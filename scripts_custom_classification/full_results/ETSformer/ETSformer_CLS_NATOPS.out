Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4409937858581543
Epoch: 1, Steps: 12 | Train Loss: 1.556 Vali Loss: 0.998 Vali Acc: 0.656 Test Loss: 0.998 Test Acc: 0.656
Validation loss decreased (inf --> -0.655546).  Saving model ...
Epoch: 2 cost time: 1.2489402294158936
Epoch: 2, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.556 Vali Acc: 0.722 Test Loss: 0.556 Test Acc: 0.722
Validation loss decreased (-0.655546 --> -0.722217).  Saving model ...
Epoch: 3 cost time: 1.3698899745941162
Epoch: 3, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.420 Vali Acc: 0.800 Test Loss: 0.420 Test Acc: 0.800
Validation loss decreased (-0.722217 --> -0.799996).  Saving model ...
Epoch: 4 cost time: 1.4012892246246338
Epoch: 4, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.372 Vali Acc: 0.817 Test Loss: 0.372 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 1.3680238723754883
Epoch: 5, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.379 Vali Acc: 0.861 Test Loss: 0.379 Test Acc: 0.861
Validation loss decreased (-0.816663 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 1.4577898979187012
Epoch: 6, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6341028213500977
Epoch: 7, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.359736680984497
Epoch: 8, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.411 Vali Acc: 0.811 Test Loss: 0.411 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5250816345214844
Epoch: 9, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.468 Vali Acc: 0.822 Test Loss: 0.468 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.457381248474121
Epoch: 10, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8488445281982422
Epoch: 11, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.579425573348999
Epoch: 12, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.379 Vali Acc: 0.844 Test Loss: 0.379 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5339231491088867
Epoch: 13, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
Validation loss decreased (-0.861107 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.6564013957977295
Epoch: 14, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4984533786773682
Epoch: 15, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.363 Vali Acc: 0.844 Test Loss: 0.363 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0284860134124756
Epoch: 16, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.419 Vali Acc: 0.856 Test Loss: 0.419 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6193628311157227
Epoch: 17, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 1.9890761375427246
Epoch: 18, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.378 Vali Acc: 0.872 Test Loss: 0.378 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6145591735839844
Epoch: 19, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 1.9789543151855469
Epoch: 20, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.15921688079834
Epoch: 21, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.354 Vali Acc: 0.872 Test Loss: 0.354 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7550685405731201
Epoch: 22, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.497 Vali Acc: 0.828 Test Loss: 0.497 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5349688529968262
Epoch: 23, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.459348201751709
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.596 Vali Acc: 0.839 Test Loss: 0.596 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5854201316833496
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.441 Vali Acc: 0.839 Test Loss: 0.441 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5251553058624268
Epoch: 26, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.845 Vali Acc: 0.822 Test Loss: 0.845 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7157549858093262
Epoch: 27, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.496 Vali Acc: 0.839 Test Loss: 0.496 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4847078323364258
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5998075008392334
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.355 Vali Acc: 0.883 Test Loss: 0.355 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 5496038
model size : 30.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9493868350982666
Epoch: 1, Steps: 12 | Train Loss: 1.554 Vali Loss: 0.998 Vali Acc: 0.656 Test Loss: 0.998 Test Acc: 0.656
Validation loss decreased (inf --> -0.655546).  Saving model ...
Epoch: 2 cost time: 1.789656162261963
Epoch: 2, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.557 Vali Acc: 0.728 Test Loss: 0.557 Test Acc: 0.728
Validation loss decreased (-0.655546 --> -0.727772).  Saving model ...
Epoch: 3 cost time: 1.650810718536377
Epoch: 3, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.415 Vali Acc: 0.778 Test Loss: 0.415 Test Acc: 0.778
Validation loss decreased (-0.727772 --> -0.777774).  Saving model ...
Epoch: 4 cost time: 1.6653218269348145
Epoch: 4, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.373 Vali Acc: 0.817 Test Loss: 0.373 Test Acc: 0.817
Validation loss decreased (-0.777774 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 1.6014842987060547
Epoch: 5, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.381 Vali Acc: 0.872 Test Loss: 0.381 Test Acc: 0.872
Validation loss decreased (-0.816663 --> -0.872218).  Saving model ...
Epoch: 6 cost time: 2.2316575050354004
Epoch: 6, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.349 Vali Acc: 0.817 Test Loss: 0.349 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3836722373962402
Epoch: 7, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.295 Vali Acc: 0.844 Test Loss: 0.295 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5846281051635742
Epoch: 8, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.386 Vali Acc: 0.822 Test Loss: 0.386 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8204965591430664
Epoch: 9, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.492 Vali Acc: 0.817 Test Loss: 0.492 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7202272415161133
Epoch: 10, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9202520847320557
Epoch: 11, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.415 Vali Acc: 0.861 Test Loss: 0.415 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0084612369537354
Epoch: 12, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.514 Vali Acc: 0.817 Test Loss: 0.514 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5173718929290771
Epoch: 13, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.9858980178833008
Epoch: 14, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7543220520019531
Epoch: 15, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4188048839569092
Epoch: 16, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.354 Vali Acc: 0.872 Test Loss: 0.354 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4812495708465576
Epoch: 17, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9192898273468018
Epoch: 18, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 2.00565242767334
Epoch: 19, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8394925594329834
Epoch: 20, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.311 Vali Acc: 0.894 Test Loss: 0.311 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 21 cost time: 1.6509380340576172
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.344 Vali Acc: 0.883 Test Loss: 0.344 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.792895793914795
Epoch: 22, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.351 Vali Acc: 0.867 Test Loss: 0.351 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9249012470245361
Epoch: 23, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.373 Vali Acc: 0.872 Test Loss: 0.373 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9285128116607666
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.381 Vali Acc: 0.861 Test Loss: 0.381 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6344521045684814
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8126356601715088
Epoch: 26, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5825862884521484
Epoch: 27, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.460 Vali Acc: 0.844 Test Loss: 0.460 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5892770290374756
Epoch: 28, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.331 Vali Acc: 0.872 Test Loss: 0.331 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5031805038452148
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.349 Vali Acc: 0.861 Test Loss: 0.349 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.422334909439087
Epoch: 30, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.625 Vali Acc: 0.828 Test Loss: 0.625 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 5496038
model size : 30.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7988009452819824
Epoch: 1, Steps: 12 | Train Loss: 1.545 Vali Loss: 0.979 Vali Acc: 0.656 Test Loss: 0.979 Test Acc: 0.656
Validation loss decreased (inf --> -0.655546).  Saving model ...
Epoch: 2 cost time: 1.7167656421661377
Epoch: 2, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.547 Vali Acc: 0.733 Test Loss: 0.547 Test Acc: 0.733
Validation loss decreased (-0.655546 --> -0.733328).  Saving model ...
Epoch: 3 cost time: 1.5157966613769531
Epoch: 3, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.399 Vali Acc: 0.783 Test Loss: 0.399 Test Acc: 0.783
Validation loss decreased (-0.733328 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 1.921842098236084
Epoch: 4, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.365 Vali Acc: 0.811 Test Loss: 0.365 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 1.8981077671051025
Epoch: 5, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.382 Vali Acc: 0.856 Test Loss: 0.382 Test Acc: 0.856
Validation loss decreased (-0.811107 --> -0.855552).  Saving model ...
Epoch: 6 cost time: 1.4273285865783691
Epoch: 6, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.340 Vali Acc: 0.822 Test Loss: 0.340 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7274174690246582
Epoch: 7, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.296 Vali Acc: 0.839 Test Loss: 0.296 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7307872772216797
Epoch: 8, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6753654479980469
Epoch: 9, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.508 Vali Acc: 0.817 Test Loss: 0.508 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7436747550964355
Epoch: 10, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.342 Vali Acc: 0.850 Test Loss: 0.342 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7400903701782227
Epoch: 11, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7509565353393555
Epoch: 12, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.869539737701416
Epoch: 13, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
Validation loss decreased (-0.855552 --> -0.905553).  Saving model ...
Epoch: 14 cost time: 2.033846139907837
Epoch: 14, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6193866729736328
Epoch: 15, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.097071886062622
Epoch: 16, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.355 Vali Acc: 0.872 Test Loss: 0.355 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.184903621673584
Epoch: 17, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.298 Vali Acc: 0.878 Test Loss: 0.298 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.952193021774292
Epoch: 18, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6542394161224365
Epoch: 19, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4973514080047607
Epoch: 20, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.150006055831909
Epoch: 21, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.022082805633545
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.394 Vali Acc: 0.856 Test Loss: 0.394 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.669541597366333
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.408 Vali Acc: 0.883 Test Loss: 0.408 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 5496038
model size : 30.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.020900011062622
Epoch: 1, Steps: 12 | Train Loss: 1.550 Vali Loss: 0.981 Vali Acc: 0.650 Test Loss: 0.981 Test Acc: 0.650
Validation loss decreased (inf --> -0.649990).  Saving model ...
Epoch: 2 cost time: 1.5658636093139648
Epoch: 2, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.559 Vali Acc: 0.733 Test Loss: 0.559 Test Acc: 0.733
Validation loss decreased (-0.649990 --> -0.733328).  Saving model ...
Epoch: 3 cost time: 1.9588825702667236
Epoch: 3, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.393 Vali Acc: 0.794 Test Loss: 0.393 Test Acc: 0.794
Validation loss decreased (-0.733328 --> -0.794441).  Saving model ...
Epoch: 4 cost time: 1.5739080905914307
Epoch: 4, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
Validation loss decreased (-0.794441 --> -0.827774).  Saving model ...
Epoch: 5 cost time: 1.6662852764129639
Epoch: 5, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.355 Vali Acc: 0.861 Test Loss: 0.355 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 6 cost time: 1.6685259342193604
Epoch: 6, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.650571346282959
Epoch: 7, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6645264625549316
Epoch: 8, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.452 Vali Acc: 0.822 Test Loss: 0.452 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8139774799346924
Epoch: 9, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.401 Vali Acc: 0.822 Test Loss: 0.401 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.489497184753418
Epoch: 10, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894442).  Saving model ...
Epoch: 11 cost time: 1.460357666015625
Epoch: 11, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.336 Vali Acc: 0.867 Test Loss: 0.336 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3353056907653809
Epoch: 12, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.411 Vali Acc: 0.861 Test Loss: 0.411 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7228422164916992
Epoch: 13, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.608597755432129
Epoch: 14, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.366 Vali Acc: 0.883 Test Loss: 0.366 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0306384563446045
Epoch: 15, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9249022006988525
Epoch: 16, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8875517845153809
Epoch: 17, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.432 Vali Acc: 0.883 Test Loss: 0.432 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7764992713928223
Epoch: 18, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7125566005706787
Epoch: 19, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.317 Vali Acc: 0.872 Test Loss: 0.317 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9541852474212646
Epoch: 20, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.441 Vali Acc: 0.872 Test Loss: 0.441 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 5496038
model size : 30.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.548265218734741
Epoch: 1, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.006 Vali Acc: 0.672 Test Loss: 1.006 Test Acc: 0.672
Validation loss decreased (inf --> -0.672212).  Saving model ...
Epoch: 2 cost time: 1.7183120250701904
Epoch: 2, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.590 Vali Acc: 0.706 Test Loss: 0.590 Test Acc: 0.706
Validation loss decreased (-0.672212 --> -0.705550).  Saving model ...
Epoch: 3 cost time: 1.990248680114746
Epoch: 3, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.428 Vali Acc: 0.772 Test Loss: 0.428 Test Acc: 0.772
Validation loss decreased (-0.705550 --> -0.772218).  Saving model ...
Epoch: 4 cost time: 1.7387726306915283
Epoch: 4, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.397 Vali Acc: 0.772 Test Loss: 0.397 Test Acc: 0.772
Validation loss decreased (-0.772218 --> -0.772218).  Saving model ...
Epoch: 5 cost time: 1.9279356002807617
Epoch: 5, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.374 Vali Acc: 0.839 Test Loss: 0.374 Test Acc: 0.839
Validation loss decreased (-0.772218 --> -0.838885).  Saving model ...
Epoch: 6 cost time: 1.780482530593872
Epoch: 6, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 2.0803375244140625
Epoch: 7, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.415 Vali Acc: 0.844 Test Loss: 0.415 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9099254608154297
Epoch: 8, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.777862310409546
Epoch: 9, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.336 Vali Acc: 0.867 Test Loss: 0.336 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866663).  Saving model ...
Epoch: 10 cost time: 1.8453383445739746
Epoch: 10, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
Validation loss decreased (-0.866663 --> -0.927775).  Saving model ...
Epoch: 11 cost time: 1.6763145923614502
Epoch: 11, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.307 Vali Acc: 0.872 Test Loss: 0.307 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.671555757522583
Epoch: 12, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.365 Vali Acc: 0.872 Test Loss: 0.365 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8255813121795654
Epoch: 13, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1091997623443604
Epoch: 14, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.322 Vali Acc: 0.867 Test Loss: 0.322 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9676015377044678
Epoch: 15, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8546514511108398
Epoch: 16, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.329 Vali Acc: 0.861 Test Loss: 0.329 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6782631874084473
Epoch: 17, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.351 Vali Acc: 0.867 Test Loss: 0.351 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5816640853881836
Epoch: 18, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4308204650878906
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.430 Vali Acc: 0.856 Test Loss: 0.430 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.773876667022705
Epoch: 20, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.325 Vali Acc: 0.867 Test Loss: 0.325 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 3398886
model size : 22.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.33868670463562
Epoch: 1, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.001 Vali Acc: 0.672 Test Loss: 1.001 Test Acc: 0.672
Validation loss decreased (inf --> -0.672212).  Saving model ...
Epoch: 2 cost time: 1.944148302078247
Epoch: 2, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.589 Vali Acc: 0.706 Test Loss: 0.589 Test Acc: 0.706
Validation loss decreased (-0.672212 --> -0.705550).  Saving model ...
Epoch: 3 cost time: 1.7648775577545166
Epoch: 3, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.424 Vali Acc: 0.761 Test Loss: 0.424 Test Acc: 0.761
Validation loss decreased (-0.705550 --> -0.761107).  Saving model ...
Epoch: 4 cost time: 1.9116086959838867
Epoch: 4, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.390 Vali Acc: 0.783 Test Loss: 0.390 Test Acc: 0.783
Validation loss decreased (-0.761107 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 1.74863600730896
Epoch: 5, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.371 Vali Acc: 0.839 Test Loss: 0.371 Test Acc: 0.839
Validation loss decreased (-0.783329 --> -0.838885).  Saving model ...
Epoch: 6 cost time: 1.6864376068115234
Epoch: 6, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.347 Vali Acc: 0.833 Test Loss: 0.347 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7530865669250488
Epoch: 7, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.432 Vali Acc: 0.839 Test Loss: 0.432 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.028909206390381
Epoch: 8, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.367 Vali Acc: 0.839 Test Loss: 0.367 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 1.6778969764709473
Epoch: 9, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.317 Vali Acc: 0.861 Test Loss: 0.317 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.9844551086425781
Epoch: 10, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 1.5645220279693604
Epoch: 11, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 1.68865966796875
Epoch: 12, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.350 Vali Acc: 0.878 Test Loss: 0.350 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 13 cost time: 1.6569912433624268
Epoch: 13, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.712667465209961
Epoch: 14, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.319 Vali Acc: 0.867 Test Loss: 0.319 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8832261562347412
Epoch: 15, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.346 Vali Acc: 0.861 Test Loss: 0.346 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.289583683013916
Epoch: 16, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.349 Vali Acc: 0.856 Test Loss: 0.349 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6982038021087646
Epoch: 17, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.328 Vali Acc: 0.872 Test Loss: 0.328 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.832634449005127
Epoch: 18, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 1.6753618717193604
Epoch: 19, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.311 Vali Acc: 0.894 Test Loss: 0.311 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6490509510040283
Epoch: 20, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.404 Vali Acc: 0.878 Test Loss: 0.404 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7005741596221924
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.399 Vali Acc: 0.872 Test Loss: 0.399 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6827163696289062
Epoch: 22, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.378 Vali Acc: 0.878 Test Loss: 0.378 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9968578815460205
Epoch: 23, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.450 Vali Acc: 0.878 Test Loss: 0.450 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.675934076309204
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.334 Vali Acc: 0.894 Test Loss: 0.334 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7509372234344482
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.804927110671997
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8799712657928467
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9477941989898682
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 3398886
model size : 22.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.848660469055176
Epoch: 1, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.000 Vali Acc: 0.694 Test Loss: 1.000 Test Acc: 0.694
Validation loss decreased (inf --> -0.694434).  Saving model ...
Epoch: 2 cost time: 1.835578441619873
Epoch: 2, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.590 Vali Acc: 0.711 Test Loss: 0.590 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711105).  Saving model ...
Epoch: 3 cost time: 1.407261610031128
Epoch: 3, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.420 Vali Acc: 0.767 Test Loss: 0.420 Test Acc: 0.767
Validation loss decreased (-0.711105 --> -0.766662).  Saving model ...
Epoch: 4 cost time: 1.6425440311431885
Epoch: 4, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.388 Vali Acc: 0.761 Test Loss: 0.388 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7168450355529785
Epoch: 5, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.362 Vali Acc: 0.839 Test Loss: 0.362 Test Acc: 0.839
Validation loss decreased (-0.766662 --> -0.838885).  Saving model ...
Epoch: 6 cost time: 1.6431238651275635
Epoch: 6, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.340 Vali Acc: 0.839 Test Loss: 0.340 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 1.753269910812378
Epoch: 7, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.414 Vali Acc: 0.856 Test Loss: 0.414 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855551).  Saving model ...
Epoch: 8 cost time: 1.6261446475982666
Epoch: 8, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.365 Vali Acc: 0.828 Test Loss: 0.365 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6451125144958496
Epoch: 9, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 1.5241765975952148
Epoch: 10, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
Validation loss decreased (-0.872219 --> -0.927775).  Saving model ...
Epoch: 11 cost time: 1.5282959938049316
Epoch: 11, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8739597797393799
Epoch: 12, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.397 Vali Acc: 0.883 Test Loss: 0.397 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6662027835845947
Epoch: 13, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0752954483032227
Epoch: 14, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.327 Vali Acc: 0.872 Test Loss: 0.327 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8620884418487549
Epoch: 15, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.334 Vali Acc: 0.872 Test Loss: 0.334 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5017435550689697
Epoch: 16, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.396 Vali Acc: 0.844 Test Loss: 0.396 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0441370010375977
Epoch: 17, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9212195873260498
Epoch: 18, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.310 Vali Acc: 0.894 Test Loss: 0.310 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.606001853942871
Epoch: 19, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.500864028930664
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 3398886
model size : 22.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7698678970336914
Epoch: 1, Steps: 12 | Train Loss: 1.562 Vali Loss: 0.961 Vali Acc: 0.689 Test Loss: 0.961 Test Acc: 0.689
Validation loss decreased (inf --> -0.688879).  Saving model ...
Epoch: 2 cost time: 1.8480515480041504
Epoch: 2, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.565 Vali Acc: 0.711 Test Loss: 0.565 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711105).  Saving model ...
Epoch: 3 cost time: 1.8047826290130615
Epoch: 3, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.413 Vali Acc: 0.783 Test Loss: 0.413 Test Acc: 0.783
Validation loss decreased (-0.711105 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 1.6960444450378418
Epoch: 4, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.377 Vali Acc: 0.789 Test Loss: 0.377 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 5 cost time: 1.8746364116668701
Epoch: 5, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.342 Vali Acc: 0.822 Test Loss: 0.342 Test Acc: 0.822
Validation loss decreased (-0.788885 --> -0.822219).  Saving model ...
Epoch: 6 cost time: 1.5165419578552246
Epoch: 6, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.321 Vali Acc: 0.839 Test Loss: 0.321 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838886).  Saving model ...
Epoch: 7 cost time: 1.301964521408081
Epoch: 7, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.419 Vali Acc: 0.872 Test Loss: 0.419 Test Acc: 0.872
Validation loss decreased (-0.838886 --> -0.872218).  Saving model ...
Epoch: 8 cost time: 1.3649404048919678
Epoch: 8, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4129817485809326
Epoch: 9, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6220788955688477
Epoch: 10, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.251 Vali Acc: 0.894 Test Loss: 0.251 Test Acc: 0.894
Validation loss decreased (-0.872218 --> -0.894442).  Saving model ...
Epoch: 11 cost time: 1.9571630954742432
Epoch: 11, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.254 Vali Acc: 0.878 Test Loss: 0.254 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6870033740997314
Epoch: 12, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.328 Vali Acc: 0.844 Test Loss: 0.328 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7114150524139404
Epoch: 13, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.334 Vali Acc: 0.867 Test Loss: 0.334 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9206411838531494
Epoch: 14, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7214100360870361
Epoch: 15, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.585740089416504
Epoch: 16, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8654439449310303
Epoch: 17, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.341 Vali Acc: 0.878 Test Loss: 0.341 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6435792446136475
Epoch: 18, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.775569200515747
Epoch: 19, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.362 Vali Acc: 0.883 Test Loss: 0.362 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6883034706115723
Epoch: 20, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.372 Vali Acc: 0.856 Test Loss: 0.372 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 3398886
model size : 22.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.621373414993286
Epoch: 1, Steps: 12 | Train Loss: 1.595 Vali Loss: 1.049 Vali Acc: 0.606 Test Loss: 1.049 Test Acc: 0.606
Validation loss decreased (inf --> -0.605545).  Saving model ...
Epoch: 2 cost time: 1.7891697883605957
Epoch: 2, Steps: 12 | Train Loss: 0.840 Vali Loss: 0.650 Vali Acc: 0.722 Test Loss: 0.650 Test Acc: 0.722
Validation loss decreased (-0.605545 --> -0.722216).  Saving model ...
Epoch: 3 cost time: 1.6219611167907715
Epoch: 3, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.397 Vali Acc: 0.800 Test Loss: 0.397 Test Acc: 0.800
Validation loss decreased (-0.722216 --> -0.799996).  Saving model ...
Epoch: 4 cost time: 1.5895600318908691
Epoch: 4, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.388 Vali Acc: 0.811 Test Loss: 0.388 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 1.6977529525756836
Epoch: 5, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.388 Vali Acc: 0.844 Test Loss: 0.388 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.6809401512145996
Epoch: 6, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 7 cost time: 1.9415502548217773
Epoch: 7, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 8 cost time: 2.00738787651062
Epoch: 8, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.332 Vali Acc: 0.844 Test Loss: 0.332 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8752682209014893
Epoch: 9, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.370 Vali Acc: 0.861 Test Loss: 0.370 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4774296283721924
Epoch: 10, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.527 Vali Acc: 0.806 Test Loss: 0.527 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.661344051361084
Epoch: 11, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.299 Vali Acc: 0.844 Test Loss: 0.299 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3814949989318848
Epoch: 12, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.297 Vali Acc: 0.872 Test Loss: 0.297 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.742119550704956
Epoch: 13, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.359 Vali Acc: 0.861 Test Loss: 0.359 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6988673210144043
Epoch: 14, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0444815158843994
Epoch: 15, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.356 Vali Acc: 0.844 Test Loss: 0.356 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0296871662139893
Epoch: 16, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.419 Vali Acc: 0.828 Test Loss: 0.419 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8875584602355957
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.601 Vali Acc: 0.811 Test Loss: 0.601 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2350310
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6674227714538574
Epoch: 1, Steps: 12 | Train Loss: 1.591 Vali Loss: 1.043 Vali Acc: 0.633 Test Loss: 1.043 Test Acc: 0.633
Validation loss decreased (inf --> -0.633323).  Saving model ...
Epoch: 2 cost time: 1.6521947383880615
Epoch: 2, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.648 Vali Acc: 0.722 Test Loss: 0.648 Test Acc: 0.722
Validation loss decreased (-0.633323 --> -0.722216).  Saving model ...
Epoch: 3 cost time: 1.6910574436187744
Epoch: 3, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.395 Vali Acc: 0.806 Test Loss: 0.395 Test Acc: 0.806
Validation loss decreased (-0.722216 --> -0.805552).  Saving model ...
Epoch: 4 cost time: 1.8221356868743896
Epoch: 4, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.391 Vali Acc: 0.828 Test Loss: 0.391 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 5 cost time: 1.7290682792663574
Epoch: 5, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.388 Vali Acc: 0.844 Test Loss: 0.388 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.6215124130249023
Epoch: 6, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.324 Vali Acc: 0.850 Test Loss: 0.324 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 7 cost time: 1.6272008419036865
Epoch: 7, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 8 cost time: 1.7889597415924072
Epoch: 8, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 9 cost time: 1.8267147541046143
Epoch: 9, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.371 Vali Acc: 0.856 Test Loss: 0.371 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.643446683883667
Epoch: 10, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.469 Vali Acc: 0.817 Test Loss: 0.469 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6582269668579102
Epoch: 11, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.763338327407837
Epoch: 12, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.96480393409729
Epoch: 13, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.435 Vali Acc: 0.833 Test Loss: 0.435 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7996940612792969
Epoch: 14, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.704585313796997
Epoch: 15, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.390 Vali Acc: 0.856 Test Loss: 0.390 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9850866794586182
Epoch: 16, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.466 Vali Acc: 0.828 Test Loss: 0.466 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.578300952911377
Epoch: 17, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.547 Vali Acc: 0.817 Test Loss: 0.547 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7786695957183838
Epoch: 18, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2350310
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9923768043518066
Epoch: 1, Steps: 12 | Train Loss: 1.588 Vali Loss: 1.040 Vali Acc: 0.639 Test Loss: 1.040 Test Acc: 0.639
Validation loss decreased (inf --> -0.638878).  Saving model ...
Epoch: 2 cost time: 1.9772224426269531
Epoch: 2, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.639 Vali Acc: 0.717 Test Loss: 0.639 Test Acc: 0.717
Validation loss decreased (-0.638878 --> -0.716660).  Saving model ...
Epoch: 3 cost time: 1.441451072692871
Epoch: 3, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.394 Vali Acc: 0.789 Test Loss: 0.394 Test Acc: 0.789
Validation loss decreased (-0.716660 --> -0.788885).  Saving model ...
Epoch: 4 cost time: 1.936359167098999
Epoch: 4, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.385 Vali Acc: 0.817 Test Loss: 0.385 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 1.7426104545593262
Epoch: 5, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.379 Vali Acc: 0.844 Test Loss: 0.379 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.957911729812622
Epoch: 6, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7026407718658447
Epoch: 7, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 8 cost time: 1.8747475147247314
Epoch: 8, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.765620231628418
Epoch: 9, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.380 Vali Acc: 0.850 Test Loss: 0.380 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9475407600402832
Epoch: 10, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.542 Vali Acc: 0.817 Test Loss: 0.542 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8174569606781006
Epoch: 11, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
Validation loss decreased (-0.855553 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 1.6699135303497314
Epoch: 12, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8175296783447266
Epoch: 13, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.358 Vali Acc: 0.839 Test Loss: 0.358 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.899571418762207
Epoch: 14, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.316 Vali Acc: 0.872 Test Loss: 0.316 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9421920776367188
Epoch: 15, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.363 Vali Acc: 0.867 Test Loss: 0.363 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8561816215515137
Epoch: 16, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.429 Vali Acc: 0.828 Test Loss: 0.429 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9525132179260254
Epoch: 17, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.645 Vali Acc: 0.811 Test Loss: 0.645 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.623047113418579
Epoch: 18, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.6332721710205078
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.370 Vali Acc: 0.872 Test Loss: 0.370 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5937650203704834
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.382 Vali Acc: 0.867 Test Loss: 0.382 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8567583560943604
Epoch: 21, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.313 Vali Acc: 0.894 Test Loss: 0.313 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 22 cost time: 1.6511085033416748
Epoch: 22, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.382 Vali Acc: 0.878 Test Loss: 0.382 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7975728511810303
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4859232902526855
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8136141300201416
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.308 Vali Acc: 0.878 Test Loss: 0.308 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.932396411895752
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.397 Vali Acc: 0.878 Test Loss: 0.397 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.700617790222168
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.745330810546875
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.437 Vali Acc: 0.872 Test Loss: 0.437 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.004575490951538
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.354 Vali Acc: 0.894 Test Loss: 0.354 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7380039691925049
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.739128828048706
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.354 Vali Acc: 0.906 Test Loss: 0.354 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 32 cost time: 1.8053226470947266
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9597337245941162
Epoch: 33, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.104832887649536
Epoch: 34, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.1477720737457275
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.368 Vali Acc: 0.894 Test Loss: 0.368 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.9683480262756348
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.345 Vali Acc: 0.883 Test Loss: 0.345 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.0470709800720215
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.348 Vali Acc: 0.883 Test Loss: 0.348 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.197824716567993
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.116299867630005
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.778754472732544
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.6863987445831299
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 2350310
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.13304328918457
Epoch: 1, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.028 Vali Acc: 0.617 Test Loss: 1.028 Test Acc: 0.617
Validation loss decreased (inf --> -0.616656).  Saving model ...
Epoch: 2 cost time: 2.139587163925171
Epoch: 2, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.631 Vali Acc: 0.717 Test Loss: 0.631 Test Acc: 0.717
Validation loss decreased (-0.616656 --> -0.716660).  Saving model ...
Epoch: 3 cost time: 2.0733630657196045
Epoch: 3, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.385 Vali Acc: 0.822 Test Loss: 0.385 Test Acc: 0.822
Validation loss decreased (-0.716660 --> -0.822218).  Saving model ...
Epoch: 4 cost time: 2.115978479385376
Epoch: 4, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.375 Vali Acc: 0.817 Test Loss: 0.375 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2005441188812256
Epoch: 5, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.357 Vali Acc: 0.844 Test Loss: 0.357 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.9562592506408691
Epoch: 6, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 2.1852457523345947
Epoch: 7, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.855552 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 2.0392889976501465
Epoch: 8, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.428 Vali Acc: 0.811 Test Loss: 0.428 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9645252227783203
Epoch: 9, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.366 Vali Acc: 0.828 Test Loss: 0.366 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.255136489868164
Epoch: 10, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1472949981689453
Epoch: 11, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899998).  Saving model ...
Epoch: 12 cost time: 2.0527875423431396
Epoch: 12, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9329848289489746
Epoch: 13, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.396 Vali Acc: 0.839 Test Loss: 0.396 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9426062107086182
Epoch: 14, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0634608268737793
Epoch: 15, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.429 Vali Acc: 0.867 Test Loss: 0.429 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2914226055145264
Epoch: 16, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.390 Vali Acc: 0.839 Test Loss: 0.390 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9983677864074707
Epoch: 17, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9441897869110107
Epoch: 18, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3104591369628906
Epoch: 19, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.393 Vali Acc: 0.861 Test Loss: 0.393 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9015166759490967
Epoch: 20, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.001655340194702
Epoch: 21, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.369 Vali Acc: 0.883 Test Loss: 0.369 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2350310
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1731038093566895
Epoch: 1, Steps: 12 | Train Loss: 1.555 Vali Loss: 0.943 Vali Acc: 0.700 Test Loss: 0.943 Test Acc: 0.700
Validation loss decreased (inf --> -0.699991).  Saving model ...
Epoch: 2 cost time: 1.8807342052459717
Epoch: 2, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.605 Vali Acc: 0.744 Test Loss: 0.605 Test Acc: 0.744
Validation loss decreased (-0.699991 --> -0.744438).  Saving model ...
Epoch: 3 cost time: 1.9517426490783691
Epoch: 3, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.462 Vali Acc: 0.811 Test Loss: 0.462 Test Acc: 0.811
Validation loss decreased (-0.744438 --> -0.811106).  Saving model ...
Epoch: 4 cost time: 1.9613289833068848
Epoch: 4, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.424 Vali Acc: 0.778 Test Loss: 0.424 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9040367603302002
Epoch: 5, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.367 Vali Acc: 0.839 Test Loss: 0.367 Test Acc: 0.839
Validation loss decreased (-0.811106 --> -0.838885).  Saving model ...
Epoch: 6 cost time: 1.9874858856201172
Epoch: 6, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.325 Vali Acc: 0.828 Test Loss: 0.325 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.168837308883667
Epoch: 7, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.339 Vali Acc: 0.856 Test Loss: 0.339 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 2.0530717372894287
Epoch: 8, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.372 Vali Acc: 0.844 Test Loss: 0.372 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.825028896331787
Epoch: 9, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.531 Vali Acc: 0.811 Test Loss: 0.531 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7557711601257324
Epoch: 10, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.336 Vali Acc: 0.839 Test Loss: 0.336 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.136837959289551
Epoch: 11, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.561 Vali Acc: 0.789 Test Loss: 0.561 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.983335018157959
Epoch: 12, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.469 Vali Acc: 0.806 Test Loss: 0.469 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0454394817352295
Epoch: 13, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 2.2711093425750732
Epoch: 14, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 2.134835958480835
Epoch: 15, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.400 Vali Acc: 0.828 Test Loss: 0.400 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.182206630706787
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.340 Vali Acc: 0.861 Test Loss: 0.340 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 2.226487159729004
Epoch: 17, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 1.83255934715271
Epoch: 18, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.827087163925171
Epoch: 19, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.862685203552246
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.354 Vali Acc: 0.861 Test Loss: 0.354 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9045119285583496
Epoch: 21, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 2.1710355281829834
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9788930416107178
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.397 Vali Acc: 0.861 Test Loss: 0.397 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2850632667541504
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.343 Vali Acc: 0.872 Test Loss: 0.343 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.3069417476654053
Epoch: 25, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.324 Vali Acc: 0.867 Test Loss: 0.324 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0347955226898193
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.399 Vali Acc: 0.856 Test Loss: 0.399 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.1596193313598633
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.339 Vali Acc: 0.878 Test Loss: 0.339 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.5459389686584473
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.322 Vali Acc: 0.883 Test Loss: 0.322 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.280424118041992
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.226247549057007
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.342 Vali Acc: 0.894 Test Loss: 0.342 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.1493537425994873
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1826022
model size : 16.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.94616436958313
Epoch: 1, Steps: 12 | Train Loss: 1.545 Vali Loss: 0.938 Vali Acc: 0.700 Test Loss: 0.938 Test Acc: 0.700
Validation loss decreased (inf --> -0.699991).  Saving model ...
Epoch: 2 cost time: 2.131086826324463
Epoch: 2, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.608 Vali Acc: 0.744 Test Loss: 0.608 Test Acc: 0.744
Validation loss decreased (-0.699991 --> -0.744438).  Saving model ...
Epoch: 3 cost time: 2.0070722103118896
Epoch: 3, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.454 Vali Acc: 0.800 Test Loss: 0.454 Test Acc: 0.800
Validation loss decreased (-0.744438 --> -0.799995).  Saving model ...
Epoch: 4 cost time: 1.8209121227264404
Epoch: 4, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.426 Vali Acc: 0.772 Test Loss: 0.426 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0285847187042236
Epoch: 5, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.379 Vali Acc: 0.850 Test Loss: 0.379 Test Acc: 0.850
Validation loss decreased (-0.799995 --> -0.849996).  Saving model ...
Epoch: 6 cost time: 2.044466018676758
Epoch: 6, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.932030439376831
Epoch: 7, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.331 Vali Acc: 0.861 Test Loss: 0.331 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 2.047621965408325
Epoch: 8, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.972768783569336
Epoch: 9, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.546 Vali Acc: 0.811 Test Loss: 0.546 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.925074577331543
Epoch: 10, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.348 Vali Acc: 0.828 Test Loss: 0.348 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0226972103118896
Epoch: 11, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2985494136810303
Epoch: 12, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.485 Vali Acc: 0.806 Test Loss: 0.485 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0200254917144775
Epoch: 13, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.331 Vali Acc: 0.856 Test Loss: 0.331 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8804621696472168
Epoch: 14, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.323 Vali Acc: 0.861 Test Loss: 0.323 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 1.8583693504333496
Epoch: 15, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9945344924926758
Epoch: 16, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1266491413116455
Epoch: 17, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 1.8315739631652832
Epoch: 18, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.297 Vali Acc: 0.894 Test Loss: 0.297 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 19 cost time: 1.8750672340393066
Epoch: 19, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.392451524734497
Epoch: 20, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.345 Vali Acc: 0.867 Test Loss: 0.345 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9526185989379883
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 1.9154458045959473
Epoch: 22, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.323 Vali Acc: 0.878 Test Loss: 0.323 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.221271514892578
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.413 Vali Acc: 0.844 Test Loss: 0.413 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1989657878875732
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9694886207580566
Epoch: 25, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.2402184009552
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.353 Vali Acc: 0.878 Test Loss: 0.353 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.322575330734253
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.339 Vali Acc: 0.878 Test Loss: 0.339 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.2055342197418213
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.1728527545928955
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.421 Vali Acc: 0.872 Test Loss: 0.421 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.0541388988494873
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 31 cost time: 2.1974573135375977
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.330 Vali Acc: 0.883 Test Loss: 0.330 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.3146004676818848
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.364 Vali Acc: 0.878 Test Loss: 0.364 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.3567535877227783
Epoch: 33, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.359 Vali Acc: 0.883 Test Loss: 0.359 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.0830368995666504
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.340 Vali Acc: 0.878 Test Loss: 0.340 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.028696060180664
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.367 Vali Acc: 0.872 Test Loss: 0.367 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.25475811958313
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.333 Vali Acc: 0.883 Test Loss: 0.333 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.19679594039917
Epoch: 37, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.363 Vali Acc: 0.872 Test Loss: 0.363 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.226090669631958
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.359 Vali Acc: 0.878 Test Loss: 0.359 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.194817304611206
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 1.8576152324676514
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.470 Vali Acc: 0.878 Test Loss: 0.470 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.1787266731262207
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.385 Vali Acc: 0.883 Test Loss: 0.385 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.236036777496338
Epoch: 42, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.361 Vali Acc: 0.883 Test Loss: 0.361 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.1244397163391113
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.1938741207122803
Epoch: 44, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.06622576713562
Epoch: 45, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.437 Vali Acc: 0.889 Test Loss: 0.437 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.9358789920806885
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.665 Vali Acc: 0.850 Test Loss: 0.665 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.9378082752227783
Epoch: 47, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.2536494731903076
Epoch: 48, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.2797555923461914
Epoch: 49, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.620 Vali Acc: 0.867 Test Loss: 0.620 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1826022
model size : 16.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.959211826324463
Epoch: 1, Steps: 12 | Train Loss: 1.543 Vali Loss: 0.932 Vali Acc: 0.672 Test Loss: 0.932 Test Acc: 0.672
Validation loss decreased (inf --> -0.672213).  Saving model ...
Epoch: 2 cost time: 2.1111814975738525
Epoch: 2, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.603 Vali Acc: 0.744 Test Loss: 0.603 Test Acc: 0.744
Validation loss decreased (-0.672213 --> -0.744438).  Saving model ...
Epoch: 3 cost time: 2.0537216663360596
Epoch: 3, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.441 Vali Acc: 0.822 Test Loss: 0.441 Test Acc: 0.822
Validation loss decreased (-0.744438 --> -0.822218).  Saving model ...
Epoch: 4 cost time: 1.9317905902862549
Epoch: 4, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.407 Vali Acc: 0.772 Test Loss: 0.407 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1278960704803467
Epoch: 5, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.374 Vali Acc: 0.856 Test Loss: 0.374 Test Acc: 0.856
Validation loss decreased (-0.822218 --> -0.855552).  Saving model ...
Epoch: 6 cost time: 2.180328607559204
Epoch: 6, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.311 Vali Acc: 0.833 Test Loss: 0.311 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1624743938446045
Epoch: 7, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 2.2994954586029053
Epoch: 8, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.362 Vali Acc: 0.856 Test Loss: 0.362 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3352274894714355
Epoch: 9, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.528 Vali Acc: 0.817 Test Loss: 0.528 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1031546592712402
Epoch: 10, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.348 Vali Acc: 0.833 Test Loss: 0.348 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0591275691986084
Epoch: 11, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.586 Vali Acc: 0.794 Test Loss: 0.586 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.241917371749878
Epoch: 12, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.405 Vali Acc: 0.817 Test Loss: 0.405 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1032016277313232
Epoch: 13, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.329 Vali Acc: 0.861 Test Loss: 0.329 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 2.0357539653778076
Epoch: 14, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.386 Vali Acc: 0.839 Test Loss: 0.386 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.094010591506958
Epoch: 15, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.344 Vali Acc: 0.861 Test Loss: 0.344 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9496500492095947
Epoch: 16, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.335 Vali Acc: 0.878 Test Loss: 0.335 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877774).  Saving model ...
Epoch: 17 cost time: 2.0884878635406494
Epoch: 17, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.474 Vali Acc: 0.844 Test Loss: 0.474 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.21331524848938
Epoch: 18, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.335 Vali Acc: 0.856 Test Loss: 0.335 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0730388164520264
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 20 cost time: 2.090837240219116
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.931847095489502
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.337 Vali Acc: 0.894 Test Loss: 0.337 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 22 cost time: 1.9987983703613281
Epoch: 22, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.372 Vali Acc: 0.872 Test Loss: 0.372 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2167837619781494
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.441 Vali Acc: 0.861 Test Loss: 0.441 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1285414695739746
Epoch: 24, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.337 Vali Acc: 0.894 Test Loss: 0.337 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 25 cost time: 2.1767215728759766
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 2.122201442718506
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.491 Vali Acc: 0.839 Test Loss: 0.491 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2317445278167725
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0728206634521484
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.366 Vali Acc: 0.883 Test Loss: 0.366 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.2457830905914307
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.363 Vali Acc: 0.883 Test Loss: 0.363 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9632961750030518
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7271664142608643
Epoch: 31, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.375 Vali Acc: 0.883 Test Loss: 0.375 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.1458892822265625
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.381 Vali Acc: 0.889 Test Loss: 0.381 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.1411564350128174
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.372 Vali Acc: 0.883 Test Loss: 0.372 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.840935468673706
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.551 Vali Acc: 0.872 Test Loss: 0.551 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.915330410003662
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1826022
model size : 16.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.650303363800049
Epoch: 1, Steps: 12 | Train Loss: 1.531 Vali Loss: 0.931 Vali Acc: 0.678 Test Loss: 0.931 Test Acc: 0.678
Validation loss decreased (inf --> -0.677768).  Saving model ...
Epoch: 2 cost time: 1.897737979888916
Epoch: 2, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.590 Vali Acc: 0.744 Test Loss: 0.590 Test Acc: 0.744
Validation loss decreased (-0.677768 --> -0.744439).  Saving model ...
Epoch: 3 cost time: 1.9838547706604004
Epoch: 3, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.428 Vali Acc: 0.811 Test Loss: 0.428 Test Acc: 0.811
Validation loss decreased (-0.744439 --> -0.811107).  Saving model ...
Epoch: 4 cost time: 2.3341755867004395
Epoch: 4, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.386 Vali Acc: 0.789 Test Loss: 0.386 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0712034702301025
Epoch: 5, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.350 Vali Acc: 0.856 Test Loss: 0.350 Test Acc: 0.856
Validation loss decreased (-0.811107 --> -0.855552).  Saving model ...
Epoch: 6 cost time: 1.717477798461914
Epoch: 6, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.295 Vali Acc: 0.850 Test Loss: 0.295 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8188667297363281
Epoch: 7, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 8 cost time: 2.054861545562744
Epoch: 8, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.158869504928589
Epoch: 9, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6891043186187744
Epoch: 10, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8598458766937256
Epoch: 11, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.440 Vali Acc: 0.817 Test Loss: 0.440 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7652573585510254
Epoch: 12, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.314 Vali Acc: 0.867 Test Loss: 0.314 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 1.9778404235839844
Epoch: 13, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 2.03033185005188
Epoch: 14, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.325 Vali Acc: 0.872 Test Loss: 0.325 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.213278293609619
Epoch: 15, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.413 Vali Acc: 0.844 Test Loss: 0.413 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9843666553497314
Epoch: 16, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.372 Vali Acc: 0.861 Test Loss: 0.372 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0534989833831787
Epoch: 17, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.336 Vali Acc: 0.867 Test Loss: 0.336 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.982048511505127
Epoch: 18, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 2.5422298908233643
Epoch: 19, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.379 Vali Acc: 0.867 Test Loss: 0.379 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2771506309509277
Epoch: 20, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.344 Vali Acc: 0.878 Test Loss: 0.344 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.225083827972412
Epoch: 21, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.371 Vali Acc: 0.872 Test Loss: 0.371 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2503180503845215
Epoch: 22, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 2.3139214515686035
Epoch: 23, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.390 Vali Acc: 0.872 Test Loss: 0.390 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.292433977127075
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 1.9656543731689453
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.376 Vali Acc: 0.867 Test Loss: 0.376 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.27949595451355
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.342 Vali Acc: 0.894 Test Loss: 0.342 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.290969133377075
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0698869228363037
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.413 Vali Acc: 0.878 Test Loss: 0.413 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.982344150543213
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.466 Vali Acc: 0.878 Test Loss: 0.466 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.37300968170166
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.357 Vali Acc: 0.878 Test Loss: 0.357 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.068873405456543
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.2528820037841797
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.308833122253418
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 34 cost time: 2.16536283493042
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.4239161014556885
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.375 Vali Acc: 0.883 Test Loss: 0.375 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.203070878982544
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 37 cost time: 1.9920876026153564
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.407 Vali Acc: 0.883 Test Loss: 0.407 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.0159292221069336
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.335 Vali Acc: 0.906 Test Loss: 0.335 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.9550955295562744
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.340 Vali Acc: 0.906 Test Loss: 0.340 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.9099111557006836
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.9503099918365479
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.335 Vali Acc: 0.906 Test Loss: 0.335 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.8047115802764893
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.356 Vali Acc: 0.906 Test Loss: 0.356 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.7722747325897217
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.340 Vali Acc: 0.906 Test Loss: 0.340 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.9460983276367188
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.343 Vali Acc: 0.906 Test Loss: 0.343 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.0184295177459717
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.906 Test Loss: 0.354 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.9574873447418213
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.386 Vali Acc: 0.894 Test Loss: 0.386 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1826022
model size : 16.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.52625846862793
Epoch: 1, Steps: 12 | Train Loss: 1.495 Vali Loss: 0.956 Vali Acc: 0.678 Test Loss: 0.956 Test Acc: 0.678
Validation loss decreased (inf --> -0.677768).  Saving model ...
Epoch: 2 cost time: 2.2583236694335938
Epoch: 2, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.585 Vali Acc: 0.750 Test Loss: 0.585 Test Acc: 0.750
Validation loss decreased (-0.677768 --> -0.749994).  Saving model ...
Epoch: 3 cost time: 1.9460713863372803
Epoch: 3, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.400 Vali Acc: 0.800 Test Loss: 0.400 Test Acc: 0.800
Validation loss decreased (-0.749994 --> -0.799996).  Saving model ...
Epoch: 4 cost time: 2.238847255706787
Epoch: 4, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.356 Vali Acc: 0.811 Test Loss: 0.356 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811108).  Saving model ...
Epoch: 5 cost time: 2.501103162765503
Epoch: 5, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
Validation loss decreased (-0.811108 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 2.4052586555480957
Epoch: 6, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.434 Vali Acc: 0.772 Test Loss: 0.434 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.414903163909912
Epoch: 7, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.387 Vali Acc: 0.833 Test Loss: 0.387 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 2.4982688426971436
Epoch: 8, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.322 Vali Acc: 0.833 Test Loss: 0.322 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 2.1908986568450928
Epoch: 9, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.374 Vali Acc: 0.817 Test Loss: 0.374 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1856870651245117
Epoch: 10, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.295 Vali Acc: 0.850 Test Loss: 0.295 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 2.429979085922241
Epoch: 11, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 2.0524165630340576
Epoch: 12, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.342 Vali Acc: 0.844 Test Loss: 0.342 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.046809673309326
Epoch: 13, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.483 Vali Acc: 0.817 Test Loss: 0.483 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7153489589691162
Epoch: 14, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.325 Vali Acc: 0.861 Test Loss: 0.325 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0934078693389893
Epoch: 15, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.312 Vali Acc: 0.878 Test Loss: 0.312 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.130990982055664
Epoch: 16, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1849148273468018
Epoch: 17, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.289605140686035
Epoch: 18, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 2.3759758472442627
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2889668941497803
Epoch: 20, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 2.1593589782714844
Epoch: 21, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.053812026977539
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3579752445220947
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.345 Vali Acc: 0.856 Test Loss: 0.345 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.3385231494903564
Epoch: 24, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.444 Vali Acc: 0.839 Test Loss: 0.444 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.138268232345581
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.415 Vali Acc: 0.839 Test Loss: 0.415 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.030647039413452
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.374 Vali Acc: 0.872 Test Loss: 0.374 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9862711429595947
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.715831995010376
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8560478687286377
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.356 Vali Acc: 0.883 Test Loss: 0.356 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9767391681671143
Epoch: 30, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.375 Vali Acc: 0.878 Test Loss: 0.375 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1563878
model size : 15.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1724793910980225
Epoch: 1, Steps: 12 | Train Loss: 1.496 Vali Loss: 0.946 Vali Acc: 0.694 Test Loss: 0.946 Test Acc: 0.694
Validation loss decreased (inf --> -0.694435).  Saving model ...
Epoch: 2 cost time: 2.0283071994781494
Epoch: 2, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.579 Vali Acc: 0.756 Test Loss: 0.579 Test Acc: 0.756
Validation loss decreased (-0.694435 --> -0.755550).  Saving model ...
Epoch: 3 cost time: 2.1111202239990234
Epoch: 3, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.399 Vali Acc: 0.789 Test Loss: 0.399 Test Acc: 0.789
Validation loss decreased (-0.755550 --> -0.788885).  Saving model ...
Epoch: 4 cost time: 2.1033880710601807
Epoch: 4, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.356 Vali Acc: 0.806 Test Loss: 0.356 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805552).  Saving model ...
Epoch: 5 cost time: 2.29870867729187
Epoch: 5, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 2.0675764083862305
Epoch: 6, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.428 Vali Acc: 0.789 Test Loss: 0.428 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1965088844299316
Epoch: 7, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.379 Vali Acc: 0.844 Test Loss: 0.379 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 1.9433138370513916
Epoch: 8, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 1.622770071029663
Epoch: 9, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.363 Vali Acc: 0.817 Test Loss: 0.363 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9330978393554688
Epoch: 10, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 1.816795825958252
Epoch: 11, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.320 Vali Acc: 0.867 Test Loss: 0.320 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866663).  Saving model ...
Epoch: 12 cost time: 2.042872428894043
Epoch: 12, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8197622299194336
Epoch: 13, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.480 Vali Acc: 0.806 Test Loss: 0.480 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8721742630004883
Epoch: 14, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.315 Vali Acc: 0.861 Test Loss: 0.315 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3743600845336914
Epoch: 15, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.329 Vali Acc: 0.872 Test Loss: 0.329 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 2.245573043823242
Epoch: 16, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 2.3262553215026855
Epoch: 17, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.361504077911377
Epoch: 18, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.160052537918091
Epoch: 19, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 2.306373119354248
Epoch: 20, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.377272605895996
Epoch: 21, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.332 Vali Acc: 0.872 Test Loss: 0.332 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.370729923248291
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.328886032104492
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.345 Vali Acc: 0.872 Test Loss: 0.345 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.5140671730041504
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.474 Vali Acc: 0.844 Test Loss: 0.474 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.638096809387207
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.3780946731567383
Epoch: 26, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.429 Vali Acc: 0.861 Test Loss: 0.429 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.2793142795562744
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.4193480014801025
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.297 Vali Acc: 0.883 Test Loss: 0.297 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.28591251373291
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.410 Vali Acc: 0.883 Test Loss: 0.410 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1563878
model size : 15.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.6478211879730225
Epoch: 1, Steps: 12 | Train Loss: 1.496 Vali Loss: 0.938 Vali Acc: 0.733 Test Loss: 0.938 Test Acc: 0.733
Validation loss decreased (inf --> -0.733324).  Saving model ...
Epoch: 2 cost time: 2.0851128101348877
Epoch: 2, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.583 Vali Acc: 0.756 Test Loss: 0.583 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755550).  Saving model ...
Epoch: 3 cost time: 2.259160041809082
Epoch: 3, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.405 Vali Acc: 0.783 Test Loss: 0.405 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 1.7411391735076904
Epoch: 4, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.354 Vali Acc: 0.811 Test Loss: 0.354 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811108).  Saving model ...
Epoch: 5 cost time: 1.8430964946746826
Epoch: 5, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.404 Vali Acc: 0.839 Test Loss: 0.404 Test Acc: 0.839
Validation loss decreased (-0.811108 --> -0.838885).  Saving model ...
Epoch: 6 cost time: 1.9375801086425781
Epoch: 6, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.440 Vali Acc: 0.794 Test Loss: 0.440 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8883376121520996
Epoch: 7, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.359 Vali Acc: 0.861 Test Loss: 0.359 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 2.3486685752868652
Epoch: 8, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 2.2654128074645996
Epoch: 9, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.348 Vali Acc: 0.839 Test Loss: 0.348 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2765724658966064
Epoch: 10, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 11 cost time: 2.3202154636383057
Epoch: 11, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3569228649139404
Epoch: 12, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.7611017227172852
Epoch: 13, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2001638412475586
Epoch: 14, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.171454906463623
Epoch: 15, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.377 Vali Acc: 0.872 Test Loss: 0.377 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1031785011291504
Epoch: 16, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.325 Vali Acc: 0.872 Test Loss: 0.325 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.206674814224243
Epoch: 17, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.281 Vali Acc: 0.861 Test Loss: 0.281 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1068665981292725
Epoch: 18, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.161813259124756
Epoch: 19, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.288 Vali Acc: 0.894 Test Loss: 0.288 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 2.1256792545318604
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1503007411956787
Epoch: 21, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.333 Vali Acc: 0.867 Test Loss: 0.333 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8203425407409668
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1269006729125977
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8448688983917236
Epoch: 24, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.050004482269287
Epoch: 25, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2619402408599854
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.353 Vali Acc: 0.878 Test Loss: 0.353 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.064528465270996
Epoch: 27, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.324 Vali Acc: 0.878 Test Loss: 0.324 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.134732246398926
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1399362087249756
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.373 Vali Acc: 0.867 Test Loss: 0.373 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1563878
model size : 15.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.514123916625977
Epoch: 1, Steps: 12 | Train Loss: 1.498 Vali Loss: 0.948 Vali Acc: 0.711 Test Loss: 0.948 Test Acc: 0.711
Validation loss decreased (inf --> -0.711102).  Saving model ...
Epoch: 2 cost time: 2.178903818130493
Epoch: 2, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.577 Vali Acc: 0.761 Test Loss: 0.577 Test Acc: 0.761
Validation loss decreased (-0.711102 --> -0.761105).  Saving model ...
Epoch: 3 cost time: 2.136688470840454
Epoch: 3, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.398 Vali Acc: 0.789 Test Loss: 0.398 Test Acc: 0.789
Validation loss decreased (-0.761105 --> -0.788885).  Saving model ...
Epoch: 4 cost time: 2.0386910438537598
Epoch: 4, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.349 Vali Acc: 0.817 Test Loss: 0.349 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 2.2573118209838867
Epoch: 5, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.375 Vali Acc: 0.856 Test Loss: 0.375 Test Acc: 0.856
Validation loss decreased (-0.816663 --> -0.855552).  Saving model ...
Epoch: 6 cost time: 2.0623221397399902
Epoch: 6, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.379 Vali Acc: 0.794 Test Loss: 0.379 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1197729110717773
Epoch: 7, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.406 Vali Acc: 0.839 Test Loss: 0.406 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3323352336883545
Epoch: 8, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.312 Vali Acc: 0.833 Test Loss: 0.312 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.11791729927063
Epoch: 9, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.365 Vali Acc: 0.828 Test Loss: 0.365 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8925325870513916
Epoch: 10, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.855552 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 1.9750349521636963
Epoch: 11, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.277 Vali Acc: 0.861 Test Loss: 0.277 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2655718326568604
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.257 Vali Acc: 0.872 Test Loss: 0.257 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1131622791290283
Epoch: 13, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7840816974639893
Epoch: 14, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.238027811050415
Epoch: 15, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1148271560668945
Epoch: 16, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.338 Vali Acc: 0.839 Test Loss: 0.338 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9222033023834229
Epoch: 17, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7014169692993164
Epoch: 18, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.106910467147827
Epoch: 19, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.3543689250946045
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1563878
model size : 15.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.412651777267456
Epoch: 1, Steps: 12 | Train Loss: 1.578 Vali Loss: 0.973 Vali Acc: 0.644 Test Loss: 0.973 Test Acc: 0.644
Validation loss decreased (inf --> -0.644435).  Saving model ...
Epoch: 2 cost time: 1.7686679363250732
Epoch: 2, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.608 Vali Acc: 0.694 Test Loss: 0.608 Test Acc: 0.694
Validation loss decreased (-0.644435 --> -0.694438).  Saving model ...
Epoch: 3 cost time: 1.864229440689087
Epoch: 3, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.462 Vali Acc: 0.761 Test Loss: 0.462 Test Acc: 0.761
Validation loss decreased (-0.694438 --> -0.761106).  Saving model ...
Epoch: 4 cost time: 1.742579698562622
Epoch: 4, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.392 Vali Acc: 0.806 Test Loss: 0.392 Test Acc: 0.806
Validation loss decreased (-0.761106 --> -0.805552).  Saving model ...
Epoch: 5 cost time: 1.802917242050171
Epoch: 5, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
Validation loss decreased (-0.805552 --> -0.888886).  Saving model ...
Epoch: 6 cost time: 1.7861716747283936
Epoch: 6, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.367 Vali Acc: 0.839 Test Loss: 0.367 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8081090450286865
Epoch: 7, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.386 Vali Acc: 0.817 Test Loss: 0.386 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6463708877563477
Epoch: 8, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7950563430786133
Epoch: 9, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.302 Vali Acc: 0.839 Test Loss: 0.302 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.802647352218628
Epoch: 10, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.381 Vali Acc: 0.844 Test Loss: 0.381 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9525892734527588
Epoch: 11, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.316 Vali Acc: 0.894 Test Loss: 0.316 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 12 cost time: 1.8862550258636475
Epoch: 12, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.393 Vali Acc: 0.850 Test Loss: 0.393 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.03579044342041
Epoch: 13, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.509 Vali Acc: 0.806 Test Loss: 0.509 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.11688494682312
Epoch: 14, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.493 Vali Acc: 0.828 Test Loss: 0.493 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1391983032226562
Epoch: 15, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8182094097137451
Epoch: 16, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.359 Vali Acc: 0.844 Test Loss: 0.359 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9380831718444824
Epoch: 17, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.402 Vali Acc: 0.839 Test Loss: 0.402 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.187828540802002
Epoch: 18, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.009516716003418
Epoch: 19, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0601372718811035
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.455 Vali Acc: 0.861 Test Loss: 0.455 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2233710289001465
Epoch: 21, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1432806
model size : 15.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.017821311950684
Epoch: 1, Steps: 12 | Train Loss: 1.571 Vali Loss: 0.968 Vali Acc: 0.650 Test Loss: 0.968 Test Acc: 0.650
Validation loss decreased (inf --> -0.649990).  Saving model ...
Epoch: 2 cost time: 2.587219715118408
Epoch: 2, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.610 Vali Acc: 0.689 Test Loss: 0.610 Test Acc: 0.689
Validation loss decreased (-0.649990 --> -0.688883).  Saving model ...
Epoch: 3 cost time: 2.3573856353759766
Epoch: 3, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.465 Vali Acc: 0.767 Test Loss: 0.465 Test Acc: 0.767
Validation loss decreased (-0.688883 --> -0.766662).  Saving model ...
Epoch: 4 cost time: 2.2316811084747314
Epoch: 4, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.390 Vali Acc: 0.822 Test Loss: 0.390 Test Acc: 0.822
Validation loss decreased (-0.766662 --> -0.822218).  Saving model ...
Epoch: 5 cost time: 2.146650552749634
Epoch: 5, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.341 Vali Acc: 0.878 Test Loss: 0.341 Test Acc: 0.878
Validation loss decreased (-0.822218 --> -0.877774).  Saving model ...
Epoch: 6 cost time: 2.1125571727752686
Epoch: 6, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.354 Vali Acc: 0.833 Test Loss: 0.354 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2992403507232666
Epoch: 7, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.397 Vali Acc: 0.811 Test Loss: 0.397 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9512619972229004
Epoch: 8, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1868717670440674
Epoch: 9, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.308 Vali Acc: 0.833 Test Loss: 0.308 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9591267108917236
Epoch: 10, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.391 Vali Acc: 0.856 Test Loss: 0.391 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1826515197753906
Epoch: 11, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.336 Vali Acc: 0.883 Test Loss: 0.336 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 1.9238207340240479
Epoch: 12, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.388 Vali Acc: 0.844 Test Loss: 0.388 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3473191261291504
Epoch: 13, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.525 Vali Acc: 0.806 Test Loss: 0.525 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0228657722473145
Epoch: 14, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.419 Vali Acc: 0.844 Test Loss: 0.419 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1512722969055176
Epoch: 15, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.352 Vali Acc: 0.850 Test Loss: 0.352 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0934791564941406
Epoch: 16, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9721102714538574
Epoch: 17, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.408 Vali Acc: 0.833 Test Loss: 0.408 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.772310733795166
Epoch: 18, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.154681444168091
Epoch: 19, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.318 Vali Acc: 0.872 Test Loss: 0.318 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.248734712600708
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.383 Vali Acc: 0.878 Test Loss: 0.383 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2536134719848633
Epoch: 21, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.349 Vali Acc: 0.878 Test Loss: 0.349 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1432806
model size : 15.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.821651935577393
Epoch: 1, Steps: 12 | Train Loss: 1.571 Vali Loss: 0.961 Vali Acc: 0.656 Test Loss: 0.961 Test Acc: 0.656
Validation loss decreased (inf --> -0.655546).  Saving model ...
Epoch: 2 cost time: 1.9240949153900146
Epoch: 2, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.605 Vali Acc: 0.694 Test Loss: 0.605 Test Acc: 0.694
Validation loss decreased (-0.655546 --> -0.694438).  Saving model ...
Epoch: 3 cost time: 2.1488873958587646
Epoch: 3, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.462 Vali Acc: 0.783 Test Loss: 0.462 Test Acc: 0.783
Validation loss decreased (-0.694438 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 2.1009671688079834
Epoch: 4, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.378 Vali Acc: 0.817 Test Loss: 0.378 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 1.99141263961792
Epoch: 5, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.335 Vali Acc: 0.828 Test Loss: 0.335 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 1.94846510887146
Epoch: 6, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.335 Vali Acc: 0.822 Test Loss: 0.335 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1898562908172607
Epoch: 7, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.441 Vali Acc: 0.800 Test Loss: 0.441 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2150087356567383
Epoch: 8, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 1.8687636852264404
Epoch: 9, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0069308280944824
Epoch: 10, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.423 Vali Acc: 0.856 Test Loss: 0.423 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.008347511291504
Epoch: 11, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.349 Vali Acc: 0.878 Test Loss: 0.349 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877774).  Saving model ...
Epoch: 12 cost time: 2.179744005203247
Epoch: 12, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.405 Vali Acc: 0.844 Test Loss: 0.405 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1376047134399414
Epoch: 13, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.461 Vali Acc: 0.817 Test Loss: 0.461 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.432953119277954
Epoch: 14, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.407 Vali Acc: 0.844 Test Loss: 0.407 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.148167371749878
Epoch: 15, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.314 Vali Acc: 0.872 Test Loss: 0.314 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9958751201629639
Epoch: 16, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.354 Vali Acc: 0.861 Test Loss: 0.354 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.520350933074951
Epoch: 17, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.417 Vali Acc: 0.839 Test Loss: 0.417 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4903366565704346
Epoch: 18, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.440 Vali Acc: 0.861 Test Loss: 0.440 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3047938346862793
Epoch: 19, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 2.2372477054595947
Epoch: 20, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.476 Vali Acc: 0.856 Test Loss: 0.476 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.469977617263794
Epoch: 21, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.363 Vali Acc: 0.867 Test Loss: 0.363 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.659269332885742
Epoch: 22, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.347 Vali Acc: 0.894 Test Loss: 0.347 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 23 cost time: 2.245124101638794
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.493 Vali Acc: 0.867 Test Loss: 0.493 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5830469131469727
Epoch: 24, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 25 cost time: 2.2992005348205566
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3505916595458984
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.359 Vali Acc: 0.867 Test Loss: 0.359 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.528021812438965
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.416011333465576
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.359 Vali Acc: 0.878 Test Loss: 0.359 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.1710591316223145
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 30 cost time: 2.2710931301116943
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.431 Vali Acc: 0.872 Test Loss: 0.431 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2760703563690186
Epoch: 31, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.372 Vali Acc: 0.906 Test Loss: 0.372 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.205322265625
Epoch: 32, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.203498601913452
Epoch: 33, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.355 Vali Acc: 0.878 Test Loss: 0.355 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.057246446609497
Epoch: 34, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.417 Vali Acc: 0.872 Test Loss: 0.417 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.9496309757232666
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.2930147647857666
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.181638240814209
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.401 Vali Acc: 0.883 Test Loss: 0.401 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.9634106159210205
Epoch: 38, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.512 Vali Acc: 0.878 Test Loss: 0.512 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.3961384296417236
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1432806
model size : 15.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.448180198669434
Epoch: 1, Steps: 12 | Train Loss: 1.562 Vali Loss: 0.959 Vali Acc: 0.700 Test Loss: 0.959 Test Acc: 0.700
Validation loss decreased (inf --> -0.699990).  Saving model ...
Epoch: 2 cost time: 1.8330497741699219
Epoch: 2, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.607 Vali Acc: 0.683 Test Loss: 0.607 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4996569156646729
Epoch: 3, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.455 Vali Acc: 0.767 Test Loss: 0.455 Test Acc: 0.767
Validation loss decreased (-0.699990 --> -0.766662).  Saving model ...
Epoch: 4 cost time: 1.6832802295684814
Epoch: 4, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.376 Vali Acc: 0.817 Test Loss: 0.376 Test Acc: 0.817
Validation loss decreased (-0.766662 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 1.6979031562805176
Epoch: 5, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 6 cost time: 1.6794724464416504
Epoch: 6, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6065120697021484
Epoch: 7, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.398 Vali Acc: 0.800 Test Loss: 0.398 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7581732273101807
Epoch: 8, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7940683364868164
Epoch: 9, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.287 Vali Acc: 0.833 Test Loss: 0.287 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 2.0424811840057373
Epoch: 10, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.371 Vali Acc: 0.856 Test Loss: 0.371 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 1.8151922225952148
Epoch: 11, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.318 Vali Acc: 0.867 Test Loss: 0.318 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 12 cost time: 1.6557323932647705
Epoch: 12, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9185824394226074
Epoch: 13, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.562 Vali Acc: 0.811 Test Loss: 0.562 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7608709335327148
Epoch: 14, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9001712799072266
Epoch: 15, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.511 Vali Acc: 0.806 Test Loss: 0.511 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.924593448638916
Epoch: 16, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.310 Vali Acc: 0.883 Test Loss: 0.310 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.8139026165008545
Epoch: 17, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.339 Vali Acc: 0.867 Test Loss: 0.339 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0025126934051514
Epoch: 18, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9447426795959473
Epoch: 19, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.322 Vali Acc: 0.878 Test Loss: 0.322 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9798591136932373
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 21 cost time: 2.0163955688476562
Epoch: 21, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.375 Vali Acc: 0.850 Test Loss: 0.375 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0827085971832275
Epoch: 22, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8097212314605713
Epoch: 23, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8395144939422607
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7840111255645752
Epoch: 25, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.329 Vali Acc: 0.883 Test Loss: 0.329 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6374907493591309
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.372 Vali Acc: 0.856 Test Loss: 0.372 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9220857620239258
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7706568241119385
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.314 Vali Acc: 0.872 Test Loss: 0.314 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.175917387008667
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.360 Vali Acc: 0.878 Test Loss: 0.360 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.1932411193847656
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.344 Vali Acc: 0.878 Test Loss: 0.344 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1432806
model size : 15.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.421690464019775
Epoch: 1, Steps: 12 | Train Loss: 1.577 Vali Loss: 1.234 Vali Acc: 0.572 Test Loss: 1.234 Test Acc: 0.572
Validation loss decreased (inf --> -0.572210).  Saving model ...
Epoch: 2 cost time: 1.8366127014160156
Epoch: 2, Steps: 12 | Train Loss: 0.980 Vali Loss: 0.737 Vali Acc: 0.717 Test Loss: 0.737 Test Acc: 0.717
Validation loss decreased (-0.572210 --> -0.716659).  Saving model ...
Epoch: 3 cost time: 1.9074809551239014
Epoch: 3, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.581 Vali Acc: 0.711 Test Loss: 0.581 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6652107238769531
Epoch: 4, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.475 Vali Acc: 0.750 Test Loss: 0.475 Test Acc: 0.750
Validation loss decreased (-0.716659 --> -0.749995).  Saving model ...
Epoch: 5 cost time: 1.7250981330871582
Epoch: 5, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.402 Vali Acc: 0.800 Test Loss: 0.402 Test Acc: 0.800
Validation loss decreased (-0.749995 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 1.8362295627593994
Epoch: 6, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.402 Vali Acc: 0.778 Test Loss: 0.402 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.676147222518921
Epoch: 7, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.434 Vali Acc: 0.817 Test Loss: 0.434 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816662).  Saving model ...
Epoch: 8 cost time: 1.5880355834960938
Epoch: 8, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.352 Vali Acc: 0.856 Test Loss: 0.352 Test Acc: 0.856
Validation loss decreased (-0.816662 --> -0.855552).  Saving model ...
Epoch: 9 cost time: 2.0047671794891357
Epoch: 9, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.333 Vali Acc: 0.844 Test Loss: 0.333 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6813907623291016
Epoch: 10, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8780477046966553
Epoch: 11, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.372 Vali Acc: 0.817 Test Loss: 0.372 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6747026443481445
Epoch: 12, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.9066627025604248
Epoch: 13, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.98191237449646
Epoch: 14, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9415619373321533
Epoch: 15, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 1.8329219818115234
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8756012916564941
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.658259630203247
Epoch: 18, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.329 Vali Acc: 0.856 Test Loss: 0.329 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7407195568084717
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5053603649139404
Epoch: 20, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5578265190124512
Epoch: 21, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4817984104156494
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7062432765960693
Epoch: 23, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6291370391845703
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 1.5631589889526367
Epoch: 25, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.350 Vali Acc: 0.850 Test Loss: 0.350 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8455369472503662
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7824656963348389
Epoch: 27, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.322 Vali Acc: 0.867 Test Loss: 0.322 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6659271717071533
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8706352710723877
Epoch: 29, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.310 Vali Acc: 0.894 Test Loss: 0.310 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7939646244049072
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.749713659286499
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.8525805473327637
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.8660321235656738
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 34 cost time: 1.781341552734375
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.449 Vali Acc: 0.878 Test Loss: 0.449 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7788376808166504
Epoch: 35, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.7865431308746338
Epoch: 36, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.8956220149993896
Epoch: 37, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 38 cost time: 1.6494441032409668
Epoch: 38, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.284 Vali Acc: 0.922 Test Loss: 0.284 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922219).  Saving model ...
Epoch: 39 cost time: 1.5113780498504639
Epoch: 39, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.7247178554534912
Epoch: 40, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7108120918273926
Epoch: 41, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.8177480697631836
Epoch: 42, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.754192590713501
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.351 Vali Acc: 0.894 Test Loss: 0.351 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.4368140697479248
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.317 Vali Acc: 0.911 Test Loss: 0.317 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.9420909881591797
Epoch: 45, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.381 Vali Acc: 0.867 Test Loss: 0.381 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.9689161777496338
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.8698983192443848
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.314 Vali Acc: 0.906 Test Loss: 0.314 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.9788281917572021
Epoch: 48, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.343 Vali Acc: 0.906 Test Loss: 0.343 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2485990
model size : 14.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.973975896835327
Epoch: 1, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.229 Vali Acc: 0.594 Test Loss: 1.229 Test Acc: 0.594
Validation loss decreased (inf --> -0.594432).  Saving model ...
Epoch: 2 cost time: 1.856130599975586
Epoch: 2, Steps: 12 | Train Loss: 0.972 Vali Loss: 0.739 Vali Acc: 0.733 Test Loss: 0.739 Test Acc: 0.733
Validation loss decreased (-0.594432 --> -0.733326).  Saving model ...
Epoch: 3 cost time: 1.7611415386199951
Epoch: 3, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7991271018981934
Epoch: 4, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.469 Vali Acc: 0.761 Test Loss: 0.469 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761106).  Saving model ...
Epoch: 5 cost time: 1.5884590148925781
Epoch: 5, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.398 Vali Acc: 0.806 Test Loss: 0.398 Test Acc: 0.806
Validation loss decreased (-0.761106 --> -0.805552).  Saving model ...
Epoch: 6 cost time: 1.9672088623046875
Epoch: 6, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.408 Vali Acc: 0.772 Test Loss: 0.408 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4457316398620605
Epoch: 7, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.437 Vali Acc: 0.806 Test Loss: 0.437 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8459153175354004
Epoch: 8, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.354 Vali Acc: 0.844 Test Loss: 0.354 Test Acc: 0.844
Validation loss decreased (-0.805552 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 1.6917922496795654
Epoch: 9, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 1.836904525756836
Epoch: 10, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.9143753051757812
Epoch: 11, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.365 Vali Acc: 0.817 Test Loss: 0.365 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9812884330749512
Epoch: 12, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.297 Vali Acc: 0.872 Test Loss: 0.297 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 1.8613340854644775
Epoch: 13, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8938755989074707
Epoch: 14, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.893873691558838
Epoch: 15, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 16 cost time: 1.5534348487854004
Epoch: 16, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.6395447254180908
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5646991729736328
Epoch: 18, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.336 Vali Acc: 0.850 Test Loss: 0.336 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.810715913772583
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.819871187210083
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7564897537231445
Epoch: 21, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.315 Vali Acc: 0.856 Test Loss: 0.315 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5815918445587158
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7568833827972412
Epoch: 23, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6343238353729248
Epoch: 24, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 25 cost time: 1.634878396987915
Epoch: 25, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.376 Vali Acc: 0.844 Test Loss: 0.376 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.665419578552246
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.321 Vali Acc: 0.878 Test Loss: 0.321 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7113115787506104
Epoch: 27, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7089364528656006
Epoch: 28, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7886862754821777
Epoch: 29, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8659610748291016
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.1123242378234863
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.8550467491149902
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.7891473770141602
Epoch: 33, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.901702880859375
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7347667217254639
Epoch: 35, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.9179203510284424
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.568 Vali Acc: 0.844 Test Loss: 0.568 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.9172821044921875
Epoch: 37, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.6488220691680908
Epoch: 38, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.317 Vali Acc: 0.906 Test Loss: 0.317 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.8544249534606934
Epoch: 39, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.302 Vali Acc: 0.911 Test Loss: 0.302 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.9564416408538818
Epoch: 40, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.929201364517212
Epoch: 41, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.692842721939087
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 2485990
model size : 14.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.119395971298218
Epoch: 1, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.227 Vali Acc: 0.606 Test Loss: 1.227 Test Acc: 0.606
Validation loss decreased (inf --> -0.605543).  Saving model ...
Epoch: 2 cost time: 2.058643341064453
Epoch: 2, Steps: 12 | Train Loss: 0.956 Vali Loss: 0.733 Vali Acc: 0.700 Test Loss: 0.733 Test Acc: 0.700
Validation loss decreased (-0.605543 --> -0.699993).  Saving model ...
Epoch: 3 cost time: 1.6735632419586182
Epoch: 3, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.567 Vali Acc: 0.717 Test Loss: 0.567 Test Acc: 0.717
Validation loss decreased (-0.699993 --> -0.716661).  Saving model ...
Epoch: 4 cost time: 2.0002493858337402
Epoch: 4, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.474 Vali Acc: 0.761 Test Loss: 0.474 Test Acc: 0.761
Validation loss decreased (-0.716661 --> -0.761106).  Saving model ...
Epoch: 5 cost time: 1.8797495365142822
Epoch: 5, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.392 Vali Acc: 0.806 Test Loss: 0.392 Test Acc: 0.806
Validation loss decreased (-0.761106 --> -0.805552).  Saving model ...
Epoch: 6 cost time: 1.757575511932373
Epoch: 6, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.414 Vali Acc: 0.761 Test Loss: 0.414 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.793513536453247
Epoch: 7, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.428 Vali Acc: 0.806 Test Loss: 0.428 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8046355247497559
Epoch: 8, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
Validation loss decreased (-0.805552 --> -0.855552).  Saving model ...
Epoch: 9 cost time: 1.7882544994354248
Epoch: 9, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.328 Vali Acc: 0.844 Test Loss: 0.328 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7234292030334473
Epoch: 10, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7288410663604736
Epoch: 11, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8588175773620605
Epoch: 12, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 1.7993674278259277
Epoch: 13, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 14 cost time: 2.0666255950927734
Epoch: 14, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.061424970626831
Epoch: 15, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.283 Vali Acc: 0.894 Test Loss: 0.283 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 1.911616325378418
Epoch: 16, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9463841915130615
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9468302726745605
Epoch: 18, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.325 Vali Acc: 0.850 Test Loss: 0.325 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8177642822265625
Epoch: 19, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 1.9443645477294922
Epoch: 20, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7859752178192139
Epoch: 21, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.309 Vali Acc: 0.872 Test Loss: 0.309 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7356691360473633
Epoch: 22, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.21384334564209
Epoch: 23, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.357 Vali Acc: 0.878 Test Loss: 0.357 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8081903457641602
Epoch: 24, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 25 cost time: 1.6983699798583984
Epoch: 25, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9925055503845215
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.349 Vali Acc: 0.872 Test Loss: 0.349 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7854244709014893
Epoch: 27, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5418980121612549
Epoch: 28, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9339988231658936
Epoch: 29, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.355 Vali Acc: 0.894 Test Loss: 0.355 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.875173568725586
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.318 Vali Acc: 0.906 Test Loss: 0.318 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6914942264556885
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.7793681621551514
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 33 cost time: 1.6251401901245117
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.7174088954925537
Epoch: 34, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.469 Vali Acc: 0.878 Test Loss: 0.469 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.9791922569274902
Epoch: 35, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.0675203800201416
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.429 Vali Acc: 0.856 Test Loss: 0.429 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.9656331539154053
Epoch: 37, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.378 Vali Acc: 0.922 Test Loss: 0.378 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922218).  Saving model ...
Epoch: 38 cost time: 1.7948615550994873
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.388 Vali Acc: 0.917 Test Loss: 0.388 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.9139587879180908
Epoch: 39, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7489619255065918
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.288857936859131
Epoch: 41, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.371 Vali Acc: 0.906 Test Loss: 0.371 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.1086630821228027
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.343 Vali Acc: 0.911 Test Loss: 0.343 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.1169586181640625
Epoch: 43, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.389 Vali Acc: 0.911 Test Loss: 0.389 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.956092119216919
Epoch: 44, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 45 cost time: 2.2920291423797607
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.058159589767456
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.340 Vali Acc: 0.894 Test Loss: 0.340 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.0332398414611816
Epoch: 47, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.915449619293213
Epoch: 48, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.373 Vali Acc: 0.906 Test Loss: 0.373 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.264007568359375
Epoch: 49, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.825676679611206
Epoch: 50, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.1136064529418945
Epoch: 51, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.356 Vali Acc: 0.906 Test Loss: 0.356 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.0322890281677246
Epoch: 52, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.1615114212036133
Epoch: 53, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.327 Vali Acc: 0.911 Test Loss: 0.327 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.1853790283203125
Epoch: 54, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2485990
model size : 14.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.510309934616089
Epoch: 1, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.233 Vali Acc: 0.633 Test Loss: 1.233 Test Acc: 0.633
Validation loss decreased (inf --> -0.633321).  Saving model ...
Epoch: 2 cost time: 1.695451259613037
Epoch: 2, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.730 Vali Acc: 0.700 Test Loss: 0.730 Test Acc: 0.700
Validation loss decreased (-0.633321 --> -0.699993).  Saving model ...
Epoch: 3 cost time: 1.8895561695098877
Epoch: 3, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.550 Vali Acc: 0.728 Test Loss: 0.550 Test Acc: 0.728
Validation loss decreased (-0.699993 --> -0.727772).  Saving model ...
Epoch: 4 cost time: 1.9144532680511475
Epoch: 4, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.449 Vali Acc: 0.800 Test Loss: 0.449 Test Acc: 0.800
Validation loss decreased (-0.727772 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 2.0692665576934814
Epoch: 5, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 1.757103443145752
Epoch: 6, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.376 Vali Acc: 0.806 Test Loss: 0.376 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9837141036987305
Epoch: 7, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.406 Vali Acc: 0.806 Test Loss: 0.406 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7709722518920898
Epoch: 8, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.318 Vali Acc: 0.833 Test Loss: 0.318 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.8496625423431396
Epoch: 9, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.303 Vali Acc: 0.856 Test Loss: 0.303 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855553).  Saving model ...
Epoch: 10 cost time: 1.944939136505127
Epoch: 10, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8180723190307617
Epoch: 11, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.318 Vali Acc: 0.839 Test Loss: 0.318 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6568048000335693
Epoch: 12, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 1.6310992240905762
Epoch: 13, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.296 Vali Acc: 0.850 Test Loss: 0.296 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6741409301757812
Epoch: 14, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 1.6932013034820557
Epoch: 15, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.717022180557251
Epoch: 16, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.361 Vali Acc: 0.850 Test Loss: 0.361 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6841847896575928
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6820857524871826
Epoch: 18, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.375 Vali Acc: 0.872 Test Loss: 0.375 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872218).  Saving model ...
Epoch: 19 cost time: 1.6949996948242188
Epoch: 19, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.245 Vali Acc: 0.878 Test Loss: 0.245 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 2.033399820327759
Epoch: 20, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.277 Vali Acc: 0.856 Test Loss: 0.277 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.035184621810913
Epoch: 21, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 1.8606619834899902
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899998).  Saving model ...
Epoch: 23 cost time: 2.1171488761901855
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.378 Vali Acc: 0.867 Test Loss: 0.378 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7728745937347412
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5874814987182617
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.614950180053711
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.390 Vali Acc: 0.906 Test Loss: 0.390 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905552).  Saving model ...
Epoch: 27 cost time: 1.6872527599334717
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.357 Vali Acc: 0.867 Test Loss: 0.357 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.651829719543457
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8236184120178223
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6267399787902832
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.672644853591919
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.359 Vali Acc: 0.883 Test Loss: 0.359 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.8792498111724854
Epoch: 32, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.5025696754455566
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6896617412567139
Epoch: 34, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.412 Vali Acc: 0.883 Test Loss: 0.412 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.924375295639038
Epoch: 35, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.364 Vali Acc: 0.906 Test Loss: 0.364 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905552).  Saving model ...
Epoch: 36 cost time: 1.9690093994140625
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.342 Vali Acc: 0.894 Test Loss: 0.342 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.681776523590088
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.305 Vali Acc: 0.883 Test Loss: 0.305 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.9007272720336914
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.8911340236663818
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.4768269062042236
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.7461786270141602
Epoch: 41, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 42 cost time: 1.7037384510040283
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.6531317234039307
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 44 cost time: 2.0020902156829834
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 45 cost time: 1.9145774841308594
Epoch: 45, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.8814983367919922
Epoch: 46, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.7307047843933105
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 48 cost time: 1.5761628150939941
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.7467222213745117
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.6993803977966309
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.7777199745178223
Epoch: 51, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.63895583152771
Epoch: 52, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.906 Test Loss: 0.247 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.7907416820526123
Epoch: 53, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.8728206157684326
Epoch: 54, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.8580224514007568
Epoch: 55, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.7382690906524658
Epoch: 56, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.7157776355743408
Epoch: 57, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2485990
model size : 14.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.271823167800903
Epoch: 1, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.311 Vali Acc: 0.539 Test Loss: 1.311 Test Acc: 0.539
Validation loss decreased (inf --> -0.538876).  Saving model ...
Epoch: 2 cost time: 1.6981558799743652
Epoch: 2, Steps: 12 | Train Loss: 1.069 Vali Loss: 0.728 Vali Acc: 0.717 Test Loss: 0.728 Test Acc: 0.717
Validation loss decreased (-0.538876 --> -0.716659).  Saving model ...
Epoch: 3 cost time: 1.7041776180267334
Epoch: 3, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.543 Vali Acc: 0.722 Test Loss: 0.543 Test Acc: 0.722
Validation loss decreased (-0.716659 --> -0.722217).  Saving model ...
Epoch: 4 cost time: 1.7476253509521484
Epoch: 4, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.456 Vali Acc: 0.783 Test Loss: 0.456 Test Acc: 0.783
Validation loss decreased (-0.722217 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 2.0444295406341553
Epoch: 5, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.375 Vali Acc: 0.817 Test Loss: 0.375 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 1.8905925750732422
Epoch: 6, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.352 Vali Acc: 0.850 Test Loss: 0.352 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849996).  Saving model ...
Epoch: 7 cost time: 1.8073222637176514
Epoch: 7, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.359 Vali Acc: 0.828 Test Loss: 0.359 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9284634590148926
Epoch: 8, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.375 Vali Acc: 0.828 Test Loss: 0.375 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8281633853912354
Epoch: 9, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.326 Vali Acc: 0.839 Test Loss: 0.326 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.785083293914795
Epoch: 10, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.327 Vali Acc: 0.850 Test Loss: 0.327 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 1.8261771202087402
Epoch: 11, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 1.5812923908233643
Epoch: 12, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.324 Vali Acc: 0.844 Test Loss: 0.324 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7869229316711426
Epoch: 13, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.399 Vali Acc: 0.844 Test Loss: 0.399 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6573667526245117
Epoch: 14, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.336 Vali Acc: 0.878 Test Loss: 0.336 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877774).  Saving model ...
Epoch: 15 cost time: 1.5888988971710205
Epoch: 15, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6907374858856201
Epoch: 16, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.6496326923370361
Epoch: 17, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.277 Vali Acc: 0.856 Test Loss: 0.277 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7599925994873047
Epoch: 18, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.863542079925537
Epoch: 19, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 2.077975273132324
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9234390258789062
Epoch: 21, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.7438552379608154
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7032017707824707
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.352 Vali Acc: 0.844 Test Loss: 0.352 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6623926162719727
Epoch: 24, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.610 Vali Acc: 0.811 Test Loss: 0.610 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5721142292022705
Epoch: 25, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.421 Vali Acc: 0.844 Test Loss: 0.421 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6815719604492188
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.618882656097412
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.364 Vali Acc: 0.856 Test Loss: 0.364 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7384545803070068
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.544372797012329
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.8165512084960938
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6239795684814453
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1437414
model size : 10.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.987567901611328
Epoch: 1, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.299 Vali Acc: 0.550 Test Loss: 1.299 Test Acc: 0.550
Validation loss decreased (inf --> -0.549987).  Saving model ...
Epoch: 2 cost time: 1.623617172241211
Epoch: 2, Steps: 12 | Train Loss: 1.053 Vali Loss: 0.720 Vali Acc: 0.717 Test Loss: 0.720 Test Acc: 0.717
Validation loss decreased (-0.549987 --> -0.716659).  Saving model ...
Epoch: 3 cost time: 1.6906616687774658
Epoch: 3, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.543 Vali Acc: 0.722 Test Loss: 0.543 Test Acc: 0.722
Validation loss decreased (-0.716659 --> -0.722217).  Saving model ...
Epoch: 4 cost time: 1.7030906677246094
Epoch: 4, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.455 Vali Acc: 0.794 Test Loss: 0.455 Test Acc: 0.794
Validation loss decreased (-0.722217 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 1.9098820686340332
Epoch: 5, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.377 Vali Acc: 0.828 Test Loss: 0.377 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 1.803419828414917
Epoch: 6, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.349 Vali Acc: 0.856 Test Loss: 0.349 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 1.6795799732208252
Epoch: 7, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.353 Vali Acc: 0.828 Test Loss: 0.353 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.723327398300171
Epoch: 8, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.381 Vali Acc: 0.822 Test Loss: 0.381 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5261931419372559
Epoch: 9, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.325 Vali Acc: 0.839 Test Loss: 0.325 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6774730682373047
Epoch: 10, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.331 Vali Acc: 0.872 Test Loss: 0.331 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 1.6587119102478027
Epoch: 11, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 1.5790214538574219
Epoch: 12, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4845049381256104
Epoch: 13, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.395 Vali Acc: 0.856 Test Loss: 0.395 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.479541540145874
Epoch: 14, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.336 Vali Acc: 0.878 Test Loss: 0.336 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6776301860809326
Epoch: 15, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.281 Vali Acc: 0.861 Test Loss: 0.281 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.404555082321167
Epoch: 16, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.4963068962097168
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.274 Vali Acc: 0.856 Test Loss: 0.274 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5946691036224365
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.419144630432129
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6786108016967773
Epoch: 20, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6087005138397217
Epoch: 21, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 1.7185256481170654
Epoch: 22, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8613519668579102
Epoch: 23, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.416 Vali Acc: 0.828 Test Loss: 0.416 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4927103519439697
Epoch: 24, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.690 Vali Acc: 0.806 Test Loss: 0.690 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.530369758605957
Epoch: 25, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.517 Vali Acc: 0.833 Test Loss: 0.517 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6471326351165771
Epoch: 26, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.895491123199463
Epoch: 27, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4117710590362549
Epoch: 28, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.307 Vali Acc: 0.894 Test Loss: 0.307 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.654470682144165
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5442020893096924
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.453035593032837
Epoch: 31, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1437414
model size : 10.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.039072036743164
Epoch: 1, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.279 Vali Acc: 0.556 Test Loss: 1.279 Test Acc: 0.556
Validation loss decreased (inf --> -0.555543).  Saving model ...
Epoch: 2 cost time: 1.8878662586212158
Epoch: 2, Steps: 12 | Train Loss: 1.043 Vali Loss: 0.704 Vali Acc: 0.728 Test Loss: 0.704 Test Acc: 0.728
Validation loss decreased (-0.555543 --> -0.727771).  Saving model ...
Epoch: 3 cost time: 1.8528237342834473
Epoch: 3, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.535 Vali Acc: 0.722 Test Loss: 0.535 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7510578632354736
Epoch: 4, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.443 Vali Acc: 0.811 Test Loss: 0.443 Test Acc: 0.811
Validation loss decreased (-0.727771 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 1.7775721549987793
Epoch: 5, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.370 Vali Acc: 0.828 Test Loss: 0.370 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 1.6457817554473877
Epoch: 6, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.342 Vali Acc: 0.850 Test Loss: 0.342 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 7 cost time: 1.5971596240997314
Epoch: 7, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6661913394927979
Epoch: 8, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.388 Vali Acc: 0.817 Test Loss: 0.388 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6817703247070312
Epoch: 9, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5195815563201904
Epoch: 10, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.332 Vali Acc: 0.883 Test Loss: 0.332 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 11 cost time: 1.827599048614502
Epoch: 11, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.316 Vali Acc: 0.878 Test Loss: 0.316 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.819364309310913
Epoch: 12, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.316 Vali Acc: 0.844 Test Loss: 0.316 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7401387691497803
Epoch: 13, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.414 Vali Acc: 0.839 Test Loss: 0.414 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7486011981964111
Epoch: 14, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.335 Vali Acc: 0.867 Test Loss: 0.335 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.007383108139038
Epoch: 15, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8244044780731201
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.321 Vali Acc: 0.872 Test Loss: 0.321 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9126389026641846
Epoch: 17, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.308 Vali Acc: 0.883 Test Loss: 0.308 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 1.7754626274108887
Epoch: 18, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 1.843132495880127
Epoch: 19, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7950184345245361
Epoch: 20, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.775097131729126
Epoch: 21, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5901367664337158
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6160266399383545
Epoch: 23, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7642004489898682
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.692 Vali Acc: 0.817 Test Loss: 0.692 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6642417907714844
Epoch: 25, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.369 Vali Acc: 0.861 Test Loss: 0.369 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.719038963317871
Epoch: 26, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.312 Vali Acc: 0.894 Test Loss: 0.312 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7008373737335205
Epoch: 27, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6279687881469727
Epoch: 28, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1437414
model size : 10.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8152341842651367
Epoch: 1, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.274 Vali Acc: 0.622 Test Loss: 1.274 Test Acc: 0.622
Validation loss decreased (inf --> -0.622209).  Saving model ...
Epoch: 2 cost time: 1.8063628673553467
Epoch: 2, Steps: 12 | Train Loss: 1.026 Vali Loss: 0.705 Vali Acc: 0.744 Test Loss: 0.705 Test Acc: 0.744
Validation loss decreased (-0.622209 --> -0.744437).  Saving model ...
Epoch: 3 cost time: 1.8508059978485107
Epoch: 3, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.522 Vali Acc: 0.744 Test Loss: 0.522 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744439).  Saving model ...
Epoch: 4 cost time: 1.739532709121704
Epoch: 4, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.420 Vali Acc: 0.806 Test Loss: 0.420 Test Acc: 0.806
Validation loss decreased (-0.744439 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 1.6317174434661865
Epoch: 5, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.350 Vali Acc: 0.817 Test Loss: 0.350 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 1.780571460723877
Epoch: 6, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 1.6407380104064941
Epoch: 7, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.328 Vali Acc: 0.833 Test Loss: 0.328 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.641200065612793
Epoch: 8, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.371 Vali Acc: 0.817 Test Loss: 0.371 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.640702724456787
Epoch: 9, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855553).  Saving model ...
Epoch: 10 cost time: 1.79062819480896
Epoch: 10, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.624682903289795
Epoch: 11, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.298 Vali Acc: 0.839 Test Loss: 0.298 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.699960708618164
Epoch: 12, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 1.6176550388336182
Epoch: 13, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6587810516357422
Epoch: 14, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6155638694763184
Epoch: 15, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.284 Vali Acc: 0.839 Test Loss: 0.284 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6343708038330078
Epoch: 16, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7445573806762695
Epoch: 17, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.634622573852539
Epoch: 18, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.779142141342163
Epoch: 19, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.435 Vali Acc: 0.861 Test Loss: 0.435 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6540412902832031
Epoch: 20, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8235859870910645
Epoch: 21, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.670536756515503
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.311 Vali Acc: 0.867 Test Loss: 0.311 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6733498573303223
Epoch: 23, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 1.6527619361877441
Epoch: 24, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.801 Vali Acc: 0.811 Test Loss: 0.801 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.754711389541626
Epoch: 25, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7639248371124268
Epoch: 26, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6221046447753906
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.697145938873291
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.315 Vali Acc: 0.878 Test Loss: 0.315 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6814343929290771
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.347 Vali Acc: 0.872 Test Loss: 0.347 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6270561218261719
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5655581951141357
Epoch: 31, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.422 Vali Acc: 0.878 Test Loss: 0.422 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6879267692565918
Epoch: 32, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7380876541137695
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1437414
model size : 10.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.516954183578491
Epoch: 1, Steps: 12 | Train Loss: 1.692 Vali Loss: 1.223 Vali Acc: 0.617 Test Loss: 1.223 Test Acc: 0.617
Validation loss decreased (inf --> -0.616654).  Saving model ...
Epoch: 2 cost time: 1.4679629802703857
Epoch: 2, Steps: 12 | Train Loss: 0.942 Vali Loss: 0.726 Vali Acc: 0.672 Test Loss: 0.726 Test Acc: 0.672
Validation loss decreased (-0.616654 --> -0.672215).  Saving model ...
Epoch: 3 cost time: 1.859640121459961
Epoch: 3, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.566 Vali Acc: 0.711 Test Loss: 0.566 Test Acc: 0.711
Validation loss decreased (-0.672215 --> -0.711105).  Saving model ...
Epoch: 4 cost time: 1.6830322742462158
Epoch: 4, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.427 Vali Acc: 0.789 Test Loss: 0.427 Test Acc: 0.789
Validation loss decreased (-0.711105 --> -0.788885).  Saving model ...
Epoch: 5 cost time: 1.791076898574829
Epoch: 5, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.404 Vali Acc: 0.833 Test Loss: 0.404 Test Acc: 0.833
Validation loss decreased (-0.788885 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 1.8510563373565674
Epoch: 6, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.991004467010498
Epoch: 7, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
Validation loss decreased (-0.833329 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 1.9516048431396484
Epoch: 8, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.343 Vali Acc: 0.856 Test Loss: 0.343 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8460619449615479
Epoch: 9, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8163669109344482
Epoch: 10, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.378 Vali Acc: 0.806 Test Loss: 0.378 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9082942008972168
Epoch: 11, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.437 Vali Acc: 0.811 Test Loss: 0.437 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8268554210662842
Epoch: 12, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.367 Vali Acc: 0.856 Test Loss: 0.367 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0921597480773926
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.277 Vali Acc: 0.894 Test Loss: 0.277 Test Acc: 0.894
Validation loss decreased (-0.855552 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 1.9214558601379395
Epoch: 14, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.665684461593628
Epoch: 15, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8282482624053955
Epoch: 16, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.950958490371704
Epoch: 17, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7883241176605225
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.297 Vali Acc: 0.872 Test Loss: 0.297 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7261333465576172
Epoch: 19, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7436039447784424
Epoch: 20, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 1.8160295486450195
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.76792573928833
Epoch: 22, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6861193180084229
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0477120876312256
Epoch: 24, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.805213212966919
Epoch: 25, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8755152225494385
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 27 cost time: 1.755539894104004
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7006480693817139
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.376 Vali Acc: 0.844 Test Loss: 0.376 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.0160999298095703
Epoch: 29, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 2.0108485221862793
Epoch: 30, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0494751930236816
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.205634117126465
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.083111524581909
Epoch: 33, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.1099960803985596
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.404175043106079
Epoch: 35, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.0912625789642334
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.1862359046936035
Epoch: 37, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.9658639430999756
Epoch: 38, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.317 Vali Acc: 0.872 Test Loss: 0.317 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.9642863273620605
Epoch: 39, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.338 Vali Acc: 0.878 Test Loss: 0.338 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 913126
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.394783020019531
Epoch: 1, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.217 Vali Acc: 0.600 Test Loss: 1.217 Test Acc: 0.600
Validation loss decreased (inf --> -0.599988).  Saving model ...
Epoch: 2 cost time: 1.7345969676971436
Epoch: 2, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.719 Vali Acc: 0.689 Test Loss: 0.719 Test Acc: 0.689
Validation loss decreased (-0.599988 --> -0.688882).  Saving model ...
Epoch: 3 cost time: 1.6573054790496826
Epoch: 3, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.564 Vali Acc: 0.711 Test Loss: 0.564 Test Acc: 0.711
Validation loss decreased (-0.688882 --> -0.711105).  Saving model ...
Epoch: 4 cost time: 1.8382010459899902
Epoch: 4, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.427 Vali Acc: 0.778 Test Loss: 0.427 Test Acc: 0.778
Validation loss decreased (-0.711105 --> -0.777774).  Saving model ...
Epoch: 5 cost time: 1.8928558826446533
Epoch: 5, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.393 Vali Acc: 0.844 Test Loss: 0.393 Test Acc: 0.844
Validation loss decreased (-0.777774 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.6380608081817627
Epoch: 6, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.84452486038208
Epoch: 7, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 1.8109638690948486
Epoch: 8, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.342 Vali Acc: 0.850 Test Loss: 0.342 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8268988132476807
Epoch: 9, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.320 Vali Acc: 0.833 Test Loss: 0.320 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7004945278167725
Epoch: 10, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.392 Vali Acc: 0.800 Test Loss: 0.392 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8070313930511475
Epoch: 11, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.463 Vali Acc: 0.811 Test Loss: 0.463 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6341948509216309
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.382 Vali Acc: 0.844 Test Loss: 0.382 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6697049140930176
Epoch: 13, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
Validation loss decreased (-0.855552 --> -0.899997).  Saving model ...
Epoch: 14 cost time: 1.721001386642456
Epoch: 14, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7990806102752686
Epoch: 15, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6552796363830566
Epoch: 16, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9498748779296875
Epoch: 17, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.300 Vali Acc: 0.872 Test Loss: 0.300 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8161983489990234
Epoch: 18, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.774346113204956
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.268 Vali Acc: 0.872 Test Loss: 0.268 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7870657444000244
Epoch: 20, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.673882007598877
Epoch: 21, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6981728076934814
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.390 Vali Acc: 0.844 Test Loss: 0.390 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4012949466705322
Epoch: 23, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 1.5925562381744385
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.351 Vali Acc: 0.872 Test Loss: 0.351 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8752877712249756
Epoch: 25, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.334 Vali Acc: 0.894 Test Loss: 0.334 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8576278686523438
Epoch: 26, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 1.8141138553619385
Epoch: 27, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8047246932983398
Epoch: 28, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6522209644317627
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.656113862991333
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.8606173992156982
Epoch: 31, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.7595453262329102
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.810837984085083
Epoch: 33, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.318 Vali Acc: 0.894 Test Loss: 0.318 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.815535306930542
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.7594430446624756
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.1148738861083984
Epoch: 36, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.310 Vali Acc: 0.878 Test Loss: 0.310 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 913126
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.275945663452148
Epoch: 1, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.214 Vali Acc: 0.633 Test Loss: 1.214 Test Acc: 0.633
Validation loss decreased (inf --> -0.633321).  Saving model ...
Epoch: 2 cost time: 1.6899583339691162
Epoch: 2, Steps: 12 | Train Loss: 0.944 Vali Loss: 0.716 Vali Acc: 0.689 Test Loss: 0.716 Test Acc: 0.689
Validation loss decreased (-0.633321 --> -0.688882).  Saving model ...
Epoch: 3 cost time: 1.8247385025024414
Epoch: 3, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
Validation loss decreased (-0.688882 --> -0.722217).  Saving model ...
Epoch: 4 cost time: 1.8883483409881592
Epoch: 4, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.424 Vali Acc: 0.783 Test Loss: 0.424 Test Acc: 0.783
Validation loss decreased (-0.722217 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 1.714301586151123
Epoch: 5, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.392 Vali Acc: 0.844 Test Loss: 0.392 Test Acc: 0.844
Validation loss decreased (-0.783329 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 2.184098720550537
Epoch: 6, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.357 Vali Acc: 0.817 Test Loss: 0.357 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9449405670166016
Epoch: 7, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.321 Vali Acc: 0.861 Test Loss: 0.321 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 2.040019989013672
Epoch: 8, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9619395732879639
Epoch: 9, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.313 Vali Acc: 0.839 Test Loss: 0.313 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9162657260894775
Epoch: 10, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.398 Vali Acc: 0.794 Test Loss: 0.398 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8218796253204346
Epoch: 11, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.459 Vali Acc: 0.811 Test Loss: 0.459 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8168058395385742
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9870121479034424
Epoch: 13, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 1.9881439208984375
Epoch: 14, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.91593337059021
Epoch: 15, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8130662441253662
Epoch: 16, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 1.6096413135528564
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5533185005187988
Epoch: 18, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.785996913909912
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8130710124969482
Epoch: 20, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7926387786865234
Epoch: 21, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.317 Vali Acc: 0.883 Test Loss: 0.317 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8079006671905518
Epoch: 22, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0522923469543457
Epoch: 23, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 1.9138259887695312
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.347 Vali Acc: 0.883 Test Loss: 0.347 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7862486839294434
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9579544067382812
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6417386531829834
Epoch: 27, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5760412216186523
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7024879455566406
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.777184009552002
Epoch: 30, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 31 cost time: 1.763129711151123
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.287 Vali Acc: 0.894 Test Loss: 0.287 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6598987579345703
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8478772640228271
Epoch: 33, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.311 Vali Acc: 0.894 Test Loss: 0.311 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8316402435302734
Epoch: 34, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.357 Vali Acc: 0.872 Test Loss: 0.357 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6934311389923096
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6109943389892578
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.376 Vali Acc: 0.867 Test Loss: 0.376 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.6707665920257568
Epoch: 37, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.6085443496704102
Epoch: 38, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.5994329452514648
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6389544010162354
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.317 Vali Acc: 0.872 Test Loss: 0.317 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 913126
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8004050254821777
Epoch: 1, Steps: 12 | Train Loss: 1.639 Vali Loss: 1.214 Vali Acc: 0.661 Test Loss: 1.214 Test Acc: 0.661
Validation loss decreased (inf --> -0.661099).  Saving model ...
Epoch: 2 cost time: 1.6657426357269287
Epoch: 2, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.695 Vali Acc: 0.683 Test Loss: 0.695 Test Acc: 0.683
Validation loss decreased (-0.661099 --> -0.683326).  Saving model ...
Epoch: 3 cost time: 1.6533052921295166
Epoch: 3, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.548 Vali Acc: 0.722 Test Loss: 0.548 Test Acc: 0.722
Validation loss decreased (-0.683326 --> -0.722217).  Saving model ...
Epoch: 4 cost time: 1.4310002326965332
Epoch: 4, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.408 Vali Acc: 0.789 Test Loss: 0.408 Test Acc: 0.789
Validation loss decreased (-0.722217 --> -0.788885).  Saving model ...
Epoch: 5 cost time: 1.549450159072876
Epoch: 5, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.385 Vali Acc: 0.844 Test Loss: 0.385 Test Acc: 0.844
Validation loss decreased (-0.788885 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.5161218643188477
Epoch: 6, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7885713577270508
Epoch: 7, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.296 Vali Acc: 0.850 Test Loss: 0.296 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 1.6453869342803955
Epoch: 8, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 9 cost time: 1.867138147354126
Epoch: 9, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.292 Vali Acc: 0.844 Test Loss: 0.292 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8970134258270264
Epoch: 10, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.359 Vali Acc: 0.817 Test Loss: 0.359 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6344728469848633
Epoch: 11, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.447 Vali Acc: 0.817 Test Loss: 0.447 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.695652723312378
Epoch: 12, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.396 Vali Acc: 0.822 Test Loss: 0.396 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8281023502349854
Epoch: 13, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.8690335750579834
Epoch: 14, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.284 Vali Acc: 0.850 Test Loss: 0.284 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.732290267944336
Epoch: 15, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8218739032745361
Epoch: 16, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.275 Vali Acc: 0.872 Test Loss: 0.275 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7491271495819092
Epoch: 17, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7818467617034912
Epoch: 18, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.264 Vali Acc: 0.861 Test Loss: 0.264 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9063918590545654
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.243 Vali Acc: 0.878 Test Loss: 0.243 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6420772075653076
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.237 Vali Acc: 0.878 Test Loss: 0.237 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6191596984863281
Epoch: 21, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.799318790435791
Epoch: 22, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7274112701416016
Epoch: 23, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.7125487327575684
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.324 Vali Acc: 0.878 Test Loss: 0.324 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5540351867675781
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.368 Vali Acc: 0.867 Test Loss: 0.368 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.89404296875
Epoch: 26, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 1.7921602725982666
Epoch: 27, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.811462640762329
Epoch: 28, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8818590641021729
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 30 cost time: 1.448350429534912
Epoch: 30, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 31 cost time: 1.55979585647583
Epoch: 31, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7123844623565674
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4961328506469727
Epoch: 33, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4628283977508545
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4617507457733154
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4651925563812256
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.356 Vali Acc: 0.867 Test Loss: 0.356 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5022037029266357
Epoch: 37, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.5105564594268799
Epoch: 38, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 39 cost time: 1.641172170639038
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.447007179260254
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.395 Vali Acc: 0.861 Test Loss: 0.395 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4632227420806885
Epoch: 41, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5471529960632324
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5888822078704834
Epoch: 43, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.588761568069458
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.6306941509246826
Epoch: 45, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.346 Vali Acc: 0.867 Test Loss: 0.346 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.5808899402618408
Epoch: 46, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.564033031463623
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.646052360534668
Epoch: 48, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 913126
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.755535840988159
Epoch: 1, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.247 Vali Acc: 0.600 Test Loss: 1.247 Test Acc: 0.600
Validation loss decreased (inf --> -0.599988).  Saving model ...
Epoch: 2 cost time: 1.4577140808105469
Epoch: 2, Steps: 12 | Train Loss: 0.958 Vali Loss: 0.771 Vali Acc: 0.683 Test Loss: 0.771 Test Acc: 0.683
Validation loss decreased (-0.599988 --> -0.683326).  Saving model ...
Epoch: 3 cost time: 1.4584712982177734
Epoch: 3, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.585 Vali Acc: 0.728 Test Loss: 0.585 Test Acc: 0.728
Validation loss decreased (-0.683326 --> -0.727772).  Saving model ...
Epoch: 4 cost time: 1.5563530921936035
Epoch: 4, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.453 Vali Acc: 0.783 Test Loss: 0.453 Test Acc: 0.783
Validation loss decreased (-0.727772 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 1.525587558746338
Epoch: 5, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.408 Vali Acc: 0.794 Test Loss: 0.408 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 1.6807670593261719
Epoch: 6, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.377 Vali Acc: 0.806 Test Loss: 0.377 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 7 cost time: 1.8007194995880127
Epoch: 7, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
Validation loss decreased (-0.805552 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 1.5964632034301758
Epoch: 8, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.332 Vali Acc: 0.833 Test Loss: 0.332 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6636698246002197
Epoch: 9, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.336 Vali Acc: 0.828 Test Loss: 0.336 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5693089962005615
Epoch: 10, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.6142897605895996
Epoch: 11, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4137797355651855
Epoch: 12, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6732256412506104
Epoch: 13, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.359 Vali Acc: 0.844 Test Loss: 0.359 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5177850723266602
Epoch: 14, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.824592113494873
Epoch: 15, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.403 Vali Acc: 0.817 Test Loss: 0.403 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9149608612060547
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.369 Vali Acc: 0.856 Test Loss: 0.369 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.747460126876831
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.329 Vali Acc: 0.844 Test Loss: 0.329 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7812044620513916
Epoch: 18, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.623241901397705
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 20 cost time: 1.5290932655334473
Epoch: 20, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.328 Vali Acc: 0.867 Test Loss: 0.328 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6937971115112305
Epoch: 21, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 22 cost time: 1.488037347793579
Epoch: 22, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 1.7619102001190186
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.371 Vali Acc: 0.872 Test Loss: 0.371 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5876750946044922
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.334 Vali Acc: 0.856 Test Loss: 0.334 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.68461275100708
Epoch: 25, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7822959423065186
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.343 Vali Acc: 0.861 Test Loss: 0.343 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8965637683868408
Epoch: 27, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7701611518859863
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 1.523883581161499
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.327 Vali Acc: 0.883 Test Loss: 0.327 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.642120361328125
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.346 Vali Acc: 0.856 Test Loss: 0.346 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.563220500946045
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7506895065307617
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 33 cost time: 1.423274278640747
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3506672382354736
Epoch: 34, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 35 cost time: 1.658623218536377
Epoch: 35, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.313 Vali Acc: 0.894 Test Loss: 0.313 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7642247676849365
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.6991727352142334
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.6926443576812744
Epoch: 38, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6430270671844482
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.6469457149505615
Epoch: 40, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.6515240669250488
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.5110249519348145
Epoch: 42, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.388 Vali Acc: 0.872 Test Loss: 0.388 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.5698561668395996
Epoch: 43, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.356 Vali Acc: 0.878 Test Loss: 0.356 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.4763164520263672
Epoch: 44, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 650982
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6474618911743164
Epoch: 1, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.243 Vali Acc: 0.606 Test Loss: 1.243 Test Acc: 0.606
Validation loss decreased (inf --> -0.605543).  Saving model ...
Epoch: 2 cost time: 1.5160186290740967
Epoch: 2, Steps: 12 | Train Loss: 0.938 Vali Loss: 0.767 Vali Acc: 0.694 Test Loss: 0.767 Test Acc: 0.694
Validation loss decreased (-0.605543 --> -0.694437).  Saving model ...
Epoch: 3 cost time: 1.6306917667388916
Epoch: 3, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.573 Vali Acc: 0.739 Test Loss: 0.573 Test Acc: 0.739
Validation loss decreased (-0.694437 --> -0.738883).  Saving model ...
Epoch: 4 cost time: 1.7613883018493652
Epoch: 4, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.445 Vali Acc: 0.800 Test Loss: 0.445 Test Acc: 0.800
Validation loss decreased (-0.738883 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 1.6697680950164795
Epoch: 5, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.405 Vali Acc: 0.806 Test Loss: 0.405 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 6 cost time: 1.7408065795898438
Epoch: 6, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.371 Vali Acc: 0.811 Test Loss: 0.371 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 1.8602724075317383
Epoch: 7, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 1.766535997390747
Epoch: 8, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.330 Vali Acc: 0.844 Test Loss: 0.330 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 1.7591407299041748
Epoch: 9, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.329 Vali Acc: 0.828 Test Loss: 0.329 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6629281044006348
Epoch: 10, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.6941494941711426
Epoch: 11, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.333 Vali Acc: 0.828 Test Loss: 0.333 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7689130306243896
Epoch: 12, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6484341621398926
Epoch: 13, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6602067947387695
Epoch: 14, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5333588123321533
Epoch: 15, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.414 Vali Acc: 0.817 Test Loss: 0.414 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6434111595153809
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5868861675262451
Epoch: 17, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.568253993988037
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7175748348236084
Epoch: 19, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 1.8510282039642334
Epoch: 20, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.361 Vali Acc: 0.861 Test Loss: 0.361 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9070305824279785
Epoch: 21, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 1.924729824066162
Epoch: 22, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7481615543365479
Epoch: 23, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.375 Vali Acc: 0.878 Test Loss: 0.375 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8059194087982178
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.322 Vali Acc: 0.867 Test Loss: 0.322 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7455837726593018
Epoch: 25, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8148527145385742
Epoch: 26, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.325 Vali Acc: 0.872 Test Loss: 0.325 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8027429580688477
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.310 Vali Acc: 0.878 Test Loss: 0.310 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6047546863555908
Epoch: 28, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.298 Vali Acc: 0.911 Test Loss: 0.298 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 29 cost time: 1.6992740631103516
Epoch: 29, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.329 Vali Acc: 0.872 Test Loss: 0.329 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5796878337860107
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.374 Vali Acc: 0.861 Test Loss: 0.374 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.712226152420044
Epoch: 31, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7654871940612793
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.299 Vali Acc: 0.911 Test Loss: 0.299 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.6242930889129639
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.327 Vali Acc: 0.894 Test Loss: 0.327 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.7759313583374023
Epoch: 34, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.9707412719726562
Epoch: 35, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.7097249031066895
Epoch: 36, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.5301227569580078
Epoch: 37, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.6185498237609863
Epoch: 38, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.6643612384796143
Epoch: 39, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8366267681121826
Epoch: 40, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7309978008270264
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.375 Vali Acc: 0.861 Test Loss: 0.375 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.8168129920959473
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.381 Vali Acc: 0.878 Test Loss: 0.381 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7737329006195068
Epoch: 43, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6222610473632812
Epoch: 44, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.318 Vali Acc: 0.894 Test Loss: 0.318 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.7298600673675537
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.659928321838379
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.5084764957427979
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.55934476852417
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 650982
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.683805227279663
Epoch: 1, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.255 Vali Acc: 0.589 Test Loss: 1.255 Test Acc: 0.589
Validation loss decreased (inf --> -0.588876).  Saving model ...
Epoch: 2 cost time: 1.618222951889038
Epoch: 2, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.763 Vali Acc: 0.694 Test Loss: 0.763 Test Acc: 0.694
Validation loss decreased (-0.588876 --> -0.694437).  Saving model ...
Epoch: 3 cost time: 1.7065620422363281
Epoch: 3, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.573 Vali Acc: 0.767 Test Loss: 0.573 Test Acc: 0.767
Validation loss decreased (-0.694437 --> -0.766661).  Saving model ...
Epoch: 4 cost time: 1.662994146347046
Epoch: 4, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.439 Vali Acc: 0.772 Test Loss: 0.439 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772218).  Saving model ...
Epoch: 5 cost time: 1.6241376399993896
Epoch: 5, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.405 Vali Acc: 0.794 Test Loss: 0.405 Test Acc: 0.794
Validation loss decreased (-0.772218 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 1.7800562381744385
Epoch: 6, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.372 Vali Acc: 0.794 Test Loss: 0.372 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794441).  Saving model ...
Epoch: 7 cost time: 1.5588829517364502
Epoch: 7, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.341 Vali Acc: 0.844 Test Loss: 0.341 Test Acc: 0.844
Validation loss decreased (-0.794441 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 1.448716640472412
Epoch: 8, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.326 Vali Acc: 0.828 Test Loss: 0.326 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5486905574798584
Epoch: 9, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5533580780029297
Epoch: 10, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.355 Vali Acc: 0.844 Test Loss: 0.355 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6704621315002441
Epoch: 11, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.344 Vali Acc: 0.833 Test Loss: 0.344 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8651783466339111
Epoch: 12, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
Validation loss decreased (-0.844441 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 1.776360034942627
Epoch: 13, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8017768859863281
Epoch: 14, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8321902751922607
Epoch: 15, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5034615993499756
Epoch: 16, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.465 Vali Acc: 0.817 Test Loss: 0.465 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5555553436279297
Epoch: 17, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.409 Vali Acc: 0.828 Test Loss: 0.409 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6850717067718506
Epoch: 18, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6314549446105957
Epoch: 19, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 1.5601544380187988
Epoch: 20, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6416070461273193
Epoch: 21, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 1.8433420658111572
Epoch: 22, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8235037326812744
Epoch: 23, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.395 Vali Acc: 0.872 Test Loss: 0.395 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.728353500366211
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.829704761505127
Epoch: 25, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 1.9731371402740479
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9125192165374756
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.301 Vali Acc: 0.894 Test Loss: 0.301 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7757625579833984
Epoch: 28, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.977799654006958
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4619290828704834
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.327 Vali Acc: 0.878 Test Loss: 0.327 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.6722629070281982
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.318 Vali Acc: 0.894 Test Loss: 0.318 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.521576166152954
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8889403343200684
Epoch: 33, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.402 Vali Acc: 0.889 Test Loss: 0.402 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8511357307434082
Epoch: 34, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 35 cost time: 1.586751937866211
Epoch: 35, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6256134510040283
Epoch: 36, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.359 Vali Acc: 0.867 Test Loss: 0.359 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.838942289352417
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.8214023113250732
Epoch: 38, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.5825865268707275
Epoch: 39, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.437 Vali Acc: 0.889 Test Loss: 0.437 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.7749953269958496
Epoch: 40, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.355 Vali Acc: 0.861 Test Loss: 0.355 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.9126713275909424
Epoch: 41, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.0654184818267822
Epoch: 42, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.8573808670043945
Epoch: 43, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 44 cost time: 1.661712646484375
Epoch: 44, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.495 Vali Acc: 0.889 Test Loss: 0.495 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6478924751281738
Epoch: 45, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.405 Vali Acc: 0.894 Test Loss: 0.405 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.7325870990753174
Epoch: 46, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.324 Vali Acc: 0.883 Test Loss: 0.324 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.7716248035430908
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.363 Vali Acc: 0.894 Test Loss: 0.363 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.7335419654846191
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.6806449890136719
Epoch: 49, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.335 Vali Acc: 0.906 Test Loss: 0.335 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.7001354694366455
Epoch: 50, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.5456197261810303
Epoch: 51, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.337 Vali Acc: 0.911 Test Loss: 0.337 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.6000521183013916
Epoch: 52, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.356 Vali Acc: 0.894 Test Loss: 0.356 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.636831521987915
Epoch: 53, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.463 Vali Acc: 0.889 Test Loss: 0.463 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 650982
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.219441175460815
Epoch: 1, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.245 Vali Acc: 0.622 Test Loss: 1.245 Test Acc: 0.622
Validation loss decreased (inf --> -0.622210).  Saving model ...
Epoch: 2 cost time: 1.7864325046539307
Epoch: 2, Steps: 12 | Train Loss: 0.927 Vali Loss: 0.739 Vali Acc: 0.711 Test Loss: 0.739 Test Acc: 0.711
Validation loss decreased (-0.622210 --> -0.711104).  Saving model ...
Epoch: 3 cost time: 1.6558952331542969
Epoch: 3, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.549 Vali Acc: 0.761 Test Loss: 0.549 Test Acc: 0.761
Validation loss decreased (-0.711104 --> -0.761106).  Saving model ...
Epoch: 4 cost time: 1.636641502380371
Epoch: 4, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.411 Vali Acc: 0.794 Test Loss: 0.411 Test Acc: 0.794
Validation loss decreased (-0.761106 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 1.5438144207000732
Epoch: 5, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.381 Vali Acc: 0.800 Test Loss: 0.381 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 1.6654057502746582
Epoch: 6, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.345 Vali Acc: 0.822 Test Loss: 0.345 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 1.804041862487793
Epoch: 7, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
Validation loss decreased (-0.822219 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 1.5739738941192627
Epoch: 8, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 9 cost time: 1.5772030353546143
Epoch: 9, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.288 Vali Acc: 0.839 Test Loss: 0.288 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8333230018615723
Epoch: 10, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.325 Vali Acc: 0.861 Test Loss: 0.325 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.5526423454284668
Epoch: 11, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.322 Vali Acc: 0.839 Test Loss: 0.322 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6873815059661865
Epoch: 12, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.621736764907837
Epoch: 13, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.356 Vali Acc: 0.828 Test Loss: 0.356 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5969133377075195
Epoch: 14, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5594561100006104
Epoch: 15, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.337 Vali Acc: 0.833 Test Loss: 0.337 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8194372653961182
Epoch: 16, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.351 Vali Acc: 0.844 Test Loss: 0.351 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6817626953125
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5937542915344238
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.85084867477417
Epoch: 19, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.238 Vali Acc: 0.883 Test Loss: 0.238 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 20 cost time: 1.8684759140014648
Epoch: 20, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.339 Vali Acc: 0.856 Test Loss: 0.339 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6783757209777832
Epoch: 21, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.276 Vali Acc: 0.867 Test Loss: 0.276 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7585875988006592
Epoch: 22, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 1.6527600288391113
Epoch: 23, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.320 Vali Acc: 0.878 Test Loss: 0.320 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4861619472503662
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4957795143127441
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7974531650543213
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.888221025466919
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6407835483551025
Epoch: 28, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.292 Vali Acc: 0.883 Test Loss: 0.292 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6515140533447266
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.298 Vali Acc: 0.878 Test Loss: 0.298 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6176671981811523
Epoch: 30, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6468291282653809
Epoch: 31, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7331159114837646
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 650982
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.661963224411011
Epoch: 1, Steps: 12 | Train Loss: 1.643 Vali Loss: 1.181 Vali Acc: 0.622 Test Loss: 1.181 Test Acc: 0.622
Validation loss decreased (inf --> -0.622210).  Saving model ...
Epoch: 2 cost time: 1.967745065689087
Epoch: 2, Steps: 12 | Train Loss: 0.949 Vali Loss: 0.711 Vali Acc: 0.700 Test Loss: 0.711 Test Acc: 0.700
Validation loss decreased (-0.622210 --> -0.699993).  Saving model ...
Epoch: 3 cost time: 1.8082311153411865
Epoch: 3, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.510 Vali Acc: 0.739 Test Loss: 0.510 Test Acc: 0.739
Validation loss decreased (-0.699993 --> -0.738884).  Saving model ...
Epoch: 4 cost time: 1.7662615776062012
Epoch: 4, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.440 Vali Acc: 0.806 Test Loss: 0.440 Test Acc: 0.806
Validation loss decreased (-0.738884 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 1.7679800987243652
Epoch: 5, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.396 Vali Acc: 0.806 Test Loss: 0.396 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805552).  Saving model ...
Epoch: 6 cost time: 1.9484012126922607
Epoch: 6, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.376 Vali Acc: 0.822 Test Loss: 0.376 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 1.9143149852752686
Epoch: 7, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9055025577545166
Epoch: 8, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
Validation loss decreased (-0.822218 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 1.7228972911834717
Epoch: 9, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.343 Vali Acc: 0.844 Test Loss: 0.343 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7467494010925293
Epoch: 10, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.407 Vali Acc: 0.833 Test Loss: 0.407 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7021145820617676
Epoch: 11, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.381 Vali Acc: 0.844 Test Loss: 0.381 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6284186840057373
Epoch: 12, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.698500633239746
Epoch: 13, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.343 Vali Acc: 0.828 Test Loss: 0.343 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6582732200622559
Epoch: 14, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 1.6992912292480469
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.355 Vali Acc: 0.872 Test Loss: 0.355 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 1.9650583267211914
Epoch: 16, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6201086044311523
Epoch: 17, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 18 cost time: 1.674459457397461
Epoch: 18, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.7861452102661133
Epoch: 19, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7513604164123535
Epoch: 20, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.358 Vali Acc: 0.850 Test Loss: 0.358 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5887856483459473
Epoch: 21, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6885862350463867
Epoch: 22, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.350 Vali Acc: 0.867 Test Loss: 0.350 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7199199199676514
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7367539405822754
Epoch: 24, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7410001754760742
Epoch: 25, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 26 cost time: 1.697021484375
Epoch: 26, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8828637599945068
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6850559711456299
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7610077857971191
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.343 Vali Acc: 0.867 Test Loss: 0.343 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6794548034667969
Epoch: 30, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.933321475982666
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.312 Vali Acc: 0.894 Test Loss: 0.312 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.918424129486084
Epoch: 32, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9256882667541504
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.9370875358581543
Epoch: 34, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.221137285232544
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 519910
model size : 6.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.918450593948364
Epoch: 1, Steps: 12 | Train Loss: 1.633 Vali Loss: 1.179 Vali Acc: 0.611 Test Loss: 1.179 Test Acc: 0.611
Validation loss decreased (inf --> -0.611099).  Saving model ...
Epoch: 2 cost time: 2.0929863452911377
Epoch: 2, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.707 Vali Acc: 0.700 Test Loss: 0.707 Test Acc: 0.700
Validation loss decreased (-0.611099 --> -0.699993).  Saving model ...
Epoch: 3 cost time: 1.9997448921203613
Epoch: 3, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.505 Vali Acc: 0.733 Test Loss: 0.505 Test Acc: 0.733
Validation loss decreased (-0.699993 --> -0.733328).  Saving model ...
Epoch: 4 cost time: 1.792285442352295
Epoch: 4, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.434 Vali Acc: 0.811 Test Loss: 0.434 Test Acc: 0.811
Validation loss decreased (-0.733328 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 1.8769440650939941
Epoch: 5, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.392 Vali Acc: 0.806 Test Loss: 0.392 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.73679518699646
Epoch: 6, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.369 Vali Acc: 0.828 Test Loss: 0.369 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 2.0259788036346436
Epoch: 7, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.364 Vali Acc: 0.822 Test Loss: 0.364 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.853250503540039
Epoch: 8, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
Validation loss decreased (-0.827774 --> -0.866664).  Saving model ...
Epoch: 9 cost time: 1.7904345989227295
Epoch: 9, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.343 Vali Acc: 0.850 Test Loss: 0.343 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.834852933883667
Epoch: 10, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.389 Vali Acc: 0.822 Test Loss: 0.389 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8134632110595703
Epoch: 11, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.382 Vali Acc: 0.850 Test Loss: 0.382 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.603743314743042
Epoch: 12, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8776021003723145
Epoch: 13, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.341 Vali Acc: 0.839 Test Loss: 0.341 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8859059810638428
Epoch: 14, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 1.9511797428131104
Epoch: 15, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.368 Vali Acc: 0.867 Test Loss: 0.368 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6515491008758545
Epoch: 16, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.332 Vali Acc: 0.856 Test Loss: 0.332 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6288275718688965
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 1.8068606853485107
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.8667452335357666
Epoch: 19, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7373647689819336
Epoch: 20, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.329 Vali Acc: 0.861 Test Loss: 0.329 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.862823486328125
Epoch: 21, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.309 Vali Acc: 0.872 Test Loss: 0.309 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7363080978393555
Epoch: 22, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7941761016845703
Epoch: 23, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 24 cost time: 2.080667734146118
Epoch: 24, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.923703670501709
Epoch: 25, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5677464008331299
Epoch: 26, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 27 cost time: 1.744899034500122
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
Validation loss decreased (-0.894441 --> -0.911108).  Saving model ...
Epoch: 28 cost time: 1.8084712028503418
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6548998355865479
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.340 Vali Acc: 0.878 Test Loss: 0.340 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7579281330108643
Epoch: 30, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.9360888004302979
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.321 Vali Acc: 0.878 Test Loss: 0.321 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.660820722579956
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.801985263824463
Epoch: 33, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.412 Vali Acc: 0.883 Test Loss: 0.412 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.7074129581451416
Epoch: 34, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.9576106071472168
Epoch: 35, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.8066129684448242
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.395 Vali Acc: 0.883 Test Loss: 0.395 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.8238227367401123
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.345 Vali Acc: 0.883 Test Loss: 0.345 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 519910
model size : 6.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.708957195281982
Epoch: 1, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.184 Vali Acc: 0.600 Test Loss: 1.184 Test Acc: 0.600
Validation loss decreased (inf --> -0.599988).  Saving model ...
Epoch: 2 cost time: 1.5761291980743408
Epoch: 2, Steps: 12 | Train Loss: 0.949 Vali Loss: 0.709 Vali Acc: 0.717 Test Loss: 0.709 Test Acc: 0.717
Validation loss decreased (-0.599988 --> -0.716660).  Saving model ...
Epoch: 3 cost time: 1.6536896228790283
Epoch: 3, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.507 Vali Acc: 0.728 Test Loss: 0.507 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727773).  Saving model ...
Epoch: 4 cost time: 1.8018765449523926
Epoch: 4, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.441 Vali Acc: 0.817 Test Loss: 0.441 Test Acc: 0.817
Validation loss decreased (-0.727773 --> -0.816662).  Saving model ...
Epoch: 5 cost time: 1.7073643207550049
Epoch: 5, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.392 Vali Acc: 0.800 Test Loss: 0.392 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7531647682189941
Epoch: 6, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.381 Vali Acc: 0.811 Test Loss: 0.381 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9372737407684326
Epoch: 7, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.5918338298797607
Epoch: 8, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.325 Vali Acc: 0.850 Test Loss: 0.325 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 1.7072291374206543
Epoch: 9, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.341 Vali Acc: 0.850 Test Loss: 0.341 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7691993713378906
Epoch: 10, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.391 Vali Acc: 0.822 Test Loss: 0.391 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.820145845413208
Epoch: 11, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.380 Vali Acc: 0.833 Test Loss: 0.380 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5351026058197021
Epoch: 12, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6920106410980225
Epoch: 13, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4965648651123047
Epoch: 14, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 1.7070143222808838
Epoch: 15, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.361 Vali Acc: 0.872 Test Loss: 0.361 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 1.5039288997650146
Epoch: 16, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6878609657287598
Epoch: 17, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.7099404335021973
Epoch: 18, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.5991401672363281
Epoch: 19, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5957982540130615
Epoch: 20, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.718595266342163
Epoch: 21, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6233570575714111
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6754565238952637
Epoch: 23, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.312 Vali Acc: 0.894 Test Loss: 0.312 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 24 cost time: 1.6674754619598389
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7015695571899414
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.882807970046997
Epoch: 26, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.297 Vali Acc: 0.894 Test Loss: 0.297 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 27 cost time: 1.7277777194976807
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 28 cost time: 1.705277919769287
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8074262142181396
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.350 Vali Acc: 0.867 Test Loss: 0.350 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6707193851470947
Epoch: 30, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4918971061706543
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.319 Vali Acc: 0.878 Test Loss: 0.319 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6780569553375244
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6692314147949219
Epoch: 33, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6177618503570557
Epoch: 34, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.346 Vali Acc: 0.894 Test Loss: 0.346 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.9922764301300049
Epoch: 35, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.875476360321045
Epoch: 36, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.391 Vali Acc: 0.883 Test Loss: 0.391 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.833885908126831
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.971989393234253
Epoch: 38, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.323 Vali Acc: 0.878 Test Loss: 0.323 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.7232129573822021
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.772278070449829
Epoch: 40, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.300 Vali Acc: 0.911 Test Loss: 0.300 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.9265151023864746
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.980973243713379
Epoch: 42, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.5600478649139404
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.6755211353302002
Epoch: 44, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 1.777702808380127
Epoch: 45, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.5908663272857666
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.6604368686676025
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.8064613342285156
Epoch: 48, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.348 Vali Acc: 0.906 Test Loss: 0.348 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.8017454147338867
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.6619822978973389
Epoch: 50, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.477 Vali Acc: 0.883 Test Loss: 0.477 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.688188076019287
Epoch: 51, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.8469314575195312
Epoch: 52, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.445 Vali Acc: 0.878 Test Loss: 0.445 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.1400058269500732
Epoch: 53, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.476 Vali Acc: 0.889 Test Loss: 0.476 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.833836317062378
Epoch: 54, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 519910
model size : 6.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.155024766921997
Epoch: 1, Steps: 12 | Train Loss: 1.625 Vali Loss: 1.183 Vali Acc: 0.622 Test Loss: 1.183 Test Acc: 0.622
Validation loss decreased (inf --> -0.622210).  Saving model ...
Epoch: 2 cost time: 1.8159043788909912
Epoch: 2, Steps: 12 | Train Loss: 0.937 Vali Loss: 0.704 Vali Acc: 0.694 Test Loss: 0.704 Test Acc: 0.694
Validation loss decreased (-0.622210 --> -0.694437).  Saving model ...
Epoch: 3 cost time: 1.745258092880249
Epoch: 3, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.502 Vali Acc: 0.739 Test Loss: 0.502 Test Acc: 0.739
Validation loss decreased (-0.694437 --> -0.738884).  Saving model ...
Epoch: 4 cost time: 1.6269943714141846
Epoch: 4, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.426 Vali Acc: 0.811 Test Loss: 0.426 Test Acc: 0.811
Validation loss decreased (-0.738884 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 1.6451570987701416
Epoch: 5, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.389 Vali Acc: 0.811 Test Loss: 0.389 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 1.6345911026000977
Epoch: 6, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.356 Vali Acc: 0.833 Test Loss: 0.356 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 1.5001332759857178
Epoch: 7, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.343 Vali Acc: 0.806 Test Loss: 0.343 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7895846366882324
Epoch: 8, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 1.633617639541626
Epoch: 9, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5274686813354492
Epoch: 10, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.382 Vali Acc: 0.822 Test Loss: 0.382 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5157794952392578
Epoch: 11, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4600863456726074
Epoch: 12, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 13 cost time: 1.5009186267852783
Epoch: 13, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.347 Vali Acc: 0.817 Test Loss: 0.347 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6153411865234375
Epoch: 14, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
Validation loss decreased (-0.855553 --> -0.855553).  Saving model ...
Epoch: 15 cost time: 1.521235466003418
Epoch: 15, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.340 Vali Acc: 0.856 Test Loss: 0.340 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.710944652557373
Epoch: 16, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7589256763458252
Epoch: 17, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.855553 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.9263970851898193
Epoch: 18, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7991242408752441
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8643944263458252
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7067058086395264
Epoch: 21, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.318 Vali Acc: 0.872 Test Loss: 0.318 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.580575704574585
Epoch: 22, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.352 Vali Acc: 0.872 Test Loss: 0.352 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5562412738800049
Epoch: 23, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.426189661026001
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.321 Vali Acc: 0.883 Test Loss: 0.321 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6157829761505127
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 26 cost time: 1.702284336090088
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.328 Vali Acc: 0.894 Test Loss: 0.328 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4372844696044922
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.255 Vali Acc: 0.911 Test Loss: 0.255 Test Acc: 0.911
Validation loss decreased (-0.894441 --> -0.911109).  Saving model ...
Epoch: 28 cost time: 1.6359150409698486
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6271240711212158
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.281 Vali Acc: 0.906 Test Loss: 0.281 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5398681163787842
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5700640678405762
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7055513858795166
Epoch: 32, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7772572040557861
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.436 Vali Acc: 0.872 Test Loss: 0.436 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.7433290481567383
Epoch: 34, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.728348970413208
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4419262409210205
Epoch: 36, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4344992637634277
Epoch: 37, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 519910
model size : 6.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.138678550720215
Epoch: 1, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.300 Vali Acc: 0.567 Test Loss: 1.300 Test Acc: 0.567
Validation loss decreased (inf --> -0.566654).  Saving model ...
Epoch: 2 cost time: 1.6924002170562744
Epoch: 2, Steps: 12 | Train Loss: 1.062 Vali Loss: 0.757 Vali Acc: 0.722 Test Loss: 0.757 Test Acc: 0.722
Validation loss decreased (-0.566654 --> -0.722215).  Saving model ...
Epoch: 3 cost time: 1.591123342514038
Epoch: 3, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.561 Vali Acc: 0.739 Test Loss: 0.561 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738883).  Saving model ...
Epoch: 4 cost time: 1.5328681468963623
Epoch: 4, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.488 Vali Acc: 0.761 Test Loss: 0.488 Test Acc: 0.761
Validation loss decreased (-0.738883 --> -0.761106).  Saving model ...
Epoch: 5 cost time: 1.7765626907348633
Epoch: 5, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.432 Vali Acc: 0.778 Test Loss: 0.432 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 1.696366548538208
Epoch: 6, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.402 Vali Acc: 0.806 Test Loss: 0.402 Test Acc: 0.806
Validation loss decreased (-0.777773 --> -0.805552).  Saving model ...
Epoch: 7 cost time: 1.5206289291381836
Epoch: 7, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
Validation loss decreased (-0.805552 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 1.7427902221679688
Epoch: 8, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 1.6422438621520996
Epoch: 9, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.341 Vali Acc: 0.817 Test Loss: 0.341 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6794116497039795
Epoch: 10, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.320 Vali Acc: 0.867 Test Loss: 0.320 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866663).  Saving model ...
Epoch: 11 cost time: 1.9174127578735352
Epoch: 11, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.423 Vali Acc: 0.811 Test Loss: 0.423 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.930799961090088
Epoch: 12, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9949402809143066
Epoch: 13, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.328 Vali Acc: 0.822 Test Loss: 0.328 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0853347778320312
Epoch: 14, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8968486785888672
Epoch: 15, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.715763807296753
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.339 Vali Acc: 0.844 Test Loss: 0.339 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8448083400726318
Epoch: 17, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.332 Vali Acc: 0.867 Test Loss: 0.332 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6765739917755127
Epoch: 18, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 2.0212674140930176
Epoch: 19, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.287 Vali Acc: 0.856 Test Loss: 0.287 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8562030792236328
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.791022777557373
Epoch: 21, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9764540195465088
Epoch: 22, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 1.7758574485778809
Epoch: 23, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.338 Vali Acc: 0.844 Test Loss: 0.338 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7725491523742676
Epoch: 24, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6406044960021973
Epoch: 25, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 1.7083566188812256
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9822978973388672
Epoch: 27, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.363 Vali Acc: 0.883 Test Loss: 0.363 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8434536457061768
Epoch: 28, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.315 Vali Acc: 0.856 Test Loss: 0.315 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8431031703948975
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7364814281463623
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.295 Vali Acc: 0.894 Test Loss: 0.295 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.6730225086212158
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.323 Vali Acc: 0.894 Test Loss: 0.323 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6880147457122803
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.5690252780914307
Epoch: 33, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 1.7521486282348633
Epoch: 34, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7350313663482666
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 36 cost time: 1.6685383319854736
Epoch: 36, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7101171016693115
Epoch: 37, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5966885089874268
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.294 Vali Acc: 0.911 Test Loss: 0.294 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6146178245544434
Epoch: 39, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.7428555488586426
Epoch: 40, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.349 Vali Acc: 0.883 Test Loss: 0.349 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.6696617603302002
Epoch: 41, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.331 Vali Acc: 0.894 Test Loss: 0.331 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.6416893005371094
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.390 Vali Acc: 0.867 Test Loss: 0.390 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.6364295482635498
Epoch: 43, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 1.6795852184295654
Epoch: 44, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5834102630615234
Epoch: 45, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6753971576690674
Epoch: 46, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.371 Vali Acc: 0.894 Test Loss: 0.371 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.8254737854003906
Epoch: 47, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.8437573909759521
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.367 Vali Acc: 0.883 Test Loss: 0.367 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8672680854797363
Epoch: 49, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.334 Vali Acc: 0.894 Test Loss: 0.334 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.735194206237793
Epoch: 50, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.6218898296356201
Epoch: 51, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.318 Vali Acc: 0.906 Test Loss: 0.318 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.776357889175415
Epoch: 52, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.324 Vali Acc: 0.911 Test Loss: 0.324 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.707033634185791
Epoch: 53, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.9480292797088623
Epoch: 54, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.416 Vali Acc: 0.883 Test Loss: 0.416 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.8704190254211426
Epoch: 55, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.296 Vali Acc: 0.911 Test Loss: 0.296 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.8307254314422607
Epoch: 56, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 57 cost time: 1.6017634868621826
Epoch: 57, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.366 Vali Acc: 0.894 Test Loss: 0.366 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.687082052230835
Epoch: 58, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.331 Vali Acc: 0.911 Test Loss: 0.331 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.719815731048584
Epoch: 59, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.728710651397705
Epoch: 60, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.8251609802246094
Epoch: 61, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.7581250667572021
Epoch: 62, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.323 Vali Acc: 0.906 Test Loss: 0.323 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.8620095252990723
Epoch: 63, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.824784755706787
Epoch: 64, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.911 Test Loss: 0.307 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 2.0247085094451904
Epoch: 65, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.8404154777526855
Epoch: 66, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 454374
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.939094305038452
Epoch: 1, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.290 Vali Acc: 0.594 Test Loss: 1.290 Test Acc: 0.594
Validation loss decreased (inf --> -0.594432).  Saving model ...
Epoch: 2 cost time: 1.6858816146850586
Epoch: 2, Steps: 12 | Train Loss: 1.050 Vali Loss: 0.747 Vali Acc: 0.717 Test Loss: 0.747 Test Acc: 0.717
Validation loss decreased (-0.594432 --> -0.716659).  Saving model ...
Epoch: 3 cost time: 1.8679847717285156
Epoch: 3, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.561 Vali Acc: 0.733 Test Loss: 0.561 Test Acc: 0.733
Validation loss decreased (-0.716659 --> -0.733328).  Saving model ...
Epoch: 4 cost time: 1.7404911518096924
Epoch: 4, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.485 Vali Acc: 0.761 Test Loss: 0.485 Test Acc: 0.761
Validation loss decreased (-0.733328 --> -0.761106).  Saving model ...
Epoch: 5 cost time: 1.8964464664459229
Epoch: 5, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.427 Vali Acc: 0.794 Test Loss: 0.427 Test Acc: 0.794
Validation loss decreased (-0.761106 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 1.7798073291778564
Epoch: 6, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.403 Vali Acc: 0.806 Test Loss: 0.403 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 7 cost time: 1.8725168704986572
Epoch: 7, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.372 Vali Acc: 0.844 Test Loss: 0.372 Test Acc: 0.844
Validation loss decreased (-0.805552 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 1.8632254600524902
Epoch: 8, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 1.7046945095062256
Epoch: 9, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.341 Vali Acc: 0.806 Test Loss: 0.341 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.635467767715454
Epoch: 10, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 1.6014010906219482
Epoch: 11, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.408 Vali Acc: 0.828 Test Loss: 0.408 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5433094501495361
Epoch: 12, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7612016201019287
Epoch: 13, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.338 Vali Acc: 0.828 Test Loss: 0.338 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.989098310470581
Epoch: 14, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8226141929626465
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9822113513946533
Epoch: 16, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.347 Vali Acc: 0.850 Test Loss: 0.347 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.015559673309326
Epoch: 17, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.329 Vali Acc: 0.878 Test Loss: 0.329 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 18 cost time: 1.9508535861968994
Epoch: 18, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894441).  Saving model ...
Epoch: 19 cost time: 2.0642638206481934
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8250651359558105
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9257218837738037
Epoch: 21, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8965814113616943
Epoch: 22, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.310 Vali Acc: 0.894 Test Loss: 0.310 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8434278964996338
Epoch: 23, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.357 Vali Acc: 0.844 Test Loss: 0.357 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.915435791015625
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6838696002960205
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 1.595590353012085
Epoch: 26, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.334 Vali Acc: 0.894 Test Loss: 0.334 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.596587896347046
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.417 Vali Acc: 0.883 Test Loss: 0.417 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6814255714416504
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7084853649139404
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.315 Vali Acc: 0.883 Test Loss: 0.315 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6738438606262207
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 31 cost time: 1.7765319347381592
Epoch: 31, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8302676677703857
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.453 Vali Acc: 0.861 Test Loss: 0.453 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8930468559265137
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.349 Vali Acc: 0.883 Test Loss: 0.349 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.781454086303711
Epoch: 34, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.340 Vali Acc: 0.867 Test Loss: 0.340 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.703047513961792
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7719688415527344
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.337 Vali Acc: 0.911 Test Loss: 0.337 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 37 cost time: 1.6362650394439697
Epoch: 37, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8482208251953125
Epoch: 38, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.8093955516815186
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8375377655029297
Epoch: 40, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.383 Vali Acc: 0.894 Test Loss: 0.383 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.8234970569610596
Epoch: 41, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.358 Vali Acc: 0.883 Test Loss: 0.358 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.7540907859802246
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.421 Vali Acc: 0.856 Test Loss: 0.421 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.7287395000457764
Epoch: 43, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.6800382137298584
Epoch: 44, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.6677467823028564
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.7249245643615723
Epoch: 46, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.299 Vali Acc: 0.911 Test Loss: 0.299 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 47 cost time: 1.5299475193023682
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.6025681495666504
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.300 Vali Acc: 0.906 Test Loss: 0.300 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.9104790687561035
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.8030095100402832
Epoch: 50, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.89937162399292
Epoch: 51, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.307 Vali Acc: 0.911 Test Loss: 0.307 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.906942367553711
Epoch: 52, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.690237283706665
Epoch: 53, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.318 Vali Acc: 0.894 Test Loss: 0.318 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.6338136196136475
Epoch: 54, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.300 Vali Acc: 0.911 Test Loss: 0.300 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.8062634468078613
Epoch: 55, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.813812255859375
Epoch: 56, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.309 Vali Acc: 0.911 Test Loss: 0.309 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 454374
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.521010637283325
Epoch: 1, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.286 Vali Acc: 0.594 Test Loss: 1.286 Test Acc: 0.594
Validation loss decreased (inf --> -0.594432).  Saving model ...
Epoch: 2 cost time: 2.1197991371154785
Epoch: 2, Steps: 12 | Train Loss: 1.040 Vali Loss: 0.742 Vali Acc: 0.733 Test Loss: 0.742 Test Acc: 0.733
Validation loss decreased (-0.594432 --> -0.733326).  Saving model ...
Epoch: 3 cost time: 2.014519214630127
Epoch: 3, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.550 Vali Acc: 0.739 Test Loss: 0.550 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738883).  Saving model ...
Epoch: 4 cost time: 1.9112584590911865
Epoch: 4, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.482 Vali Acc: 0.767 Test Loss: 0.482 Test Acc: 0.767
Validation loss decreased (-0.738883 --> -0.766662).  Saving model ...
Epoch: 5 cost time: 1.8565444946289062
Epoch: 5, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.428 Vali Acc: 0.800 Test Loss: 0.428 Test Acc: 0.800
Validation loss decreased (-0.766662 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 1.972762107849121
Epoch: 6, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.399 Vali Acc: 0.811 Test Loss: 0.399 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 1.978318452835083
Epoch: 7, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.377 Vali Acc: 0.839 Test Loss: 0.377 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 1.930614948272705
Epoch: 8, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.315 Vali Acc: 0.861 Test Loss: 0.315 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 1.8261289596557617
Epoch: 9, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9961304664611816
Epoch: 10, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.324 Vali Acc: 0.883 Test Loss: 0.324 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883330).  Saving model ...
Epoch: 11 cost time: 1.9944140911102295
Epoch: 11, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.419 Vali Acc: 0.833 Test Loss: 0.419 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0739099979400635
Epoch: 12, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.322 Vali Acc: 0.856 Test Loss: 0.322 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.98317551612854
Epoch: 13, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.343 Vali Acc: 0.828 Test Loss: 0.343 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9853734970092773
Epoch: 14, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9483017921447754
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7109673023223877
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.350 Vali Acc: 0.844 Test Loss: 0.350 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.667252540588379
Epoch: 17, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.315 Vali Acc: 0.878 Test Loss: 0.315 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.728006362915039
Epoch: 18, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.6825406551361084
Epoch: 19, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5544757843017578
Epoch: 20, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6539795398712158
Epoch: 21, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.319 Vali Acc: 0.883 Test Loss: 0.319 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9124152660369873
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9107701778411865
Epoch: 23, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.316 Vali Acc: 0.878 Test Loss: 0.316 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7022778987884521
Epoch: 24, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.312 Vali Acc: 0.878 Test Loss: 0.312 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6838231086730957
Epoch: 25, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 1.6951825618743896
Epoch: 26, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.334 Vali Acc: 0.894 Test Loss: 0.334 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.659607172012329
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.422 Vali Acc: 0.883 Test Loss: 0.422 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7556791305541992
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.440 Vali Acc: 0.833 Test Loss: 0.440 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.690793514251709
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.317 Vali Acc: 0.883 Test Loss: 0.317 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5129287242889404
Epoch: 30, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7092642784118652
Epoch: 31, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.323 Vali Acc: 0.894 Test Loss: 0.323 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.7709345817565918
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.425 Vali Acc: 0.861 Test Loss: 0.425 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.7523434162139893
Epoch: 33, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.136571168899536
Epoch: 34, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.338 Vali Acc: 0.878 Test Loss: 0.338 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.9973177909851074
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 454374
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8787097930908203
Epoch: 1, Steps: 12 | Train Loss: 1.742 Vali Loss: 1.295 Vali Acc: 0.622 Test Loss: 1.295 Test Acc: 0.622
Validation loss decreased (inf --> -0.622209).  Saving model ...
Epoch: 2 cost time: 1.7447679042816162
Epoch: 2, Steps: 12 | Train Loss: 1.052 Vali Loss: 0.731 Vali Acc: 0.722 Test Loss: 0.731 Test Acc: 0.722
Validation loss decreased (-0.622209 --> -0.722215).  Saving model ...
Epoch: 3 cost time: 1.8080837726593018
Epoch: 3, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.537 Vali Acc: 0.756 Test Loss: 0.537 Test Acc: 0.756
Validation loss decreased (-0.722215 --> -0.755550).  Saving model ...
Epoch: 4 cost time: 1.8489058017730713
Epoch: 4, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.462 Vali Acc: 0.772 Test Loss: 0.462 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772218).  Saving model ...
Epoch: 5 cost time: 1.7735061645507812
Epoch: 5, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.403 Vali Acc: 0.822 Test Loss: 0.403 Test Acc: 0.822
Validation loss decreased (-0.772218 --> -0.822218).  Saving model ...
Epoch: 6 cost time: 1.5304267406463623
Epoch: 6, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.366 Vali Acc: 0.822 Test Loss: 0.366 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 1.5565054416656494
Epoch: 7, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.340 Vali Acc: 0.867 Test Loss: 0.340 Test Acc: 0.867
Validation loss decreased (-0.822219 --> -0.866663).  Saving model ...
Epoch: 8 cost time: 1.648831844329834
Epoch: 8, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 1.7249302864074707
Epoch: 9, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.322 Vali Acc: 0.839 Test Loss: 0.322 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.72090482711792
Epoch: 10, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 11 cost time: 1.553880214691162
Epoch: 11, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.418 Vali Acc: 0.817 Test Loss: 0.418 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.774139404296875
Epoch: 12, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6165037155151367
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6034600734710693
Epoch: 14, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.352 Vali Acc: 0.850 Test Loss: 0.352 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4643681049346924
Epoch: 15, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.775428295135498
Epoch: 16, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.763279676437378
Epoch: 17, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6864242553710938
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.768568754196167
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.268 Vali Acc: 0.872 Test Loss: 0.268 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7809562683105469
Epoch: 20, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 454374
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.155517816543579
Epoch: 1, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.540 Vali Acc: 0.344 Test Loss: 1.540 Test Acc: 0.344
Validation loss decreased (inf --> -0.344429).  Saving model ...
Epoch: 2 cost time: 1.6044139862060547
Epoch: 2, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.026 Vali Acc: 0.667 Test Loss: 1.026 Test Acc: 0.667
Validation loss decreased (-0.344429 --> -0.666656).  Saving model ...
Epoch: 3 cost time: 1.6925361156463623
Epoch: 3, Steps: 12 | Train Loss: 0.853 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
Validation loss decreased (-0.666656 --> -0.716659).  Saving model ...
Epoch: 4 cost time: 1.4137542247772217
Epoch: 4, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.590 Vali Acc: 0.761 Test Loss: 0.590 Test Acc: 0.761
Validation loss decreased (-0.716659 --> -0.761105).  Saving model ...
Epoch: 5 cost time: 1.5236589908599854
Epoch: 5, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.506 Vali Acc: 0.761 Test Loss: 0.506 Test Acc: 0.761
Validation loss decreased (-0.761105 --> -0.761106).  Saving model ...
Epoch: 6 cost time: 1.760815143585205
Epoch: 6, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.472 Vali Acc: 0.789 Test Loss: 0.472 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 1.5438823699951172
Epoch: 7, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.427 Vali Acc: 0.811 Test Loss: 0.427 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 1.7532522678375244
Epoch: 8, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.414 Vali Acc: 0.800 Test Loss: 0.414 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8412728309631348
Epoch: 9, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.385 Vali Acc: 0.817 Test Loss: 0.385 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 1.5893170833587646
Epoch: 10, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 11 cost time: 1.5886948108673096
Epoch: 11, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.341 Vali Acc: 0.822 Test Loss: 0.341 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 12 cost time: 1.7190301418304443
Epoch: 12, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 13 cost time: 1.568758487701416
Epoch: 13, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.701720952987671
Epoch: 14, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 1.6891310214996338
Epoch: 15, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.306 Vali Acc: 0.867 Test Loss: 0.306 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 1.8707013130187988
Epoch: 16, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.867631435394287
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8357725143432617
Epoch: 18, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6909754276275635
Epoch: 19, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 20 cost time: 1.6936256885528564
Epoch: 20, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 21 cost time: 1.6898181438446045
Epoch: 21, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6844375133514404
Epoch: 22, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 1.6758198738098145
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7475669384002686
Epoch: 24, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.872194528579712
Epoch: 25, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6883890628814697
Epoch: 26, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8572931289672852
Epoch: 27, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0591681003570557
Epoch: 28, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9552772045135498
Epoch: 29, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 1.936995029449463
Epoch: 30, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9126946926116943
Epoch: 31, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8668968677520752
Epoch: 32, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 33 cost time: 1.64994478225708
Epoch: 33, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.68928861618042
Epoch: 34, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8280730247497559
Epoch: 35, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.362 Vali Acc: 0.856 Test Loss: 0.362 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7232520580291748
Epoch: 36, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.319 Vali Acc: 0.883 Test Loss: 0.319 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7613356113433838
Epoch: 37, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.466 Vali Acc: 0.844 Test Loss: 0.466 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.730792760848999
Epoch: 38, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.326 Vali Acc: 0.867 Test Loss: 0.326 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.8006505966186523
Epoch: 39, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.7677009105682373
Epoch: 40, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.376 Vali Acc: 0.856 Test Loss: 0.376 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.8188772201538086
Epoch: 41, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.802825927734375
Epoch: 42, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1177574
model size : 6.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.141035079956055
Epoch: 1, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.534 Vali Acc: 0.361 Test Loss: 1.534 Test Acc: 0.361
Validation loss decreased (inf --> -0.361096).  Saving model ...
Epoch: 2 cost time: 1.6020293235778809
Epoch: 2, Steps: 12 | Train Loss: 1.244 Vali Loss: 1.023 Vali Acc: 0.656 Test Loss: 1.023 Test Acc: 0.656
Validation loss decreased (-0.361096 --> -0.655545).  Saving model ...
Epoch: 3 cost time: 2.00374698638916
Epoch: 3, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.748 Vali Acc: 0.717 Test Loss: 0.748 Test Acc: 0.717
Validation loss decreased (-0.655545 --> -0.716659).  Saving model ...
Epoch: 4 cost time: 2.075136423110962
Epoch: 4, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.593 Vali Acc: 0.756 Test Loss: 0.593 Test Acc: 0.756
Validation loss decreased (-0.716659 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 1.9689757823944092
Epoch: 5, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.504 Vali Acc: 0.767 Test Loss: 0.504 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766662).  Saving model ...
Epoch: 6 cost time: 2.046281576156616
Epoch: 6, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.472 Vali Acc: 0.772 Test Loss: 0.472 Test Acc: 0.772
Validation loss decreased (-0.766662 --> -0.772218).  Saving model ...
Epoch: 7 cost time: 1.8592798709869385
Epoch: 7, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.426 Vali Acc: 0.806 Test Loss: 0.426 Test Acc: 0.806
Validation loss decreased (-0.772218 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 1.8608911037445068
Epoch: 8, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.417 Vali Acc: 0.811 Test Loss: 0.417 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 1.9058585166931152
Epoch: 9, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.387 Vali Acc: 0.811 Test Loss: 0.387 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 1.7186808586120605
Epoch: 10, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.359 Vali Acc: 0.817 Test Loss: 0.359 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 11 cost time: 1.809499740600586
Epoch: 11, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.341 Vali Acc: 0.839 Test Loss: 0.341 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 1.8617267608642578
Epoch: 12, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.338 Vali Acc: 0.828 Test Loss: 0.338 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.831211805343628
Epoch: 13, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.335 Vali Acc: 0.856 Test Loss: 0.335 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 1.9214963912963867
Epoch: 14, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.065843105316162
Epoch: 15, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 2.0457563400268555
Epoch: 16, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 2.0077104568481445
Epoch: 17, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8802752494812012
Epoch: 18, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7648069858551025
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7953016757965088
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 21 cost time: 1.6669056415557861
Epoch: 21, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.632807970046997
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 1.6319141387939453
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9104275703430176
Epoch: 24, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8072841167449951
Epoch: 25, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7421669960021973
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8284523487091064
Epoch: 27, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5777997970581055
Epoch: 28, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9499387741088867
Epoch: 29, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 1.752359390258789
Epoch: 30, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7943832874298096
Epoch: 31, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7023406028747559
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.820117473602295
Epoch: 33, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.8253557682037354
Epoch: 34, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.0485265254974365
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.1366310119628906
Epoch: 36, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.311 Vali Acc: 0.872 Test Loss: 0.311 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.7351999282836914
Epoch: 37, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.8563933372497559
Epoch: 38, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.352 Vali Acc: 0.872 Test Loss: 0.352 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.497084379196167
Epoch: 39, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.362 Vali Acc: 0.844 Test Loss: 0.362 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1177574
model size : 6.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.0504350662231445
Epoch: 1, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.528 Vali Acc: 0.361 Test Loss: 1.528 Test Acc: 0.361
Validation loss decreased (inf --> -0.361096).  Saving model ...
Epoch: 2 cost time: 1.6495702266693115
Epoch: 2, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.014 Vali Acc: 0.661 Test Loss: 1.014 Test Acc: 0.661
Validation loss decreased (-0.361096 --> -0.661101).  Saving model ...
Epoch: 3 cost time: 1.6297810077667236
Epoch: 3, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.736 Vali Acc: 0.739 Test Loss: 0.736 Test Acc: 0.739
Validation loss decreased (-0.661101 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 1.6601781845092773
Epoch: 4, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.585 Vali Acc: 0.767 Test Loss: 0.585 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766661).  Saving model ...
Epoch: 5 cost time: 1.69032883644104
Epoch: 5, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.496 Vali Acc: 0.772 Test Loss: 0.496 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 6 cost time: 1.787907361984253
Epoch: 6, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.470 Vali Acc: 0.783 Test Loss: 0.470 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 1.7844185829162598
Epoch: 7, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.420 Vali Acc: 0.806 Test Loss: 0.420 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 1.7623929977416992
Epoch: 8, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.414 Vali Acc: 0.800 Test Loss: 0.414 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6772334575653076
Epoch: 9, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.381 Vali Acc: 0.811 Test Loss: 0.381 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 1.7925646305084229
Epoch: 10, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 11 cost time: 1.7527642250061035
Epoch: 11, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.336 Vali Acc: 0.833 Test Loss: 0.336 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 1.671717643737793
Epoch: 12, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 1.6075036525726318
Epoch: 13, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.335 Vali Acc: 0.844 Test Loss: 0.335 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4053285121917725
Epoch: 14, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 1.6520230770111084
Epoch: 15, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 1.68562650680542
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7066071033477783
Epoch: 17, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7098760604858398
Epoch: 18, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5946900844573975
Epoch: 19, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6867780685424805
Epoch: 20, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6699655055999756
Epoch: 21, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5840692520141602
Epoch: 22, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 23 cost time: 1.5711066722869873
Epoch: 23, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.554229497909546
Epoch: 24, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.327 Vali Acc: 0.872 Test Loss: 0.327 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7469792366027832
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.270 Vali Acc: 0.867 Test Loss: 0.270 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6998121738433838
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6066646575927734
Epoch: 27, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6070959568023682
Epoch: 28, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6057589054107666
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4963383674621582
Epoch: 30, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.334 Vali Acc: 0.867 Test Loss: 0.334 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.682868480682373
Epoch: 31, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.309 Vali Acc: 0.872 Test Loss: 0.309 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8345398902893066
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 1.661635160446167
Epoch: 33, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6537368297576904
Epoch: 34, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 35 cost time: 1.668731927871704
Epoch: 35, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6768722534179688
Epoch: 36, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.342 Vali Acc: 0.883 Test Loss: 0.342 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.790581226348877
Epoch: 37, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.704200029373169
Epoch: 38, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 39 cost time: 1.9436204433441162
Epoch: 39, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8049068450927734
Epoch: 40, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.801853895187378
Epoch: 41, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.338 Vali Acc: 0.878 Test Loss: 0.338 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7692627906799316
Epoch: 42, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.328 Vali Acc: 0.894 Test Loss: 0.328 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.716404914855957
Epoch: 43, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.281 Vali Acc: 0.906 Test Loss: 0.281 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 44 cost time: 1.6709318161010742
Epoch: 44, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.8332316875457764
Epoch: 45, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.347 Vali Acc: 0.883 Test Loss: 0.347 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.683365821838379
Epoch: 46, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.968358039855957
Epoch: 47, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.351 Vali Acc: 0.883 Test Loss: 0.351 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6080265045166016
Epoch: 48, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.602065086364746
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.8164515495300293
Epoch: 50, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.7785990238189697
Epoch: 51, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.408 Vali Acc: 0.889 Test Loss: 0.408 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.669982671737671
Epoch: 52, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.6938726902008057
Epoch: 53, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.337 Vali Acc: 0.883 Test Loss: 0.337 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1177574
model size : 6.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.695688486099243
Epoch: 1, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.517 Vali Acc: 0.406 Test Loss: 1.517 Test Acc: 0.406
Validation loss decreased (inf --> -0.405540).  Saving model ...
Epoch: 2 cost time: 1.6447923183441162
Epoch: 2, Steps: 12 | Train Loss: 1.236 Vali Loss: 0.999 Vali Acc: 0.650 Test Loss: 0.999 Test Acc: 0.650
Validation loss decreased (-0.405540 --> -0.649990).  Saving model ...
Epoch: 3 cost time: 1.4140360355377197
Epoch: 3, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.714 Vali Acc: 0.717 Test Loss: 0.714 Test Acc: 0.717
Validation loss decreased (-0.649990 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 1.4681265354156494
Epoch: 4, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.562 Vali Acc: 0.761 Test Loss: 0.562 Test Acc: 0.761
Validation loss decreased (-0.716660 --> -0.761105).  Saving model ...
Epoch: 5 cost time: 1.5030162334442139
Epoch: 5, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.465 Vali Acc: 0.783 Test Loss: 0.465 Test Acc: 0.783
Validation loss decreased (-0.761105 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 1.4529786109924316
Epoch: 6, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.432 Vali Acc: 0.822 Test Loss: 0.432 Test Acc: 0.822
Validation loss decreased (-0.783329 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 1.5794413089752197
Epoch: 7, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.383 Vali Acc: 0.811 Test Loss: 0.383 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.512601613998413
Epoch: 8, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 1.648691177368164
Epoch: 9, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.350 Vali Acc: 0.811 Test Loss: 0.350 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5973436832427979
Epoch: 10, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838886).  Saving model ...
Epoch: 11 cost time: 1.4746551513671875
Epoch: 11, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.308 Vali Acc: 0.839 Test Loss: 0.308 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 12 cost time: 1.4755280017852783
Epoch: 12, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 1.3822808265686035
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3505008220672607
Epoch: 14, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.316 Vali Acc: 0.839 Test Loss: 0.316 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3668296337127686
Epoch: 15, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.849997 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.372687578201294
Epoch: 16, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4153902530670166
Epoch: 17, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.524850606918335
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4297633171081543
Epoch: 19, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4591124057769775
Epoch: 20, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4840056896209717
Epoch: 21, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5795810222625732
Epoch: 22, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5587890148162842
Epoch: 23, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.5172803401947021
Epoch: 24, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.287 Vali Acc: 0.894 Test Loss: 0.287 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 25 cost time: 1.4843580722808838
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 1.6676158905029297
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6228277683258057
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 28 cost time: 1.6290605068206787
Epoch: 28, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7956891059875488
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7202327251434326
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.717641830444336
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6825830936431885
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7226872444152832
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 1.7283868789672852
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.706657886505127
Epoch: 35, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6199443340301514
Epoch: 36, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6901707649230957
Epoch: 37, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.504 Vali Acc: 0.861 Test Loss: 0.504 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.9230728149414062
Epoch: 38, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.9704608917236328
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.0383834838867188
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.8847558498382568
Epoch: 41, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.771608829498291
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.6921908855438232
Epoch: 43, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 1177574
model size : 6.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.046532154083252
Epoch: 1, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.428 Vali Acc: 0.506 Test Loss: 1.428 Test Acc: 0.506
Validation loss decreased (inf --> -0.505541).  Saving model ...
Epoch: 2 cost time: 1.6594140529632568
Epoch: 2, Steps: 12 | Train Loss: 1.203 Vali Loss: 0.926 Vali Acc: 0.706 Test Loss: 0.926 Test Acc: 0.706
Validation loss decreased (-0.505541 --> -0.705546).  Saving model ...
Epoch: 3 cost time: 1.7725110054016113
Epoch: 3, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.688 Vali Acc: 0.694 Test Loss: 0.688 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6614711284637451
Epoch: 4, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.585 Vali Acc: 0.744 Test Loss: 0.585 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744439).  Saving model ...
Epoch: 5 cost time: 1.480264663696289
Epoch: 5, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.498 Vali Acc: 0.761 Test Loss: 0.498 Test Acc: 0.761
Validation loss decreased (-0.744439 --> -0.761106).  Saving model ...
Epoch: 6 cost time: 1.542978286743164
Epoch: 6, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.463 Vali Acc: 0.767 Test Loss: 0.463 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 1.5370848178863525
Epoch: 7, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.433 Vali Acc: 0.794 Test Loss: 0.433 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 1.4897232055664062
Epoch: 8, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.386 Vali Acc: 0.789 Test Loss: 0.386 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6269347667694092
Epoch: 9, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
Validation loss decreased (-0.794440 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 1.4876644611358643
Epoch: 10, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.380 Vali Acc: 0.806 Test Loss: 0.380 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.550295114517212
Epoch: 11, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.347 Vali Acc: 0.867 Test Loss: 0.347 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866663).  Saving model ...
Epoch: 12 cost time: 1.5483806133270264
Epoch: 12, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.362 Vali Acc: 0.811 Test Loss: 0.362 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5799505710601807
Epoch: 13, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.328 Vali Acc: 0.833 Test Loss: 0.328 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5739750862121582
Epoch: 14, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.324 Vali Acc: 0.822 Test Loss: 0.324 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.390392541885376
Epoch: 15, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.315 Vali Acc: 0.828 Test Loss: 0.315 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5885529518127441
Epoch: 16, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 17 cost time: 1.6007180213928223
Epoch: 17, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 1.5887677669525146
Epoch: 18, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.445 Vali Acc: 0.811 Test Loss: 0.445 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.65297269821167
Epoch: 19, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.371 Vali Acc: 0.844 Test Loss: 0.371 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7401232719421387
Epoch: 20, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.677666425704956
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.636889934539795
Epoch: 22, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 23 cost time: 1.513805866241455
Epoch: 23, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.315 Vali Acc: 0.839 Test Loss: 0.315 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4335808753967285
Epoch: 24, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.312 Vali Acc: 0.878 Test Loss: 0.312 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.523322343826294
Epoch: 25, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 26 cost time: 1.5323748588562012
Epoch: 26, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.352 Vali Acc: 0.844 Test Loss: 0.352 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6023614406585693
Epoch: 27, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5636725425720215
Epoch: 28, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.340 Vali Acc: 0.839 Test Loss: 0.340 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6822245121002197
Epoch: 29, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.381 Vali Acc: 0.844 Test Loss: 0.381 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5609378814697266
Epoch: 30, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 31 cost time: 1.477576494216919
Epoch: 31, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.4211199283599854
Epoch: 32, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5926847457885742
Epoch: 33, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.396 Vali Acc: 0.839 Test Loss: 0.396 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.642669677734375
Epoch: 34, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7447080612182617
Epoch: 35, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.9501457214355469
Epoch: 36, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.8449532985687256
Epoch: 37, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.7959089279174805
Epoch: 38, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.310 Vali Acc: 0.894 Test Loss: 0.310 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.7899589538574219
Epoch: 39, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.7891902923583984
Epoch: 40, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.7639484405517578
Epoch: 41, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 653286
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.957048177719116
Epoch: 1, Steps: 12 | Train Loss: 1.727 Vali Loss: 1.429 Vali Acc: 0.517 Test Loss: 1.429 Test Acc: 0.517
Validation loss decreased (inf --> -0.516652).  Saving model ...
Epoch: 2 cost time: 1.9894781112670898
Epoch: 2, Steps: 12 | Train Loss: 1.195 Vali Loss: 0.925 Vali Acc: 0.711 Test Loss: 0.925 Test Acc: 0.711
Validation loss decreased (-0.516652 --> -0.711102).  Saving model ...
Epoch: 3 cost time: 1.9428694248199463
Epoch: 3, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.685 Vali Acc: 0.706 Test Loss: 0.685 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0688657760620117
Epoch: 4, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.589 Vali Acc: 0.744 Test Loss: 0.589 Test Acc: 0.744
Validation loss decreased (-0.711102 --> -0.744439).  Saving model ...
Epoch: 5 cost time: 1.7398877143859863
Epoch: 5, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.495 Vali Acc: 0.750 Test Loss: 0.495 Test Acc: 0.750
Validation loss decreased (-0.744439 --> -0.749995).  Saving model ...
Epoch: 6 cost time: 1.6206176280975342
Epoch: 6, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.463 Vali Acc: 0.761 Test Loss: 0.463 Test Acc: 0.761
Validation loss decreased (-0.749995 --> -0.761106).  Saving model ...
Epoch: 7 cost time: 1.6703095436096191
Epoch: 7, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.434 Vali Acc: 0.789 Test Loss: 0.434 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788885).  Saving model ...
Epoch: 8 cost time: 1.5450716018676758
Epoch: 8, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.388 Vali Acc: 0.783 Test Loss: 0.388 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.556938886642456
Epoch: 9, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.369 Vali Acc: 0.822 Test Loss: 0.369 Test Acc: 0.822
Validation loss decreased (-0.788885 --> -0.822219).  Saving model ...
Epoch: 10 cost time: 1.9148163795471191
Epoch: 10, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.378 Vali Acc: 0.811 Test Loss: 0.378 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.694291591644287
Epoch: 11, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.351 Vali Acc: 0.867 Test Loss: 0.351 Test Acc: 0.867
Validation loss decreased (-0.822219 --> -0.866663).  Saving model ...
Epoch: 12 cost time: 1.5935866832733154
Epoch: 12, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.364 Vali Acc: 0.811 Test Loss: 0.364 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7152283191680908
Epoch: 13, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.723564863204956
Epoch: 14, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.331 Vali Acc: 0.822 Test Loss: 0.331 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.633906364440918
Epoch: 15, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7752392292022705
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.310 Vali Acc: 0.878 Test Loss: 0.310 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 1.9527859687805176
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.306 Vali Acc: 0.872 Test Loss: 0.306 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9333438873291016
Epoch: 18, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.417 Vali Acc: 0.811 Test Loss: 0.417 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8080689907073975
Epoch: 19, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.382 Vali Acc: 0.850 Test Loss: 0.382 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7876989841461182
Epoch: 20, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.381 Vali Acc: 0.822 Test Loss: 0.381 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.786583662033081
Epoch: 21, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7641189098358154
Epoch: 22, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.307 Vali Acc: 0.894 Test Loss: 0.307 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894441).  Saving model ...
Epoch: 23 cost time: 1.7271409034729004
Epoch: 23, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7179338932037354
Epoch: 24, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8212904930114746
Epoch: 25, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 1.8609750270843506
Epoch: 26, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.339 Vali Acc: 0.856 Test Loss: 0.339 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5967588424682617
Epoch: 27, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7438433170318604
Epoch: 28, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.356 Vali Acc: 0.844 Test Loss: 0.356 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5307059288024902
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.368 Vali Acc: 0.844 Test Loss: 0.368 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6794147491455078
Epoch: 30, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 31 cost time: 1.6421403884887695
Epoch: 31, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.6309967041015625
Epoch: 32, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.673717975616455
Epoch: 33, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.405 Vali Acc: 0.839 Test Loss: 0.405 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5123631954193115
Epoch: 34, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7190420627593994
Epoch: 35, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.7112631797790527
Epoch: 36, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.322 Vali Acc: 0.883 Test Loss: 0.322 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.6789169311523438
Epoch: 37, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.8118510246276855
Epoch: 38, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.316 Vali Acc: 0.878 Test Loss: 0.316 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.9036128520965576
Epoch: 39, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.311 Vali Acc: 0.883 Test Loss: 0.311 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.7807347774505615
Epoch: 40, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.565246820449829
Epoch: 41, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 653286
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.126607894897461
Epoch: 1, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.422 Vali Acc: 0.517 Test Loss: 1.422 Test Acc: 0.517
Validation loss decreased (inf --> -0.516652).  Saving model ...
Epoch: 2 cost time: 1.6364574432373047
Epoch: 2, Steps: 12 | Train Loss: 1.186 Vali Loss: 0.917 Vali Acc: 0.717 Test Loss: 0.917 Test Acc: 0.717
Validation loss decreased (-0.516652 --> -0.716657).  Saving model ...
Epoch: 3 cost time: 1.6877193450927734
Epoch: 3, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.676 Vali Acc: 0.717 Test Loss: 0.676 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 1.4734020233154297
Epoch: 4, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.587 Vali Acc: 0.756 Test Loss: 0.587 Test Acc: 0.756
Validation loss decreased (-0.716660 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 1.5438158512115479
Epoch: 5, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.486 Vali Acc: 0.756 Test Loss: 0.486 Test Acc: 0.756
Validation loss decreased (-0.755550 --> -0.755551).  Saving model ...
Epoch: 6 cost time: 1.7557225227355957
Epoch: 6, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.453 Vali Acc: 0.789 Test Loss: 0.453 Test Acc: 0.789
Validation loss decreased (-0.755551 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 1.9698657989501953
Epoch: 7, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.422 Vali Acc: 0.783 Test Loss: 0.422 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.97969651222229
Epoch: 8, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.379 Vali Acc: 0.794 Test Loss: 0.379 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794441).  Saving model ...
Epoch: 9 cost time: 1.7259416580200195
Epoch: 9, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.355 Vali Acc: 0.844 Test Loss: 0.355 Test Acc: 0.844
Validation loss decreased (-0.794441 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 1.6044721603393555
Epoch: 10, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.354 Vali Acc: 0.833 Test Loss: 0.354 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8097307682037354
Epoch: 11, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 1.7006700038909912
Epoch: 12, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.340 Vali Acc: 0.822 Test Loss: 0.340 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9473247528076172
Epoch: 13, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.326 Vali Acc: 0.839 Test Loss: 0.326 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.810995101928711
Epoch: 14, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.311 Vali Acc: 0.844 Test Loss: 0.311 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7031662464141846
Epoch: 15, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 1.9707930088043213
Epoch: 16, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 1.8886284828186035
Epoch: 17, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.695486068725586
Epoch: 18, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.386 Vali Acc: 0.828 Test Loss: 0.386 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8112199306488037
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.349 Vali Acc: 0.872 Test Loss: 0.349 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9672212600708008
Epoch: 20, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894441).  Saving model ...
Epoch: 21 cost time: 1.7440545558929443
Epoch: 21, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.386 Vali Acc: 0.817 Test Loss: 0.386 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5977377891540527
Epoch: 22, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.370 Vali Acc: 0.856 Test Loss: 0.370 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5211029052734375
Epoch: 23, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 1.5771057605743408
Epoch: 24, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.326 Vali Acc: 0.883 Test Loss: 0.326 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7843852043151855
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.600287675857544
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.568934440612793
Epoch: 27, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5253441333770752
Epoch: 28, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.393 Vali Acc: 0.844 Test Loss: 0.393 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6111414432525635
Epoch: 29, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6943771839141846
Epoch: 30, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.470076322555542
Epoch: 31, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7854783535003662
Epoch: 32, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.9351482391357422
Epoch: 33, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.382 Vali Acc: 0.839 Test Loss: 0.382 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5481793880462646
Epoch: 34, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.7766106128692627
Epoch: 35, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.8078663349151611
Epoch: 36, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.66642165184021
Epoch: 37, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.6680643558502197
Epoch: 38, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.356 Vali Acc: 0.894 Test Loss: 0.356 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.7070484161376953
Epoch: 39, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.318 Vali Acc: 0.906 Test Loss: 0.318 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.7444977760314941
Epoch: 40, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 653286
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.632800817489624
Epoch: 1, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.427 Vali Acc: 0.511 Test Loss: 1.427 Test Acc: 0.511
Validation loss decreased (inf --> -0.511097).  Saving model ...
Epoch: 2 cost time: 1.5809786319732666
Epoch: 2, Steps: 12 | Train Loss: 1.185 Vali Loss: 0.924 Vali Acc: 0.678 Test Loss: 0.924 Test Acc: 0.678
Validation loss decreased (-0.511097 --> -0.677769).  Saving model ...
Epoch: 3 cost time: 1.452204942703247
Epoch: 3, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.683 Vali Acc: 0.711 Test Loss: 0.683 Test Acc: 0.711
Validation loss decreased (-0.677769 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.5817279815673828
Epoch: 4, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.577 Vali Acc: 0.733 Test Loss: 0.577 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733328).  Saving model ...
Epoch: 5 cost time: 1.6530203819274902
Epoch: 5, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.478 Vali Acc: 0.772 Test Loss: 0.478 Test Acc: 0.772
Validation loss decreased (-0.733328 --> -0.772217).  Saving model ...
Epoch: 6 cost time: 1.3931190967559814
Epoch: 6, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.441 Vali Acc: 0.794 Test Loss: 0.441 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 1.6069982051849365
Epoch: 7, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.407 Vali Acc: 0.789 Test Loss: 0.407 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5942492485046387
Epoch: 8, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.370 Vali Acc: 0.817 Test Loss: 0.370 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816663).  Saving model ...
Epoch: 9 cost time: 1.6531894207000732
Epoch: 9, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.338 Vali Acc: 0.850 Test Loss: 0.338 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 1.6167614459991455
Epoch: 10, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.339 Vali Acc: 0.822 Test Loss: 0.339 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7341065406799316
Epoch: 11, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 1.5376207828521729
Epoch: 12, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.334 Vali Acc: 0.822 Test Loss: 0.334 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5211045742034912
Epoch: 13, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6056444644927979
Epoch: 14, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.296 Vali Acc: 0.856 Test Loss: 0.296 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 15 cost time: 1.464768648147583
Epoch: 15, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 1.5647649765014648
Epoch: 16, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 1.6839547157287598
Epoch: 17, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.7187342643737793
Epoch: 18, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.355 Vali Acc: 0.844 Test Loss: 0.355 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.450070858001709
Epoch: 19, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.316 Vali Acc: 0.878 Test Loss: 0.316 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6116292476654053
Epoch: 20, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4289906024932861
Epoch: 21, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6355464458465576
Epoch: 22, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.363 Vali Acc: 0.861 Test Loss: 0.363 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6677141189575195
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 1.7566254138946533
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 25 cost time: 1.7248320579528809
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.266 Vali Acc: 0.911 Test Loss: 0.266 Test Acc: 0.911
Validation loss decreased (-0.894441 --> -0.911108).  Saving model ...
Epoch: 26 cost time: 1.733572006225586
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 27 cost time: 1.6000590324401855
Epoch: 27, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5182933807373047
Epoch: 28, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.222 Vali Acc: 0.900 Test Loss: 0.222 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6629629135131836
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.5160026550292969
Epoch: 30, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6858696937561035
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4768846035003662
Epoch: 32, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5020265579223633
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.6316030025482178
Epoch: 34, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.6652312278747559
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.238 Vali Acc: 0.906 Test Loss: 0.238 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.5419878959655762
Epoch: 36, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.5469732284545898
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.4489221572875977
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 39 cost time: 1.5150198936462402
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3826537132263184
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3744401931762695
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4936416149139404
Epoch: 42, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.460529088973999
Epoch: 43, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5231261253356934
Epoch: 44, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.5383872985839844
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.6595897674560547
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.7531459331512451
Epoch: 47, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.762 Vali Acc: 0.850 Test Loss: 0.762 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.6823508739471436
Epoch: 48, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 653286
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.86604642868042
Epoch: 1, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.478 Vali Acc: 0.444 Test Loss: 1.478 Test Acc: 0.444
Validation loss decreased (inf --> -0.444430).  Saving model ...
Epoch: 2 cost time: 1.8541803359985352
Epoch: 2, Steps: 12 | Train Loss: 1.330 Vali Loss: 0.994 Vali Acc: 0.672 Test Loss: 0.994 Test Acc: 0.672
Validation loss decreased (-0.444430 --> -0.672212).  Saving model ...
Epoch: 3 cost time: 1.7438430786132812
Epoch: 3, Steps: 12 | Train Loss: 0.908 Vali Loss: 0.717 Vali Acc: 0.711 Test Loss: 0.717 Test Acc: 0.711
Validation loss decreased (-0.672212 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.6835060119628906
Epoch: 4, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.587 Vali Acc: 0.772 Test Loss: 0.587 Test Acc: 0.772
Validation loss decreased (-0.711104 --> -0.772216).  Saving model ...
Epoch: 5 cost time: 1.5745964050292969
Epoch: 5, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.495 Vali Acc: 0.778 Test Loss: 0.495 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 1.737802505493164
Epoch: 6, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.456 Vali Acc: 0.761 Test Loss: 0.456 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.501307725906372
Epoch: 7, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.415 Vali Acc: 0.806 Test Loss: 0.415 Test Acc: 0.806
Validation loss decreased (-0.777773 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 1.5312740802764893
Epoch: 8, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.387 Vali Acc: 0.806 Test Loss: 0.387 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805552).  Saving model ...
Epoch: 9 cost time: 1.6724441051483154
Epoch: 9, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.363 Vali Acc: 0.828 Test Loss: 0.363 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 1.55965256690979
Epoch: 10, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.355 Vali Acc: 0.806 Test Loss: 0.355 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7938387393951416
Epoch: 11, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6085619926452637
Epoch: 12, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.328 Vali Acc: 0.822 Test Loss: 0.328 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7721450328826904
Epoch: 13, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 14 cost time: 1.4370930194854736
Epoch: 14, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 1.7225401401519775
Epoch: 15, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6308977603912354
Epoch: 16, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.393 Vali Acc: 0.811 Test Loss: 0.393 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.877744436264038
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.310 Vali Acc: 0.833 Test Loss: 0.310 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9468154907226562
Epoch: 18, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.296 Vali Acc: 0.844 Test Loss: 0.296 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.756309986114502
Epoch: 19, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 1.7163095474243164
Epoch: 20, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.335 Vali Acc: 0.822 Test Loss: 0.335 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7508955001831055
Epoch: 21, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 1.7612321376800537
Epoch: 22, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.317 Vali Acc: 0.861 Test Loss: 0.317 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7490429878234863
Epoch: 23, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.312 Vali Acc: 0.833 Test Loss: 0.312 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5166325569152832
Epoch: 24, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5321810245513916
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3853964805603027
Epoch: 26, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.320 Vali Acc: 0.867 Test Loss: 0.320 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.467099666595459
Epoch: 27, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3999762535095215
Epoch: 28, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6309325695037842
Epoch: 29, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5206882953643799
Epoch: 30, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5363619327545166
Epoch: 31, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 391142
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.056291341781616
Epoch: 1, Steps: 12 | Train Loss: 1.811 Vali Loss: 1.472 Vali Acc: 0.444 Test Loss: 1.472 Test Acc: 0.444
Validation loss decreased (inf --> -0.444430).  Saving model ...
Epoch: 2 cost time: 1.7164740562438965
Epoch: 2, Steps: 12 | Train Loss: 1.308 Vali Loss: 0.990 Vali Acc: 0.667 Test Loss: 0.990 Test Acc: 0.667
Validation loss decreased (-0.444430 --> -0.666657).  Saving model ...
Epoch: 3 cost time: 1.5823190212249756
Epoch: 3, Steps: 12 | Train Loss: 0.911 Vali Loss: 0.715 Vali Acc: 0.711 Test Loss: 0.715 Test Acc: 0.711
Validation loss decreased (-0.666657 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.5497822761535645
Epoch: 4, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.584 Vali Acc: 0.772 Test Loss: 0.584 Test Acc: 0.772
Validation loss decreased (-0.711104 --> -0.772216).  Saving model ...
Epoch: 5 cost time: 1.5775716304779053
Epoch: 5, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.492 Vali Acc: 0.783 Test Loss: 0.492 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 1.6632530689239502
Epoch: 6, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.451 Vali Acc: 0.756 Test Loss: 0.451 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.695434331893921
Epoch: 7, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.410 Vali Acc: 0.811 Test Loss: 0.410 Test Acc: 0.811
Validation loss decreased (-0.783328 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 1.6606826782226562
Epoch: 8, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.389 Vali Acc: 0.811 Test Loss: 0.389 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 1.7971670627593994
Epoch: 9, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 1.7236597537994385
Epoch: 10, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.359 Vali Acc: 0.794 Test Loss: 0.359 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7447490692138672
Epoch: 11, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.346 Vali Acc: 0.817 Test Loss: 0.346 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5555968284606934
Epoch: 12, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.337 Vali Acc: 0.828 Test Loss: 0.337 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6694252490997314
Epoch: 13, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.338 Vali Acc: 0.844 Test Loss: 0.338 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.541762351989746
Epoch: 14, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 1.3411686420440674
Epoch: 15, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3904674053192139
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.377 Vali Acc: 0.817 Test Loss: 0.377 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.453772783279419
Epoch: 17, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.303 Vali Acc: 0.833 Test Loss: 0.303 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7642252445220947
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.297 Vali Acc: 0.839 Test Loss: 0.297 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.522031545639038
Epoch: 19, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 1.4314601421356201
Epoch: 20, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.561239242553711
Epoch: 21, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 1.5895166397094727
Epoch: 22, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.320 Vali Acc: 0.856 Test Loss: 0.320 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6990461349487305
Epoch: 23, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.333 Vali Acc: 0.828 Test Loss: 0.333 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.705132007598877
Epoch: 24, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5713095664978027
Epoch: 25, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.731186866760254
Epoch: 26, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.332 Vali Acc: 0.867 Test Loss: 0.332 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7097585201263428
Epoch: 27, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.352 Vali Acc: 0.839 Test Loss: 0.352 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7918930053710938
Epoch: 28, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.537975549697876
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7799246311187744
Epoch: 30, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.7336983680725098
Epoch: 31, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 391142
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8613805770874023
Epoch: 1, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.480 Vali Acc: 0.406 Test Loss: 1.480 Test Acc: 0.406
Validation loss decreased (inf --> -0.405541).  Saving model ...
Epoch: 2 cost time: 1.7999725341796875
Epoch: 2, Steps: 12 | Train Loss: 1.289 Vali Loss: 0.988 Vali Acc: 0.678 Test Loss: 0.988 Test Acc: 0.678
Validation loss decreased (-0.405541 --> -0.677768).  Saving model ...
Epoch: 3 cost time: 1.8549997806549072
Epoch: 3, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.713 Vali Acc: 0.717 Test Loss: 0.713 Test Acc: 0.717
Validation loss decreased (-0.677768 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 1.8862810134887695
Epoch: 4, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.583 Vali Acc: 0.767 Test Loss: 0.583 Test Acc: 0.767
Validation loss decreased (-0.716660 --> -0.766661).  Saving model ...
Epoch: 5 cost time: 1.8722755908966064
Epoch: 5, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.490 Vali Acc: 0.800 Test Loss: 0.490 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799995).  Saving model ...
Epoch: 6 cost time: 1.6653738021850586
Epoch: 6, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.446 Vali Acc: 0.767 Test Loss: 0.446 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6376359462738037
Epoch: 7, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.411 Vali Acc: 0.817 Test Loss: 0.411 Test Acc: 0.817
Validation loss decreased (-0.799995 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.8403525352478027
Epoch: 8, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.386 Vali Acc: 0.800 Test Loss: 0.386 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.902489185333252
Epoch: 9, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.368 Vali Acc: 0.844 Test Loss: 0.368 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 2.05875563621521
Epoch: 10, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.356 Vali Acc: 0.794 Test Loss: 0.356 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7570507526397705
Epoch: 11, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.347 Vali Acc: 0.817 Test Loss: 0.347 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5789387226104736
Epoch: 12, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.331 Vali Acc: 0.806 Test Loss: 0.331 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5571863651275635
Epoch: 13, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.329 Vali Acc: 0.839 Test Loss: 0.329 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5987327098846436
Epoch: 14, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 1.6650855541229248
Epoch: 15, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.880246639251709
Epoch: 16, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9851179122924805
Epoch: 17, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.302 Vali Acc: 0.844 Test Loss: 0.302 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.840752124786377
Epoch: 18, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.730036973953247
Epoch: 19, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7078149318695068
Epoch: 20, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.309 Vali Acc: 0.839 Test Loss: 0.309 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5875251293182373
Epoch: 21, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 1.5754623413085938
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.336 Vali Acc: 0.861 Test Loss: 0.336 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5919504165649414
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.314 Vali Acc: 0.833 Test Loss: 0.314 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.779343843460083
Epoch: 24, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6933348178863525
Epoch: 25, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.534973382949829
Epoch: 26, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5651650428771973
Epoch: 27, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6085612773895264
Epoch: 28, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6077466011047363
Epoch: 29, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.315 Vali Acc: 0.883 Test Loss: 0.315 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5651354789733887
Epoch: 30, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 31 cost time: 1.5318689346313477
Epoch: 31, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4629967212677002
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.318 Vali Acc: 0.872 Test Loss: 0.318 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3985764980316162
Epoch: 33, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 34 cost time: 1.3927087783813477
Epoch: 34, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4191868305206299
Epoch: 35, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.7361304759979248
Epoch: 36, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.336 Vali Acc: 0.878 Test Loss: 0.336 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7801988124847412
Epoch: 37, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.6258554458618164
Epoch: 38, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.316 Vali Acc: 0.872 Test Loss: 0.316 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.571592092514038
Epoch: 39, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.8168940544128418
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.8961358070373535
Epoch: 41, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.6775403022766113
Epoch: 42, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.318 Vali Acc: 0.872 Test Loss: 0.318 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.786637544631958
Epoch: 43, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 391142
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8762645721435547
Epoch: 1, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.467 Vali Acc: 0.450 Test Loss: 1.467 Test Acc: 0.450
Validation loss decreased (inf --> -0.449985).  Saving model ...
Epoch: 2 cost time: 1.8155193328857422
Epoch: 2, Steps: 12 | Train Loss: 1.259 Vali Loss: 0.987 Vali Acc: 0.722 Test Loss: 0.987 Test Acc: 0.722
Validation loss decreased (-0.449985 --> -0.722212).  Saving model ...
Epoch: 3 cost time: 1.3575053215026855
Epoch: 3, Steps: 12 | Train Loss: 0.891 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4204819202423096
Epoch: 4, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.581 Vali Acc: 0.756 Test Loss: 0.581 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 1.603153944015503
Epoch: 5, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.483 Vali Acc: 0.783 Test Loss: 0.483 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 1.618337631225586
Epoch: 6, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.436 Vali Acc: 0.800 Test Loss: 0.436 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 1.9661636352539062
Epoch: 7, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.392 Vali Acc: 0.817 Test Loss: 0.392 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.706174373626709
Epoch: 8, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.362 Vali Acc: 0.822 Test Loss: 0.362 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 9 cost time: 1.5637552738189697
Epoch: 9, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.350 Vali Acc: 0.833 Test Loss: 0.350 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 1.9107961654663086
Epoch: 10, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.341 Vali Acc: 0.822 Test Loss: 0.341 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7930855751037598
Epoch: 11, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.333 Vali Acc: 0.822 Test Loss: 0.333 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5653138160705566
Epoch: 12, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.321 Vali Acc: 0.811 Test Loss: 0.321 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.653764009475708
Epoch: 13, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.5720257759094238
Epoch: 14, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 1.8645856380462646
Epoch: 15, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.318 Vali Acc: 0.833 Test Loss: 0.318 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8107085227966309
Epoch: 16, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.352 Vali Acc: 0.817 Test Loss: 0.352 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6064097881317139
Epoch: 17, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3909108638763428
Epoch: 18, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.266 Vali Acc: 0.861 Test Loss: 0.266 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 19 cost time: 1.6171300411224365
Epoch: 19, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 20 cost time: 1.712228775024414
Epoch: 20, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.301 Vali Acc: 0.844 Test Loss: 0.301 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5990214347839355
Epoch: 21, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.311 Vali Acc: 0.844 Test Loss: 0.311 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6640372276306152
Epoch: 22, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6270275115966797
Epoch: 23, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.272 Vali Acc: 0.861 Test Loss: 0.272 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7805571556091309
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 25 cost time: 1.6545004844665527
Epoch: 25, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.260 Vali Acc: 0.867 Test Loss: 0.260 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6431059837341309
Epoch: 26, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.336 Vali Acc: 0.867 Test Loss: 0.336 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6886889934539795
Epoch: 27, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 1.4687676429748535
Epoch: 28, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 1.4363410472869873
Epoch: 29, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.236 Vali Acc: 0.889 Test Loss: 0.236 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 30 cost time: 1.6288847923278809
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
Validation loss decreased (-0.888887 --> -0.905553).  Saving model ...
Epoch: 31 cost time: 1.7431838512420654
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 32 cost time: 1.7173528671264648
Epoch: 32, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6712024211883545
Epoch: 33, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.211 Vali Acc: 0.911 Test Loss: 0.211 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 34 cost time: 1.5869636535644531
Epoch: 34, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 35 cost time: 1.7041525840759277
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6359846591949463
Epoch: 36, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.323 Vali Acc: 0.894 Test Loss: 0.323 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4570095539093018
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 38 cost time: 1.6151812076568604
Epoch: 38, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6867661476135254
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.390 Vali Acc: 0.872 Test Loss: 0.390 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5298304557800293
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.300 Vali Acc: 0.906 Test Loss: 0.300 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.5251412391662598
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.5881524085998535
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.6587035655975342
Epoch: 43, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.7158610820770264
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.8069801330566406
Epoch: 45, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.6747474670410156
Epoch: 46, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.5471491813659668
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 391142
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5274267196655273
Epoch: 1, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.375 Vali Acc: 0.533 Test Loss: 1.375 Test Acc: 0.533
Validation loss decreased (inf --> -0.533320).  Saving model ...
Epoch: 2 cost time: 1.5489401817321777
Epoch: 2, Steps: 12 | Train Loss: 1.185 Vali Loss: 0.945 Vali Acc: 0.650 Test Loss: 0.945 Test Acc: 0.650
Validation loss decreased (-0.533320 --> -0.649991).  Saving model ...
Epoch: 3 cost time: 1.6706738471984863
Epoch: 3, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.741 Vali Acc: 0.689 Test Loss: 0.741 Test Acc: 0.689
Validation loss decreased (-0.649991 --> -0.688881).  Saving model ...
Epoch: 4 cost time: 1.5427942276000977
Epoch: 4, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.576 Vali Acc: 0.750 Test Loss: 0.576 Test Acc: 0.750
Validation loss decreased (-0.688881 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 1.7907381057739258
Epoch: 5, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.500 Vali Acc: 0.778 Test Loss: 0.500 Test Acc: 0.778
Validation loss decreased (-0.749994 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 1.691758394241333
Epoch: 6, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.444 Vali Acc: 0.794 Test Loss: 0.444 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 1.8265576362609863
Epoch: 7, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.407 Vali Acc: 0.794 Test Loss: 0.407 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 1.8173213005065918
Epoch: 8, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.381 Vali Acc: 0.800 Test Loss: 0.381 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 9 cost time: 1.7348213195800781
Epoch: 9, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.368 Vali Acc: 0.828 Test Loss: 0.368 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 1.7809014320373535
Epoch: 10, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.371 Vali Acc: 0.817 Test Loss: 0.371 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7212104797363281
Epoch: 11, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.350 Vali Acc: 0.833 Test Loss: 0.350 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 1.6947619915008545
Epoch: 12, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.378 Vali Acc: 0.822 Test Loss: 0.378 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.655071496963501
Epoch: 13, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 14 cost time: 1.3566009998321533
Epoch: 14, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.311 Vali Acc: 0.850 Test Loss: 0.311 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 1.8017230033874512
Epoch: 15, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.338 Vali Acc: 0.811 Test Loss: 0.338 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5390260219573975
Epoch: 16, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.342 Vali Acc: 0.850 Test Loss: 0.342 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7660088539123535
Epoch: 17, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 18 cost time: 1.8131475448608398
Epoch: 18, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.663848876953125
Epoch: 19, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.294 Vali Acc: 0.839 Test Loss: 0.294 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7520930767059326
Epoch: 20, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.290 Vali Acc: 0.878 Test Loss: 0.290 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 1.5536706447601318
Epoch: 21, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.749462604522705
Epoch: 22, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6648530960083008
Epoch: 23, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 24 cost time: 1.5304954051971436
Epoch: 24, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.291 Vali Acc: 0.850 Test Loss: 0.291 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8326959609985352
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8644390106201172
Epoch: 26, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.302 Vali Acc: 0.883 Test Loss: 0.302 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.949235200881958
Epoch: 27, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 1.6388185024261475
Epoch: 28, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7312922477722168
Epoch: 29, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.678044080734253
Epoch: 30, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7972431182861328
Epoch: 31, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6616570949554443
Epoch: 32, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.8483529090881348
Epoch: 33, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5848464965820312
Epoch: 34, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.7524681091308594
Epoch: 35, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.8471713066101074
Epoch: 36, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 37 cost time: 1.5677368640899658
Epoch: 37, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.695119857788086
Epoch: 38, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.6443111896514893
Epoch: 39, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6242563724517822
Epoch: 40, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.9203782081604004
Epoch: 41, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6418657302856445
Epoch: 42, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.413 Vali Acc: 0.867 Test Loss: 0.413 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.6199707984924316
Epoch: 43, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.6662898063659668
Epoch: 44, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.6828844547271729
Epoch: 45, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.7885167598724365
Epoch: 46, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 47 cost time: 1.5007672309875488
Epoch: 47, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.5817492008209229
Epoch: 48, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.287 Vali Acc: 0.894 Test Loss: 0.287 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.783247947692871
Epoch: 49, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.297 Vali Acc: 0.894 Test Loss: 0.297 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.6235182285308838
Epoch: 50, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.4851791858673096
Epoch: 51, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.448962688446045
Epoch: 52, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.716217041015625
Epoch: 53, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.8128128051757812
Epoch: 54, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.7821149826049805
Epoch: 55, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.9088332653045654
Epoch: 56, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 260070
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.563910484313965
Epoch: 1, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.373 Vali Acc: 0.528 Test Loss: 1.373 Test Acc: 0.528
Validation loss decreased (inf --> -0.527764).  Saving model ...
Epoch: 2 cost time: 1.6254887580871582
Epoch: 2, Steps: 12 | Train Loss: 1.179 Vali Loss: 0.943 Vali Acc: 0.644 Test Loss: 0.943 Test Acc: 0.644
Validation loss decreased (-0.527764 --> -0.644435).  Saving model ...
Epoch: 3 cost time: 1.6998710632324219
Epoch: 3, Steps: 12 | Train Loss: 0.834 Vali Loss: 0.737 Vali Acc: 0.678 Test Loss: 0.737 Test Acc: 0.678
Validation loss decreased (-0.644435 --> -0.677770).  Saving model ...
Epoch: 4 cost time: 1.8101592063903809
Epoch: 4, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.575 Vali Acc: 0.733 Test Loss: 0.575 Test Acc: 0.733
Validation loss decreased (-0.677770 --> -0.733328).  Saving model ...
Epoch: 5 cost time: 1.8042712211608887
Epoch: 5, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.498 Vali Acc: 0.778 Test Loss: 0.498 Test Acc: 0.778
Validation loss decreased (-0.733328 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 1.7008507251739502
Epoch: 6, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.439 Vali Acc: 0.789 Test Loss: 0.439 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 1.7520031929016113
Epoch: 7, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.405 Vali Acc: 0.806 Test Loss: 0.405 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805552).  Saving model ...
Epoch: 8 cost time: 1.826897382736206
Epoch: 8, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.382 Vali Acc: 0.806 Test Loss: 0.382 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 9 cost time: 1.8194236755371094
Epoch: 9, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
Validation loss decreased (-0.805552 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 1.7216382026672363
Epoch: 10, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.369 Vali Acc: 0.806 Test Loss: 0.369 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8581297397613525
Epoch: 11, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 1.8214502334594727
Epoch: 12, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.379 Vali Acc: 0.822 Test Loss: 0.379 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7940142154693604
Epoch: 13, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.344 Vali Acc: 0.844 Test Loss: 0.344 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.8796958923339844
Epoch: 14, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.315 Vali Acc: 0.878 Test Loss: 0.315 Test Acc: 0.878
Validation loss decreased (-0.844441 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.7245314121246338
Epoch: 15, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.341 Vali Acc: 0.806 Test Loss: 0.341 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9147002696990967
Epoch: 16, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6896803379058838
Epoch: 17, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 1.643927812576294
Epoch: 18, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.320 Vali Acc: 0.833 Test Loss: 0.320 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7578637599945068
Epoch: 19, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.299 Vali Acc: 0.844 Test Loss: 0.299 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6173419952392578
Epoch: 20, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 1.6795828342437744
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5811808109283447
Epoch: 22, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.325 Vali Acc: 0.856 Test Loss: 0.325 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7137916088104248
Epoch: 23, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 1.4633173942565918
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5529990196228027
Epoch: 25, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6409249305725098
Epoch: 26, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.741595983505249
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7921736240386963
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6154026985168457
Epoch: 29, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8647465705871582
Epoch: 30, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.9586589336395264
Epoch: 31, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.677659273147583
Epoch: 32, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7340538501739502
Epoch: 33, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 1.6625194549560547
Epoch: 34, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6554594039916992
Epoch: 35, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.8996477127075195
Epoch: 36, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 37 cost time: 1.6685938835144043
Epoch: 37, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8483667373657227
Epoch: 38, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.82883882522583
Epoch: 39, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.60581636428833
Epoch: 40, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.6674461364746094
Epoch: 41, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.473 Vali Acc: 0.839 Test Loss: 0.473 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.8250160217285156
Epoch: 42, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.416 Vali Acc: 0.867 Test Loss: 0.416 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.5644457340240479
Epoch: 43, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.583787441253662
Epoch: 44, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.782487392425537
Epoch: 45, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.6143851280212402
Epoch: 46, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 260070
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.674283504486084
Epoch: 1, Steps: 12 | Train Loss: 1.633 Vali Loss: 1.369 Vali Acc: 0.522 Test Loss: 1.369 Test Acc: 0.522
Validation loss decreased (inf --> -0.522209).  Saving model ...
Epoch: 2 cost time: 1.7413947582244873
Epoch: 2, Steps: 12 | Train Loss: 1.174 Vali Loss: 0.937 Vali Acc: 0.656 Test Loss: 0.937 Test Acc: 0.656
Validation loss decreased (-0.522209 --> -0.655546).  Saving model ...
Epoch: 3 cost time: 1.475494384765625
Epoch: 3, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.733 Vali Acc: 0.683 Test Loss: 0.733 Test Acc: 0.683
Validation loss decreased (-0.655546 --> -0.683326).  Saving model ...
Epoch: 4 cost time: 1.766172170639038
Epoch: 4, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.570 Vali Acc: 0.744 Test Loss: 0.570 Test Acc: 0.744
Validation loss decreased (-0.683326 --> -0.744439).  Saving model ...
Epoch: 5 cost time: 1.6329596042633057
Epoch: 5, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.494 Vali Acc: 0.789 Test Loss: 0.494 Test Acc: 0.789
Validation loss decreased (-0.744439 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 1.7216062545776367
Epoch: 6, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.431 Vali Acc: 0.800 Test Loss: 0.431 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 1.8665378093719482
Epoch: 7, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.396 Vali Acc: 0.794 Test Loss: 0.396 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7351622581481934
Epoch: 8, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.374 Vali Acc: 0.828 Test Loss: 0.374 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 1.5666677951812744
Epoch: 9, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.360 Vali Acc: 0.839 Test Loss: 0.360 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 1.7154021263122559
Epoch: 10, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.360 Vali Acc: 0.811 Test Loss: 0.360 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.557175874710083
Epoch: 11, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.348 Vali Acc: 0.839 Test Loss: 0.348 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 1.6447527408599854
Epoch: 12, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.370 Vali Acc: 0.811 Test Loss: 0.370 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7461588382720947
Epoch: 13, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.340 Vali Acc: 0.844 Test Loss: 0.340 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.6101579666137695
Epoch: 14, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.310 Vali Acc: 0.872 Test Loss: 0.310 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 1.8335518836975098
Epoch: 15, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.328 Vali Acc: 0.817 Test Loss: 0.328 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9212546348571777
Epoch: 16, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7432315349578857
Epoch: 17, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 1.7928869724273682
Epoch: 18, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7015628814697266
Epoch: 19, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.286 Vali Acc: 0.856 Test Loss: 0.286 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7765858173370361
Epoch: 20, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 1.7423338890075684
Epoch: 21, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8370838165283203
Epoch: 22, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7867085933685303
Epoch: 23, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 1.609205961227417
Epoch: 24, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8049230575561523
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3974027633666992
Epoch: 26, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3999302387237549
Epoch: 27, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4445574283599854
Epoch: 28, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.311 Vali Acc: 0.850 Test Loss: 0.311 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.485450267791748
Epoch: 29, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.320 Vali Acc: 0.867 Test Loss: 0.320 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8681178092956543
Epoch: 30, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5540106296539307
Epoch: 31, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.4429106712341309
Epoch: 32, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.489046573638916
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 260070
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.00705099105835
Epoch: 1, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.390 Vali Acc: 0.533 Test Loss: 1.390 Test Acc: 0.533
Validation loss decreased (inf --> -0.533319).  Saving model ...
Epoch: 2 cost time: 1.6241729259490967
Epoch: 2, Steps: 12 | Train Loss: 1.201 Vali Loss: 0.956 Vali Acc: 0.683 Test Loss: 0.956 Test Acc: 0.683
Validation loss decreased (-0.533319 --> -0.683324).  Saving model ...
Epoch: 3 cost time: 1.5930917263031006
Epoch: 3, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.743 Vali Acc: 0.678 Test Loss: 0.743 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6390619277954102
Epoch: 4, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.579 Vali Acc: 0.733 Test Loss: 0.579 Test Acc: 0.733
Validation loss decreased (-0.683324 --> -0.733328).  Saving model ...
Epoch: 5 cost time: 1.668886661529541
Epoch: 5, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.495 Vali Acc: 0.778 Test Loss: 0.495 Test Acc: 0.778
Validation loss decreased (-0.733328 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 1.8629710674285889
Epoch: 6, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.435 Vali Acc: 0.806 Test Loss: 0.435 Test Acc: 0.806
Validation loss decreased (-0.777773 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 1.418139934539795
Epoch: 7, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.393 Vali Acc: 0.794 Test Loss: 0.393 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4751617908477783
Epoch: 8, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.369 Vali Acc: 0.817 Test Loss: 0.369 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 9 cost time: 1.4912049770355225
Epoch: 9, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.350 Vali Acc: 0.811 Test Loss: 0.350 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6164839267730713
Epoch: 10, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 11 cost time: 1.741471767425537
Epoch: 11, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 1.6008031368255615
Epoch: 12, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.363 Vali Acc: 0.828 Test Loss: 0.363 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4063739776611328
Epoch: 13, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.323 Vali Acc: 0.828 Test Loss: 0.323 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4978535175323486
Epoch: 14, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
Validation loss decreased (-0.833330 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 1.573103904724121
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.341 Vali Acc: 0.822 Test Loss: 0.341 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5353398323059082
Epoch: 16, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.321 Vali Acc: 0.839 Test Loss: 0.321 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5371959209442139
Epoch: 17, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.264 Vali Acc: 0.867 Test Loss: 0.264 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4896893501281738
Epoch: 18, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6397392749786377
Epoch: 19, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.269 Vali Acc: 0.861 Test Loss: 0.269 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6406097412109375
Epoch: 20, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 21 cost time: 1.606328010559082
Epoch: 21, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.287 Vali Acc: 0.856 Test Loss: 0.287 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6049120426177979
Epoch: 22, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5999484062194824
Epoch: 23, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.6203858852386475
Epoch: 24, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.558929204940796
Epoch: 25, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.252 Vali Acc: 0.867 Test Loss: 0.252 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9488608837127686
Epoch: 26, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8418858051300049
Epoch: 27, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.247 Vali Acc: 0.883 Test Loss: 0.247 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.567194938659668
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8311805725097656
Epoch: 29, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.350 Vali Acc: 0.839 Test Loss: 0.350 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6087150573730469
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.242 Vali Acc: 0.878 Test Loss: 0.242 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.6849305629730225
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6964945793151855
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.245 Vali Acc: 0.911 Test Loss: 0.245 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 33 cost time: 1.6448235511779785
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.6426129341125488
Epoch: 34, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6248137950897217
Epoch: 35, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6924819946289062
Epoch: 36, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.347 Vali Acc: 0.867 Test Loss: 0.347 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.9940922260284424
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.260 Vali Acc: 0.872 Test Loss: 0.260 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.784031867980957
Epoch: 38, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.324 Vali Acc: 0.878 Test Loss: 0.324 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.8207030296325684
Epoch: 39, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.706 Vali Acc: 0.828 Test Loss: 0.706 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.6756815910339355
Epoch: 40, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.555117130279541
Epoch: 41, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.8796055316925049
Epoch: 42, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.634765863418579
Epoch: 43, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 260070
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.754974365234375
Epoch: 1, Steps: 12 | Train Loss: 1.960 Vali Loss: 1.556 Vali Acc: 0.406 Test Loss: 1.556 Test Acc: 0.406
Validation loss decreased (inf --> -0.405540).  Saving model ...
Epoch: 2 cost time: 1.6215293407440186
Epoch: 2, Steps: 12 | Train Loss: 1.367 Vali Loss: 1.025 Vali Acc: 0.661 Test Loss: 1.025 Test Acc: 0.661
Validation loss decreased (-0.405540 --> -0.661101).  Saving model ...
Epoch: 3 cost time: 1.4957990646362305
Epoch: 3, Steps: 12 | Train Loss: 0.895 Vali Loss: 0.734 Vali Acc: 0.706 Test Loss: 0.734 Test Acc: 0.706
Validation loss decreased (-0.661101 --> -0.705548).  Saving model ...
Epoch: 4 cost time: 1.5933058261871338
Epoch: 4, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.613 Vali Acc: 0.694 Test Loss: 0.613 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6135802268981934
Epoch: 5, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.521 Vali Acc: 0.744 Test Loss: 0.521 Test Acc: 0.744
Validation loss decreased (-0.705548 --> -0.744439).  Saving model ...
Epoch: 6 cost time: 1.5114936828613281
Epoch: 6, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.462 Vali Acc: 0.756 Test Loss: 0.462 Test Acc: 0.756
Validation loss decreased (-0.744439 --> -0.755551).  Saving model ...
Epoch: 7 cost time: 1.476813793182373
Epoch: 7, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.444 Vali Acc: 0.772 Test Loss: 0.444 Test Acc: 0.772
Validation loss decreased (-0.755551 --> -0.772218).  Saving model ...
Epoch: 8 cost time: 1.5183165073394775
Epoch: 8, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.436 Vali Acc: 0.783 Test Loss: 0.436 Test Acc: 0.783
Validation loss decreased (-0.772218 --> -0.783329).  Saving model ...
Epoch: 9 cost time: 1.7488551139831543
Epoch: 9, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.392 Vali Acc: 0.783 Test Loss: 0.392 Test Acc: 0.783
Validation loss decreased (-0.783329 --> -0.783329).  Saving model ...
Epoch: 10 cost time: 1.5219876766204834
Epoch: 10, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.357 Vali Acc: 0.828 Test Loss: 0.357 Test Acc: 0.828
Validation loss decreased (-0.783329 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 1.5201942920684814
Epoch: 11, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.355 Vali Acc: 0.817 Test Loss: 0.355 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5717105865478516
Epoch: 12, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.381 Vali Acc: 0.794 Test Loss: 0.381 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5150444507598877
Epoch: 13, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.365 Vali Acc: 0.794 Test Loss: 0.365 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.661719799041748
Epoch: 14, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.350 Vali Acc: 0.811 Test Loss: 0.350 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5856223106384277
Epoch: 15, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 1.6064331531524658
Epoch: 16, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.332 Vali Acc: 0.844 Test Loss: 0.332 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4571406841278076
Epoch: 17, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.358 Vali Acc: 0.839 Test Loss: 0.358 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5747253894805908
Epoch: 18, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 19 cost time: 1.4777038097381592
Epoch: 19, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.532076358795166
Epoch: 20, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 21 cost time: 1.4710006713867188
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.371 Vali Acc: 0.822 Test Loss: 0.371 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.671065092086792
Epoch: 22, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7046444416046143
Epoch: 23, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.361 Vali Acc: 0.828 Test Loss: 0.361 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.729661464691162
Epoch: 24, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.339 Vali Acc: 0.856 Test Loss: 0.339 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6902410984039307
Epoch: 25, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.298 Vali Acc: 0.878 Test Loss: 0.298 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 26 cost time: 1.7795376777648926
Epoch: 26, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9362053871154785
Epoch: 27, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894441).  Saving model ...
Epoch: 28 cost time: 1.8316316604614258
Epoch: 28, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.729090690612793
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.371 Vali Acc: 0.856 Test Loss: 0.371 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8184869289398193
Epoch: 30, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5930852890014648
Epoch: 31, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.331 Vali Acc: 0.883 Test Loss: 0.331 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5142028331756592
Epoch: 32, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 1.620893955230713
Epoch: 33, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4270546436309814
Epoch: 34, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 35 cost time: 1.628312110900879
Epoch: 35, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 36 cost time: 1.5625128746032715
Epoch: 36, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5507807731628418
Epoch: 37, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6514582633972168
Epoch: 38, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.666987657546997
Epoch: 39, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.8338932991027832
Epoch: 40, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.5297460556030273
Epoch: 41, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.328 Vali Acc: 0.894 Test Loss: 0.328 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.704627275466919
Epoch: 42, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.339 Vali Acc: 0.856 Test Loss: 0.339 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.71895432472229
Epoch: 43, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.351 Vali Acc: 0.883 Test Loss: 0.351 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.8142061233520508
Epoch: 44, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.333 Vali Acc: 0.878 Test Loss: 0.333 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.87284517288208
Epoch: 45, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.406 Vali Acc: 0.867 Test Loss: 0.406 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 194534
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.610663890838623
Epoch: 1, Steps: 12 | Train Loss: 1.971 Vali Loss: 1.554 Vali Acc: 0.383 Test Loss: 1.554 Test Acc: 0.383
Validation loss decreased (inf --> -0.383318).  Saving model ...
Epoch: 2 cost time: 1.3959746360778809
Epoch: 2, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.021 Vali Acc: 0.678 Test Loss: 1.021 Test Acc: 0.678
Validation loss decreased (-0.383318 --> -0.677768).  Saving model ...
Epoch: 3 cost time: 1.5415821075439453
Epoch: 3, Steps: 12 | Train Loss: 0.890 Vali Loss: 0.729 Vali Acc: 0.711 Test Loss: 0.729 Test Acc: 0.711
Validation loss decreased (-0.677768 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.478905439376831
Epoch: 4, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.608 Vali Acc: 0.711 Test Loss: 0.608 Test Acc: 0.711
Validation loss decreased (-0.711104 --> -0.711105).  Saving model ...
Epoch: 5 cost time: 1.6300756931304932
Epoch: 5, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.520 Vali Acc: 0.756 Test Loss: 0.520 Test Acc: 0.756
Validation loss decreased (-0.711105 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 1.7726693153381348
Epoch: 6, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.462 Vali Acc: 0.733 Test Loss: 0.462 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6000292301177979
Epoch: 7, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.437 Vali Acc: 0.778 Test Loss: 0.437 Test Acc: 0.778
Validation loss decreased (-0.755550 --> -0.777773).  Saving model ...
Epoch: 8 cost time: 1.6195869445800781
Epoch: 8, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.431 Vali Acc: 0.778 Test Loss: 0.431 Test Acc: 0.778
Validation loss decreased (-0.777773 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.4754483699798584
Epoch: 9, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.390 Vali Acc: 0.772 Test Loss: 0.390 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6392710208892822
Epoch: 10, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.353 Vali Acc: 0.828 Test Loss: 0.353 Test Acc: 0.828
Validation loss decreased (-0.777773 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 1.4612863063812256
Epoch: 11, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.351 Vali Acc: 0.822 Test Loss: 0.351 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5892696380615234
Epoch: 12, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.387 Vali Acc: 0.800 Test Loss: 0.387 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.547685146331787
Epoch: 13, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.368 Vali Acc: 0.800 Test Loss: 0.368 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5883960723876953
Epoch: 14, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.348 Vali Acc: 0.806 Test Loss: 0.348 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.63560152053833
Epoch: 15, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 1.6707501411437988
Epoch: 16, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5388612747192383
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.360 Vali Acc: 0.844 Test Loss: 0.360 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.676182508468628
Epoch: 18, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 1.6325137615203857
Epoch: 19, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.686772108078003
Epoch: 20, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5374982357025146
Epoch: 21, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.354 Vali Acc: 0.828 Test Loss: 0.354 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6734585762023926
Epoch: 22, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5640685558319092
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.338 Vali Acc: 0.828 Test Loss: 0.338 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6473193168640137
Epoch: 24, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6646766662597656
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 1.5285918712615967
Epoch: 26, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.356 Vali Acc: 0.839 Test Loss: 0.356 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.556976079940796
Epoch: 27, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 28 cost time: 1.5193204879760742
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 29 cost time: 1.6776959896087646
Epoch: 29, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.389 Vali Acc: 0.839 Test Loss: 0.389 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8149657249450684
Epoch: 30, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.316 Vali Acc: 0.872 Test Loss: 0.316 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.8422527313232422
Epoch: 31, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.326 Vali Acc: 0.878 Test Loss: 0.326 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7779169082641602
Epoch: 32, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 33 cost time: 1.7310400009155273
Epoch: 33, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.335 Vali Acc: 0.856 Test Loss: 0.335 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5839118957519531
Epoch: 34, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6947944164276123
Epoch: 35, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8463482856750488
Epoch: 36, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.283 Vali Acc: 0.911 Test Loss: 0.283 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 37 cost time: 1.6512131690979004
Epoch: 37, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.350 Vali Acc: 0.867 Test Loss: 0.350 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7181663513183594
Epoch: 38, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.6187877655029297
Epoch: 39, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.5988891124725342
Epoch: 40, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.303 Vali Acc: 0.883 Test Loss: 0.303 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.5060174465179443
Epoch: 41, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.326 Vali Acc: 0.883 Test Loss: 0.326 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.5813994407653809
Epoch: 42, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.363 Vali Acc: 0.861 Test Loss: 0.363 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.6819660663604736
Epoch: 43, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.359 Vali Acc: 0.878 Test Loss: 0.359 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.7121996879577637
Epoch: 44, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.337 Vali Acc: 0.878 Test Loss: 0.337 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.725259780883789
Epoch: 45, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.377 Vali Acc: 0.878 Test Loss: 0.377 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.6717479228973389
Epoch: 46, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 194534
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.171345233917236
Epoch: 1, Steps: 12 | Train Loss: 1.958 Vali Loss: 1.552 Vali Acc: 0.383 Test Loss: 1.552 Test Acc: 0.383
Validation loss decreased (inf --> -0.383318).  Saving model ...
Epoch: 2 cost time: 1.8364994525909424
Epoch: 2, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.019 Vali Acc: 0.678 Test Loss: 1.019 Test Acc: 0.678
Validation loss decreased (-0.383318 --> -0.677768).  Saving model ...
Epoch: 3 cost time: 1.7504925727844238
Epoch: 3, Steps: 12 | Train Loss: 0.886 Vali Loss: 0.729 Vali Acc: 0.739 Test Loss: 0.729 Test Acc: 0.739
Validation loss decreased (-0.677768 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 1.7113721370697021
Epoch: 4, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.603 Vali Acc: 0.706 Test Loss: 0.603 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7043380737304688
Epoch: 5, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.513 Vali Acc: 0.744 Test Loss: 0.513 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744439).  Saving model ...
Epoch: 6 cost time: 1.6207196712493896
Epoch: 6, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.461 Vali Acc: 0.767 Test Loss: 0.461 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 1.6754498481750488
Epoch: 7, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.438 Vali Acc: 0.767 Test Loss: 0.438 Test Acc: 0.767
Validation loss decreased (-0.766662 --> -0.766662).  Saving model ...
Epoch: 8 cost time: 1.6100215911865234
Epoch: 8, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.434 Vali Acc: 0.778 Test Loss: 0.434 Test Acc: 0.778
Validation loss decreased (-0.766662 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.563983678817749
Epoch: 9, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.390 Vali Acc: 0.767 Test Loss: 0.390 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6590139865875244
Epoch: 10, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
Validation loss decreased (-0.777773 --> -0.822219).  Saving model ...
Epoch: 11 cost time: 1.8254337310791016
Epoch: 11, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 1.4693262577056885
Epoch: 12, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.377 Vali Acc: 0.806 Test Loss: 0.377 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4815855026245117
Epoch: 13, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.358 Vali Acc: 0.800 Test Loss: 0.358 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8093833923339844
Epoch: 14, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.344 Vali Acc: 0.828 Test Loss: 0.344 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7711410522460938
Epoch: 15, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.453934669494629
Epoch: 16, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4643499851226807
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.367 Vali Acc: 0.839 Test Loss: 0.367 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7358338832855225
Epoch: 18, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 19 cost time: 1.5660443305969238
Epoch: 19, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.311 Vali Acc: 0.867 Test Loss: 0.311 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 20 cost time: 1.483957290649414
Epoch: 20, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6408793926239014
Epoch: 21, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.351 Vali Acc: 0.833 Test Loss: 0.351 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.543152093887329
Epoch: 22, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.325 Vali Acc: 0.856 Test Loss: 0.325 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5357143878936768
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.329 Vali Acc: 0.839 Test Loss: 0.329 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.528855800628662
Epoch: 24, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6022436618804932
Epoch: 25, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.301 Vali Acc: 0.894 Test Loss: 0.301 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894441).  Saving model ...
Epoch: 26 cost time: 1.634063482284546
Epoch: 26, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7478556632995605
Epoch: 27, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.325 Vali Acc: 0.867 Test Loss: 0.325 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8853142261505127
Epoch: 28, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.297 Vali Acc: 0.894 Test Loss: 0.297 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 29 cost time: 1.5700976848602295
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.426 Vali Acc: 0.844 Test Loss: 0.426 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5357463359832764
Epoch: 30, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.335 Vali Acc: 0.867 Test Loss: 0.335 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6863963603973389
Epoch: 31, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.351 Vali Acc: 0.867 Test Loss: 0.351 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6793763637542725
Epoch: 32, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 1.6937668323516846
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.346 Vali Acc: 0.856 Test Loss: 0.346 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.523207664489746
Epoch: 34, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5899291038513184
Epoch: 35, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6163201332092285
Epoch: 36, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.604480504989624
Epoch: 37, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.387 Vali Acc: 0.856 Test Loss: 0.387 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.6889839172363281
Epoch: 38, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.4632604122161865
Epoch: 39, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.312 Vali Acc: 0.878 Test Loss: 0.312 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.751671552658081
Epoch: 40, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.590188980102539
Epoch: 41, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.358 Vali Acc: 0.872 Test Loss: 0.358 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6322598457336426
Epoch: 42, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.368 Vali Acc: 0.861 Test Loss: 0.368 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 194534
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9078164100646973
Epoch: 1, Steps: 12 | Train Loss: 1.887 Vali Loss: 1.540 Vali Acc: 0.428 Test Loss: 1.540 Test Acc: 0.428
Validation loss decreased (inf --> -0.427762).  Saving model ...
Epoch: 2 cost time: 1.5809757709503174
Epoch: 2, Steps: 12 | Train Loss: 1.346 Vali Loss: 1.019 Vali Acc: 0.656 Test Loss: 1.019 Test Acc: 0.656
Validation loss decreased (-0.427762 --> -0.655545).  Saving model ...
Epoch: 3 cost time: 1.571892499923706
Epoch: 3, Steps: 12 | Train Loss: 0.865 Vali Loss: 0.727 Vali Acc: 0.733 Test Loss: 0.727 Test Acc: 0.733
Validation loss decreased (-0.655545 --> -0.733326).  Saving model ...
Epoch: 4 cost time: 1.4704413414001465
Epoch: 4, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.600 Vali Acc: 0.689 Test Loss: 0.600 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5020644664764404
Epoch: 5, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.500 Vali Acc: 0.756 Test Loss: 0.500 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755551).  Saving model ...
Epoch: 6 cost time: 1.5970962047576904
Epoch: 6, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.445 Vali Acc: 0.783 Test Loss: 0.445 Test Acc: 0.783
Validation loss decreased (-0.755551 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 1.5383806228637695
Epoch: 7, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.421 Vali Acc: 0.789 Test Loss: 0.421 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 8 cost time: 1.5436148643493652
Epoch: 8, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.404 Vali Acc: 0.800 Test Loss: 0.404 Test Acc: 0.800
Validation loss decreased (-0.788885 --> -0.799996).  Saving model ...
Epoch: 9 cost time: 1.5201997756958008
Epoch: 9, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.365 Vali Acc: 0.817 Test Loss: 0.365 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 1.6418309211730957
Epoch: 10, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.337 Vali Acc: 0.817 Test Loss: 0.337 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 11 cost time: 1.7803163528442383
Epoch: 11, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.328 Vali Acc: 0.844 Test Loss: 0.328 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 1.7393877506256104
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.359 Vali Acc: 0.811 Test Loss: 0.359 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6293296813964844
Epoch: 13, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.334 Vali Acc: 0.806 Test Loss: 0.334 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6463077068328857
Epoch: 14, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.325 Vali Acc: 0.833 Test Loss: 0.325 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.560617208480835
Epoch: 15, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
Validation loss decreased (-0.844441 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 1.6441149711608887
Epoch: 16, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.451444149017334
Epoch: 17, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.587674617767334
Epoch: 18, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.4145936965942383
Epoch: 19, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5472831726074219
Epoch: 20, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.290 Vali Acc: 0.844 Test Loss: 0.290 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4998726844787598
Epoch: 21, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5670132637023926
Epoch: 22, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5360968112945557
Epoch: 23, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.285 Vali Acc: 0.844 Test Loss: 0.285 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4741380214691162
Epoch: 24, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4577789306640625
Epoch: 25, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 1.385200023651123
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3997385501861572
Epoch: 27, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2830653190612793
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3773889541625977
Epoch: 29, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.317 Vali Acc: 0.861 Test Loss: 0.317 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5227699279785156
Epoch: 30, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.275 Vali Acc: 0.861 Test Loss: 0.275 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3812546730041504
Epoch: 31, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.420271635055542
Epoch: 32, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 33 cost time: 1.5654752254486084
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.459930181503296
Epoch: 34, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4298591613769531
Epoch: 35, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4710006713867188
Epoch: 36, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.252 Vali Acc: 0.883 Test Loss: 0.252 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5659570693969727
Epoch: 37, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.6745014190673828
Epoch: 38, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.5209503173828125
Epoch: 39, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.4840972423553467
Epoch: 40, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.5764515399932861
Epoch: 41, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.5020039081573486
Epoch: 42, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.298 Vali Acc: 0.878 Test Loss: 0.298 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 194534
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9464032649993896
Epoch: 1, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.527 Vali Acc: 0.389 Test Loss: 1.527 Test Acc: 0.389
Validation loss decreased (inf --> -0.388874).  Saving model ...
Epoch: 2 cost time: 1.5038042068481445
Epoch: 2, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.001 Vali Acc: 0.683 Test Loss: 1.001 Test Acc: 0.683
Validation loss decreased (-0.388874 --> -0.683323).  Saving model ...
Epoch: 3 cost time: 1.643805742263794
Epoch: 3, Steps: 12 | Train Loss: 0.869 Vali Loss: 0.720 Vali Acc: 0.744 Test Loss: 0.720 Test Acc: 0.744
Validation loss decreased (-0.683323 --> -0.744437).  Saving model ...
Epoch: 4 cost time: 1.5558583736419678
Epoch: 4, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.589 Vali Acc: 0.711 Test Loss: 0.589 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6832575798034668
Epoch: 5, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.506 Vali Acc: 0.739 Test Loss: 0.506 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6108322143554688
Epoch: 6, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.452 Vali Acc: 0.794 Test Loss: 0.452 Test Acc: 0.794
Validation loss decreased (-0.744437 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 1.5434184074401855
Epoch: 7, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.439 Vali Acc: 0.778 Test Loss: 0.439 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7412464618682861
Epoch: 8, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.394 Vali Acc: 0.811 Test Loss: 0.394 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 1.7542896270751953
Epoch: 9, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.363 Vali Acc: 0.794 Test Loss: 0.363 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.757643461227417
Epoch: 10, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.343 Vali Acc: 0.828 Test Loss: 0.343 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 1.50278639793396
Epoch: 11, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.344 Vali Acc: 0.844 Test Loss: 0.344 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 1.55043363571167
Epoch: 12, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.330 Vali Acc: 0.822 Test Loss: 0.330 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6877853870391846
Epoch: 13, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 1.5817162990570068
Epoch: 14, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.336 Vali Acc: 0.811 Test Loss: 0.336 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.610335111618042
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.773313283920288
Epoch: 16, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 1.6558194160461426
Epoch: 17, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6776931285858154
Epoch: 18, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6852612495422363
Epoch: 19, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 1.7473499774932861
Epoch: 20, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.303 Vali Acc: 0.856 Test Loss: 0.303 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6522459983825684
Epoch: 21, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 1.6224539279937744
Epoch: 22, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.317 Vali Acc: 0.839 Test Loss: 0.317 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7564260959625244
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6227366924285889
Epoch: 24, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6666555404663086
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6341078281402588
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5773026943206787
Epoch: 27, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 1.5298988819122314
Epoch: 28, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 29 cost time: 1.5801045894622803
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5156025886535645
Epoch: 30, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6092395782470703
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.63834810256958
Epoch: 32, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5572192668914795
Epoch: 33, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.490980863571167
Epoch: 34, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.321 Vali Acc: 0.883 Test Loss: 0.321 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.511321783065796
Epoch: 35, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 36 cost time: 1.454960823059082
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.320 Vali Acc: 0.867 Test Loss: 0.320 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6151387691497803
Epoch: 37, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6140146255493164
Epoch: 38, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6042311191558838
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.728731393814087
Epoch: 40, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.6296920776367188
Epoch: 41, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.295 Vali Acc: 0.894 Test Loss: 0.295 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.7201347351074219
Epoch: 42, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.7512991428375244
Epoch: 43, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.287 Vali Acc: 0.894 Test Loss: 0.287 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.784543514251709
Epoch: 44, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.7065143585205078
Epoch: 45, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.339 Vali Acc: 0.872 Test Loss: 0.339 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 161766
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.236560344696045
Epoch: 1, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.527 Vali Acc: 0.378 Test Loss: 1.527 Test Acc: 0.378
Validation loss decreased (inf --> -0.377763).  Saving model ...
Epoch: 2 cost time: 1.529329776763916
Epoch: 2, Steps: 12 | Train Loss: 1.279 Vali Loss: 0.999 Vali Acc: 0.689 Test Loss: 0.999 Test Acc: 0.689
Validation loss decreased (-0.377763 --> -0.688879).  Saving model ...
Epoch: 3 cost time: 1.5369200706481934
Epoch: 3, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.717 Vali Acc: 0.750 Test Loss: 0.717 Test Acc: 0.750
Validation loss decreased (-0.688879 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 1.5228841304779053
Epoch: 4, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.589 Vali Acc: 0.694 Test Loss: 0.589 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5775182247161865
Epoch: 5, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.506 Vali Acc: 0.739 Test Loss: 0.506 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5271217823028564
Epoch: 6, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.450 Vali Acc: 0.783 Test Loss: 0.450 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 1.5688586235046387
Epoch: 7, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.440 Vali Acc: 0.778 Test Loss: 0.440 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6934168338775635
Epoch: 8, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.396 Vali Acc: 0.806 Test Loss: 0.396 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805552).  Saving model ...
Epoch: 9 cost time: 1.726872444152832
Epoch: 9, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.364 Vali Acc: 0.789 Test Loss: 0.364 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6764521598815918
Epoch: 10, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.345 Vali Acc: 0.828 Test Loss: 0.345 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 1.66648530960083
Epoch: 11, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.349 Vali Acc: 0.833 Test Loss: 0.349 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 1.891345500946045
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.334 Vali Acc: 0.822 Test Loss: 0.334 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9405224323272705
Epoch: 13, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
Validation loss decreased (-0.833330 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.7471458911895752
Epoch: 14, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.326 Vali Acc: 0.822 Test Loss: 0.326 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6925833225250244
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6671628952026367
Epoch: 16, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.292 Vali Acc: 0.883 Test Loss: 0.292 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.4335167407989502
Epoch: 17, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.343 Vali Acc: 0.856 Test Loss: 0.343 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7115144729614258
Epoch: 18, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.350 Vali Acc: 0.833 Test Loss: 0.350 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6953160762786865
Epoch: 19, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 20 cost time: 1.7454707622528076
Epoch: 20, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.771104335784912
Epoch: 21, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 1.7211248874664307
Epoch: 22, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.322 Vali Acc: 0.833 Test Loss: 0.322 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7537071704864502
Epoch: 23, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 1.8953125476837158
Epoch: 24, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8408615589141846
Epoch: 25, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6062843799591064
Epoch: 26, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.608400821685791
Epoch: 27, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5180771350860596
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 29 cost time: 1.5399656295776367
Epoch: 29, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6173155307769775
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6541943550109863
Epoch: 31, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7231009006500244
Epoch: 32, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7601146697998047
Epoch: 33, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.6502115726470947
Epoch: 34, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.335 Vali Acc: 0.883 Test Loss: 0.335 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.5683503150939941
Epoch: 35, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.8177173137664795
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.338 Vali Acc: 0.861 Test Loss: 0.338 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.7352104187011719
Epoch: 37, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.6299679279327393
Epoch: 38, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.301 Vali Acc: 0.878 Test Loss: 0.301 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 161766
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8538334369659424
Epoch: 1, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.517 Vali Acc: 0.383 Test Loss: 1.517 Test Acc: 0.383
Validation loss decreased (inf --> -0.383318).  Saving model ...
Epoch: 2 cost time: 1.4659836292266846
Epoch: 2, Steps: 12 | Train Loss: 1.258 Vali Loss: 0.991 Vali Acc: 0.689 Test Loss: 0.991 Test Acc: 0.689
Validation loss decreased (-0.383318 --> -0.688879).  Saving model ...
Epoch: 3 cost time: 1.5293521881103516
Epoch: 3, Steps: 12 | Train Loss: 0.861 Vali Loss: 0.712 Vali Acc: 0.761 Test Loss: 0.712 Test Acc: 0.761
Validation loss decreased (-0.688879 --> -0.761104).  Saving model ...
Epoch: 4 cost time: 1.425419569015503
Epoch: 4, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.585 Vali Acc: 0.711 Test Loss: 0.585 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5658259391784668
Epoch: 5, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.502 Vali Acc: 0.733 Test Loss: 0.502 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5982849597930908
Epoch: 6, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.447 Vali Acc: 0.778 Test Loss: 0.447 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 1.4966545104980469
Epoch: 7, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.440 Vali Acc: 0.778 Test Loss: 0.440 Test Acc: 0.778
Validation loss decreased (-0.777773 --> -0.777773).  Saving model ...
Epoch: 8 cost time: 1.621164321899414
Epoch: 8, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
Validation loss decreased (-0.777773 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 1.619093656539917
Epoch: 9, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.362 Vali Acc: 0.800 Test Loss: 0.362 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.601928949356079
Epoch: 10, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.341 Vali Acc: 0.811 Test Loss: 0.341 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.62941312789917
Epoch: 11, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.344 Vali Acc: 0.833 Test Loss: 0.344 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 1.673494815826416
Epoch: 12, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.332 Vali Acc: 0.822 Test Loss: 0.332 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7548155784606934
Epoch: 13, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.313 Vali Acc: 0.872 Test Loss: 0.313 Test Acc: 0.872
Validation loss decreased (-0.833330 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.6853687763214111
Epoch: 14, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.323 Vali Acc: 0.817 Test Loss: 0.323 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6845436096191406
Epoch: 15, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.339 Vali Acc: 0.844 Test Loss: 0.339 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.608621597290039
Epoch: 16, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 1.6083076000213623
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.362 Vali Acc: 0.850 Test Loss: 0.362 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.514047384262085
Epoch: 18, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.351 Vali Acc: 0.833 Test Loss: 0.351 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4783899784088135
Epoch: 19, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 20 cost time: 1.4230940341949463
Epoch: 20, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6881005764007568
Epoch: 21, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 1.6543080806732178
Epoch: 22, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7694735527038574
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6381635665893555
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 1.7221899032592773
Epoch: 25, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.426163673400879
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.465442419052124
Epoch: 27, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 28 cost time: 1.687734603881836
Epoch: 28, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7074871063232422
Epoch: 29, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.46335768699646
Epoch: 30, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.6199417114257812
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.416666030883789
Epoch: 32, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.281 Vali Acc: 0.906 Test Loss: 0.281 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5233852863311768
Epoch: 33, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5830178260803223
Epoch: 34, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5613858699798584
Epoch: 35, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7457976341247559
Epoch: 36, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.336 Vali Acc: 0.850 Test Loss: 0.336 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.7126591205596924
Epoch: 37, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.5399463176727295
Epoch: 38, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.6636414527893066
Epoch: 39, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6282539367675781
Epoch: 40, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 161766
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.571312427520752
Epoch: 1, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.517 Vali Acc: 0.422 Test Loss: 1.517 Test Acc: 0.422
Validation loss decreased (inf --> -0.422207).  Saving model ...
Epoch: 2 cost time: 1.4146509170532227
Epoch: 2, Steps: 12 | Train Loss: 1.250 Vali Loss: 1.005 Vali Acc: 0.683 Test Loss: 1.005 Test Acc: 0.683
Validation loss decreased (-0.422207 --> -0.683323).  Saving model ...
Epoch: 3 cost time: 1.4862537384033203
Epoch: 3, Steps: 12 | Train Loss: 0.858 Vali Loss: 0.722 Vali Acc: 0.756 Test Loss: 0.722 Test Acc: 0.756
Validation loss decreased (-0.683323 --> -0.755548).  Saving model ...
Epoch: 4 cost time: 1.4484503269195557
Epoch: 4, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4343819618225098
Epoch: 5, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.505 Vali Acc: 0.744 Test Loss: 0.505 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4975497722625732
Epoch: 6, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.444 Vali Acc: 0.789 Test Loss: 0.444 Test Acc: 0.789
Validation loss decreased (-0.755548 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 1.4516723155975342
Epoch: 7, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.430 Vali Acc: 0.783 Test Loss: 0.430 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5990827083587646
Epoch: 8, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.390 Vali Acc: 0.828 Test Loss: 0.390 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 1.478987216949463
Epoch: 9, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.352 Vali Acc: 0.800 Test Loss: 0.352 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.429262399673462
Epoch: 10, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.335 Vali Acc: 0.822 Test Loss: 0.335 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4041774272918701
Epoch: 11, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 12 cost time: 1.566650152206421
Epoch: 12, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4796879291534424
Epoch: 13, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.297 Vali Acc: 0.883 Test Loss: 0.297 Test Acc: 0.883
Validation loss decreased (-0.838886 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.4929323196411133
Epoch: 14, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.308 Vali Acc: 0.822 Test Loss: 0.308 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3821053504943848
Epoch: 15, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.459202766418457
Epoch: 16, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.4878685474395752
Epoch: 17, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6571063995361328
Epoch: 18, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.335 Vali Acc: 0.828 Test Loss: 0.335 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4895744323730469
Epoch: 19, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 1.4906346797943115
Epoch: 20, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.611009120941162
Epoch: 21, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.270 Vali Acc: 0.872 Test Loss: 0.270 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5763983726501465
Epoch: 22, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4732863903045654
Epoch: 23, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.424736499786377
Epoch: 24, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 25 cost time: 1.3804478645324707
Epoch: 25, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6290175914764404
Epoch: 26, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7075932025909424
Epoch: 27, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5800199508666992
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 29 cost time: 1.5729413032531738
Epoch: 29, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6446638107299805
Epoch: 30, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5999500751495361
Epoch: 31, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5420215129852295
Epoch: 32, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 1.5089919567108154
Epoch: 33, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6424217224121094
Epoch: 34, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.345 Vali Acc: 0.878 Test Loss: 0.345 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5639073848724365
Epoch: 35, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6916248798370361
Epoch: 36, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5334532260894775
Epoch: 37, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.6875805854797363
Epoch: 38, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.4716262817382812
Epoch: 39, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6753690242767334
Epoch: 40, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.73630690574646
Epoch: 41, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.5995185375213623
Epoch: 42, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 161766
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.41444730758667
Epoch: 1, Steps: 12 | Train Loss: 1.647 Vali Loss: 1.488 Vali Acc: 0.411 Test Loss: 1.488 Test Acc: 0.411
Validation loss decreased (inf --> -0.411096).  Saving model ...
Epoch: 2 cost time: 1.4010636806488037
Epoch: 2, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.180 Vali Acc: 0.706 Test Loss: 1.180 Test Acc: 0.706
Validation loss decreased (-0.411096 --> -0.705544).  Saving model ...
Epoch: 3 cost time: 1.314054250717163
Epoch: 3, Steps: 12 | Train Loss: 1.080 Vali Loss: 0.936 Vali Acc: 0.722 Test Loss: 0.936 Test Acc: 0.722
Validation loss decreased (-0.705544 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 1.3784937858581543
Epoch: 4, Steps: 12 | Train Loss: 0.878 Vali Loss: 0.773 Vali Acc: 0.711 Test Loss: 0.773 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.476400375366211
Epoch: 5, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.684 Vali Acc: 0.717 Test Loss: 0.684 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3179571628570557
Epoch: 6, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.609 Vali Acc: 0.750 Test Loss: 0.609 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.4463047981262207
Epoch: 7, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.556 Vali Acc: 0.750 Test Loss: 0.556 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.4547746181488037
Epoch: 8, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.511 Vali Acc: 0.772 Test Loss: 0.511 Test Acc: 0.772
Validation loss decreased (-0.749994 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 1.389920949935913
Epoch: 9, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.474 Vali Acc: 0.767 Test Loss: 0.474 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4977319240570068
Epoch: 10, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.453 Vali Acc: 0.800 Test Loss: 0.453 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 1.2573769092559814
Epoch: 11, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.437 Vali Acc: 0.783 Test Loss: 0.437 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4585697650909424
Epoch: 12, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.431 Vali Acc: 0.772 Test Loss: 0.431 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.451486349105835
Epoch: 13, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.410 Vali Acc: 0.800 Test Loss: 0.410 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799996).  Saving model ...
Epoch: 14 cost time: 1.3928985595703125
Epoch: 14, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.398 Vali Acc: 0.800 Test Loss: 0.398 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 15 cost time: 1.3462495803833008
Epoch: 15, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.371 Vali Acc: 0.828 Test Loss: 0.371 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 1.3300247192382812
Epoch: 16, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.366 Vali Acc: 0.811 Test Loss: 0.366 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5687620639801025
Epoch: 17, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 18 cost time: 1.371070384979248
Epoch: 18, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 19 cost time: 1.3838117122650146
Epoch: 19, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 20 cost time: 1.4076552391052246
Epoch: 20, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4375622272491455
Epoch: 21, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.338 Vali Acc: 0.833 Test Loss: 0.338 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5138795375823975
Epoch: 22, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.337 Vali Acc: 0.828 Test Loss: 0.337 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4348011016845703
Epoch: 23, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 24 cost time: 1.3943119049072266
Epoch: 24, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.331 Vali Acc: 0.822 Test Loss: 0.331 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4364018440246582
Epoch: 25, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855552).  Saving model ...
Epoch: 26 cost time: 1.514613389968872
Epoch: 26, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4129185676574707
Epoch: 27, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 28 cost time: 1.2950422763824463
Epoch: 28, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 29 cost time: 1.2230679988861084
Epoch: 29, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 30 cost time: 1.2628605365753174
Epoch: 30, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 31 cost time: 1.2745773792266846
Epoch: 31, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.309 Vali Acc: 0.872 Test Loss: 0.309 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.096989393234253
Epoch: 32, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2864928245544434
Epoch: 33, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2484252452850342
Epoch: 34, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 35 cost time: 1.1834743022918701
Epoch: 35, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 36 cost time: 1.4488208293914795
Epoch: 36, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 37 cost time: 1.3100497722625732
Epoch: 37, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5206060409545898
Epoch: 38, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 39 cost time: 1.3656527996063232
Epoch: 39, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.42781400680542
Epoch: 40, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5575873851776123
Epoch: 41, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.605004072189331
Epoch: 42, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5700757503509521
Epoch: 43, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.4849567413330078
Epoch: 44, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.3049745559692383
Epoch: 45, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 46 cost time: 1.201632022857666
Epoch: 46, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4436333179473877
Epoch: 47, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.409752368927002
Epoch: 48, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.4851961135864258
Epoch: 49, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.3972351551055908
Epoch: 50, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.3289663791656494
Epoch: 51, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.4516122341156006
Epoch: 52, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.3296351432800293
Epoch: 53, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.570744514465332
Epoch: 54, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.350 Vali Acc: 0.856 Test Loss: 0.350 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.3356683254241943
Epoch: 55, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.366 Vali Acc: 0.833 Test Loss: 0.366 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 572518
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.006577253341675
Epoch: 1, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.491 Vali Acc: 0.406 Test Loss: 1.491 Test Acc: 0.406
Validation loss decreased (inf --> -0.405541).  Saving model ...
Epoch: 2 cost time: 1.4028034210205078
Epoch: 2, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.180 Vali Acc: 0.683 Test Loss: 1.180 Test Acc: 0.683
Validation loss decreased (-0.405541 --> -0.683322).  Saving model ...
Epoch: 3 cost time: 1.3623783588409424
Epoch: 3, Steps: 12 | Train Loss: 1.076 Vali Loss: 0.934 Vali Acc: 0.733 Test Loss: 0.934 Test Acc: 0.733
Validation loss decreased (-0.683322 --> -0.733324).  Saving model ...
Epoch: 4 cost time: 1.3746953010559082
Epoch: 4, Steps: 12 | Train Loss: 0.883 Vali Loss: 0.768 Vali Acc: 0.694 Test Loss: 0.768 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.409317970275879
Epoch: 5, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.682 Vali Acc: 0.711 Test Loss: 0.682 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3108108043670654
Epoch: 6, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.606 Vali Acc: 0.733 Test Loss: 0.606 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733327).  Saving model ...
Epoch: 7 cost time: 1.3270032405853271
Epoch: 7, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.552 Vali Acc: 0.750 Test Loss: 0.552 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.3466086387634277
Epoch: 8, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
Validation loss decreased (-0.749994 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.2856945991516113
Epoch: 9, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.473 Vali Acc: 0.767 Test Loss: 0.473 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4680795669555664
Epoch: 10, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.448 Vali Acc: 0.789 Test Loss: 0.448 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788884).  Saving model ...
Epoch: 11 cost time: 1.3524558544158936
Epoch: 11, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.430 Vali Acc: 0.789 Test Loss: 0.430 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788885).  Saving model ...
Epoch: 12 cost time: 1.436781883239746
Epoch: 12, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.424 Vali Acc: 0.783 Test Loss: 0.424 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4092097282409668
Epoch: 13, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.402 Vali Acc: 0.806 Test Loss: 0.402 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805552).  Saving model ...
Epoch: 14 cost time: 1.3141987323760986
Epoch: 14, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.395 Vali Acc: 0.806 Test Loss: 0.395 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 15 cost time: 1.302863359451294
Epoch: 15, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.368 Vali Acc: 0.828 Test Loss: 0.368 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 1.385319709777832
Epoch: 16, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.361 Vali Acc: 0.811 Test Loss: 0.361 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3753204345703125
Epoch: 17, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.357 Vali Acc: 0.822 Test Loss: 0.357 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5100314617156982
Epoch: 18, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.341 Vali Acc: 0.828 Test Loss: 0.341 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 1.4139809608459473
Epoch: 19, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 20 cost time: 1.4022977352142334
Epoch: 20, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 21 cost time: 1.6729497909545898
Epoch: 21, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.337 Vali Acc: 0.833 Test Loss: 0.337 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.310708999633789
Epoch: 22, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 23 cost time: 1.4421539306640625
Epoch: 23, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.315 Vali Acc: 0.822 Test Loss: 0.315 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3917269706726074
Epoch: 24, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.333 Vali Acc: 0.822 Test Loss: 0.333 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4578402042388916
Epoch: 25, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5457069873809814
Epoch: 26, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 27 cost time: 1.5090889930725098
Epoch: 27, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5728936195373535
Epoch: 28, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.296 Vali Acc: 0.850 Test Loss: 0.296 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 29 cost time: 1.4181091785430908
Epoch: 29, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 30 cost time: 1.323991298675537
Epoch: 30, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 31 cost time: 1.3227877616882324
Epoch: 31, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 32 cost time: 1.290651798248291
Epoch: 32, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3236949443817139
Epoch: 33, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.301623821258545
Epoch: 34, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5527534484863281
Epoch: 35, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.274 Vali Acc: 0.867 Test Loss: 0.274 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4400148391723633
Epoch: 36, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 37 cost time: 1.375596046447754
Epoch: 37, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2692511081695557
Epoch: 38, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.4789419174194336
Epoch: 39, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 40 cost time: 1.3723053932189941
Epoch: 40, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 41 cost time: 1.3452534675598145
Epoch: 41, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.575016975402832
Epoch: 42, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.280 Vali Acc: 0.861 Test Loss: 0.280 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3689277172088623
Epoch: 43, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 44 cost time: 1.4511382579803467
Epoch: 44, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.4815959930419922
Epoch: 45, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4569778442382812
Epoch: 46, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.33845853805542
Epoch: 47, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.203157901763916
Epoch: 48, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.230013370513916
Epoch: 49, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.2195096015930176
Epoch: 50, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.2204320430755615
Epoch: 51, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.332 Vali Acc: 0.867 Test Loss: 0.332 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.5249719619750977
Epoch: 52, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.559736728668213
Epoch: 53, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 572518
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7693557739257812
Epoch: 1, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.486 Vali Acc: 0.422 Test Loss: 1.486 Test Acc: 0.422
Validation loss decreased (inf --> -0.422207).  Saving model ...
Epoch: 2 cost time: 1.4126338958740234
Epoch: 2, Steps: 12 | Train Loss: 1.351 Vali Loss: 1.172 Vali Acc: 0.694 Test Loss: 1.172 Test Acc: 0.694
Validation loss decreased (-0.422207 --> -0.694433).  Saving model ...
Epoch: 3 cost time: 1.2271502017974854
Epoch: 3, Steps: 12 | Train Loss: 1.060 Vali Loss: 0.923 Vali Acc: 0.733 Test Loss: 0.923 Test Acc: 0.733
Validation loss decreased (-0.694433 --> -0.733324).  Saving model ...
Epoch: 4 cost time: 1.3862674236297607
Epoch: 4, Steps: 12 | Train Loss: 0.860 Vali Loss: 0.761 Vali Acc: 0.722 Test Loss: 0.761 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4218382835388184
Epoch: 5, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.677 Vali Acc: 0.744 Test Loss: 0.677 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 1.2156498432159424
Epoch: 6, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.596 Vali Acc: 0.767 Test Loss: 0.596 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766661).  Saving model ...
Epoch: 7 cost time: 1.4256067276000977
Epoch: 7, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.538 Vali Acc: 0.756 Test Loss: 0.538 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5504422187805176
Epoch: 8, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.497 Vali Acc: 0.778 Test Loss: 0.497 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.3473706245422363
Epoch: 9, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.464 Vali Acc: 0.783 Test Loss: 0.464 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 10 cost time: 1.3619909286499023
Epoch: 10, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.441 Vali Acc: 0.806 Test Loss: 0.441 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 1.3559238910675049
Epoch: 11, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.422 Vali Acc: 0.811 Test Loss: 0.422 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 1.3922035694122314
Epoch: 12, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.416 Vali Acc: 0.794 Test Loss: 0.416 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3215041160583496
Epoch: 13, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.398 Vali Acc: 0.811 Test Loss: 0.398 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 1.3183424472808838
Epoch: 14, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3467583656311035
Epoch: 15, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 16 cost time: 1.472243309020996
Epoch: 16, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.356 Vali Acc: 0.811 Test Loss: 0.356 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4028875827789307
Epoch: 17, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.357 Vali Acc: 0.817 Test Loss: 0.357 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2369191646575928
Epoch: 18, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 19 cost time: 1.2935380935668945
Epoch: 19, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.331 Vali Acc: 0.828 Test Loss: 0.331 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.43196702003479
Epoch: 20, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 21 cost time: 1.2058961391448975
Epoch: 21, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.347 Vali Acc: 0.833 Test Loss: 0.347 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3735437393188477
Epoch: 22, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.337 Vali Acc: 0.822 Test Loss: 0.337 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.390289306640625
Epoch: 23, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.328 Vali Acc: 0.833 Test Loss: 0.328 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4003441333770752
Epoch: 24, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5346109867095947
Epoch: 25, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 26 cost time: 1.4253380298614502
Epoch: 26, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.302565336227417
Epoch: 27, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2679190635681152
Epoch: 28, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.311 Vali Acc: 0.850 Test Loss: 0.311 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3749802112579346
Epoch: 29, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.294 Vali Acc: 0.850 Test Loss: 0.294 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.524949550628662
Epoch: 30, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3939297199249268
Epoch: 31, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.311 Vali Acc: 0.833 Test Loss: 0.311 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3568685054779053
Epoch: 32, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 33 cost time: 1.3893370628356934
Epoch: 33, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.281 Vali Acc: 0.856 Test Loss: 0.281 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3930895328521729
Epoch: 34, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 1.2603330612182617
Epoch: 35, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2743520736694336
Epoch: 36, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3069548606872559
Epoch: 37, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4701807498931885
Epoch: 38, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.311 Vali Acc: 0.867 Test Loss: 0.311 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.418308973312378
Epoch: 39, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 40 cost time: 1.4393882751464844
Epoch: 40, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2753477096557617
Epoch: 41, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.354 Vali Acc: 0.861 Test Loss: 0.354 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3536498546600342
Epoch: 42, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.300 Vali Acc: 0.867 Test Loss: 0.300 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3309803009033203
Epoch: 43, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.3405075073242188
Epoch: 44, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.301 Vali Acc: 0.844 Test Loss: 0.301 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.591799259185791
Epoch: 45, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.5424764156341553
Epoch: 46, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.373 Vali Acc: 0.872 Test Loss: 0.373 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.5769634246826172
Epoch: 47, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.300 Vali Acc: 0.867 Test Loss: 0.300 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.563856840133667
Epoch: 48, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.352 Vali Acc: 0.861 Test Loss: 0.352 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.600433349609375
Epoch: 49, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 572518
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2859578132629395
Epoch: 1, Steps: 12 | Train Loss: 1.610 Vali Loss: 1.478 Vali Acc: 0.478 Test Loss: 1.478 Test Acc: 0.478
Validation loss decreased (inf --> -0.477763).  Saving model ...
Epoch: 2 cost time: 1.3262577056884766
Epoch: 2, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.161 Vali Acc: 0.700 Test Loss: 1.161 Test Acc: 0.700
Validation loss decreased (-0.477763 --> -0.699988).  Saving model ...
Epoch: 3 cost time: 1.3974099159240723
Epoch: 3, Steps: 12 | Train Loss: 1.044 Vali Loss: 0.915 Vali Acc: 0.717 Test Loss: 0.915 Test Acc: 0.717
Validation loss decreased (-0.699988 --> -0.716658).  Saving model ...
Epoch: 4 cost time: 1.2312631607055664
Epoch: 4, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.752 Vali Acc: 0.700 Test Loss: 0.752 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.349081039428711
Epoch: 5, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.656 Vali Acc: 0.728 Test Loss: 0.656 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 1.3744142055511475
Epoch: 6, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.3158626556396484
Epoch: 7, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.510 Vali Acc: 0.772 Test Loss: 0.510 Test Acc: 0.772
Validation loss decreased (-0.749994 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 1.3842158317565918
Epoch: 8, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.455 Vali Acc: 0.794 Test Loss: 0.455 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 1.5068800449371338
Epoch: 9, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.422 Vali Acc: 0.800 Test Loss: 0.422 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 10 cost time: 1.4056429862976074
Epoch: 10, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.395 Vali Acc: 0.806 Test Loss: 0.395 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 11 cost time: 1.4748866558074951
Epoch: 11, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.380 Vali Acc: 0.828 Test Loss: 0.380 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 1.3256804943084717
Epoch: 12, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.377 Vali Acc: 0.828 Test Loss: 0.377 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 1.42759370803833
Epoch: 13, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.349 Vali Acc: 0.817 Test Loss: 0.349 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2857182025909424
Epoch: 14, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.344 Vali Acc: 0.833 Test Loss: 0.344 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 15 cost time: 1.4055674076080322
Epoch: 15, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.325 Vali Acc: 0.822 Test Loss: 0.325 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4491910934448242
Epoch: 16, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 17 cost time: 1.2263836860656738
Epoch: 17, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4297001361846924
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.315 Vali Acc: 0.839 Test Loss: 0.315 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2952706813812256
Epoch: 19, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.301 Vali Acc: 0.844 Test Loss: 0.301 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2731125354766846
Epoch: 20, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.284 Vali Acc: 0.844 Test Loss: 0.284 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2540621757507324
Epoch: 21, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2279694080352783
Epoch: 22, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 23 cost time: 1.346879482269287
Epoch: 23, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 24 cost time: 1.2511746883392334
Epoch: 24, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 25 cost time: 1.2241580486297607
Epoch: 25, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 26 cost time: 1.2831261157989502
Epoch: 26, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872220).  Saving model ...
Epoch: 27 cost time: 1.3273475170135498
Epoch: 27, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877775).  Saving model ...
Epoch: 28 cost time: 1.2939517498016357
Epoch: 28, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.276 Vali Acc: 0.861 Test Loss: 0.276 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4504215717315674
Epoch: 29, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.246 Vali Acc: 0.883 Test Loss: 0.246 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 30 cost time: 1.4125077724456787
Epoch: 30, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.254 Vali Acc: 0.878 Test Loss: 0.254 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4404106140136719
Epoch: 31, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4139454364776611
Epoch: 32, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2838833332061768
Epoch: 33, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.246 Vali Acc: 0.872 Test Loss: 0.246 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2161011695861816
Epoch: 34, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.250 Vali Acc: 0.878 Test Loss: 0.250 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2666311264038086
Epoch: 35, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2689955234527588
Epoch: 36, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.259 Vali Acc: 0.861 Test Loss: 0.259 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.235586166381836
Epoch: 37, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 38 cost time: 1.3309459686279297
Epoch: 38, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4330790042877197
Epoch: 39, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 40 cost time: 1.3424339294433594
Epoch: 40, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.255 Vali Acc: 0.872 Test Loss: 0.255 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2657208442687988
Epoch: 41, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.298332691192627
Epoch: 42, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2343981266021729
Epoch: 43, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2270848751068115
Epoch: 44, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2121014595031738
Epoch: 45, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.234 Vali Acc: 0.883 Test Loss: 0.234 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.2810454368591309
Epoch: 46, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.3481757640838623
Epoch: 47, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.271 Vali Acc: 0.867 Test Loss: 0.271 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.2875683307647705
Epoch: 48, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.4177703857421875
Epoch: 49, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 572518
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.011368274688721
Epoch: 1, Steps: 12 | Train Loss: 1.993 Vali Loss: 1.748 Vali Acc: 0.189 Test Loss: 1.748 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 1.3974816799163818
Epoch: 2, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.361 Vali Acc: 0.472 Test Loss: 1.361 Test Acc: 0.472
Validation loss decreased (-0.188871 --> -0.472209).  Saving model ...
Epoch: 3 cost time: 1.4307916164398193
Epoch: 3, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.035 Vali Acc: 0.617 Test Loss: 1.035 Test Acc: 0.617
Validation loss decreased (-0.472209 --> -0.616656).  Saving model ...
Epoch: 4 cost time: 1.277632713317871
Epoch: 4, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.840 Vali Acc: 0.694 Test Loss: 0.840 Test Acc: 0.694
Validation loss decreased (-0.616656 --> -0.694436).  Saving model ...
Epoch: 5 cost time: 1.4595515727996826
Epoch: 5, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.715 Vali Acc: 0.717 Test Loss: 0.715 Test Acc: 0.717
Validation loss decreased (-0.694436 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 1.4675354957580566
Epoch: 6, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.607 Vali Acc: 0.722 Test Loss: 0.607 Test Acc: 0.722
Validation loss decreased (-0.716660 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 1.3001964092254639
Epoch: 7, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.561 Vali Acc: 0.750 Test Loss: 0.561 Test Acc: 0.750
Validation loss decreased (-0.722216 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.4562439918518066
Epoch: 8, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 1.3538484573364258
Epoch: 9, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.476 Vali Acc: 0.767 Test Loss: 0.476 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.35988187789917
Epoch: 10, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.458 Vali Acc: 0.761 Test Loss: 0.458 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1460142135620117
Epoch: 11, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.429 Vali Acc: 0.772 Test Loss: 0.429 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5510377883911133
Epoch: 12, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.391 Vali Acc: 0.800 Test Loss: 0.391 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799996).  Saving model ...
Epoch: 13 cost time: 1.4671318531036377
Epoch: 13, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.376 Vali Acc: 0.806 Test Loss: 0.376 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 14 cost time: 1.4376845359802246
Epoch: 14, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.368 Vali Acc: 0.806 Test Loss: 0.368 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 15 cost time: 1.3479595184326172
Epoch: 15, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822219).  Saving model ...
Epoch: 16 cost time: 1.5666654109954834
Epoch: 16, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.352 Vali Acc: 0.822 Test Loss: 0.352 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 17 cost time: 1.4453871250152588
Epoch: 17, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.341 Vali Acc: 0.817 Test Loss: 0.341 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3178977966308594
Epoch: 18, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.338 Vali Acc: 0.822 Test Loss: 0.338 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 19 cost time: 1.39316725730896
Epoch: 19, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.320 Vali Acc: 0.828 Test Loss: 0.320 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827775).  Saving model ...
Epoch: 20 cost time: 1.3947699069976807
Epoch: 20, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
Validation loss decreased (-0.827775 --> -0.844441).  Saving model ...
Epoch: 21 cost time: 1.4412841796875
Epoch: 21, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.311 Vali Acc: 0.822 Test Loss: 0.311 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4160497188568115
Epoch: 22, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.302 Vali Acc: 0.839 Test Loss: 0.302 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4250531196594238
Epoch: 23, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.297 Vali Acc: 0.839 Test Loss: 0.297 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3221282958984375
Epoch: 24, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 1.3373119831085205
Epoch: 25, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.299 Vali Acc: 0.839 Test Loss: 0.299 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3529577255249023
Epoch: 26, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.294 Vali Acc: 0.839 Test Loss: 0.294 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.439819097518921
Epoch: 27, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 28 cost time: 1.4044625759124756
Epoch: 28, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.282 Vali Acc: 0.861 Test Loss: 0.282 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 29 cost time: 1.2589325904846191
Epoch: 29, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.280 Vali Acc: 0.861 Test Loss: 0.280 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 30 cost time: 1.3318841457366943
Epoch: 30, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.283 Vali Acc: 0.856 Test Loss: 0.283 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.289416790008545
Epoch: 31, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.299 Vali Acc: 0.844 Test Loss: 0.299 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3144690990447998
Epoch: 32, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 33 cost time: 1.263916015625
Epoch: 33, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.280 Vali Acc: 0.856 Test Loss: 0.280 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3803179264068604
Epoch: 34, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.297 Vali Acc: 0.839 Test Loss: 0.297 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4683120250701904
Epoch: 35, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.327 Vali Acc: 0.850 Test Loss: 0.327 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.408548355102539
Epoch: 36, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4680266380310059
Epoch: 37, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.288 Vali Acc: 0.850 Test Loss: 0.288 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5841734409332275
Epoch: 38, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.521177053451538
Epoch: 39, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.5138413906097412
Epoch: 40, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.4084289073944092
Epoch: 41, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 42 cost time: 1.3317577838897705
Epoch: 42, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.469893455505371
Epoch: 43, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 44 cost time: 1.346095323562622
Epoch: 44, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3623311519622803
Epoch: 45, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4306855201721191
Epoch: 46, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.4243125915527344
Epoch: 47, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6056323051452637
Epoch: 48, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.4324140548706055
Epoch: 49, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.3859727382659912
Epoch: 50, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.4888920783996582
Epoch: 51, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 52 cost time: 1.4666082859039307
Epoch: 52, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.366408109664917
Epoch: 53, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.506258487701416
Epoch: 54, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 55 cost time: 1.4977896213531494
Epoch: 55, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.3126254081726074
Epoch: 56, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.3926336765289307
Epoch: 57, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.314 Vali Acc: 0.872 Test Loss: 0.314 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.416546106338501
Epoch: 58, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.4864108562469482
Epoch: 59, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.566026210784912
Epoch: 60, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.6189274787902832
Epoch: 61, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.4652421474456787
Epoch: 62, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.293 Vali Acc: 0.894 Test Loss: 0.293 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.4760379791259766
Epoch: 63, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.310 Vali Acc: 0.878 Test Loss: 0.310 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.2907896041870117
Epoch: 64, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 310374
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.541710615158081
Epoch: 1, Steps: 12 | Train Loss: 1.989 Vali Loss: 1.743 Vali Acc: 0.189 Test Loss: 1.743 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 1.3725805282592773
Epoch: 2, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.354 Vali Acc: 0.478 Test Loss: 1.354 Test Acc: 0.478
Validation loss decreased (-0.188871 --> -0.477764).  Saving model ...
Epoch: 3 cost time: 1.2978830337524414
Epoch: 3, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.030 Vali Acc: 0.622 Test Loss: 1.030 Test Acc: 0.622
Validation loss decreased (-0.477764 --> -0.622212).  Saving model ...
Epoch: 4 cost time: 1.3857462406158447
Epoch: 4, Steps: 12 | Train Loss: 0.945 Vali Loss: 0.836 Vali Acc: 0.683 Test Loss: 0.836 Test Acc: 0.683
Validation loss decreased (-0.622212 --> -0.683325).  Saving model ...
Epoch: 5 cost time: 1.293349266052246
Epoch: 5, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.711 Vali Acc: 0.717 Test Loss: 0.711 Test Acc: 0.717
Validation loss decreased (-0.683325 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 1.4264473915100098
Epoch: 6, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
Validation loss decreased (-0.716660 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 1.2619373798370361
Epoch: 7, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.559 Vali Acc: 0.750 Test Loss: 0.559 Test Acc: 0.750
Validation loss decreased (-0.722216 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.1717865467071533
Epoch: 8, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 1.3490428924560547
Epoch: 9, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.473 Vali Acc: 0.767 Test Loss: 0.473 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3532166481018066
Epoch: 10, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.454 Vali Acc: 0.767 Test Loss: 0.454 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3376402854919434
Epoch: 11, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.425 Vali Acc: 0.778 Test Loss: 0.425 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2910947799682617
Epoch: 12, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.388 Vali Acc: 0.806 Test Loss: 0.388 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805552).  Saving model ...
Epoch: 13 cost time: 1.3961341381072998
Epoch: 13, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.371 Vali Acc: 0.811 Test Loss: 0.371 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 1.2247467041015625
Epoch: 14, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 1.459352970123291
Epoch: 15, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.355 Vali Acc: 0.828 Test Loss: 0.355 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 1.4621436595916748
Epoch: 16, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.349 Vali Acc: 0.811 Test Loss: 0.349 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4382293224334717
Epoch: 17, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.339 Vali Acc: 0.817 Test Loss: 0.339 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4462597370147705
Epoch: 18, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 1.4713232517242432
Epoch: 19, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.318 Vali Acc: 0.833 Test Loss: 0.318 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 20 cost time: 1.3470475673675537
Epoch: 20, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 21 cost time: 1.1288301944732666
Epoch: 21, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.309 Vali Acc: 0.822 Test Loss: 0.309 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2673728466033936
Epoch: 22, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.300 Vali Acc: 0.833 Test Loss: 0.300 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2746853828430176
Epoch: 23, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.297 Vali Acc: 0.839 Test Loss: 0.297 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4135253429412842
Epoch: 24, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.293 Vali Acc: 0.839 Test Loss: 0.293 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3313369750976562
Epoch: 25, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 26 cost time: 1.2942442893981934
Epoch: 26, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4641165733337402
Epoch: 27, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 28 cost time: 1.3856027126312256
Epoch: 28, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 29 cost time: 1.511216640472412
Epoch: 29, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.280 Vali Acc: 0.861 Test Loss: 0.280 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4663183689117432
Epoch: 30, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3605308532714844
Epoch: 31, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.299 Vali Acc: 0.844 Test Loss: 0.299 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5499839782714844
Epoch: 32, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 33 cost time: 1.5155930519104004
Epoch: 33, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.280 Vali Acc: 0.856 Test Loss: 0.280 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5064728260040283
Epoch: 34, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4049961566925049
Epoch: 35, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4438512325286865
Epoch: 36, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.315 Vali Acc: 0.844 Test Loss: 0.315 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4710609912872314
Epoch: 37, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.459435224533081
Epoch: 38, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.295 Vali Acc: 0.844 Test Loss: 0.295 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.518120527267456
Epoch: 39, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 1.2081880569458008
Epoch: 40, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.37168288230896
Epoch: 41, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3126106262207031
Epoch: 42, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.278 Vali Acc: 0.856 Test Loss: 0.278 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3123972415924072
Epoch: 43, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2398414611816406
Epoch: 44, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 45 cost time: 1.3482234477996826
Epoch: 45, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.345998764038086
Epoch: 46, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.4270970821380615
Epoch: 47, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3760759830474854
Epoch: 48, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.4517903327941895
Epoch: 49, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.540269136428833
Epoch: 50, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.5368142127990723
Epoch: 51, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.288 Vali Acc: 0.894 Test Loss: 0.288 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.62046217918396
Epoch: 52, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.4544358253479004
Epoch: 53, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.566997766494751
Epoch: 54, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 310374
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4139621257781982
Epoch: 1, Steps: 12 | Train Loss: 1.974 Vali Loss: 1.739 Vali Acc: 0.200 Test Loss: 1.739 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.211855411529541
Epoch: 2, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.352 Vali Acc: 0.478 Test Loss: 1.352 Test Acc: 0.478
Validation loss decreased (-0.199983 --> -0.477764).  Saving model ...
Epoch: 3 cost time: 1.38262939453125
Epoch: 3, Steps: 12 | Train Loss: 1.251 Vali Loss: 1.024 Vali Acc: 0.622 Test Loss: 1.024 Test Acc: 0.622
Validation loss decreased (-0.477764 --> -0.622212).  Saving model ...
Epoch: 4 cost time: 1.3099215030670166
Epoch: 4, Steps: 12 | Train Loss: 0.922 Vali Loss: 0.830 Vali Acc: 0.667 Test Loss: 0.830 Test Acc: 0.667
Validation loss decreased (-0.622212 --> -0.666658).  Saving model ...
Epoch: 5 cost time: 1.3393559455871582
Epoch: 5, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.707 Vali Acc: 0.689 Test Loss: 0.707 Test Acc: 0.689
Validation loss decreased (-0.666658 --> -0.688882).  Saving model ...
Epoch: 6 cost time: 1.3268356323242188
Epoch: 6, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.599 Vali Acc: 0.744 Test Loss: 0.599 Test Acc: 0.744
Validation loss decreased (-0.688882 --> -0.744438).  Saving model ...
Epoch: 7 cost time: 1.2876543998718262
Epoch: 7, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.549 Vali Acc: 0.761 Test Loss: 0.549 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 1.222383737564087
Epoch: 8, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.498 Vali Acc: 0.783 Test Loss: 0.498 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 1.4066505432128906
Epoch: 9, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.464 Vali Acc: 0.789 Test Loss: 0.464 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 1.442884922027588
Epoch: 10, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.440 Vali Acc: 0.761 Test Loss: 0.440 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.534475564956665
Epoch: 11, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.411 Vali Acc: 0.789 Test Loss: 0.411 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788885).  Saving model ...
Epoch: 12 cost time: 1.381683111190796
Epoch: 12, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.382 Vali Acc: 0.811 Test Loss: 0.382 Test Acc: 0.811
Validation loss decreased (-0.788885 --> -0.811107).  Saving model ...
Epoch: 13 cost time: 1.4573578834533691
Epoch: 13, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 1.4545631408691406
Epoch: 14, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.355 Vali Acc: 0.811 Test Loss: 0.355 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811108).  Saving model ...
Epoch: 15 cost time: 1.5105626583099365
Epoch: 15, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
Validation loss decreased (-0.811108 --> -0.822219).  Saving model ...
Epoch: 16 cost time: 1.4598898887634277
Epoch: 16, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.336 Vali Acc: 0.828 Test Loss: 0.336 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 17 cost time: 1.434206485748291
Epoch: 17, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 18 cost time: 1.5224666595458984
Epoch: 18, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.323 Vali Acc: 0.828 Test Loss: 0.323 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827775).  Saving model ...
Epoch: 19 cost time: 1.4117822647094727
Epoch: 19, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.307 Vali Acc: 0.839 Test Loss: 0.307 Test Acc: 0.839
Validation loss decreased (-0.827775 --> -0.838886).  Saving model ...
Epoch: 20 cost time: 1.3237066268920898
Epoch: 20, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 1.3665690422058105
Epoch: 21, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.301 Vali Acc: 0.844 Test Loss: 0.301 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3551483154296875
Epoch: 22, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4836761951446533
Epoch: 23, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.288 Vali Acc: 0.839 Test Loss: 0.288 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3700361251831055
Epoch: 24, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3914871215820312
Epoch: 25, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 26 cost time: 1.3269879817962646
Epoch: 26, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3775229454040527
Epoch: 27, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4981458187103271
Epoch: 28, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.275 Vali Acc: 0.872 Test Loss: 0.275 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 29 cost time: 1.417069435119629
Epoch: 29, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872220).  Saving model ...
Epoch: 30 cost time: 1.520470142364502
Epoch: 30, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.282 Vali Acc: 0.867 Test Loss: 0.282 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4520831108093262
Epoch: 31, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.279 Vali Acc: 0.856 Test Loss: 0.279 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4135198593139648
Epoch: 32, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877775).  Saving model ...
Epoch: 33 cost time: 1.4387216567993164
Epoch: 33, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.270 Vali Acc: 0.867 Test Loss: 0.270 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.407257318496704
Epoch: 34, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5131187438964844
Epoch: 35, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.439101219177246
Epoch: 36, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.390089750289917
Epoch: 37, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3739440441131592
Epoch: 38, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 39 cost time: 1.3318665027618408
Epoch: 39, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.311 Vali Acc: 0.867 Test Loss: 0.311 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3309106826782227
Epoch: 40, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.495858907699585
Epoch: 41, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 1.3905913829803467
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5682659149169922
Epoch: 43, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3719532489776611
Epoch: 44, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.3169851303100586
Epoch: 45, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.319 Vali Acc: 0.867 Test Loss: 0.319 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.5436534881591797
Epoch: 46, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.306 Vali Acc: 0.867 Test Loss: 0.306 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.6635768413543701
Epoch: 47, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.275 Vali Acc: 0.878 Test Loss: 0.275 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3651952743530273
Epoch: 48, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.5774259567260742
Epoch: 49, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.5296440124511719
Epoch: 50, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.4568657875061035
Epoch: 51, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 52 cost time: 1.4935486316680908
Epoch: 52, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 53 cost time: 1.4958696365356445
Epoch: 53, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.6471176147460938
Epoch: 54, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.277 Vali Acc: 0.894 Test Loss: 0.277 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.4283437728881836
Epoch: 55, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 56 cost time: 1.64107346534729
Epoch: 56, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3107995986938477
Epoch: 57, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.326 Vali Acc: 0.878 Test Loss: 0.326 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.387624740600586
Epoch: 58, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.345 Vali Acc: 0.883 Test Loss: 0.345 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.4793436527252197
Epoch: 59, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.3838613033294678
Epoch: 60, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.4619579315185547
Epoch: 61, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.347 Vali Acc: 0.872 Test Loss: 0.347 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.4624876976013184
Epoch: 62, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.362 Vali Acc: 0.878 Test Loss: 0.362 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.436429500579834
Epoch: 63, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.356 Vali Acc: 0.883 Test Loss: 0.356 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.5047743320465088
Epoch: 64, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.376 Vali Acc: 0.878 Test Loss: 0.376 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.672011375427246
Epoch: 65, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.322 Vali Acc: 0.894 Test Loss: 0.322 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 310374
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2056450843811035
Epoch: 1, Steps: 12 | Train Loss: 1.958 Vali Loss: 1.732 Vali Acc: 0.189 Test Loss: 1.732 Test Acc: 0.189
Validation loss decreased (inf --> -0.188872).  Saving model ...
Epoch: 2 cost time: 1.1262195110321045
Epoch: 2, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.342 Vali Acc: 0.489 Test Loss: 1.342 Test Acc: 0.489
Validation loss decreased (-0.188872 --> -0.488875).  Saving model ...
Epoch: 3 cost time: 1.2363319396972656
Epoch: 3, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.017 Vali Acc: 0.633 Test Loss: 1.017 Test Acc: 0.633
Validation loss decreased (-0.488875 --> -0.633323).  Saving model ...
Epoch: 4 cost time: 1.342024326324463
Epoch: 4, Steps: 12 | Train Loss: 0.905 Vali Loss: 0.823 Vali Acc: 0.706 Test Loss: 0.823 Test Acc: 0.706
Validation loss decreased (-0.633323 --> -0.705547).  Saving model ...
Epoch: 5 cost time: 1.3979158401489258
Epoch: 5, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.699 Vali Acc: 0.700 Test Loss: 0.699 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.260721206665039
Epoch: 6, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.590 Vali Acc: 0.750 Test Loss: 0.590 Test Acc: 0.750
Validation loss decreased (-0.705547 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.3582963943481445
Epoch: 7, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.534 Vali Acc: 0.761 Test Loss: 0.534 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 1.29227876663208
Epoch: 8, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.479 Vali Acc: 0.778 Test Loss: 0.479 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.292771339416504
Epoch: 9, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.444 Vali Acc: 0.789 Test Loss: 0.444 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 1.3488430976867676
Epoch: 10, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.417 Vali Acc: 0.794 Test Loss: 0.417 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 1.2361457347869873
Epoch: 11, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.386 Vali Acc: 0.806 Test Loss: 0.386 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 12 cost time: 1.436267375946045
Epoch: 12, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822219).  Saving model ...
Epoch: 13 cost time: 1.242276668548584
Epoch: 13, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.343 Vali Acc: 0.811 Test Loss: 0.343 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.249891996383667
Epoch: 14, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.337 Vali Acc: 0.817 Test Loss: 0.337 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3749475479125977
Epoch: 15, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.320 Vali Acc: 0.817 Test Loss: 0.320 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2628252506256104
Epoch: 16, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 17 cost time: 1.259871006011963
Epoch: 17, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.313 Vali Acc: 0.817 Test Loss: 0.313 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.318082571029663
Epoch: 18, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.313 Vali Acc: 0.833 Test Loss: 0.313 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 19 cost time: 1.3293571472167969
Epoch: 19, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 20 cost time: 1.3772997856140137
Epoch: 20, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 1.3792836666107178
Epoch: 21, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.290 Vali Acc: 0.844 Test Loss: 0.290 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.25441575050354
Epoch: 22, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.287 Vali Acc: 0.839 Test Loss: 0.287 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3676254749298096
Epoch: 23, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.282 Vali Acc: 0.856 Test Loss: 0.282 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2509255409240723
Epoch: 24, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.270 Vali Acc: 0.867 Test Loss: 0.270 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 25 cost time: 1.363703727722168
Epoch: 25, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.270 Vali Acc: 0.861 Test Loss: 0.270 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.330106258392334
Epoch: 26, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.280 Vali Acc: 0.856 Test Loss: 0.280 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2509539127349854
Epoch: 27, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.273 Vali Acc: 0.839 Test Loss: 0.273 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.221390724182129
Epoch: 28, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.244 Vali Acc: 0.883 Test Loss: 0.244 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 29 cost time: 1.2846171855926514
Epoch: 29, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.245 Vali Acc: 0.883 Test Loss: 0.245 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1817216873168945
Epoch: 30, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.266 Vali Acc: 0.850 Test Loss: 0.266 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.241410732269287
Epoch: 31, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.244 Vali Acc: 0.872 Test Loss: 0.244 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1926515102386475
Epoch: 32, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1951568126678467
Epoch: 33, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.237 Vali Acc: 0.878 Test Loss: 0.237 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3606977462768555
Epoch: 34, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.282 Vali Acc: 0.861 Test Loss: 0.282 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.330491542816162
Epoch: 35, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.413353443145752
Epoch: 36, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2858245372772217
Epoch: 37, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.255 Vali Acc: 0.861 Test Loss: 0.255 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2855818271636963
Epoch: 38, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.240 Vali Acc: 0.878 Test Loss: 0.240 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 310374
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.61759090423584
Epoch: 1, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.694 Vali Acc: 0.167 Test Loss: 1.694 Test Acc: 0.167
Validation loss decreased (inf --> -0.166650).  Saving model ...
Epoch: 2 cost time: 1.461059808731079
Epoch: 2, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.342 Vali Acc: 0.494 Test Loss: 1.342 Test Acc: 0.494
Validation loss decreased (-0.166650 --> -0.494431).  Saving model ...
Epoch: 3 cost time: 1.182297945022583
Epoch: 3, Steps: 12 | Train Loss: 1.137 Vali Loss: 1.044 Vali Acc: 0.622 Test Loss: 1.044 Test Acc: 0.622
Validation loss decreased (-0.494431 --> -0.622212).  Saving model ...
Epoch: 4 cost time: 1.2443370819091797
Epoch: 4, Steps: 12 | Train Loss: 0.890 Vali Loss: 0.838 Vali Acc: 0.722 Test Loss: 0.838 Test Acc: 0.722
Validation loss decreased (-0.622212 --> -0.722214).  Saving model ...
Epoch: 5 cost time: 1.4232242107391357
Epoch: 5, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.728 Vali Acc: 0.717 Test Loss: 0.728 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5113141536712646
Epoch: 6, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.649 Vali Acc: 0.700 Test Loss: 0.649 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5520892143249512
Epoch: 7, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
Validation loss decreased (-0.722214 --> -0.783328).  Saving model ...
Epoch: 8 cost time: 1.346369981765747
Epoch: 8, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.518 Vali Acc: 0.767 Test Loss: 0.518 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4024033546447754
Epoch: 9, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.473 Vali Acc: 0.750 Test Loss: 0.473 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2636480331420898
Epoch: 10, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.454 Vali Acc: 0.783 Test Loss: 0.454 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 1.4790456295013428
Epoch: 11, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.417 Vali Acc: 0.789 Test Loss: 0.417 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 12 cost time: 1.5009362697601318
Epoch: 12, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.395 Vali Acc: 0.800 Test Loss: 0.395 Test Acc: 0.800
Validation loss decreased (-0.788885 --> -0.799996).  Saving model ...
Epoch: 13 cost time: 1.5092897415161133
Epoch: 13, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.386 Vali Acc: 0.806 Test Loss: 0.386 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 14 cost time: 1.540456771850586
Epoch: 14, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.380 Vali Acc: 0.800 Test Loss: 0.380 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6327495574951172
Epoch: 15, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.382 Vali Acc: 0.789 Test Loss: 0.382 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6534225940704346
Epoch: 16, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.364 Vali Acc: 0.806 Test Loss: 0.364 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 17 cost time: 1.5404565334320068
Epoch: 17, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.352 Vali Acc: 0.833 Test Loss: 0.352 Test Acc: 0.833
Validation loss decreased (-0.805552 --> -0.833330).  Saving model ...
Epoch: 18 cost time: 1.6357402801513672
Epoch: 18, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 19 cost time: 1.6233243942260742
Epoch: 19, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 20 cost time: 1.474285364151001
Epoch: 20, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3354628086090088
Epoch: 21, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.318 Vali Acc: 0.822 Test Loss: 0.318 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.309096336364746
Epoch: 22, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.324 Vali Acc: 0.817 Test Loss: 0.324 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.290243148803711
Epoch: 23, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.306 Vali Acc: 0.839 Test Loss: 0.306 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2990179061889648
Epoch: 24, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.303 Vali Acc: 0.833 Test Loss: 0.303 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2592735290527344
Epoch: 25, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.294088363647461
Epoch: 26, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 27 cost time: 1.214977502822876
Epoch: 27, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.306 Vali Acc: 0.844 Test Loss: 0.306 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3969030380249023
Epoch: 28, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.301 Vali Acc: 0.844 Test Loss: 0.301 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.294513463973999
Epoch: 29, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.472043752670288
Epoch: 30, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6294448375701904
Epoch: 31, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 32 cost time: 1.6399540901184082
Epoch: 32, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.281 Vali Acc: 0.856 Test Loss: 0.281 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6409645080566406
Epoch: 33, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.285 Vali Acc: 0.856 Test Loss: 0.285 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5644793510437012
Epoch: 34, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.837526559829712
Epoch: 35, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.5210685729980469
Epoch: 36, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 37 cost time: 1.4489386081695557
Epoch: 37, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.276 Vali Acc: 0.867 Test Loss: 0.276 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5234124660491943
Epoch: 38, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5064096450805664
Epoch: 39, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.282 Vali Acc: 0.861 Test Loss: 0.282 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.447831153869629
Epoch: 40, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 41 cost time: 1.57778000831604
Epoch: 41, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.759314775466919
Epoch: 42, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.7162120342254639
Epoch: 43, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 44 cost time: 1.5189847946166992
Epoch: 44, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.537886381149292
Epoch: 45, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.723158597946167
Epoch: 46, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.7274847030639648
Epoch: 47, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.691370964050293
Epoch: 48, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 49 cost time: 1.8313214778900146
Epoch: 49, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.7007498741149902
Epoch: 50, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.5890426635742188
Epoch: 51, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.794485092163086
Epoch: 52, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.5565855503082275
Epoch: 53, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.5747182369232178
Epoch: 54, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.5146965980529785
Epoch: 55, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.4204633235931396
Epoch: 56, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.303 Vali Acc: 0.883 Test Loss: 0.303 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.6117687225341797
Epoch: 57, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.356 Vali Acc: 0.839 Test Loss: 0.356 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.5493366718292236
Epoch: 58, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.375 Vali Acc: 0.861 Test Loss: 0.375 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 179302
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6048343181610107
Epoch: 1, Steps: 12 | Train Loss: 1.837 Vali Loss: 1.692 Vali Acc: 0.183 Test Loss: 1.692 Test Acc: 0.183
Validation loss decreased (inf --> -0.183316).  Saving model ...
Epoch: 2 cost time: 1.2402877807617188
Epoch: 2, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.339 Vali Acc: 0.511 Test Loss: 1.339 Test Acc: 0.511
Validation loss decreased (-0.183316 --> -0.511098).  Saving model ...
Epoch: 3 cost time: 1.4033551216125488
Epoch: 3, Steps: 12 | Train Loss: 1.134 Vali Loss: 1.040 Vali Acc: 0.639 Test Loss: 1.040 Test Acc: 0.639
Validation loss decreased (-0.511098 --> -0.638878).  Saving model ...
Epoch: 4 cost time: 1.5467071533203125
Epoch: 4, Steps: 12 | Train Loss: 0.889 Vali Loss: 0.835 Vali Acc: 0.706 Test Loss: 0.835 Test Acc: 0.706
Validation loss decreased (-0.638878 --> -0.705547).  Saving model ...
Epoch: 5 cost time: 1.1975836753845215
Epoch: 5, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.725 Vali Acc: 0.717 Test Loss: 0.725 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716659).  Saving model ...
Epoch: 6 cost time: 1.2275631427764893
Epoch: 6, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.645 Vali Acc: 0.711 Test Loss: 0.645 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3146402835845947
Epoch: 7, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.563 Vali Acc: 0.778 Test Loss: 0.563 Test Acc: 0.778
Validation loss decreased (-0.716659 --> -0.777772).  Saving model ...
Epoch: 8 cost time: 1.328378677368164
Epoch: 8, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.516 Vali Acc: 0.767 Test Loss: 0.516 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3269431591033936
Epoch: 9, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.467 Vali Acc: 0.761 Test Loss: 0.467 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2124512195587158
Epoch: 10, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.449 Vali Acc: 0.806 Test Loss: 0.449 Test Acc: 0.806
Validation loss decreased (-0.777772 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 1.2120709419250488
Epoch: 11, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.412 Vali Acc: 0.778 Test Loss: 0.412 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.41530442237854
Epoch: 12, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.389 Vali Acc: 0.794 Test Loss: 0.389 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3070569038391113
Epoch: 13, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.382 Vali Acc: 0.806 Test Loss: 0.382 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805552).  Saving model ...
Epoch: 14 cost time: 1.363490104675293
Epoch: 14, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.377 Vali Acc: 0.817 Test Loss: 0.377 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 1.205387830734253
Epoch: 15, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.378 Vali Acc: 0.800 Test Loss: 0.378 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4677634239196777
Epoch: 16, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.359 Vali Acc: 0.800 Test Loss: 0.359 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3779771327972412
Epoch: 17, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
Validation loss decreased (-0.816663 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 1.3959062099456787
Epoch: 18, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3281478881835938
Epoch: 19, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 20 cost time: 1.2068586349487305
Epoch: 20, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.322 Vali Acc: 0.839 Test Loss: 0.322 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.21488356590271
Epoch: 21, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.320 Vali Acc: 0.828 Test Loss: 0.320 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3004610538482666
Epoch: 22, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.319 Vali Acc: 0.828 Test Loss: 0.319 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4206969738006592
Epoch: 23, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.303 Vali Acc: 0.839 Test Loss: 0.303 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3709897994995117
Epoch: 24, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.302 Vali Acc: 0.844 Test Loss: 0.302 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3037066459655762
Epoch: 25, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.306 Vali Acc: 0.844 Test Loss: 0.306 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.249077558517456
Epoch: 26, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 27 cost time: 1.349703073501587
Epoch: 27, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.311 Vali Acc: 0.839 Test Loss: 0.311 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2286293506622314
Epoch: 28, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.303 Vali Acc: 0.833 Test Loss: 0.303 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3240115642547607
Epoch: 29, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.317 Vali Acc: 0.833 Test Loss: 0.317 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2580211162567139
Epoch: 30, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.311415195465088
Epoch: 31, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.277 Vali Acc: 0.867 Test Loss: 0.277 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 32 cost time: 1.3038508892059326
Epoch: 32, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4270117282867432
Epoch: 33, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.287 Vali Acc: 0.856 Test Loss: 0.287 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3560855388641357
Epoch: 34, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3652169704437256
Epoch: 35, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3466999530792236
Epoch: 36, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 1.2838103771209717
Epoch: 37, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1860365867614746
Epoch: 38, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2055020332336426
Epoch: 39, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1638333797454834
Epoch: 40, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 41 cost time: 1.07448410987854
Epoch: 41, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1799192428588867
Epoch: 42, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 43 cost time: 1.1611344814300537
Epoch: 43, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 44 cost time: 1.2789726257324219
Epoch: 44, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0846312046051025
Epoch: 45, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3696115016937256
Epoch: 46, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.4029457569122314
Epoch: 47, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.304 Vali Acc: 0.867 Test Loss: 0.304 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.4309091567993164
Epoch: 48, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.460806131362915
Epoch: 49, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.1486990451812744
Epoch: 50, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.4769930839538574
Epoch: 51, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.4176826477050781
Epoch: 52, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.4215404987335205
Epoch: 53, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 179302
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.501622200012207
Epoch: 1, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.681 Vali Acc: 0.194 Test Loss: 1.681 Test Acc: 0.194
Validation loss decreased (inf --> -0.194428).  Saving model ...
Epoch: 2 cost time: 1.465066909790039
Epoch: 2, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.329 Vali Acc: 0.511 Test Loss: 1.329 Test Acc: 0.511
Validation loss decreased (-0.194428 --> -0.511098).  Saving model ...
Epoch: 3 cost time: 1.3149261474609375
Epoch: 3, Steps: 12 | Train Loss: 1.148 Vali Loss: 1.030 Vali Acc: 0.678 Test Loss: 1.030 Test Acc: 0.678
Validation loss decreased (-0.511098 --> -0.677767).  Saving model ...
Epoch: 4 cost time: 1.3683011531829834
Epoch: 4, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.824 Vali Acc: 0.711 Test Loss: 0.824 Test Acc: 0.711
Validation loss decreased (-0.677767 --> -0.711103).  Saving model ...
Epoch: 5 cost time: 1.2430238723754883
Epoch: 5, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.717 Vali Acc: 0.694 Test Loss: 0.717 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2556891441345215
Epoch: 6, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.632 Vali Acc: 0.722 Test Loss: 0.632 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 1.270498514175415
Epoch: 7, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.550 Vali Acc: 0.767 Test Loss: 0.550 Test Acc: 0.767
Validation loss decreased (-0.722216 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 1.4038078784942627
Epoch: 8, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.506 Vali Acc: 0.756 Test Loss: 0.506 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2580127716064453
Epoch: 9, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.461 Vali Acc: 0.761 Test Loss: 0.461 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.409186601638794
Epoch: 10, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.441 Vali Acc: 0.794 Test Loss: 0.441 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 1.3387656211853027
Epoch: 11, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.407 Vali Acc: 0.794 Test Loss: 0.407 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 12 cost time: 1.4208199977874756
Epoch: 12, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.383 Vali Acc: 0.789 Test Loss: 0.383 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.312896728515625
Epoch: 13, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.376 Vali Acc: 0.806 Test Loss: 0.376 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 14 cost time: 1.4209551811218262
Epoch: 14, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 15 cost time: 1.397331953048706
Epoch: 15, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.372 Vali Acc: 0.789 Test Loss: 0.372 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4754745960235596
Epoch: 16, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.354 Vali Acc: 0.806 Test Loss: 0.354 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2803001403808594
Epoch: 17, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.344 Vali Acc: 0.828 Test Loss: 0.344 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 18 cost time: 1.3114893436431885
Epoch: 18, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.334 Vali Acc: 0.833 Test Loss: 0.334 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 19 cost time: 1.3003194332122803
Epoch: 19, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.319 Vali Acc: 0.844 Test Loss: 0.319 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 20 cost time: 1.413597822189331
Epoch: 20, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.315 Vali Acc: 0.844 Test Loss: 0.315 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 21 cost time: 1.383969783782959
Epoch: 21, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.317 Vali Acc: 0.828 Test Loss: 0.317 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.258293867111206
Epoch: 22, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 23 cost time: 1.3497536182403564
Epoch: 23, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3874502182006836
Epoch: 24, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3012638092041016
Epoch: 25, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3828034400939941
Epoch: 26, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 27 cost time: 1.1148221492767334
Epoch: 27, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4023582935333252
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2604882717132568
Epoch: 29, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.319 Vali Acc: 0.844 Test Loss: 0.319 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3613615036010742
Epoch: 30, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3081717491149902
Epoch: 31, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 32 cost time: 1.347425937652588
Epoch: 32, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4639201164245605
Epoch: 33, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3983819484710693
Epoch: 34, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.327 Vali Acc: 0.861 Test Loss: 0.327 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3097584247589111
Epoch: 35, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.388622522354126
Epoch: 36, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.388965129852295
Epoch: 37, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3391985893249512
Epoch: 38, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.4622178077697754
Epoch: 39, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 1.3562400341033936
Epoch: 40, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3217616081237793
Epoch: 41, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.439112663269043
Epoch: 42, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3564603328704834
Epoch: 43, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.333388328552246
Epoch: 44, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.4021553993225098
Epoch: 45, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.4508678913116455
Epoch: 46, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.312 Vali Acc: 0.872 Test Loss: 0.312 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.3123278617858887
Epoch: 47, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.310 Vali Acc: 0.872 Test Loss: 0.310 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.401104211807251
Epoch: 48, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911108).  Saving model ...
Epoch: 49 cost time: 1.2928102016448975
Epoch: 49, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.295 Vali Acc: 0.894 Test Loss: 0.295 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3351335525512695
Epoch: 50, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.261500358581543
Epoch: 51, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.3874571323394775
Epoch: 52, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.3618860244750977
Epoch: 53, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.3352618217468262
Epoch: 54, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.2818012237548828
Epoch: 55, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.168651819229126
Epoch: 56, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.235496997833252
Epoch: 57, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.2822957038879395
Epoch: 58, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.448 Vali Acc: 0.856 Test Loss: 0.448 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 179302
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.473400831222534
Epoch: 1, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.655 Vali Acc: 0.272 Test Loss: 1.655 Test Acc: 0.272
Validation loss decreased (inf --> -0.272206).  Saving model ...
Epoch: 2 cost time: 1.535536766052246
Epoch: 2, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.314 Vali Acc: 0.522 Test Loss: 1.314 Test Acc: 0.522
Validation loss decreased (-0.272206 --> -0.522209).  Saving model ...
Epoch: 3 cost time: 1.437509298324585
Epoch: 3, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.028 Vali Acc: 0.644 Test Loss: 1.028 Test Acc: 0.644
Validation loss decreased (-0.522209 --> -0.644434).  Saving model ...
Epoch: 4 cost time: 1.4880671501159668
Epoch: 4, Steps: 12 | Train Loss: 0.879 Vali Loss: 0.827 Vali Acc: 0.689 Test Loss: 0.827 Test Acc: 0.689
Validation loss decreased (-0.644434 --> -0.688881).  Saving model ...
Epoch: 5 cost time: 1.5205705165863037
Epoch: 5, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.720 Vali Acc: 0.678 Test Loss: 0.720 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.343688726425171
Epoch: 6, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.637 Vali Acc: 0.694 Test Loss: 0.637 Test Acc: 0.694
Validation loss decreased (-0.688881 --> -0.694438).  Saving model ...
Epoch: 7 cost time: 1.2740867137908936
Epoch: 7, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.541 Vali Acc: 0.767 Test Loss: 0.541 Test Acc: 0.767
Validation loss decreased (-0.694438 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 1.2671327590942383
Epoch: 8, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.495 Vali Acc: 0.778 Test Loss: 0.495 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.265890121459961
Epoch: 9, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.456 Vali Acc: 0.794 Test Loss: 0.456 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 10 cost time: 1.2940294742584229
Epoch: 10, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.431 Vali Acc: 0.817 Test Loss: 0.431 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816662).  Saving model ...
Epoch: 11 cost time: 1.4225530624389648
Epoch: 11, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.391 Vali Acc: 0.817 Test Loss: 0.391 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 12 cost time: 1.386016845703125
Epoch: 12, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.367 Vali Acc: 0.844 Test Loss: 0.367 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 13 cost time: 1.3667328357696533
Epoch: 13, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.357 Vali Acc: 0.850 Test Loss: 0.357 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 14 cost time: 1.3172123432159424
Epoch: 14, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.351 Vali Acc: 0.822 Test Loss: 0.351 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3090996742248535
Epoch: 15, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.346 Vali Acc: 0.822 Test Loss: 0.346 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.39839768409729
Epoch: 16, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 17 cost time: 1.4272592067718506
Epoch: 17, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.3761281967163086
Epoch: 18, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4580354690551758
Epoch: 19, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.296 Vali Acc: 0.856 Test Loss: 0.296 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.387331485748291
Epoch: 20, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.295 Vali Acc: 0.839 Test Loss: 0.295 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3998844623565674
Epoch: 21, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.297 Vali Acc: 0.833 Test Loss: 0.297 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3676986694335938
Epoch: 22, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.289 Vali Acc: 0.850 Test Loss: 0.289 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4280498027801514
Epoch: 23, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.275 Vali Acc: 0.861 Test Loss: 0.275 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 24 cost time: 1.3683505058288574
Epoch: 24, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.282 Vali Acc: 0.856 Test Loss: 0.282 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5225167274475098
Epoch: 25, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 26 cost time: 1.3367908000946045
Epoch: 26, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 27 cost time: 1.1735103130340576
Epoch: 27, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 28 cost time: 1.273324966430664
Epoch: 28, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.273 Vali Acc: 0.839 Test Loss: 0.273 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4756255149841309
Epoch: 29, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.289 Vali Acc: 0.850 Test Loss: 0.289 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.379554271697998
Epoch: 30, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.262 Vali Acc: 0.856 Test Loss: 0.262 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4480626583099365
Epoch: 31, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 1.4107656478881836
Epoch: 32, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.252 Vali Acc: 0.872 Test Loss: 0.252 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3791542053222656
Epoch: 33, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.261 Vali Acc: 0.878 Test Loss: 0.261 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.526282787322998
Epoch: 34, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5000214576721191
Epoch: 35, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.6201162338256836
Epoch: 36, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5078108310699463
Epoch: 37, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3365910053253174
Epoch: 38, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.255 Vali Acc: 0.894 Test Loss: 0.255 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 39 cost time: 1.4548044204711914
Epoch: 39, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 40 cost time: 1.491760492324829
Epoch: 40, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3436169624328613
Epoch: 41, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.237 Vali Acc: 0.894 Test Loss: 0.237 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3973243236541748
Epoch: 42, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.218 Vali Acc: 0.900 Test Loss: 0.218 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3918673992156982
Epoch: 43, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.211 Vali Acc: 0.911 Test Loss: 0.211 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 44 cost time: 1.5604922771453857
Epoch: 44, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.479832649230957
Epoch: 45, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.229 Vali Acc: 0.911 Test Loss: 0.229 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4117693901062012
Epoch: 46, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.4176545143127441
Epoch: 47, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.303 Vali Acc: 0.883 Test Loss: 0.303 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.2805299758911133
Epoch: 48, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 49 cost time: 1.369920015335083
Epoch: 49, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.5302033424377441
Epoch: 50, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.4347212314605713
Epoch: 51, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 52 cost time: 1.5306010246276855
Epoch: 52, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.510936975479126
Epoch: 53, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.6694469451904297
Epoch: 54, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.5512447357177734
Epoch: 55, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.5733633041381836
Epoch: 56, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.6229407787322998
Epoch: 57, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.4223957061767578
Epoch: 58, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.407 Vali Acc: 0.878 Test Loss: 0.407 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.3672540187835693
Epoch: 59, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.320 Vali Acc: 0.878 Test Loss: 0.320 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.41851806640625
Epoch: 60, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.5048613548278809
Epoch: 61, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.348 Vali Acc: 0.883 Test Loss: 0.348 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 179302
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6642534732818604
Epoch: 1, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.463 Vali Acc: 0.489 Test Loss: 1.463 Test Acc: 0.489
Validation loss decreased (inf --> -0.488874).  Saving model ...
Epoch: 2 cost time: 1.5973904132843018
Epoch: 2, Steps: 12 | Train Loss: 1.367 Vali Loss: 1.142 Vali Acc: 0.656 Test Loss: 1.142 Test Acc: 0.656
Validation loss decreased (-0.488874 --> -0.655544).  Saving model ...
Epoch: 3 cost time: 1.567502737045288
Epoch: 3, Steps: 12 | Train Loss: 1.050 Vali Loss: 0.896 Vali Acc: 0.694 Test Loss: 0.896 Test Acc: 0.694
Validation loss decreased (-0.655544 --> -0.694435).  Saving model ...
Epoch: 4 cost time: 1.4705383777618408
Epoch: 4, Steps: 12 | Train Loss: 0.861 Vali Loss: 0.748 Vali Acc: 0.744 Test Loss: 0.748 Test Acc: 0.744
Validation loss decreased (-0.694435 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 1.5281386375427246
Epoch: 5, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.640 Vali Acc: 0.772 Test Loss: 0.640 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772216).  Saving model ...
Epoch: 6 cost time: 1.531132459640503
Epoch: 6, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.584 Vali Acc: 0.761 Test Loss: 0.584 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2010815143585205
Epoch: 7, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.532 Vali Acc: 0.722 Test Loss: 0.532 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2850730419158936
Epoch: 8, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
Validation loss decreased (-0.772216 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.209015130996704
Epoch: 9, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.479 Vali Acc: 0.789 Test Loss: 0.479 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 1.4065070152282715
Epoch: 10, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.466 Vali Acc: 0.783 Test Loss: 0.466 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.22636079788208
Epoch: 11, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.430 Vali Acc: 0.772 Test Loss: 0.430 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2946743965148926
Epoch: 12, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.411 Vali Acc: 0.828 Test Loss: 0.411 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 1.3149898052215576
Epoch: 13, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.393 Vali Acc: 0.789 Test Loss: 0.393 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2755169868469238
Epoch: 14, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.381 Vali Acc: 0.817 Test Loss: 0.381 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.357804536819458
Epoch: 15, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.364 Vali Acc: 0.811 Test Loss: 0.364 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3454256057739258
Epoch: 16, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4321093559265137
Epoch: 17, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.361 Vali Acc: 0.800 Test Loss: 0.361 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.41965651512146
Epoch: 18, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.348 Vali Acc: 0.822 Test Loss: 0.348 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3356420993804932
Epoch: 19, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3605046272277832
Epoch: 20, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.372 Vali Acc: 0.822 Test Loss: 0.372 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4492580890655518
Epoch: 21, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.333 Vali Acc: 0.822 Test Loss: 0.333 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4329509735107422
Epoch: 22, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 23 cost time: 1.2904186248779297
Epoch: 23, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2651937007904053
Epoch: 24, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.322 Vali Acc: 0.822 Test Loss: 0.322 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2790732383728027
Epoch: 25, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.314 Vali Acc: 0.833 Test Loss: 0.314 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.41015625
Epoch: 26, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.442183256149292
Epoch: 27, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.317 Vali Acc: 0.839 Test Loss: 0.317 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3616652488708496
Epoch: 28, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.329 Vali Acc: 0.833 Test Loss: 0.329 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3899602890014648
Epoch: 29, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 30 cost time: 1.3093039989471436
Epoch: 30, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3897736072540283
Epoch: 31, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.290 Vali Acc: 0.878 Test Loss: 0.290 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 32 cost time: 1.2936253547668457
Epoch: 32, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.477933645248413
Epoch: 33, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.305 Vali Acc: 0.839 Test Loss: 0.305 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.511692762374878
Epoch: 34, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5023236274719238
Epoch: 35, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.312 Vali Acc: 0.833 Test Loss: 0.312 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4217095375061035
Epoch: 36, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.328 Vali Acc: 0.850 Test Loss: 0.328 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4986677169799805
Epoch: 37, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5042641162872314
Epoch: 38, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 39 cost time: 1.335860252380371
Epoch: 39, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 1.2141797542572021
Epoch: 40, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.5285637378692627
Epoch: 41, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.279 Vali Acc: 0.867 Test Loss: 0.279 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2998709678649902
Epoch: 42, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.365323543548584
Epoch: 43, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.3964147567749023
Epoch: 44, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.3530793190002441
Epoch: 45, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.4265756607055664
Epoch: 46, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.3222546577453613
Epoch: 47, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.2507400512695312
Epoch: 48, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.5600247383117676
Epoch: 49, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 113766
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8092525005340576
Epoch: 1, Steps: 12 | Train Loss: 1.739 Vali Loss: 1.459 Vali Acc: 0.489 Test Loss: 1.459 Test Acc: 0.489
Validation loss decreased (inf --> -0.488874).  Saving model ...
Epoch: 2 cost time: 1.5798170566558838
Epoch: 2, Steps: 12 | Train Loss: 1.363 Vali Loss: 1.139 Vali Acc: 0.628 Test Loss: 1.139 Test Acc: 0.628
Validation loss decreased (-0.488874 --> -0.627766).  Saving model ...
Epoch: 3 cost time: 1.345099687576294
Epoch: 3, Steps: 12 | Train Loss: 1.051 Vali Loss: 0.890 Vali Acc: 0.717 Test Loss: 0.890 Test Acc: 0.717
Validation loss decreased (-0.627766 --> -0.716658).  Saving model ...
Epoch: 4 cost time: 1.2863545417785645
Epoch: 4, Steps: 12 | Train Loss: 0.842 Vali Loss: 0.740 Vali Acc: 0.744 Test Loss: 0.740 Test Acc: 0.744
Validation loss decreased (-0.716658 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 1.1588592529296875
Epoch: 5, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.632 Vali Acc: 0.761 Test Loss: 0.632 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761105).  Saving model ...
Epoch: 6 cost time: 1.2569732666015625
Epoch: 6, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.578 Vali Acc: 0.761 Test Loss: 0.578 Test Acc: 0.761
Validation loss decreased (-0.761105 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 1.279954195022583
Epoch: 7, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.527 Vali Acc: 0.733 Test Loss: 0.527 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.358680248260498
Epoch: 8, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.491 Vali Acc: 0.789 Test Loss: 0.491 Test Acc: 0.789
Validation loss decreased (-0.761105 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.2831602096557617
Epoch: 9, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.475 Vali Acc: 0.789 Test Loss: 0.475 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 1.3637235164642334
Epoch: 10, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.458 Vali Acc: 0.772 Test Loss: 0.458 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6074271202087402
Epoch: 11, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.425 Vali Acc: 0.789 Test Loss: 0.425 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788885).  Saving model ...
Epoch: 12 cost time: 1.5665836334228516
Epoch: 12, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.407 Vali Acc: 0.828 Test Loss: 0.407 Test Acc: 0.828
Validation loss decreased (-0.788885 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 1.5586581230163574
Epoch: 13, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.388 Vali Acc: 0.800 Test Loss: 0.388 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.620642900466919
Epoch: 14, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.373 Vali Acc: 0.822 Test Loss: 0.373 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4852800369262695
Epoch: 15, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.358 Vali Acc: 0.811 Test Loss: 0.358 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.532731056213379
Epoch: 16, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 17 cost time: 1.397160291671753
Epoch: 17, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.355 Vali Acc: 0.806 Test Loss: 0.355 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3965463638305664
Epoch: 18, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.339 Vali Acc: 0.822 Test Loss: 0.339 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3838648796081543
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5774188041687012
Epoch: 20, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.365 Vali Acc: 0.828 Test Loss: 0.365 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.410332202911377
Epoch: 21, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.327 Vali Acc: 0.811 Test Loss: 0.327 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2746379375457764
Epoch: 22, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.317 Vali Acc: 0.861 Test Loss: 0.317 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 23 cost time: 1.5290493965148926
Epoch: 23, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 24 cost time: 1.5015416145324707
Epoch: 24, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.316 Vali Acc: 0.822 Test Loss: 0.316 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4265415668487549
Epoch: 25, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.471217393875122
Epoch: 26, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.302 Vali Acc: 0.844 Test Loss: 0.302 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.48060941696167
Epoch: 27, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.316 Vali Acc: 0.828 Test Loss: 0.316 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5052263736724854
Epoch: 28, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5216567516326904
Epoch: 29, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.316 Vali Acc: 0.839 Test Loss: 0.316 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4715778827667236
Epoch: 30, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.615429401397705
Epoch: 31, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 32 cost time: 1.5423352718353271
Epoch: 32, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5013976097106934
Epoch: 33, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.303 Vali Acc: 0.839 Test Loss: 0.303 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4840583801269531
Epoch: 34, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.331751823425293
Epoch: 35, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4255902767181396
Epoch: 36, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2986595630645752
Epoch: 37, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4832971096038818
Epoch: 38, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 39 cost time: 1.363506555557251
Epoch: 39, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 40 cost time: 1.4654481410980225
Epoch: 40, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4300403594970703
Epoch: 41, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.469573974609375
Epoch: 42, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.5720655918121338
Epoch: 43, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.545753002166748
Epoch: 44, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.4858698844909668
Epoch: 45, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.5051276683807373
Epoch: 46, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.435687780380249
Epoch: 47, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.4629528522491455
Epoch: 48, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.5243966579437256
Epoch: 49, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 113766
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5417981147766113
Epoch: 1, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.458 Vali Acc: 0.522 Test Loss: 1.458 Test Acc: 0.522
Validation loss decreased (inf --> -0.522208).  Saving model ...
Epoch: 2 cost time: 1.3961894512176514
Epoch: 2, Steps: 12 | Train Loss: 1.367 Vali Loss: 1.133 Vali Acc: 0.639 Test Loss: 1.133 Test Acc: 0.639
Validation loss decreased (-0.522208 --> -0.638878).  Saving model ...
Epoch: 3 cost time: 1.3269867897033691
Epoch: 3, Steps: 12 | Train Loss: 1.043 Vali Loss: 0.881 Vali Acc: 0.706 Test Loss: 0.881 Test Acc: 0.706
Validation loss decreased (-0.638878 --> -0.705547).  Saving model ...
Epoch: 4 cost time: 1.2768571376800537
Epoch: 4, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.728 Vali Acc: 0.761 Test Loss: 0.728 Test Acc: 0.761
Validation loss decreased (-0.705547 --> -0.761104).  Saving model ...
Epoch: 5 cost time: 1.2729377746582031
Epoch: 5, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.619 Vali Acc: 0.744 Test Loss: 0.619 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2698180675506592
Epoch: 6, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.568 Vali Acc: 0.778 Test Loss: 0.568 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777772).  Saving model ...
Epoch: 7 cost time: 1.3079626560211182
Epoch: 7, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.515 Vali Acc: 0.761 Test Loss: 0.515 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2641339302062988
Epoch: 8, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.475 Vali Acc: 0.783 Test Loss: 0.475 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783329).  Saving model ...
Epoch: 9 cost time: 1.4609780311584473
Epoch: 9, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.461 Vali Acc: 0.800 Test Loss: 0.461 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799995).  Saving model ...
Epoch: 10 cost time: 1.2681455612182617
Epoch: 10, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.446 Vali Acc: 0.783 Test Loss: 0.446 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.13995361328125
Epoch: 11, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.411 Vali Acc: 0.783 Test Loss: 0.411 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0746722221374512
Epoch: 12, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.392 Vali Acc: 0.822 Test Loss: 0.392 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 1.2702901363372803
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.373 Vali Acc: 0.811 Test Loss: 0.373 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.493032455444336
Epoch: 14, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.360 Vali Acc: 0.800 Test Loss: 0.360 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3355247974395752
Epoch: 15, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.344 Vali Acc: 0.806 Test Loss: 0.344 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4284417629241943
Epoch: 16, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.351 Vali Acc: 0.833 Test Loss: 0.351 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 17 cost time: 1.2392261028289795
Epoch: 17, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.342 Vali Acc: 0.806 Test Loss: 0.342 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3541386127471924
Epoch: 18, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 19 cost time: 1.3817975521087646
Epoch: 19, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.22462797164917
Epoch: 20, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.352 Vali Acc: 0.828 Test Loss: 0.352 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2746825218200684
Epoch: 21, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.315 Vali Acc: 0.833 Test Loss: 0.315 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 1.2722666263580322
Epoch: 22, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866664).  Saving model ...
Epoch: 23 cost time: 1.4209327697753906
Epoch: 23, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.39851975440979
Epoch: 24, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.308 Vali Acc: 0.828 Test Loss: 0.308 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2409231662750244
Epoch: 25, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2301504611968994
Epoch: 26, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.297 Vali Acc: 0.833 Test Loss: 0.297 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2091076374053955
Epoch: 27, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.297621726989746
Epoch: 28, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.317 Vali Acc: 0.833 Test Loss: 0.317 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3267080783843994
Epoch: 29, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.280998945236206
Epoch: 30, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.294 Vali Acc: 0.833 Test Loss: 0.294 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3293159008026123
Epoch: 31, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 32 cost time: 1.360302209854126
Epoch: 32, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.300 Vali Acc: 0.867 Test Loss: 0.300 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4423582553863525
Epoch: 33, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.289 Vali Acc: 0.833 Test Loss: 0.289 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3320600986480713
Epoch: 34, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 35 cost time: 1.2251274585723877
Epoch: 35, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.281 Vali Acc: 0.861 Test Loss: 0.281 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2552695274353027
Epoch: 36, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.267592430114746
Epoch: 37, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.372737169265747
Epoch: 38, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 39 cost time: 1.2608485221862793
Epoch: 39, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4926426410675049
Epoch: 40, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 41 cost time: 1.3699250221252441
Epoch: 41, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.285 Vali Acc: 0.850 Test Loss: 0.285 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5619323253631592
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3036308288574219
Epoch: 43, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2689688205718994
Epoch: 44, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2753081321716309
Epoch: 45, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.3677992820739746
Epoch: 46, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3222012519836426
Epoch: 47, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.395371913909912
Epoch: 48, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.3576757907867432
Epoch: 49, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.297 Vali Acc: 0.872 Test Loss: 0.297 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4409806728363037
Epoch: 50, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 113766
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5245561599731445
Epoch: 1, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.486 Vali Acc: 0.489 Test Loss: 1.486 Test Acc: 0.489
Validation loss decreased (inf --> -0.488874).  Saving model ...
Epoch: 2 cost time: 1.290952205657959
Epoch: 2, Steps: 12 | Train Loss: 1.353 Vali Loss: 1.159 Vali Acc: 0.667 Test Loss: 1.159 Test Acc: 0.667
Validation loss decreased (-0.488874 --> -0.666655).  Saving model ...
Epoch: 3 cost time: 1.4734535217285156
Epoch: 3, Steps: 12 | Train Loss: 1.030 Vali Loss: 0.904 Vali Acc: 0.700 Test Loss: 0.904 Test Acc: 0.700
Validation loss decreased (-0.666655 --> -0.699991).  Saving model ...
Epoch: 4 cost time: 1.4388103485107422
Epoch: 4, Steps: 12 | Train Loss: 0.833 Vali Loss: 0.750 Vali Acc: 0.711 Test Loss: 0.750 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711104).  Saving model ...
Epoch: 5 cost time: 1.314133882522583
Epoch: 5, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.638 Vali Acc: 0.728 Test Loss: 0.638 Test Acc: 0.728
Validation loss decreased (-0.711104 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 1.2948565483093262
Epoch: 6, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.574 Vali Acc: 0.750 Test Loss: 0.574 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.3916187286376953
Epoch: 7, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.518 Vali Acc: 0.744 Test Loss: 0.518 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2190885543823242
Epoch: 8, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.474 Vali Acc: 0.789 Test Loss: 0.474 Test Acc: 0.789
Validation loss decreased (-0.749994 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.434143304824829
Epoch: 9, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.449 Vali Acc: 0.806 Test Loss: 0.449 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 10 cost time: 1.4077253341674805
Epoch: 10, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.429 Vali Acc: 0.767 Test Loss: 0.429 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.50614595413208
Epoch: 11, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.398 Vali Acc: 0.800 Test Loss: 0.398 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.451704978942871
Epoch: 12, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.378 Vali Acc: 0.822 Test Loss: 0.378 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 1.563302755355835
Epoch: 13, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.357 Vali Acc: 0.811 Test Loss: 0.357 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3637990951538086
Epoch: 14, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.342 Vali Acc: 0.817 Test Loss: 0.342 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.565197467803955
Epoch: 15, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.339 Vali Acc: 0.817 Test Loss: 0.339 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3634967803955078
Epoch: 16, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.338 Vali Acc: 0.828 Test Loss: 0.338 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 17 cost time: 1.309885025024414
Epoch: 17, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.332 Vali Acc: 0.806 Test Loss: 0.332 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3779873847961426
Epoch: 18, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 19 cost time: 1.3948166370391846
Epoch: 19, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.340 Vali Acc: 0.817 Test Loss: 0.340 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2414207458496094
Epoch: 20, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.324 Vali Acc: 0.850 Test Loss: 0.324 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 21 cost time: 1.4107420444488525
Epoch: 21, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.307 Vali Acc: 0.833 Test Loss: 0.307 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.375694751739502
Epoch: 22, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 23 cost time: 1.2076010704040527
Epoch: 23, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.282 Vali Acc: 0.867 Test Loss: 0.282 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 24 cost time: 1.3399410247802734
Epoch: 24, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.282 Vali Acc: 0.850 Test Loss: 0.282 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.431147575378418
Epoch: 25, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.273 Vali Acc: 0.867 Test Loss: 0.273 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 26 cost time: 1.3363349437713623
Epoch: 26, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.273 Vali Acc: 0.861 Test Loss: 0.273 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3540639877319336
Epoch: 27, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5641324520111084
Epoch: 28, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.283 Vali Acc: 0.850 Test Loss: 0.283 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4411025047302246
Epoch: 29, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3259968757629395
Epoch: 30, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.272 Vali Acc: 0.867 Test Loss: 0.272 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 31 cost time: 1.3093247413635254
Epoch: 31, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.254 Vali Acc: 0.883 Test Loss: 0.254 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 32 cost time: 1.291654348373413
Epoch: 32, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.270153522491455
Epoch: 33, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.268 Vali Acc: 0.872 Test Loss: 0.268 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4152755737304688
Epoch: 34, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2995250225067139
Epoch: 35, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.267 Vali Acc: 0.872 Test Loss: 0.267 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4751338958740234
Epoch: 36, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3349525928497314
Epoch: 37, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.238 Vali Acc: 0.883 Test Loss: 0.238 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 38 cost time: 1.2765882015228271
Epoch: 38, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 39 cost time: 1.2725694179534912
Epoch: 39, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.509474515914917
Epoch: 40, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3839902877807617
Epoch: 41, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.267 Vali Acc: 0.867 Test Loss: 0.267 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.389134407043457
Epoch: 42, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.3603086471557617
Epoch: 43, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.242 Vali Acc: 0.878 Test Loss: 0.242 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.4627902507781982
Epoch: 44, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.4591736793518066
Epoch: 45, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.228 Vali Acc: 0.883 Test Loss: 0.228 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.4014627933502197
Epoch: 46, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.3070576190948486
Epoch: 47, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.259 Vali Acc: 0.861 Test Loss: 0.259 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.351017713546753
Epoch: 48, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 113766
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.413362741470337
Epoch: 1, Steps: 12 | Train Loss: 1.904 Vali Loss: 1.668 Vali Acc: 0.367 Test Loss: 1.668 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 1.2666471004486084
Epoch: 2, Steps: 12 | Train Loss: 1.556 Vali Loss: 1.273 Vali Acc: 0.583 Test Loss: 1.273 Test Acc: 0.583
Validation loss decreased (-0.366650 --> -0.583321).  Saving model ...
Epoch: 3 cost time: 1.28062105178833
Epoch: 3, Steps: 12 | Train Loss: 1.196 Vali Loss: 0.969 Vali Acc: 0.667 Test Loss: 0.969 Test Acc: 0.667
Validation loss decreased (-0.583321 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 1.2736706733703613
Epoch: 4, Steps: 12 | Train Loss: 0.878 Vali Loss: 0.791 Vali Acc: 0.706 Test Loss: 0.791 Test Acc: 0.706
Validation loss decreased (-0.666657 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 1.2518131732940674
Epoch: 5, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.681 Vali Acc: 0.756 Test Loss: 0.681 Test Acc: 0.756
Validation loss decreased (-0.705548 --> -0.755549).  Saving model ...
Epoch: 6 cost time: 1.165257453918457
Epoch: 6, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.612 Vali Acc: 0.733 Test Loss: 0.612 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.416795015335083
Epoch: 7, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.566 Vali Acc: 0.739 Test Loss: 0.566 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.307318925857544
Epoch: 8, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.509 Vali Acc: 0.756 Test Loss: 0.509 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755550).  Saving model ...
Epoch: 9 cost time: 1.3845422267913818
Epoch: 9, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.500 Vali Acc: 0.756 Test Loss: 0.500 Test Acc: 0.756
Validation loss decreased (-0.755550 --> -0.755551).  Saving model ...
Epoch: 10 cost time: 1.3807451725006104
Epoch: 10, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.442 Vali Acc: 0.783 Test Loss: 0.442 Test Acc: 0.783
Validation loss decreased (-0.755551 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 1.420586347579956
Epoch: 11, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.421 Vali Acc: 0.789 Test Loss: 0.421 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 12 cost time: 1.326601266860962
Epoch: 12, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.413 Vali Acc: 0.778 Test Loss: 0.413 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4479196071624756
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.384 Vali Acc: 0.822 Test Loss: 0.384 Test Acc: 0.822
Validation loss decreased (-0.788885 --> -0.822218).  Saving model ...
Epoch: 14 cost time: 1.532719612121582
Epoch: 14, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.381 Vali Acc: 0.822 Test Loss: 0.381 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 1.2877154350280762
Epoch: 15, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 16 cost time: 1.3279755115509033
Epoch: 16, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.351 Vali Acc: 0.822 Test Loss: 0.351 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 17 cost time: 1.5360629558563232
Epoch: 17, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 18 cost time: 1.1937463283538818
Epoch: 18, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 19 cost time: 1.213721752166748
Epoch: 19, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.332 Vali Acc: 0.833 Test Loss: 0.332 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4384829998016357
Epoch: 20, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3499515056610107
Epoch: 21, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.330 Vali Acc: 0.833 Test Loss: 0.330 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2365899085998535
Epoch: 22, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855552).  Saving model ...
Epoch: 23 cost time: 1.2405428886413574
Epoch: 23, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3336865901947021
Epoch: 24, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.308 Vali Acc: 0.839 Test Loss: 0.308 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3230395317077637
Epoch: 25, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4042105674743652
Epoch: 26, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3135991096496582
Epoch: 27, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.410165548324585
Epoch: 28, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 29 cost time: 1.2268998622894287
Epoch: 29, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3979015350341797
Epoch: 30, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883330).  Saving model ...
Epoch: 31 cost time: 1.417456865310669
Epoch: 31, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.231050968170166
Epoch: 32, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1525721549987793
Epoch: 33, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.294921875
Epoch: 34, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.340 Vali Acc: 0.844 Test Loss: 0.340 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.264228343963623
Epoch: 35, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2399451732635498
Epoch: 36, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.329 Vali Acc: 0.844 Test Loss: 0.329 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3045907020568848
Epoch: 37, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 38 cost time: 1.3187994956970215
Epoch: 38, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.321582555770874
Epoch: 39, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.300 Vali Acc: 0.872 Test Loss: 0.300 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2643399238586426
Epoch: 40, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 41 cost time: 1.3218634128570557
Epoch: 41, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.347294569015503
Epoch: 42, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 43 cost time: 1.2934200763702393
Epoch: 43, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.219270944595337
Epoch: 44, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2165796756744385
Epoch: 45, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1645421981811523
Epoch: 46, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2676117420196533
Epoch: 47, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.297 Vali Acc: 0.883 Test Loss: 0.297 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1585321426391602
Epoch: 48, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 49 cost time: 1.2700285911560059
Epoch: 49, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.305908203125
Epoch: 50, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.277 Vali Acc: 0.894 Test Loss: 0.277 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.328655481338501
Epoch: 51, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.30372953414917
Epoch: 52, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.3889846801757812
Epoch: 53, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.287 Vali Acc: 0.894 Test Loss: 0.287 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.3549206256866455
Epoch: 54, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.3115227222442627
Epoch: 55, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.2137784957885742
Epoch: 56, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.3546035289764404
Epoch: 57, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.283146619796753
Epoch: 58, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.294 Vali Acc: 0.894 Test Loss: 0.294 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 80998
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.409050464630127
Epoch: 1, Steps: 12 | Train Loss: 1.896 Vali Loss: 1.669 Vali Acc: 0.367 Test Loss: 1.669 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 1.3681316375732422
Epoch: 2, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.275 Vali Acc: 0.578 Test Loss: 1.275 Test Acc: 0.578
Validation loss decreased (-0.366650 --> -0.577765).  Saving model ...
Epoch: 3 cost time: 1.2418112754821777
Epoch: 3, Steps: 12 | Train Loss: 1.192 Vali Loss: 0.969 Vali Acc: 0.678 Test Loss: 0.969 Test Acc: 0.678
Validation loss decreased (-0.577765 --> -0.677768).  Saving model ...
Epoch: 4 cost time: 1.1493654251098633
Epoch: 4, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.792 Vali Acc: 0.700 Test Loss: 0.792 Test Acc: 0.700
Validation loss decreased (-0.677768 --> -0.699992).  Saving model ...
Epoch: 5 cost time: 1.4407670497894287
Epoch: 5, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.684 Vali Acc: 0.733 Test Loss: 0.684 Test Acc: 0.733
Validation loss decreased (-0.699992 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 1.204594612121582
Epoch: 6, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.615 Vali Acc: 0.728 Test Loss: 0.615 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3989229202270508
Epoch: 7, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.570 Vali Acc: 0.739 Test Loss: 0.570 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 1.3112335205078125
Epoch: 8, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.514 Vali Acc: 0.750 Test Loss: 0.514 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749995).  Saving model ...
Epoch: 9 cost time: 1.331002950668335
Epoch: 9, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.505 Vali Acc: 0.767 Test Loss: 0.505 Test Acc: 0.767
Validation loss decreased (-0.749995 --> -0.766662).  Saving model ...
Epoch: 10 cost time: 1.4870891571044922
Epoch: 10, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.444 Vali Acc: 0.783 Test Loss: 0.444 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 1.3419029712677002
Epoch: 11, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.421 Vali Acc: 0.800 Test Loss: 0.421 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 12 cost time: 1.3615329265594482
Epoch: 12, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.413 Vali Acc: 0.800 Test Loss: 0.413 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 13 cost time: 1.4363744258880615
Epoch: 13, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.386 Vali Acc: 0.817 Test Loss: 0.386 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 14 cost time: 1.140244960784912
Epoch: 14, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.382 Vali Acc: 0.817 Test Loss: 0.382 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 1.1548984050750732
Epoch: 15, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.370 Vali Acc: 0.811 Test Loss: 0.370 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2148654460906982
Epoch: 16, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.354 Vali Acc: 0.822 Test Loss: 0.354 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 17 cost time: 1.1511328220367432
Epoch: 17, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.338 Vali Acc: 0.822 Test Loss: 0.338 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 18 cost time: 1.2658131122589111
Epoch: 18, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 1.3562672138214111
Epoch: 19, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.330 Vali Acc: 0.833 Test Loss: 0.330 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5169823169708252
Epoch: 20, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.322 Vali Acc: 0.828 Test Loss: 0.322 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2513573169708252
Epoch: 21, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.327 Vali Acc: 0.817 Test Loss: 0.327 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2136375904083252
Epoch: 22, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 23 cost time: 1.3728466033935547
Epoch: 23, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.299 Vali Acc: 0.844 Test Loss: 0.299 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3521509170532227
Epoch: 24, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.304 Vali Acc: 0.844 Test Loss: 0.304 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5146129131317139
Epoch: 25, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3597745895385742
Epoch: 26, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3741862773895264
Epoch: 27, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 28 cost time: 1.3755805492401123
Epoch: 28, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2692785263061523
Epoch: 29, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3093857765197754
Epoch: 30, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 31 cost time: 1.3726418018341064
Epoch: 31, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4322874546051025
Epoch: 32, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3262567520141602
Epoch: 33, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 34 cost time: 1.343193769454956
Epoch: 34, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1425461769104004
Epoch: 35, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2433395385742188
Epoch: 36, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.272815227508545
Epoch: 37, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 1.3834083080291748
Epoch: 38, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3922288417816162
Epoch: 39, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3031837940216064
Epoch: 40, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 41 cost time: 1.3302254676818848
Epoch: 41, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.430772066116333
Epoch: 42, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 43 cost time: 1.4709641933441162
Epoch: 43, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3630468845367432
Epoch: 44, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.4046072959899902
Epoch: 45, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3040375709533691
Epoch: 46, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.4803569316864014
Epoch: 47, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.305 Vali Acc: 0.883 Test Loss: 0.305 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2969577312469482
Epoch: 48, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.3796343803405762
Epoch: 49, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.3747498989105225
Epoch: 50, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.2980194091796875
Epoch: 51, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.2939226627349854
Epoch: 52, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 80998
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.593271017074585
Epoch: 1, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.649 Vali Acc: 0.439 Test Loss: 1.649 Test Acc: 0.439
Validation loss decreased (inf --> -0.438872).  Saving model ...
Epoch: 2 cost time: 1.3120083808898926
Epoch: 2, Steps: 12 | Train Loss: 1.544 Vali Loss: 1.258 Vali Acc: 0.594 Test Loss: 1.258 Test Acc: 0.594
Validation loss decreased (-0.438872 --> -0.594432).  Saving model ...
Epoch: 3 cost time: 1.2164442539215088
Epoch: 3, Steps: 12 | Train Loss: 1.174 Vali Loss: 0.951 Vali Acc: 0.711 Test Loss: 0.951 Test Acc: 0.711
Validation loss decreased (-0.594432 --> -0.711102).  Saving model ...
Epoch: 4 cost time: 1.2113254070281982
Epoch: 4, Steps: 12 | Train Loss: 0.854 Vali Loss: 0.774 Vali Acc: 0.733 Test Loss: 0.774 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733326).  Saving model ...
Epoch: 5 cost time: 1.2442469596862793
Epoch: 5, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.670 Vali Acc: 0.761 Test Loss: 0.670 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761104).  Saving model ...
Epoch: 6 cost time: 1.2698872089385986
Epoch: 6, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.596 Vali Acc: 0.750 Test Loss: 0.596 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.582319974899292
Epoch: 7, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.551 Vali Acc: 0.756 Test Loss: 0.551 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.232471227645874
Epoch: 8, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.496 Vali Acc: 0.756 Test Loss: 0.496 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2030420303344727
Epoch: 9, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.485 Vali Acc: 0.772 Test Loss: 0.485 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772217).  Saving model ...
Epoch: 10 cost time: 1.394282341003418
Epoch: 10, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.432 Vali Acc: 0.778 Test Loss: 0.432 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 11 cost time: 1.0742723941802979
Epoch: 11, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.408 Vali Acc: 0.800 Test Loss: 0.408 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 12 cost time: 1.369375228881836
Epoch: 12, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.398 Vali Acc: 0.794 Test Loss: 0.398 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4942705631256104
Epoch: 13, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.371 Vali Acc: 0.822 Test Loss: 0.371 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822219).  Saving model ...
Epoch: 14 cost time: 1.4980583190917969
Epoch: 14, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.369 Vali Acc: 0.817 Test Loss: 0.369 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3857145309448242
Epoch: 15, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.357 Vali Acc: 0.817 Test Loss: 0.357 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.395644187927246
Epoch: 16, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.344 Vali Acc: 0.828 Test Loss: 0.344 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 17 cost time: 1.3454067707061768
Epoch: 17, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 18 cost time: 1.3416953086853027
Epoch: 18, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 19 cost time: 1.276975154876709
Epoch: 19, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.316 Vali Acc: 0.839 Test Loss: 0.316 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3588042259216309
Epoch: 20, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 21 cost time: 1.2533259391784668
Epoch: 21, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.319 Vali Acc: 0.822 Test Loss: 0.319 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2506630420684814
Epoch: 22, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 23 cost time: 1.2907323837280273
Epoch: 23, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.293 Vali Acc: 0.844 Test Loss: 0.293 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.327263355255127
Epoch: 24, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2479138374328613
Epoch: 25, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.255549669265747
Epoch: 26, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3538827896118164
Epoch: 27, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4903881549835205
Epoch: 28, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4589810371398926
Epoch: 29, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3690321445465088
Epoch: 30, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.297 Vali Acc: 0.883 Test Loss: 0.297 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 31 cost time: 1.3997583389282227
Epoch: 31, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.381638765335083
Epoch: 32, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3882827758789062
Epoch: 33, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2910189628601074
Epoch: 34, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.304957628250122
Epoch: 35, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.335 Vali Acc: 0.861 Test Loss: 0.335 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2275867462158203
Epoch: 36, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2759981155395508
Epoch: 37, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 1.2657458782196045
Epoch: 38, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2121987342834473
Epoch: 39, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5480618476867676
Epoch: 40, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 41 cost time: 1.2122955322265625
Epoch: 41, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.292 Vali Acc: 0.883 Test Loss: 0.292 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4175963401794434
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 43 cost time: 1.3130428791046143
Epoch: 43, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2690269947052002
Epoch: 44, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2531070709228516
Epoch: 45, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.296 Vali Acc: 0.894 Test Loss: 0.296 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.263733148574829
Epoch: 46, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2951698303222656
Epoch: 47, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.391373634338379
Epoch: 48, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.275787591934204
Epoch: 49, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.2634639739990234
Epoch: 50, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 51 cost time: 1.310148000717163
Epoch: 51, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3740015029907227
Epoch: 52, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.504784345626831
Epoch: 53, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.2780299186706543
Epoch: 54, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.5564289093017578
Epoch: 55, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.288 Vali Acc: 0.894 Test Loss: 0.288 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.5447359085083008
Epoch: 56, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.2662506103515625
Epoch: 57, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.295 Vali Acc: 0.894 Test Loss: 0.295 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.377248764038086
Epoch: 58, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.324 Vali Acc: 0.883 Test Loss: 0.324 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.3302111625671387
Epoch: 59, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.2763209342956543
Epoch: 60, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 80998
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3605968952178955
Epoch: 1, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.637 Vali Acc: 0.389 Test Loss: 1.637 Test Acc: 0.389
Validation loss decreased (inf --> -0.388873).  Saving model ...
Epoch: 2 cost time: 1.4050331115722656
Epoch: 2, Steps: 12 | Train Loss: 1.519 Vali Loss: 1.254 Vali Acc: 0.639 Test Loss: 1.254 Test Acc: 0.639
Validation loss decreased (-0.388873 --> -0.638876).  Saving model ...
Epoch: 3 cost time: 1.3075530529022217
Epoch: 3, Steps: 12 | Train Loss: 1.168 Vali Loss: 0.942 Vali Acc: 0.728 Test Loss: 0.942 Test Acc: 0.728
Validation loss decreased (-0.638876 --> -0.727768).  Saving model ...
Epoch: 4 cost time: 1.2140464782714844
Epoch: 4, Steps: 12 | Train Loss: 0.855 Vali Loss: 0.756 Vali Acc: 0.728 Test Loss: 0.756 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727770).  Saving model ...
Epoch: 5 cost time: 1.2215652465820312
Epoch: 5, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.645 Vali Acc: 0.767 Test Loss: 0.645 Test Acc: 0.767
Validation loss decreased (-0.727770 --> -0.766660).  Saving model ...
Epoch: 6 cost time: 1.2275962829589844
Epoch: 6, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3022150993347168
Epoch: 7, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.521 Vali Acc: 0.756 Test Loss: 0.521 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2126424312591553
Epoch: 8, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.466 Vali Acc: 0.783 Test Loss: 0.466 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783329).  Saving model ...
Epoch: 9 cost time: 1.3314766883850098
Epoch: 9, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.451 Vali Acc: 0.778 Test Loss: 0.451 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3447463512420654
Epoch: 10, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.403 Vali Acc: 0.817 Test Loss: 0.403 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 11 cost time: 1.2792961597442627
Epoch: 11, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.382 Vali Acc: 0.828 Test Loss: 0.382 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 1.3674843311309814
Epoch: 12, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 13 cost time: 1.3316240310668945
Epoch: 13, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.345 Vali Acc: 0.833 Test Loss: 0.345 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 14 cost time: 1.3651278018951416
Epoch: 14, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.342 Vali Acc: 0.844 Test Loss: 0.342 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 1.3565058708190918
Epoch: 15, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.329 Vali Acc: 0.828 Test Loss: 0.329 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4377284049987793
Epoch: 16, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 17 cost time: 1.3081777095794678
Epoch: 17, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.3171110153198242
Epoch: 18, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 19 cost time: 1.3407073020935059
Epoch: 19, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2916898727416992
Epoch: 20, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3792176246643066
Epoch: 21, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.293 Vali Acc: 0.844 Test Loss: 0.293 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2278220653533936
Epoch: 22, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 23 cost time: 1.3169167041778564
Epoch: 23, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3667442798614502
Epoch: 24, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.278 Vali Acc: 0.850 Test Loss: 0.278 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2387452125549316
Epoch: 25, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.288 Vali Acc: 0.833 Test Loss: 0.288 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2468218803405762
Epoch: 26, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.276 Vali Acc: 0.861 Test Loss: 0.276 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3426690101623535
Epoch: 27, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.275 Vali Acc: 0.867 Test Loss: 0.275 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5403354167938232
Epoch: 28, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.277 Vali Acc: 0.867 Test Loss: 0.277 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3212504386901855
Epoch: 29, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.380152940750122
Epoch: 30, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4079923629760742
Epoch: 31, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3292179107666016
Epoch: 32, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 33 cost time: 1.2134971618652344
Epoch: 33, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.263 Vali Acc: 0.867 Test Loss: 0.263 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3714673519134521
Epoch: 34, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1497011184692383
Epoch: 35, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.421116828918457
Epoch: 36, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2955708503723145
Epoch: 37, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2586116790771484
Epoch: 38, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.275 Vali Acc: 0.850 Test Loss: 0.275 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2522361278533936
Epoch: 39, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 40 cost time: 1.2706387042999268
Epoch: 40, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.253 Vali Acc: 0.878 Test Loss: 0.253 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3309519290924072
Epoch: 41, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2627084255218506
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.4005980491638184
Epoch: 43, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2377502918243408
Epoch: 44, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.257 Vali Acc: 0.878 Test Loss: 0.257 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2128281593322754
Epoch: 45, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.241 Vali Acc: 0.883 Test Loss: 0.241 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.248631477355957
Epoch: 46, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 47 cost time: 1.4537787437438965
Epoch: 47, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.38600492477417
Epoch: 48, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 49 cost time: 1.2522304058074951
Epoch: 49, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.219 Vali Acc: 0.906 Test Loss: 0.219 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 50 cost time: 1.2083463668823242
Epoch: 50, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.301220178604126
Epoch: 51, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.2202365398406982
Epoch: 52, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.4564454555511475
Epoch: 53, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.183765172958374
Epoch: 54, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.165954351425171
Epoch: 55, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.248 Vali Acc: 0.894 Test Loss: 0.248 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.162395715713501
Epoch: 56, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.1366617679595947
Epoch: 57, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.101632833480835
Epoch: 58, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.311 Vali Acc: 0.883 Test Loss: 0.311 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.2746708393096924
Epoch: 59, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 80998
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4945313930511475
Epoch: 1, Steps: 12 | Train Loss: 1.899 Vali Loss: 1.727 Vali Acc: 0.278 Test Loss: 1.727 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 1.2266979217529297
Epoch: 2, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.354 Vali Acc: 0.522 Test Loss: 1.354 Test Acc: 0.522
Validation loss decreased (-0.277761 --> -0.522209).  Saving model ...
Epoch: 3 cost time: 1.2997982501983643
Epoch: 3, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.031 Vali Acc: 0.633 Test Loss: 1.031 Test Acc: 0.633
Validation loss decreased (-0.522209 --> -0.633323).  Saving model ...
Epoch: 4 cost time: 1.3597705364227295
Epoch: 4, Steps: 12 | Train Loss: 0.895 Vali Loss: 0.851 Vali Acc: 0.639 Test Loss: 0.851 Test Acc: 0.639
Validation loss decreased (-0.633323 --> -0.638880).  Saving model ...
Epoch: 5 cost time: 1.2993276119232178
Epoch: 5, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.722 Vali Acc: 0.689 Test Loss: 0.722 Test Acc: 0.689
Validation loss decreased (-0.638880 --> -0.688882).  Saving model ...
Epoch: 6 cost time: 1.331446886062622
Epoch: 6, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.639 Vali Acc: 0.689 Test Loss: 0.639 Test Acc: 0.689
Validation loss decreased (-0.688882 --> -0.688882).  Saving model ...
Epoch: 7 cost time: 1.451322317123413
Epoch: 7, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.569 Vali Acc: 0.739 Test Loss: 0.569 Test Acc: 0.739
Validation loss decreased (-0.688882 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 1.4423937797546387
Epoch: 8, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.522 Vali Acc: 0.772 Test Loss: 0.522 Test Acc: 0.772
Validation loss decreased (-0.738883 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 1.2239995002746582
Epoch: 9, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.482 Vali Acc: 0.778 Test Loss: 0.482 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 10 cost time: 1.212975025177002
Epoch: 10, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.447 Vali Acc: 0.811 Test Loss: 0.447 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 1.3457551002502441
Epoch: 11, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.434 Vali Acc: 0.800 Test Loss: 0.434 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4327821731567383
Epoch: 12, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.421 Vali Acc: 0.778 Test Loss: 0.421 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.596426010131836
Epoch: 13, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.403 Vali Acc: 0.783 Test Loss: 0.403 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.450484275817871
Epoch: 14, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.371 Vali Acc: 0.828 Test Loss: 0.371 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 15 cost time: 1.2155287265777588
Epoch: 15, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.358 Vali Acc: 0.811 Test Loss: 0.358 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.328646183013916
Epoch: 16, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.366 Vali Acc: 0.839 Test Loss: 0.366 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 1.2962791919708252
Epoch: 17, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.344 Vali Acc: 0.828 Test Loss: 0.344 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5617728233337402
Epoch: 18, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.346 Vali Acc: 0.817 Test Loss: 0.346 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3574674129486084
Epoch: 19, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.333 Vali Acc: 0.828 Test Loss: 0.333 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2042622566223145
Epoch: 20, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 21 cost time: 1.195746898651123
Epoch: 21, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.335 Vali Acc: 0.822 Test Loss: 0.335 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2228693962097168
Epoch: 22, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 23 cost time: 1.2647125720977783
Epoch: 23, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.312 Vali Acc: 0.833 Test Loss: 0.312 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2441730499267578
Epoch: 24, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.310 Vali Acc: 0.828 Test Loss: 0.310 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.317601203918457
Epoch: 25, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.308 Vali Acc: 0.839 Test Loss: 0.308 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.277062177658081
Epoch: 26, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 27 cost time: 1.3148162364959717
Epoch: 27, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 28 cost time: 1.3720324039459229
Epoch: 28, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.339 Vali Acc: 0.817 Test Loss: 0.339 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.272742748260498
Epoch: 29, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.304 Vali Acc: 0.844 Test Loss: 0.304 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4768280982971191
Epoch: 30, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4124088287353516
Epoch: 31, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 32 cost time: 1.4830069541931152
Epoch: 32, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.31541109085083
Epoch: 33, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3173837661743164
Epoch: 34, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.348381519317627
Epoch: 35, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3982057571411133
Epoch: 36, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3604435920715332
Epoch: 37, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1686832904815674
Epoch: 38, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 39 cost time: 1.345921277999878
Epoch: 39, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3096861839294434
Epoch: 40, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 41 cost time: 1.3927891254425049
Epoch: 41, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3793625831604004
Epoch: 42, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3798561096191406
Epoch: 43, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3406484127044678
Epoch: 44, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.4507761001586914
Epoch: 45, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.4713187217712402
Epoch: 46, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.290 Vali Acc: 0.850 Test Loss: 0.290 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2996926307678223
Epoch: 47, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.4372339248657227
Epoch: 48, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.366821527481079
Epoch: 49, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.3085196018218994
Epoch: 50, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 64614
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.452918767929077
Epoch: 1, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.723 Vali Acc: 0.239 Test Loss: 1.723 Test Acc: 0.239
Validation loss decreased (inf --> -0.238872).  Saving model ...
Epoch: 2 cost time: 1.1762592792510986
Epoch: 2, Steps: 12 | Train Loss: 1.629 Vali Loss: 1.348 Vali Acc: 0.511 Test Loss: 1.348 Test Acc: 0.511
Validation loss decreased (-0.238872 --> -0.511098).  Saving model ...
Epoch: 3 cost time: 1.2528655529022217
Epoch: 3, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.027 Vali Acc: 0.617 Test Loss: 1.027 Test Acc: 0.617
Validation loss decreased (-0.511098 --> -0.616656).  Saving model ...
Epoch: 4 cost time: 1.3294627666473389
Epoch: 4, Steps: 12 | Train Loss: 0.887 Vali Loss: 0.847 Vali Acc: 0.639 Test Loss: 0.847 Test Acc: 0.639
Validation loss decreased (-0.616656 --> -0.638880).  Saving model ...
Epoch: 5 cost time: 1.1823177337646484
Epoch: 5, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.720 Vali Acc: 0.683 Test Loss: 0.720 Test Acc: 0.683
Validation loss decreased (-0.638880 --> -0.683326).  Saving model ...
Epoch: 6 cost time: 1.4944181442260742
Epoch: 6, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.637 Vali Acc: 0.689 Test Loss: 0.637 Test Acc: 0.689
Validation loss decreased (-0.683326 --> -0.688883).  Saving model ...
Epoch: 7 cost time: 1.3593957424163818
Epoch: 7, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.568 Vali Acc: 0.750 Test Loss: 0.568 Test Acc: 0.750
Validation loss decreased (-0.688883 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.3252291679382324
Epoch: 8, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 1.313143014907837
Epoch: 9, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.482 Vali Acc: 0.783 Test Loss: 0.482 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 10 cost time: 1.1283118724822998
Epoch: 10, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.449 Vali Acc: 0.806 Test Loss: 0.449 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 1.2099690437316895
Epoch: 11, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.436 Vali Acc: 0.789 Test Loss: 0.436 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2801697254180908
Epoch: 12, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.418 Vali Acc: 0.778 Test Loss: 0.418 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4155774116516113
Epoch: 13, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.399 Vali Acc: 0.794 Test Loss: 0.399 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2338104248046875
Epoch: 14, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.368 Vali Acc: 0.833 Test Loss: 0.368 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833330).  Saving model ...
Epoch: 15 cost time: 1.2365100383758545
Epoch: 15, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.358 Vali Acc: 0.811 Test Loss: 0.358 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.42830491065979
Epoch: 16, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3190252780914307
Epoch: 17, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.342 Vali Acc: 0.833 Test Loss: 0.342 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 18 cost time: 1.2527878284454346
Epoch: 18, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.344 Vali Acc: 0.817 Test Loss: 0.344 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.291121244430542
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.331 Vali Acc: 0.822 Test Loss: 0.331 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3022489547729492
Epoch: 20, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 21 cost time: 1.4503140449523926
Epoch: 21, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4707245826721191
Epoch: 22, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 23 cost time: 1.417947769165039
Epoch: 23, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.311 Vali Acc: 0.828 Test Loss: 0.311 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.257542371749878
Epoch: 24, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.308 Vali Acc: 0.828 Test Loss: 0.308 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2737207412719727
Epoch: 25, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.305 Vali Acc: 0.839 Test Loss: 0.305 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 26 cost time: 1.2654898166656494
Epoch: 26, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.301 Vali Acc: 0.839 Test Loss: 0.301 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 27 cost time: 1.1851866245269775
Epoch: 27, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
Validation loss decreased (-0.838886 --> -0.883330).  Saving model ...
Epoch: 28 cost time: 1.20274019241333
Epoch: 28, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.333 Vali Acc: 0.828 Test Loss: 0.333 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.289454460144043
Epoch: 29, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.303 Vali Acc: 0.839 Test Loss: 0.303 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1416146755218506
Epoch: 30, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.336 Vali Acc: 0.828 Test Loss: 0.336 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2289903163909912
Epoch: 31, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2629945278167725
Epoch: 32, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4588966369628906
Epoch: 33, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2358736991882324
Epoch: 34, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.303 Vali Acc: 0.844 Test Loss: 0.303 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3373422622680664
Epoch: 35, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3866386413574219
Epoch: 36, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.283 Vali Acc: 0.856 Test Loss: 0.283 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2327613830566406
Epoch: 37, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 64614
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1061363220214844
Epoch: 1, Steps: 12 | Train Loss: 1.878 Vali Loss: 1.725 Vali Acc: 0.233 Test Loss: 1.725 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 1.2334070205688477
Epoch: 2, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.349 Vali Acc: 0.511 Test Loss: 1.349 Test Acc: 0.511
Validation loss decreased (-0.233316 --> -0.511098).  Saving model ...
Epoch: 3 cost time: 1.2542550563812256
Epoch: 3, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.022 Vali Acc: 0.639 Test Loss: 1.022 Test Acc: 0.639
Validation loss decreased (-0.511098 --> -0.638879).  Saving model ...
Epoch: 4 cost time: 1.3911950588226318
Epoch: 4, Steps: 12 | Train Loss: 0.869 Vali Loss: 0.846 Vali Acc: 0.650 Test Loss: 0.846 Test Acc: 0.650
Validation loss decreased (-0.638879 --> -0.649992).  Saving model ...
Epoch: 5 cost time: 1.4069507122039795
Epoch: 5, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.714 Vali Acc: 0.717 Test Loss: 0.714 Test Acc: 0.717
Validation loss decreased (-0.649992 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 1.2082314491271973
Epoch: 6, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.625 Vali Acc: 0.706 Test Loss: 0.625 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2038331031799316
Epoch: 7, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.565 Vali Acc: 0.744 Test Loss: 0.565 Test Acc: 0.744
Validation loss decreased (-0.716660 --> -0.744439).  Saving model ...
Epoch: 8 cost time: 1.1150176525115967
Epoch: 8, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.744439 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.1832220554351807
Epoch: 9, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.472 Vali Acc: 0.778 Test Loss: 0.472 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3129546642303467
Epoch: 10, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.441 Vali Acc: 0.800 Test Loss: 0.441 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799996).  Saving model ...
Epoch: 11 cost time: 1.24247407913208
Epoch: 11, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.426 Vali Acc: 0.800 Test Loss: 0.426 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 12 cost time: 1.1705689430236816
Epoch: 12, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.410 Vali Acc: 0.800 Test Loss: 0.410 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 13 cost time: 1.258723497390747
Epoch: 13, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.393 Vali Acc: 0.794 Test Loss: 0.393 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2060754299163818
Epoch: 14, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.360 Vali Acc: 0.839 Test Loss: 0.360 Test Acc: 0.839
Validation loss decreased (-0.799996 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 1.3226675987243652
Epoch: 15, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.349 Vali Acc: 0.828 Test Loss: 0.349 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3401851654052734
Epoch: 16, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.351 Vali Acc: 0.822 Test Loss: 0.351 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2065751552581787
Epoch: 17, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.332 Vali Acc: 0.822 Test Loss: 0.332 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1691062450408936
Epoch: 18, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.332 Vali Acc: 0.822 Test Loss: 0.332 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2507832050323486
Epoch: 19, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.323 Vali Acc: 0.839 Test Loss: 0.323 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 20 cost time: 1.1977674961090088
Epoch: 20, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.320 Vali Acc: 0.833 Test Loss: 0.320 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.220468282699585
Epoch: 21, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.320 Vali Acc: 0.817 Test Loss: 0.320 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2314600944519043
Epoch: 22, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 23 cost time: 1.2366328239440918
Epoch: 23, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.302 Vali Acc: 0.844 Test Loss: 0.302 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2163724899291992
Epoch: 24, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.297 Vali Acc: 0.833 Test Loss: 0.297 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1769156455993652
Epoch: 25, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.291 Vali Acc: 0.850 Test Loss: 0.291 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 26 cost time: 1.1947078704833984
Epoch: 26, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.290 Vali Acc: 0.844 Test Loss: 0.290 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.295011043548584
Epoch: 27, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 28 cost time: 1.3848886489868164
Epoch: 28, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.320 Vali Acc: 0.828 Test Loss: 0.320 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2708306312561035
Epoch: 29, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3824119567871094
Epoch: 30, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3381104469299316
Epoch: 31, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2599709033966064
Epoch: 32, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1709587574005127
Epoch: 33, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2622826099395752
Epoch: 34, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.341217041015625
Epoch: 35, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2765238285064697
Epoch: 36, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 37 cost time: 1.2783796787261963
Epoch: 37, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2251884937286377
Epoch: 38, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2443413734436035
Epoch: 39, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2422971725463867
Epoch: 40, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 41 cost time: 1.398848295211792
Epoch: 41, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4210445880889893
Epoch: 42, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.390425682067871
Epoch: 43, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2767679691314697
Epoch: 44, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2568237781524658
Epoch: 45, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.145817518234253
Epoch: 46, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.398594856262207
Epoch: 47, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.2764403820037842
Epoch: 48, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.0717592239379883
Epoch: 49, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.223778486251831
Epoch: 50, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 64614
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.649365186691284
Epoch: 1, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.689 Vali Acc: 0.261 Test Loss: 1.689 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 1.3186943531036377
Epoch: 2, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.329 Vali Acc: 0.511 Test Loss: 1.329 Test Acc: 0.511
Validation loss decreased (-0.261094 --> -0.511098).  Saving model ...
Epoch: 3 cost time: 1.127411127090454
Epoch: 3, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.011 Vali Acc: 0.650 Test Loss: 1.011 Test Acc: 0.650
Validation loss decreased (-0.511098 --> -0.649990).  Saving model ...
Epoch: 4 cost time: 1.304769515991211
Epoch: 4, Steps: 12 | Train Loss: 0.861 Vali Loss: 0.837 Vali Acc: 0.667 Test Loss: 0.837 Test Acc: 0.667
Validation loss decreased (-0.649990 --> -0.666658).  Saving model ...
Epoch: 5 cost time: 1.2044827938079834
Epoch: 5, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.716 Vali Acc: 0.717 Test Loss: 0.716 Test Acc: 0.717
Validation loss decreased (-0.666658 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 1.1118659973144531
Epoch: 6, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.624 Vali Acc: 0.717 Test Loss: 0.624 Test Acc: 0.717
Validation loss decreased (-0.716660 --> -0.716660).  Saving model ...
Epoch: 7 cost time: 1.2575876712799072
Epoch: 7, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.551 Vali Acc: 0.744 Test Loss: 0.551 Test Acc: 0.744
Validation loss decreased (-0.716660 --> -0.744439).  Saving model ...
Epoch: 8 cost time: 1.082991361618042
Epoch: 8, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.502 Vali Acc: 0.778 Test Loss: 0.502 Test Acc: 0.778
Validation loss decreased (-0.744439 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.127119541168213
Epoch: 9, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.467 Vali Acc: 0.767 Test Loss: 0.467 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1404139995574951
Epoch: 10, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.433 Vali Acc: 0.800 Test Loss: 0.433 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 11 cost time: 1.065338134765625
Epoch: 11, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.410 Vali Acc: 0.811 Test Loss: 0.410 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 1.0590829849243164
Epoch: 12, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.398 Vali Acc: 0.817 Test Loss: 0.398 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 13 cost time: 1.1329131126403809
Epoch: 13, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.386 Vali Acc: 0.806 Test Loss: 0.386 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2355639934539795
Epoch: 14, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.348 Vali Acc: 0.861 Test Loss: 0.348 Test Acc: 0.861
Validation loss decreased (-0.816663 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 1.2589523792266846
Epoch: 15, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3361828327178955
Epoch: 16, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.342 Vali Acc: 0.817 Test Loss: 0.342 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3472983837127686
Epoch: 17, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.324 Vali Acc: 0.850 Test Loss: 0.324 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2009713649749756
Epoch: 18, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.329 Vali Acc: 0.828 Test Loss: 0.329 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1954774856567383
Epoch: 19, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.320 Vali Acc: 0.828 Test Loss: 0.320 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.228578805923462
Epoch: 20, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1725685596466064
Epoch: 21, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.311 Vali Acc: 0.833 Test Loss: 0.311 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1463735103607178
Epoch: 22, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 23 cost time: 1.192636251449585
Epoch: 23, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.295 Vali Acc: 0.850 Test Loss: 0.295 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.155649185180664
Epoch: 24, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.290 Vali Acc: 0.850 Test Loss: 0.290 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1457529067993164
Epoch: 25, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1981065273284912
Epoch: 26, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.278 Vali Acc: 0.856 Test Loss: 0.278 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1729357242584229
Epoch: 27, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 28 cost time: 1.2148017883300781
Epoch: 28, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.302 Vali Acc: 0.822 Test Loss: 0.302 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.153829574584961
Epoch: 29, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.282573938369751
Epoch: 30, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.305 Vali Acc: 0.839 Test Loss: 0.305 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2528600692749023
Epoch: 31, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.277 Vali Acc: 0.861 Test Loss: 0.277 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2208411693572998
Epoch: 32, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1205337047576904
Epoch: 33, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.1586925983428955
Epoch: 34, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.276 Vali Acc: 0.867 Test Loss: 0.276 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0845205783843994
Epoch: 35, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.230545997619629
Epoch: 36, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899997).  Saving model ...
Epoch: 37 cost time: 1.1718332767486572
Epoch: 37, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.174264669418335
Epoch: 38, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.265 Vali Acc: 0.872 Test Loss: 0.265 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1325359344482422
Epoch: 39, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.144784927368164
Epoch: 40, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.277 Vali Acc: 0.861 Test Loss: 0.277 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1749110221862793
Epoch: 41, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0630147457122803
Epoch: 42, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1744647026062012
Epoch: 43, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.2100014686584473
Epoch: 44, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.309464693069458
Epoch: 45, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.1673691272735596
Epoch: 46, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 64614
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.340620279312134
Epoch: 1, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.815 Vali Acc: 0.133 Test Loss: 1.815 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.0517160892486572
Epoch: 2, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.619 Vali Acc: 0.394 Test Loss: 1.619 Test Acc: 0.394
Validation loss decreased (-0.133315 --> -0.394428).  Saving model ...
Epoch: 3 cost time: 1.0819013118743896
Epoch: 3, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.386 Vali Acc: 0.572 Test Loss: 1.386 Test Acc: 0.572
Validation loss decreased (-0.394428 --> -0.572208).  Saving model ...
Epoch: 4 cost time: 1.152010202407837
Epoch: 4, Steps: 12 | Train Loss: 1.333 Vali Loss: 1.175 Vali Acc: 0.633 Test Loss: 1.175 Test Acc: 0.633
Validation loss decreased (-0.572208 --> -0.633322).  Saving model ...
Epoch: 5 cost time: 1.0891847610473633
Epoch: 5, Steps: 12 | Train Loss: 1.103 Vali Loss: 0.995 Vali Acc: 0.661 Test Loss: 0.995 Test Acc: 0.661
Validation loss decreased (-0.633322 --> -0.661101).  Saving model ...
Epoch: 6 cost time: 1.1547935009002686
Epoch: 6, Steps: 12 | Train Loss: 0.926 Vali Loss: 0.863 Vali Acc: 0.678 Test Loss: 0.863 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677769).  Saving model ...
Epoch: 7 cost time: 1.1565701961517334
Epoch: 7, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.771 Vali Acc: 0.717 Test Loss: 0.771 Test Acc: 0.717
Validation loss decreased (-0.677769 --> -0.716659).  Saving model ...
Epoch: 8 cost time: 1.3762037754058838
Epoch: 8, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.696 Vali Acc: 0.700 Test Loss: 0.696 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2304399013519287
Epoch: 9, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.641 Vali Acc: 0.722 Test Loss: 0.641 Test Acc: 0.722
Validation loss decreased (-0.716659 --> -0.722216).  Saving model ...
Epoch: 10 cost time: 1.225998878479004
Epoch: 10, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.591 Vali Acc: 0.728 Test Loss: 0.591 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727772).  Saving model ...
Epoch: 11 cost time: 1.1296436786651611
Epoch: 11, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.546 Vali Acc: 0.767 Test Loss: 0.546 Test Acc: 0.767
Validation loss decreased (-0.727772 --> -0.766661).  Saving model ...
Epoch: 12 cost time: 1.3153679370880127
Epoch: 12, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788884).  Saving model ...
Epoch: 13 cost time: 1.324371337890625
Epoch: 13, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.488 Vali Acc: 0.778 Test Loss: 0.488 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4064288139343262
Epoch: 14, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.471 Vali Acc: 0.783 Test Loss: 0.471 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4024298191070557
Epoch: 15, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.452 Vali Acc: 0.806 Test Loss: 0.452 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 16 cost time: 1.3340466022491455
Epoch: 16, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.433 Vali Acc: 0.828 Test Loss: 0.433 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827773).  Saving model ...
Epoch: 17 cost time: 1.333845853805542
Epoch: 17, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.427 Vali Acc: 0.806 Test Loss: 0.427 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2026481628417969
Epoch: 18, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.422 Vali Acc: 0.783 Test Loss: 0.422 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.233511209487915
Epoch: 19, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.410 Vali Acc: 0.811 Test Loss: 0.410 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2350072860717773
Epoch: 20, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.403 Vali Acc: 0.800 Test Loss: 0.403 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2802715301513672
Epoch: 21, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.391 Vali Acc: 0.806 Test Loss: 0.391 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2071616649627686
Epoch: 22, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.373 Vali Acc: 0.822 Test Loss: 0.373 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2235169410705566
Epoch: 23, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.358 Vali Acc: 0.822 Test Loss: 0.358 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1748087406158447
Epoch: 24, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 1.5060219764709473
Epoch: 25, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.266463041305542
Epoch: 26, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1184747219085693
Epoch: 27, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.348 Vali Acc: 0.833 Test Loss: 0.348 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4228270053863525
Epoch: 28, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2452855110168457
Epoch: 29, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4001343250274658
Epoch: 30, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 31 cost time: 1.3487205505371094
Epoch: 31, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 32 cost time: 1.2365925312042236
Epoch: 32, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.315 Vali Acc: 0.861 Test Loss: 0.315 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 33 cost time: 1.2532219886779785
Epoch: 33, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2763643264770508
Epoch: 34, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3193588256835938
Epoch: 35, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1817586421966553
Epoch: 36, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 37 cost time: 1.207362174987793
Epoch: 37, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1346216201782227
Epoch: 38, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.258784532546997
Epoch: 39, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.304 Vali Acc: 0.867 Test Loss: 0.304 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 40 cost time: 1.3086957931518555
Epoch: 40, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2112641334533691
Epoch: 41, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2548315525054932
Epoch: 42, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2055943012237549
Epoch: 43, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2302908897399902
Epoch: 44, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.164548635482788
Epoch: 45, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 46 cost time: 1.2797942161560059
Epoch: 46, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.283 Vali Acc: 0.856 Test Loss: 0.283 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.220961332321167
Epoch: 47, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2030303478240967
Epoch: 48, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2855889797210693
Epoch: 49, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.4546194076538086
Epoch: 50, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.1084749698638916
Epoch: 51, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.291 Vali Acc: 0.850 Test Loss: 0.291 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.1482291221618652
Epoch: 52, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 53 cost time: 1.1684470176696777
Epoch: 53, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.2227959632873535
Epoch: 54, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.237546443939209
Epoch: 55, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.2464220523834229
Epoch: 56, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.278 Vali Acc: 0.867 Test Loss: 0.278 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.3212199211120605
Epoch: 57, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.2552282810211182
Epoch: 58, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.2554357051849365
Epoch: 59, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.2867298126220703
Epoch: 60, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.4794657230377197
Epoch: 61, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.4961278438568115
Epoch: 62, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 282278
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.280353307723999
Epoch: 1, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.816 Vali Acc: 0.139 Test Loss: 1.816 Test Acc: 0.139
Validation loss decreased (inf --> -0.138871).  Saving model ...
Epoch: 2 cost time: 1.2766480445861816
Epoch: 2, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.621 Vali Acc: 0.400 Test Loss: 1.621 Test Acc: 0.400
Validation loss decreased (-0.138871 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 1.0878207683563232
Epoch: 3, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.386 Vali Acc: 0.567 Test Loss: 1.386 Test Acc: 0.567
Validation loss decreased (-0.399984 --> -0.566653).  Saving model ...
Epoch: 4 cost time: 1.2137272357940674
Epoch: 4, Steps: 12 | Train Loss: 1.321 Vali Loss: 1.174 Vali Acc: 0.644 Test Loss: 1.174 Test Acc: 0.644
Validation loss decreased (-0.566653 --> -0.644433).  Saving model ...
Epoch: 5 cost time: 1.2553601264953613
Epoch: 5, Steps: 12 | Train Loss: 1.096 Vali Loss: 0.992 Vali Acc: 0.656 Test Loss: 0.992 Test Acc: 0.656
Validation loss decreased (-0.644433 --> -0.655546).  Saving model ...
Epoch: 6 cost time: 1.2043781280517578
Epoch: 6, Steps: 12 | Train Loss: 0.921 Vali Loss: 0.862 Vali Acc: 0.667 Test Loss: 0.862 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 1.1819608211517334
Epoch: 7, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.773 Vali Acc: 0.717 Test Loss: 0.773 Test Acc: 0.717
Validation loss decreased (-0.666658 --> -0.716659).  Saving model ...
Epoch: 8 cost time: 1.2281441688537598
Epoch: 8, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.698 Vali Acc: 0.683 Test Loss: 0.698 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.14792799949646
Epoch: 9, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.645 Vali Acc: 0.728 Test Loss: 0.645 Test Acc: 0.728
Validation loss decreased (-0.716659 --> -0.727771).  Saving model ...
Epoch: 10 cost time: 1.2468197345733643
Epoch: 10, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.596 Vali Acc: 0.711 Test Loss: 0.596 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2780492305755615
Epoch: 11, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.552 Vali Acc: 0.750 Test Loss: 0.552 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 1.420431137084961
Epoch: 12, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.523 Vali Acc: 0.772 Test Loss: 0.523 Test Acc: 0.772
Validation loss decreased (-0.749994 --> -0.772217).  Saving model ...
Epoch: 13 cost time: 1.4800403118133545
Epoch: 13, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.489 Vali Acc: 0.767 Test Loss: 0.489 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.318969964981079
Epoch: 14, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.471 Vali Acc: 0.772 Test Loss: 0.471 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772218).  Saving model ...
Epoch: 15 cost time: 1.3276984691619873
Epoch: 15, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.450 Vali Acc: 0.800 Test Loss: 0.450 Test Acc: 0.800
Validation loss decreased (-0.772218 --> -0.799995).  Saving model ...
Epoch: 16 cost time: 1.2464711666107178
Epoch: 16, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.436 Vali Acc: 0.806 Test Loss: 0.436 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 1.3051650524139404
Epoch: 17, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.429 Vali Acc: 0.828 Test Loss: 0.429 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827773).  Saving model ...
Epoch: 18 cost time: 1.146193265914917
Epoch: 18, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.424 Vali Acc: 0.789 Test Loss: 0.424 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1712219715118408
Epoch: 19, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.407 Vali Acc: 0.794 Test Loss: 0.407 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.312753677368164
Epoch: 20, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.400 Vali Acc: 0.811 Test Loss: 0.400 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1503620147705078
Epoch: 21, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.388 Vali Acc: 0.811 Test Loss: 0.388 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2665510177612305
Epoch: 22, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844441).  Saving model ...
Epoch: 23 cost time: 1.1053650379180908
Epoch: 23, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1705069541931152
Epoch: 24, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.349 Vali Acc: 0.850 Test Loss: 0.349 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 25 cost time: 1.2145838737487793
Epoch: 25, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.354 Vali Acc: 0.828 Test Loss: 0.354 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2476441860198975
Epoch: 26, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.352 Vali Acc: 0.839 Test Loss: 0.352 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2462413311004639
Epoch: 27, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2433152198791504
Epoch: 28, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.338 Vali Acc: 0.856 Test Loss: 0.338 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 29 cost time: 1.18357515335083
Epoch: 29, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2288177013397217
Epoch: 30, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 31 cost time: 1.3162858486175537
Epoch: 31, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2520015239715576
Epoch: 32, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.307 Vali Acc: 0.872 Test Loss: 0.307 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 33 cost time: 1.2019107341766357
Epoch: 33, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3052330017089844
Epoch: 34, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2990539073944092
Epoch: 35, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2254416942596436
Epoch: 36, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 37 cost time: 1.2530865669250488
Epoch: 37, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2296571731567383
Epoch: 38, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.21799898147583
Epoch: 39, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.303 Vali Acc: 0.844 Test Loss: 0.303 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2622888088226318
Epoch: 40, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.282 Vali Acc: 0.867 Test Loss: 0.282 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1224582195281982
Epoch: 41, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 42 cost time: 1.2310833930969238
Epoch: 42, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3183364868164062
Epoch: 43, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.271 Vali Acc: 0.861 Test Loss: 0.271 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2485337257385254
Epoch: 44, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2827908992767334
Epoch: 45, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 1.2565100193023682
Epoch: 46, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.273 Vali Acc: 0.872 Test Loss: 0.273 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3064773082733154
Epoch: 47, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2113687992095947
Epoch: 48, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.3343796730041504
Epoch: 49, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1913673877716064
Epoch: 50, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.3009114265441895
Epoch: 51, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.267 Vali Acc: 0.872 Test Loss: 0.267 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.2059032917022705
Epoch: 52, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.210270881652832
Epoch: 53, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.278 Vali Acc: 0.856 Test Loss: 0.278 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.2464168071746826
Epoch: 54, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 55 cost time: 1.1389286518096924
Epoch: 55, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.277 Vali Acc: 0.894 Test Loss: 0.277 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2518277168273926
Epoch: 56, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1359081268310547
Epoch: 57, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.3408339023590088
Epoch: 58, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.259 Vali Acc: 0.883 Test Loss: 0.259 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.3769845962524414
Epoch: 59, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.3543124198913574
Epoch: 60, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.4100677967071533
Epoch: 61, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.3032441139221191
Epoch: 62, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.275 Vali Acc: 0.867 Test Loss: 0.275 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.1907808780670166
Epoch: 63, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.1892266273498535
Epoch: 64, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 282278
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.282670259475708
Epoch: 1, Steps: 12 | Train Loss: 1.869 Vali Loss: 1.814 Vali Acc: 0.106 Test Loss: 1.814 Test Acc: 0.106
Validation loss decreased (inf --> -0.105537).  Saving model ...
Epoch: 2 cost time: 1.1317782402038574
Epoch: 2, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.619 Vali Acc: 0.383 Test Loss: 1.619 Test Acc: 0.383
Validation loss decreased (-0.105537 --> -0.383317).  Saving model ...
Epoch: 3 cost time: 1.058558702468872
Epoch: 3, Steps: 12 | Train Loss: 1.569 Vali Loss: 1.382 Vali Acc: 0.594 Test Loss: 1.382 Test Acc: 0.594
Validation loss decreased (-0.383317 --> -0.594431).  Saving model ...
Epoch: 4 cost time: 1.2057290077209473
Epoch: 4, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.167 Vali Acc: 0.633 Test Loss: 1.167 Test Acc: 0.633
Validation loss decreased (-0.594431 --> -0.633322).  Saving model ...
Epoch: 5 cost time: 1.1621603965759277
Epoch: 5, Steps: 12 | Train Loss: 1.081 Vali Loss: 0.981 Vali Acc: 0.650 Test Loss: 0.981 Test Acc: 0.650
Validation loss decreased (-0.633322 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 1.13401198387146
Epoch: 6, Steps: 12 | Train Loss: 0.915 Vali Loss: 0.850 Vali Acc: 0.667 Test Loss: 0.850 Test Acc: 0.667
Validation loss decreased (-0.649990 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 1.1671600341796875
Epoch: 7, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.760 Vali Acc: 0.717 Test Loss: 0.760 Test Acc: 0.717
Validation loss decreased (-0.666658 --> -0.716659).  Saving model ...
Epoch: 8 cost time: 1.191267728805542
Epoch: 8, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.685 Vali Acc: 0.694 Test Loss: 0.685 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2656967639923096
Epoch: 9, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.632 Vali Acc: 0.733 Test Loss: 0.632 Test Acc: 0.733
Validation loss decreased (-0.716659 --> -0.733327).  Saving model ...
Epoch: 10 cost time: 1.2005932331085205
Epoch: 10, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.583 Vali Acc: 0.756 Test Loss: 0.583 Test Acc: 0.756
Validation loss decreased (-0.733327 --> -0.755550).  Saving model ...
Epoch: 11 cost time: 1.185964584350586
Epoch: 11, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783328).  Saving model ...
Epoch: 12 cost time: 1.2988908290863037
Epoch: 12, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.514 Vali Acc: 0.761 Test Loss: 0.514 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1915051937103271
Epoch: 13, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.482 Vali Acc: 0.800 Test Loss: 0.482 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799995).  Saving model ...
Epoch: 14 cost time: 1.0902926921844482
Epoch: 14, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.463 Vali Acc: 0.800 Test Loss: 0.463 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 15 cost time: 1.2169432640075684
Epoch: 15, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.444 Vali Acc: 0.811 Test Loss: 0.444 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 16 cost time: 1.2685513496398926
Epoch: 16, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.428 Vali Acc: 0.811 Test Loss: 0.428 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 17 cost time: 1.3329033851623535
Epoch: 17, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.423 Vali Acc: 0.817 Test Loss: 0.423 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816662).  Saving model ...
Epoch: 18 cost time: 1.2321510314941406
Epoch: 18, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.411 Vali Acc: 0.806 Test Loss: 0.411 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1570825576782227
Epoch: 19, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.406 Vali Acc: 0.822 Test Loss: 0.406 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 20 cost time: 1.225926160812378
Epoch: 20, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.390 Vali Acc: 0.828 Test Loss: 0.390 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 21 cost time: 1.1583163738250732
Epoch: 21, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.384 Vali Acc: 0.828 Test Loss: 0.384 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 22 cost time: 1.2772772312164307
Epoch: 22, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849996).  Saving model ...
Epoch: 23 cost time: 1.2065093517303467
Epoch: 23, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.350 Vali Acc: 0.856 Test Loss: 0.350 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 24 cost time: 1.2948269844055176
Epoch: 24, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2295010089874268
Epoch: 25, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2126638889312744
Epoch: 26, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.343 Vali Acc: 0.844 Test Loss: 0.343 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4058723449707031
Epoch: 27, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.339 Vali Acc: 0.844 Test Loss: 0.339 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0941314697265625
Epoch: 28, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2094395160675049
Epoch: 29, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.334 Vali Acc: 0.828 Test Loss: 0.334 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1008310317993164
Epoch: 30, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.329 Vali Acc: 0.839 Test Loss: 0.329 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.112471580505371
Epoch: 31, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.328 Vali Acc: 0.828 Test Loss: 0.328 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.13716721534729
Epoch: 32, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.08445143699646
Epoch: 33, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.326 Vali Acc: 0.839 Test Loss: 0.326 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 282278
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4572644233703613
Epoch: 1, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.792 Vali Acc: 0.133 Test Loss: 1.792 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.3339381217956543
Epoch: 2, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.600 Vali Acc: 0.433 Test Loss: 1.600 Test Acc: 0.433
Validation loss decreased (-0.133315 --> -0.433317).  Saving model ...
Epoch: 3 cost time: 1.2292590141296387
Epoch: 3, Steps: 12 | Train Loss: 1.516 Vali Loss: 1.366 Vali Acc: 0.594 Test Loss: 1.366 Test Acc: 0.594
Validation loss decreased (-0.433317 --> -0.594431).  Saving model ...
Epoch: 4 cost time: 1.2171077728271484
Epoch: 4, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.154 Vali Acc: 0.650 Test Loss: 1.154 Test Acc: 0.650
Validation loss decreased (-0.594431 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 1.3072998523712158
Epoch: 5, Steps: 12 | Train Loss: 1.061 Vali Loss: 0.974 Vali Acc: 0.667 Test Loss: 0.974 Test Acc: 0.667
Validation loss decreased (-0.649988 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 1.2632644176483154
Epoch: 6, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.839 Vali Acc: 0.678 Test Loss: 0.839 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677769).  Saving model ...
Epoch: 7 cost time: 1.142054557800293
Epoch: 7, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.752 Vali Acc: 0.700 Test Loss: 0.752 Test Acc: 0.700
Validation loss decreased (-0.677769 --> -0.699992).  Saving model ...
Epoch: 8 cost time: 1.1962456703186035
Epoch: 8, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.678 Vali Acc: 0.722 Test Loss: 0.678 Test Acc: 0.722
Validation loss decreased (-0.699992 --> -0.722215).  Saving model ...
Epoch: 9 cost time: 1.2068650722503662
Epoch: 9, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.615 Vali Acc: 0.728 Test Loss: 0.615 Test Acc: 0.728
Validation loss decreased (-0.722215 --> -0.727772).  Saving model ...
Epoch: 10 cost time: 1.0955419540405273
Epoch: 10, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.562 Vali Acc: 0.750 Test Loss: 0.562 Test Acc: 0.750
Validation loss decreased (-0.727772 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 1.1514549255371094
Epoch: 11, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.515 Vali Acc: 0.761 Test Loss: 0.515 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761106).  Saving model ...
Epoch: 12 cost time: 1.1188077926635742
Epoch: 12, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.486 Vali Acc: 0.761 Test Loss: 0.486 Test Acc: 0.761
Validation loss decreased (-0.761106 --> -0.761106).  Saving model ...
Epoch: 13 cost time: 1.1451737880706787
Epoch: 13, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.454 Vali Acc: 0.789 Test Loss: 0.454 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788884).  Saving model ...
Epoch: 14 cost time: 1.1857259273529053
Epoch: 14, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.435 Vali Acc: 0.811 Test Loss: 0.435 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811107).  Saving model ...
Epoch: 15 cost time: 1.194291114807129
Epoch: 15, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.416 Vali Acc: 0.806 Test Loss: 0.416 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1384599208831787
Epoch: 16, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.404 Vali Acc: 0.806 Test Loss: 0.404 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2765181064605713
Epoch: 17, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.397 Vali Acc: 0.794 Test Loss: 0.397 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2193233966827393
Epoch: 18, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.394 Vali Acc: 0.794 Test Loss: 0.394 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3579697608947754
Epoch: 19, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.362 Vali Acc: 0.822 Test Loss: 0.362 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 20 cost time: 1.247520923614502
Epoch: 20, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.377 Vali Acc: 0.800 Test Loss: 0.377 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2200565338134766
Epoch: 21, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.360 Vali Acc: 0.844 Test Loss: 0.360 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 22 cost time: 1.29664945602417
Epoch: 22, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.354 Vali Acc: 0.828 Test Loss: 0.354 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1988732814788818
Epoch: 23, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.329 Vali Acc: 0.844 Test Loss: 0.329 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 24 cost time: 1.233278751373291
Epoch: 24, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4087145328521729
Epoch: 25, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.331 Vali Acc: 0.839 Test Loss: 0.331 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2289345264434814
Epoch: 26, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 27 cost time: 1.265700101852417
Epoch: 27, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 28 cost time: 1.2945144176483154
Epoch: 28, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3088345527648926
Epoch: 29, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3774759769439697
Epoch: 30, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.288 Vali Acc: 0.839 Test Loss: 0.288 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.334855318069458
Epoch: 31, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3669588565826416
Epoch: 32, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 1.2432386875152588
Epoch: 33, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.355858325958252
Epoch: 34, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 1.4543583393096924
Epoch: 35, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.278 Vali Acc: 0.856 Test Loss: 0.278 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2136468887329102
Epoch: 36, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.268 Vali Acc: 0.861 Test Loss: 0.268 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2835867404937744
Epoch: 37, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3088817596435547
Epoch: 38, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.285 Vali Acc: 0.856 Test Loss: 0.285 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2791495323181152
Epoch: 39, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.2848219871520996
Epoch: 40, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.269 Vali Acc: 0.861 Test Loss: 0.269 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2956323623657227
Epoch: 41, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.263 Vali Acc: 0.861 Test Loss: 0.263 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.2491674423217773
Epoch: 42, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 1.3402304649353027
Epoch: 43, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.311 Vali Acc: 0.872 Test Loss: 0.311 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3609673976898193
Epoch: 44, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2181761264801025
Epoch: 45, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 1.31772780418396
Epoch: 46, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2091405391693115
Epoch: 47, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.254610538482666
Epoch: 48, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 49 cost time: 1.3244960308074951
Epoch: 49, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.304 Vali Acc: 0.867 Test Loss: 0.304 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3817448616027832
Epoch: 50, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.3777110576629639
Epoch: 51, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.44024658203125
Epoch: 52, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.3415107727050781
Epoch: 53, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.342 Vali Acc: 0.872 Test Loss: 0.342 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.243598222732544
Epoch: 54, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.459174394607544
Epoch: 55, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.335 Vali Acc: 0.856 Test Loss: 0.335 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.579822301864624
Epoch: 56, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 57 cost time: 1.5871460437774658
Epoch: 57, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.3711330890655518
Epoch: 58, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 59 cost time: 1.4638800621032715
Epoch: 59, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.4198415279388428
Epoch: 60, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.256 Vali Acc: 0.878 Test Loss: 0.256 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1662015914916992
Epoch: 61, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.266 Vali Acc: 0.911 Test Loss: 0.266 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.4530997276306152
Epoch: 62, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.3229248523712158
Epoch: 63, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 1.6022472381591797
Epoch: 64, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.4902257919311523
Epoch: 65, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.5762231349945068
Epoch: 66, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.529062271118164
Epoch: 67, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.4744987487792969
Epoch: 68, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.4035701751708984
Epoch: 69, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.3695530891418457
Epoch: 70, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.332 Vali Acc: 0.883 Test Loss: 0.332 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.3826539516448975
Epoch: 71, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.438297986984253
Epoch: 72, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.419407844543457
Epoch: 73, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927776).  Saving model ...
Epoch: 74 cost time: 1.3871793746948242
Epoch: 74, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.545409917831421
Epoch: 75, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.5028979778289795
Epoch: 76, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.5611729621887207
Epoch: 77, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.5984511375427246
Epoch: 78, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.455 Vali Acc: 0.867 Test Loss: 0.455 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.554344892501831
Epoch: 79, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.5619375705718994
Epoch: 80, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.340 Vali Acc: 0.878 Test Loss: 0.340 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.5455658435821533
Epoch: 81, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.5704505443572998
Epoch: 82, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.4753599166870117
Epoch: 83, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 282278
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6278932094573975
Epoch: 1, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.708 Vali Acc: 0.228 Test Loss: 1.708 Test Acc: 0.228
Validation loss decreased (inf --> -0.227761).  Saving model ...
Epoch: 2 cost time: 1.4004096984863281
Epoch: 2, Steps: 12 | Train Loss: 1.603 Vali Loss: 1.539 Vali Acc: 0.317 Test Loss: 1.539 Test Acc: 0.317
Validation loss decreased (-0.227761 --> -0.316651).  Saving model ...
Epoch: 3 cost time: 1.6194612979888916
Epoch: 3, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.335 Vali Acc: 0.528 Test Loss: 1.335 Test Acc: 0.528
Validation loss decreased (-0.316651 --> -0.527764).  Saving model ...
Epoch: 4 cost time: 1.445768117904663
Epoch: 4, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.149 Vali Acc: 0.628 Test Loss: 1.149 Test Acc: 0.628
Validation loss decreased (-0.527764 --> -0.627766).  Saving model ...
Epoch: 5 cost time: 1.2805328369140625
Epoch: 5, Steps: 12 | Train Loss: 1.057 Vali Loss: 0.993 Vali Acc: 0.644 Test Loss: 0.993 Test Acc: 0.644
Validation loss decreased (-0.627766 --> -0.644435).  Saving model ...
Epoch: 6 cost time: 1.326533317565918
Epoch: 6, Steps: 12 | Train Loss: 0.919 Vali Loss: 0.872 Vali Acc: 0.650 Test Loss: 0.872 Test Acc: 0.650
Validation loss decreased (-0.644435 --> -0.649991).  Saving model ...
Epoch: 7 cost time: 1.1816215515136719
Epoch: 7, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.771 Vali Acc: 0.672 Test Loss: 0.771 Test Acc: 0.672
Validation loss decreased (-0.649991 --> -0.672215).  Saving model ...
Epoch: 8 cost time: 1.2537024021148682
Epoch: 8, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.704 Vali Acc: 0.689 Test Loss: 0.704 Test Acc: 0.689
Validation loss decreased (-0.672215 --> -0.688882).  Saving model ...
Epoch: 9 cost time: 1.2315850257873535
Epoch: 9, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.647 Vali Acc: 0.722 Test Loss: 0.647 Test Acc: 0.722
Validation loss decreased (-0.688882 --> -0.722216).  Saving model ...
Epoch: 10 cost time: 1.123474359512329
Epoch: 10, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.613 Vali Acc: 0.728 Test Loss: 0.613 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727772).  Saving model ...
Epoch: 11 cost time: 1.1978404521942139
Epoch: 11, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.335007905960083
Epoch: 12, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.548 Vali Acc: 0.744 Test Loss: 0.548 Test Acc: 0.744
Validation loss decreased (-0.727772 --> -0.744439).  Saving model ...
Epoch: 13 cost time: 1.2390930652618408
Epoch: 13, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.507 Vali Acc: 0.756 Test Loss: 0.507 Test Acc: 0.756
Validation loss decreased (-0.744439 --> -0.755550).  Saving model ...
Epoch: 14 cost time: 1.3020844459533691
Epoch: 14, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.483 Vali Acc: 0.767 Test Loss: 0.483 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766662).  Saving model ...
Epoch: 15 cost time: 1.1120398044586182
Epoch: 15, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.470 Vali Acc: 0.761 Test Loss: 0.470 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.268920660018921
Epoch: 16, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.457 Vali Acc: 0.783 Test Loss: 0.457 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783329).  Saving model ...
Epoch: 17 cost time: 1.053030252456665
Epoch: 17, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.447 Vali Acc: 0.756 Test Loss: 0.447 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.096921682357788
Epoch: 18, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.434 Vali Acc: 0.772 Test Loss: 0.434 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1849706172943115
Epoch: 19, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.419 Vali Acc: 0.800 Test Loss: 0.419 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 20 cost time: 1.1803107261657715
Epoch: 20, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.403 Vali Acc: 0.794 Test Loss: 0.403 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2501184940338135
Epoch: 21, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.385 Vali Acc: 0.822 Test Loss: 0.385 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 22 cost time: 1.3305935859680176
Epoch: 22, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.373 Vali Acc: 0.833 Test Loss: 0.373 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 23 cost time: 1.1838457584381104
Epoch: 23, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.363 Vali Acc: 0.839 Test Loss: 0.363 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 24 cost time: 1.1836023330688477
Epoch: 24, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.372 Vali Acc: 0.822 Test Loss: 0.372 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.187537431716919
Epoch: 25, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.365 Vali Acc: 0.839 Test Loss: 0.365 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2308897972106934
Epoch: 26, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 27 cost time: 1.2095999717712402
Epoch: 27, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.351 Vali Acc: 0.850 Test Loss: 0.351 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 28 cost time: 1.3280525207519531
Epoch: 28, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1179039478302002
Epoch: 29, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.327 Vali Acc: 0.861 Test Loss: 0.327 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 30 cost time: 1.2137222290039062
Epoch: 30, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.336 Vali Acc: 0.828 Test Loss: 0.336 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1318347454071045
Epoch: 31, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.331 Vali Acc: 0.867 Test Loss: 0.331 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 32 cost time: 1.2601466178894043
Epoch: 32, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1596271991729736
Epoch: 33, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.20107102394104
Epoch: 34, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.255249261856079
Epoch: 35, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 36 cost time: 1.3149306774139404
Epoch: 36, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2843568325042725
Epoch: 37, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2384321689605713
Epoch: 38, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2634661197662354
Epoch: 39, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.221423864364624
Epoch: 40, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1504907608032227
Epoch: 41, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 42 cost time: 1.1346242427825928
Epoch: 42, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1459379196166992
Epoch: 43, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.290 Vali Acc: 0.878 Test Loss: 0.290 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0640809535980225
Epoch: 44, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.197685956954956
Epoch: 45, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.144500732421875
Epoch: 46, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2592737674713135
Epoch: 47, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.296 Vali Acc: 0.856 Test Loss: 0.296 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2611258029937744
Epoch: 48, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.0488452911376953
Epoch: 49, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.3153245449066162
Epoch: 50, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.3270094394683838
Epoch: 51, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 52 cost time: 1.298548936843872
Epoch: 52, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3599963188171387
Epoch: 53, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.3917794227600098
Epoch: 54, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.184495449066162
Epoch: 55, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.333981990814209
Epoch: 56, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.1968927383422852
Epoch: 57, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.296 Vali Acc: 0.861 Test Loss: 0.296 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.1691153049468994
Epoch: 58, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.2964656352996826
Epoch: 59, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.1568315029144287
Epoch: 60, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 61 cost time: 1.1015384197235107
Epoch: 61, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.282 Vali Acc: 0.861 Test Loss: 0.282 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.1760165691375732
Epoch: 62, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 63 cost time: 1.2032487392425537
Epoch: 63, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.3196351528167725
Epoch: 64, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.262 Vali Acc: 0.872 Test Loss: 0.262 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.3289813995361328
Epoch: 65, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.255 Vali Acc: 0.878 Test Loss: 0.255 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.2010366916656494
Epoch: 66, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 67 cost time: 1.2118542194366455
Epoch: 67, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.240116834640503
Epoch: 68, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.1543560028076172
Epoch: 69, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.3263940811157227
Epoch: 70, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.1457152366638184
Epoch: 71, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.30715012550354
Epoch: 72, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.2114067077636719
Epoch: 73, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.0805363655090332
Epoch: 74, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.1880993843078613
Epoch: 75, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.255300521850586
Epoch: 76, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 151206
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1907901763916016
Epoch: 1, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.708 Vali Acc: 0.222 Test Loss: 1.708 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 1.1967966556549072
Epoch: 2, Steps: 12 | Train Loss: 1.605 Vali Loss: 1.537 Vali Acc: 0.317 Test Loss: 1.537 Test Acc: 0.317
Validation loss decreased (-0.222205 --> -0.316651).  Saving model ...
Epoch: 3 cost time: 1.2722866535186768
Epoch: 3, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.333 Vali Acc: 0.556 Test Loss: 1.333 Test Acc: 0.556
Validation loss decreased (-0.316651 --> -0.555542).  Saving model ...
Epoch: 4 cost time: 1.245574951171875
Epoch: 4, Steps: 12 | Train Loss: 1.255 Vali Loss: 1.146 Vali Acc: 0.644 Test Loss: 1.146 Test Acc: 0.644
Validation loss decreased (-0.555542 --> -0.644433).  Saving model ...
Epoch: 5 cost time: 1.301039695739746
Epoch: 5, Steps: 12 | Train Loss: 1.061 Vali Loss: 0.991 Vali Acc: 0.644 Test Loss: 0.991 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644435).  Saving model ...
Epoch: 6 cost time: 1.3556294441223145
Epoch: 6, Steps: 12 | Train Loss: 0.912 Vali Loss: 0.872 Vali Acc: 0.650 Test Loss: 0.872 Test Acc: 0.650
Validation loss decreased (-0.644435 --> -0.649991).  Saving model ...
Epoch: 7 cost time: 1.3661458492279053
Epoch: 7, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.773 Vali Acc: 0.667 Test Loss: 0.773 Test Acc: 0.667
Validation loss decreased (-0.649991 --> -0.666659).  Saving model ...
Epoch: 8 cost time: 1.1950111389160156
Epoch: 8, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.702 Vali Acc: 0.689 Test Loss: 0.702 Test Acc: 0.689
Validation loss decreased (-0.666659 --> -0.688882).  Saving model ...
Epoch: 9 cost time: 1.1732850074768066
Epoch: 9, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.644 Vali Acc: 0.711 Test Loss: 0.644 Test Acc: 0.711
Validation loss decreased (-0.688882 --> -0.711105).  Saving model ...
Epoch: 10 cost time: 1.0738098621368408
Epoch: 10, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.612 Vali Acc: 0.722 Test Loss: 0.612 Test Acc: 0.722
Validation loss decreased (-0.711105 --> -0.722216).  Saving model ...
Epoch: 11 cost time: 1.12278413772583
Epoch: 11, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.321946144104004
Epoch: 12, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.549 Vali Acc: 0.739 Test Loss: 0.549 Test Acc: 0.739
Validation loss decreased (-0.722216 --> -0.738883).  Saving model ...
Epoch: 13 cost time: 1.1772980690002441
Epoch: 13, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.511 Vali Acc: 0.744 Test Loss: 0.511 Test Acc: 0.744
Validation loss decreased (-0.738883 --> -0.744439).  Saving model ...
Epoch: 14 cost time: 1.1836373805999756
Epoch: 14, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.485 Vali Acc: 0.750 Test Loss: 0.485 Test Acc: 0.750
Validation loss decreased (-0.744439 --> -0.749995).  Saving model ...
Epoch: 15 cost time: 1.2279164791107178
Epoch: 15, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.474 Vali Acc: 0.756 Test Loss: 0.474 Test Acc: 0.756
Validation loss decreased (-0.749995 --> -0.755551).  Saving model ...
Epoch: 16 cost time: 1.2894036769866943
Epoch: 16, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.460 Vali Acc: 0.772 Test Loss: 0.460 Test Acc: 0.772
Validation loss decreased (-0.755551 --> -0.772218).  Saving model ...
Epoch: 17 cost time: 1.2006094455718994
Epoch: 17, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.445 Vali Acc: 0.778 Test Loss: 0.445 Test Acc: 0.778
Validation loss decreased (-0.772218 --> -0.777773).  Saving model ...
Epoch: 18 cost time: 1.3438568115234375
Epoch: 18, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.438 Vali Acc: 0.767 Test Loss: 0.438 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4368689060211182
Epoch: 19, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.421 Vali Acc: 0.800 Test Loss: 0.421 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 20 cost time: 1.3784863948822021
Epoch: 20, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.406 Vali Acc: 0.800 Test Loss: 0.406 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 21 cost time: 1.227121353149414
Epoch: 21, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.388 Vali Acc: 0.822 Test Loss: 0.388 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 22 cost time: 1.298931360244751
Epoch: 22, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 23 cost time: 1.1881978511810303
Epoch: 23, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.365 Vali Acc: 0.828 Test Loss: 0.365 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 24 cost time: 1.1875033378601074
Epoch: 24, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.375 Vali Acc: 0.833 Test Loss: 0.375 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 25 cost time: 1.3294250965118408
Epoch: 25, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.366 Vali Acc: 0.828 Test Loss: 0.366 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2709712982177734
Epoch: 26, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.354 Vali Acc: 0.833 Test Loss: 0.354 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 27 cost time: 1.38136887550354
Epoch: 27, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.349 Vali Acc: 0.850 Test Loss: 0.349 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 28 cost time: 1.2898316383361816
Epoch: 28, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.336 Vali Acc: 0.833 Test Loss: 0.336 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.135636329650879
Epoch: 29, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 30 cost time: 1.1467695236206055
Epoch: 30, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.339 Vali Acc: 0.828 Test Loss: 0.339 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3602626323699951
Epoch: 31, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.333 Vali Acc: 0.844 Test Loss: 0.333 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.38332200050354
Epoch: 32, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 33 cost time: 1.6770548820495605
Epoch: 33, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5559217929840088
Epoch: 34, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.310 Vali Acc: 0.872 Test Loss: 0.310 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 35 cost time: 1.5358240604400635
Epoch: 35, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3570187091827393
Epoch: 36, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4272572994232178
Epoch: 37, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2397594451904297
Epoch: 38, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.4519836902618408
Epoch: 39, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.4755733013153076
Epoch: 40, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.294 Vali Acc: 0.856 Test Loss: 0.294 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.826395034790039
Epoch: 41, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 42 cost time: 1.777904748916626
Epoch: 42, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.7288048267364502
Epoch: 43, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 44 cost time: 1.621281623840332
Epoch: 44, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.593055248260498
Epoch: 45, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4120731353759766
Epoch: 46, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3895721435546875
Epoch: 47, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.2354047298431396
Epoch: 48, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.4595909118652344
Epoch: 49, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.276 Vali Acc: 0.861 Test Loss: 0.276 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.4362928867340088
Epoch: 50, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.4425065517425537
Epoch: 51, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 52 cost time: 1.4347805976867676
Epoch: 52, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.275 Vali Acc: 0.872 Test Loss: 0.275 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.4650921821594238
Epoch: 53, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.280 Vali Acc: 0.861 Test Loss: 0.280 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.6215980052947998
Epoch: 54, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.4751427173614502
Epoch: 55, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.267 Vali Acc: 0.872 Test Loss: 0.267 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.2422397136688232
Epoch: 56, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.283 Vali Acc: 0.856 Test Loss: 0.283 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.4391813278198242
Epoch: 57, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.4827871322631836
Epoch: 58, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.5535073280334473
Epoch: 59, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.2995884418487549
Epoch: 60, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 61 cost time: 1.4278671741485596
Epoch: 61, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.3201904296875
Epoch: 62, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 63 cost time: 1.3285901546478271
Epoch: 63, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.266 Vali Acc: 0.872 Test Loss: 0.266 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.3606922626495361
Epoch: 64, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.3495264053344727
Epoch: 65, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.5095202922821045
Epoch: 66, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.255 Vali Acc: 0.894 Test Loss: 0.255 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 67 cost time: 1.4011378288269043
Epoch: 67, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 68 cost time: 1.6257953643798828
Epoch: 68, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.4500834941864014
Epoch: 69, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.3119404315948486
Epoch: 70, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.2591168880462646
Epoch: 71, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.222785234451294
Epoch: 72, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.3400819301605225
Epoch: 73, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.3382394313812256
Epoch: 74, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.3337066173553467
Epoch: 75, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.2977044582366943
Epoch: 76, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.5142171382904053
Epoch: 77, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 78 cost time: 1.5228180885314941
Epoch: 78, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.5887424945831299
Epoch: 79, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.4745268821716309
Epoch: 80, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.192136287689209
Epoch: 81, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 82 cost time: 1.6187779903411865
Epoch: 82, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.3333628177642822
Epoch: 83, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.4923512935638428
Epoch: 84, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.318183422088623
Epoch: 85, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.4024872779846191
Epoch: 86, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.328 Vali Acc: 0.872 Test Loss: 0.328 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 1.4956004619598389
Epoch: 87, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 1.244236946105957
Epoch: 88, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.317 Vali Acc: 0.878 Test Loss: 0.317 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 1.5606229305267334
Epoch: 89, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 1.3810184001922607
Epoch: 90, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 1.4263687133789062
Epoch: 91, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 151206
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3661611080169678
Epoch: 1, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.699 Vali Acc: 0.250 Test Loss: 1.699 Test Acc: 0.250
Validation loss decreased (inf --> -0.249983).  Saving model ...
Epoch: 2 cost time: 1.2584705352783203
Epoch: 2, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.526 Vali Acc: 0.356 Test Loss: 1.526 Test Acc: 0.356
Validation loss decreased (-0.249983 --> -0.355540).  Saving model ...
Epoch: 3 cost time: 1.318624496459961
Epoch: 3, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.321 Vali Acc: 0.589 Test Loss: 1.321 Test Acc: 0.589
Validation loss decreased (-0.355540 --> -0.588876).  Saving model ...
Epoch: 4 cost time: 1.1713659763336182
Epoch: 4, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.135 Vali Acc: 0.633 Test Loss: 1.135 Test Acc: 0.633
Validation loss decreased (-0.588876 --> -0.633322).  Saving model ...
Epoch: 5 cost time: 1.2527542114257812
Epoch: 5, Steps: 12 | Train Loss: 1.062 Vali Loss: 0.978 Vali Acc: 0.656 Test Loss: 0.978 Test Acc: 0.656
Validation loss decreased (-0.633322 --> -0.655546).  Saving model ...
Epoch: 6 cost time: 1.3185021877288818
Epoch: 6, Steps: 12 | Train Loss: 0.914 Vali Loss: 0.860 Vali Acc: 0.667 Test Loss: 0.860 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 1.2330572605133057
Epoch: 7, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.766 Vali Acc: 0.689 Test Loss: 0.766 Test Acc: 0.689
Validation loss decreased (-0.666658 --> -0.688881).  Saving model ...
Epoch: 8 cost time: 1.2308940887451172
Epoch: 8, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.701 Vali Acc: 0.689 Test Loss: 0.701 Test Acc: 0.689
Validation loss decreased (-0.688881 --> -0.688882).  Saving model ...
Epoch: 9 cost time: 1.1305766105651855
Epoch: 9, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.646 Vali Acc: 0.717 Test Loss: 0.646 Test Acc: 0.717
Validation loss decreased (-0.688882 --> -0.716660).  Saving model ...
Epoch: 10 cost time: 1.1258807182312012
Epoch: 10, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
Validation loss decreased (-0.716660 --> -0.722216).  Saving model ...
Epoch: 11 cost time: 1.1999669075012207
Epoch: 11, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (-0.722216 --> -0.722216).  Saving model ...
Epoch: 12 cost time: 1.2560510635375977
Epoch: 12, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.550 Vali Acc: 0.733 Test Loss: 0.550 Test Acc: 0.733
Validation loss decreased (-0.722216 --> -0.733328).  Saving model ...
Epoch: 13 cost time: 1.1814639568328857
Epoch: 13, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.507 Vali Acc: 0.744 Test Loss: 0.507 Test Acc: 0.744
Validation loss decreased (-0.733328 --> -0.744439).  Saving model ...
Epoch: 14 cost time: 1.2279713153839111
Epoch: 14, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.482 Vali Acc: 0.761 Test Loss: 0.482 Test Acc: 0.761
Validation loss decreased (-0.744439 --> -0.761106).  Saving model ...
Epoch: 15 cost time: 1.2065677642822266
Epoch: 15, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.473 Vali Acc: 0.761 Test Loss: 0.473 Test Acc: 0.761
Validation loss decreased (-0.761106 --> -0.761106).  Saving model ...
Epoch: 16 cost time: 1.1351263523101807
Epoch: 16, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.459 Vali Acc: 0.744 Test Loss: 0.459 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1944913864135742
Epoch: 17, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.439 Vali Acc: 0.778 Test Loss: 0.439 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777773).  Saving model ...
Epoch: 18 cost time: 1.2221636772155762
Epoch: 18, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.433 Vali Acc: 0.772 Test Loss: 0.433 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1750965118408203
Epoch: 19, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.414 Vali Acc: 0.794 Test Loss: 0.414 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 20 cost time: 1.1759202480316162
Epoch: 20, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.404 Vali Acc: 0.800 Test Loss: 0.404 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 21 cost time: 1.1791284084320068
Epoch: 21, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.383 Vali Acc: 0.828 Test Loss: 0.383 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 22 cost time: 1.2197370529174805
Epoch: 22, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.368 Vali Acc: 0.844 Test Loss: 0.368 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 23 cost time: 1.2679905891418457
Epoch: 23, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3138930797576904
Epoch: 24, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.370 Vali Acc: 0.833 Test Loss: 0.370 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2559177875518799
Epoch: 25, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.364 Vali Acc: 0.839 Test Loss: 0.364 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2561068534851074
Epoch: 26, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.351 Vali Acc: 0.856 Test Loss: 0.351 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 27 cost time: 1.231924295425415
Epoch: 27, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1239559650421143
Epoch: 28, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.188305139541626
Epoch: 29, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1699156761169434
Epoch: 30, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.337 Vali Acc: 0.839 Test Loss: 0.337 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1589314937591553
Epoch: 31, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 32 cost time: 1.288512945175171
Epoch: 32, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1740293502807617
Epoch: 33, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 34 cost time: 1.3000531196594238
Epoch: 34, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 35 cost time: 1.2517938613891602
Epoch: 35, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 36 cost time: 1.2003843784332275
Epoch: 36, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.357539176940918
Epoch: 37, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3360884189605713
Epoch: 38, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.328033208847046
Epoch: 39, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2964534759521484
Epoch: 40, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3533704280853271
Epoch: 41, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 42 cost time: 1.2452366352081299
Epoch: 42, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.167675495147705
Epoch: 43, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 44 cost time: 1.278451919555664
Epoch: 44, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2330453395843506
Epoch: 45, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 46 cost time: 1.1370453834533691
Epoch: 46, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2519211769104004
Epoch: 47, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1365461349487305
Epoch: 48, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1386914253234863
Epoch: 49, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 50 cost time: 1.2753100395202637
Epoch: 50, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.280801773071289
Epoch: 51, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.1925363540649414
Epoch: 52, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.2721562385559082
Epoch: 53, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.2101516723632812
Epoch: 54, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.275 Vali Acc: 0.878 Test Loss: 0.275 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.230863094329834
Epoch: 55, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.2665889263153076
Epoch: 56, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.1349027156829834
Epoch: 57, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.2443859577178955
Epoch: 58, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.2135043144226074
Epoch: 59, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 151206
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2710559368133545
Epoch: 1, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.703 Vali Acc: 0.222 Test Loss: 1.703 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 1.20052170753479
Epoch: 2, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.525 Vali Acc: 0.394 Test Loss: 1.525 Test Acc: 0.394
Validation loss decreased (-0.222205 --> -0.394429).  Saving model ...
Epoch: 3 cost time: 1.144343614578247
Epoch: 3, Steps: 12 | Train Loss: 1.431 Vali Loss: 1.320 Vali Acc: 0.556 Test Loss: 1.320 Test Acc: 0.556
Validation loss decreased (-0.394429 --> -0.555542).  Saving model ...
Epoch: 4 cost time: 1.2886996269226074
Epoch: 4, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.125 Vali Acc: 0.633 Test Loss: 1.125 Test Acc: 0.633
Validation loss decreased (-0.555542 --> -0.633322).  Saving model ...
Epoch: 5 cost time: 1.298180103302002
Epoch: 5, Steps: 12 | Train Loss: 1.059 Vali Loss: 0.960 Vali Acc: 0.644 Test Loss: 0.960 Test Acc: 0.644
Validation loss decreased (-0.633322 --> -0.644435).  Saving model ...
Epoch: 6 cost time: 1.0500445365905762
Epoch: 6, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.830 Vali Acc: 0.656 Test Loss: 0.830 Test Acc: 0.656
Validation loss decreased (-0.644435 --> -0.655547).  Saving model ...
Epoch: 7 cost time: 1.2503633499145508
Epoch: 7, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.734 Vali Acc: 0.667 Test Loss: 0.734 Test Acc: 0.667
Validation loss decreased (-0.655547 --> -0.666659).  Saving model ...
Epoch: 8 cost time: 1.2519640922546387
Epoch: 8, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.663 Vali Acc: 0.700 Test Loss: 0.663 Test Acc: 0.700
Validation loss decreased (-0.666659 --> -0.699993).  Saving model ...
Epoch: 9 cost time: 1.3038599491119385
Epoch: 9, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.602 Vali Acc: 0.700 Test Loss: 0.602 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699994).  Saving model ...
Epoch: 10 cost time: 1.043409824371338
Epoch: 10, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (-0.699994 --> -0.722217).  Saving model ...
Epoch: 11 cost time: 1.1397929191589355
Epoch: 11, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.537 Vali Acc: 0.728 Test Loss: 0.537 Test Acc: 0.728
Validation loss decreased (-0.722217 --> -0.727772).  Saving model ...
Epoch: 12 cost time: 1.0661253929138184
Epoch: 12, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.513 Vali Acc: 0.728 Test Loss: 0.513 Test Acc: 0.728
Validation loss decreased (-0.727772 --> -0.727773).  Saving model ...
Epoch: 13 cost time: 1.0408730506896973
Epoch: 13, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.470 Vali Acc: 0.744 Test Loss: 0.470 Test Acc: 0.744
Validation loss decreased (-0.727773 --> -0.744440).  Saving model ...
Epoch: 14 cost time: 1.1653757095336914
Epoch: 14, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.450 Vali Acc: 0.756 Test Loss: 0.450 Test Acc: 0.756
Validation loss decreased (-0.744440 --> -0.755551).  Saving model ...
Epoch: 15 cost time: 1.286231517791748
Epoch: 15, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.435 Vali Acc: 0.767 Test Loss: 0.435 Test Acc: 0.767
Validation loss decreased (-0.755551 --> -0.766662).  Saving model ...
Epoch: 16 cost time: 1.2729449272155762
Epoch: 16, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.426 Vali Acc: 0.772 Test Loss: 0.426 Test Acc: 0.772
Validation loss decreased (-0.766662 --> -0.772218).  Saving model ...
Epoch: 17 cost time: 1.2594575881958008
Epoch: 17, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.403 Vali Acc: 0.806 Test Loss: 0.403 Test Acc: 0.806
Validation loss decreased (-0.772218 --> -0.805552).  Saving model ...
Epoch: 18 cost time: 1.3041443824768066
Epoch: 18, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.392 Vali Acc: 0.778 Test Loss: 0.392 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3036770820617676
Epoch: 19, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.371 Vali Acc: 0.811 Test Loss: 0.371 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 20 cost time: 1.1817381381988525
Epoch: 20, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.367 Vali Acc: 0.817 Test Loss: 0.367 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 21 cost time: 1.3482389450073242
Epoch: 21, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.348 Vali Acc: 0.828 Test Loss: 0.348 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 22 cost time: 1.2071192264556885
Epoch: 22, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.331 Vali Acc: 0.861 Test Loss: 0.331 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 23 cost time: 1.1792802810668945
Epoch: 23, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.226977825164795
Epoch: 24, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.346 Vali Acc: 0.844 Test Loss: 0.346 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2843894958496094
Epoch: 25, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.329 Vali Acc: 0.856 Test Loss: 0.329 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.247370958328247
Epoch: 26, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2363841533660889
Epoch: 27, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 28 cost time: 1.408050537109375
Epoch: 28, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.320 Vali Acc: 0.839 Test Loss: 0.320 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2218654155731201
Epoch: 29, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 30 cost time: 1.1565797328948975
Epoch: 30, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.253678321838379
Epoch: 31, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2127690315246582
Epoch: 32, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3128600120544434
Epoch: 33, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.338 Vali Acc: 0.839 Test Loss: 0.338 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3055248260498047
Epoch: 34, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2726199626922607
Epoch: 35, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 1.2184553146362305
Epoch: 36, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.267894983291626
Epoch: 37, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3370590209960938
Epoch: 38, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2286953926086426
Epoch: 39, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1913635730743408
Epoch: 40, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2783122062683105
Epoch: 41, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2901957035064697
Epoch: 42, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3508539199829102
Epoch: 43, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 44 cost time: 1.2290613651275635
Epoch: 44, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.337489128112793
Epoch: 45, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1933588981628418
Epoch: 46, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3273053169250488
Epoch: 47, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.301 Vali Acc: 0.878 Test Loss: 0.301 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.3591015338897705
Epoch: 48, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 49 cost time: 1.278667688369751
Epoch: 49, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2999141216278076
Epoch: 50, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.3699212074279785
Epoch: 51, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 52 cost time: 1.252408504486084
Epoch: 52, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.268 Vali Acc: 0.872 Test Loss: 0.268 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3064486980438232
Epoch: 53, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.2283861637115479
Epoch: 54, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.229261875152588
Epoch: 55, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.2821457386016846
Epoch: 56, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.3111670017242432
Epoch: 57, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.268878698348999
Epoch: 58, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.2045025825500488
Epoch: 59, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.0890305042266846
Epoch: 60, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.1919829845428467
Epoch: 61, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 151206
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5249202251434326
Epoch: 1, Steps: 12 | Train Loss: 1.940 Vali Loss: 1.828 Vali Acc: 0.111 Test Loss: 1.828 Test Acc: 0.111
Validation loss decreased (inf --> -0.111093).  Saving model ...
Epoch: 2 cost time: 1.308969497680664
Epoch: 2, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.623 Vali Acc: 0.344 Test Loss: 1.623 Test Acc: 0.344
Validation loss decreased (-0.111093 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 1.3751192092895508
Epoch: 3, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.394 Vali Acc: 0.533 Test Loss: 1.394 Test Acc: 0.533
Validation loss decreased (-0.344428 --> -0.533319).  Saving model ...
Epoch: 4 cost time: 1.270158290863037
Epoch: 4, Steps: 12 | Train Loss: 1.305 Vali Loss: 1.193 Vali Acc: 0.572 Test Loss: 1.193 Test Acc: 0.572
Validation loss decreased (-0.533319 --> -0.572210).  Saving model ...
Epoch: 5 cost time: 1.4078731536865234
Epoch: 5, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.031 Vali Acc: 0.639 Test Loss: 1.031 Test Acc: 0.639
Validation loss decreased (-0.572210 --> -0.638879).  Saving model ...
Epoch: 6 cost time: 1.2621715068817139
Epoch: 6, Steps: 12 | Train Loss: 0.954 Vali Loss: 0.898 Vali Acc: 0.639 Test Loss: 0.898 Test Acc: 0.639
Validation loss decreased (-0.638879 --> -0.638880).  Saving model ...
Epoch: 7 cost time: 1.3858668804168701
Epoch: 7, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.798 Vali Acc: 0.667 Test Loss: 0.798 Test Acc: 0.667
Validation loss decreased (-0.638880 --> -0.666659).  Saving model ...
Epoch: 8 cost time: 1.3226399421691895
Epoch: 8, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.734 Vali Acc: 0.694 Test Loss: 0.734 Test Acc: 0.694
Validation loss decreased (-0.666659 --> -0.694437).  Saving model ...
Epoch: 9 cost time: 1.254606008529663
Epoch: 9, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.682 Vali Acc: 0.706 Test Loss: 0.682 Test Acc: 0.706
Validation loss decreased (-0.694437 --> -0.705549).  Saving model ...
Epoch: 10 cost time: 1.3120970726013184
Epoch: 10, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.625 Vali Acc: 0.761 Test Loss: 0.625 Test Acc: 0.761
Validation loss decreased (-0.705549 --> -0.761105).  Saving model ...
Epoch: 11 cost time: 1.2195048332214355
Epoch: 11, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.569 Vali Acc: 0.739 Test Loss: 0.569 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2786428928375244
Epoch: 12, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.540 Vali Acc: 0.744 Test Loss: 0.540 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.350471019744873
Epoch: 13, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.513 Vali Acc: 0.761 Test Loss: 0.513 Test Acc: 0.761
Validation loss decreased (-0.761105 --> -0.761106).  Saving model ...
Epoch: 14 cost time: 1.256911039352417
Epoch: 14, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.479 Vali Acc: 0.772 Test Loss: 0.479 Test Acc: 0.772
Validation loss decreased (-0.761106 --> -0.772217).  Saving model ...
Epoch: 15 cost time: 1.2183945178985596
Epoch: 15, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.464 Vali Acc: 0.761 Test Loss: 0.464 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2875301837921143
Epoch: 16, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.452 Vali Acc: 0.778 Test Loss: 0.452 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 17 cost time: 1.3408503532409668
Epoch: 17, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.445 Vali Acc: 0.789 Test Loss: 0.445 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788884).  Saving model ...
Epoch: 18 cost time: 1.4367120265960693
Epoch: 18, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.423 Vali Acc: 0.800 Test Loss: 0.423 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 1.3973543643951416
Epoch: 19, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.417 Vali Acc: 0.794 Test Loss: 0.417 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4056875705718994
Epoch: 20, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.397 Vali Acc: 0.800 Test Loss: 0.397 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 21 cost time: 1.260446310043335
Epoch: 21, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.380 Vali Acc: 0.806 Test Loss: 0.380 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 22 cost time: 1.3814148902893066
Epoch: 22, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.378 Vali Acc: 0.811 Test Loss: 0.378 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 23 cost time: 1.4728002548217773
Epoch: 23, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.363 Vali Acc: 0.828 Test Loss: 0.363 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 24 cost time: 1.244666576385498
Epoch: 24, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.360 Vali Acc: 0.828 Test Loss: 0.360 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 25 cost time: 1.3746647834777832
Epoch: 25, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.354 Vali Acc: 0.828 Test Loss: 0.354 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 26 cost time: 1.2885687351226807
Epoch: 26, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.343 Vali Acc: 0.844 Test Loss: 0.343 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 27 cost time: 1.2663109302520752
Epoch: 27, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3285915851593018
Epoch: 28, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 29 cost time: 1.2694497108459473
Epoch: 29, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.337 Vali Acc: 0.817 Test Loss: 0.337 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2856223583221436
Epoch: 30, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.332 Vali Acc: 0.844 Test Loss: 0.332 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.221419095993042
Epoch: 31, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0610620975494385
Epoch: 32, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2171642780303955
Epoch: 33, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 34 cost time: 1.1676180362701416
Epoch: 34, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1657514572143555
Epoch: 35, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 36 cost time: 1.205019235610962
Epoch: 36, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3161897659301758
Epoch: 37, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 38 cost time: 1.203655481338501
Epoch: 38, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 39 cost time: 1.2013258934020996
Epoch: 39, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1745762825012207
Epoch: 40, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.239029884338379
Epoch: 41, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2504255771636963
Epoch: 42, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.319 Vali Acc: 0.844 Test Loss: 0.319 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2153596878051758
Epoch: 43, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.1944248676300049
Epoch: 44, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.2035448551177979
Epoch: 45, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.281 Vali Acc: 0.861 Test Loss: 0.281 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.2080261707305908
Epoch: 46, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.230649471282959
Epoch: 47, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.3375179767608643
Epoch: 48, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 49 cost time: 1.2515180110931396
Epoch: 49, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2242841720581055
Epoch: 50, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.3775520324707031
Epoch: 51, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.3623003959655762
Epoch: 52, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.301 Vali Acc: 0.844 Test Loss: 0.301 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.3858952522277832
Epoch: 53, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.3648951053619385
Epoch: 54, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.3054380416870117
Epoch: 55, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 56 cost time: 1.2292354106903076
Epoch: 56, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.296 Vali Acc: 0.850 Test Loss: 0.296 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.2853968143463135
Epoch: 57, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.3189616203308105
Epoch: 58, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.260099172592163
Epoch: 59, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 60 cost time: 1.193359613418579
Epoch: 60, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.332 Vali Acc: 0.833 Test Loss: 0.332 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.2625386714935303
Epoch: 61, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 62 cost time: 1.3441779613494873
Epoch: 62, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.3432302474975586
Epoch: 63, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 64 cost time: 1.4043552875518799
Epoch: 64, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.275 Vali Acc: 0.872 Test Loss: 0.275 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.2869961261749268
Epoch: 65, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 66 cost time: 1.344339370727539
Epoch: 66, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.2530038356781006
Epoch: 67, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.3649473190307617
Epoch: 68, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.3827831745147705
Epoch: 69, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.3915796279907227
Epoch: 70, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.260422945022583
Epoch: 71, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.2965161800384521
Epoch: 72, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.3352291584014893
Epoch: 73, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.3855726718902588
Epoch: 74, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.385009527206421
Epoch: 75, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 85670
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4084317684173584
Epoch: 1, Steps: 12 | Train Loss: 1.954 Vali Loss: 1.842 Vali Acc: 0.083 Test Loss: 1.842 Test Acc: 0.083
Validation loss decreased (inf --> -0.083315).  Saving model ...
Epoch: 2 cost time: 1.2126703262329102
Epoch: 2, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.634 Vali Acc: 0.317 Test Loss: 1.634 Test Acc: 0.317
Validation loss decreased (-0.083315 --> -0.316650).  Saving model ...
Epoch: 3 cost time: 1.318981647491455
Epoch: 3, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.400 Vali Acc: 0.522 Test Loss: 1.400 Test Acc: 0.522
Validation loss decreased (-0.316650 --> -0.522208).  Saving model ...
Epoch: 4 cost time: 1.352269172668457
Epoch: 4, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.196 Vali Acc: 0.594 Test Loss: 1.196 Test Acc: 0.594
Validation loss decreased (-0.522208 --> -0.594432).  Saving model ...
Epoch: 5 cost time: 1.3507332801818848
Epoch: 5, Steps: 12 | Train Loss: 1.091 Vali Loss: 1.032 Vali Acc: 0.628 Test Loss: 1.032 Test Acc: 0.628
Validation loss decreased (-0.594432 --> -0.627767).  Saving model ...
Epoch: 6 cost time: 1.311910629272461
Epoch: 6, Steps: 12 | Train Loss: 0.939 Vali Loss: 0.897 Vali Acc: 0.656 Test Loss: 0.897 Test Acc: 0.656
Validation loss decreased (-0.627767 --> -0.655547).  Saving model ...
Epoch: 7 cost time: 1.3896920680999756
Epoch: 7, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.795 Vali Acc: 0.667 Test Loss: 0.795 Test Acc: 0.667
Validation loss decreased (-0.655547 --> -0.666659).  Saving model ...
Epoch: 8 cost time: 1.397864580154419
Epoch: 8, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.734 Vali Acc: 0.689 Test Loss: 0.734 Test Acc: 0.689
Validation loss decreased (-0.666659 --> -0.688882).  Saving model ...
Epoch: 9 cost time: 1.2343804836273193
Epoch: 9, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.682 Vali Acc: 0.694 Test Loss: 0.682 Test Acc: 0.694
Validation loss decreased (-0.688882 --> -0.694438).  Saving model ...
Epoch: 10 cost time: 1.2551617622375488
Epoch: 10, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.625 Vali Acc: 0.761 Test Loss: 0.625 Test Acc: 0.761
Validation loss decreased (-0.694438 --> -0.761105).  Saving model ...
Epoch: 11 cost time: 1.2344799041748047
Epoch: 11, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.566 Vali Acc: 0.756 Test Loss: 0.566 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2478575706481934
Epoch: 12, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.539 Vali Acc: 0.756 Test Loss: 0.539 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3439769744873047
Epoch: 13, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.517 Vali Acc: 0.756 Test Loss: 0.517 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1290605068206787
Epoch: 14, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.486 Vali Acc: 0.767 Test Loss: 0.486 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766662).  Saving model ...
Epoch: 15 cost time: 1.1356139183044434
Epoch: 15, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.466 Vali Acc: 0.767 Test Loss: 0.466 Test Acc: 0.767
Validation loss decreased (-0.766662 --> -0.766662).  Saving model ...
Epoch: 16 cost time: 1.2189569473266602
Epoch: 16, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.455 Vali Acc: 0.783 Test Loss: 0.455 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783329).  Saving model ...
Epoch: 17 cost time: 1.1942923069000244
Epoch: 17, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.447 Vali Acc: 0.789 Test Loss: 0.447 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788884).  Saving model ...
Epoch: 18 cost time: 1.2601099014282227
Epoch: 18, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.422 Vali Acc: 0.794 Test Loss: 0.422 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 19 cost time: 1.2731220722198486
Epoch: 19, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.415 Vali Acc: 0.789 Test Loss: 0.415 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.387282133102417
Epoch: 20, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.395 Vali Acc: 0.811 Test Loss: 0.395 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 21 cost time: 1.3976263999938965
Epoch: 21, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.380 Vali Acc: 0.811 Test Loss: 0.380 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 22 cost time: 1.3961832523345947
Epoch: 22, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.382 Vali Acc: 0.811 Test Loss: 0.382 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2278165817260742
Epoch: 23, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.366 Vali Acc: 0.828 Test Loss: 0.366 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 24 cost time: 1.384126901626587
Epoch: 24, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 25 cost time: 1.3425726890563965
Epoch: 25, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.357 Vali Acc: 0.822 Test Loss: 0.357 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2737841606140137
Epoch: 26, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.346 Vali Acc: 0.833 Test Loss: 0.346 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 27 cost time: 1.3465416431427002
Epoch: 27, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.254197359085083
Epoch: 28, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.342 Vali Acc: 0.844 Test Loss: 0.342 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 29 cost time: 1.2823145389556885
Epoch: 29, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.341 Vali Acc: 0.817 Test Loss: 0.341 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3214635848999023
Epoch: 30, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2132861614227295
Epoch: 31, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2368321418762207
Epoch: 32, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.325 Vali Acc: 0.844 Test Loss: 0.325 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 33 cost time: 1.1867449283599854
Epoch: 33, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.319 Vali Acc: 0.844 Test Loss: 0.319 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 34 cost time: 1.2669498920440674
Epoch: 34, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.329 Vali Acc: 0.839 Test Loss: 0.329 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1765928268432617
Epoch: 35, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.314 Vali Acc: 0.867 Test Loss: 0.314 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 36 cost time: 1.2006666660308838
Epoch: 36, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.319 Vali Acc: 0.844 Test Loss: 0.319 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1661279201507568
Epoch: 37, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3510651588439941
Epoch: 38, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2052297592163086
Epoch: 39, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1261579990386963
Epoch: 40, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.287672519683838
Epoch: 41, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3022902011871338
Epoch: 42, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3371093273162842
Epoch: 43, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 44 cost time: 1.3438754081726074
Epoch: 44, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2085793018341064
Epoch: 45, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.289 Vali Acc: 0.850 Test Loss: 0.289 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2456741333007812
Epoch: 46, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0972626209259033
Epoch: 47, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.2719733715057373
Epoch: 48, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2317297458648682
Epoch: 49, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.2527830600738525
Epoch: 50, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.2456707954406738
Epoch: 51, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.3054141998291016
Epoch: 52, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.237607479095459
Epoch: 53, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 85670
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.341581344604492
Epoch: 1, Steps: 12 | Train Loss: 1.918 Vali Loss: 1.829 Vali Acc: 0.106 Test Loss: 1.829 Test Acc: 0.106
Validation loss decreased (inf --> -0.105537).  Saving model ...
Epoch: 2 cost time: 1.219634771347046
Epoch: 2, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.618 Vali Acc: 0.294 Test Loss: 1.618 Test Acc: 0.294
Validation loss decreased (-0.105537 --> -0.294428).  Saving model ...
Epoch: 3 cost time: 1.3167941570281982
Epoch: 3, Steps: 12 | Train Loss: 1.530 Vali Loss: 1.388 Vali Acc: 0.511 Test Loss: 1.388 Test Acc: 0.511
Validation loss decreased (-0.294428 --> -0.511097).  Saving model ...
Epoch: 4 cost time: 1.1654889583587646
Epoch: 4, Steps: 12 | Train Loss: 1.321 Vali Loss: 1.185 Vali Acc: 0.583 Test Loss: 1.185 Test Acc: 0.583
Validation loss decreased (-0.511097 --> -0.583321).  Saving model ...
Epoch: 5 cost time: 1.260218620300293
Epoch: 5, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.023 Vali Acc: 0.633 Test Loss: 1.023 Test Acc: 0.633
Validation loss decreased (-0.583321 --> -0.633323).  Saving model ...
Epoch: 6 cost time: 1.2810423374176025
Epoch: 6, Steps: 12 | Train Loss: 0.935 Vali Loss: 0.887 Vali Acc: 0.656 Test Loss: 0.887 Test Acc: 0.656
Validation loss decreased (-0.633323 --> -0.655547).  Saving model ...
Epoch: 7 cost time: 1.1690492630004883
Epoch: 7, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.791 Vali Acc: 0.661 Test Loss: 0.791 Test Acc: 0.661
Validation loss decreased (-0.655547 --> -0.661103).  Saving model ...
Epoch: 8 cost time: 1.2045612335205078
Epoch: 8, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.730 Vali Acc: 0.689 Test Loss: 0.730 Test Acc: 0.689
Validation loss decreased (-0.661103 --> -0.688882).  Saving model ...
Epoch: 9 cost time: 1.1684668064117432
Epoch: 9, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.679 Vali Acc: 0.683 Test Loss: 0.679 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2056119441986084
Epoch: 10, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.615 Vali Acc: 0.761 Test Loss: 0.615 Test Acc: 0.761
Validation loss decreased (-0.688882 --> -0.761105).  Saving model ...
Epoch: 11 cost time: 1.24489426612854
Epoch: 11, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.558 Vali Acc: 0.744 Test Loss: 0.558 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2514803409576416
Epoch: 12, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.531 Vali Acc: 0.767 Test Loss: 0.531 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 13 cost time: 1.2742819786071777
Epoch: 13, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.511 Vali Acc: 0.772 Test Loss: 0.511 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 14 cost time: 1.0997052192687988
Epoch: 14, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.482 Vali Acc: 0.789 Test Loss: 0.482 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788884).  Saving model ...
Epoch: 15 cost time: 1.4170093536376953
Epoch: 15, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.464 Vali Acc: 0.767 Test Loss: 0.464 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3086750507354736
Epoch: 16, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.452 Vali Acc: 0.772 Test Loss: 0.452 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.352693796157837
Epoch: 17, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.441 Vali Acc: 0.778 Test Loss: 0.441 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3662223815917969
Epoch: 18, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.420 Vali Acc: 0.817 Test Loss: 0.420 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816662).  Saving model ...
Epoch: 19 cost time: 1.1784930229187012
Epoch: 19, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.412 Vali Acc: 0.806 Test Loss: 0.412 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1481397151947021
Epoch: 20, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.393 Vali Acc: 0.828 Test Loss: 0.393 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827774).  Saving model ...
Epoch: 21 cost time: 1.092658281326294
Epoch: 21, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.384 Vali Acc: 0.817 Test Loss: 0.384 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2425580024719238
Epoch: 22, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.380 Vali Acc: 0.828 Test Loss: 0.380 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 23 cost time: 1.1795094013214111
Epoch: 23, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.369 Vali Acc: 0.833 Test Loss: 0.369 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 24 cost time: 1.1462287902832031
Epoch: 24, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.361 Vali Acc: 0.839 Test Loss: 0.361 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 25 cost time: 1.1551604270935059
Epoch: 25, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1901249885559082
Epoch: 26, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.346 Vali Acc: 0.844 Test Loss: 0.346 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 27 cost time: 1.1208000183105469
Epoch: 27, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.343 Vali Acc: 0.844 Test Loss: 0.343 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 28 cost time: 1.1860167980194092
Epoch: 28, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.340 Vali Acc: 0.844 Test Loss: 0.340 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 29 cost time: 1.4011051654815674
Epoch: 29, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.343 Vali Acc: 0.844 Test Loss: 0.343 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2940261363983154
Epoch: 30, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3051588535308838
Epoch: 31, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.323 Vali Acc: 0.861 Test Loss: 0.323 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 32 cost time: 1.2417402267456055
Epoch: 32, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.318 Vali Acc: 0.867 Test Loss: 0.318 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 33 cost time: 1.3679323196411133
Epoch: 33, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.327 Vali Acc: 0.850 Test Loss: 0.327 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3083770275115967
Epoch: 34, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1932768821716309
Epoch: 35, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 36 cost time: 1.2256402969360352
Epoch: 36, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.304 Vali Acc: 0.867 Test Loss: 0.304 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 37 cost time: 1.193620204925537
Epoch: 37, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 38 cost time: 1.239832878112793
Epoch: 38, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 39 cost time: 1.4007899761199951
Epoch: 39, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.275512456893921
Epoch: 40, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3184642791748047
Epoch: 41, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2357282638549805
Epoch: 42, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2937312126159668
Epoch: 43, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2863154411315918
Epoch: 44, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.279 Vali Acc: 0.867 Test Loss: 0.279 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.3835361003875732
Epoch: 45, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.275 Vali Acc: 0.878 Test Loss: 0.275 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.269660472869873
Epoch: 46, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 47 cost time: 1.2825407981872559
Epoch: 47, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3427085876464844
Epoch: 48, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 1.3013300895690918
Epoch: 49, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.323699712753296
Epoch: 50, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0472757816314697
Epoch: 51, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.3105154037475586
Epoch: 52, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 1.4573919773101807
Epoch: 53, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 54 cost time: 1.3075106143951416
Epoch: 54, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 55 cost time: 1.288785457611084
Epoch: 55, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.5251810550689697
Epoch: 56, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.2984881401062012
Epoch: 57, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.428957223892212
Epoch: 58, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 59 cost time: 1.1692297458648682
Epoch: 59, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 60 cost time: 1.3018231391906738
Epoch: 60, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.4303297996520996
Epoch: 61, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.266 Vali Acc: 0.911 Test Loss: 0.266 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 62 cost time: 1.3842136859893799
Epoch: 62, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.3671226501464844
Epoch: 63, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.264 Vali Acc: 0.883 Test Loss: 0.264 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.3914284706115723
Epoch: 64, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.3312926292419434
Epoch: 65, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.3338675498962402
Epoch: 66, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.473282814025879
Epoch: 67, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.4139249324798584
Epoch: 68, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.2052793502807617
Epoch: 69, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.4129855632781982
Epoch: 70, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.4995369911193848
Epoch: 71, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 85670
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1727726459503174
Epoch: 1, Steps: 12 | Train Loss: 1.923 Vali Loss: 1.862 Vali Acc: 0.100 Test Loss: 1.862 Test Acc: 0.100
Validation loss decreased (inf --> -0.099981).  Saving model ...
Epoch: 2 cost time: 1.1763617992401123
Epoch: 2, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.648 Vali Acc: 0.256 Test Loss: 1.648 Test Acc: 0.256
Validation loss decreased (-0.099981 --> -0.255539).  Saving model ...
Epoch: 3 cost time: 1.279771089553833
Epoch: 3, Steps: 12 | Train Loss: 1.530 Vali Loss: 1.412 Vali Acc: 0.522 Test Loss: 1.412 Test Acc: 0.522
Validation loss decreased (-0.255539 --> -0.522208).  Saving model ...
Epoch: 4 cost time: 1.251878023147583
Epoch: 4, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.198 Vali Acc: 0.606 Test Loss: 1.198 Test Acc: 0.606
Validation loss decreased (-0.522208 --> -0.605544).  Saving model ...
Epoch: 5 cost time: 1.257399559020996
Epoch: 5, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.021 Vali Acc: 0.661 Test Loss: 1.021 Test Acc: 0.661
Validation loss decreased (-0.605544 --> -0.661101).  Saving model ...
Epoch: 6 cost time: 1.1566970348358154
Epoch: 6, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.881 Vali Acc: 0.667 Test Loss: 0.881 Test Acc: 0.667
Validation loss decreased (-0.661101 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 0.932452917098999
Epoch: 7, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.774 Vali Acc: 0.711 Test Loss: 0.774 Test Acc: 0.711
Validation loss decreased (-0.666658 --> -0.711103).  Saving model ...
Epoch: 8 cost time: 1.0708436965942383
Epoch: 8, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.708 Vali Acc: 0.694 Test Loss: 0.708 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1691603660583496
Epoch: 9, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.652 Vali Acc: 0.700 Test Loss: 0.652 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3176326751708984
Epoch: 10, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
Validation loss decreased (-0.711103 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 1.1255414485931396
Epoch: 11, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.540 Vali Acc: 0.744 Test Loss: 0.540 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3226509094238281
Epoch: 12, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.503 Vali Acc: 0.756 Test Loss: 0.503 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755551).  Saving model ...
Epoch: 13 cost time: 1.496816635131836
Epoch: 13, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.479 Vali Acc: 0.756 Test Loss: 0.479 Test Acc: 0.756
Validation loss decreased (-0.755551 --> -0.755551).  Saving model ...
Epoch: 14 cost time: 1.4945669174194336
Epoch: 14, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.446 Vali Acc: 0.789 Test Loss: 0.446 Test Acc: 0.789
Validation loss decreased (-0.755551 --> -0.788884).  Saving model ...
Epoch: 15 cost time: 1.5265154838562012
Epoch: 15, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.432 Vali Acc: 0.783 Test Loss: 0.432 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3889234066009521
Epoch: 16, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.415 Vali Acc: 0.833 Test Loss: 0.415 Test Acc: 0.833
Validation loss decreased (-0.788884 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 1.5533525943756104
Epoch: 17, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.392 Vali Acc: 0.822 Test Loss: 0.392 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5716285705566406
Epoch: 18, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.371 Vali Acc: 0.828 Test Loss: 0.371 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3802809715270996
Epoch: 19, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 20 cost time: 1.3850958347320557
Epoch: 20, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.336 Vali Acc: 0.850 Test Loss: 0.336 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 21 cost time: 1.281282901763916
Epoch: 21, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.331 Vali Acc: 0.856 Test Loss: 0.331 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 22 cost time: 1.5440433025360107
Epoch: 22, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.322 Vali Acc: 0.856 Test Loss: 0.322 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 23 cost time: 1.431603193283081
Epoch: 23, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 24 cost time: 1.206481695175171
Epoch: 24, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.462080955505371
Epoch: 25, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 26 cost time: 1.3603825569152832
Epoch: 26, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 27 cost time: 1.419034481048584
Epoch: 27, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 28 cost time: 1.6243720054626465
Epoch: 28, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.284 Vali Acc: 0.850 Test Loss: 0.284 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5430665016174316
Epoch: 29, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 1.4212193489074707
Epoch: 30, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.278 Vali Acc: 0.867 Test Loss: 0.278 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7326319217681885
Epoch: 31, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4817233085632324
Epoch: 32, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.266 Vali Acc: 0.856 Test Loss: 0.266 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.399484634399414
Epoch: 33, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 1.91090989112854
Epoch: 34, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.279 Vali Acc: 0.867 Test Loss: 0.279 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8904528617858887
Epoch: 35, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.7256050109863281
Epoch: 36, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.268 Vali Acc: 0.867 Test Loss: 0.268 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6718971729278564
Epoch: 37, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.253 Vali Acc: 0.872 Test Loss: 0.253 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.699770212173462
Epoch: 38, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.240 Vali Acc: 0.894 Test Loss: 0.240 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.6716444492340088
Epoch: 39, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.247 Vali Acc: 0.883 Test Loss: 0.247 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.6529908180236816
Epoch: 40, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.242 Vali Acc: 0.883 Test Loss: 0.242 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.6052684783935547
Epoch: 41, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.902456521987915
Epoch: 42, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.953995943069458
Epoch: 43, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.251 Vali Acc: 0.867 Test Loss: 0.251 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 85670
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.528083086013794
Epoch: 1, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.667 Vali Acc: 0.328 Test Loss: 1.667 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 1.6895618438720703
Epoch: 2, Steps: 12 | Train Loss: 1.599 Vali Loss: 1.500 Vali Acc: 0.461 Test Loss: 1.500 Test Acc: 0.461
Validation loss decreased (-0.327761 --> -0.461096).  Saving model ...
Epoch: 3 cost time: 1.628242015838623
Epoch: 3, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.306 Vali Acc: 0.594 Test Loss: 1.306 Test Acc: 0.594
Validation loss decreased (-0.461096 --> -0.594431).  Saving model ...
Epoch: 4 cost time: 1.9307310581207275
Epoch: 4, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.125 Vali Acc: 0.617 Test Loss: 1.125 Test Acc: 0.617
Validation loss decreased (-0.594431 --> -0.616655).  Saving model ...
Epoch: 5 cost time: 1.8199574947357178
Epoch: 5, Steps: 12 | Train Loss: 1.044 Vali Loss: 0.979 Vali Acc: 0.622 Test Loss: 0.979 Test Acc: 0.622
Validation loss decreased (-0.616655 --> -0.622212).  Saving model ...
Epoch: 6 cost time: 1.6835477352142334
Epoch: 6, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.865 Vali Acc: 0.672 Test Loss: 0.865 Test Acc: 0.672
Validation loss decreased (-0.622212 --> -0.672214).  Saving model ...
Epoch: 7 cost time: 1.8041059970855713
Epoch: 7, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.778 Vali Acc: 0.706 Test Loss: 0.778 Test Acc: 0.706
Validation loss decreased (-0.672214 --> -0.705548).  Saving model ...
Epoch: 8 cost time: 1.947788953781128
Epoch: 8, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.712 Vali Acc: 0.678 Test Loss: 0.712 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.869697093963623
Epoch: 9, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.637 Vali Acc: 0.744 Test Loss: 0.637 Test Acc: 0.744
Validation loss decreased (-0.705548 --> -0.744438).  Saving model ...
Epoch: 10 cost time: 1.719789981842041
Epoch: 10, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.593 Vali Acc: 0.711 Test Loss: 0.593 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6303980350494385
Epoch: 11, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.565 Vali Acc: 0.733 Test Loss: 0.565 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7858805656433105
Epoch: 12, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.528 Vali Acc: 0.761 Test Loss: 0.528 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761106).  Saving model ...
Epoch: 13 cost time: 1.8402979373931885
Epoch: 13, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.496 Vali Acc: 0.744 Test Loss: 0.496 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8392384052276611
Epoch: 14, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.468 Vali Acc: 0.772 Test Loss: 0.468 Test Acc: 0.772
Validation loss decreased (-0.761106 --> -0.772218).  Saving model ...
Epoch: 15 cost time: 1.5694665908813477
Epoch: 15, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.453 Vali Acc: 0.761 Test Loss: 0.453 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5805854797363281
Epoch: 16, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.449 Vali Acc: 0.767 Test Loss: 0.449 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9308509826660156
Epoch: 17, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.428 Vali Acc: 0.778 Test Loss: 0.428 Test Acc: 0.778
Validation loss decreased (-0.772218 --> -0.777774).  Saving model ...
Epoch: 18 cost time: 1.7995033264160156
Epoch: 18, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.405 Vali Acc: 0.800 Test Loss: 0.405 Test Acc: 0.800
Validation loss decreased (-0.777774 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 1.6771774291992188
Epoch: 19, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.393 Vali Acc: 0.806 Test Loss: 0.393 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 20 cost time: 1.7186617851257324
Epoch: 20, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.386 Vali Acc: 0.806 Test Loss: 0.386 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 21 cost time: 1.7738986015319824
Epoch: 21, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 22 cost time: 1.8884434700012207
Epoch: 22, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.376 Vali Acc: 0.806 Test Loss: 0.376 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 23 cost time: 1.7780323028564453
Epoch: 23, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 24 cost time: 1.7848353385925293
Epoch: 24, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.350 Vali Acc: 0.817 Test Loss: 0.350 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 25 cost time: 1.6302895545959473
Epoch: 25, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 26 cost time: 1.8675258159637451
Epoch: 26, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.359 Vali Acc: 0.833 Test Loss: 0.359 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7297556400299072
Epoch: 27, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.342 Vali Acc: 0.817 Test Loss: 0.342 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5924503803253174
Epoch: 28, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.326 Vali Acc: 0.828 Test Loss: 0.326 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.504558801651001
Epoch: 29, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 30 cost time: 1.8062384128570557
Epoch: 30, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.324 Vali Acc: 0.828 Test Loss: 0.324 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.773205041885376
Epoch: 31, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 32 cost time: 1.4574182033538818
Epoch: 32, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.580784559249878
Epoch: 33, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.319 Vali Acc: 0.817 Test Loss: 0.319 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7742512226104736
Epoch: 34, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5700628757476807
Epoch: 35, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3450920581817627
Epoch: 36, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3360393047332764
Epoch: 37, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.304 Vali Acc: 0.844 Test Loss: 0.304 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.376427173614502
Epoch: 38, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.298 Vali Acc: 0.844 Test Loss: 0.298 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.9321391582489014
Epoch: 39, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.313 Vali Acc: 0.833 Test Loss: 0.313 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.676276683807373
Epoch: 40, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.7554471492767334
Epoch: 41, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 52902
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.299570798873901
Epoch: 1, Steps: 12 | Train Loss: 1.742 Vali Loss: 1.667 Vali Acc: 0.322 Test Loss: 1.667 Test Acc: 0.322
Validation loss decreased (inf --> -0.322206).  Saving model ...
Epoch: 2 cost time: 1.7285127639770508
Epoch: 2, Steps: 12 | Train Loss: 1.595 Vali Loss: 1.503 Vali Acc: 0.422 Test Loss: 1.503 Test Acc: 0.422
Validation loss decreased (-0.322206 --> -0.422207).  Saving model ...
Epoch: 3 cost time: 1.7018711566925049
Epoch: 3, Steps: 12 | Train Loss: 1.362 Vali Loss: 1.308 Vali Acc: 0.572 Test Loss: 1.308 Test Acc: 0.572
Validation loss decreased (-0.422207 --> -0.572209).  Saving model ...
Epoch: 4 cost time: 1.5947365760803223
Epoch: 4, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.126 Vali Acc: 0.617 Test Loss: 1.126 Test Acc: 0.617
Validation loss decreased (-0.572209 --> -0.616655).  Saving model ...
Epoch: 5 cost time: 1.5348305702209473
Epoch: 5, Steps: 12 | Train Loss: 1.029 Vali Loss: 0.979 Vali Acc: 0.606 Test Loss: 0.979 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4659531116485596
Epoch: 6, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.868 Vali Acc: 0.650 Test Loss: 0.868 Test Acc: 0.650
Validation loss decreased (-0.616655 --> -0.649991).  Saving model ...
Epoch: 7 cost time: 1.6713039875030518
Epoch: 7, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.782 Vali Acc: 0.678 Test Loss: 0.782 Test Acc: 0.678
Validation loss decreased (-0.649991 --> -0.677770).  Saving model ...
Epoch: 8 cost time: 1.399778127670288
Epoch: 8, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.716 Vali Acc: 0.678 Test Loss: 0.716 Test Acc: 0.678
Validation loss decreased (-0.677770 --> -0.677771).  Saving model ...
Epoch: 9 cost time: 1.418414831161499
Epoch: 9, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.644 Vali Acc: 0.722 Test Loss: 0.644 Test Acc: 0.722
Validation loss decreased (-0.677771 --> -0.722216).  Saving model ...
Epoch: 10 cost time: 1.5411288738250732
Epoch: 10, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.601 Vali Acc: 0.717 Test Loss: 0.601 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6518874168395996
Epoch: 11, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.570 Vali Acc: 0.733 Test Loss: 0.570 Test Acc: 0.733
Validation loss decreased (-0.722216 --> -0.733328).  Saving model ...
Epoch: 12 cost time: 1.720703363418579
Epoch: 12, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
Validation loss decreased (-0.733328 --> -0.755550).  Saving model ...
Epoch: 13 cost time: 1.7734692096710205
Epoch: 13, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.500 Vali Acc: 0.744 Test Loss: 0.500 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8145971298217773
Epoch: 14, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.473 Vali Acc: 0.756 Test Loss: 0.473 Test Acc: 0.756
Validation loss decreased (-0.755550 --> -0.755551).  Saving model ...
Epoch: 15 cost time: 1.7425496578216553
Epoch: 15, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.458 Vali Acc: 0.756 Test Loss: 0.458 Test Acc: 0.756
Validation loss decreased (-0.755551 --> -0.755551).  Saving model ...
Epoch: 16 cost time: 1.7497951984405518
Epoch: 16, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.454 Vali Acc: 0.756 Test Loss: 0.454 Test Acc: 0.756
Validation loss decreased (-0.755551 --> -0.755551).  Saving model ...
Epoch: 17 cost time: 1.8558740615844727
Epoch: 17, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.430 Vali Acc: 0.772 Test Loss: 0.430 Test Acc: 0.772
Validation loss decreased (-0.755551 --> -0.772218).  Saving model ...
Epoch: 18 cost time: 1.6158039569854736
Epoch: 18, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.408 Vali Acc: 0.783 Test Loss: 0.408 Test Acc: 0.783
Validation loss decreased (-0.772218 --> -0.783329).  Saving model ...
Epoch: 19 cost time: 1.8530263900756836
Epoch: 19, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.396 Vali Acc: 0.811 Test Loss: 0.396 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 20 cost time: 1.7973408699035645
Epoch: 20, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.388 Vali Acc: 0.789 Test Loss: 0.388 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6923208236694336
Epoch: 21, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.387 Vali Acc: 0.794 Test Loss: 0.387 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.736034631729126
Epoch: 22, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.379 Vali Acc: 0.811 Test Loss: 0.379 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 23 cost time: 1.7043402194976807
Epoch: 23, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.369 Vali Acc: 0.817 Test Loss: 0.369 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 24 cost time: 1.6463468074798584
Epoch: 24, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.352 Vali Acc: 0.828 Test Loss: 0.352 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 25 cost time: 1.8770058155059814
Epoch: 25, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.360 Vali Acc: 0.822 Test Loss: 0.360 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2039473056793213
Epoch: 26, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.357 Vali Acc: 0.839 Test Loss: 0.357 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 27 cost time: 1.4975600242614746
Epoch: 27, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.344 Vali Acc: 0.806 Test Loss: 0.344 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5997161865234375
Epoch: 28, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.331 Vali Acc: 0.811 Test Loss: 0.331 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6405549049377441
Epoch: 29, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.324 Vali Acc: 0.822 Test Loss: 0.324 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3987536430358887
Epoch: 30, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6273491382598877
Epoch: 31, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 32 cost time: 1.9516546726226807
Epoch: 32, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5617902278900146
Epoch: 33, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.324 Vali Acc: 0.817 Test Loss: 0.324 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7338826656341553
Epoch: 34, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.324 Vali Acc: 0.844 Test Loss: 0.324 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7723944187164307
Epoch: 35, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.9487171173095703
Epoch: 36, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.304 Vali Acc: 0.833 Test Loss: 0.304 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.9955487251281738
Epoch: 37, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.309 Vali Acc: 0.833 Test Loss: 0.309 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.6337246894836426
Epoch: 38, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.306 Vali Acc: 0.844 Test Loss: 0.306 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.7453997135162354
Epoch: 39, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.749840259552002
Epoch: 40, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.6162641048431396
Epoch: 41, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 52902
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.698556900024414
Epoch: 1, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.669 Vali Acc: 0.333 Test Loss: 1.669 Test Acc: 0.333
Validation loss decreased (inf --> -0.333317).  Saving model ...
Epoch: 2 cost time: 1.6089324951171875
Epoch: 2, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.502 Vali Acc: 0.444 Test Loss: 1.502 Test Acc: 0.444
Validation loss decreased (-0.333317 --> -0.444429).  Saving model ...
Epoch: 3 cost time: 1.573998212814331
Epoch: 3, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.305 Vali Acc: 0.572 Test Loss: 1.305 Test Acc: 0.572
Validation loss decreased (-0.444429 --> -0.572209).  Saving model ...
Epoch: 4 cost time: 1.7754395008087158
Epoch: 4, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.123 Vali Acc: 0.611 Test Loss: 1.123 Test Acc: 0.611
Validation loss decreased (-0.572209 --> -0.611100).  Saving model ...
Epoch: 5 cost time: 1.7434475421905518
Epoch: 5, Steps: 12 | Train Loss: 1.030 Vali Loss: 0.973 Vali Acc: 0.628 Test Loss: 0.973 Test Acc: 0.628
Validation loss decreased (-0.611100 --> -0.627768).  Saving model ...
Epoch: 6 cost time: 1.8489487171173096
Epoch: 6, Steps: 12 | Train Loss: 0.850 Vali Loss: 0.861 Vali Acc: 0.656 Test Loss: 0.861 Test Acc: 0.656
Validation loss decreased (-0.627768 --> -0.655547).  Saving model ...
Epoch: 7 cost time: 1.7175371646881104
Epoch: 7, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.777 Vali Acc: 0.689 Test Loss: 0.777 Test Acc: 0.689
Validation loss decreased (-0.655547 --> -0.688881).  Saving model ...
Epoch: 8 cost time: 1.7835195064544678
Epoch: 8, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.712 Vali Acc: 0.683 Test Loss: 0.712 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8607127666473389
Epoch: 9, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.639 Vali Acc: 0.717 Test Loss: 0.639 Test Acc: 0.717
Validation loss decreased (-0.688881 --> -0.716660).  Saving model ...
Epoch: 10 cost time: 1.6122024059295654
Epoch: 10, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.597 Vali Acc: 0.717 Test Loss: 0.597 Test Acc: 0.717
Validation loss decreased (-0.716660 --> -0.716661).  Saving model ...
Epoch: 11 cost time: 1.8455686569213867
Epoch: 11, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.572 Vali Acc: 0.728 Test Loss: 0.572 Test Acc: 0.728
Validation loss decreased (-0.716661 --> -0.727772).  Saving model ...
Epoch: 12 cost time: 1.7038238048553467
Epoch: 12, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.536 Vali Acc: 0.733 Test Loss: 0.536 Test Acc: 0.733
Validation loss decreased (-0.727772 --> -0.733328).  Saving model ...
Epoch: 13 cost time: 1.8740897178649902
Epoch: 13, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.505 Vali Acc: 0.728 Test Loss: 0.505 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.613579273223877
Epoch: 14, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.478 Vali Acc: 0.756 Test Loss: 0.478 Test Acc: 0.756
Validation loss decreased (-0.733328 --> -0.755551).  Saving model ...
Epoch: 15 cost time: 1.5929248332977295
Epoch: 15, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.463 Vali Acc: 0.739 Test Loss: 0.463 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.847700834274292
Epoch: 16, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.458 Vali Acc: 0.744 Test Loss: 0.458 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6159734725952148
Epoch: 17, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.436 Vali Acc: 0.767 Test Loss: 0.436 Test Acc: 0.767
Validation loss decreased (-0.755551 --> -0.766662).  Saving model ...
Epoch: 18 cost time: 1.6302180290222168
Epoch: 18, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.412 Vali Acc: 0.767 Test Loss: 0.412 Test Acc: 0.767
Validation loss decreased (-0.766662 --> -0.766663).  Saving model ...
Epoch: 19 cost time: 1.5567364692687988
Epoch: 19, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.401 Vali Acc: 0.800 Test Loss: 0.401 Test Acc: 0.800
Validation loss decreased (-0.766663 --> -0.799996).  Saving model ...
Epoch: 20 cost time: 1.2936670780181885
Epoch: 20, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.392 Vali Acc: 0.783 Test Loss: 0.392 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6024229526519775
Epoch: 21, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.394 Vali Acc: 0.778 Test Loss: 0.394 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3787479400634766
Epoch: 22, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.386 Vali Acc: 0.817 Test Loss: 0.386 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 23 cost time: 1.6169521808624268
Epoch: 23, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.375 Vali Acc: 0.806 Test Loss: 0.375 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6215424537658691
Epoch: 24, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.352 Vali Acc: 0.817 Test Loss: 0.352 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 25 cost time: 1.6287221908569336
Epoch: 25, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.359 Vali Acc: 0.828 Test Loss: 0.359 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 26 cost time: 1.8397743701934814
Epoch: 26, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5072746276855469
Epoch: 27, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.344 Vali Acc: 0.817 Test Loss: 0.344 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6357979774475098
Epoch: 28, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.331 Vali Acc: 0.822 Test Loss: 0.331 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7017688751220703
Epoch: 29, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.321 Vali Acc: 0.839 Test Loss: 0.321 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 30 cost time: 1.5366206169128418
Epoch: 30, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.323 Vali Acc: 0.828 Test Loss: 0.323 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3299126625061035
Epoch: 31, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855552).  Saving model ...
Epoch: 32 cost time: 1.778588056564331
Epoch: 32, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.315 Vali Acc: 0.839 Test Loss: 0.315 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.662966251373291
Epoch: 33, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.325 Vali Acc: 0.811 Test Loss: 0.325 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6553175449371338
Epoch: 34, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7033343315124512
Epoch: 35, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.7239999771118164
Epoch: 36, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.8309834003448486
Epoch: 37, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.8653197288513184
Epoch: 38, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 39 cost time: 1.7868540287017822
Epoch: 39, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.316 Vali Acc: 0.828 Test Loss: 0.316 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5922551155090332
Epoch: 40, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 41 cost time: 1.7927556037902832
Epoch: 41, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6156280040740967
Epoch: 42, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.767699956893921
Epoch: 43, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6181859970092773
Epoch: 44, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.8502295017242432
Epoch: 45, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.844803810119629
Epoch: 46, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.278 Vali Acc: 0.856 Test Loss: 0.278 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.9430155754089355
Epoch: 47, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 48 cost time: 1.5778741836547852
Epoch: 48, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.5882878303527832
Epoch: 49, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.310 Vali Acc: 0.833 Test Loss: 0.310 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.8221652507781982
Epoch: 50, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.6876447200775146
Epoch: 51, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.281 Vali Acc: 0.856 Test Loss: 0.281 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.6044466495513916
Epoch: 52, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.467747688293457
Epoch: 53, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.270 Vali Acc: 0.867 Test Loss: 0.270 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.4989149570465088
Epoch: 54, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.296 Vali Acc: 0.839 Test Loss: 0.296 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.6420726776123047
Epoch: 55, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.4018375873565674
Epoch: 56, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.370424509048462
Epoch: 57, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 52902
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.386347532272339
Epoch: 1, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.680 Vali Acc: 0.333 Test Loss: 1.680 Test Acc: 0.333
Validation loss decreased (inf --> -0.333317).  Saving model ...
Epoch: 2 cost time: 1.7603850364685059
Epoch: 2, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.510 Vali Acc: 0.467 Test Loss: 1.510 Test Acc: 0.467
Validation loss decreased (-0.333317 --> -0.466652).  Saving model ...
Epoch: 3 cost time: 1.67875337600708
Epoch: 3, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.309 Vali Acc: 0.594 Test Loss: 1.309 Test Acc: 0.594
Validation loss decreased (-0.466652 --> -0.594431).  Saving model ...
Epoch: 4 cost time: 1.7774312496185303
Epoch: 4, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.123 Vali Acc: 0.622 Test Loss: 1.123 Test Acc: 0.622
Validation loss decreased (-0.594431 --> -0.622211).  Saving model ...
Epoch: 5 cost time: 1.6522958278656006
Epoch: 5, Steps: 12 | Train Loss: 1.016 Vali Loss: 0.968 Vali Acc: 0.678 Test Loss: 0.968 Test Acc: 0.678
Validation loss decreased (-0.622211 --> -0.677768).  Saving model ...
Epoch: 6 cost time: 1.6073253154754639
Epoch: 6, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.852 Vali Acc: 0.672 Test Loss: 0.852 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5975184440612793
Epoch: 7, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.761 Vali Acc: 0.700 Test Loss: 0.761 Test Acc: 0.700
Validation loss decreased (-0.677768 --> -0.699992).  Saving model ...
Epoch: 8 cost time: 1.4667892456054688
Epoch: 8, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.692 Vali Acc: 0.689 Test Loss: 0.692 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.327237606048584
Epoch: 9, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.623 Vali Acc: 0.722 Test Loss: 0.623 Test Acc: 0.722
Validation loss decreased (-0.699992 --> -0.722216).  Saving model ...
Epoch: 10 cost time: 1.5221095085144043
Epoch: 10, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.581 Vali Acc: 0.733 Test Loss: 0.581 Test Acc: 0.733
Validation loss decreased (-0.722216 --> -0.733328).  Saving model ...
Epoch: 11 cost time: 1.9107377529144287
Epoch: 11, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.550 Vali Acc: 0.733 Test Loss: 0.550 Test Acc: 0.733
Validation loss decreased (-0.733328 --> -0.733328).  Saving model ...
Epoch: 12 cost time: 1.7963814735412598
Epoch: 12, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.508 Vali Acc: 0.761 Test Loss: 0.508 Test Acc: 0.761
Validation loss decreased (-0.733328 --> -0.761106).  Saving model ...
Epoch: 13 cost time: 1.8696329593658447
Epoch: 13, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.475 Vali Acc: 0.767 Test Loss: 0.475 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766662).  Saving model ...
Epoch: 14 cost time: 1.755086898803711
Epoch: 14, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.446 Vali Acc: 0.778 Test Loss: 0.446 Test Acc: 0.778
Validation loss decreased (-0.766662 --> -0.777773).  Saving model ...
Epoch: 15 cost time: 1.8018479347229004
Epoch: 15, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.432 Vali Acc: 0.761 Test Loss: 0.432 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7451319694519043
Epoch: 16, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.427 Vali Acc: 0.772 Test Loss: 0.427 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7062304019927979
Epoch: 17, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.405 Vali Acc: 0.783 Test Loss: 0.405 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 18 cost time: 1.8771679401397705
Epoch: 18, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.381 Vali Acc: 0.817 Test Loss: 0.381 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 19 cost time: 1.7615935802459717
Epoch: 19, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.370 Vali Acc: 0.817 Test Loss: 0.370 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 20 cost time: 1.7830784320831299
Epoch: 20, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.362 Vali Acc: 0.811 Test Loss: 0.362 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9843790531158447
Epoch: 21, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.360 Vali Acc: 0.806 Test Loss: 0.360 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8880276679992676
Epoch: 22, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.358 Vali Acc: 0.806 Test Loss: 0.358 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5985291004180908
Epoch: 23, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.348 Vali Acc: 0.822 Test Loss: 0.348 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 24 cost time: 1.6739394664764404
Epoch: 24, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.320 Vali Acc: 0.856 Test Loss: 0.320 Test Acc: 0.856
Validation loss decreased (-0.822219 --> -0.855552).  Saving model ...
Epoch: 25 cost time: 1.2083756923675537
Epoch: 25, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.681333065032959
Epoch: 26, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.324 Vali Acc: 0.817 Test Loss: 0.324 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8180584907531738
Epoch: 27, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 28 cost time: 1.8874354362487793
Epoch: 28, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 29 cost time: 1.6526923179626465
Epoch: 29, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 30 cost time: 1.7963922023773193
Epoch: 30, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7555468082427979
Epoch: 31, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5392415523529053
Epoch: 32, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.8549957275390625
Epoch: 33, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.296 Vali Acc: 0.833 Test Loss: 0.296 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.8713901042938232
Epoch: 34, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.277 Vali Acc: 0.867 Test Loss: 0.277 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7112257480621338
Epoch: 35, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 36 cost time: 1.7400031089782715
Epoch: 36, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.261 Vali Acc: 0.872 Test Loss: 0.261 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.886082649230957
Epoch: 37, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.272 Vali Acc: 0.850 Test Loss: 0.272 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.550696849822998
Epoch: 38, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.262 Vali Acc: 0.872 Test Loss: 0.262 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.459486484527588
Epoch: 39, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.266 Vali Acc: 0.844 Test Loss: 0.266 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3251502513885498
Epoch: 40, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.244 Vali Acc: 0.883 Test Loss: 0.244 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 41 cost time: 1.5999643802642822
Epoch: 41, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.246 Vali Acc: 0.867 Test Loss: 0.246 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5391063690185547
Epoch: 42, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 43 cost time: 1.5015430450439453
Epoch: 43, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.242 Vali Acc: 0.867 Test Loss: 0.242 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.845367431640625
Epoch: 44, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.654541254043579
Epoch: 45, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.7554974555969238
Epoch: 46, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.233 Vali Acc: 0.894 Test Loss: 0.233 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 47 cost time: 1.5747430324554443
Epoch: 47, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.7478570938110352
Epoch: 48, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.231 Vali Acc: 0.894 Test Loss: 0.231 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 49 cost time: 1.8772501945495605
Epoch: 49, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.252 Vali Acc: 0.878 Test Loss: 0.252 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.7072341442108154
Epoch: 50, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.249 Vali Acc: 0.894 Test Loss: 0.249 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.6837058067321777
Epoch: 51, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.248 Vali Acc: 0.872 Test Loss: 0.248 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.8811590671539307
Epoch: 52, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.249 Vali Acc: 0.883 Test Loss: 0.249 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.5719518661499023
Epoch: 53, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.245 Vali Acc: 0.867 Test Loss: 0.245 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.5905659198760986
Epoch: 54, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.4573822021484375
Epoch: 55, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.250 Vali Acc: 0.883 Test Loss: 0.250 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.616819143295288
Epoch: 56, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.254 Vali Acc: 0.878 Test Loss: 0.254 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.5256767272949219
Epoch: 57, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.239 Vali Acc: 0.883 Test Loss: 0.239 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.9292542934417725
Epoch: 58, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.254 Vali Acc: 0.861 Test Loss: 0.254 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 52902
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.781466245651245
Epoch: 1, Steps: 12 | Train Loss: 1.780 Vali Loss: 1.713 Vali Acc: 0.172 Test Loss: 1.713 Test Acc: 0.172
Validation loss decreased (inf --> -0.172205).  Saving model ...
Epoch: 2 cost time: 1.499699354171753
Epoch: 2, Steps: 12 | Train Loss: 1.633 Vali Loss: 1.531 Vali Acc: 0.422 Test Loss: 1.531 Test Acc: 0.422
Validation loss decreased (-0.172205 --> -0.422207).  Saving model ...
Epoch: 3 cost time: 1.3049976825714111
Epoch: 3, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.335 Vali Acc: 0.500 Test Loss: 1.335 Test Acc: 0.500
Validation loss decreased (-0.422207 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.2587971687316895
Epoch: 4, Steps: 12 | Train Loss: 1.272 Vali Loss: 1.153 Vali Acc: 0.583 Test Loss: 1.153 Test Acc: 0.583
Validation loss decreased (-0.499987 --> -0.583322).  Saving model ...
Epoch: 5 cost time: 1.3008639812469482
Epoch: 5, Steps: 12 | Train Loss: 1.076 Vali Loss: 0.998 Vali Acc: 0.611 Test Loss: 0.998 Test Acc: 0.611
Validation loss decreased (-0.583322 --> -0.611101).  Saving model ...
Epoch: 6 cost time: 1.5283749103546143
Epoch: 6, Steps: 12 | Train Loss: 0.933 Vali Loss: 0.878 Vali Acc: 0.644 Test Loss: 0.878 Test Acc: 0.644
Validation loss decreased (-0.611101 --> -0.644436).  Saving model ...
Epoch: 7 cost time: 1.7459216117858887
Epoch: 7, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.783 Vali Acc: 0.700 Test Loss: 0.783 Test Acc: 0.700
Validation loss decreased (-0.644436 --> -0.699992).  Saving model ...
Epoch: 8 cost time: 1.7488772869110107
Epoch: 8, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.706 Vali Acc: 0.711 Test Loss: 0.706 Test Acc: 0.711
Validation loss decreased (-0.699992 --> -0.711104).  Saving model ...
Epoch: 9 cost time: 1.6332764625549316
Epoch: 9, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.633 Vali Acc: 0.722 Test Loss: 0.633 Test Acc: 0.722
Validation loss decreased (-0.711104 --> -0.722216).  Saving model ...
Epoch: 10 cost time: 1.79886794090271
Epoch: 10, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.594 Vali Acc: 0.733 Test Loss: 0.594 Test Acc: 0.733
Validation loss decreased (-0.722216 --> -0.733327).  Saving model ...
Epoch: 11 cost time: 1.637380838394165
Epoch: 11, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6243538856506348
Epoch: 12, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.514 Vali Acc: 0.744 Test Loss: 0.514 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744439).  Saving model ...
Epoch: 13 cost time: 1.781245470046997
Epoch: 13, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.482 Vali Acc: 0.778 Test Loss: 0.482 Test Acc: 0.778
Validation loss decreased (-0.744439 --> -0.777773).  Saving model ...
Epoch: 14 cost time: 1.8430161476135254
Epoch: 14, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.459 Vali Acc: 0.767 Test Loss: 0.459 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4052834510803223
Epoch: 15, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.443 Vali Acc: 0.772 Test Loss: 0.443 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6917264461517334
Epoch: 16, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.428 Vali Acc: 0.778 Test Loss: 0.428 Test Acc: 0.778
Validation loss decreased (-0.777773 --> -0.777774).  Saving model ...
Epoch: 17 cost time: 1.7395331859588623
Epoch: 17, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.420 Vali Acc: 0.794 Test Loss: 0.420 Test Acc: 0.794
Validation loss decreased (-0.777774 --> -0.794440).  Saving model ...
Epoch: 18 cost time: 1.7735693454742432
Epoch: 18, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.396 Vali Acc: 0.800 Test Loss: 0.396 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 1.7848830223083496
Epoch: 19, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.379 Vali Acc: 0.794 Test Loss: 0.379 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.816619634628296
Epoch: 20, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.369 Vali Acc: 0.800 Test Loss: 0.369 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 21 cost time: 1.3974180221557617
Epoch: 21, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822219).  Saving model ...
Epoch: 22 cost time: 1.7707536220550537
Epoch: 22, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.351 Vali Acc: 0.806 Test Loss: 0.351 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.093322992324829
Epoch: 23, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.345 Vali Acc: 0.822 Test Loss: 0.345 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 24 cost time: 1.926264762878418
Epoch: 24, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.335 Vali Acc: 0.844 Test Loss: 0.335 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 1.7620189189910889
Epoch: 25, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.338 Vali Acc: 0.833 Test Loss: 0.338 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5754156112670898
Epoch: 26, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.330 Vali Acc: 0.817 Test Loss: 0.330 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7477035522460938
Epoch: 27, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.319 Vali Acc: 0.844 Test Loss: 0.319 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 28 cost time: 1.8111159801483154
Epoch: 28, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 29 cost time: 1.7962989807128906
Epoch: 29, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.305 Vali Acc: 0.844 Test Loss: 0.305 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8507142066955566
Epoch: 30, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 31 cost time: 1.5524377822875977
Epoch: 31, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.897801160812378
Epoch: 32, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.9670603275299072
Epoch: 33, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.296 Vali Acc: 0.861 Test Loss: 0.296 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 34 cost time: 1.8480355739593506
Epoch: 34, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 35 cost time: 1.588822603225708
Epoch: 35, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 36 cost time: 1.599869728088379
Epoch: 36, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.289 Vali Acc: 0.850 Test Loss: 0.289 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7217049598693848
Epoch: 37, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 38 cost time: 1.6824665069580078
Epoch: 38, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.289 Vali Acc: 0.844 Test Loss: 0.289 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6984825134277344
Epoch: 39, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.259 Vali Acc: 0.872 Test Loss: 0.259 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.8443458080291748
Epoch: 40, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.7812976837158203
Epoch: 41, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 42 cost time: 1.850255012512207
Epoch: 42, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.278 Vali Acc: 0.856 Test Loss: 0.278 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.7495524883270264
Epoch: 43, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.263 Vali Acc: 0.872 Test Loss: 0.263 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.7809560298919678
Epoch: 44, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.6359481811523438
Epoch: 45, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.254 Vali Acc: 0.872 Test Loss: 0.254 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.6635735034942627
Epoch: 46, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.251 Vali Acc: 0.878 Test Loss: 0.251 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 47 cost time: 1.68473219871521
Epoch: 47, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.266 Vali Acc: 0.867 Test Loss: 0.266 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.8004412651062012
Epoch: 48, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.246 Vali Acc: 0.872 Test Loss: 0.246 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.8157575130462646
Epoch: 49, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.268 Vali Acc: 0.856 Test Loss: 0.268 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.8388288021087646
Epoch: 50, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 1.7768564224243164
Epoch: 51, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.275 Vali Acc: 0.856 Test Loss: 0.275 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.6974279880523682
Epoch: 52, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.251 Vali Acc: 0.878 Test Loss: 0.251 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.6894185543060303
Epoch: 53, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.5318033695220947
Epoch: 54, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.254 Vali Acc: 0.883 Test Loss: 0.254 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.7564759254455566
Epoch: 55, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.249 Vali Acc: 0.883 Test Loss: 0.249 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.5913732051849365
Epoch: 56, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 57 cost time: 1.6222712993621826
Epoch: 57, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.278 Vali Acc: 0.867 Test Loss: 0.278 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.6911735534667969
Epoch: 58, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.6801369190216064
Epoch: 59, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.258 Vali Acc: 0.878 Test Loss: 0.258 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.9308445453643799
Epoch: 60, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 61 cost time: 1.6766142845153809
Epoch: 61, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.257 Vali Acc: 0.872 Test Loss: 0.257 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.6083180904388428
Epoch: 62, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 63 cost time: 1.7207748889923096
Epoch: 63, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.650001049041748
Epoch: 64, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 65 cost time: 1.7300093173980713
Epoch: 65, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.230 Vali Acc: 0.883 Test Loss: 0.230 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.8820443153381348
Epoch: 66, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.7347428798675537
Epoch: 67, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 68 cost time: 1.5213744640350342
Epoch: 68, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.5464258193969727
Epoch: 69, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.7255356311798096
Epoch: 70, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.519063949584961
Epoch: 71, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.47804594039917
Epoch: 72, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.2622697353363037
Epoch: 73, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.2929646968841553
Epoch: 74, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.229 Vali Acc: 0.894 Test Loss: 0.229 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.4755465984344482
Epoch: 75, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 76 cost time: 1.861546516418457
Epoch: 76, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.227 Vali Acc: 0.889 Test Loss: 0.227 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.8006868362426758
Epoch: 77, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.226 Vali Acc: 0.889 Test Loss: 0.226 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.7120413780212402
Epoch: 78, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.224 Vali Acc: 0.894 Test Loss: 0.224 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.6504037380218506
Epoch: 79, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.224 Vali Acc: 0.889 Test Loss: 0.224 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.4899425506591797
Epoch: 80, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.223 Vali Acc: 0.900 Test Loss: 0.223 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 81 cost time: 1.5183799266815186
Epoch: 81, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.547067403793335
Epoch: 82, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.215 Vali Acc: 0.906 Test Loss: 0.215 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 83 cost time: 1.8239562511444092
Epoch: 83, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.290 Vali Acc: 0.878 Test Loss: 0.290 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.5363843441009521
Epoch: 84, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.5987777709960938
Epoch: 85, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.353 Vali Acc: 0.856 Test Loss: 0.353 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 1.7726004123687744
Epoch: 86, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 2.027357816696167
Epoch: 87, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 1.776587963104248
Epoch: 88, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 1.7932097911834717
Epoch: 89, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 1.8100125789642334
Epoch: 90, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 91 cost time: 1.7147929668426514
Epoch: 91, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.232 Vali Acc: 0.906 Test Loss: 0.232 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.7352032661437988
Epoch: 92, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.245 Vali Acc: 0.894 Test Loss: 0.245 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.7068264484405518
Epoch: 93, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 2.005906343460083
Epoch: 94, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.845799207687378
Epoch: 95, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 1.584693431854248
Epoch: 96, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 1.7968921661376953
Epoch: 97, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 1.9594776630401611
Epoch: 98, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 2.09352707862854
Epoch: 99, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 1.7442090511322021
Epoch: 100, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 36518
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1253886222839355
Epoch: 1, Steps: 12 | Train Loss: 1.782 Vali Loss: 1.715 Vali Acc: 0.167 Test Loss: 1.715 Test Acc: 0.167
Validation loss decreased (inf --> -0.166650).  Saving model ...
Epoch: 2 cost time: 1.4183993339538574
Epoch: 2, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.532 Vali Acc: 0.394 Test Loss: 1.532 Test Acc: 0.394
Validation loss decreased (-0.166650 --> -0.394429).  Saving model ...
Epoch: 3 cost time: 1.788550615310669
Epoch: 3, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.333 Vali Acc: 0.494 Test Loss: 1.333 Test Acc: 0.494
Validation loss decreased (-0.394429 --> -0.494431).  Saving model ...
Epoch: 4 cost time: 1.589205265045166
Epoch: 4, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.149 Vali Acc: 0.583 Test Loss: 1.149 Test Acc: 0.583
Validation loss decreased (-0.494431 --> -0.583322).  Saving model ...
Epoch: 5 cost time: 1.492246389389038
Epoch: 5, Steps: 12 | Train Loss: 1.083 Vali Loss: 0.995 Vali Acc: 0.611 Test Loss: 0.995 Test Acc: 0.611
Validation loss decreased (-0.583322 --> -0.611101).  Saving model ...
Epoch: 6 cost time: 1.6809680461883545
Epoch: 6, Steps: 12 | Train Loss: 0.927 Vali Loss: 0.876 Vali Acc: 0.661 Test Loss: 0.876 Test Acc: 0.661
Validation loss decreased (-0.611101 --> -0.661102).  Saving model ...
Epoch: 7 cost time: 1.6029753684997559
Epoch: 7, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.777 Vali Acc: 0.689 Test Loss: 0.777 Test Acc: 0.689
Validation loss decreased (-0.661102 --> -0.688881).  Saving model ...
Epoch: 8 cost time: 1.8411836624145508
Epoch: 8, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.700 Vali Acc: 0.706 Test Loss: 0.700 Test Acc: 0.706
Validation loss decreased (-0.688881 --> -0.705549).  Saving model ...
Epoch: 9 cost time: 1.6814775466918945
Epoch: 9, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.632 Vali Acc: 0.733 Test Loss: 0.632 Test Acc: 0.733
Validation loss decreased (-0.705549 --> -0.733327).  Saving model ...
Epoch: 10 cost time: 1.457481861114502
Epoch: 10, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.592 Vali Acc: 0.744 Test Loss: 0.592 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744439).  Saving model ...
Epoch: 11 cost time: 1.7710075378417969
Epoch: 11, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.560 Vali Acc: 0.728 Test Loss: 0.560 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6352927684783936
Epoch: 12, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.513 Vali Acc: 0.750 Test Loss: 0.513 Test Acc: 0.750
Validation loss decreased (-0.744439 --> -0.749995).  Saving model ...
Epoch: 13 cost time: 1.5822348594665527
Epoch: 13, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.481 Vali Acc: 0.767 Test Loss: 0.481 Test Acc: 0.767
Validation loss decreased (-0.749995 --> -0.766662).  Saving model ...
Epoch: 14 cost time: 1.5005052089691162
Epoch: 14, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.457 Vali Acc: 0.767 Test Loss: 0.457 Test Acc: 0.767
Validation loss decreased (-0.766662 --> -0.766662).  Saving model ...
Epoch: 15 cost time: 1.7228994369506836
Epoch: 15, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.442 Vali Acc: 0.761 Test Loss: 0.442 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6771361827850342
Epoch: 16, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.426 Vali Acc: 0.772 Test Loss: 0.426 Test Acc: 0.772
Validation loss decreased (-0.766662 --> -0.772218).  Saving model ...
Epoch: 17 cost time: 1.667870044708252
Epoch: 17, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.419 Vali Acc: 0.794 Test Loss: 0.419 Test Acc: 0.794
Validation loss decreased (-0.772218 --> -0.794440).  Saving model ...
Epoch: 18 cost time: 1.737255573272705
Epoch: 18, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.396 Vali Acc: 0.800 Test Loss: 0.396 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 1.7882108688354492
Epoch: 19, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.381 Vali Acc: 0.811 Test Loss: 0.381 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 20 cost time: 1.7797811031341553
Epoch: 20, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.370 Vali Acc: 0.789 Test Loss: 0.370 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7074143886566162
Epoch: 21, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.357 Vali Acc: 0.800 Test Loss: 0.357 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5574421882629395
Epoch: 22, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.352 Vali Acc: 0.822 Test Loss: 0.352 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 23 cost time: 1.6143362522125244
Epoch: 23, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.345 Vali Acc: 0.811 Test Loss: 0.345 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.697761058807373
Epoch: 24, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.335 Vali Acc: 0.833 Test Loss: 0.335 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 25 cost time: 1.734675645828247
Epoch: 25, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 26 cost time: 1.6090996265411377
Epoch: 26, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.331 Vali Acc: 0.822 Test Loss: 0.331 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5026459693908691
Epoch: 27, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 28 cost time: 1.8941593170166016
Epoch: 28, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 29 cost time: 1.7396736145019531
Epoch: 29, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 30 cost time: 1.7678396701812744
Epoch: 30, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 31 cost time: 1.3980162143707275
Epoch: 31, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.301 Vali Acc: 0.844 Test Loss: 0.301 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7732563018798828
Epoch: 32, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.295 Vali Acc: 0.850 Test Loss: 0.295 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 33 cost time: 1.7854945659637451
Epoch: 33, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 34 cost time: 1.2366909980773926
Epoch: 34, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
Validation loss decreased (-0.855553 --> -0.877775).  Saving model ...
Epoch: 35 cost time: 1.4923994541168213
Epoch: 35, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.602346420288086
Epoch: 36, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.291 Vali Acc: 0.850 Test Loss: 0.291 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.6503586769104004
Epoch: 37, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.265 Vali Acc: 0.872 Test Loss: 0.265 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.43682861328125
Epoch: 38, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.285 Vali Acc: 0.850 Test Loss: 0.285 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.657820701599121
Epoch: 39, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.258 Vali Acc: 0.878 Test Loss: 0.258 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 40 cost time: 1.946699619293213
Epoch: 40, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.8632218837738037
Epoch: 41, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.267 Vali Acc: 0.872 Test Loss: 0.267 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.9989614486694336
Epoch: 42, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.280 Vali Acc: 0.861 Test Loss: 0.280 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.1108405590057373
Epoch: 43, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.9823064804077148
Epoch: 44, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.270 Vali Acc: 0.867 Test Loss: 0.270 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.9837901592254639
Epoch: 45, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.257 Vali Acc: 0.867 Test Loss: 0.257 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.0134661197662354
Epoch: 46, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.251 Vali Acc: 0.878 Test Loss: 0.251 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 47 cost time: 2.0828466415405273
Epoch: 47, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.761023998260498
Epoch: 48, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 1.9643733501434326
Epoch: 49, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.267 Vali Acc: 0.867 Test Loss: 0.267 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.084671974182129
Epoch: 50, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.8563268184661865
Epoch: 51, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.279 Vali Acc: 0.867 Test Loss: 0.279 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.774848222732544
Epoch: 52, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.260 Vali Acc: 0.867 Test Loss: 0.260 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.5919523239135742
Epoch: 53, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.7859597206115723
Epoch: 54, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.262 Vali Acc: 0.872 Test Loss: 0.262 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.649956226348877
Epoch: 55, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.251 Vali Acc: 0.867 Test Loss: 0.251 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.8264150619506836
Epoch: 56, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.248 Vali Acc: 0.883 Test Loss: 0.248 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.7068533897399902
Epoch: 57, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.6753931045532227
Epoch: 58, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.257 Vali Acc: 0.878 Test Loss: 0.257 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 36518
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.131249904632568
Epoch: 1, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.730 Vali Acc: 0.183 Test Loss: 1.730 Test Acc: 0.183
Validation loss decreased (inf --> -0.183316).  Saving model ...
Epoch: 2 cost time: 1.9102869033813477
Epoch: 2, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.546 Vali Acc: 0.389 Test Loss: 1.546 Test Acc: 0.389
Validation loss decreased (-0.183316 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 1.5458695888519287
Epoch: 3, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.345 Vali Acc: 0.506 Test Loss: 1.345 Test Acc: 0.506
Validation loss decreased (-0.388873 --> -0.505542).  Saving model ...
Epoch: 4 cost time: 1.7405190467834473
Epoch: 4, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.158 Vali Acc: 0.578 Test Loss: 1.158 Test Acc: 0.578
Validation loss decreased (-0.505542 --> -0.577766).  Saving model ...
Epoch: 5 cost time: 1.8288917541503906
Epoch: 5, Steps: 12 | Train Loss: 1.063 Vali Loss: 0.999 Vali Acc: 0.611 Test Loss: 0.999 Test Acc: 0.611
Validation loss decreased (-0.577766 --> -0.611101).  Saving model ...
Epoch: 6 cost time: 1.684891939163208
Epoch: 6, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.878 Vali Acc: 0.644 Test Loss: 0.878 Test Acc: 0.644
Validation loss decreased (-0.611101 --> -0.644436).  Saving model ...
Epoch: 7 cost time: 1.6050159931182861
Epoch: 7, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.781 Vali Acc: 0.678 Test Loss: 0.781 Test Acc: 0.678
Validation loss decreased (-0.644436 --> -0.677770).  Saving model ...
Epoch: 8 cost time: 1.4513084888458252
Epoch: 8, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.703 Vali Acc: 0.683 Test Loss: 0.703 Test Acc: 0.683
Validation loss decreased (-0.677770 --> -0.683326).  Saving model ...
Epoch: 9 cost time: 1.7420752048492432
Epoch: 9, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.633 Vali Acc: 0.739 Test Loss: 0.633 Test Acc: 0.739
Validation loss decreased (-0.683326 --> -0.738883).  Saving model ...
Epoch: 10 cost time: 1.8404765129089355
Epoch: 10, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.593 Vali Acc: 0.750 Test Loss: 0.593 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 1.5259265899658203
Epoch: 11, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4977118968963623
Epoch: 12, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.514 Vali Acc: 0.733 Test Loss: 0.514 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7867047786712646
Epoch: 13, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.483 Vali Acc: 0.772 Test Loss: 0.483 Test Acc: 0.772
Validation loss decreased (-0.749994 --> -0.772217).  Saving model ...
Epoch: 14 cost time: 1.8266587257385254
Epoch: 14, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.455 Vali Acc: 0.772 Test Loss: 0.455 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772218).  Saving model ...
Epoch: 15 cost time: 2.1612963676452637
Epoch: 15, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.440 Vali Acc: 0.783 Test Loss: 0.440 Test Acc: 0.783
Validation loss decreased (-0.772218 --> -0.783329).  Saving model ...
Epoch: 16 cost time: 1.7945470809936523
Epoch: 16, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.423 Vali Acc: 0.761 Test Loss: 0.423 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8463752269744873
Epoch: 17, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.418 Vali Acc: 0.789 Test Loss: 0.418 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 18 cost time: 1.6961095333099365
Epoch: 18, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.394 Vali Acc: 0.806 Test Loss: 0.394 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805552).  Saving model ...
Epoch: 19 cost time: 1.6042215824127197
Epoch: 19, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.377 Vali Acc: 0.811 Test Loss: 0.377 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 20 cost time: 1.7828993797302246
Epoch: 20, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.366 Vali Acc: 0.811 Test Loss: 0.366 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 21 cost time: 1.6976580619812012
Epoch: 21, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.354 Vali Acc: 0.839 Test Loss: 0.354 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 22 cost time: 1.5227117538452148
Epoch: 22, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6794826984405518
Epoch: 23, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.347 Vali Acc: 0.828 Test Loss: 0.347 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7394297122955322
Epoch: 24, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.341 Vali Acc: 0.828 Test Loss: 0.341 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.789431095123291
Epoch: 25, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.333 Vali Acc: 0.844 Test Loss: 0.333 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 26 cost time: 1.4455406665802002
Epoch: 26, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.332 Vali Acc: 0.817 Test Loss: 0.332 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6426210403442383
Epoch: 27, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8326895236968994
Epoch: 28, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.319 Vali Acc: 0.844 Test Loss: 0.319 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 29 cost time: 1.8881864547729492
Epoch: 29, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 30 cost time: 1.6525909900665283
Epoch: 30, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 31 cost time: 1.614799976348877
Epoch: 31, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.308 Vali Acc: 0.839 Test Loss: 0.308 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9314732551574707
Epoch: 32, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 33 cost time: 1.3542747497558594
Epoch: 33, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 34 cost time: 1.4827818870544434
Epoch: 34, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 35 cost time: 1.6628592014312744
Epoch: 35, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.294 Vali Acc: 0.850 Test Loss: 0.294 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7399208545684814
Epoch: 36, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.295 Vali Acc: 0.850 Test Loss: 0.295 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7613799571990967
Epoch: 37, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 38 cost time: 1.630772590637207
Epoch: 38, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.649052619934082
Epoch: 39, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.268 Vali Acc: 0.872 Test Loss: 0.268 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7773678302764893
Epoch: 40, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.7709667682647705
Epoch: 41, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.276 Vali Acc: 0.861 Test Loss: 0.276 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.537001609802246
Epoch: 42, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.276 Vali Acc: 0.861 Test Loss: 0.276 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.56144118309021
Epoch: 43, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 44 cost time: 1.828279972076416
Epoch: 44, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.271 Vali Acc: 0.867 Test Loss: 0.271 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5450897216796875
Epoch: 45, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4682040214538574
Epoch: 46, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 47 cost time: 1.6079232692718506
Epoch: 47, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.7423243522644043
Epoch: 48, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.7628417015075684
Epoch: 49, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.8268718719482422
Epoch: 50, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.273 Vali Acc: 0.867 Test Loss: 0.273 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.741826057434082
Epoch: 51, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.8216311931610107
Epoch: 52, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.272 Vali Acc: 0.867 Test Loss: 0.272 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.794259786605835
Epoch: 53, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.7741141319274902
Epoch: 54, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.7876152992248535
Epoch: 55, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.256 Vali Acc: 0.861 Test Loss: 0.256 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.7074651718139648
Epoch: 56, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 57 cost time: 1.7208311557769775
Epoch: 57, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.689992904663086
Epoch: 58, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.255 Vali Acc: 0.883 Test Loss: 0.255 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.5572381019592285
Epoch: 59, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.5371160507202148
Epoch: 60, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899998).  Saving model ...
Epoch: 61 cost time: 1.6882781982421875
Epoch: 61, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.257 Vali Acc: 0.872 Test Loss: 0.257 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.4227590560913086
Epoch: 62, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.237 Vali Acc: 0.883 Test Loss: 0.237 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.4674038887023926
Epoch: 63, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.4433443546295166
Epoch: 64, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 65 cost time: 1.3858120441436768
Epoch: 65, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.5847892761230469
Epoch: 66, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.5855669975280762
Epoch: 67, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.638188362121582
Epoch: 68, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 69 cost time: 1.803619623184204
Epoch: 69, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.8830678462982178
Epoch: 70, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.251 Vali Acc: 0.883 Test Loss: 0.251 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.664205551147461
Epoch: 71, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.5962066650390625
Epoch: 72, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.244 Vali Acc: 0.894 Test Loss: 0.244 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.8305883407592773
Epoch: 73, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.9650192260742188
Epoch: 74, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 75 cost time: 1.728137493133545
Epoch: 75, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.735069990158081
Epoch: 76, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.8320367336273193
Epoch: 77, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.4365487098693848
Epoch: 78, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.46244215965271
Epoch: 79, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.240 Vali Acc: 0.894 Test Loss: 0.240 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.8683958053588867
Epoch: 80, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 2.0736658573150635
Epoch: 81, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.247 Vali Acc: 0.906 Test Loss: 0.247 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 1.8334085941314697
Epoch: 82, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 1.7378454208374023
Epoch: 83, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.290 Vali Acc: 0.878 Test Loss: 0.290 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 1.8294224739074707
Epoch: 84, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 36518
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1448609828948975
Epoch: 1, Steps: 12 | Train Loss: 1.772 Vali Loss: 1.732 Vali Acc: 0.206 Test Loss: 1.732 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 1.818086862564087
Epoch: 2, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.554 Vali Acc: 0.394 Test Loss: 1.554 Test Acc: 0.394
Validation loss decreased (-0.205538 --> -0.394429).  Saving model ...
Epoch: 3 cost time: 1.8319876194000244
Epoch: 3, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.352 Vali Acc: 0.528 Test Loss: 1.352 Test Acc: 0.528
Validation loss decreased (-0.394429 --> -0.527764).  Saving model ...
Epoch: 4 cost time: 1.6518025398254395
Epoch: 4, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.162 Vali Acc: 0.589 Test Loss: 1.162 Test Acc: 0.589
Validation loss decreased (-0.527764 --> -0.588877).  Saving model ...
Epoch: 5 cost time: 1.7066338062286377
Epoch: 5, Steps: 12 | Train Loss: 1.054 Vali Loss: 0.990 Vali Acc: 0.633 Test Loss: 0.990 Test Acc: 0.633
Validation loss decreased (-0.588877 --> -0.633323).  Saving model ...
Epoch: 6 cost time: 1.5238869190216064
Epoch: 6, Steps: 12 | Train Loss: 0.924 Vali Loss: 0.863 Vali Acc: 0.650 Test Loss: 0.863 Test Acc: 0.650
Validation loss decreased (-0.633323 --> -0.649991).  Saving model ...
Epoch: 7 cost time: 1.627962589263916
Epoch: 7, Steps: 12 | Train Loss: 0.784 Vali Loss: 0.764 Vali Acc: 0.683 Test Loss: 0.764 Test Acc: 0.683
Validation loss decreased (-0.649991 --> -0.683326).  Saving model ...
Epoch: 8 cost time: 1.6315412521362305
Epoch: 8, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.685 Vali Acc: 0.689 Test Loss: 0.685 Test Acc: 0.689
Validation loss decreased (-0.683326 --> -0.688882).  Saving model ...
Epoch: 9 cost time: 1.8166999816894531
Epoch: 9, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.621 Vali Acc: 0.722 Test Loss: 0.621 Test Acc: 0.722
Validation loss decreased (-0.688882 --> -0.722216).  Saving model ...
Epoch: 10 cost time: 1.7210936546325684
Epoch: 10, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.581 Vali Acc: 0.728 Test Loss: 0.581 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727772).  Saving model ...
Epoch: 11 cost time: 1.781156063079834
Epoch: 11, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.547 Vali Acc: 0.722 Test Loss: 0.547 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7508504390716553
Epoch: 12, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.510 Vali Acc: 0.733 Test Loss: 0.510 Test Acc: 0.733
Validation loss decreased (-0.727772 --> -0.733328).  Saving model ...
Epoch: 13 cost time: 1.8845853805541992
Epoch: 13, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.480 Vali Acc: 0.756 Test Loss: 0.480 Test Acc: 0.756
Validation loss decreased (-0.733328 --> -0.755551).  Saving model ...
Epoch: 14 cost time: 1.7753400802612305
Epoch: 14, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.456 Vali Acc: 0.767 Test Loss: 0.456 Test Acc: 0.767
Validation loss decreased (-0.755551 --> -0.766662).  Saving model ...
Epoch: 15 cost time: 1.862419843673706
Epoch: 15, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.439 Vali Acc: 0.772 Test Loss: 0.439 Test Acc: 0.772
Validation loss decreased (-0.766662 --> -0.772218).  Saving model ...
Epoch: 16 cost time: 1.6511011123657227
Epoch: 16, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.424 Vali Acc: 0.767 Test Loss: 0.424 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7948086261749268
Epoch: 17, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.413 Vali Acc: 0.800 Test Loss: 0.413 Test Acc: 0.800
Validation loss decreased (-0.772218 --> -0.799996).  Saving model ...
Epoch: 18 cost time: 2.033504009246826
Epoch: 18, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.393 Vali Acc: 0.811 Test Loss: 0.393 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 19 cost time: 1.7984919548034668
Epoch: 19, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.372 Vali Acc: 0.800 Test Loss: 0.372 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.659186840057373
Epoch: 20, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.363 Vali Acc: 0.811 Test Loss: 0.363 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 21 cost time: 1.791724681854248
Epoch: 21, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.348 Vali Acc: 0.806 Test Loss: 0.348 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5357844829559326
Epoch: 22, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.345 Vali Acc: 0.811 Test Loss: 0.345 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811108).  Saving model ...
Epoch: 23 cost time: 1.5204355716705322
Epoch: 23, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.345 Vali Acc: 0.811 Test Loss: 0.345 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7371435165405273
Epoch: 24, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
Validation loss decreased (-0.811108 --> -0.827774).  Saving model ...
Epoch: 25 cost time: 1.7597801685333252
Epoch: 25, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 26 cost time: 1.647157907485962
Epoch: 26, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.325 Vali Acc: 0.822 Test Loss: 0.325 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7545630931854248
Epoch: 27, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.312 Vali Acc: 0.822 Test Loss: 0.312 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9198648929595947
Epoch: 28, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.309 Vali Acc: 0.839 Test Loss: 0.309 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 29 cost time: 1.5852134227752686
Epoch: 29, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.300 Vali Acc: 0.844 Test Loss: 0.300 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 30 cost time: 1.7735552787780762
Epoch: 30, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.299 Vali Acc: 0.844 Test Loss: 0.299 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 31 cost time: 1.6665596961975098
Epoch: 31, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.309 Vali Acc: 0.844 Test Loss: 0.309 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7504305839538574
Epoch: 32, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 33 cost time: 1.68458890914917
Epoch: 33, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.311 Vali Acc: 0.833 Test Loss: 0.311 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.7573256492614746
Epoch: 34, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.284 Vali Acc: 0.850 Test Loss: 0.284 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8235869407653809
Epoch: 35, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.287 Vali Acc: 0.856 Test Loss: 0.287 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6949841976165771
Epoch: 36, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.288 Vali Acc: 0.833 Test Loss: 0.288 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.882246971130371
Epoch: 37, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 1.7800018787384033
Epoch: 38, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.292 Vali Acc: 0.833 Test Loss: 0.292 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5726397037506104
Epoch: 39, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 40 cost time: 1.426274061203003
Epoch: 40, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.275 Vali Acc: 0.867 Test Loss: 0.275 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.8801932334899902
Epoch: 41, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.261 Vali Acc: 0.856 Test Loss: 0.261 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7622735500335693
Epoch: 42, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.281 Vali Acc: 0.850 Test Loss: 0.281 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.811840534210205
Epoch: 43, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 44 cost time: 1.8576438426971436
Epoch: 44, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.266 Vali Acc: 0.867 Test Loss: 0.266 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.4721450805664062
Epoch: 45, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6457836627960205
Epoch: 46, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.6693272590637207
Epoch: 47, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.9880969524383545
Epoch: 48, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.252 Vali Acc: 0.861 Test Loss: 0.252 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.7857401371002197
Epoch: 49, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.5842204093933105
Epoch: 50, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.247 Vali Acc: 0.861 Test Loss: 0.247 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.8217625617980957
Epoch: 51, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.749657154083252
Epoch: 52, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.236 Vali Acc: 0.861 Test Loss: 0.236 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.7274272441864014
Epoch: 53, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.272 Vali Acc: 0.856 Test Loss: 0.272 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 36518
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8996362686157227
Epoch: 1, Steps: 12 | Train Loss: 2.034 Vali Loss: 1.878 Vali Acc: 0.100 Test Loss: 1.878 Test Acc: 0.100
Validation loss decreased (inf --> -0.099981).  Saving model ...
Epoch: 2 cost time: 1.5461561679840088
Epoch: 2, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.667 Vali Acc: 0.278 Test Loss: 1.667 Test Acc: 0.278
Validation loss decreased (-0.099981 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 1.8634543418884277
Epoch: 3, Steps: 12 | Train Loss: 1.599 Vali Loss: 1.437 Vali Acc: 0.511 Test Loss: 1.437 Test Acc: 0.511
Validation loss decreased (-0.277761 --> -0.511097).  Saving model ...
Epoch: 4 cost time: 1.6247634887695312
Epoch: 4, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.227 Vali Acc: 0.600 Test Loss: 1.227 Test Acc: 0.600
Validation loss decreased (-0.511097 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 1.3857097625732422
Epoch: 5, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.053 Vali Acc: 0.633 Test Loss: 1.053 Test Acc: 0.633
Validation loss decreased (-0.599988 --> -0.633323).  Saving model ...
Epoch: 6 cost time: 1.325610637664795
Epoch: 6, Steps: 12 | Train Loss: 0.957 Vali Loss: 0.918 Vali Acc: 0.617 Test Loss: 0.918 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3972713947296143
Epoch: 7, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.807 Vali Acc: 0.656 Test Loss: 0.807 Test Acc: 0.656
Validation loss decreased (-0.633323 --> -0.655547).  Saving model ...
Epoch: 8 cost time: 1.4895398616790771
Epoch: 8, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.728 Vali Acc: 0.678 Test Loss: 0.728 Test Acc: 0.678
Validation loss decreased (-0.655547 --> -0.677770).  Saving model ...
Epoch: 9 cost time: 1.4110000133514404
Epoch: 9, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.671 Vali Acc: 0.689 Test Loss: 0.671 Test Acc: 0.689
Validation loss decreased (-0.677770 --> -0.688882).  Saving model ...
Epoch: 10 cost time: 1.9696784019470215
Epoch: 10, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.631 Vali Acc: 0.706 Test Loss: 0.631 Test Acc: 0.706
Validation loss decreased (-0.688882 --> -0.705549).  Saving model ...
Epoch: 11 cost time: 1.5167393684387207
Epoch: 11, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.581 Vali Acc: 0.733 Test Loss: 0.581 Test Acc: 0.733
Validation loss decreased (-0.705549 --> -0.733328).  Saving model ...
Epoch: 12 cost time: 1.867762804031372
Epoch: 12, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.558 Vali Acc: 0.717 Test Loss: 0.558 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7820544242858887
Epoch: 13, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.520 Vali Acc: 0.767 Test Loss: 0.520 Test Acc: 0.767
Validation loss decreased (-0.733328 --> -0.766661).  Saving model ...
Epoch: 14 cost time: 1.7573034763336182
Epoch: 14, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.497 Vali Acc: 0.739 Test Loss: 0.497 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6028566360473633
Epoch: 15, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.467 Vali Acc: 0.761 Test Loss: 0.467 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.882753610610962
Epoch: 16, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.453 Vali Acc: 0.767 Test Loss: 0.453 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766662).  Saving model ...
Epoch: 17 cost time: 1.8054440021514893
Epoch: 17, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.442 Vali Acc: 0.772 Test Loss: 0.442 Test Acc: 0.772
Validation loss decreased (-0.766662 --> -0.772218).  Saving model ...
Epoch: 18 cost time: 1.5992436408996582
Epoch: 18, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.436 Vali Acc: 0.783 Test Loss: 0.436 Test Acc: 0.783
Validation loss decreased (-0.772218 --> -0.783329).  Saving model ...
Epoch: 19 cost time: 1.6300709247589111
Epoch: 19, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.418 Vali Acc: 0.778 Test Loss: 0.418 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.898022174835205
Epoch: 20, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.407 Vali Acc: 0.800 Test Loss: 0.407 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 21 cost time: 1.8336782455444336
Epoch: 21, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.396 Vali Acc: 0.822 Test Loss: 0.396 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 22 cost time: 1.6294887065887451
Epoch: 22, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.394 Vali Acc: 0.794 Test Loss: 0.394 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.678720235824585
Epoch: 23, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9968922138214111
Epoch: 24, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.365 Vali Acc: 0.822 Test Loss: 0.365 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 25 cost time: 1.6967353820800781
Epoch: 25, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.360 Vali Acc: 0.822 Test Loss: 0.360 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 26 cost time: 1.7878682613372803
Epoch: 26, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.349 Vali Acc: 0.811 Test Loss: 0.349 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.627706527709961
Epoch: 27, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.353 Vali Acc: 0.811 Test Loss: 0.353 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6767981052398682
Epoch: 28, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838886).  Saving model ...
Epoch: 29 cost time: 1.605997085571289
Epoch: 29, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.337 Vali Acc: 0.839 Test Loss: 0.337 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5940260887145996
Epoch: 30, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 31 cost time: 1.5959010124206543
Epoch: 31, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 32 cost time: 1.480234146118164
Epoch: 32, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5389091968536377
Epoch: 33, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 34 cost time: 1.7620179653167725
Epoch: 34, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5881552696228027
Epoch: 35, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.5632481575012207
Epoch: 36, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.706409215927124
Epoch: 37, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.296 Vali Acc: 0.856 Test Loss: 0.296 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.7135365009307861
Epoch: 38, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.7503418922424316
Epoch: 39, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.816910743713379
Epoch: 40, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.290 Vali Acc: 0.844 Test Loss: 0.290 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.5234742164611816
Epoch: 41, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 42 cost time: 1.364070177078247
Epoch: 42, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.291 Vali Acc: 0.844 Test Loss: 0.291 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.412726640701294
Epoch: 43, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.282 Vali Acc: 0.844 Test Loss: 0.282 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.609712839126587
Epoch: 44, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 45 cost time: 1.8585667610168457
Epoch: 45, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.292 Vali Acc: 0.844 Test Loss: 0.292 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.6293504238128662
Epoch: 46, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.267 Vali Acc: 0.872 Test Loss: 0.267 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872220).  Saving model ...
Epoch: 47 cost time: 1.8045916557312012
Epoch: 47, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.318 Vali Acc: 0.833 Test Loss: 0.318 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.5575649738311768
Epoch: 48, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.268 Vali Acc: 0.867 Test Loss: 0.268 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.6924519538879395
Epoch: 49, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.282 Vali Acc: 0.844 Test Loss: 0.282 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.8958606719970703
Epoch: 50, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.277 Vali Acc: 0.850 Test Loss: 0.277 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.670175552368164
Epoch: 51, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.265 Vali Acc: 0.872 Test Loss: 0.265 Test Acc: 0.872
Validation loss decreased (-0.872220 --> -0.872220).  Saving model ...
Epoch: 52 cost time: 1.4365711212158203
Epoch: 52, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.261 Vali Acc: 0.861 Test Loss: 0.261 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.5972208976745605
Epoch: 53, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.256 Vali Acc: 0.856 Test Loss: 0.256 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.701967716217041
Epoch: 54, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883331).  Saving model ...
Epoch: 55 cost time: 1.803255558013916
Epoch: 55, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.267 Vali Acc: 0.856 Test Loss: 0.267 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.6036221981048584
Epoch: 56, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.264 Vali Acc: 0.856 Test Loss: 0.264 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.7108187675476074
Epoch: 57, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.267 Vali Acc: 0.867 Test Loss: 0.267 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.651474952697754
Epoch: 58, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.8559281826019287
Epoch: 59, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.279 Vali Acc: 0.856 Test Loss: 0.279 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.5688467025756836
Epoch: 60, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.259 Vali Acc: 0.883 Test Loss: 0.259 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 61 cost time: 1.4990265369415283
Epoch: 61, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.279 Vali Acc: 0.856 Test Loss: 0.279 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.8275225162506104
Epoch: 62, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.261 Vali Acc: 0.878 Test Loss: 0.261 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.9893298149108887
Epoch: 63, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.251 Vali Acc: 0.878 Test Loss: 0.251 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.8695919513702393
Epoch: 64, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 65 cost time: 2.0542898178100586
Epoch: 65, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.272 Vali Acc: 0.861 Test Loss: 0.272 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.968585729598999
Epoch: 66, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.250 Vali Acc: 0.872 Test Loss: 0.250 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.9649789333343506
Epoch: 67, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.249 Vali Acc: 0.878 Test Loss: 0.249 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.9350364208221436
Epoch: 68, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.253 Vali Acc: 0.878 Test Loss: 0.253 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.7215893268585205
Epoch: 69, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.254 Vali Acc: 0.878 Test Loss: 0.254 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 2.0310118198394775
Epoch: 70, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.250 Vali Acc: 0.872 Test Loss: 0.250 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.9089183807373047
Epoch: 71, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.250 Vali Acc: 0.872 Test Loss: 0.250 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.8806993961334229
Epoch: 72, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.246 Vali Acc: 0.883 Test Loss: 0.246 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 73 cost time: 2.2256200313568115
Epoch: 73, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.247 Vali Acc: 0.883 Test Loss: 0.247 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.472562313079834
Epoch: 74, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.251 Vali Acc: 0.883 Test Loss: 0.251 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 2.0312459468841553
Epoch: 75, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 76 cost time: 1.8362298011779785
Epoch: 76, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 77 cost time: 2.032721757888794
Epoch: 77, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 2.057196855545044
Epoch: 78, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.9329659938812256
Epoch: 79, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.691190481185913
Epoch: 80, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.4948005676269531
Epoch: 81, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.9545581340789795
Epoch: 82, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.275 Vali Acc: 0.867 Test Loss: 0.275 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.7123112678527832
Epoch: 83, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 2.0617902278900146
Epoch: 84, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 1.7355923652648926
Epoch: 85, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 86 cost time: 1.942000150680542
Epoch: 86, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.9538462162017822
Epoch: 87, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 2.17085599899292
Epoch: 88, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.7704174518585205
Epoch: 89, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.899789810180664
Epoch: 90, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 1.8636713027954102
Epoch: 91, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 1.9163923263549805
Epoch: 92, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 2.0533828735351562
Epoch: 93, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 1.7616417407989502
Epoch: 94, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.264 Vali Acc: 0.883 Test Loss: 0.264 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 1.9052462577819824
Epoch: 95, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 28326
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.288345575332642
Epoch: 1, Steps: 12 | Train Loss: 2.044 Vali Loss: 1.878 Vali Acc: 0.094 Test Loss: 1.878 Test Acc: 0.094
Validation loss decreased (inf --> -0.094426).  Saving model ...
Epoch: 2 cost time: 1.5017776489257812
Epoch: 2, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.667 Vali Acc: 0.267 Test Loss: 1.667 Test Acc: 0.267
Validation loss decreased (-0.094426 --> -0.266650).  Saving model ...
Epoch: 3 cost time: 1.7223527431488037
Epoch: 3, Steps: 12 | Train Loss: 1.588 Vali Loss: 1.435 Vali Acc: 0.533 Test Loss: 1.435 Test Acc: 0.533
Validation loss decreased (-0.266650 --> -0.533319).  Saving model ...
Epoch: 4 cost time: 1.139817237854004
Epoch: 4, Steps: 12 | Train Loss: 1.362 Vali Loss: 1.223 Vali Acc: 0.600 Test Loss: 1.223 Test Acc: 0.600
Validation loss decreased (-0.533319 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 1.7298121452331543
Epoch: 5, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.046 Vali Acc: 0.667 Test Loss: 1.046 Test Acc: 0.667
Validation loss decreased (-0.599988 --> -0.666656).  Saving model ...
Epoch: 6 cost time: 1.7559938430786133
Epoch: 6, Steps: 12 | Train Loss: 0.960 Vali Loss: 0.913 Vali Acc: 0.639 Test Loss: 0.913 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5761361122131348
Epoch: 7, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.806 Vali Acc: 0.644 Test Loss: 0.806 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7548186779022217
Epoch: 8, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.726 Vali Acc: 0.672 Test Loss: 0.726 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672215).  Saving model ...
Epoch: 9 cost time: 1.600637674331665
Epoch: 9, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.669 Vali Acc: 0.700 Test Loss: 0.669 Test Acc: 0.700
Validation loss decreased (-0.672215 --> -0.699993).  Saving model ...
Epoch: 10 cost time: 1.7231521606445312
Epoch: 10, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.629 Vali Acc: 0.689 Test Loss: 0.629 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7097833156585693
Epoch: 11, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.580 Vali Acc: 0.733 Test Loss: 0.580 Test Acc: 0.733
Validation loss decreased (-0.699993 --> -0.733328).  Saving model ...
Epoch: 12 cost time: 1.778576374053955
Epoch: 12, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.556 Vali Acc: 0.722 Test Loss: 0.556 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5301780700683594
Epoch: 13, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.520 Vali Acc: 0.761 Test Loss: 0.520 Test Acc: 0.761
Validation loss decreased (-0.733328 --> -0.761106).  Saving model ...
Epoch: 14 cost time: 1.6757512092590332
Epoch: 14, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.495 Vali Acc: 0.739 Test Loss: 0.495 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6758899688720703
Epoch: 15, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.464 Vali Acc: 0.761 Test Loss: 0.464 Test Acc: 0.761
Validation loss decreased (-0.761106 --> -0.761106).  Saving model ...
Epoch: 16 cost time: 1.7023570537567139
Epoch: 16, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.454 Vali Acc: 0.772 Test Loss: 0.454 Test Acc: 0.772
Validation loss decreased (-0.761106 --> -0.772218).  Saving model ...
Epoch: 17 cost time: 1.7216875553131104
Epoch: 17, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.444 Vali Acc: 0.778 Test Loss: 0.444 Test Acc: 0.778
Validation loss decreased (-0.772218 --> -0.777773).  Saving model ...
Epoch: 18 cost time: 1.6897761821746826
Epoch: 18, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.438 Vali Acc: 0.778 Test Loss: 0.438 Test Acc: 0.778
Validation loss decreased (-0.777773 --> -0.777773).  Saving model ...
Epoch: 19 cost time: 1.7715160846710205
Epoch: 19, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.420 Vali Acc: 0.783 Test Loss: 0.420 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 20 cost time: 1.542738914489746
Epoch: 20, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.406 Vali Acc: 0.794 Test Loss: 0.406 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794440).  Saving model ...
Epoch: 21 cost time: 1.8898844718933105
Epoch: 21, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822218).  Saving model ...
Epoch: 22 cost time: 1.4778380393981934
Epoch: 22, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.395 Vali Acc: 0.794 Test Loss: 0.395 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6009552478790283
Epoch: 23, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.374 Vali Acc: 0.811 Test Loss: 0.374 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6746065616607666
Epoch: 24, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.370 Vali Acc: 0.817 Test Loss: 0.370 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5223181247711182
Epoch: 25, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.365 Vali Acc: 0.828 Test Loss: 0.365 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 26 cost time: 1.5654218196868896
Epoch: 26, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.353 Vali Acc: 0.817 Test Loss: 0.353 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6001145839691162
Epoch: 27, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.356 Vali Acc: 0.817 Test Loss: 0.356 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8019402027130127
Epoch: 28, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.338 Vali Acc: 0.822 Test Loss: 0.338 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6680004596710205
Epoch: 29, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.343 Vali Acc: 0.828 Test Loss: 0.343 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 30 cost time: 1.6924912929534912
Epoch: 30, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.335 Vali Acc: 0.822 Test Loss: 0.335 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6128768920898438
Epoch: 31, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.319 Vali Acc: 0.844 Test Loss: 0.319 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 32 cost time: 1.7088062763214111
Epoch: 32, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 33 cost time: 1.891017198562622
Epoch: 33, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 34 cost time: 1.7405714988708496
Epoch: 34, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.314 Vali Acc: 0.867 Test Loss: 0.314 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8890140056610107
Epoch: 35, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.740502119064331
Epoch: 36, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.310 Vali Acc: 0.839 Test Loss: 0.310 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6734449863433838
Epoch: 37, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.9022815227508545
Epoch: 38, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 39 cost time: 1.711763620376587
Epoch: 39, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.305 Vali Acc: 0.839 Test Loss: 0.305 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.7612922191619873
Epoch: 40, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.701678991317749
Epoch: 41, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.6262950897216797
Epoch: 42, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.296 Vali Acc: 0.839 Test Loss: 0.296 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.6196842193603516
Epoch: 43, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.286 Vali Acc: 0.850 Test Loss: 0.286 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5136146545410156
Epoch: 44, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 45 cost time: 1.3940446376800537
Epoch: 45, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.296 Vali Acc: 0.850 Test Loss: 0.296 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.4213039875030518
Epoch: 46, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 47 cost time: 1.7585110664367676
Epoch: 47, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.316 Vali Acc: 0.828 Test Loss: 0.316 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.8152222633361816
Epoch: 48, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.279 Vali Acc: 0.867 Test Loss: 0.279 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.6283936500549316
Epoch: 49, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.734708309173584
Epoch: 50, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.8103508949279785
Epoch: 51, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 52 cost time: 1.7324447631835938
Epoch: 52, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.272 Vali Acc: 0.856 Test Loss: 0.272 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.8230674266815186
Epoch: 53, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.261 Vali Acc: 0.878 Test Loss: 0.261 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 54 cost time: 1.8443107604980469
Epoch: 54, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 55 cost time: 1.745558261871338
Epoch: 55, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.272 Vali Acc: 0.861 Test Loss: 0.272 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.759450912475586
Epoch: 56, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.6721577644348145
Epoch: 57, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.8244671821594238
Epoch: 58, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.281 Vali Acc: 0.861 Test Loss: 0.281 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.2758166790008545
Epoch: 59, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.278 Vali Acc: 0.856 Test Loss: 0.278 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.7678627967834473
Epoch: 60, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.490434169769287
Epoch: 61, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.273 Vali Acc: 0.867 Test Loss: 0.273 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.8442659378051758
Epoch: 62, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.545795202255249
Epoch: 63, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.770226001739502
Epoch: 64, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 28326
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.092191219329834
Epoch: 1, Steps: 12 | Train Loss: 2.035 Vali Loss: 1.879 Vali Acc: 0.094 Test Loss: 1.879 Test Acc: 0.094
Validation loss decreased (inf --> -0.094426).  Saving model ...
Epoch: 2 cost time: 1.7310371398925781
Epoch: 2, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.670 Vali Acc: 0.294 Test Loss: 1.670 Test Acc: 0.294
Validation loss decreased (-0.094426 --> -0.294428).  Saving model ...
Epoch: 3 cost time: 1.5746433734893799
Epoch: 3, Steps: 12 | Train Loss: 1.591 Vali Loss: 1.436 Vali Acc: 0.544 Test Loss: 1.436 Test Acc: 0.544
Validation loss decreased (-0.294428 --> -0.544430).  Saving model ...
Epoch: 4 cost time: 1.46380615234375
Epoch: 4, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.223 Vali Acc: 0.628 Test Loss: 1.223 Test Acc: 0.628
Validation loss decreased (-0.544430 --> -0.627766).  Saving model ...
Epoch: 5 cost time: 1.348888635635376
Epoch: 5, Steps: 12 | Train Loss: 1.091 Vali Loss: 1.042 Vali Acc: 0.678 Test Loss: 1.042 Test Acc: 0.678
Validation loss decreased (-0.627766 --> -0.677767).  Saving model ...
Epoch: 6 cost time: 1.870652198791504
Epoch: 6, Steps: 12 | Train Loss: 0.943 Vali Loss: 0.911 Vali Acc: 0.633 Test Loss: 0.911 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.627976894378662
Epoch: 7, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.801 Vali Acc: 0.656 Test Loss: 0.801 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.478389024734497
Epoch: 8, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.721 Vali Acc: 0.667 Test Loss: 0.721 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6681256294250488
Epoch: 9, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.664 Vali Acc: 0.694 Test Loss: 0.664 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694438).  Saving model ...
Epoch: 10 cost time: 1.562377691268921
Epoch: 10, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.626 Vali Acc: 0.706 Test Loss: 0.626 Test Acc: 0.706
Validation loss decreased (-0.694438 --> -0.705549).  Saving model ...
Epoch: 11 cost time: 1.508246898651123
Epoch: 11, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.576 Vali Acc: 0.728 Test Loss: 0.576 Test Acc: 0.728
Validation loss decreased (-0.705549 --> -0.727772).  Saving model ...
Epoch: 12 cost time: 1.3292453289031982
Epoch: 12, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.549 Vali Acc: 0.728 Test Loss: 0.549 Test Acc: 0.728
Validation loss decreased (-0.727772 --> -0.727772).  Saving model ...
Epoch: 13 cost time: 1.3694264888763428
Epoch: 13, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.513 Vali Acc: 0.767 Test Loss: 0.513 Test Acc: 0.767
Validation loss decreased (-0.727772 --> -0.766662).  Saving model ...
Epoch: 14 cost time: 1.5415778160095215
Epoch: 14, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.489 Vali Acc: 0.744 Test Loss: 0.489 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.502204179763794
Epoch: 15, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.456 Vali Acc: 0.778 Test Loss: 0.456 Test Acc: 0.778
Validation loss decreased (-0.766662 --> -0.777773).  Saving model ...
Epoch: 16 cost time: 1.5988140106201172
Epoch: 16, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.443 Vali Acc: 0.783 Test Loss: 0.443 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 17 cost time: 1.40653657913208
Epoch: 17, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.432 Vali Acc: 0.783 Test Loss: 0.432 Test Acc: 0.783
Validation loss decreased (-0.783329 --> -0.783329).  Saving model ...
Epoch: 18 cost time: 1.7192025184631348
Epoch: 18, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.429 Vali Acc: 0.800 Test Loss: 0.429 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 1.6369316577911377
Epoch: 19, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.413 Vali Acc: 0.783 Test Loss: 0.413 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6872878074645996
Epoch: 20, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.401 Vali Acc: 0.806 Test Loss: 0.401 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 21 cost time: 1.392000675201416
Epoch: 21, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.392 Vali Acc: 0.811 Test Loss: 0.392 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 22 cost time: 1.7023375034332275
Epoch: 22, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.390 Vali Acc: 0.806 Test Loss: 0.390 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.590912103652954
Epoch: 23, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.373 Vali Acc: 0.822 Test Loss: 0.373 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 24 cost time: 1.6356501579284668
Epoch: 24, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6881160736083984
Epoch: 25, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.362 Vali Acc: 0.822 Test Loss: 0.362 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 26 cost time: 1.6697032451629639
Epoch: 26, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.354 Vali Acc: 0.817 Test Loss: 0.354 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6521334648132324
Epoch: 27, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.348 Vali Acc: 0.839 Test Loss: 0.348 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838885).  Saving model ...
Epoch: 28 cost time: 1.4890954494476318
Epoch: 28, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.340 Vali Acc: 0.822 Test Loss: 0.340 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.540461778640747
Epoch: 29, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.341 Vali Acc: 0.839 Test Loss: 0.341 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 30 cost time: 1.2370445728302002
Epoch: 30, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.333 Vali Acc: 0.833 Test Loss: 0.333 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3003110885620117
Epoch: 31, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.322 Vali Acc: 0.833 Test Loss: 0.322 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.306426763534546
Epoch: 32, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3744704723358154
Epoch: 33, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.314 Vali Acc: 0.867 Test Loss: 0.314 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866664).  Saving model ...
Epoch: 34 cost time: 1.540830373764038
Epoch: 34, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.609257698059082
Epoch: 35, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.322 Vali Acc: 0.856 Test Loss: 0.322 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4461944103240967
Epoch: 36, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.315 Vali Acc: 0.833 Test Loss: 0.315 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.5658385753631592
Epoch: 37, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.7703392505645752
Epoch: 38, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 39 cost time: 1.5459558963775635
Epoch: 39, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.316 Vali Acc: 0.844 Test Loss: 0.316 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6011016368865967
Epoch: 40, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4770872592926025
Epoch: 41, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.296 Vali Acc: 0.861 Test Loss: 0.296 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.6663646697998047
Epoch: 42, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.6923925876617432
Epoch: 43, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.286 Vali Acc: 0.856 Test Loss: 0.286 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5949687957763672
Epoch: 44, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 45 cost time: 1.5455420017242432
Epoch: 45, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.290 Vali Acc: 0.850 Test Loss: 0.290 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.7715916633605957
Epoch: 46, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 47 cost time: 1.6999976634979248
Epoch: 47, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.7683041095733643
Epoch: 48, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.713120937347412
Epoch: 49, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.5130283832550049
Epoch: 50, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.7038381099700928
Epoch: 51, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.5624282360076904
Epoch: 52, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.282 Vali Acc: 0.856 Test Loss: 0.282 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.8012878894805908
Epoch: 53, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 54 cost time: 1.5310535430908203
Epoch: 54, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 55 cost time: 1.3239922523498535
Epoch: 55, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.609616756439209
Epoch: 56, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.276 Vali Acc: 0.867 Test Loss: 0.276 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.7219994068145752
Epoch: 57, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.720069408416748
Epoch: 58, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.5197083950042725
Epoch: 59, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.9153783321380615
Epoch: 60, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 61 cost time: 1.822251558303833
Epoch: 61, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.275 Vali Acc: 0.872 Test Loss: 0.275 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.5651862621307373
Epoch: 62, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.604628086090088
Epoch: 63, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 64 cost time: 1.8238866329193115
Epoch: 64, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.6354007720947266
Epoch: 65, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.275 Vali Acc: 0.872 Test Loss: 0.275 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.7065703868865967
Epoch: 66, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.6557106971740723
Epoch: 67, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 68 cost time: 1.7852768898010254
Epoch: 68, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.8364613056182861
Epoch: 69, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.800678014755249
Epoch: 70, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.9056220054626465
Epoch: 71, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.869218111038208
Epoch: 72, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.835052728652954
Epoch: 73, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.8411731719970703
Epoch: 74, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.8858988285064697
Epoch: 75, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 76 cost time: 1.9123549461364746
Epoch: 76, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 2.047213315963745
Epoch: 77, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.911919355392456
Epoch: 78, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.8822612762451172
Epoch: 79, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.7671451568603516
Epoch: 80, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.9821739196777344
Epoch: 81, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 1.8302907943725586
Epoch: 82, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 1.9492533206939697
Epoch: 83, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.304 Vali Acc: 0.883 Test Loss: 0.304 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 1.7040441036224365
Epoch: 84, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 1.784255027770996
Epoch: 85, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 28326
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.753662109375
Epoch: 1, Steps: 12 | Train Loss: 1.985 Vali Loss: 1.854 Vali Acc: 0.122 Test Loss: 1.854 Test Acc: 0.122
Validation loss decreased (inf --> -0.122204).  Saving model ...
Epoch: 2 cost time: 1.5045065879821777
Epoch: 2, Steps: 12 | Train Loss: 1.814 Vali Loss: 1.655 Vali Acc: 0.317 Test Loss: 1.655 Test Acc: 0.317
Validation loss decreased (-0.122204 --> -0.316650).  Saving model ...
Epoch: 3 cost time: 1.728452444076538
Epoch: 3, Steps: 12 | Train Loss: 1.573 Vali Loss: 1.431 Vali Acc: 0.539 Test Loss: 1.431 Test Acc: 0.539
Validation loss decreased (-0.316650 --> -0.538875).  Saving model ...
Epoch: 4 cost time: 1.2747766971588135
Epoch: 4, Steps: 12 | Train Loss: 1.337 Vali Loss: 1.219 Vali Acc: 0.633 Test Loss: 1.219 Test Acc: 0.633
Validation loss decreased (-0.538875 --> -0.633321).  Saving model ...
Epoch: 5 cost time: 1.309126377105713
Epoch: 5, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.040 Vali Acc: 0.644 Test Loss: 1.040 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644434).  Saving model ...
Epoch: 6 cost time: 1.6052629947662354
Epoch: 6, Steps: 12 | Train Loss: 0.927 Vali Loss: 0.905 Vali Acc: 0.628 Test Loss: 0.905 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6909103393554688
Epoch: 7, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.797 Vali Acc: 0.650 Test Loss: 0.797 Test Acc: 0.650
Validation loss decreased (-0.644434 --> -0.649992).  Saving model ...
Epoch: 8 cost time: 1.760495901107788
Epoch: 8, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.716 Vali Acc: 0.678 Test Loss: 0.716 Test Acc: 0.678
Validation loss decreased (-0.649992 --> -0.677771).  Saving model ...
Epoch: 9 cost time: 1.6564536094665527
Epoch: 9, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.654 Vali Acc: 0.700 Test Loss: 0.654 Test Acc: 0.700
Validation loss decreased (-0.677771 --> -0.699993).  Saving model ...
Epoch: 10 cost time: 1.6814913749694824
Epoch: 10, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.615 Vali Acc: 0.711 Test Loss: 0.615 Test Acc: 0.711
Validation loss decreased (-0.699993 --> -0.711105).  Saving model ...
Epoch: 11 cost time: 1.7898526191711426
Epoch: 11, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.567 Vali Acc: 0.728 Test Loss: 0.567 Test Acc: 0.728
Validation loss decreased (-0.711105 --> -0.727772).  Saving model ...
Epoch: 12 cost time: 1.545687198638916
Epoch: 12, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.542 Vali Acc: 0.733 Test Loss: 0.542 Test Acc: 0.733
Validation loss decreased (-0.727772 --> -0.733328).  Saving model ...
Epoch: 13 cost time: 1.4516081809997559
Epoch: 13, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.504 Vali Acc: 0.756 Test Loss: 0.504 Test Acc: 0.756
Validation loss decreased (-0.733328 --> -0.755551).  Saving model ...
Epoch: 14 cost time: 1.7919690608978271
Epoch: 14, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.475 Vali Acc: 0.750 Test Loss: 0.475 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3406484127044678
Epoch: 15, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.448 Vali Acc: 0.761 Test Loss: 0.448 Test Acc: 0.761
Validation loss decreased (-0.755551 --> -0.761107).  Saving model ...
Epoch: 16 cost time: 1.303455114364624
Epoch: 16, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.432 Vali Acc: 0.750 Test Loss: 0.432 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4318857192993164
Epoch: 17, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.422 Vali Acc: 0.761 Test Loss: 0.422 Test Acc: 0.761
Validation loss decreased (-0.761107 --> -0.761107).  Saving model ...
Epoch: 18 cost time: 1.6197235584259033
Epoch: 18, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.426 Vali Acc: 0.794 Test Loss: 0.426 Test Acc: 0.794
Validation loss decreased (-0.761107 --> -0.794440).  Saving model ...
Epoch: 19 cost time: 1.5890488624572754
Epoch: 19, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.406 Vali Acc: 0.789 Test Loss: 0.406 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6521835327148438
Epoch: 20, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.397 Vali Acc: 0.806 Test Loss: 0.397 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 21 cost time: 1.4855053424835205
Epoch: 21, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.380 Vali Acc: 0.800 Test Loss: 0.380 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5103626251220703
Epoch: 22, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.374 Vali Acc: 0.811 Test Loss: 0.374 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 23 cost time: 1.5466077327728271
Epoch: 23, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.361 Vali Acc: 0.806 Test Loss: 0.361 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6327879428863525
Epoch: 24, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.357 Vali Acc: 0.817 Test Loss: 0.357 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 25 cost time: 1.6444475650787354
Epoch: 25, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.357 Vali Acc: 0.817 Test Loss: 0.357 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4074771404266357
Epoch: 26, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.349 Vali Acc: 0.806 Test Loss: 0.349 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3261959552764893
Epoch: 27, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.342 Vali Acc: 0.822 Test Loss: 0.342 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 28 cost time: 1.346529483795166
Epoch: 28, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.330 Vali Acc: 0.822 Test Loss: 0.330 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 29 cost time: 1.8457908630371094
Epoch: 29, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838886).  Saving model ...
Epoch: 30 cost time: 1.7745661735534668
Epoch: 30, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.314 Vali Acc: 0.833 Test Loss: 0.314 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7163593769073486
Epoch: 31, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 32 cost time: 1.6621921062469482
Epoch: 32, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.312 Vali Acc: 0.839 Test Loss: 0.312 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4638168811798096
Epoch: 33, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.302 Vali Acc: 0.822 Test Loss: 0.302 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0974359512329102
Epoch: 34, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.303 Vali Acc: 0.822 Test Loss: 0.303 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1887831687927246
Epoch: 35, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.304 Vali Acc: 0.839 Test Loss: 0.304 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3146257400512695
Epoch: 36, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.297 Vali Acc: 0.833 Test Loss: 0.297 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5511207580566406
Epoch: 37, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.277 Vali Acc: 0.867 Test Loss: 0.277 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 38 cost time: 1.7198765277862549
Epoch: 38, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 39 cost time: 1.7616441249847412
Epoch: 39, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.534346580505371
Epoch: 40, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7508790493011475
Epoch: 41, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.268 Vali Acc: 0.867 Test Loss: 0.268 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.8370788097381592
Epoch: 42, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.281 Vali Acc: 0.850 Test Loss: 0.281 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5577178001403809
Epoch: 43, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.272 Vali Acc: 0.867 Test Loss: 0.272 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.7426469326019287
Epoch: 44, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.268 Vali Acc: 0.867 Test Loss: 0.268 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.585439682006836
Epoch: 45, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.267 Vali Acc: 0.856 Test Loss: 0.267 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.6577539443969727
Epoch: 46, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.254 Vali Acc: 0.867 Test Loss: 0.254 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.7374260425567627
Epoch: 47, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.281 Vali Acc: 0.856 Test Loss: 0.281 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.751314401626587
Epoch: 48, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.253 Vali Acc: 0.867 Test Loss: 0.253 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 28326
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.057681083679199
Epoch: 1, Steps: 12 | Train Loss: 1.529 Vali Loss: 1.002 Vali Acc: 0.672 Test Loss: 1.002 Test Acc: 0.672
Validation loss decreased (inf --> -0.672212).  Saving model ...
Epoch: 2 cost time: 1.4753227233886719
Epoch: 2, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.597 Vali Acc: 0.739 Test Loss: 0.597 Test Acc: 0.739
Validation loss decreased (-0.672212 --> -0.738883).  Saving model ...
Epoch: 3 cost time: 1.5845043659210205
Epoch: 3, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.416 Vali Acc: 0.794 Test Loss: 0.416 Test Acc: 0.794
Validation loss decreased (-0.738883 --> -0.794440).  Saving model ...
Epoch: 4 cost time: 1.6576800346374512
Epoch: 4, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.388 Vali Acc: 0.811 Test Loss: 0.388 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 1.414581537246704
Epoch: 5, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.347 Vali Acc: 0.844 Test Loss: 0.347 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.7144415378570557
Epoch: 6, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.335 Vali Acc: 0.833 Test Loss: 0.335 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.535383939743042
Epoch: 7, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.295 Vali Acc: 0.850 Test Loss: 0.295 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 1.3787152767181396
Epoch: 8, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.363 Vali Acc: 0.828 Test Loss: 0.363 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3710486888885498
Epoch: 9, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 1.3916785717010498
Epoch: 10, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.358 Vali Acc: 0.844 Test Loss: 0.358 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3202996253967285
Epoch: 11, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4001400470733643
Epoch: 12, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.613614797592163
Epoch: 13, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.322 Vali Acc: 0.883 Test Loss: 0.322 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.4372646808624268
Epoch: 14, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.423 Vali Acc: 0.839 Test Loss: 0.423 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.507660150527954
Epoch: 15, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2935516834259033
Epoch: 16, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.311 Vali Acc: 0.872 Test Loss: 0.311 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.312591314315796
Epoch: 17, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.500 Vali Acc: 0.828 Test Loss: 0.500 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.382737636566162
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.341 Vali Acc: 0.867 Test Loss: 0.341 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2024002075195312
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 1.1771981716156006
Epoch: 20, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.436 Vali Acc: 0.878 Test Loss: 0.436 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4523348808288574
Epoch: 21, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.364 Vali Acc: 0.894 Test Loss: 0.364 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 22 cost time: 1.577082633972168
Epoch: 22, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.325 Vali Acc: 0.894 Test Loss: 0.325 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 23 cost time: 1.435976505279541
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.337 Vali Acc: 0.883 Test Loss: 0.337 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4175012111663818
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.384 Vali Acc: 0.878 Test Loss: 0.384 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.698227882385254
Epoch: 25, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.556 Vali Acc: 0.839 Test Loss: 0.556 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.668877363204956
Epoch: 26, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.411 Vali Acc: 0.856 Test Loss: 0.411 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.53879976272583
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.353 Vali Acc: 0.883 Test Loss: 0.353 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6301817893981934
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.388 Vali Acc: 0.872 Test Loss: 0.388 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.481966257095337
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.353 Vali Acc: 0.883 Test Loss: 0.353 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5526559352874756
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.585439682006836
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.375 Vali Acc: 0.872 Test Loss: 0.375 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.5714728832244873
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.372 Vali Acc: 0.878 Test Loss: 0.372 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2845814
model size : 20.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.476703405380249
Epoch: 1, Steps: 12 | Train Loss: 1.526 Vali Loss: 0.987 Vali Acc: 0.689 Test Loss: 0.987 Test Acc: 0.689
Validation loss decreased (inf --> -0.688879).  Saving model ...
Epoch: 2 cost time: 1.1795804500579834
Epoch: 2, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.589 Vali Acc: 0.739 Test Loss: 0.589 Test Acc: 0.739
Validation loss decreased (-0.688879 --> -0.738883).  Saving model ...
Epoch: 3 cost time: 1.5365328788757324
Epoch: 3, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.407 Vali Acc: 0.806 Test Loss: 0.407 Test Acc: 0.806
Validation loss decreased (-0.738883 --> -0.805551).  Saving model ...
Epoch: 4 cost time: 1.4606878757476807
Epoch: 4, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.379 Vali Acc: 0.817 Test Loss: 0.379 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 1.4217898845672607
Epoch: 5, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.340 Vali Acc: 0.844 Test Loss: 0.340 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.487306833267212
Epoch: 6, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3069736957550049
Epoch: 7, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.290 Vali Acc: 0.844 Test Loss: 0.290 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844442).  Saving model ...
Epoch: 8 cost time: 1.6356239318847656
Epoch: 8, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.569457769393921
Epoch: 9, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
Validation loss decreased (-0.844442 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 1.3296852111816406
Epoch: 10, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5740180015563965
Epoch: 11, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5105781555175781
Epoch: 12, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.443 Vali Acc: 0.844 Test Loss: 0.443 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.433741807937622
Epoch: 13, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.310 Vali Acc: 0.883 Test Loss: 0.310 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.5405304431915283
Epoch: 14, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.425 Vali Acc: 0.839 Test Loss: 0.425 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5829863548278809
Epoch: 15, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4706566333770752
Epoch: 16, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.430903434753418
Epoch: 17, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2135646343231201
Epoch: 18, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.241070032119751
Epoch: 19, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.357 Vali Acc: 0.883 Test Loss: 0.357 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5040135383605957
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.416 Vali Acc: 0.883 Test Loss: 0.416 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3963558673858643
Epoch: 21, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.341 Vali Acc: 0.894 Test Loss: 0.341 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 22 cost time: 1.3937931060791016
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.319 Vali Acc: 0.883 Test Loss: 0.319 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5303137302398682
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 24 cost time: 1.4842495918273926
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.348 Vali Acc: 0.883 Test Loss: 0.348 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5021982192993164
Epoch: 25, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.456 Vali Acc: 0.856 Test Loss: 0.456 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7953248023986816
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.410 Vali Acc: 0.867 Test Loss: 0.410 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6620092391967773
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.338 Vali Acc: 0.878 Test Loss: 0.338 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.6423356533050537
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.358 Vali Acc: 0.872 Test Loss: 0.358 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.675506591796875
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.341 Vali Acc: 0.883 Test Loss: 0.341 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5598363876342773
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.330 Vali Acc: 0.878 Test Loss: 0.330 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.560655117034912
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.372 Vali Acc: 0.872 Test Loss: 0.372 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.295351266860962
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.362 Vali Acc: 0.872 Test Loss: 0.362 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.683361291885376
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.352 Vali Acc: 0.894 Test Loss: 0.352 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2845814
model size : 20.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9370763301849365
Epoch: 1, Steps: 12 | Train Loss: 1.541 Vali Loss: 0.979 Vali Acc: 0.683 Test Loss: 0.979 Test Acc: 0.683
Validation loss decreased (inf --> -0.683324).  Saving model ...
Epoch: 2 cost time: 1.3025076389312744
Epoch: 2, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.576 Vali Acc: 0.739 Test Loss: 0.576 Test Acc: 0.739
Validation loss decreased (-0.683324 --> -0.738883).  Saving model ...
Epoch: 3 cost time: 1.5745859146118164
Epoch: 3, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.391 Vali Acc: 0.822 Test Loss: 0.391 Test Acc: 0.822
Validation loss decreased (-0.738883 --> -0.822218).  Saving model ...
Epoch: 4 cost time: 1.3717949390411377
Epoch: 4, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.363 Vali Acc: 0.811 Test Loss: 0.363 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2254974842071533
Epoch: 5, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.510350227355957
Epoch: 6, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.308 Vali Acc: 0.839 Test Loss: 0.308 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3819737434387207
Epoch: 7, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.278 Vali Acc: 0.833 Test Loss: 0.278 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3544669151306152
Epoch: 8, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.346 Vali Acc: 0.833 Test Loss: 0.346 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4397296905517578
Epoch: 9, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.276 Vali Acc: 0.867 Test Loss: 0.276 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 1.117915391921997
Epoch: 10, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3960065841674805
Epoch: 11, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4345312118530273
Epoch: 12, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.327646255493164
Epoch: 13, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.1384849548339844
Epoch: 14, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.423 Vali Acc: 0.844 Test Loss: 0.423 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4607889652252197
Epoch: 15, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0501821041107178
Epoch: 16, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.155367136001587
Epoch: 17, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.471 Vali Acc: 0.817 Test Loss: 0.471 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2844040393829346
Epoch: 18, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.4955005645751953
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3409185409545898
Epoch: 20, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.358 Vali Acc: 0.894 Test Loss: 0.358 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5089609622955322
Epoch: 21, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.330 Vali Acc: 0.883 Test Loss: 0.330 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.279289960861206
Epoch: 22, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5341856479644775
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4009130001068115
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.449021816253662
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.413 Vali Acc: 0.856 Test Loss: 0.413 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.399296522140503
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.373 Vali Acc: 0.867 Test Loss: 0.373 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3951761722564697
Epoch: 27, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.324 Vali Acc: 0.883 Test Loss: 0.324 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3267836570739746
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.358 Vali Acc: 0.883 Test Loss: 0.358 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2845814
model size : 20.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4192495346069336
Epoch: 1, Steps: 12 | Train Loss: 1.545 Vali Loss: 1.008 Vali Acc: 0.689 Test Loss: 1.008 Test Acc: 0.689
Validation loss decreased (inf --> -0.688879).  Saving model ...
Epoch: 2 cost time: 1.4022610187530518
Epoch: 2, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.602 Vali Acc: 0.717 Test Loss: 0.602 Test Acc: 0.717
Validation loss decreased (-0.688879 --> -0.716661).  Saving model ...
Epoch: 3 cost time: 1.3363089561462402
Epoch: 3, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.423 Vali Acc: 0.794 Test Loss: 0.423 Test Acc: 0.794
Validation loss decreased (-0.716661 --> -0.794440).  Saving model ...
Epoch: 4 cost time: 1.4203946590423584
Epoch: 4, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.385 Vali Acc: 0.800 Test Loss: 0.385 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 1.3173491954803467
Epoch: 5, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.332 Vali Acc: 0.833 Test Loss: 0.332 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 6 cost time: 1.38547682762146
Epoch: 6, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 1.5956683158874512
Epoch: 7, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.286 Vali Acc: 0.844 Test Loss: 0.286 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844442).  Saving model ...
Epoch: 8 cost time: 1.5071690082550049
Epoch: 8, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.338 Vali Acc: 0.817 Test Loss: 0.338 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3762421607971191
Epoch: 9, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
Validation loss decreased (-0.844442 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.6151418685913086
Epoch: 10, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.279 Vali Acc: 0.850 Test Loss: 0.279 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2908990383148193
Epoch: 11, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6006197929382324
Epoch: 12, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.358 Vali Acc: 0.850 Test Loss: 0.358 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4173955917358398
Epoch: 13, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.290 Vali Acc: 0.850 Test Loss: 0.290 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2711424827575684
Epoch: 14, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 1.3753156661987305
Epoch: 15, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.556197166442871
Epoch: 16, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5678775310516357
Epoch: 17, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4004404544830322
Epoch: 18, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.554762840270996
Epoch: 19, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 1.5009715557098389
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5132737159729004
Epoch: 21, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.287 Vali Acc: 0.894 Test Loss: 0.287 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5471076965332031
Epoch: 22, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4432363510131836
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3930461406707764
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.319 Vali Acc: 0.894 Test Loss: 0.319 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4891953468322754
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.324 Vali Acc: 0.878 Test Loss: 0.324 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4703395366668701
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.450974941253662
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.306 Vali Acc: 0.894 Test Loss: 0.306 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5706110000610352
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.362 Vali Acc: 0.867 Test Loss: 0.362 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3534467220306396
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.326 Vali Acc: 0.883 Test Loss: 0.326 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2845814
model size : 20.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4431402683258057
Epoch: 1, Steps: 12 | Train Loss: 1.607 Vali Loss: 0.989 Vali Acc: 0.650 Test Loss: 0.989 Test Acc: 0.650
Validation loss decreased (inf --> -0.649990).  Saving model ...
Epoch: 2 cost time: 1.6737241744995117
Epoch: 2, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.615 Vali Acc: 0.739 Test Loss: 0.615 Test Acc: 0.739
Validation loss decreased (-0.649990 --> -0.738883).  Saving model ...
Epoch: 3 cost time: 1.6264748573303223
Epoch: 3, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.427 Vali Acc: 0.783 Test Loss: 0.427 Test Acc: 0.783
Validation loss decreased (-0.738883 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 1.399658441543579
Epoch: 4, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
Validation loss decreased (-0.783329 --> -0.833330).  Saving model ...
Epoch: 5 cost time: 1.693701982498169
Epoch: 5, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.398 Vali Acc: 0.800 Test Loss: 0.398 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8881051540374756
Epoch: 6, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.330 Vali Acc: 0.856 Test Loss: 0.330 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 1.765453577041626
Epoch: 7, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.373 Vali Acc: 0.811 Test Loss: 0.373 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6917917728424072
Epoch: 8, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.594242811203003
Epoch: 9, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6518380641937256
Epoch: 10, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.305 Vali Acc: 0.883 Test Loss: 0.305 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 11 cost time: 1.7628998756408691
Epoch: 11, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6394169330596924
Epoch: 12, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7292087078094482
Epoch: 13, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5558733940124512
Epoch: 14, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4838159084320068
Epoch: 15, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7055065631866455
Epoch: 16, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.287 Vali Acc: 0.894 Test Loss: 0.287 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 1.4306590557098389
Epoch: 17, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.360 Vali Acc: 0.844 Test Loss: 0.360 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7512824535369873
Epoch: 18, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.353 Vali Acc: 0.850 Test Loss: 0.353 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.303495168685913
Epoch: 19, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.381 Vali Acc: 0.850 Test Loss: 0.381 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7014014720916748
Epoch: 20, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4014782905578613
Epoch: 21, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.457 Vali Acc: 0.839 Test Loss: 0.457 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7031235694885254
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.396 Vali Acc: 0.861 Test Loss: 0.396 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4553592205047607
Epoch: 23, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.344 Vali Acc: 0.883 Test Loss: 0.344 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7712805271148682
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.576 Vali Acc: 0.839 Test Loss: 0.576 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5333342552185059
Epoch: 25, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.327 Vali Acc: 0.883 Test Loss: 0.327 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5207583904266357
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.354 Vali Acc: 0.867 Test Loss: 0.354 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1797238
model size : 16.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4958913326263428
Epoch: 1, Steps: 12 | Train Loss: 1.610 Vali Loss: 0.991 Vali Acc: 0.628 Test Loss: 0.991 Test Acc: 0.628
Validation loss decreased (inf --> -0.627768).  Saving model ...
Epoch: 2 cost time: 1.5044147968292236
Epoch: 2, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.612 Vali Acc: 0.722 Test Loss: 0.612 Test Acc: 0.722
Validation loss decreased (-0.627768 --> -0.722216).  Saving model ...
Epoch: 3 cost time: 1.1991164684295654
Epoch: 3, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.426 Vali Acc: 0.783 Test Loss: 0.426 Test Acc: 0.783
Validation loss decreased (-0.722216 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 1.0877697467803955
Epoch: 4, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.363 Vali Acc: 0.828 Test Loss: 0.363 Test Acc: 0.828
Validation loss decreased (-0.783329 --> -0.827774).  Saving model ...
Epoch: 5 cost time: 1.217752456665039
Epoch: 5, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.398 Vali Acc: 0.800 Test Loss: 0.398 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3754372596740723
Epoch: 6, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.325 Vali Acc: 0.872 Test Loss: 0.325 Test Acc: 0.872
Validation loss decreased (-0.827774 --> -0.872219).  Saving model ...
Epoch: 7 cost time: 1.4332635402679443
Epoch: 7, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.372 Vali Acc: 0.811 Test Loss: 0.372 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2923312187194824
Epoch: 8, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.438046932220459
Epoch: 9, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.354 Vali Acc: 0.828 Test Loss: 0.354 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6738531589508057
Epoch: 10, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 1.2965660095214844
Epoch: 11, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3397297859191895
Epoch: 12, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4807016849517822
Epoch: 13, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.339 Vali Acc: 0.861 Test Loss: 0.339 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7066938877105713
Epoch: 14, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6285607814788818
Epoch: 15, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.372328758239746
Epoch: 16, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5078880786895752
Epoch: 17, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.379 Vali Acc: 0.844 Test Loss: 0.379 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5825786590576172
Epoch: 18, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.368 Vali Acc: 0.861 Test Loss: 0.368 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4275307655334473
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.436 Vali Acc: 0.844 Test Loss: 0.436 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5457706451416016
Epoch: 20, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1797238
model size : 16.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1923394203186035
Epoch: 1, Steps: 12 | Train Loss: 1.630 Vali Loss: 1.000 Vali Acc: 0.650 Test Loss: 1.000 Test Acc: 0.650
Validation loss decreased (inf --> -0.649990).  Saving model ...
Epoch: 2 cost time: 1.4658052921295166
Epoch: 2, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.608 Vali Acc: 0.728 Test Loss: 0.608 Test Acc: 0.728
Validation loss decreased (-0.649990 --> -0.727772).  Saving model ...
Epoch: 3 cost time: 1.3919086456298828
Epoch: 3, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.414 Vali Acc: 0.783 Test Loss: 0.414 Test Acc: 0.783
Validation loss decreased (-0.727772 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 1.2946841716766357
Epoch: 4, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.360 Vali Acc: 0.822 Test Loss: 0.360 Test Acc: 0.822
Validation loss decreased (-0.783329 --> -0.822219).  Saving model ...
Epoch: 5 cost time: 1.3609464168548584
Epoch: 5, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.394 Vali Acc: 0.794 Test Loss: 0.394 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5984125137329102
Epoch: 6, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.318 Vali Acc: 0.883 Test Loss: 0.318 Test Acc: 0.883
Validation loss decreased (-0.822219 --> -0.883330).  Saving model ...
Epoch: 7 cost time: 1.5119152069091797
Epoch: 7, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3626585006713867
Epoch: 8, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2192082405090332
Epoch: 9, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4569017887115479
Epoch: 10, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 11 cost time: 1.302826166152954
Epoch: 11, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2586076259613037
Epoch: 12, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4038043022155762
Epoch: 13, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6884186267852783
Epoch: 14, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.338874340057373
Epoch: 15, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4904825687408447
Epoch: 16, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.328 Vali Acc: 0.883 Test Loss: 0.328 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.600527048110962
Epoch: 17, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.288 Vali Acc: 0.894 Test Loss: 0.288 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.617544174194336
Epoch: 18, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5907857418060303
Epoch: 19, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.547421932220459
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1797238
model size : 16.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.65291428565979
Epoch: 1, Steps: 12 | Train Loss: 1.569 Vali Loss: 1.017 Vali Acc: 0.683 Test Loss: 1.017 Test Acc: 0.683
Validation loss decreased (inf --> -0.683323).  Saving model ...
Epoch: 2 cost time: 1.2861299514770508
Epoch: 2, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.644 Vali Acc: 0.689 Test Loss: 0.644 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688882).  Saving model ...
Epoch: 3 cost time: 1.6685237884521484
Epoch: 3, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.433 Vali Acc: 0.789 Test Loss: 0.433 Test Acc: 0.789
Validation loss decreased (-0.688882 --> -0.788885).  Saving model ...
Epoch: 4 cost time: 1.2939281463623047
Epoch: 4, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.373 Vali Acc: 0.789 Test Loss: 0.373 Test Acc: 0.789
Validation loss decreased (-0.788885 --> -0.788885).  Saving model ...
Epoch: 5 cost time: 1.4516136646270752
Epoch: 5, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.388 Vali Acc: 0.833 Test Loss: 0.388 Test Acc: 0.833
Validation loss decreased (-0.788885 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 1.421764850616455
Epoch: 6, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
Validation loss decreased (-0.833329 --> -0.894441).  Saving model ...
Epoch: 7 cost time: 1.4895591735839844
Epoch: 7, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.369 Vali Acc: 0.806 Test Loss: 0.369 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5234804153442383
Epoch: 8, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.361405611038208
Epoch: 9, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.338 Vali Acc: 0.833 Test Loss: 0.338 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.282484769821167
Epoch: 10, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3815512657165527
Epoch: 11, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4084889888763428
Epoch: 12, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.261 Vali Acc: 0.872 Test Loss: 0.261 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.578361988067627
Epoch: 13, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2099215984344482
Epoch: 14, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4186010360717773
Epoch: 15, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4282159805297852
Epoch: 16, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1797238
model size : 16.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.525807857513428
Epoch: 1, Steps: 12 | Train Loss: 1.545 Vali Loss: 0.942 Vali Acc: 0.650 Test Loss: 0.942 Test Acc: 0.650
Validation loss decreased (inf --> -0.649991).  Saving model ...
Epoch: 2 cost time: 1.507270336151123
Epoch: 2, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
Validation loss decreased (-0.649991 --> -0.716661).  Saving model ...
Epoch: 3 cost time: 1.5759875774383545
Epoch: 3, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.442 Vali Acc: 0.761 Test Loss: 0.442 Test Acc: 0.761
Validation loss decreased (-0.716661 --> -0.761107).  Saving model ...
Epoch: 4 cost time: 1.4492692947387695
Epoch: 4, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.386 Vali Acc: 0.794 Test Loss: 0.386 Test Acc: 0.794
Validation loss decreased (-0.761107 --> -0.794441).  Saving model ...
Epoch: 5 cost time: 1.3451807498931885
Epoch: 5, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.380 Vali Acc: 0.850 Test Loss: 0.380 Test Acc: 0.850
Validation loss decreased (-0.794441 --> -0.849996).  Saving model ...
Epoch: 6 cost time: 1.3801207542419434
Epoch: 6, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.374 Vali Acc: 0.800 Test Loss: 0.374 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9722349643707275
Epoch: 7, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2902660369873047
Epoch: 8, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.414 Vali Acc: 0.822 Test Loss: 0.414 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.334524154663086
Epoch: 9, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883330).  Saving model ...
Epoch: 10 cost time: 1.4180378913879395
Epoch: 10, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3200080394744873
Epoch: 11, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.324 Vali Acc: 0.850 Test Loss: 0.324 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1882309913635254
Epoch: 12, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 1.2085802555084229
Epoch: 13, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4042696952819824
Epoch: 14, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3747751712799072
Epoch: 15, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 1.099747896194458
Epoch: 16, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.443 Vali Acc: 0.867 Test Loss: 0.443 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4196743965148926
Epoch: 17, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4896557331085205
Epoch: 18, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.307 Vali Acc: 0.872 Test Loss: 0.307 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3478891849517822
Epoch: 19, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5102243423461914
Epoch: 20, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5529758930206299
Epoch: 21, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4937565326690674
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.340 Vali Acc: 0.872 Test Loss: 0.340 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5330286026000977
Epoch: 23, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.349 Vali Acc: 0.861 Test Loss: 0.349 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4370005130767822
Epoch: 24, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.345 Vali Acc: 0.878 Test Loss: 0.345 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4969477653503418
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.346 Vali Acc: 0.883 Test Loss: 0.346 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1272950
model size : 14.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.89665150642395
Epoch: 1, Steps: 12 | Train Loss: 1.542 Vali Loss: 0.951 Vali Acc: 0.628 Test Loss: 0.951 Test Acc: 0.628
Validation loss decreased (inf --> -0.627768).  Saving model ...
Epoch: 2 cost time: 1.3813621997833252
Epoch: 2, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.569 Vali Acc: 0.700 Test Loss: 0.569 Test Acc: 0.700
Validation loss decreased (-0.627768 --> -0.699994).  Saving model ...
Epoch: 3 cost time: 1.283679723739624
Epoch: 3, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.448 Vali Acc: 0.756 Test Loss: 0.448 Test Acc: 0.756
Validation loss decreased (-0.699994 --> -0.755551).  Saving model ...
Epoch: 4 cost time: 1.3510851860046387
Epoch: 4, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.377 Vali Acc: 0.806 Test Loss: 0.377 Test Acc: 0.806
Validation loss decreased (-0.755551 --> -0.805552).  Saving model ...
Epoch: 5 cost time: 1.2050015926361084
Epoch: 5, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.368 Vali Acc: 0.856 Test Loss: 0.368 Test Acc: 0.856
Validation loss decreased (-0.805552 --> -0.855552).  Saving model ...
Epoch: 6 cost time: 1.3620967864990234
Epoch: 6, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.390 Vali Acc: 0.800 Test Loss: 0.390 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3826076984405518
Epoch: 7, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.315288782119751
Epoch: 8, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.441 Vali Acc: 0.811 Test Loss: 0.441 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3171663284301758
Epoch: 9, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.292 Vali Acc: 0.883 Test Loss: 0.292 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 10 cost time: 1.4822618961334229
Epoch: 10, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 11 cost time: 1.4400238990783691
Epoch: 11, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3765602111816406
Epoch: 12, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4562098979949951
Epoch: 13, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.47456693649292
Epoch: 14, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3532865047454834
Epoch: 15, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.311 Vali Acc: 0.894 Test Loss: 0.311 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 16 cost time: 1.409883737564087
Epoch: 16, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.386 Vali Acc: 0.878 Test Loss: 0.386 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1982369422912598
Epoch: 17, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.335 Vali Acc: 0.872 Test Loss: 0.335 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0667951107025146
Epoch: 18, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2558703422546387
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.301 Vali Acc: 0.894 Test Loss: 0.301 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 20 cost time: 1.171006441116333
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.382 Vali Acc: 0.867 Test Loss: 0.382 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2686455249786377
Epoch: 21, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.384 Vali Acc: 0.856 Test Loss: 0.384 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1534044742584229
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.337 Vali Acc: 0.872 Test Loss: 0.337 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3058192729949951
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.344 Vali Acc: 0.878 Test Loss: 0.344 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3561296463012695
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2682287693023682
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.369 Vali Acc: 0.878 Test Loss: 0.369 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4904356002807617
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.366 Vali Acc: 0.878 Test Loss: 0.366 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5281178951263428
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4801104068756104
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.388 Vali Acc: 0.883 Test Loss: 0.388 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.313831090927124
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1272950
model size : 14.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.0464863777160645
Epoch: 1, Steps: 12 | Train Loss: 1.533 Vali Loss: 0.944 Vali Acc: 0.644 Test Loss: 0.944 Test Acc: 0.644
Validation loss decreased (inf --> -0.644435).  Saving model ...
Epoch: 2 cost time: 1.5005605220794678
Epoch: 2, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.559 Vali Acc: 0.739 Test Loss: 0.559 Test Acc: 0.739
Validation loss decreased (-0.644435 --> -0.738883).  Saving model ...
Epoch: 3 cost time: 1.5687744617462158
Epoch: 3, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.445 Vali Acc: 0.756 Test Loss: 0.445 Test Acc: 0.756
Validation loss decreased (-0.738883 --> -0.755551).  Saving model ...
Epoch: 4 cost time: 1.5454416275024414
Epoch: 4, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.379 Vali Acc: 0.806 Test Loss: 0.379 Test Acc: 0.806
Validation loss decreased (-0.755551 --> -0.805552).  Saving model ...
Epoch: 5 cost time: 1.2106404304504395
Epoch: 5, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.372 Vali Acc: 0.844 Test Loss: 0.372 Test Acc: 0.844
Validation loss decreased (-0.805552 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.4744205474853516
Epoch: 6, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.379 Vali Acc: 0.800 Test Loss: 0.379 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4625098705291748
Epoch: 7, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.314 Vali Acc: 0.833 Test Loss: 0.314 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4984688758850098
Epoch: 8, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.406 Vali Acc: 0.817 Test Loss: 0.406 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4351396560668945
Epoch: 9, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 1.389467716217041
Epoch: 10, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4003641605377197
Epoch: 11, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.304 Vali Acc: 0.844 Test Loss: 0.304 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.524289608001709
Epoch: 12, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 13 cost time: 1.4909532070159912
Epoch: 13, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3864080905914307
Epoch: 14, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 15 cost time: 1.5062921047210693
Epoch: 15, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1516993045806885
Epoch: 16, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1661083698272705
Epoch: 17, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 1.120354413986206
Epoch: 18, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0012152194976807
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.321 Vali Acc: 0.878 Test Loss: 0.321 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2448229789733887
Epoch: 20, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.409 Vali Acc: 0.867 Test Loss: 0.409 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1267242431640625
Epoch: 21, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6344175338745117
Epoch: 22, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.330 Vali Acc: 0.878 Test Loss: 0.330 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5473573207855225
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.332735300064087
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 25 cost time: 1.2972862720489502
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.346 Vali Acc: 0.878 Test Loss: 0.346 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.474668264389038
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.325 Vali Acc: 0.894 Test Loss: 0.325 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.440258264541626
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.338 Vali Acc: 0.894 Test Loss: 0.338 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4404327869415283
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.403 Vali Acc: 0.872 Test Loss: 0.403 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4959759712219238
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.423 Vali Acc: 0.894 Test Loss: 0.423 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3589680194854736
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.462 Vali Acc: 0.883 Test Loss: 0.462 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0580718517303467
Epoch: 31, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.359 Vali Acc: 0.878 Test Loss: 0.359 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2175390720367432
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.457 Vali Acc: 0.861 Test Loss: 0.457 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.3477580547332764
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.365 Vali Acc: 0.872 Test Loss: 0.365 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.235414981842041
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1272950
model size : 14.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.846895217895508
Epoch: 1, Steps: 12 | Train Loss: 1.538 Vali Loss: 0.980 Vali Acc: 0.672 Test Loss: 0.980 Test Acc: 0.672
Validation loss decreased (inf --> -0.672212).  Saving model ...
Epoch: 2 cost time: 1.431976556777954
Epoch: 2, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.672212 --> -0.722216).  Saving model ...
Epoch: 3 cost time: 1.2723822593688965
Epoch: 3, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.440 Vali Acc: 0.756 Test Loss: 0.440 Test Acc: 0.756
Validation loss decreased (-0.722216 --> -0.755551).  Saving model ...
Epoch: 4 cost time: 1.3358511924743652
Epoch: 4, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.398 Vali Acc: 0.794 Test Loss: 0.398 Test Acc: 0.794
Validation loss decreased (-0.755551 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 1.4013283252716064
Epoch: 5, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.388 Vali Acc: 0.833 Test Loss: 0.388 Test Acc: 0.833
Validation loss decreased (-0.794440 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 1.332712173461914
Epoch: 6, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.330 Vali Acc: 0.833 Test Loss: 0.330 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 1.347449541091919
Epoch: 7, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.310 Vali Acc: 0.833 Test Loss: 0.310 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 1.2886409759521484
Epoch: 8, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.358 Vali Acc: 0.828 Test Loss: 0.358 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3027887344360352
Epoch: 9, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855553).  Saving model ...
Epoch: 10 cost time: 1.4252703189849854
Epoch: 10, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.277 Vali Acc: 0.894 Test Loss: 0.277 Test Acc: 0.894
Validation loss decreased (-0.855553 --> -0.894442).  Saving model ...
Epoch: 11 cost time: 1.417513370513916
Epoch: 11, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.251 Vali Acc: 0.883 Test Loss: 0.251 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6029555797576904
Epoch: 12, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4106831550598145
Epoch: 13, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.263 Vali Acc: 0.856 Test Loss: 0.263 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.460482120513916
Epoch: 14, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 15 cost time: 1.5952558517456055
Epoch: 15, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4772968292236328
Epoch: 16, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4069058895111084
Epoch: 17, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.6729280948638916
Epoch: 18, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3858962059020996
Epoch: 19, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4278497695922852
Epoch: 20, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.346 Vali Acc: 0.861 Test Loss: 0.346 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.412560224533081
Epoch: 21, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.511 Vali Acc: 0.839 Test Loss: 0.511 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4195337295532227
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5263848304748535
Epoch: 23, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4191641807556152
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5753955841064453
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5322811603546143
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3261303901672363
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1272950
model size : 14.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.778196334838867
Epoch: 1, Steps: 12 | Train Loss: 1.558 Vali Loss: 0.973 Vali Acc: 0.678 Test Loss: 0.973 Test Acc: 0.678
Validation loss decreased (inf --> -0.677768).  Saving model ...
Epoch: 2 cost time: 1.4602022171020508
Epoch: 2, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.610 Vali Acc: 0.694 Test Loss: 0.610 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694438).  Saving model ...
Epoch: 3 cost time: 1.4896056652069092
Epoch: 3, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.486 Vali Acc: 0.750 Test Loss: 0.486 Test Acc: 0.750
Validation loss decreased (-0.694438 --> -0.749995).  Saving model ...
Epoch: 4 cost time: 1.3739004135131836
Epoch: 4, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.355 Vali Acc: 0.839 Test Loss: 0.355 Test Acc: 0.839
Validation loss decreased (-0.749995 --> -0.838885).  Saving model ...
Epoch: 5 cost time: 1.4696102142333984
Epoch: 5, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.341 Vali Acc: 0.844 Test Loss: 0.341 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.2111268043518066
Epoch: 6, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 7 cost time: 1.2418978214263916
Epoch: 7, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2197601795196533
Epoch: 8, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.323373556137085
Epoch: 9, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.339 Vali Acc: 0.861 Test Loss: 0.339 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3697357177734375
Epoch: 10, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4147226810455322
Epoch: 11, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4323711395263672
Epoch: 12, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.3717336654663086
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.363 Vali Acc: 0.828 Test Loss: 0.363 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.522711992263794
Epoch: 14, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.332 Vali Acc: 0.867 Test Loss: 0.332 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.255918025970459
Epoch: 15, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3526008129119873
Epoch: 16, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 1.1531779766082764
Epoch: 17, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5062754154205322
Epoch: 18, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.358 Vali Acc: 0.856 Test Loss: 0.358 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4999125003814697
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.352 Vali Acc: 0.878 Test Loss: 0.352 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6408610343933105
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.325 Vali Acc: 0.872 Test Loss: 0.325 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4735350608825684
Epoch: 21, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6352624893188477
Epoch: 22, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6167688369750977
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4455101490020752
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.384 Vali Acc: 0.883 Test Loss: 0.384 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4929254055023193
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.348 Vali Acc: 0.878 Test Loss: 0.348 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.655688762664795
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.392 Vali Acc: 0.878 Test Loss: 0.392 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1010806
model size : 13.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.898573160171509
Epoch: 1, Steps: 12 | Train Loss: 1.552 Vali Loss: 0.973 Vali Acc: 0.689 Test Loss: 0.973 Test Acc: 0.689
Validation loss decreased (inf --> -0.688879).  Saving model ...
Epoch: 2 cost time: 1.4536943435668945
Epoch: 2, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.619 Vali Acc: 0.706 Test Loss: 0.619 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705549).  Saving model ...
Epoch: 3 cost time: 1.5228354930877686
Epoch: 3, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.496 Vali Acc: 0.750 Test Loss: 0.496 Test Acc: 0.750
Validation loss decreased (-0.705549 --> -0.749995).  Saving model ...
Epoch: 4 cost time: 1.3429088592529297
Epoch: 4, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.357 Vali Acc: 0.850 Test Loss: 0.357 Test Acc: 0.850
Validation loss decreased (-0.749995 --> -0.849996).  Saving model ...
Epoch: 5 cost time: 1.5454411506652832
Epoch: 5, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.342 Vali Acc: 0.850 Test Loss: 0.342 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 6 cost time: 1.6184024810791016
Epoch: 6, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 7 cost time: 1.3123176097869873
Epoch: 7, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3765966892242432
Epoch: 8, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.300 Vali Acc: 0.867 Test Loss: 0.300 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4572336673736572
Epoch: 9, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.358 Vali Acc: 0.850 Test Loss: 0.358 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2803199291229248
Epoch: 10, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.310 Vali Acc: 0.833 Test Loss: 0.310 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3970012664794922
Epoch: 11, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 12 cost time: 1.3321154117584229
Epoch: 12, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.268 Vali Acc: 0.911 Test Loss: 0.268 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 13 cost time: 1.6263103485107422
Epoch: 13, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6096043586730957
Epoch: 14, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6782639026641846
Epoch: 15, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.316 Vali Acc: 0.872 Test Loss: 0.316 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.456068992614746
Epoch: 16, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5294256210327148
Epoch: 17, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.300588607788086
Epoch: 18, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.343 Vali Acc: 0.872 Test Loss: 0.343 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2150607109069824
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.336 Vali Acc: 0.883 Test Loss: 0.336 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.423316240310669
Epoch: 20, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5618748664855957
Epoch: 21, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.629 Vali Acc: 0.822 Test Loss: 0.629 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3608472347259521
Epoch: 22, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.324 Vali Acc: 0.872 Test Loss: 0.324 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 1010806
model size : 13.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8044166564941406
Epoch: 1, Steps: 12 | Train Loss: 1.521 Vali Loss: 0.973 Vali Acc: 0.683 Test Loss: 0.973 Test Acc: 0.683
Validation loss decreased (inf --> -0.683324).  Saving model ...
Epoch: 2 cost time: 1.4319348335266113
Epoch: 2, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.611 Vali Acc: 0.694 Test Loss: 0.611 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694438).  Saving model ...
Epoch: 3 cost time: 1.313098430633545
Epoch: 3, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.495 Vali Acc: 0.756 Test Loss: 0.495 Test Acc: 0.756
Validation loss decreased (-0.694438 --> -0.755551).  Saving model ...
Epoch: 4 cost time: 1.295665979385376
Epoch: 4, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.354 Vali Acc: 0.839 Test Loss: 0.354 Test Acc: 0.839
Validation loss decreased (-0.755551 --> -0.838885).  Saving model ...
Epoch: 5 cost time: 1.3830108642578125
Epoch: 5, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.162391185760498
Epoch: 6, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.282 Vali Acc: 0.867 Test Loss: 0.282 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 7 cost time: 1.32387113571167
Epoch: 7, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3663487434387207
Epoch: 8, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4892542362213135
Epoch: 9, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4113452434539795
Epoch: 10, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.271 Vali Acc: 0.861 Test Loss: 0.271 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4611592292785645
Epoch: 11, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 12 cost time: 1.4682815074920654
Epoch: 12, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.325 Vali Acc: 0.850 Test Loss: 0.325 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4471220970153809
Epoch: 13, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.350 Vali Acc: 0.844 Test Loss: 0.350 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6050176620483398
Epoch: 14, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5748562812805176
Epoch: 15, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5050556659698486
Epoch: 16, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 1.4736392498016357
Epoch: 17, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.219346523284912
Epoch: 18, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.333 Vali Acc: 0.856 Test Loss: 0.333 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4498419761657715
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.329 Vali Acc: 0.883 Test Loss: 0.329 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4399809837341309
Epoch: 20, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3922903537750244
Epoch: 21, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5981924533843994
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5045299530029297
Epoch: 23, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.421520471572876
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3953092098236084
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3820302486419678
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.318 Vali Acc: 0.894 Test Loss: 0.318 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1010806
model size : 13.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8951196670532227
Epoch: 1, Steps: 12 | Train Loss: 1.498 Vali Loss: 0.995 Vali Acc: 0.700 Test Loss: 0.995 Test Acc: 0.700
Validation loss decreased (inf --> -0.699990).  Saving model ...
Epoch: 2 cost time: 1.4031260013580322
Epoch: 2, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.628 Vali Acc: 0.694 Test Loss: 0.628 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3695056438446045
Epoch: 3, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.502 Vali Acc: 0.733 Test Loss: 0.502 Test Acc: 0.733
Validation loss decreased (-0.699990 --> -0.733328).  Saving model ...
Epoch: 4 cost time: 1.407047986984253
Epoch: 4, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.365 Vali Acc: 0.806 Test Loss: 0.365 Test Acc: 0.806
Validation loss decreased (-0.733328 --> -0.805552).  Saving model ...
Epoch: 5 cost time: 1.1167998313903809
Epoch: 5, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.359 Vali Acc: 0.839 Test Loss: 0.359 Test Acc: 0.839
Validation loss decreased (-0.805552 --> -0.838885).  Saving model ...
Epoch: 6 cost time: 1.2788164615631104
Epoch: 6, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 7 cost time: 1.1602840423583984
Epoch: 7, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0908191204071045
Epoch: 8, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 9 cost time: 1.320277214050293
Epoch: 9, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.369154453277588
Epoch: 10, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899998).  Saving model ...
Epoch: 11 cost time: 1.467536211013794
Epoch: 11, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6323349475860596
Epoch: 12, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.242433786392212
Epoch: 13, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4349384307861328
Epoch: 14, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.433 Vali Acc: 0.828 Test Loss: 0.433 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3912901878356934
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.386 Vali Acc: 0.867 Test Loss: 0.386 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4259872436523438
Epoch: 16, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6562585830688477
Epoch: 17, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7053985595703125
Epoch: 18, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.462 Vali Acc: 0.844 Test Loss: 0.462 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5097110271453857
Epoch: 19, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4022002220153809
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1010806
model size : 13.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.089330673217773
Epoch: 1, Steps: 12 | Train Loss: 1.649 Vali Loss: 0.983 Vali Acc: 0.678 Test Loss: 0.983 Test Acc: 0.678
Validation loss decreased (inf --> -0.677768).  Saving model ...
Epoch: 2 cost time: 1.5224502086639404
Epoch: 2, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.591 Vali Acc: 0.744 Test Loss: 0.591 Test Acc: 0.744
Validation loss decreased (-0.677768 --> -0.744439).  Saving model ...
Epoch: 3 cost time: 1.5037438869476318
Epoch: 3, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.458 Vali Acc: 0.767 Test Loss: 0.458 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766662).  Saving model ...
Epoch: 4 cost time: 1.5518360137939453
Epoch: 4, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.414 Vali Acc: 0.806 Test Loss: 0.414 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 1.5332272052764893
Epoch: 5, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.624 Vali Acc: 0.778 Test Loss: 0.624 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4438867568969727
Epoch: 6, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.317 Vali Acc: 0.833 Test Loss: 0.317 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 1.430180549621582
Epoch: 7, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
Validation loss decreased (-0.833330 --> -0.877775).  Saving model ...
Epoch: 8 cost time: 1.6225192546844482
Epoch: 8, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.520355224609375
Epoch: 9, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.334 Vali Acc: 0.822 Test Loss: 0.334 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4341089725494385
Epoch: 10, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.42698073387146
Epoch: 11, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.337 Vali Acc: 0.844 Test Loss: 0.337 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7136356830596924
Epoch: 12, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.323 Vali Acc: 0.883 Test Loss: 0.323 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 1.523996353149414
Epoch: 13, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 14 cost time: 1.6742932796478271
Epoch: 14, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 1.7101263999938965
Epoch: 15, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.369 Vali Acc: 0.861 Test Loss: 0.369 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2953705787658691
Epoch: 16, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.314 Vali Acc: 0.872 Test Loss: 0.314 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5706100463867188
Epoch: 17, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.379 Vali Acc: 0.872 Test Loss: 0.379 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2935504913330078
Epoch: 18, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.304896593093872
Epoch: 19, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.415 Vali Acc: 0.856 Test Loss: 0.415 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4490728378295898
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.371 Vali Acc: 0.872 Test Loss: 0.371 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.54520845413208
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.345 Vali Acc: 0.894 Test Loss: 0.345 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 22 cost time: 1.4707400798797607
Epoch: 22, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.337 Vali Acc: 0.872 Test Loss: 0.337 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4256839752197266
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.323 Vali Acc: 0.894 Test Loss: 0.323 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 24 cost time: 1.4887564182281494
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.322 Vali Acc: 0.894 Test Loss: 0.322 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 25 cost time: 1.1774241924285889
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4892055988311768
Epoch: 26, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3967959880828857
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.351 Vali Acc: 0.883 Test Loss: 0.351 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4237923622131348
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.306 Vali Acc: 0.894 Test Loss: 0.306 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 29 cost time: 1.4163818359375
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.332 Vali Acc: 0.883 Test Loss: 0.332 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.481147050857544
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.418715476989746
Epoch: 31, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.385 Vali Acc: 0.872 Test Loss: 0.385 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3382647037506104
Epoch: 32, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.414 Vali Acc: 0.872 Test Loss: 0.414 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3535921573638916
Epoch: 33, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3902719020843506
Epoch: 34, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4799318313598633
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.368 Vali Acc: 0.872 Test Loss: 0.368 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.4606125354766846
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.376 Vali Acc: 0.878 Test Loss: 0.376 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.436988353729248
Epoch: 37, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.381 Vali Acc: 0.883 Test Loss: 0.381 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.163862705230713
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.346 Vali Acc: 0.894 Test Loss: 0.346 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 879734
model size : 13.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7201521396636963
Epoch: 1, Steps: 12 | Train Loss: 1.647 Vali Loss: 0.985 Vali Acc: 0.672 Test Loss: 0.985 Test Acc: 0.672
Validation loss decreased (inf --> -0.672212).  Saving model ...
Epoch: 2 cost time: 1.4178693294525146
Epoch: 2, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.602 Vali Acc: 0.733 Test Loss: 0.602 Test Acc: 0.733
Validation loss decreased (-0.672212 --> -0.733327).  Saving model ...
Epoch: 3 cost time: 1.366603136062622
Epoch: 3, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.464 Vali Acc: 0.767 Test Loss: 0.464 Test Acc: 0.767
Validation loss decreased (-0.733327 --> -0.766662).  Saving model ...
Epoch: 4 cost time: 1.30092453956604
Epoch: 4, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.424 Vali Acc: 0.806 Test Loss: 0.424 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 1.3950939178466797
Epoch: 5, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.641 Vali Acc: 0.778 Test Loss: 0.641 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.405317783355713
Epoch: 6, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 1.4243886470794678
Epoch: 7, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
Validation loss decreased (-0.827774 --> -0.877775).  Saving model ...
Epoch: 8 cost time: 1.3707737922668457
Epoch: 8, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 1.363356113433838
Epoch: 9, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.299436092376709
Epoch: 10, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.539496660232544
Epoch: 11, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.329 Vali Acc: 0.856 Test Loss: 0.329 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2923252582550049
Epoch: 12, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.273115873336792
Epoch: 13, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.288468837738037
Epoch: 14, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3730242252349854
Epoch: 15, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.390 Vali Acc: 0.839 Test Loss: 0.390 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3995656967163086
Epoch: 16, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.310 Vali Acc: 0.894 Test Loss: 0.310 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 1.3721776008605957
Epoch: 17, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.384 Vali Acc: 0.872 Test Loss: 0.384 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2529051303863525
Epoch: 18, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.298 Vali Acc: 0.878 Test Loss: 0.298 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3737401962280273
Epoch: 19, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.427 Vali Acc: 0.856 Test Loss: 0.427 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.285968542098999
Epoch: 20, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.388 Vali Acc: 0.856 Test Loss: 0.388 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2694857120513916
Epoch: 21, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.4385509490966797
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.335545539855957
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.439570665359497
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3583307266235352
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.472 Vali Acc: 0.872 Test Loss: 0.472 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4258816242218018
Epoch: 26, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.404 Vali Acc: 0.878 Test Loss: 0.404 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5574052333831787
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.367 Vali Acc: 0.861 Test Loss: 0.367 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4851562976837158
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.318 Vali Acc: 0.883 Test Loss: 0.318 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4364573955535889
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4518883228302002
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4358696937561035
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.349 Vali Acc: 0.883 Test Loss: 0.349 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 879734
model size : 13.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.061896800994873
Epoch: 1, Steps: 12 | Train Loss: 1.646 Vali Loss: 0.986 Vali Acc: 0.672 Test Loss: 0.986 Test Acc: 0.672
Validation loss decreased (inf --> -0.672212).  Saving model ...
Epoch: 2 cost time: 1.3895933628082275
Epoch: 2, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.591 Vali Acc: 0.744 Test Loss: 0.591 Test Acc: 0.744
Validation loss decreased (-0.672212 --> -0.744439).  Saving model ...
Epoch: 3 cost time: 1.4797358512878418
Epoch: 3, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.454 Vali Acc: 0.767 Test Loss: 0.454 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766662).  Saving model ...
Epoch: 4 cost time: 1.3539843559265137
Epoch: 4, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.411 Vali Acc: 0.822 Test Loss: 0.411 Test Acc: 0.822
Validation loss decreased (-0.766662 --> -0.822218).  Saving model ...
Epoch: 5 cost time: 1.161635160446167
Epoch: 5, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4014794826507568
Epoch: 6, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.330 Vali Acc: 0.833 Test Loss: 0.330 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 1.3856573104858398
Epoch: 7, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
Validation loss decreased (-0.833330 --> -0.883331).  Saving model ...
Epoch: 8 cost time: 1.4516854286193848
Epoch: 8, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.302 Vali Acc: 0.883 Test Loss: 0.302 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4267096519470215
Epoch: 9, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2373404502868652
Epoch: 10, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.277 Vali Acc: 0.867 Test Loss: 0.277 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.278604507446289
Epoch: 11, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.333 Vali Acc: 0.844 Test Loss: 0.333 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2710747718811035
Epoch: 12, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2604069709777832
Epoch: 13, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2418735027313232
Epoch: 14, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.333475112915039
Epoch: 15, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.339 Vali Acc: 0.856 Test Loss: 0.339 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.603135347366333
Epoch: 16, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.3447282314300537
Epoch: 17, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.362 Vali Acc: 0.872 Test Loss: 0.362 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4662771224975586
Epoch: 18, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4603450298309326
Epoch: 19, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.365 Vali Acc: 0.872 Test Loss: 0.365 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4409704208374023
Epoch: 20, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.390 Vali Acc: 0.856 Test Loss: 0.390 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5181851387023926
Epoch: 21, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.313 Vali Acc: 0.894 Test Loss: 0.313 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 22 cost time: 1.3976385593414307
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.493238925933838
Epoch: 23, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 1.5194833278656006
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.296 Vali Acc: 0.894 Test Loss: 0.296 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5277609825134277
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.405 Vali Acc: 0.889 Test Loss: 0.405 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3589770793914795
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3983030319213867
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.318 Vali Acc: 0.894 Test Loss: 0.318 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4032797813415527
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3582401275634766
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.328 Vali Acc: 0.878 Test Loss: 0.328 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5189018249511719
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.322 Vali Acc: 0.883 Test Loss: 0.322 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.324204683303833
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.345 Vali Acc: 0.872 Test Loss: 0.345 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.4308066368103027
Epoch: 32, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3787014484405518
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 879734
model size : 13.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.355888605117798
Epoch: 1, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.006 Vali Acc: 0.706 Test Loss: 1.006 Test Acc: 0.706
Validation loss decreased (inf --> -0.705545).  Saving model ...
Epoch: 2 cost time: 1.3289999961853027
Epoch: 2, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.604 Vali Acc: 0.717 Test Loss: 0.604 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716661).  Saving model ...
Epoch: 3 cost time: 1.3936455249786377
Epoch: 3, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.467 Vali Acc: 0.772 Test Loss: 0.467 Test Acc: 0.772
Validation loss decreased (-0.716661 --> -0.772218).  Saving model ...
Epoch: 4 cost time: 1.3507087230682373
Epoch: 4, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.429 Vali Acc: 0.794 Test Loss: 0.429 Test Acc: 0.794
Validation loss decreased (-0.772218 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 1.3272299766540527
Epoch: 5, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1708431243896484
Epoch: 6, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.360 Vali Acc: 0.800 Test Loss: 0.360 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 1.2863202095031738
Epoch: 7, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.311 Vali Acc: 0.811 Test Loss: 0.311 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811108).  Saving model ...
Epoch: 8 cost time: 1.0493097305297852
Epoch: 8, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
Validation loss decreased (-0.811108 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 1.4202563762664795
Epoch: 9, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3372299671173096
Epoch: 10, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.303 Vali Acc: 0.856 Test Loss: 0.303 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 1.1461224555969238
Epoch: 11, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.213557481765747
Epoch: 12, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.294 Vali Acc: 0.850 Test Loss: 0.294 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5386581420898438
Epoch: 13, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
Validation loss decreased (-0.855553 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 1.2371959686279297
Epoch: 14, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4273738861083984
Epoch: 15, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 1.303797721862793
Epoch: 16, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.344639778137207
Epoch: 17, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3417623043060303
Epoch: 18, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4290432929992676
Epoch: 19, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.408 Vali Acc: 0.856 Test Loss: 0.408 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3804864883422852
Epoch: 20, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.453 Vali Acc: 0.839 Test Loss: 0.453 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.208078145980835
Epoch: 21, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.3420052528381348
Epoch: 22, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5463581085205078
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2978625297546387
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3634669780731201
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.393 Vali Acc: 0.883 Test Loss: 0.393 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.537808895111084
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.408548355102539
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.330 Vali Acc: 0.872 Test Loss: 0.330 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3593788146972656
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.346726417541504
Epoch: 29, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.316 Vali Acc: 0.883 Test Loss: 0.316 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0984387397766113
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4851739406585693
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.349 Vali Acc: 0.878 Test Loss: 0.349 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 879734
model size : 13.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8285012245178223
Epoch: 1, Steps: 12 | Train Loss: 1.481 Vali Loss: 0.934 Vali Acc: 0.650 Test Loss: 0.934 Test Acc: 0.650
Validation loss decreased (inf --> -0.649991).  Saving model ...
Epoch: 2 cost time: 1.3562755584716797
Epoch: 2, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.639 Vali Acc: 0.706 Test Loss: 0.639 Test Acc: 0.706
Validation loss decreased (-0.649991 --> -0.705549).  Saving model ...
Epoch: 3 cost time: 1.1788873672485352
Epoch: 3, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.437 Vali Acc: 0.783 Test Loss: 0.437 Test Acc: 0.783
Validation loss decreased (-0.705549 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 1.2838935852050781
Epoch: 4, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.359 Vali Acc: 0.833 Test Loss: 0.359 Test Acc: 0.833
Validation loss decreased (-0.783329 --> -0.833330).  Saving model ...
Epoch: 5 cost time: 1.1874847412109375
Epoch: 5, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.323 Vali Acc: 0.822 Test Loss: 0.323 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2497777938842773
Epoch: 6, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.307 Vali Acc: 0.872 Test Loss: 0.307 Test Acc: 0.872
Validation loss decreased (-0.833330 --> -0.872219).  Saving model ...
Epoch: 7 cost time: 1.3169851303100586
Epoch: 7, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.334 Vali Acc: 0.828 Test Loss: 0.334 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4796454906463623
Epoch: 8, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.339 Vali Acc: 0.844 Test Loss: 0.339 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4461445808410645
Epoch: 9, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3914480209350586
Epoch: 10, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.528 Vali Acc: 0.806 Test Loss: 0.528 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.433591365814209
Epoch: 11, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.261 Vali Acc: 0.872 Test Loss: 0.261 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872220).  Saving model ...
Epoch: 12 cost time: 1.5622167587280273
Epoch: 12, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883331).  Saving model ...
Epoch: 13 cost time: 1.462212085723877
Epoch: 13, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.419057846069336
Epoch: 14, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 1.4241793155670166
Epoch: 15, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4796628952026367
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.433 Vali Acc: 0.828 Test Loss: 0.433 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.444528341293335
Epoch: 17, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5851755142211914
Epoch: 18, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.387 Vali Acc: 0.878 Test Loss: 0.387 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6146841049194336
Epoch: 19, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.405 Vali Acc: 0.856 Test Loss: 0.405 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5045373439788818
Epoch: 20, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.476 Vali Acc: 0.833 Test Loss: 0.476 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4079921245574951
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.325 Vali Acc: 0.872 Test Loss: 0.325 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3936092853546143
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.397447109222412
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.346 Vali Acc: 0.878 Test Loss: 0.346 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3637268543243408
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.377 Vali Acc: 0.867 Test Loss: 0.377 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 814198
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.234782934188843
Epoch: 1, Steps: 12 | Train Loss: 1.474 Vali Loss: 0.933 Vali Acc: 0.644 Test Loss: 0.933 Test Acc: 0.644
Validation loss decreased (inf --> -0.644435).  Saving model ...
Epoch: 2 cost time: 1.4412140846252441
Epoch: 2, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.630 Vali Acc: 0.717 Test Loss: 0.630 Test Acc: 0.717
Validation loss decreased (-0.644435 --> -0.716660).  Saving model ...
Epoch: 3 cost time: 1.6047396659851074
Epoch: 3, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.431 Vali Acc: 0.783 Test Loss: 0.431 Test Acc: 0.783
Validation loss decreased (-0.716660 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 1.4030327796936035
Epoch: 4, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.354 Vali Acc: 0.828 Test Loss: 0.354 Test Acc: 0.828
Validation loss decreased (-0.783329 --> -0.827774).  Saving model ...
Epoch: 5 cost time: 1.6327502727508545
Epoch: 5, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.322 Vali Acc: 0.817 Test Loss: 0.322 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5511772632598877
Epoch: 6, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
Validation loss decreased (-0.827774 --> -0.877775).  Saving model ...
Epoch: 7 cost time: 1.454387903213501
Epoch: 7, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3148298263549805
Epoch: 8, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5070290565490723
Epoch: 9, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2286221981048584
Epoch: 10, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.513 Vali Acc: 0.822 Test Loss: 0.513 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.287860631942749
Epoch: 11, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.248 Vali Acc: 0.883 Test Loss: 0.248 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 12 cost time: 1.302856206893921
Epoch: 12, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 1.2325706481933594
Epoch: 13, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.418 Vali Acc: 0.856 Test Loss: 0.418 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1651170253753662
Epoch: 14, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 1.2668533325195312
Epoch: 15, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1088802814483643
Epoch: 16, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.382 Vali Acc: 0.850 Test Loss: 0.382 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1707348823547363
Epoch: 17, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.372 Vali Acc: 0.861 Test Loss: 0.372 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4228343963623047
Epoch: 18, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.365 Vali Acc: 0.883 Test Loss: 0.365 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2979583740234375
Epoch: 19, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3765463829040527
Epoch: 20, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.472 Vali Acc: 0.839 Test Loss: 0.472 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2971696853637695
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4532113075256348
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3422341346740723
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4663755893707275
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.343 Vali Acc: 0.878 Test Loss: 0.343 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 814198
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3723855018615723
Epoch: 1, Steps: 12 | Train Loss: 1.481 Vali Loss: 0.926 Vali Acc: 0.656 Test Loss: 0.926 Test Acc: 0.656
Validation loss decreased (inf --> -0.655546).  Saving model ...
Epoch: 2 cost time: 1.1249995231628418
Epoch: 2, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.630 Vali Acc: 0.722 Test Loss: 0.630 Test Acc: 0.722
Validation loss decreased (-0.655546 --> -0.722216).  Saving model ...
Epoch: 3 cost time: 1.4192054271697998
Epoch: 3, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.433 Vali Acc: 0.783 Test Loss: 0.433 Test Acc: 0.783
Validation loss decreased (-0.722216 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 1.2888126373291016
Epoch: 4, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.354 Vali Acc: 0.833 Test Loss: 0.354 Test Acc: 0.833
Validation loss decreased (-0.783329 --> -0.833330).  Saving model ...
Epoch: 5 cost time: 1.2429084777832031
Epoch: 5, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.323 Vali Acc: 0.817 Test Loss: 0.323 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1624631881713867
Epoch: 6, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866664).  Saving model ...
Epoch: 7 cost time: 1.3863012790679932
Epoch: 7, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.320 Vali Acc: 0.828 Test Loss: 0.320 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3788414001464844
Epoch: 8, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3351466655731201
Epoch: 9, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.275 Vali Acc: 0.867 Test Loss: 0.275 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 1.4336419105529785
Epoch: 10, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.532 Vali Acc: 0.806 Test Loss: 0.532 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5218429565429688
Epoch: 11, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 1.5204885005950928
Epoch: 12, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3800644874572754
Epoch: 13, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.368 Vali Acc: 0.861 Test Loss: 0.368 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4090492725372314
Epoch: 14, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4092068672180176
Epoch: 15, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4286365509033203
Epoch: 16, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.337932825088501
Epoch: 17, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.361 Vali Acc: 0.867 Test Loss: 0.361 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4026901721954346
Epoch: 18, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4379515647888184
Epoch: 19, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 1.3150291442871094
Epoch: 20, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4654252529144287
Epoch: 21, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.297926902770996
Epoch: 22, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.352 Vali Acc: 0.878 Test Loss: 0.352 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2765264511108398
Epoch: 23, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4557881355285645
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5510246753692627
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5124356746673584
Epoch: 26, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.329 Vali Acc: 0.894 Test Loss: 0.329 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2860214710235596
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.387 Vali Acc: 0.872 Test Loss: 0.387 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.357109785079956
Epoch: 28, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3255298137664795
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 814198
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7411789894104004
Epoch: 1, Steps: 12 | Train Loss: 1.441 Vali Loss: 0.948 Vali Acc: 0.683 Test Loss: 0.948 Test Acc: 0.683
Validation loss decreased (inf --> -0.683324).  Saving model ...
Epoch: 2 cost time: 1.1357638835906982
Epoch: 2, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.627 Vali Acc: 0.700 Test Loss: 0.627 Test Acc: 0.700
Validation loss decreased (-0.683324 --> -0.699994).  Saving model ...
Epoch: 3 cost time: 1.1262133121490479
Epoch: 3, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.439 Vali Acc: 0.783 Test Loss: 0.439 Test Acc: 0.783
Validation loss decreased (-0.699994 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 1.3525159358978271
Epoch: 4, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.366 Vali Acc: 0.822 Test Loss: 0.366 Test Acc: 0.822
Validation loss decreased (-0.783329 --> -0.822219).  Saving model ...
Epoch: 5 cost time: 1.4016475677490234
Epoch: 5, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.315 Vali Acc: 0.861 Test Loss: 0.315 Test Acc: 0.861
Validation loss decreased (-0.822219 --> -0.861108).  Saving model ...
Epoch: 6 cost time: 1.4067142009735107
Epoch: 6, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 7 cost time: 1.3080744743347168
Epoch: 7, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4183568954467773
Epoch: 8, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 9 cost time: 1.4271926879882812
Epoch: 9, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.267 Vali Acc: 0.872 Test Loss: 0.267 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.527942419052124
Epoch: 10, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2641370296478271
Epoch: 11, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.238 Vali Acc: 0.883 Test Loss: 0.238 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 12 cost time: 1.3680040836334229
Epoch: 12, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 13 cost time: 1.4439663887023926
Epoch: 13, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.347 Vali Acc: 0.872 Test Loss: 0.347 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5139713287353516
Epoch: 14, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 1.3649981021881104
Epoch: 15, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.247 Vali Acc: 0.906 Test Loss: 0.247 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 1.5418734550476074
Epoch: 16, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.362 Vali Acc: 0.844 Test Loss: 0.362 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5241467952728271
Epoch: 17, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.338 Vali Acc: 0.861 Test Loss: 0.338 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4376702308654785
Epoch: 18, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4782946109771729
Epoch: 19, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3229212760925293
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0716683864593506
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3784165382385254
Epoch: 22, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.44175386428833
Epoch: 23, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4084711074829102
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3814334869384766
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.365 Vali Acc: 0.878 Test Loss: 0.365 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 814198
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.637686014175415
Epoch: 1, Steps: 12 | Train Loss: 1.562 Vali Loss: 1.175 Vali Acc: 0.606 Test Loss: 1.175 Test Acc: 0.606
Validation loss decreased (inf --> -0.605544).  Saving model ...
Epoch: 2 cost time: 1.3675341606140137
Epoch: 2, Steps: 12 | Train Loss: 0.886 Vali Loss: 0.686 Vali Acc: 0.694 Test Loss: 0.686 Test Acc: 0.694
Validation loss decreased (-0.605544 --> -0.694438).  Saving model ...
Epoch: 3 cost time: 1.4463646411895752
Epoch: 3, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.525 Vali Acc: 0.744 Test Loss: 0.525 Test Acc: 0.744
Validation loss decreased (-0.694438 --> -0.744439).  Saving model ...
Epoch: 4 cost time: 1.4506525993347168
Epoch: 4, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.439 Vali Acc: 0.783 Test Loss: 0.439 Test Acc: 0.783
Validation loss decreased (-0.744439 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 1.462946891784668
Epoch: 5, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.402 Vali Acc: 0.794 Test Loss: 0.402 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 1.3610548973083496
Epoch: 6, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.396 Vali Acc: 0.811 Test Loss: 0.396 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 1.3785223960876465
Epoch: 7, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.350 Vali Acc: 0.817 Test Loss: 0.350 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.2825627326965332
Epoch: 8, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.316 Vali Acc: 0.833 Test Loss: 0.316 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.2310798168182373
Epoch: 9, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.336 Vali Acc: 0.839 Test Loss: 0.336 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 10 cost time: 1.2520108222961426
Epoch: 10, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.300 Vali Acc: 0.894 Test Loss: 0.300 Test Acc: 0.894
Validation loss decreased (-0.838886 --> -0.894441).  Saving model ...
Epoch: 11 cost time: 1.2647013664245605
Epoch: 11, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1943531036376953
Epoch: 12, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1382665634155273
Epoch: 13, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.369 Vali Acc: 0.822 Test Loss: 0.369 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3665683269500732
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.316988229751587
Epoch: 15, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2560174465179443
Epoch: 16, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0509757995605469
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2590703964233398
Epoch: 18, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.283 Vali Acc: 0.894 Test Loss: 0.283 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.2848834991455078
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3812811374664307
Epoch: 20, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 1.4005820751190186
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.366 Vali Acc: 0.844 Test Loss: 0.366 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3189654350280762
Epoch: 22, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2779288291931152
Epoch: 23, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.374 Vali Acc: 0.861 Test Loss: 0.374 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3018083572387695
Epoch: 24, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.308 Vali Acc: 0.883 Test Loss: 0.308 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2837753295898438
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3481366634368896
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.376 Vali Acc: 0.883 Test Loss: 0.376 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2321412563323975
Epoch: 27, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3436229228973389
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4136252403259277
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5398683547973633
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.365 Vali Acc: 0.861 Test Loss: 0.365 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1291894
model size : 9.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4282805919647217
Epoch: 1, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.179 Vali Acc: 0.606 Test Loss: 1.179 Test Acc: 0.606
Validation loss decreased (inf --> -0.605544).  Saving model ...
Epoch: 2 cost time: 1.0697312355041504
Epoch: 2, Steps: 12 | Train Loss: 0.887 Vali Loss: 0.687 Vali Acc: 0.711 Test Loss: 0.687 Test Acc: 0.711
Validation loss decreased (-0.605544 --> -0.711104).  Saving model ...
Epoch: 3 cost time: 1.2169830799102783
Epoch: 3, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.523 Vali Acc: 0.756 Test Loss: 0.523 Test Acc: 0.756
Validation loss decreased (-0.711104 --> -0.755550).  Saving model ...
Epoch: 4 cost time: 1.078014850616455
Epoch: 4, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.437 Vali Acc: 0.789 Test Loss: 0.437 Test Acc: 0.789
Validation loss decreased (-0.755550 --> -0.788885).  Saving model ...
Epoch: 5 cost time: 1.259446620941162
Epoch: 5, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.401 Vali Acc: 0.794 Test Loss: 0.401 Test Acc: 0.794
Validation loss decreased (-0.788885 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 1.1965231895446777
Epoch: 6, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.396 Vali Acc: 0.800 Test Loss: 0.396 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 1.2790992259979248
Epoch: 7, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822219).  Saving model ...
Epoch: 8 cost time: 1.252842664718628
Epoch: 8, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.315 Vali Acc: 0.822 Test Loss: 0.315 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 9 cost time: 0.9915714263916016
Epoch: 9, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.334 Vali Acc: 0.833 Test Loss: 0.334 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 1.1764323711395264
Epoch: 10, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
Validation loss decreased (-0.833330 --> -0.883330).  Saving model ...
Epoch: 11 cost time: 1.4041223526000977
Epoch: 11, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.363342046737671
Epoch: 12, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2468743324279785
Epoch: 13, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.361 Vali Acc: 0.839 Test Loss: 0.361 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.181058406829834
Epoch: 14, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.285 Vali Acc: 0.856 Test Loss: 0.285 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3263564109802246
Epoch: 15, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5019876956939697
Epoch: 16, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.304349422454834
Epoch: 17, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1001696586608887
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.1156337261199951
Epoch: 19, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1478192806243896
Epoch: 20, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 1.1198623180389404
Epoch: 21, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1014072895050049
Epoch: 22, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0137579441070557
Epoch: 23, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.272843837738037
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3280601501464844
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2727010250091553
Epoch: 26, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.355 Vali Acc: 0.878 Test Loss: 0.355 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4429984092712402
Epoch: 27, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3279929161071777
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.198706865310669
Epoch: 29, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.348 Vali Acc: 0.872 Test Loss: 0.348 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3959336280822754
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1291894
model size : 9.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.916600465774536
Epoch: 1, Steps: 12 | Train Loss: 1.593 Vali Loss: 1.176 Vali Acc: 0.622 Test Loss: 1.176 Test Acc: 0.622
Validation loss decreased (inf --> -0.622210).  Saving model ...
Epoch: 2 cost time: 1.180732250213623
Epoch: 2, Steps: 12 | Train Loss: 0.893 Vali Loss: 0.684 Vali Acc: 0.739 Test Loss: 0.684 Test Acc: 0.739
Validation loss decreased (-0.622210 --> -0.738882).  Saving model ...
Epoch: 3 cost time: 1.098698616027832
Epoch: 3, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.519 Vali Acc: 0.744 Test Loss: 0.519 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744439).  Saving model ...
Epoch: 4 cost time: 1.340388536453247
Epoch: 4, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.430 Vali Acc: 0.772 Test Loss: 0.430 Test Acc: 0.772
Validation loss decreased (-0.744439 --> -0.772218).  Saving model ...
Epoch: 5 cost time: 1.3078949451446533
Epoch: 5, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.386 Vali Acc: 0.806 Test Loss: 0.386 Test Acc: 0.806
Validation loss decreased (-0.772218 --> -0.805552).  Saving model ...
Epoch: 6 cost time: 1.1975550651550293
Epoch: 6, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.380 Vali Acc: 0.806 Test Loss: 0.380 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 7 cost time: 1.2582135200500488
Epoch: 7, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.343 Vali Acc: 0.817 Test Loss: 0.343 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.278543472290039
Epoch: 8, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.302 Vali Acc: 0.839 Test Loss: 0.302 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838886).  Saving model ...
Epoch: 9 cost time: 1.2453014850616455
Epoch: 9, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.317 Vali Acc: 0.833 Test Loss: 0.317 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.220020055770874
Epoch: 10, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
Validation loss decreased (-0.838886 --> -0.894442).  Saving model ...
Epoch: 11 cost time: 1.1321384906768799
Epoch: 11, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.301 Vali Acc: 0.839 Test Loss: 0.301 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3530468940734863
Epoch: 12, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1887240409851074
Epoch: 13, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.351 Vali Acc: 0.828 Test Loss: 0.351 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.190321922302246
Epoch: 14, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.368574857711792
Epoch: 15, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2845327854156494
Epoch: 16, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2160208225250244
Epoch: 17, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3459229469299316
Epoch: 18, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 1.4511399269104004
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3894672393798828
Epoch: 20, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3813493251800537
Epoch: 21, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3893072605133057
Epoch: 22, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 23 cost time: 1.473567008972168
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.315 Vali Acc: 0.878 Test Loss: 0.315 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.37880277633667
Epoch: 24, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4082214832305908
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.353437900543213
Epoch: 26, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.345 Vali Acc: 0.878 Test Loss: 0.345 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.389162302017212
Epoch: 27, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2752485275268555
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1319541931152344
Epoch: 29, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2381222248077393
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.338 Vali Acc: 0.861 Test Loss: 0.338 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2663981914520264
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2272913455963135
Epoch: 32, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 1291894
model size : 9.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7383296489715576
Epoch: 1, Steps: 12 | Train Loss: 1.652 Vali Loss: 1.238 Vali Acc: 0.667 Test Loss: 1.238 Test Acc: 0.667
Validation loss decreased (inf --> -0.666654).  Saving model ...
Epoch: 2 cost time: 1.3078031539916992
Epoch: 2, Steps: 12 | Train Loss: 0.927 Vali Loss: 0.720 Vali Acc: 0.739 Test Loss: 0.720 Test Acc: 0.739
Validation loss decreased (-0.666654 --> -0.738882).  Saving model ...
Epoch: 3 cost time: 1.171048879623413
Epoch: 3, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.546 Vali Acc: 0.744 Test Loss: 0.546 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744439).  Saving model ...
Epoch: 4 cost time: 1.0763204097747803
Epoch: 4, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.444 Vali Acc: 0.772 Test Loss: 0.444 Test Acc: 0.772
Validation loss decreased (-0.744439 --> -0.772218).  Saving model ...
Epoch: 5 cost time: 1.0540366172790527
Epoch: 5, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.392 Vali Acc: 0.811 Test Loss: 0.392 Test Acc: 0.811
Validation loss decreased (-0.772218 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 1.3013343811035156
Epoch: 6, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.389 Vali Acc: 0.806 Test Loss: 0.389 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1848747730255127
Epoch: 7, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.334 Vali Acc: 0.811 Test Loss: 0.334 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811108).  Saving model ...
Epoch: 8 cost time: 1.1041715145111084
Epoch: 8, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
Validation loss decreased (-0.811108 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 1.324173927307129
Epoch: 9, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2521018981933594
Epoch: 10, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
Validation loss decreased (-0.844441 --> -0.911108).  Saving model ...
Epoch: 11 cost time: 1.2763032913208008
Epoch: 11, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.300 Vali Acc: 0.844 Test Loss: 0.300 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2803637981414795
Epoch: 12, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.375084638595581
Epoch: 13, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.336 Vali Acc: 0.828 Test Loss: 0.336 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3622241020202637
Epoch: 14, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3784568309783936
Epoch: 15, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3322052955627441
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.282 Vali Acc: 0.867 Test Loss: 0.282 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4448671340942383
Epoch: 17, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.188150405883789
Epoch: 18, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1231279373168945
Epoch: 19, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.113783836364746
Epoch: 20, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.3611786365509033
Epoch: 21, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.383 Vali Acc: 0.833 Test Loss: 0.383 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.311147689819336
Epoch: 22, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4104697704315186
Epoch: 23, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2682852745056152
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1172714233398438
Epoch: 25, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0835621356964111
Epoch: 26, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.329 Vali Acc: 0.878 Test Loss: 0.329 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.072941780090332
Epoch: 27, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2288751602172852
Epoch: 28, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.356 Vali Acc: 0.872 Test Loss: 0.356 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2344720363616943
Epoch: 29, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.266322374343872
Epoch: 30, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1291894
model size : 9.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.577040910720825
Epoch: 1, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.265 Vali Acc: 0.650 Test Loss: 1.265 Test Acc: 0.650
Validation loss decreased (inf --> -0.649987).  Saving model ...
Epoch: 2 cost time: 1.3981688022613525
Epoch: 2, Steps: 12 | Train Loss: 0.954 Vali Loss: 0.715 Vali Acc: 0.739 Test Loss: 0.715 Test Acc: 0.739
Validation loss decreased (-0.649987 --> -0.738882).  Saving model ...
Epoch: 3 cost time: 1.4650681018829346
Epoch: 3, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.534 Vali Acc: 0.756 Test Loss: 0.534 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755550).  Saving model ...
Epoch: 4 cost time: 1.4844465255737305
Epoch: 4, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.428 Vali Acc: 0.828 Test Loss: 0.428 Test Acc: 0.828
Validation loss decreased (-0.755550 --> -0.827773).  Saving model ...
Epoch: 5 cost time: 1.2034506797790527
Epoch: 5, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.406 Vali Acc: 0.794 Test Loss: 0.406 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3414885997772217
Epoch: 6, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.359 Vali Acc: 0.806 Test Loss: 0.359 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4534366130828857
Epoch: 7, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.394 Vali Acc: 0.833 Test Loss: 0.394 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 1.3349640369415283
Epoch: 8, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.338 Vali Acc: 0.839 Test Loss: 0.338 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838886).  Saving model ...
Epoch: 9 cost time: 1.241832971572876
Epoch: 9, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.325 Vali Acc: 0.850 Test Loss: 0.325 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 1.3314869403839111
Epoch: 10, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 1.3931522369384766
Epoch: 11, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.169543981552124
Epoch: 12, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 1.309091567993164
Epoch: 13, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.321 Vali Acc: 0.872 Test Loss: 0.321 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.250657558441162
Epoch: 14, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3944344520568848
Epoch: 15, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.5133395195007324
Epoch: 16, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4103283882141113
Epoch: 17, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4943280220031738
Epoch: 18, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 19 cost time: 1.5972638130187988
Epoch: 19, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5222790241241455
Epoch: 20, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4389152526855469
Epoch: 21, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 1.4583454132080078
Epoch: 22, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2479043006896973
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.359 Vali Acc: 0.850 Test Loss: 0.359 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2784593105316162
Epoch: 24, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4008903503417969
Epoch: 25, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 1.2639801502227783
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 27 cost time: 1.2602932453155518
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.326 Vali Acc: 0.878 Test Loss: 0.326 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.388303518295288
Epoch: 28, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4294273853302002
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.294633388519287
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.319 Vali Acc: 0.894 Test Loss: 0.319 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4684240818023682
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4432053565979004
Epoch: 32, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.296 Vali Acc: 0.894 Test Loss: 0.296 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.5427350997924805
Epoch: 33, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3752050399780273
Epoch: 34, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.386 Vali Acc: 0.878 Test Loss: 0.386 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2791528701782227
Epoch: 35, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.343 Vali Acc: 0.861 Test Loss: 0.343 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.315666913986206
Epoch: 36, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 767606
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5871660709381104
Epoch: 1, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.273 Vali Acc: 0.606 Test Loss: 1.273 Test Acc: 0.606
Validation loss decreased (inf --> -0.605543).  Saving model ...
Epoch: 2 cost time: 1.1964738368988037
Epoch: 2, Steps: 12 | Train Loss: 0.947 Vali Loss: 0.718 Vali Acc: 0.750 Test Loss: 0.718 Test Acc: 0.750
Validation loss decreased (-0.605543 --> -0.749993).  Saving model ...
Epoch: 3 cost time: 1.209958791732788
Epoch: 3, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.532 Vali Acc: 0.744 Test Loss: 0.532 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2094063758850098
Epoch: 4, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.430 Vali Acc: 0.822 Test Loss: 0.430 Test Acc: 0.822
Validation loss decreased (-0.749993 --> -0.822218).  Saving model ...
Epoch: 5 cost time: 1.306626796722412
Epoch: 5, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.410 Vali Acc: 0.794 Test Loss: 0.410 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2566797733306885
Epoch: 6, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.359 Vali Acc: 0.806 Test Loss: 0.359 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.255366563796997
Epoch: 7, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.393 Vali Acc: 0.828 Test Loss: 0.393 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 1.2443783283233643
Epoch: 8, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.337 Vali Acc: 0.833 Test Loss: 0.337 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.183305025100708
Epoch: 9, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 1.0036215782165527
Epoch: 10, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.302 Vali Acc: 0.839 Test Loss: 0.302 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3038053512573242
Epoch: 11, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1772418022155762
Epoch: 12, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
Validation loss decreased (-0.849997 --> -0.899997).  Saving model ...
Epoch: 13 cost time: 1.0598151683807373
Epoch: 13, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.152212381362915
Epoch: 14, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2322945594787598
Epoch: 15, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3075628280639648
Epoch: 16, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.277 Vali Acc: 0.867 Test Loss: 0.277 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1907768249511719
Epoch: 17, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3020339012145996
Epoch: 18, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.300 Vali Acc: 0.894 Test Loss: 0.300 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0663950443267822
Epoch: 19, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.37446928024292
Epoch: 20, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2238171100616455
Epoch: 21, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2393693923950195
Epoch: 22, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 767606
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8702571392059326
Epoch: 1, Steps: 12 | Train Loss: 1.672 Vali Loss: 1.249 Vali Acc: 0.622 Test Loss: 1.249 Test Acc: 0.622
Validation loss decreased (inf --> -0.622210).  Saving model ...
Epoch: 2 cost time: 1.4008166790008545
Epoch: 2, Steps: 12 | Train Loss: 0.941 Vali Loss: 0.706 Vali Acc: 0.728 Test Loss: 0.706 Test Acc: 0.728
Validation loss decreased (-0.622210 --> -0.727771).  Saving model ...
Epoch: 3 cost time: 1.1799407005310059
Epoch: 3, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.523 Vali Acc: 0.756 Test Loss: 0.523 Test Acc: 0.756
Validation loss decreased (-0.727771 --> -0.755550).  Saving model ...
Epoch: 4 cost time: 1.2850558757781982
Epoch: 4, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.415 Vali Acc: 0.839 Test Loss: 0.415 Test Acc: 0.839
Validation loss decreased (-0.755550 --> -0.838885).  Saving model ...
Epoch: 5 cost time: 1.2673771381378174
Epoch: 5, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.394 Vali Acc: 0.794 Test Loss: 0.394 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0110411643981934
Epoch: 6, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.355 Vali Acc: 0.806 Test Loss: 0.355 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2828691005706787
Epoch: 7, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.396 Vali Acc: 0.828 Test Loss: 0.396 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2792563438415527
Epoch: 8, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2350270748138428
Epoch: 9, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.309 Vali Acc: 0.833 Test Loss: 0.309 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.196692705154419
Epoch: 10, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.285 Vali Acc: 0.856 Test Loss: 0.285 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 1.1630234718322754
Epoch: 11, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.336 Vali Acc: 0.817 Test Loss: 0.336 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3497028350830078
Epoch: 12, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.855553 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 1.2776038646697998
Epoch: 13, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0682604312896729
Epoch: 14, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2187471389770508
Epoch: 15, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2706716060638428
Epoch: 16, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2564857006072998
Epoch: 17, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.309 Vali Acc: 0.844 Test Loss: 0.309 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2191312313079834
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.3024520874023438
Epoch: 19, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1666433811187744
Epoch: 20, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3206803798675537
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 1.3389291763305664
Epoch: 22, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3338806629180908
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.344 Vali Acc: 0.850 Test Loss: 0.344 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2120778560638428
Epoch: 24, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0927128791809082
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 1.2980053424835205
Epoch: 26, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4107859134674072
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2250449657440186
Epoch: 28, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2182667255401611
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.287 Vali Acc: 0.894 Test Loss: 0.287 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3374629020690918
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 31 cost time: 1.2553300857543945
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3711628913879395
Epoch: 32, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1033494472503662
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2395246028900146
Epoch: 34, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.353 Vali Acc: 0.894 Test Loss: 0.353 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2187769412994385
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2221789360046387
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3237271308898926
Epoch: 37, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.338 Vali Acc: 0.894 Test Loss: 0.338 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.215193748474121
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.298 Vali Acc: 0.911 Test Loss: 0.298 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0742387771606445
Epoch: 39, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.328 Vali Acc: 0.894 Test Loss: 0.328 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.2224576473236084
Epoch: 40, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.313 Vali Acc: 0.911 Test Loss: 0.313 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 767606
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.624387741088867
Epoch: 1, Steps: 12 | Train Loss: 1.694 Vali Loss: 1.289 Vali Acc: 0.633 Test Loss: 1.289 Test Acc: 0.633
Validation loss decreased (inf --> -0.633320).  Saving model ...
Epoch: 2 cost time: 1.0690715312957764
Epoch: 2, Steps: 12 | Train Loss: 0.981 Vali Loss: 0.741 Vali Acc: 0.728 Test Loss: 0.741 Test Acc: 0.728
Validation loss decreased (-0.633320 --> -0.727770).  Saving model ...
Epoch: 3 cost time: 1.0980489253997803
Epoch: 3, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.551 Vali Acc: 0.744 Test Loss: 0.551 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744439).  Saving model ...
Epoch: 4 cost time: 1.0724222660064697
Epoch: 4, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.436 Vali Acc: 0.817 Test Loss: 0.436 Test Acc: 0.817
Validation loss decreased (-0.744439 --> -0.816662).  Saving model ...
Epoch: 5 cost time: 1.1145834922790527
Epoch: 5, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.405 Vali Acc: 0.778 Test Loss: 0.405 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2316703796386719
Epoch: 6, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.379 Vali Acc: 0.806 Test Loss: 0.379 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2813758850097656
Epoch: 7, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.432 Vali Acc: 0.811 Test Loss: 0.432 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2609078884124756
Epoch: 8, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 1.3080055713653564
Epoch: 9, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.330 Vali Acc: 0.817 Test Loss: 0.330 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3074617385864258
Epoch: 10, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.300 Vali Acc: 0.844 Test Loss: 0.300 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 1.4189436435699463
Epoch: 11, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.369 Vali Acc: 0.806 Test Loss: 0.369 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.356795072555542
Epoch: 12, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
Validation loss decreased (-0.844441 --> -0.905553).  Saving model ...
Epoch: 13 cost time: 1.3417601585388184
Epoch: 13, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.302 Vali Acc: 0.844 Test Loss: 0.302 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3560762405395508
Epoch: 14, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4052960872650146
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3878586292266846
Epoch: 16, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.275 Vali Acc: 0.856 Test Loss: 0.275 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3477628231048584
Epoch: 17, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.303 Vali Acc: 0.856 Test Loss: 0.303 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3377974033355713
Epoch: 18, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 1.271489143371582
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3846018314361572
Epoch: 20, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4081785678863525
Epoch: 21, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3071322441101074
Epoch: 22, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3461723327636719
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.414 Vali Acc: 0.844 Test Loss: 0.414 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3591499328613281
Epoch: 24, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2257046699523926
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 26 cost time: 1.2801671028137207
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2471072673797607
Epoch: 27, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.310 Vali Acc: 0.894 Test Loss: 0.310 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.24649977684021
Epoch: 28, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3117995262145996
Epoch: 29, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.131406307220459
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.310720443725586
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3018217086791992
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2090678215026855
Epoch: 33, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.517 Vali Acc: 0.856 Test Loss: 0.517 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.125565528869629
Epoch: 34, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1362380981445312
Epoch: 35, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 767606
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.946747303009033
Epoch: 1, Steps: 12 | Train Loss: 1.592 Vali Loss: 1.222 Vali Acc: 0.539 Test Loss: 1.222 Test Acc: 0.539
Validation loss decreased (inf --> -0.538877).  Saving model ...
Epoch: 2 cost time: 1.3089768886566162
Epoch: 2, Steps: 12 | Train Loss: 0.958 Vali Loss: 0.729 Vali Acc: 0.678 Test Loss: 0.729 Test Acc: 0.678
Validation loss decreased (-0.538877 --> -0.677770).  Saving model ...
Epoch: 3 cost time: 1.0945453643798828
Epoch: 3, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.557 Vali Acc: 0.711 Test Loss: 0.557 Test Acc: 0.711
Validation loss decreased (-0.677770 --> -0.711106).  Saving model ...
Epoch: 4 cost time: 1.050110101699829
Epoch: 4, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.440 Vali Acc: 0.800 Test Loss: 0.440 Test Acc: 0.800
Validation loss decreased (-0.711106 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 1.309178113937378
Epoch: 5, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.393 Vali Acc: 0.794 Test Loss: 0.393 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1996278762817383
Epoch: 6, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.355 Vali Acc: 0.817 Test Loss: 0.355 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 1.2529258728027344
Epoch: 7, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.333 Vali Acc: 0.844 Test Loss: 0.333 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 1.3183224201202393
Epoch: 8, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.390 Vali Acc: 0.794 Test Loss: 0.390 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.445375680923462
Epoch: 9, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.395 Vali Acc: 0.811 Test Loss: 0.395 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3197002410888672
Epoch: 10, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.321 Vali Acc: 0.883 Test Loss: 0.321 Test Acc: 0.883
Validation loss decreased (-0.844441 --> -0.883330).  Saving model ...
Epoch: 11 cost time: 1.2366321086883545
Epoch: 11, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3261053562164307
Epoch: 12, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.343 Vali Acc: 0.844 Test Loss: 0.343 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.316760778427124
Epoch: 13, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.306 Vali Acc: 0.844 Test Loss: 0.306 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3162658214569092
Epoch: 14, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4021921157836914
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.349193811416626
Epoch: 16, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.303 Vali Acc: 0.883 Test Loss: 0.303 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1908693313598633
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2951037883758545
Epoch: 18, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.307 Vali Acc: 0.872 Test Loss: 0.307 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1561520099639893
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1453735828399658
Epoch: 20, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2563390731811523
Epoch: 21, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.393587589263916
Epoch: 22, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 1.2999303340911865
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 1.2796852588653564
Epoch: 24, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 1.2928829193115234
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.293 Vali Acc: 0.894 Test Loss: 0.293 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.345529317855835
Epoch: 26, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.318603515625
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2949764728546143
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.330 Vali Acc: 0.872 Test Loss: 0.330 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4068894386291504
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.316 Vali Acc: 0.878 Test Loss: 0.316 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.356065034866333
Epoch: 30, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.307464361190796
Epoch: 31, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 32 cost time: 1.2909932136535645
Epoch: 32, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2430894374847412
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 34 cost time: 1.3316385746002197
Epoch: 34, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.301 Vali Acc: 0.894 Test Loss: 0.301 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2115027904510498
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2234411239624023
Epoch: 36, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.364 Vali Acc: 0.883 Test Loss: 0.364 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3363876342773438
Epoch: 37, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.316 Vali Acc: 0.894 Test Loss: 0.316 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2893495559692383
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2401087284088135
Epoch: 39, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.392 Vali Acc: 0.878 Test Loss: 0.392 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2835609912872314
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.385 Vali Acc: 0.889 Test Loss: 0.385 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2679944038391113
Epoch: 41, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.3987703323364258
Epoch: 42, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.367 Vali Acc: 0.867 Test Loss: 0.367 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4688806533813477
Epoch: 43, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.347 Vali Acc: 0.894 Test Loss: 0.347 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 505462
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0531060695648193
Epoch: 1, Steps: 12 | Train Loss: 1.588 Vali Loss: 1.223 Vali Acc: 0.539 Test Loss: 1.223 Test Acc: 0.539
Validation loss decreased (inf --> -0.538877).  Saving model ...
Epoch: 2 cost time: 1.2442045211791992
Epoch: 2, Steps: 12 | Train Loss: 0.954 Vali Loss: 0.725 Vali Acc: 0.700 Test Loss: 0.725 Test Acc: 0.700
Validation loss decreased (-0.538877 --> -0.699993).  Saving model ...
Epoch: 3 cost time: 1.2339515686035156
Epoch: 3, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.555 Vali Acc: 0.711 Test Loss: 0.555 Test Acc: 0.711
Validation loss decreased (-0.699993 --> -0.711106).  Saving model ...
Epoch: 4 cost time: 1.1862564086914062
Epoch: 4, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.437 Vali Acc: 0.800 Test Loss: 0.437 Test Acc: 0.800
Validation loss decreased (-0.711106 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 1.397824764251709
Epoch: 5, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.382 Vali Acc: 0.817 Test Loss: 0.382 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 1.3906490802764893
Epoch: 6, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.350 Vali Acc: 0.828 Test Loss: 0.350 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 1.329772710800171
Epoch: 7, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 8 cost time: 1.353926181793213
Epoch: 8, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.384 Vali Acc: 0.800 Test Loss: 0.384 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3397037982940674
Epoch: 9, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.398 Vali Acc: 0.811 Test Loss: 0.398 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4515972137451172
Epoch: 10, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.313 Vali Acc: 0.872 Test Loss: 0.313 Test Acc: 0.872
Validation loss decreased (-0.838886 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 1.3555424213409424
Epoch: 11, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 1.299055576324463
Epoch: 12, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.284696102142334
Epoch: 13, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.303 Vali Acc: 0.844 Test Loss: 0.303 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.383937120437622
Epoch: 14, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2884409427642822
Epoch: 15, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 1.2765331268310547
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.388019323348999
Epoch: 17, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.391 Vali Acc: 0.856 Test Loss: 0.391 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3833529949188232
Epoch: 18, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2897825241088867
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2008373737335205
Epoch: 20, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4181251525878906
Epoch: 21, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3190078735351562
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 1.2880473136901855
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 1.35463547706604
Epoch: 24, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2698500156402588
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2997040748596191
Epoch: 26, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2850024700164795
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2233960628509521
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3097739219665527
Epoch: 29, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3452250957489014
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2524452209472656
Epoch: 31, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2798383235931396
Epoch: 32, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.2525575160980225
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.2670528888702393
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2080094814300537
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2431535720825195
Epoch: 36, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.333 Vali Acc: 0.883 Test Loss: 0.333 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2185425758361816
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2973480224609375
Epoch: 38, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2766141891479492
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.369 Vali Acc: 0.878 Test Loss: 0.369 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2045154571533203
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.350 Vali Acc: 0.883 Test Loss: 0.350 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2327790260314941
Epoch: 41, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.3166136741638184
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.331 Vali Acc: 0.894 Test Loss: 0.331 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3156096935272217
Epoch: 43, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.347 Vali Acc: 0.894 Test Loss: 0.347 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 505462
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7028489112854004
Epoch: 1, Steps: 12 | Train Loss: 1.615 Vali Loss: 1.235 Vali Acc: 0.561 Test Loss: 1.235 Test Acc: 0.561
Validation loss decreased (inf --> -0.561099).  Saving model ...
Epoch: 2 cost time: 1.369579553604126
Epoch: 2, Steps: 12 | Train Loss: 0.957 Vali Loss: 0.729 Vali Acc: 0.689 Test Loss: 0.729 Test Acc: 0.689
Validation loss decreased (-0.561099 --> -0.688882).  Saving model ...
Epoch: 3 cost time: 1.4172346591949463
Epoch: 3, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.559 Vali Acc: 0.728 Test Loss: 0.559 Test Acc: 0.728
Validation loss decreased (-0.688882 --> -0.727772).  Saving model ...
Epoch: 4 cost time: 1.363206386566162
Epoch: 4, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.435 Vali Acc: 0.800 Test Loss: 0.435 Test Acc: 0.800
Validation loss decreased (-0.727772 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 1.3751921653747559
Epoch: 5, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.378 Vali Acc: 0.817 Test Loss: 0.378 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 1.2622454166412354
Epoch: 6, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.347 Vali Acc: 0.822 Test Loss: 0.347 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 1.3111598491668701
Epoch: 7, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.319 Vali Acc: 0.828 Test Loss: 0.319 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827775).  Saving model ...
Epoch: 8 cost time: 1.3247690200805664
Epoch: 8, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.380 Vali Acc: 0.800 Test Loss: 0.380 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2348661422729492
Epoch: 9, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.378 Vali Acc: 0.806 Test Loss: 0.378 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2535250186920166
Epoch: 10, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
Validation loss decreased (-0.827775 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 1.192323923110962
Epoch: 11, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 12 cost time: 1.2122976779937744
Epoch: 12, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1720290184020996
Epoch: 13, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.289 Vali Acc: 0.839 Test Loss: 0.289 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4738974571228027
Epoch: 14, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.47300386428833
Epoch: 15, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1517374515533447
Epoch: 16, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2718651294708252
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.199960470199585
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4023017883300781
Epoch: 19, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2989778518676758
Epoch: 20, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2592828273773193
Epoch: 21, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 505462
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.64581561088562
Epoch: 1, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.270 Vali Acc: 0.572 Test Loss: 1.270 Test Acc: 0.572
Validation loss decreased (inf --> -0.572210).  Saving model ...
Epoch: 2 cost time: 1.1734943389892578
Epoch: 2, Steps: 12 | Train Loss: 0.980 Vali Loss: 0.758 Vali Acc: 0.694 Test Loss: 0.758 Test Acc: 0.694
Validation loss decreased (-0.572210 --> -0.694437).  Saving model ...
Epoch: 3 cost time: 1.3108117580413818
Epoch: 3, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.584 Vali Acc: 0.711 Test Loss: 0.584 Test Acc: 0.711
Validation loss decreased (-0.694437 --> -0.711105).  Saving model ...
Epoch: 4 cost time: 1.2830288410186768
Epoch: 4, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.451 Vali Acc: 0.806 Test Loss: 0.451 Test Acc: 0.806
Validation loss decreased (-0.711105 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 1.2690157890319824
Epoch: 5, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.397 Vali Acc: 0.794 Test Loss: 0.397 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.220470905303955
Epoch: 6, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.360 Vali Acc: 0.811 Test Loss: 0.360 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811108).  Saving model ...
Epoch: 7 cost time: 1.256460428237915
Epoch: 7, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.327 Vali Acc: 0.872 Test Loss: 0.327 Test Acc: 0.872
Validation loss decreased (-0.811108 --> -0.872219).  Saving model ...
Epoch: 8 cost time: 1.1975460052490234
Epoch: 8, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.381 Vali Acc: 0.783 Test Loss: 0.381 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.376950740814209
Epoch: 9, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.417 Vali Acc: 0.794 Test Loss: 0.417 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9563007354736328
Epoch: 10, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.310 Vali Acc: 0.872 Test Loss: 0.310 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 1.2486648559570312
Epoch: 11, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.296 Vali Acc: 0.850 Test Loss: 0.296 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2582736015319824
Epoch: 12, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.334 Vali Acc: 0.822 Test Loss: 0.334 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2573540210723877
Epoch: 13, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.295 Vali Acc: 0.833 Test Loss: 0.295 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.125183343887329
Epoch: 14, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.298 Vali Acc: 0.833 Test Loss: 0.298 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0749523639678955
Epoch: 15, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2755236625671387
Epoch: 16, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 1.2790770530700684
Epoch: 17, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.360 Vali Acc: 0.822 Test Loss: 0.360 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0655741691589355
Epoch: 18, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1676156520843506
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1693809032440186
Epoch: 20, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.323 Vali Acc: 0.839 Test Loss: 0.323 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.488818883895874
Epoch: 21, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0405044555664062
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0730791091918945
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2072091102600098
Epoch: 24, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3009181022644043
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1692347526550293
Epoch: 26, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.291 Vali Acc: 0.844 Test Loss: 0.291 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 505462
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5509047508239746
Epoch: 1, Steps: 12 | Train Loss: 1.569 Vali Loss: 1.144 Vali Acc: 0.672 Test Loss: 1.144 Test Acc: 0.672
Validation loss decreased (inf --> -0.672211).  Saving model ...
Epoch: 2 cost time: 1.3639841079711914
Epoch: 2, Steps: 12 | Train Loss: 0.940 Vali Loss: 0.713 Vali Acc: 0.700 Test Loss: 0.713 Test Acc: 0.700
Validation loss decreased (-0.672211 --> -0.699993).  Saving model ...
Epoch: 3 cost time: 1.3777580261230469
Epoch: 3, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.513 Vali Acc: 0.750 Test Loss: 0.513 Test Acc: 0.750
Validation loss decreased (-0.699993 --> -0.749995).  Saving model ...
Epoch: 4 cost time: 1.3384501934051514
Epoch: 4, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.424 Vali Acc: 0.800 Test Loss: 0.424 Test Acc: 0.800
Validation loss decreased (-0.749995 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 1.1716716289520264
Epoch: 5, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.394 Vali Acc: 0.806 Test Loss: 0.394 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 6 cost time: 1.2016186714172363
Epoch: 6, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.344 Vali Acc: 0.844 Test Loss: 0.344 Test Acc: 0.844
Validation loss decreased (-0.805552 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 1.206904649734497
Epoch: 7, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2158308029174805
Epoch: 8, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
Validation loss decreased (-0.844441 --> -0.877775).  Saving model ...
Epoch: 9 cost time: 1.1874792575836182
Epoch: 9, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0668003559112549
Epoch: 10, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 1.1992626190185547
Epoch: 11, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1796584129333496
Epoch: 12, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1111111640930176
Epoch: 13, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2175631523132324
Epoch: 14, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2827227115631104
Epoch: 15, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 1.209773063659668
Epoch: 16, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.338 Vali Acc: 0.828 Test Loss: 0.338 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2455835342407227
Epoch: 17, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.306 Vali Acc: 0.867 Test Loss: 0.306 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.231929063796997
Epoch: 18, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1844964027404785
Epoch: 19, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.174858570098877
Epoch: 20, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1484718322753906
Epoch: 21, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.398 Vali Acc: 0.867 Test Loss: 0.398 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2230727672576904
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.276336431503296
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2048530578613281
Epoch: 24, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.195329189300537
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 374390
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.512162923812866
Epoch: 1, Steps: 12 | Train Loss: 1.565 Vali Loss: 1.143 Vali Acc: 0.689 Test Loss: 1.143 Test Acc: 0.689
Validation loss decreased (inf --> -0.688877).  Saving model ...
Epoch: 2 cost time: 1.224475622177124
Epoch: 2, Steps: 12 | Train Loss: 0.929 Vali Loss: 0.708 Vali Acc: 0.700 Test Loss: 0.708 Test Acc: 0.700
Validation loss decreased (-0.688877 --> -0.699993).  Saving model ...
Epoch: 3 cost time: 1.1945934295654297
Epoch: 3, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.507 Vali Acc: 0.750 Test Loss: 0.507 Test Acc: 0.750
Validation loss decreased (-0.699993 --> -0.749995).  Saving model ...
Epoch: 4 cost time: 1.251922845840454
Epoch: 4, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.418 Vali Acc: 0.800 Test Loss: 0.418 Test Acc: 0.800
Validation loss decreased (-0.749995 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 1.198624849319458
Epoch: 5, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.390 Vali Acc: 0.822 Test Loss: 0.390 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 6 cost time: 1.2623405456542969
Epoch: 6, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849997).  Saving model ...
Epoch: 7 cost time: 1.2053983211517334
Epoch: 7, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.323 Vali Acc: 0.817 Test Loss: 0.323 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1745266914367676
Epoch: 8, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 9 cost time: 1.1707441806793213
Epoch: 9, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1754138469696045
Epoch: 10, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 11 cost time: 1.2707149982452393
Epoch: 11, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.308619499206543
Epoch: 12, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2642855644226074
Epoch: 13, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2486555576324463
Epoch: 14, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.331730842590332
Epoch: 15, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 1.2595205307006836
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.315 Vali Acc: 0.844 Test Loss: 0.315 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.19614839553833
Epoch: 17, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3205647468566895
Epoch: 18, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2630069255828857
Epoch: 19, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1780433654785156
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2722277641296387
Epoch: 21, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.409 Vali Acc: 0.867 Test Loss: 0.409 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1897914409637451
Epoch: 22, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 1.21980881690979
Epoch: 23, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.297 Vali Acc: 0.894 Test Loss: 0.297 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3389461040496826
Epoch: 24, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2533698081970215
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2643110752105713
Epoch: 26, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2158243656158447
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2267858982086182
Epoch: 28, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2180113792419434
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.353 Vali Acc: 0.883 Test Loss: 0.353 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.416041612625122
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2597589492797852
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1921777725219727
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 374390
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.561995029449463
Epoch: 1, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.141 Vali Acc: 0.722 Test Loss: 1.141 Test Acc: 0.722
Validation loss decreased (inf --> -0.722211).  Saving model ...
Epoch: 2 cost time: 1.5102617740631104
Epoch: 2, Steps: 12 | Train Loss: 0.935 Vali Loss: 0.696 Vali Acc: 0.722 Test Loss: 0.696 Test Acc: 0.722
Validation loss decreased (-0.722211 --> -0.722215).  Saving model ...
Epoch: 3 cost time: 1.2635893821716309
Epoch: 3, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.497 Vali Acc: 0.772 Test Loss: 0.497 Test Acc: 0.772
Validation loss decreased (-0.722215 --> -0.772217).  Saving model ...
Epoch: 4 cost time: 1.3635435104370117
Epoch: 4, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.406 Vali Acc: 0.811 Test Loss: 0.406 Test Acc: 0.811
Validation loss decreased (-0.772217 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 1.1764369010925293
Epoch: 5, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.379 Vali Acc: 0.828 Test Loss: 0.379 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 1.157533884048462
Epoch: 6, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 1.157066822052002
Epoch: 7, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.320 Vali Acc: 0.833 Test Loss: 0.320 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1584315299987793
Epoch: 8, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
Validation loss decreased (-0.844441 --> -0.899997).  Saving model ...
Epoch: 9 cost time: 1.0640363693237305
Epoch: 9, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.302 Vali Acc: 0.833 Test Loss: 0.302 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2293012142181396
Epoch: 10, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3403472900390625
Epoch: 11, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.282 Vali Acc: 0.850 Test Loss: 0.282 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2487895488739014
Epoch: 12, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1515047550201416
Epoch: 13, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3414041996002197
Epoch: 14, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.280 Vali Acc: 0.856 Test Loss: 0.280 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2912535667419434
Epoch: 15, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 1.3381528854370117
Epoch: 16, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.322 Vali Acc: 0.833 Test Loss: 0.322 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3495399951934814
Epoch: 17, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.368420124053955
Epoch: 18, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3991048336029053
Epoch: 19, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3943676948547363
Epoch: 20, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5089449882507324
Epoch: 21, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4026198387145996
Epoch: 22, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 1.3879587650299072
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3562994003295898
Epoch: 24, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.503082036972046
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 1.5307490825653076
Epoch: 26, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4620139598846436
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.367582082748413
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2737886905670166
Epoch: 29, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.358 Vali Acc: 0.878 Test Loss: 0.358 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.44498610496521
Epoch: 30, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2921538352966309
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.308 Vali Acc: 0.883 Test Loss: 0.308 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3192598819732666
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1748626232147217
Epoch: 33, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.283 Vali Acc: 0.894 Test Loss: 0.283 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3613653182983398
Epoch: 34, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3192377090454102
Epoch: 35, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 36 cost time: 1.320063591003418
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.351 Vali Acc: 0.872 Test Loss: 0.351 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2386140823364258
Epoch: 37, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.317 Vali Acc: 0.883 Test Loss: 0.317 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4374024868011475
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.315063238143921
Epoch: 39, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3088657855987549
Epoch: 40, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4777603149414062
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.335 Vali Acc: 0.878 Test Loss: 0.335 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4146592617034912
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2052631378173828
Epoch: 43, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.348 Vali Acc: 0.878 Test Loss: 0.348 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0989618301391602
Epoch: 44, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.354 Vali Acc: 0.867 Test Loss: 0.354 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.2526073455810547
Epoch: 45, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.3269319534301758
Epoch: 46, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.396 Vali Acc: 0.872 Test Loss: 0.396 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.1938345432281494
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.333 Vali Acc: 0.878 Test Loss: 0.333 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.2808332443237305
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 374390
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.390002489089966
Epoch: 1, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.204 Vali Acc: 0.672 Test Loss: 1.204 Test Acc: 0.672
Validation loss decreased (inf --> -0.672210).  Saving model ...
Epoch: 2 cost time: 1.3477284908294678
Epoch: 2, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.746 Vali Acc: 0.700 Test Loss: 0.746 Test Acc: 0.700
Validation loss decreased (-0.672210 --> -0.699993).  Saving model ...
Epoch: 3 cost time: 1.2786016464233398
Epoch: 3, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.536 Vali Acc: 0.756 Test Loss: 0.536 Test Acc: 0.756
Validation loss decreased (-0.699993 --> -0.755550).  Saving model ...
Epoch: 4 cost time: 1.3372037410736084
Epoch: 4, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.432 Vali Acc: 0.822 Test Loss: 0.432 Test Acc: 0.822
Validation loss decreased (-0.755550 --> -0.822218).  Saving model ...
Epoch: 5 cost time: 1.251465082168579
Epoch: 5, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849996).  Saving model ...
Epoch: 6 cost time: 1.2439837455749512
Epoch: 6, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.343 Vali Acc: 0.844 Test Loss: 0.343 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3191759586334229
Epoch: 7, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.330 Vali Acc: 0.833 Test Loss: 0.330 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2286021709442139
Epoch: 8, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
Validation loss decreased (-0.849996 --> -0.899997).  Saving model ...
Epoch: 9 cost time: 1.2429234981536865
Epoch: 9, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0892887115478516
Epoch: 10, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0481243133544922
Epoch: 11, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.272 Vali Acc: 0.861 Test Loss: 0.272 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0713567733764648
Epoch: 12, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1603667736053467
Epoch: 13, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.301 Vali Acc: 0.844 Test Loss: 0.301 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1750853061676025
Epoch: 14, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.282 Vali Acc: 0.861 Test Loss: 0.282 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3312466144561768
Epoch: 15, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 1.2728137969970703
Epoch: 16, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.352 Vali Acc: 0.811 Test Loss: 0.352 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.267012119293213
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.332 Vali Acc: 0.822 Test Loss: 0.332 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3156874179840088
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.276 Vali Acc: 0.850 Test Loss: 0.276 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2137863636016846
Epoch: 19, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 1.2336506843566895
Epoch: 20, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.308 Vali Acc: 0.839 Test Loss: 0.308 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2904644012451172
Epoch: 21, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2048425674438477
Epoch: 22, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9717898368835449
Epoch: 23, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 0.948145866394043
Epoch: 24, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.193016767501831
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1572463512420654
Epoch: 26, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.266890048980713
Epoch: 27, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.253 Vali Acc: 0.894 Test Loss: 0.253 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.37022066116333
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.195838451385498
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.465 Vali Acc: 0.839 Test Loss: 0.465 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2867026329040527
Epoch: 30, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.331 Vali Acc: 0.872 Test Loss: 0.331 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1577911376953125
Epoch: 31, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.353 Vali Acc: 0.850 Test Loss: 0.353 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3539412021636963
Epoch: 32, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3080625534057617
Epoch: 33, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 374390
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.910923719406128
Epoch: 1, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.313 Vali Acc: 0.533 Test Loss: 1.313 Test Acc: 0.533
Validation loss decreased (inf --> -0.533320).  Saving model ...
Epoch: 2 cost time: 1.0987067222595215
Epoch: 2, Steps: 12 | Train Loss: 0.996 Vali Loss: 0.742 Vali Acc: 0.678 Test Loss: 0.742 Test Acc: 0.678
Validation loss decreased (-0.533320 --> -0.677770).  Saving model ...
Epoch: 3 cost time: 1.3066532611846924
Epoch: 3, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.572 Vali Acc: 0.728 Test Loss: 0.572 Test Acc: 0.728
Validation loss decreased (-0.677770 --> -0.727772).  Saving model ...
Epoch: 4 cost time: 1.3793573379516602
Epoch: 4, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.471 Vali Acc: 0.761 Test Loss: 0.471 Test Acc: 0.761
Validation loss decreased (-0.727772 --> -0.761106).  Saving model ...
Epoch: 5 cost time: 1.0575299263000488
Epoch: 5, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.388 Vali Acc: 0.833 Test Loss: 0.388 Test Acc: 0.833
Validation loss decreased (-0.761106 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 1.2306616306304932
Epoch: 6, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.374 Vali Acc: 0.828 Test Loss: 0.374 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.308152675628662
Epoch: 7, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.348 Vali Acc: 0.856 Test Loss: 0.348 Test Acc: 0.856
Validation loss decreased (-0.833329 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 1.3276972770690918
Epoch: 8, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.360 Vali Acc: 0.828 Test Loss: 0.360 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1883115768432617
Epoch: 9, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.341 Vali Acc: 0.856 Test Loss: 0.341 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 1.1642615795135498
Epoch: 10, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 1.498558521270752
Epoch: 11, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4141616821289062
Epoch: 12, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.388 Vali Acc: 0.822 Test Loss: 0.388 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3622515201568604
Epoch: 13, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.296 Vali Acc: 0.850 Test Loss: 0.296 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.384429693222046
Epoch: 14, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.355 Vali Acc: 0.839 Test Loss: 0.355 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4804377555847168
Epoch: 15, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.855553 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 1.3725214004516602
Epoch: 16, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4418063163757324
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3013455867767334
Epoch: 18, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2905189990997314
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.403355360031128
Epoch: 20, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2483980655670166
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.260345220565796
Epoch: 22, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.39463210105896
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.316 Vali Acc: 0.883 Test Loss: 0.316 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4246344566345215
Epoch: 24, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.375 Vali Acc: 0.867 Test Loss: 0.375 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.404587984085083
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.313 Vali Acc: 0.883 Test Loss: 0.313 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 308854
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.979823350906372
Epoch: 1, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.310 Vali Acc: 0.506 Test Loss: 1.310 Test Acc: 0.506
Validation loss decreased (inf --> -0.505542).  Saving model ...
Epoch: 2 cost time: 1.2597591876983643
Epoch: 2, Steps: 12 | Train Loss: 0.989 Vali Loss: 0.741 Vali Acc: 0.689 Test Loss: 0.741 Test Acc: 0.689
Validation loss decreased (-0.505542 --> -0.688881).  Saving model ...
Epoch: 3 cost time: 1.304161548614502
Epoch: 3, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.577 Vali Acc: 0.733 Test Loss: 0.577 Test Acc: 0.733
Validation loss decreased (-0.688881 --> -0.733328).  Saving model ...
Epoch: 4 cost time: 1.3426604270935059
Epoch: 4, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.471 Vali Acc: 0.761 Test Loss: 0.471 Test Acc: 0.761
Validation loss decreased (-0.733328 --> -0.761106).  Saving model ...
Epoch: 5 cost time: 1.2324190139770508
Epoch: 5, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.390 Vali Acc: 0.833 Test Loss: 0.390 Test Acc: 0.833
Validation loss decreased (-0.761106 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 1.2686407566070557
Epoch: 6, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.376 Vali Acc: 0.822 Test Loss: 0.376 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2251567840576172
Epoch: 7, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.347 Vali Acc: 0.828 Test Loss: 0.347 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2258329391479492
Epoch: 8, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.356 Vali Acc: 0.828 Test Loss: 0.356 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1510040760040283
Epoch: 9, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.338 Vali Acc: 0.839 Test Loss: 0.338 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838886).  Saving model ...
Epoch: 10 cost time: 1.101384162902832
Epoch: 10, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 1.3174712657928467
Epoch: 11, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2397265434265137
Epoch: 12, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.398 Vali Acc: 0.811 Test Loss: 0.398 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2732369899749756
Epoch: 13, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3700766563415527
Epoch: 14, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.356 Vali Acc: 0.839 Test Loss: 0.356 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2937304973602295
Epoch: 15, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
Validation loss decreased (-0.855553 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 1.150437831878662
Epoch: 16, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0267024040222168
Epoch: 17, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.320530652999878
Epoch: 18, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2254962921142578
Epoch: 19, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.328711748123169
Epoch: 20, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1689949035644531
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.324521780014038
Epoch: 22, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2556109428405762
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.324 Vali Acc: 0.878 Test Loss: 0.324 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4076368808746338
Epoch: 24, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.365 Vali Acc: 0.867 Test Loss: 0.365 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1399083137512207
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 308854
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3305981159210205
Epoch: 1, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.308 Vali Acc: 0.539 Test Loss: 1.308 Test Acc: 0.539
Validation loss decreased (inf --> -0.538876).  Saving model ...
Epoch: 2 cost time: 0.9483530521392822
Epoch: 2, Steps: 12 | Train Loss: 0.991 Vali Loss: 0.732 Vali Acc: 0.672 Test Loss: 0.732 Test Acc: 0.672
Validation loss decreased (-0.538876 --> -0.672215).  Saving model ...
Epoch: 3 cost time: 0.9926142692565918
Epoch: 3, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.566 Vali Acc: 0.739 Test Loss: 0.566 Test Acc: 0.739
Validation loss decreased (-0.672215 --> -0.738883).  Saving model ...
Epoch: 4 cost time: 1.2103271484375
Epoch: 4, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.461 Vali Acc: 0.772 Test Loss: 0.461 Test Acc: 0.772
Validation loss decreased (-0.738883 --> -0.772218).  Saving model ...
Epoch: 5 cost time: 1.1722166538238525
Epoch: 5, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.375 Vali Acc: 0.833 Test Loss: 0.375 Test Acc: 0.833
Validation loss decreased (-0.772218 --> -0.833330).  Saving model ...
Epoch: 6 cost time: 1.146475076675415
Epoch: 6, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.368 Vali Acc: 0.806 Test Loss: 0.368 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4014742374420166
Epoch: 7, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.340 Vali Acc: 0.856 Test Loss: 0.340 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 1.1593520641326904
Epoch: 8, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2534964084625244
Epoch: 9, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.26202392578125
Epoch: 10, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 1.2351372241973877
Epoch: 11, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3554251194000244
Epoch: 12, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.411 Vali Acc: 0.794 Test Loss: 0.411 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2286944389343262
Epoch: 13, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.285 Vali Acc: 0.850 Test Loss: 0.285 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0857033729553223
Epoch: 14, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.319 Vali Acc: 0.844 Test Loss: 0.319 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0832850933074951
Epoch: 15, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
Validation loss decreased (-0.872219 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 1.1699802875518799
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1958835124969482
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2250840663909912
Epoch: 18, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0311439037322998
Epoch: 19, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2593472003936768
Epoch: 20, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.277369737625122
Epoch: 21, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2151505947113037
Epoch: 22, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2552473545074463
Epoch: 23, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.318 Vali Acc: 0.883 Test Loss: 0.318 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1942603588104248
Epoch: 24, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2287750244140625
Epoch: 25, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 308854
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.490588665008545
Epoch: 1, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.354 Vali Acc: 0.556 Test Loss: 1.354 Test Acc: 0.556
Validation loss decreased (inf --> -0.555542).  Saving model ...
Epoch: 2 cost time: 1.282573938369751
Epoch: 2, Steps: 12 | Train Loss: 1.011 Vali Loss: 0.766 Vali Acc: 0.678 Test Loss: 0.766 Test Acc: 0.678
Validation loss decreased (-0.555542 --> -0.677770).  Saving model ...
Epoch: 3 cost time: 1.320922613143921
Epoch: 3, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
Validation loss decreased (-0.677770 --> -0.716661).  Saving model ...
Epoch: 4 cost time: 1.1689116954803467
Epoch: 4, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.465 Vali Acc: 0.750 Test Loss: 0.465 Test Acc: 0.750
Validation loss decreased (-0.716661 --> -0.749995).  Saving model ...
Epoch: 5 cost time: 1.1850390434265137
Epoch: 5, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.380 Vali Acc: 0.828 Test Loss: 0.380 Test Acc: 0.828
Validation loss decreased (-0.749995 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 1.2803618907928467
Epoch: 6, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.380 Vali Acc: 0.806 Test Loss: 0.380 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3464500904083252
Epoch: 7, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 1.2437913417816162
Epoch: 8, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.350 Vali Acc: 0.828 Test Loss: 0.350 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.189239263534546
Epoch: 9, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 1.178049087524414
Epoch: 10, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 1.1989529132843018
Epoch: 11, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2647247314453125
Epoch: 12, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.406 Vali Acc: 0.800 Test Loss: 0.406 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.240464687347412
Epoch: 13, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.299 Vali Acc: 0.828 Test Loss: 0.299 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2710659503936768
Epoch: 14, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.336 Vali Acc: 0.817 Test Loss: 0.336 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2107763290405273
Epoch: 15, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 1.250781536102295
Epoch: 16, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.182633876800537
Epoch: 17, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1848702430725098
Epoch: 18, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0925462245941162
Epoch: 19, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0623390674591064
Epoch: 20, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0851171016693115
Epoch: 21, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3161137104034424
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2530066967010498
Epoch: 23, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.317 Vali Acc: 0.872 Test Loss: 0.317 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.303074836730957
Epoch: 24, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.351 Vali Acc: 0.861 Test Loss: 0.351 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2265956401824951
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 308854
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7237372398376465
Epoch: 1, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.208 Vali Acc: 0.639 Test Loss: 1.208 Test Acc: 0.639
Validation loss decreased (inf --> -0.638877).  Saving model ...
Epoch: 2 cost time: 1.229750394821167
Epoch: 2, Steps: 12 | Train Loss: 0.929 Vali Loss: 0.730 Vali Acc: 0.756 Test Loss: 0.730 Test Acc: 0.756
Validation loss decreased (-0.638877 --> -0.755548).  Saving model ...
Epoch: 3 cost time: 1.1904253959655762
Epoch: 3, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.517 Vali Acc: 0.733 Test Loss: 0.517 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2141435146331787
Epoch: 4, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.422 Vali Acc: 0.811 Test Loss: 0.422 Test Acc: 0.811
Validation loss decreased (-0.755548 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 1.228571891784668
Epoch: 5, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.376 Vali Acc: 0.811 Test Loss: 0.376 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 1.235809564590454
Epoch: 6, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.365 Vali Acc: 0.817 Test Loss: 0.365 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 1.1999726295471191
Epoch: 7, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.360 Vali Acc: 0.839 Test Loss: 0.360 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 1.0637917518615723
Epoch: 8, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.330 Vali Acc: 0.822 Test Loss: 0.330 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2132904529571533
Epoch: 9, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.258216381072998
Epoch: 10, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1955547332763672
Epoch: 11, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 1.1190719604492188
Epoch: 12, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.193821668624878
Epoch: 13, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.301 Vali Acc: 0.839 Test Loss: 0.301 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.103621482849121
Epoch: 14, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.059502124786377
Epoch: 15, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 1.287198543548584
Epoch: 16, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.218637466430664
Epoch: 17, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.340 Vali Acc: 0.839 Test Loss: 0.340 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0971183776855469
Epoch: 18, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.069324254989624
Epoch: 19, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.270 Vali Acc: 0.872 Test Loss: 0.270 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2604191303253174
Epoch: 20, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1694250106811523
Epoch: 21, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0792973041534424
Epoch: 22, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 23 cost time: 1.29512357711792
Epoch: 23, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2990491390228271
Epoch: 24, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.076115369796753
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.311 Vali Acc: 0.883 Test Loss: 0.311 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 26 cost time: 1.2607178688049316
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 1.1410913467407227
Epoch: 27, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.430 Vali Acc: 0.856 Test Loss: 0.430 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.327378749847412
Epoch: 28, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.424 Vali Acc: 0.828 Test Loss: 0.424 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3081941604614258
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 1.2246906757354736
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.293 Vali Acc: 0.883 Test Loss: 0.293 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0173311233520508
Epoch: 31, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2941796779632568
Epoch: 32, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1408483982086182
Epoch: 33, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.244715929031372
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2795360088348389
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.308 Vali Acc: 0.883 Test Loss: 0.308 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2611942291259766
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2655363082885742
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2731833457946777
Epoch: 38, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.314 Vali Acc: 0.883 Test Loss: 0.314 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.3249623775482178
Epoch: 39, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 40 cost time: 1.347402572631836
Epoch: 40, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1751141548156738
Epoch: 41, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2262258529663086
Epoch: 42, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.316 Vali Acc: 0.883 Test Loss: 0.316 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1456966400146484
Epoch: 43, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.247023582458496
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.313 Vali Acc: 0.894 Test Loss: 0.313 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 45 cost time: 1.1876380443572998
Epoch: 45, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 46 cost time: 1.1655662059783936
Epoch: 46, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0742897987365723
Epoch: 47, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.300 Vali Acc: 0.906 Test Loss: 0.300 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 48 cost time: 1.0241475105285645
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.331 Vali Acc: 0.883 Test Loss: 0.331 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0728318691253662
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2594170570373535
Epoch: 50, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0694003105163574
Epoch: 51, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.330 Vali Acc: 0.894 Test Loss: 0.330 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0790472030639648
Epoch: 52, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.330 Vali Acc: 0.894 Test Loss: 0.330 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.2030396461486816
Epoch: 53, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.186927080154419
Epoch: 54, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.2874104976654053
Epoch: 55, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.287992238998413
Epoch: 56, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.404 Vali Acc: 0.883 Test Loss: 0.404 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.098024845123291
Epoch: 57, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 276086
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4856760501861572
Epoch: 1, Steps: 12 | Train Loss: 1.644 Vali Loss: 1.214 Vali Acc: 0.622 Test Loss: 1.214 Test Acc: 0.622
Validation loss decreased (inf --> -0.622210).  Saving model ...
Epoch: 2 cost time: 1.0793943405151367
Epoch: 2, Steps: 12 | Train Loss: 0.922 Vali Loss: 0.732 Vali Acc: 0.744 Test Loss: 0.732 Test Acc: 0.744
Validation loss decreased (-0.622210 --> -0.744437).  Saving model ...
Epoch: 3 cost time: 1.0895745754241943
Epoch: 3, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.518 Vali Acc: 0.739 Test Loss: 0.518 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.090186595916748
Epoch: 4, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.425 Vali Acc: 0.806 Test Loss: 0.425 Test Acc: 0.806
Validation loss decreased (-0.744437 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 1.0597500801086426
Epoch: 5, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.378 Vali Acc: 0.800 Test Loss: 0.378 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0553388595581055
Epoch: 6, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 1.3173885345458984
Epoch: 7, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.354 Vali Acc: 0.844 Test Loss: 0.354 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 1.3153250217437744
Epoch: 8, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.327 Vali Acc: 0.828 Test Loss: 0.327 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2104160785675049
Epoch: 9, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 10 cost time: 1.1928317546844482
Epoch: 10, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2309081554412842
Epoch: 11, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 1.139284610748291
Epoch: 12, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.299 Vali Acc: 0.844 Test Loss: 0.299 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2505593299865723
Epoch: 13, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.254241943359375
Epoch: 14, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3384904861450195
Epoch: 15, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.283 Vali Acc: 0.894 Test Loss: 0.283 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 1.3338203430175781
Epoch: 16, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3378326892852783
Epoch: 17, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.251387119293213
Epoch: 18, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3180148601531982
Epoch: 19, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.307427167892456
Epoch: 20, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.311 Vali Acc: 0.872 Test Loss: 0.311 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1305603981018066
Epoch: 21, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2808914184570312
Epoch: 22, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3396806716918945
Epoch: 23, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3721847534179688
Epoch: 24, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3043208122253418
Epoch: 25, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 276086
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8098785877227783
Epoch: 1, Steps: 12 | Train Loss: 1.646 Vali Loss: 1.222 Vali Acc: 0.622 Test Loss: 1.222 Test Acc: 0.622
Validation loss decreased (inf --> -0.622210).  Saving model ...
Epoch: 2 cost time: 1.3188750743865967
Epoch: 2, Steps: 12 | Train Loss: 0.933 Vali Loss: 0.726 Vali Acc: 0.728 Test Loss: 0.726 Test Acc: 0.728
Validation loss decreased (-0.622210 --> -0.727771).  Saving model ...
Epoch: 3 cost time: 1.1489436626434326
Epoch: 3, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.513 Vali Acc: 0.756 Test Loss: 0.513 Test Acc: 0.756
Validation loss decreased (-0.727771 --> -0.755550).  Saving model ...
Epoch: 4 cost time: 1.2769856452941895
Epoch: 4, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.416 Vali Acc: 0.811 Test Loss: 0.416 Test Acc: 0.811
Validation loss decreased (-0.755550 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 1.3367183208465576
Epoch: 5, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.373 Vali Acc: 0.811 Test Loss: 0.373 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 1.379526138305664
Epoch: 6, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.355 Vali Acc: 0.817 Test Loss: 0.355 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 1.2421555519104004
Epoch: 7, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.349 Vali Acc: 0.856 Test Loss: 0.349 Test Acc: 0.856
Validation loss decreased (-0.816663 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 1.1407949924468994
Epoch: 8, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.315 Vali Acc: 0.828 Test Loss: 0.315 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2519419193267822
Epoch: 9, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 10 cost time: 1.2323176860809326
Epoch: 10, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.287 Vali Acc: 0.844 Test Loss: 0.287 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.291879415512085
Epoch: 11, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1941614151000977
Epoch: 12, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.289 Vali Acc: 0.850 Test Loss: 0.289 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1620259284973145
Epoch: 13, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.277 Vali Acc: 0.861 Test Loss: 0.277 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2847957611083984
Epoch: 14, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.505403757095337
Epoch: 15, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 1.4141356945037842
Epoch: 16, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4819540977478027
Epoch: 17, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3315849304199219
Epoch: 18, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.274 Vali Acc: 0.856 Test Loss: 0.274 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.513866662979126
Epoch: 19, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.250 Vali Acc: 0.883 Test Loss: 0.250 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.341393232345581
Epoch: 20, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5012974739074707
Epoch: 21, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3059823513031006
Epoch: 22, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4243032932281494
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.349487066268921
Epoch: 24, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3469362258911133
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 276086
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1463499069213867
Epoch: 1, Steps: 12 | Train Loss: 1.677 Vali Loss: 1.268 Vali Acc: 0.594 Test Loss: 1.268 Test Acc: 0.594
Validation loss decreased (inf --> -0.594432).  Saving model ...
Epoch: 2 cost time: 1.124575138092041
Epoch: 2, Steps: 12 | Train Loss: 0.980 Vali Loss: 0.758 Vali Acc: 0.683 Test Loss: 0.758 Test Acc: 0.683
Validation loss decreased (-0.594432 --> -0.683326).  Saving model ...
Epoch: 3 cost time: 1.4143884181976318
Epoch: 3, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.539 Vali Acc: 0.728 Test Loss: 0.539 Test Acc: 0.728
Validation loss decreased (-0.683326 --> -0.727772).  Saving model ...
Epoch: 4 cost time: 1.3178870677947998
Epoch: 4, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.439 Vali Acc: 0.778 Test Loss: 0.439 Test Acc: 0.778
Validation loss decreased (-0.727772 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 1.2461867332458496
Epoch: 5, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.396 Vali Acc: 0.828 Test Loss: 0.396 Test Acc: 0.828
Validation loss decreased (-0.777773 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 1.273237705230713
Epoch: 6, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.370 Vali Acc: 0.817 Test Loss: 0.370 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3509392738342285
Epoch: 7, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.350 Vali Acc: 0.856 Test Loss: 0.350 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 1.2752125263214111
Epoch: 8, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.335 Vali Acc: 0.817 Test Loss: 0.335 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2990398406982422
Epoch: 9, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.301 Vali Acc: 0.894 Test Loss: 0.301 Test Acc: 0.894
Validation loss decreased (-0.855552 --> -0.894441).  Saving model ...
Epoch: 10 cost time: 1.2338800430297852
Epoch: 10, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.298 Vali Acc: 0.844 Test Loss: 0.298 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2941787242889404
Epoch: 11, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1816329956054688
Epoch: 12, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0820095539093018
Epoch: 13, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.283 Vali Acc: 0.850 Test Loss: 0.283 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2288472652435303
Epoch: 14, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.357163906097412
Epoch: 15, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1869463920593262
Epoch: 16, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0429162979125977
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.99210524559021
Epoch: 18, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2235915660858154
Epoch: 19, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 276086
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2956016063690186
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.473 Vali Acc: 0.456 Test Loss: 1.473 Test Acc: 0.456
Validation loss decreased (inf --> -0.455541).  Saving model ...
Epoch: 2 cost time: 1.2271466255187988
Epoch: 2, Steps: 12 | Train Loss: 1.246 Vali Loss: 0.998 Vali Acc: 0.617 Test Loss: 0.998 Test Acc: 0.617
Validation loss decreased (-0.455541 --> -0.616657).  Saving model ...
Epoch: 3 cost time: 1.074124813079834
Epoch: 3, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.745 Vali Acc: 0.717 Test Loss: 0.745 Test Acc: 0.717
Validation loss decreased (-0.616657 --> -0.716659).  Saving model ...
Epoch: 4 cost time: 1.2305219173431396
Epoch: 4, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.604 Vali Acc: 0.706 Test Loss: 0.604 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3285534381866455
Epoch: 5, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.525 Vali Acc: 0.750 Test Loss: 0.525 Test Acc: 0.750
Validation loss decreased (-0.716659 --> -0.749995).  Saving model ...
Epoch: 6 cost time: 1.149430274963379
Epoch: 6, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.462 Vali Acc: 0.739 Test Loss: 0.462 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2038812637329102
Epoch: 7, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.432 Vali Acc: 0.761 Test Loss: 0.432 Test Acc: 0.761
Validation loss decreased (-0.749995 --> -0.761107).  Saving model ...
Epoch: 8 cost time: 1.2929341793060303
Epoch: 8, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.410 Vali Acc: 0.800 Test Loss: 0.410 Test Acc: 0.800
Validation loss decreased (-0.761107 --> -0.799996).  Saving model ...
Epoch: 9 cost time: 1.2651071548461914
Epoch: 9, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.383 Vali Acc: 0.817 Test Loss: 0.383 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 1.1974258422851562
Epoch: 10, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.387 Vali Acc: 0.839 Test Loss: 0.387 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 1.1907424926757812
Epoch: 11, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.331 Vali Acc: 0.833 Test Loss: 0.331 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1758990287780762
Epoch: 12, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.337 Vali Acc: 0.833 Test Loss: 0.337 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4004790782928467
Epoch: 13, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.338 Vali Acc: 0.828 Test Loss: 0.338 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3135662078857422
Epoch: 14, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.348 Vali Acc: 0.822 Test Loss: 0.348 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.134605884552002
Epoch: 15, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.336 Vali Acc: 0.839 Test Loss: 0.336 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 16 cost time: 1.0629022121429443
Epoch: 16, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855552).  Saving model ...
Epoch: 17 cost time: 1.1535217761993408
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.2761478424072266
Epoch: 18, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1623344421386719
Epoch: 19, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.306 Vali Acc: 0.833 Test Loss: 0.306 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1491122245788574
Epoch: 20, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.306 Vali Acc: 0.867 Test Loss: 0.306 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 21 cost time: 1.1893270015716553
Epoch: 21, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 1.2605915069580078
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4608664512634277
Epoch: 23, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 24 cost time: 1.2735216617584229
Epoch: 24, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2938830852508545
Epoch: 25, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.347353219985962
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.488734245300293
Epoch: 27, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 28 cost time: 1.3571345806121826
Epoch: 28, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.298 Vali Acc: 0.878 Test Loss: 0.298 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3466291427612305
Epoch: 29, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2615976333618164
Epoch: 30, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3238203525543213
Epoch: 31, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 32 cost time: 1.3272631168365479
Epoch: 32, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.334 Vali Acc: 0.872 Test Loss: 0.334 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.380831241607666
Epoch: 33, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2595574855804443
Epoch: 34, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.188033103942871
Epoch: 35, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 36 cost time: 1.1411659717559814
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.234250545501709
Epoch: 37, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.376 Vali Acc: 0.867 Test Loss: 0.376 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2876110076904297
Epoch: 38, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.3123514652252197
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.356734275817871
Epoch: 40, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.317 Vali Acc: 0.883 Test Loss: 0.317 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.4499435424804688
Epoch: 41, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3496720790863037
Epoch: 42, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.322 Vali Acc: 0.894 Test Loss: 0.322 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3118493556976318
Epoch: 43, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.3091185092926025
Epoch: 44, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.334 Vali Acc: 0.872 Test Loss: 0.334 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2852020263671875
Epoch: 45, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 613238
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.662456750869751
Epoch: 1, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.465 Vali Acc: 0.461 Test Loss: 1.465 Test Acc: 0.461
Validation loss decreased (inf --> -0.461096).  Saving model ...
Epoch: 2 cost time: 1.3296024799346924
Epoch: 2, Steps: 12 | Train Loss: 1.240 Vali Loss: 0.990 Vali Acc: 0.622 Test Loss: 0.990 Test Acc: 0.622
Validation loss decreased (-0.461096 --> -0.622212).  Saving model ...
Epoch: 3 cost time: 1.1765363216400146
Epoch: 3, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.739 Vali Acc: 0.711 Test Loss: 0.739 Test Acc: 0.711
Validation loss decreased (-0.622212 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.3183073997497559
Epoch: 4, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (-0.711104 --> -0.722216).  Saving model ...
Epoch: 5 cost time: 1.2019176483154297
Epoch: 5, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.522 Vali Acc: 0.756 Test Loss: 0.522 Test Acc: 0.756
Validation loss decreased (-0.722216 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 1.4890124797821045
Epoch: 6, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.456 Vali Acc: 0.744 Test Loss: 0.456 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3473289012908936
Epoch: 7, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.424 Vali Acc: 0.778 Test Loss: 0.424 Test Acc: 0.778
Validation loss decreased (-0.755550 --> -0.777774).  Saving model ...
Epoch: 8 cost time: 1.2622787952423096
Epoch: 8, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.400 Vali Acc: 0.806 Test Loss: 0.400 Test Acc: 0.806
Validation loss decreased (-0.777774 --> -0.805552).  Saving model ...
Epoch: 9 cost time: 1.3490371704101562
Epoch: 9, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.375 Vali Acc: 0.828 Test Loss: 0.375 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 1.316547155380249
Epoch: 10, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 1.418764352798462
Epoch: 11, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.321 Vali Acc: 0.839 Test Loss: 0.321 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.418297529220581
Epoch: 12, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 1.3792712688446045
Epoch: 13, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.330 Vali Acc: 0.822 Test Loss: 0.330 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4144823551177979
Epoch: 14, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.340 Vali Acc: 0.817 Test Loss: 0.340 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2727642059326172
Epoch: 15, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.1851959228515625
Epoch: 16, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 1.2980597019195557
Epoch: 17, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 1.2589118480682373
Epoch: 18, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0418667793273926
Epoch: 19, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.292 Vali Acc: 0.844 Test Loss: 0.292 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2036206722259521
Epoch: 20, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 1.4019577503204346
Epoch: 21, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 1.1670029163360596
Epoch: 22, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.299785852432251
Epoch: 23, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 24 cost time: 1.3126389980316162
Epoch: 24, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2220096588134766
Epoch: 25, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.267592191696167
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2997465133666992
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 28 cost time: 1.2840251922607422
Epoch: 28, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.245577335357666
Epoch: 29, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2163431644439697
Epoch: 30, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2563776969909668
Epoch: 31, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 32 cost time: 1.3019661903381348
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.308 Vali Acc: 0.878 Test Loss: 0.308 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2729740142822266
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2608816623687744
Epoch: 34, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.302954912185669
Epoch: 35, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2850663661956787
Epoch: 36, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1624863147735596
Epoch: 37, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.368 Vali Acc: 0.856 Test Loss: 0.368 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1188075542449951
Epoch: 38, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.352320909500122
Epoch: 39, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 1.437377691268921
Epoch: 40, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3189077377319336
Epoch: 41, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 1.2495830059051514
Epoch: 42, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1322226524353027
Epoch: 43, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.323 Vali Acc: 0.894 Test Loss: 0.323 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 44 cost time: 1.3196079730987549
Epoch: 44, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.334 Vali Acc: 0.867 Test Loss: 0.334 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.357121229171753
Epoch: 45, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1102416515350342
Epoch: 46, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2025856971740723
Epoch: 47, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0938100814819336
Epoch: 48, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899996).  Saving model ...
Epoch: 49 cost time: 1.0124292373657227
Epoch: 49, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.334 Vali Acc: 0.883 Test Loss: 0.334 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.088757038116455
Epoch: 50, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.319 Vali Acc: 0.883 Test Loss: 0.319 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0965774059295654
Epoch: 51, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.365 Vali Acc: 0.883 Test Loss: 0.365 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.007798194885254
Epoch: 52, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.324 Vali Acc: 0.883 Test Loss: 0.324 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.1283767223358154
Epoch: 53, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.379 Vali Acc: 0.883 Test Loss: 0.379 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.3198730945587158
Epoch: 54, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.237330675125122
Epoch: 55, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.324 Vali Acc: 0.883 Test Loss: 0.324 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.3237888813018799
Epoch: 56, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.361 Vali Acc: 0.878 Test Loss: 0.361 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.2913415431976318
Epoch: 57, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.029895544052124
Epoch: 58, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.354 Vali Acc: 0.883 Test Loss: 0.354 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 613238
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.486034870147705
Epoch: 1, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.455 Vali Acc: 0.461 Test Loss: 1.455 Test Acc: 0.461
Validation loss decreased (inf --> -0.461097).  Saving model ...
Epoch: 2 cost time: 1.2322521209716797
Epoch: 2, Steps: 12 | Train Loss: 1.228 Vali Loss: 0.977 Vali Acc: 0.644 Test Loss: 0.977 Test Acc: 0.644
Validation loss decreased (-0.461097 --> -0.644435).  Saving model ...
Epoch: 3 cost time: 1.2832109928131104
Epoch: 3, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.727 Vali Acc: 0.700 Test Loss: 0.727 Test Acc: 0.700
Validation loss decreased (-0.644435 --> -0.699993).  Saving model ...
Epoch: 4 cost time: 1.2452549934387207
Epoch: 4, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.593 Vali Acc: 0.700 Test Loss: 0.593 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699994).  Saving model ...
Epoch: 5 cost time: 1.2008061408996582
Epoch: 5, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.515 Vali Acc: 0.756 Test Loss: 0.515 Test Acc: 0.756
Validation loss decreased (-0.699994 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 1.1279237270355225
Epoch: 6, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.447 Vali Acc: 0.767 Test Loss: 0.447 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 1.4076611995697021
Epoch: 7, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.412 Vali Acc: 0.783 Test Loss: 0.412 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783329).  Saving model ...
Epoch: 8 cost time: 1.0462923049926758
Epoch: 8, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.387 Vali Acc: 0.800 Test Loss: 0.387 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 9 cost time: 1.1963691711425781
Epoch: 9, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.364 Vali Acc: 0.839 Test Loss: 0.364 Test Acc: 0.839
Validation loss decreased (-0.799996 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 1.1350114345550537
Epoch: 10, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.363 Vali Acc: 0.844 Test Loss: 0.363 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 1.1462204456329346
Epoch: 11, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 1.2152678966522217
Epoch: 12, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.320 Vali Acc: 0.833 Test Loss: 0.320 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0225555896759033
Epoch: 13, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.320 Vali Acc: 0.833 Test Loss: 0.320 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2217488288879395
Epoch: 14, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.330 Vali Acc: 0.822 Test Loss: 0.330 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1585636138916016
Epoch: 15, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.320 Vali Acc: 0.856 Test Loss: 0.320 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9581968784332275
Epoch: 16, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 17 cost time: 1.1448142528533936
Epoch: 17, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 1.1301610469818115
Epoch: 18, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0184450149536133
Epoch: 19, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.288 Vali Acc: 0.850 Test Loss: 0.288 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1644480228424072
Epoch: 20, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 21 cost time: 1.3154163360595703
Epoch: 21, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 1.1578257083892822
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0888092517852783
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 24 cost time: 1.2344388961791992
Epoch: 24, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 1.2089741230010986
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.211869239807129
Epoch: 26, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.353135585784912
Epoch: 27, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 1.1081066131591797
Epoch: 28, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.151355266571045
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.16629958152771
Epoch: 30, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1334269046783447
Epoch: 31, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1872470378875732
Epoch: 32, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2471528053283691
Epoch: 33, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.076805591583252
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.177802324295044
Epoch: 35, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.190781593322754
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1571636199951172
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.353 Vali Acc: 0.861 Test Loss: 0.353 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 613238
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2077322006225586
Epoch: 1, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.473 Vali Acc: 0.483 Test Loss: 1.473 Test Acc: 0.483
Validation loss decreased (inf --> -0.483319).  Saving model ...
Epoch: 2 cost time: 0.9540083408355713
Epoch: 2, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.017 Vali Acc: 0.656 Test Loss: 1.017 Test Acc: 0.656
Validation loss decreased (-0.483319 --> -0.655545).  Saving model ...
Epoch: 3 cost time: 0.9531302452087402
Epoch: 3, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.759 Vali Acc: 0.694 Test Loss: 0.759 Test Acc: 0.694
Validation loss decreased (-0.655545 --> -0.694437).  Saving model ...
Epoch: 4 cost time: 1.1160387992858887
Epoch: 4, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.618 Vali Acc: 0.717 Test Loss: 0.618 Test Acc: 0.717
Validation loss decreased (-0.694437 --> -0.716660).  Saving model ...
Epoch: 5 cost time: 1.0340850353240967
Epoch: 5, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.534 Vali Acc: 0.739 Test Loss: 0.534 Test Acc: 0.739
Validation loss decreased (-0.716660 --> -0.738884).  Saving model ...
Epoch: 6 cost time: 1.0668375492095947
Epoch: 6, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.468 Vali Acc: 0.778 Test Loss: 0.468 Test Acc: 0.778
Validation loss decreased (-0.738884 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 1.0801165103912354
Epoch: 7, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.438 Vali Acc: 0.772 Test Loss: 0.438 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0099780559539795
Epoch: 8, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.410 Vali Acc: 0.789 Test Loss: 0.410 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788885).  Saving model ...
Epoch: 9 cost time: 0.9541661739349365
Epoch: 9, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.389 Vali Acc: 0.811 Test Loss: 0.389 Test Acc: 0.811
Validation loss decreased (-0.788885 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 1.0046782493591309
Epoch: 10, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.385 Vali Acc: 0.828 Test Loss: 0.385 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 1.0130691528320312
Epoch: 11, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 1.1014645099639893
Epoch: 12, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.342 Vali Acc: 0.817 Test Loss: 0.342 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0850908756256104
Epoch: 13, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.349 Vali Acc: 0.800 Test Loss: 0.349 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1103665828704834
Epoch: 14, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.371 Vali Acc: 0.811 Test Loss: 0.371 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.108079433441162
Epoch: 15, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 16 cost time: 1.1250569820404053
Epoch: 16, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 17 cost time: 1.0876564979553223
Epoch: 17, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 1.0860273838043213
Epoch: 18, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.301 Vali Acc: 0.878 Test Loss: 0.301 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 1.1508629322052002
Epoch: 19, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0767252445220947
Epoch: 20, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 1.0350873470306396
Epoch: 21, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1170079708099365
Epoch: 22, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0200204849243164
Epoch: 23, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9689884185791016
Epoch: 24, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9363045692443848
Epoch: 25, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.311 Vali Acc: 0.850 Test Loss: 0.311 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9672279357910156
Epoch: 26, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0644304752349854
Epoch: 27, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0722956657409668
Epoch: 28, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9166824817657471
Epoch: 29, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0261781215667725
Epoch: 30, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 613238
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3184778690338135
Epoch: 1, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.377 Vali Acc: 0.589 Test Loss: 1.377 Test Acc: 0.589
Validation loss decreased (inf --> -0.588875).  Saving model ...
Epoch: 2 cost time: 0.9697299003601074
Epoch: 2, Steps: 12 | Train Loss: 1.176 Vali Loss: 0.922 Vali Acc: 0.694 Test Loss: 0.922 Test Acc: 0.694
Validation loss decreased (-0.588875 --> -0.694435).  Saving model ...
Epoch: 3 cost time: 1.1143271923065186
Epoch: 3, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.690 Vali Acc: 0.711 Test Loss: 0.690 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.1990444660186768
Epoch: 4, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.579 Vali Acc: 0.733 Test Loss: 0.579 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733328).  Saving model ...
Epoch: 5 cost time: 1.1371655464172363
Epoch: 5, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.491 Vali Acc: 0.767 Test Loss: 0.491 Test Acc: 0.767
Validation loss decreased (-0.733328 --> -0.766662).  Saving model ...
Epoch: 6 cost time: 1.1521449089050293
Epoch: 6, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.447 Vali Acc: 0.783 Test Loss: 0.447 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 1.3037383556365967
Epoch: 7, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.408 Vali Acc: 0.806 Test Loss: 0.408 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 1.1858880519866943
Epoch: 8, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.392 Vali Acc: 0.794 Test Loss: 0.392 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.307363510131836
Epoch: 9, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 1.3273060321807861
Epoch: 10, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 1.3316917419433594
Epoch: 11, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.345 Vali Acc: 0.822 Test Loss: 0.345 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.209667682647705
Epoch: 12, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.355 Vali Acc: 0.822 Test Loss: 0.355 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3235633373260498
Epoch: 13, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 14 cost time: 1.3291819095611572
Epoch: 14, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.333 Vali Acc: 0.822 Test Loss: 0.333 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3238849639892578
Epoch: 15, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9276735782623291
Epoch: 16, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2530343532562256
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2117164134979248
Epoch: 18, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.302 Vali Acc: 0.844 Test Loss: 0.302 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2088665962219238
Epoch: 19, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 20 cost time: 1.2744836807250977
Epoch: 20, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2054765224456787
Epoch: 21, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 1.260054111480713
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2535560131072998
Epoch: 23, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 24 cost time: 1.1651246547698975
Epoch: 24, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 25 cost time: 1.2578680515289307
Epoch: 25, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2788989543914795
Epoch: 26, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.318 Vali Acc: 0.867 Test Loss: 0.318 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.090989351272583
Epoch: 27, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.337 Vali Acc: 0.844 Test Loss: 0.337 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1476311683654785
Epoch: 28, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6080467700958252
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1584234237670898
Epoch: 30, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.132018804550171
Epoch: 31, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0251655578613281
Epoch: 32, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 1.017164945602417
Epoch: 33, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1014454364776611
Epoch: 34, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1404271125793457
Epoch: 35, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.339 Vali Acc: 0.867 Test Loss: 0.339 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2056362628936768
Epoch: 36, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.332 Vali Acc: 0.856 Test Loss: 0.332 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9771795272827148
Epoch: 37, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2811272144317627
Epoch: 38, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1280884742736816
Epoch: 39, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1562111377716064
Epoch: 40, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.310 Vali Acc: 0.883 Test Loss: 0.310 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2378263473510742
Epoch: 41, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2163875102996826
Epoch: 42, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.336 Vali Acc: 0.883 Test Loss: 0.336 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 351094
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2895567417144775
Epoch: 1, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.375 Vali Acc: 0.583 Test Loss: 1.375 Test Acc: 0.583
Validation loss decreased (inf --> -0.583320).  Saving model ...
Epoch: 2 cost time: 1.2967467308044434
Epoch: 2, Steps: 12 | Train Loss: 1.160 Vali Loss: 0.918 Vali Acc: 0.711 Test Loss: 0.918 Test Acc: 0.711
Validation loss decreased (-0.583320 --> -0.711102).  Saving model ...
Epoch: 3 cost time: 1.2897343635559082
Epoch: 3, Steps: 12 | Train Loss: 0.818 Vali Loss: 0.686 Vali Acc: 0.711 Test Loss: 0.686 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.160355806350708
Epoch: 4, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.575 Vali Acc: 0.744 Test Loss: 0.575 Test Acc: 0.744
Validation loss decreased (-0.711104 --> -0.744439).  Saving model ...
Epoch: 5 cost time: 1.1353514194488525
Epoch: 5, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.484 Vali Acc: 0.783 Test Loss: 0.484 Test Acc: 0.783
Validation loss decreased (-0.744439 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 1.1205580234527588
Epoch: 6, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.438 Vali Acc: 0.789 Test Loss: 0.438 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788885).  Saving model ...
Epoch: 7 cost time: 1.018712043762207
Epoch: 7, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.402 Vali Acc: 0.806 Test Loss: 0.402 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805552).  Saving model ...
Epoch: 8 cost time: 1.0981531143188477
Epoch: 8, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.385 Vali Acc: 0.794 Test Loss: 0.385 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2016925811767578
Epoch: 9, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.354 Vali Acc: 0.839 Test Loss: 0.354 Test Acc: 0.839
Validation loss decreased (-0.805552 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 1.2119853496551514
Epoch: 10, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.341 Vali Acc: 0.844 Test Loss: 0.341 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 0.9559664726257324
Epoch: 11, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.337 Vali Acc: 0.822 Test Loss: 0.337 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0756340026855469
Epoch: 12, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.348 Vali Acc: 0.822 Test Loss: 0.348 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2679810523986816
Epoch: 13, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
Validation loss decreased (-0.844441 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.0969915390014648
Epoch: 14, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1816315650939941
Epoch: 15, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1205756664276123
Epoch: 16, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1864159107208252
Epoch: 17, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2683720588684082
Epoch: 18, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.300 Vali Acc: 0.844 Test Loss: 0.300 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.197761058807373
Epoch: 19, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2057344913482666
Epoch: 20, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2380669116973877
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.189136266708374
Epoch: 22, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2088618278503418
Epoch: 23, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.1736185550689697
Epoch: 24, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.283 Vali Acc: 0.894 Test Loss: 0.283 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1380736827850342
Epoch: 25, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.388120174407959
Epoch: 26, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.082935094833374
Epoch: 27, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.331 Vali Acc: 0.839 Test Loss: 0.331 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8983278274536133
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9115941524505615
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 30 cost time: 0.9366569519042969
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.907029390335083
Epoch: 31, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0357551574707031
Epoch: 32, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 1.0739145278930664
Epoch: 33, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.317 Vali Acc: 0.872 Test Loss: 0.317 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.201657772064209
Epoch: 34, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1622686386108398
Epoch: 35, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.341 Vali Acc: 0.867 Test Loss: 0.341 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0847609043121338
Epoch: 36, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.325 Vali Acc: 0.861 Test Loss: 0.325 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2652487754821777
Epoch: 37, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.306448221206665
Epoch: 38, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2154994010925293
Epoch: 39, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.347 Vali Acc: 0.878 Test Loss: 0.347 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2696564197540283
Epoch: 40, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1517295837402344
Epoch: 41, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.315 Vali Acc: 0.883 Test Loss: 0.315 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2283680438995361
Epoch: 42, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.344 Vali Acc: 0.878 Test Loss: 0.344 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 351094
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.343843698501587
Epoch: 1, Steps: 12 | Train Loss: 1.626 Vali Loss: 1.372 Vali Acc: 0.594 Test Loss: 1.372 Test Acc: 0.594
Validation loss decreased (inf --> -0.594431).  Saving model ...
Epoch: 2 cost time: 1.0980453491210938
Epoch: 2, Steps: 12 | Train Loss: 1.160 Vali Loss: 0.916 Vali Acc: 0.711 Test Loss: 0.916 Test Acc: 0.711
Validation loss decreased (-0.594431 --> -0.711102).  Saving model ...
Epoch: 3 cost time: 1.1859462261199951
Epoch: 3, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.683 Vali Acc: 0.711 Test Loss: 0.683 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.172358751296997
Epoch: 4, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.571 Vali Acc: 0.744 Test Loss: 0.571 Test Acc: 0.744
Validation loss decreased (-0.711104 --> -0.744439).  Saving model ...
Epoch: 5 cost time: 1.1197233200073242
Epoch: 5, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.480 Vali Acc: 0.778 Test Loss: 0.480 Test Acc: 0.778
Validation loss decreased (-0.744439 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 1.248572587966919
Epoch: 6, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.433 Vali Acc: 0.811 Test Loss: 0.433 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 1.220064401626587
Epoch: 7, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.396 Vali Acc: 0.806 Test Loss: 0.396 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1817309856414795
Epoch: 8, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.379 Vali Acc: 0.811 Test Loss: 0.379 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 1.213102102279663
Epoch: 9, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.349 Vali Acc: 0.867 Test Loss: 0.349 Test Acc: 0.867
Validation loss decreased (-0.811107 --> -0.866663).  Saving model ...
Epoch: 10 cost time: 1.0907342433929443
Epoch: 10, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1602401733398438
Epoch: 11, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.331 Vali Acc: 0.817 Test Loss: 0.331 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.215090036392212
Epoch: 12, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.342 Vali Acc: 0.822 Test Loss: 0.342 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2639870643615723
Epoch: 13, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2065610885620117
Epoch: 14, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.321 Vali Acc: 0.822 Test Loss: 0.321 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.207991361618042
Epoch: 15, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 1.1247730255126953
Epoch: 16, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 1.1698312759399414
Epoch: 17, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2723939418792725
Epoch: 18, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.291 Vali Acc: 0.839 Test Loss: 0.291 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.187000036239624
Epoch: 19, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 1.2403483390808105
Epoch: 20, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2414958477020264
Epoch: 21, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.0143654346466064
Epoch: 22, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0304276943206787
Epoch: 23, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.162492275238037
Epoch: 24, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.023655652999878
Epoch: 25, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1979846954345703
Epoch: 26, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3019394874572754
Epoch: 27, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.303 Vali Acc: 0.856 Test Loss: 0.303 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0252647399902344
Epoch: 28, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1301765441894531
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.146237850189209
Epoch: 30, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0171959400177002
Epoch: 31, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 351094
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2498831748962402
Epoch: 1, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.407 Vali Acc: 0.606 Test Loss: 1.407 Test Acc: 0.606
Validation loss decreased (inf --> -0.605541).  Saving model ...
Epoch: 2 cost time: 1.104804277420044
Epoch: 2, Steps: 12 | Train Loss: 1.173 Vali Loss: 0.980 Vali Acc: 0.694 Test Loss: 0.980 Test Acc: 0.694
Validation loss decreased (-0.605541 --> -0.694435).  Saving model ...
Epoch: 3 cost time: 1.101893424987793
Epoch: 3, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.738 Vali Acc: 0.689 Test Loss: 0.738 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9742124080657959
Epoch: 4, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.619 Vali Acc: 0.739 Test Loss: 0.619 Test Acc: 0.739
Validation loss decreased (-0.694435 --> -0.738883).  Saving model ...
Epoch: 5 cost time: 1.1834979057312012
Epoch: 5, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.510 Vali Acc: 0.761 Test Loss: 0.510 Test Acc: 0.761
Validation loss decreased (-0.738883 --> -0.761106).  Saving model ...
Epoch: 6 cost time: 1.1220417022705078
Epoch: 6, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.457 Vali Acc: 0.789 Test Loss: 0.457 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 1.0687048435211182
Epoch: 7, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.419 Vali Acc: 0.822 Test Loss: 0.419 Test Acc: 0.822
Validation loss decreased (-0.788884 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 1.0410194396972656
Epoch: 8, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.408 Vali Acc: 0.783 Test Loss: 0.408 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0196123123168945
Epoch: 9, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.378 Vali Acc: 0.822 Test Loss: 0.378 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 10 cost time: 1.1344397068023682
Epoch: 10, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.360 Vali Acc: 0.822 Test Loss: 0.360 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 11 cost time: 1.1693391799926758
Epoch: 11, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.350 Vali Acc: 0.811 Test Loss: 0.350 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2287487983703613
Epoch: 12, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.364 Vali Acc: 0.806 Test Loss: 0.364 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.085451364517212
Epoch: 13, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
Validation loss decreased (-0.822219 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 1.0945713520050049
Epoch: 14, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.351 Vali Acc: 0.811 Test Loss: 0.351 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0185813903808594
Epoch: 15, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.1060543060302734
Epoch: 16, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.302 Vali Acc: 0.883 Test Loss: 0.302 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 0.9620757102966309
Epoch: 17, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.317 Vali Acc: 0.822 Test Loss: 0.317 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0882456302642822
Epoch: 18, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.335 Vali Acc: 0.817 Test Loss: 0.335 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1880583763122559
Epoch: 19, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.303 Vali Acc: 0.844 Test Loss: 0.303 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2700090408325195
Epoch: 20, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.098139762878418
Epoch: 21, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1753630638122559
Epoch: 22, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1332039833068848
Epoch: 23, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0698959827423096
Epoch: 24, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2329888343811035
Epoch: 25, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.346 Vali Acc: 0.833 Test Loss: 0.346 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0820095539093018
Epoch: 26, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.318 Vali Acc: 0.872 Test Loss: 0.318 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 351094
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9762380123138428
Epoch: 1, Steps: 12 | Train Loss: 1.782 Vali Loss: 1.462 Vali Acc: 0.450 Test Loss: 1.462 Test Acc: 0.450
Validation loss decreased (inf --> -0.449985).  Saving model ...
Epoch: 2 cost time: 1.177140712738037
Epoch: 2, Steps: 12 | Train Loss: 1.321 Vali Loss: 0.969 Vali Acc: 0.667 Test Loss: 0.969 Test Acc: 0.667
Validation loss decreased (-0.449985 --> -0.666657).  Saving model ...
Epoch: 3 cost time: 1.072206735610962
Epoch: 3, Steps: 12 | Train Loss: 0.853 Vali Loss: 0.714 Vali Acc: 0.717 Test Loss: 0.714 Test Acc: 0.717
Validation loss decreased (-0.666657 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 1.1635768413543701
Epoch: 4, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.570 Vali Acc: 0.733 Test Loss: 0.570 Test Acc: 0.733
Validation loss decreased (-0.716660 --> -0.733328).  Saving model ...
Epoch: 5 cost time: 1.1813750267028809
Epoch: 5, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.484 Vali Acc: 0.783 Test Loss: 0.484 Test Acc: 0.783
Validation loss decreased (-0.733328 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 1.2134270668029785
Epoch: 6, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.449 Vali Acc: 0.800 Test Loss: 0.449 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 1.112442970275879
Epoch: 7, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.409 Vali Acc: 0.833 Test Loss: 0.409 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 1.3286519050598145
Epoch: 8, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.398 Vali Acc: 0.811 Test Loss: 0.398 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1725525856018066
Epoch: 9, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.379 Vali Acc: 0.817 Test Loss: 0.379 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1543633937835693
Epoch: 10, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.371 Vali Acc: 0.828 Test Loss: 0.371 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0056662559509277
Epoch: 11, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.348 Vali Acc: 0.856 Test Loss: 0.348 Test Acc: 0.856
Validation loss decreased (-0.833329 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 1.2233726978302002
Epoch: 12, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.315359354019165
Epoch: 13, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.339 Vali Acc: 0.828 Test Loss: 0.339 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2038257122039795
Epoch: 14, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.855552 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 1.1063134670257568
Epoch: 15, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2757418155670166
Epoch: 16, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0158779621124268
Epoch: 17, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.306 Vali Acc: 0.833 Test Loss: 0.306 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2520158290863037
Epoch: 18, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.132871389389038
Epoch: 19, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.253798246383667
Epoch: 20, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 1.2182135581970215
Epoch: 21, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2060275077819824
Epoch: 22, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.316 Vali Acc: 0.839 Test Loss: 0.316 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2530999183654785
Epoch: 23, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2095255851745605
Epoch: 24, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2442171573638916
Epoch: 25, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 1.1562998294830322
Epoch: 26, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.231130838394165
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1018013954162598
Epoch: 28, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3132100105285645
Epoch: 29, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.090583324432373
Epoch: 30, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 31 cost time: 1.2053287029266357
Epoch: 31, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.130533218383789
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.158332109451294
Epoch: 33, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.009345531463623
Epoch: 34, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0196797847747803
Epoch: 35, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.375 Vali Acc: 0.839 Test Loss: 0.375 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0774962902069092
Epoch: 36, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.173835277557373
Epoch: 37, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0346736907958984
Epoch: 38, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2357559204101562
Epoch: 39, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.341 Vali Acc: 0.872 Test Loss: 0.341 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.269094705581665
Epoch: 40, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 41 cost time: 1.2655255794525146
Epoch: 41, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0831973552703857
Epoch: 42, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1259875297546387
Epoch: 43, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.391200304031372
Epoch: 44, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.330 Vali Acc: 0.883 Test Loss: 0.330 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2712092399597168
Epoch: 45, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.355 Vali Acc: 0.861 Test Loss: 0.355 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2535443305969238
Epoch: 46, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.329 Vali Acc: 0.872 Test Loss: 0.329 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3098185062408447
Epoch: 47, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 48 cost time: 1.3631343841552734
Epoch: 48, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1970860958099365
Epoch: 49, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1548371315002441
Epoch: 50, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1721844673156738
Epoch: 51, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.1129770278930664
Epoch: 52, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.327 Vali Acc: 0.894 Test Loss: 0.327 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.2106678485870361
Epoch: 53, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.391 Vali Acc: 0.878 Test Loss: 0.391 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0949113368988037
Epoch: 54, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.0731773376464844
Epoch: 55, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.262305736541748
Epoch: 56, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.1746463775634766
Epoch: 57, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 220022
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.783390522003174
Epoch: 1, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.446 Vali Acc: 0.483 Test Loss: 1.446 Test Acc: 0.483
Validation loss decreased (inf --> -0.483319).  Saving model ...
Epoch: 2 cost time: 1.176621437072754
Epoch: 2, Steps: 12 | Train Loss: 1.311 Vali Loss: 0.961 Vali Acc: 0.667 Test Loss: 0.961 Test Acc: 0.667
Validation loss decreased (-0.483319 --> -0.666657).  Saving model ...
Epoch: 3 cost time: 1.1685638427734375
Epoch: 3, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.707 Vali Acc: 0.733 Test Loss: 0.707 Test Acc: 0.733
Validation loss decreased (-0.666657 --> -0.733326).  Saving model ...
Epoch: 4 cost time: 1.1880254745483398
Epoch: 4, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.566 Vali Acc: 0.744 Test Loss: 0.566 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744439).  Saving model ...
Epoch: 5 cost time: 1.0914065837860107
Epoch: 5, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.478 Vali Acc: 0.783 Test Loss: 0.478 Test Acc: 0.783
Validation loss decreased (-0.744439 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 1.2109405994415283
Epoch: 6, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.445 Vali Acc: 0.800 Test Loss: 0.445 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 1.0618889331817627
Epoch: 7, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.404 Vali Acc: 0.844 Test Loss: 0.404 Test Acc: 0.844
Validation loss decreased (-0.799996 --> -0.844440).  Saving model ...
Epoch: 8 cost time: 1.1135754585266113
Epoch: 8, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.391 Vali Acc: 0.822 Test Loss: 0.391 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2771425247192383
Epoch: 9, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.373 Vali Acc: 0.817 Test Loss: 0.373 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.136275053024292
Epoch: 10, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.256239652633667
Epoch: 11, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.341 Vali Acc: 0.856 Test Loss: 0.341 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 1.1837246417999268
Epoch: 12, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 1.1666874885559082
Epoch: 13, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.331 Vali Acc: 0.839 Test Loss: 0.331 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0863773822784424
Epoch: 14, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.855552 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.9669625759124756
Epoch: 15, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9555759429931641
Epoch: 16, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.270932674407959
Epoch: 17, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.299 Vali Acc: 0.844 Test Loss: 0.299 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1962220668792725
Epoch: 18, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.2202835083007812
Epoch: 19, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1970481872558594
Epoch: 20, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 1.252946376800537
Epoch: 21, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.266270399093628
Epoch: 22, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3658788204193115
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1548728942871094
Epoch: 24, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0905070304870605
Epoch: 25, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 1.0854146480560303
Epoch: 26, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.261629581451416
Epoch: 27, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1558644771575928
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 29 cost time: 1.3156647682189941
Epoch: 29, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2426984310150146
Epoch: 30, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2564218044281006
Epoch: 31, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2775144577026367
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.169614315032959
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2512953281402588
Epoch: 34, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2912747859954834
Epoch: 35, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.380 Vali Acc: 0.833 Test Loss: 0.380 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.2511024475097656
Epoch: 36, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.305 Vali Acc: 0.883 Test Loss: 0.305 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0970051288604736
Epoch: 37, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 38 cost time: 1.2346150875091553
Epoch: 38, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3904969692230225
Epoch: 39, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.336 Vali Acc: 0.872 Test Loss: 0.336 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3215258121490479
Epoch: 40, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2654101848602295
Epoch: 41, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1639142036437988
Epoch: 42, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.294 Vali Acc: 0.894 Test Loss: 0.294 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1987190246582031
Epoch: 43, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1801187992095947
Epoch: 44, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.5290892124176025
Epoch: 45, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.370 Vali Acc: 0.867 Test Loss: 0.370 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3362338542938232
Epoch: 46, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.316 Vali Acc: 0.872 Test Loss: 0.316 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.336904525756836
Epoch: 47, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 48 cost time: 1.2290282249450684
Epoch: 48, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1845064163208008
Epoch: 49, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3916208744049072
Epoch: 50, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0925579071044922
Epoch: 51, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0589959621429443
Epoch: 52, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.329 Vali Acc: 0.883 Test Loss: 0.329 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.0987238883972168
Epoch: 53, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.395 Vali Acc: 0.878 Test Loss: 0.395 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0934503078460693
Epoch: 54, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.0781588554382324
Epoch: 55, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.007941722869873
Epoch: 56, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.337 Vali Acc: 0.883 Test Loss: 0.337 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.3032112121582031
Epoch: 57, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.355 Vali Acc: 0.883 Test Loss: 0.355 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 220022
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7813098430633545
Epoch: 1, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.447 Vali Acc: 0.489 Test Loss: 1.447 Test Acc: 0.489
Validation loss decreased (inf --> -0.488874).  Saving model ...
Epoch: 2 cost time: 1.2482185363769531
Epoch: 2, Steps: 12 | Train Loss: 1.287 Vali Loss: 0.956 Vali Acc: 0.656 Test Loss: 0.956 Test Acc: 0.656
Validation loss decreased (-0.488874 --> -0.655546).  Saving model ...
Epoch: 3 cost time: 1.369103193283081
Epoch: 3, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.695 Vali Acc: 0.728 Test Loss: 0.695 Test Acc: 0.728
Validation loss decreased (-0.655546 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 1.3382482528686523
Epoch: 4, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.555 Vali Acc: 0.739 Test Loss: 0.555 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738883).  Saving model ...
Epoch: 5 cost time: 1.1494195461273193
Epoch: 5, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.466 Vali Acc: 0.794 Test Loss: 0.466 Test Acc: 0.794
Validation loss decreased (-0.738883 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 1.5089454650878906
Epoch: 6, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.434 Vali Acc: 0.800 Test Loss: 0.434 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 1.2821271419525146
Epoch: 7, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.395 Vali Acc: 0.856 Test Loss: 0.395 Test Acc: 0.856
Validation loss decreased (-0.799996 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 1.1308681964874268
Epoch: 8, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.380 Vali Acc: 0.822 Test Loss: 0.380 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2264022827148438
Epoch: 9, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.364 Vali Acc: 0.811 Test Loss: 0.364 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.276740550994873
Epoch: 10, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.240583896636963
Epoch: 11, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2141509056091309
Epoch: 12, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 1.0926010608673096
Epoch: 13, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.320 Vali Acc: 0.856 Test Loss: 0.320 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4786200523376465
Epoch: 14, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
Validation loss decreased (-0.855552 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 1.1535866260528564
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.296 Vali Acc: 0.839 Test Loss: 0.296 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3343162536621094
Epoch: 16, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2336652278900146
Epoch: 17, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.307 Vali Acc: 0.833 Test Loss: 0.307 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2746236324310303
Epoch: 18, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3244686126708984
Epoch: 19, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.266723871231079
Epoch: 20, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2910163402557373
Epoch: 21, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1744732856750488
Epoch: 22, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.296 Vali Acc: 0.861 Test Loss: 0.296 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.097956657409668
Epoch: 23, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3211917877197266
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 1.3086848258972168
Epoch: 25, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1691584587097168
Epoch: 26, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1967201232910156
Epoch: 27, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.243994951248169
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.126183271408081
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4389464855194092
Epoch: 30, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.316620111465454
Epoch: 31, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.328010082244873
Epoch: 32, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.3429534435272217
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.268 Vali Acc: 0.872 Test Loss: 0.268 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2557778358459473
Epoch: 34, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 220022
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1469390392303467
Epoch: 1, Steps: 12 | Train Loss: 1.721 Vali Loss: 1.476 Vali Acc: 0.517 Test Loss: 1.476 Test Acc: 0.517
Validation loss decreased (inf --> -0.516652).  Saving model ...
Epoch: 2 cost time: 1.0932157039642334
Epoch: 2, Steps: 12 | Train Loss: 1.295 Vali Loss: 1.014 Vali Acc: 0.700 Test Loss: 1.014 Test Acc: 0.700
Validation loss decreased (-0.516652 --> -0.699990).  Saving model ...
Epoch: 3 cost time: 1.1235897541046143
Epoch: 3, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.747 Vali Acc: 0.750 Test Loss: 0.747 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 0.9955861568450928
Epoch: 4, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.598 Vali Acc: 0.739 Test Loss: 0.598 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0736513137817383
Epoch: 5, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.495 Vali Acc: 0.789 Test Loss: 0.495 Test Acc: 0.789
Validation loss decreased (-0.749993 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 1.0388028621673584
Epoch: 6, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.461 Vali Acc: 0.800 Test Loss: 0.461 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799995).  Saving model ...
Epoch: 7 cost time: 1.07344388961792
Epoch: 7, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.419 Vali Acc: 0.822 Test Loss: 0.419 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 0.9589881896972656
Epoch: 8, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.405 Vali Acc: 0.811 Test Loss: 0.405 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1523454189300537
Epoch: 9, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.397 Vali Acc: 0.800 Test Loss: 0.397 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9946646690368652
Epoch: 10, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.380 Vali Acc: 0.811 Test Loss: 0.380 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.064138650894165
Epoch: 11, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0610394477844238
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.358 Vali Acc: 0.828 Test Loss: 0.358 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 0.9882426261901855
Epoch: 13, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.361 Vali Acc: 0.811 Test Loss: 0.361 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1216580867767334
Epoch: 14, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.329 Vali Acc: 0.878 Test Loss: 0.329 Test Acc: 0.878
Validation loss decreased (-0.827774 --> -0.877774).  Saving model ...
Epoch: 15 cost time: 1.1313447952270508
Epoch: 15, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0736167430877686
Epoch: 16, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0436081886291504
Epoch: 17, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.355 Vali Acc: 0.817 Test Loss: 0.355 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0838420391082764
Epoch: 18, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.330 Vali Acc: 0.856 Test Loss: 0.330 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0548429489135742
Epoch: 19, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.313 Vali Acc: 0.839 Test Loss: 0.313 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0849933624267578
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1470587253570557
Epoch: 21, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.303 Vali Acc: 0.844 Test Loss: 0.303 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0364654064178467
Epoch: 22, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.331 Vali Acc: 0.822 Test Loss: 0.331 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1089718341827393
Epoch: 23, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3588061332702637
Epoch: 24, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 220022
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.437150716781616
Epoch: 1, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.427 Vali Acc: 0.494 Test Loss: 1.427 Test Acc: 0.494
Validation loss decreased (inf --> -0.494430).  Saving model ...
Epoch: 2 cost time: 1.3526432514190674
Epoch: 2, Steps: 12 | Train Loss: 1.186 Vali Loss: 0.944 Vali Acc: 0.678 Test Loss: 0.944 Test Acc: 0.678
Validation loss decreased (-0.494430 --> -0.677768).  Saving model ...
Epoch: 3 cost time: 1.1211254596710205
Epoch: 3, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.715 Vali Acc: 0.694 Test Loss: 0.715 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694437).  Saving model ...
Epoch: 4 cost time: 1.3712365627288818
Epoch: 4, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.574 Vali Acc: 0.739 Test Loss: 0.574 Test Acc: 0.739
Validation loss decreased (-0.694437 --> -0.738883).  Saving model ...
Epoch: 5 cost time: 1.1139371395111084
Epoch: 5, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.498 Vali Acc: 0.750 Test Loss: 0.498 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749995).  Saving model ...
Epoch: 6 cost time: 1.0677900314331055
Epoch: 6, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.445 Vali Acc: 0.772 Test Loss: 0.445 Test Acc: 0.772
Validation loss decreased (-0.749995 --> -0.772218).  Saving model ...
Epoch: 7 cost time: 1.2600626945495605
Epoch: 7, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.405 Vali Acc: 0.778 Test Loss: 0.405 Test Acc: 0.778
Validation loss decreased (-0.772218 --> -0.777774).  Saving model ...
Epoch: 8 cost time: 1.0099623203277588
Epoch: 8, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.402 Vali Acc: 0.806 Test Loss: 0.402 Test Acc: 0.806
Validation loss decreased (-0.777774 --> -0.805552).  Saving model ...
Epoch: 9 cost time: 1.3371922969818115
Epoch: 9, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.364 Vali Acc: 0.839 Test Loss: 0.364 Test Acc: 0.839
Validation loss decreased (-0.805552 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 1.1938464641571045
Epoch: 10, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.359 Vali Acc: 0.828 Test Loss: 0.359 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.228158950805664
Epoch: 11, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.366 Vali Acc: 0.817 Test Loss: 0.366 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.16432523727417
Epoch: 12, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.362 Vali Acc: 0.844 Test Loss: 0.362 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 13 cost time: 1.2345983982086182
Epoch: 13, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.371 Vali Acc: 0.822 Test Loss: 0.371 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1838674545288086
Epoch: 14, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.374 Vali Acc: 0.850 Test Loss: 0.374 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 1.224113941192627
Epoch: 15, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.111208438873291
Epoch: 16, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.340 Vali Acc: 0.839 Test Loss: 0.340 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.979074239730835
Epoch: 17, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 1.22389817237854
Epoch: 18, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.344 Vali Acc: 0.833 Test Loss: 0.344 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1663851737976074
Epoch: 19, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 20 cost time: 1.200385332107544
Epoch: 20, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.320 Vali Acc: 0.872 Test Loss: 0.320 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 21 cost time: 0.9904623031616211
Epoch: 21, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0259268283843994
Epoch: 22, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.315 Vali Acc: 0.856 Test Loss: 0.315 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2626049518585205
Epoch: 23, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.342 Vali Acc: 0.850 Test Loss: 0.342 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.089078664779663
Epoch: 24, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.332 Vali Acc: 0.856 Test Loss: 0.332 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1792163848876953
Epoch: 25, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 26 cost time: 1.1967127323150635
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1208012104034424
Epoch: 27, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.326 Vali Acc: 0.861 Test Loss: 0.326 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0571925640106201
Epoch: 28, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.322 Vali Acc: 0.883 Test Loss: 0.322 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 29 cost time: 1.0640959739685059
Epoch: 29, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 1.2515885829925537
Epoch: 30, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.364 Vali Acc: 0.844 Test Loss: 0.364 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2083358764648438
Epoch: 31, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.218332290649414
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.272432565689087
Epoch: 33, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2923798561096191
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.333 Vali Acc: 0.894 Test Loss: 0.333 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1098883152008057
Epoch: 35, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.327 Vali Acc: 0.872 Test Loss: 0.327 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.220564365386963
Epoch: 36, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 1.178785800933838
Epoch: 37, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1283597946166992
Epoch: 38, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.302 Vali Acc: 0.911 Test Loss: 0.302 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2005460262298584
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0433273315429688
Epoch: 40, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1753571033477783
Epoch: 41, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0355775356292725
Epoch: 42, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1357784271240234
Epoch: 43, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.392 Vali Acc: 0.856 Test Loss: 0.392 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1539547443389893
Epoch: 44, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.408 Vali Acc: 0.872 Test Loss: 0.408 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.079484462738037
Epoch: 45, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.1599628925323486
Epoch: 46, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 154486
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6635944843292236
Epoch: 1, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.421 Vali Acc: 0.533 Test Loss: 1.421 Test Acc: 0.533
Validation loss decreased (inf --> -0.533319).  Saving model ...
Epoch: 2 cost time: 1.3371894359588623
Epoch: 2, Steps: 12 | Train Loss: 1.180 Vali Loss: 0.938 Vali Acc: 0.661 Test Loss: 0.938 Test Acc: 0.661
Validation loss decreased (-0.533319 --> -0.661102).  Saving model ...
Epoch: 3 cost time: 1.0971667766571045
Epoch: 3, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.707 Vali Acc: 0.700 Test Loss: 0.707 Test Acc: 0.700
Validation loss decreased (-0.661102 --> -0.699993).  Saving model ...
Epoch: 4 cost time: 1.0878620147705078
Epoch: 4, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.566 Vali Acc: 0.739 Test Loss: 0.566 Test Acc: 0.739
Validation loss decreased (-0.699993 --> -0.738883).  Saving model ...
Epoch: 5 cost time: 1.1097838878631592
Epoch: 5, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.492 Vali Acc: 0.761 Test Loss: 0.492 Test Acc: 0.761
Validation loss decreased (-0.738883 --> -0.761106).  Saving model ...
Epoch: 6 cost time: 1.2212028503417969
Epoch: 6, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.435 Vali Acc: 0.783 Test Loss: 0.435 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 1.2422564029693604
Epoch: 7, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.395 Vali Acc: 0.789 Test Loss: 0.395 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 8 cost time: 0.9661722183227539
Epoch: 8, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.395 Vali Acc: 0.806 Test Loss: 0.395 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805552).  Saving model ...
Epoch: 9 cost time: 1.0230131149291992
Epoch: 9, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.355 Vali Acc: 0.850 Test Loss: 0.355 Test Acc: 0.850
Validation loss decreased (-0.805552 --> -0.849996).  Saving model ...
Epoch: 10 cost time: 1.109520435333252
Epoch: 10, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2500126361846924
Epoch: 11, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.357 Vali Acc: 0.811 Test Loss: 0.357 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1425435543060303
Epoch: 12, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.350 Vali Acc: 0.833 Test Loss: 0.350 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1731595993041992
Epoch: 13, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.365 Vali Acc: 0.822 Test Loss: 0.365 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3865206241607666
Epoch: 14, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.363 Vali Acc: 0.856 Test Loss: 0.363 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 1.2538034915924072
Epoch: 15, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.359865665435791
Epoch: 16, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.331 Vali Acc: 0.839 Test Loss: 0.331 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3945231437683105
Epoch: 17, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.329 Vali Acc: 0.856 Test Loss: 0.329 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 1.3431715965270996
Epoch: 18, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.326 Vali Acc: 0.839 Test Loss: 0.326 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1760599613189697
Epoch: 19, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 20 cost time: 1.1752209663391113
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.312 Vali Acc: 0.878 Test Loss: 0.312 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 1.4035937786102295
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.245147705078125
Epoch: 22, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2594945430755615
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.329 Vali Acc: 0.844 Test Loss: 0.329 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2430922985076904
Epoch: 24, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.139171838760376
Epoch: 25, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 1.1307094097137451
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.312 Vali Acc: 0.872 Test Loss: 0.312 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2184076309204102
Epoch: 27, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.318 Vali Acc: 0.872 Test Loss: 0.318 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.214165210723877
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2517001628875732
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.236581802368164
Epoch: 30, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.363 Vali Acc: 0.844 Test Loss: 0.363 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3549118041992188
Epoch: 31, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2216169834136963
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 33 cost time: 1.164726734161377
Epoch: 33, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.274718999862671
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.303 Vali Acc: 0.894 Test Loss: 0.303 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3110833168029785
Epoch: 35, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3860127925872803
Epoch: 36, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.416982889175415
Epoch: 37, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1769075393676758
Epoch: 38, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1989336013793945
Epoch: 39, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.207848310470581
Epoch: 40, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.310 Vali Acc: 0.883 Test Loss: 0.310 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.4226222038269043
Epoch: 41, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.318 Vali Acc: 0.906 Test Loss: 0.318 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2918434143066406
Epoch: 42, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 154486
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2275068759918213
Epoch: 1, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.404 Vali Acc: 0.572 Test Loss: 1.404 Test Acc: 0.572
Validation loss decreased (inf --> -0.572208).  Saving model ...
Epoch: 2 cost time: 1.1054925918579102
Epoch: 2, Steps: 12 | Train Loss: 1.180 Vali Loss: 0.926 Vali Acc: 0.689 Test Loss: 0.926 Test Acc: 0.689
Validation loss decreased (-0.572208 --> -0.688880).  Saving model ...
Epoch: 3 cost time: 1.2077600955963135
Epoch: 3, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.695 Vali Acc: 0.717 Test Loss: 0.695 Test Acc: 0.717
Validation loss decreased (-0.688880 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 1.3594202995300293
Epoch: 4, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.557 Vali Acc: 0.733 Test Loss: 0.557 Test Acc: 0.733
Validation loss decreased (-0.716660 --> -0.733328).  Saving model ...
Epoch: 5 cost time: 1.3225524425506592
Epoch: 5, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.476 Vali Acc: 0.756 Test Loss: 0.476 Test Acc: 0.756
Validation loss decreased (-0.733328 --> -0.755551).  Saving model ...
Epoch: 6 cost time: 1.2198247909545898
Epoch: 6, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.416 Vali Acc: 0.783 Test Loss: 0.416 Test Acc: 0.783
Validation loss decreased (-0.755551 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 1.2241673469543457
Epoch: 7, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.381 Vali Acc: 0.811 Test Loss: 0.381 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 1.2181637287139893
Epoch: 8, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.385 Vali Acc: 0.811 Test Loss: 0.385 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.290480375289917
Epoch: 9, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.344 Vali Acc: 0.839 Test Loss: 0.344 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 1.3442704677581787
Epoch: 10, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.336 Vali Acc: 0.833 Test Loss: 0.336 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0149457454681396
Epoch: 11, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.348 Vali Acc: 0.811 Test Loss: 0.348 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.159916639328003
Epoch: 12, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 1.161501407623291
Epoch: 13, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.351 Vali Acc: 0.833 Test Loss: 0.351 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4242112636566162
Epoch: 14, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.352 Vali Acc: 0.850 Test Loss: 0.352 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 1.1928801536560059
Epoch: 15, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 1.2266550064086914
Epoch: 16, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.322 Vali Acc: 0.828 Test Loss: 0.322 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.185204267501831
Epoch: 17, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 1.2063708305358887
Epoch: 18, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2279112339019775
Epoch: 19, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 20 cost time: 1.1918623447418213
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3296358585357666
Epoch: 21, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 1.2869701385498047
Epoch: 22, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.262382984161377
Epoch: 23, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.330 Vali Acc: 0.833 Test Loss: 0.330 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.016829490661621
Epoch: 24, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.315 Vali Acc: 0.861 Test Loss: 0.315 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0888423919677734
Epoch: 25, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 1.1818413734436035
Epoch: 26, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1076419353485107
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0516679286956787
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 29 cost time: 1.0552403926849365
Epoch: 29, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3649766445159912
Epoch: 30, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4443650245666504
Epoch: 31, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 32 cost time: 1.230555772781372
Epoch: 32, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 33 cost time: 1.3098788261413574
Epoch: 33, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.117415428161621
Epoch: 34, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.281 Vali Acc: 0.911 Test Loss: 0.281 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 35 cost time: 1.0772705078125
Epoch: 35, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.314 Vali Acc: 0.872 Test Loss: 0.314 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0624983310699463
Epoch: 36, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.281 Vali Acc: 0.906 Test Loss: 0.281 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2417783737182617
Epoch: 37, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.284330129623413
Epoch: 38, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2925660610198975
Epoch: 39, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.379377841949463
Epoch: 40, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.348768949508667
Epoch: 41, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.306297779083252
Epoch: 42, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.3656811714172363
Epoch: 43, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.387 Vali Acc: 0.872 Test Loss: 0.387 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2462413311004639
Epoch: 44, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 154486
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.584911346435547
Epoch: 1, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.440 Vali Acc: 0.556 Test Loss: 1.440 Test Acc: 0.556
Validation loss decreased (inf --> -0.555541).  Saving model ...
Epoch: 2 cost time: 1.1493480205535889
Epoch: 2, Steps: 12 | Train Loss: 1.198 Vali Loss: 0.979 Vali Acc: 0.689 Test Loss: 0.979 Test Acc: 0.689
Validation loss decreased (-0.555541 --> -0.688879).  Saving model ...
Epoch: 3 cost time: 1.131673812866211
Epoch: 3, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.724 Vali Acc: 0.706 Test Loss: 0.724 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705548).  Saving model ...
Epoch: 4 cost time: 1.1641120910644531
Epoch: 4, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.581 Vali Acc: 0.733 Test Loss: 0.581 Test Acc: 0.733
Validation loss decreased (-0.705548 --> -0.733328).  Saving model ...
Epoch: 5 cost time: 1.1238324642181396
Epoch: 5, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.494 Vali Acc: 0.772 Test Loss: 0.494 Test Acc: 0.772
Validation loss decreased (-0.733328 --> -0.772217).  Saving model ...
Epoch: 6 cost time: 1.0043697357177734
Epoch: 6, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.434 Vali Acc: 0.789 Test Loss: 0.434 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788885).  Saving model ...
Epoch: 7 cost time: 0.9830112457275391
Epoch: 7, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.398 Vali Acc: 0.817 Test Loss: 0.398 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.0807287693023682
Epoch: 8, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.401 Vali Acc: 0.789 Test Loss: 0.401 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0480353832244873
Epoch: 9, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 1.079350471496582
Epoch: 10, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.355 Vali Acc: 0.806 Test Loss: 0.355 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.019324779510498
Epoch: 11, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.360 Vali Acc: 0.806 Test Loss: 0.360 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.184643030166626
Epoch: 12, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.352 Vali Acc: 0.822 Test Loss: 0.352 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 13 cost time: 1.0569710731506348
Epoch: 13, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.251121997833252
Epoch: 14, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.363 Vali Acc: 0.828 Test Loss: 0.363 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 15 cost time: 1.25083327293396
Epoch: 15, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.336 Vali Acc: 0.822 Test Loss: 0.336 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2183375358581543
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.345 Vali Acc: 0.817 Test Loss: 0.345 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2189898490905762
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.328 Vali Acc: 0.822 Test Loss: 0.328 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2448554039001465
Epoch: 18, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.331 Vali Acc: 0.833 Test Loss: 0.331 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 19 cost time: 1.2482922077178955
Epoch: 19, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855553).  Saving model ...
Epoch: 20 cost time: 1.310730218887329
Epoch: 20, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3193068504333496
Epoch: 21, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
Validation loss decreased (-0.855553 --> -0.855553).  Saving model ...
Epoch: 22 cost time: 1.110011100769043
Epoch: 22, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872219).  Saving model ...
Epoch: 23 cost time: 1.2085139751434326
Epoch: 23, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.324 Vali Acc: 0.828 Test Loss: 0.324 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.314403772354126
Epoch: 24, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1230075359344482
Epoch: 25, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0734217166900635
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.318 Vali Acc: 0.839 Test Loss: 0.318 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.093362808227539
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0593681335449219
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1742796897888184
Epoch: 29, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.290 Vali Acc: 0.839 Test Loss: 0.290 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0643980503082275
Epoch: 30, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0894670486450195
Epoch: 31, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.275 Vali Acc: 0.878 Test Loss: 0.275 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 32 cost time: 1.223200798034668
Epoch: 32, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 1.0699102878570557
Epoch: 33, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1644537448883057
Epoch: 34, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1116127967834473
Epoch: 35, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.344 Vali Acc: 0.861 Test Loss: 0.344 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0316214561462402
Epoch: 36, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0610873699188232
Epoch: 37, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.122894287109375
Epoch: 38, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0249381065368652
Epoch: 39, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9787032604217529
Epoch: 40, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.082383155822754
Epoch: 41, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2292437553405762
Epoch: 42, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 154486
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.538547992706299
Epoch: 1, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.482 Vali Acc: 0.522 Test Loss: 1.482 Test Acc: 0.522
Validation loss decreased (inf --> -0.522207).  Saving model ...
Epoch: 2 cost time: 1.1520202159881592
Epoch: 2, Steps: 12 | Train Loss: 1.239 Vali Loss: 1.012 Vali Acc: 0.689 Test Loss: 1.012 Test Acc: 0.689
Validation loss decreased (-0.522207 --> -0.688879).  Saving model ...
Epoch: 3 cost time: 1.292210578918457
Epoch: 3, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.737 Vali Acc: 0.711 Test Loss: 0.737 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.1322734355926514
Epoch: 4, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.607 Vali Acc: 0.700 Test Loss: 0.607 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1386816501617432
Epoch: 5, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.499 Vali Acc: 0.783 Test Loss: 0.499 Test Acc: 0.783
Validation loss decreased (-0.711104 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 1.1549029350280762
Epoch: 6, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.444 Vali Acc: 0.767 Test Loss: 0.444 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.266695261001587
Epoch: 7, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.424 Vali Acc: 0.811 Test Loss: 0.424 Test Acc: 0.811
Validation loss decreased (-0.783328 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 1.2259931564331055
Epoch: 8, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.408 Vali Acc: 0.800 Test Loss: 0.408 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1145801544189453
Epoch: 9, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.387 Vali Acc: 0.817 Test Loss: 0.387 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 1.158836841583252
Epoch: 10, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.362 Vali Acc: 0.811 Test Loss: 0.362 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3523948192596436
Epoch: 11, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.376 Vali Acc: 0.806 Test Loss: 0.376 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2626473903656006
Epoch: 12, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.354 Vali Acc: 0.811 Test Loss: 0.354 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.157602310180664
Epoch: 13, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.329 Vali Acc: 0.861 Test Loss: 0.329 Test Acc: 0.861
Validation loss decreased (-0.816663 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 1.2578487396240234
Epoch: 14, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.313 Vali Acc: 0.878 Test Loss: 0.313 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.2302908897399902
Epoch: 15, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.322 Vali Acc: 0.828 Test Loss: 0.322 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2618463039398193
Epoch: 16, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.2766549587249756
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.15329909324646
Epoch: 18, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1524457931518555
Epoch: 19, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.340 Vali Acc: 0.839 Test Loss: 0.340 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1004467010498047
Epoch: 20, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.306 Vali Acc: 0.867 Test Loss: 0.306 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3038489818572998
Epoch: 21, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 22 cost time: 1.0857315063476562
Epoch: 22, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1966047286987305
Epoch: 23, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 1.2204115390777588
Epoch: 24, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1558606624603271
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2387216091156006
Epoch: 26, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.354 Vali Acc: 0.839 Test Loss: 0.354 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3119473457336426
Epoch: 27, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2895011901855469
Epoch: 28, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.310 Vali Acc: 0.878 Test Loss: 0.310 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1801118850708008
Epoch: 29, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.349 Vali Acc: 0.850 Test Loss: 0.349 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1600332260131836
Epoch: 30, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.311 Vali Acc: 0.867 Test Loss: 0.311 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0282301902770996
Epoch: 31, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 32 cost time: 1.0853984355926514
Epoch: 32, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0700373649597168
Epoch: 33, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0311486721038818
Epoch: 34, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.314 Vali Acc: 0.883 Test Loss: 0.314 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.306614875793457
Epoch: 35, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3305611610412598
Epoch: 36, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1770410537719727
Epoch: 37, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2170097827911377
Epoch: 38, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.200561761856079
Epoch: 39, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0538418292999268
Epoch: 40, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.309 Vali Acc: 0.872 Test Loss: 0.309 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.2527992725372314
Epoch: 41, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 121718
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.690354347229004
Epoch: 1, Steps: 12 | Train Loss: 1.742 Vali Loss: 1.475 Vali Acc: 0.517 Test Loss: 1.475 Test Acc: 0.517
Validation loss decreased (inf --> -0.516652).  Saving model ...
Epoch: 2 cost time: 1.2601161003112793
Epoch: 2, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.009 Vali Acc: 0.667 Test Loss: 1.009 Test Acc: 0.667
Validation loss decreased (-0.516652 --> -0.666657).  Saving model ...
Epoch: 3 cost time: 1.3424482345581055
Epoch: 3, Steps: 12 | Train Loss: 0.837 Vali Loss: 0.736 Vali Acc: 0.700 Test Loss: 0.736 Test Acc: 0.700
Validation loss decreased (-0.666657 --> -0.699993).  Saving model ...
Epoch: 4 cost time: 1.3286547660827637
Epoch: 4, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.606 Vali Acc: 0.700 Test Loss: 0.606 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699994).  Saving model ...
Epoch: 5 cost time: 1.5736942291259766
Epoch: 5, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.495 Vali Acc: 0.800 Test Loss: 0.495 Test Acc: 0.800
Validation loss decreased (-0.699994 --> -0.799995).  Saving model ...
Epoch: 6 cost time: 1.375324010848999
Epoch: 6, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.444 Vali Acc: 0.767 Test Loss: 0.444 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5788586139678955
Epoch: 7, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.419 Vali Acc: 0.833 Test Loss: 0.419 Test Acc: 0.833
Validation loss decreased (-0.799995 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 1.2664551734924316
Epoch: 8, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.401 Vali Acc: 0.806 Test Loss: 0.401 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3737587928771973
Epoch: 9, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.383 Vali Acc: 0.822 Test Loss: 0.383 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1500415802001953
Epoch: 10, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3149569034576416
Epoch: 11, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.373 Vali Acc: 0.817 Test Loss: 0.373 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.36171293258667
Epoch: 12, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.350 Vali Acc: 0.811 Test Loss: 0.350 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2589104175567627
Epoch: 13, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.322 Vali Acc: 0.856 Test Loss: 0.322 Test Acc: 0.856
Validation loss decreased (-0.833329 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 1.2744300365447998
Epoch: 14, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.307 Vali Acc: 0.872 Test Loss: 0.307 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 1.2316038608551025
Epoch: 15, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.315 Vali Acc: 0.828 Test Loss: 0.315 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.157679796218872
Epoch: 16, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 1.3063719272613525
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 1.2333159446716309
Epoch: 18, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1343369483947754
Epoch: 19, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3861656188964844
Epoch: 20, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.297 Vali Acc: 0.872 Test Loss: 0.297 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3233437538146973
Epoch: 21, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 1.1227617263793945
Epoch: 22, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2116961479187012
Epoch: 23, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 1.207144021987915
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1278276443481445
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2291193008422852
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.338 Vali Acc: 0.839 Test Loss: 0.338 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1125211715698242
Epoch: 27, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.297 Vali Acc: 0.883 Test Loss: 0.297 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.115680456161499
Epoch: 28, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2661044597625732
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0579707622528076
Epoch: 30, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1373341083526611
Epoch: 31, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.011676549911499
Epoch: 32, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9977457523345947
Epoch: 33, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 121718
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3995094299316406
Epoch: 1, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.474 Vali Acc: 0.528 Test Loss: 1.474 Test Acc: 0.528
Validation loss decreased (inf --> -0.527763).  Saving model ...
Epoch: 2 cost time: 1.156341314315796
Epoch: 2, Steps: 12 | Train Loss: 1.230 Vali Loss: 0.998 Vali Acc: 0.689 Test Loss: 0.998 Test Acc: 0.689
Validation loss decreased (-0.527763 --> -0.688879).  Saving model ...
Epoch: 3 cost time: 1.1718995571136475
Epoch: 3, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.725 Vali Acc: 0.717 Test Loss: 0.725 Test Acc: 0.717
Validation loss decreased (-0.688879 --> -0.716659).  Saving model ...
Epoch: 4 cost time: 0.9605398178100586
Epoch: 4, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.597 Vali Acc: 0.711 Test Loss: 0.597 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1022837162017822
Epoch: 5, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.487 Vali Acc: 0.794 Test Loss: 0.487 Test Acc: 0.794
Validation loss decreased (-0.716659 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 1.3195326328277588
Epoch: 6, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.431 Vali Acc: 0.778 Test Loss: 0.431 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0739200115203857
Epoch: 7, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.408 Vali Acc: 0.833 Test Loss: 0.408 Test Acc: 0.833
Validation loss decreased (-0.794440 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 1.1925361156463623
Epoch: 8, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.390 Vali Acc: 0.817 Test Loss: 0.390 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1879680156707764
Epoch: 9, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.373 Vali Acc: 0.833 Test Loss: 0.373 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 1.0692288875579834
Epoch: 10, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.344 Vali Acc: 0.839 Test Loss: 0.344 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 0.9994747638702393
Epoch: 11, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0017330646514893
Epoch: 12, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.350 Vali Acc: 0.811 Test Loss: 0.350 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1225337982177734
Epoch: 13, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.1624505519866943
Epoch: 14, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
Validation loss decreased (-0.844441 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.0768628120422363
Epoch: 15, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.311 Vali Acc: 0.817 Test Loss: 0.311 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2083284854888916
Epoch: 16, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.3013854026794434
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1347858905792236
Epoch: 18, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.292494297027588
Epoch: 19, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.066366195678711
Epoch: 20, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2091169357299805
Epoch: 21, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 1.0185081958770752
Epoch: 22, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.181584119796753
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.293 Vali Acc: 0.883 Test Loss: 0.293 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2806947231292725
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1533656120300293
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2240536212921143
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4042925834655762
Epoch: 27, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2019329071044922
Epoch: 28, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1884105205535889
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.325 Vali Acc: 0.844 Test Loss: 0.325 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2688474655151367
Epoch: 30, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2642431259155273
Epoch: 31, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 1.223402738571167
Epoch: 32, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.269923210144043
Epoch: 33, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1800217628479004
Epoch: 34, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2329826354980469
Epoch: 35, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2751624584197998
Epoch: 36, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.275 Vali Acc: 0.878 Test Loss: 0.275 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1319730281829834
Epoch: 37, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2579829692840576
Epoch: 38, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.289860725402832
Epoch: 39, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2475976943969727
Epoch: 40, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1336157321929932
Epoch: 41, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.322 Vali Acc: 0.878 Test Loss: 0.322 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 121718
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3962111473083496
Epoch: 1, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.478 Vali Acc: 0.583 Test Loss: 1.478 Test Acc: 0.583
Validation loss decreased (inf --> -0.583319).  Saving model ...
Epoch: 2 cost time: 1.1434216499328613
Epoch: 2, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.018 Vali Acc: 0.722 Test Loss: 1.018 Test Acc: 0.722
Validation loss decreased (-0.583319 --> -0.722212).  Saving model ...
Epoch: 3 cost time: 1.1309082508087158
Epoch: 3, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.741 Vali Acc: 0.722 Test Loss: 0.741 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722215).  Saving model ...
Epoch: 4 cost time: 1.0080227851867676
Epoch: 4, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.610 Vali Acc: 0.689 Test Loss: 0.610 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2213890552520752
Epoch: 5, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.505 Vali Acc: 0.817 Test Loss: 0.505 Test Acc: 0.817
Validation loss decreased (-0.722215 --> -0.816662).  Saving model ...
Epoch: 6 cost time: 1.0938911437988281
Epoch: 6, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.446 Vali Acc: 0.778 Test Loss: 0.446 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1838374137878418
Epoch: 7, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.418 Vali Acc: 0.839 Test Loss: 0.418 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 1.234055519104004
Epoch: 8, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.400 Vali Acc: 0.817 Test Loss: 0.400 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1744000911712646
Epoch: 9, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.383 Vali Acc: 0.844 Test Loss: 0.383 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 1.0479793548583984
Epoch: 10, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.364 Vali Acc: 0.822 Test Loss: 0.364 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.097107172012329
Epoch: 11, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.383 Vali Acc: 0.806 Test Loss: 0.383 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.026012659072876
Epoch: 12, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.390 Vali Acc: 0.806 Test Loss: 0.390 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.199505090713501
Epoch: 13, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.357 Vali Acc: 0.817 Test Loss: 0.357 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3072729110717773
Epoch: 14, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.330 Vali Acc: 0.867 Test Loss: 0.330 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866663).  Saving model ...
Epoch: 15 cost time: 1.2814671993255615
Epoch: 15, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.350 Vali Acc: 0.806 Test Loss: 0.350 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0773472785949707
Epoch: 16, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 17 cost time: 0.8949909210205078
Epoch: 17, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9474606513977051
Epoch: 18, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.346 Vali Acc: 0.844 Test Loss: 0.346 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9528157711029053
Epoch: 19, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.356 Vali Acc: 0.817 Test Loss: 0.356 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0498631000518799
Epoch: 20, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0959312915802002
Epoch: 21, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 1.0444719791412354
Epoch: 22, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.120344877243042
Epoch: 23, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.306 Vali Acc: 0.867 Test Loss: 0.306 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0400514602661133
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.296 Vali Acc: 0.850 Test Loss: 0.296 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1614737510681152
Epoch: 25, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1626830101013184
Epoch: 26, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.444 Vali Acc: 0.817 Test Loss: 0.444 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.172165870666504
Epoch: 27, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2529242038726807
Epoch: 28, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1614274978637695
Epoch: 29, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1608057022094727
Epoch: 30, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.306 Vali Acc: 0.867 Test Loss: 0.306 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2237269878387451
Epoch: 31, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 121718
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.637650489807129
Epoch: 1, Steps: 12 | Train Loss: 1.644 Vali Loss: 1.378 Vali Acc: 0.522 Test Loss: 1.378 Test Acc: 0.522
Validation loss decreased (inf --> -0.522208).  Saving model ...
Epoch: 2 cost time: 1.0846574306488037
Epoch: 2, Steps: 12 | Train Loss: 1.191 Vali Loss: 0.937 Vali Acc: 0.717 Test Loss: 0.937 Test Acc: 0.717
Validation loss decreased (-0.522208 --> -0.716657).  Saving model ...
Epoch: 3 cost time: 1.1552822589874268
Epoch: 3, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.709 Vali Acc: 0.717 Test Loss: 0.709 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 1.1003446578979492
Epoch: 4, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.575 Vali Acc: 0.739 Test Loss: 0.575 Test Acc: 0.739
Validation loss decreased (-0.716660 --> -0.738883).  Saving model ...
Epoch: 5 cost time: 1.2214748859405518
Epoch: 5, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.522 Vali Acc: 0.733 Test Loss: 0.522 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1987993717193604
Epoch: 6, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.444 Vali Acc: 0.778 Test Loss: 0.444 Test Acc: 0.778
Validation loss decreased (-0.738883 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 1.3494508266448975
Epoch: 7, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.402 Vali Acc: 0.811 Test Loss: 0.402 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 1.0674922466278076
Epoch: 8, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.399 Vali Acc: 0.828 Test Loss: 0.399 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 1.234299659729004
Epoch: 9, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.368 Vali Acc: 0.789 Test Loss: 0.368 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1639108657836914
Epoch: 10, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 1.1882827281951904
Epoch: 11, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.338 Vali Acc: 0.833 Test Loss: 0.338 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2230582237243652
Epoch: 12, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1212749481201172
Epoch: 13, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.344 Vali Acc: 0.817 Test Loss: 0.344 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3356273174285889
Epoch: 14, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.344 Vali Acc: 0.844 Test Loss: 0.344 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 1.2378878593444824
Epoch: 15, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.350 Vali Acc: 0.828 Test Loss: 0.350 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.20941162109375
Epoch: 16, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.336 Vali Acc: 0.850 Test Loss: 0.336 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 17 cost time: 1.3412954807281494
Epoch: 17, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.316 Vali Acc: 0.839 Test Loss: 0.316 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1032159328460693
Epoch: 18, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 19 cost time: 1.2288463115692139
Epoch: 19, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 20 cost time: 1.2303240299224854
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 1.0242903232574463
Epoch: 21, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.321 Vali Acc: 0.861 Test Loss: 0.321 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0811848640441895
Epoch: 22, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0480914115905762
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0995686054229736
Epoch: 24, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.292 Vali Acc: 0.883 Test Loss: 0.292 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2385144233703613
Epoch: 25, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.281 Vali Acc: 0.906 Test Loss: 0.281 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 1.2085130214691162
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0556838512420654
Epoch: 27, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1571273803710938
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2868332862854004
Epoch: 29, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.297 Vali Acc: 0.872 Test Loss: 0.297 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2710151672363281
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.340 Vali Acc: 0.867 Test Loss: 0.340 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2528553009033203
Epoch: 31, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3445937633514404
Epoch: 32, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2901878356933594
Epoch: 33, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.198913812637329
Epoch: 34, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3418104648590088
Epoch: 35, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.313 Vali Acc: 0.878 Test Loss: 0.313 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 105334
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.310153007507324
Epoch: 1, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.374 Vali Acc: 0.522 Test Loss: 1.374 Test Acc: 0.522
Validation loss decreased (inf --> -0.522208).  Saving model ...
Epoch: 2 cost time: 1.1714787483215332
Epoch: 2, Steps: 12 | Train Loss: 1.186 Vali Loss: 0.936 Vali Acc: 0.711 Test Loss: 0.936 Test Acc: 0.711
Validation loss decreased (-0.522208 --> -0.711102).  Saving model ...
Epoch: 3 cost time: 1.2560293674468994
Epoch: 3, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.708 Vali Acc: 0.711 Test Loss: 0.708 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.243518352508545
Epoch: 4, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.576 Vali Acc: 0.728 Test Loss: 0.576 Test Acc: 0.728
Validation loss decreased (-0.711104 --> -0.727772).  Saving model ...
Epoch: 5 cost time: 1.1843678951263428
Epoch: 5, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.521 Vali Acc: 0.733 Test Loss: 0.521 Test Acc: 0.733
Validation loss decreased (-0.727772 --> -0.733328).  Saving model ...
Epoch: 6 cost time: 1.2120459079742432
Epoch: 6, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.444 Vali Acc: 0.772 Test Loss: 0.444 Test Acc: 0.772
Validation loss decreased (-0.733328 --> -0.772218).  Saving model ...
Epoch: 7 cost time: 0.9915690422058105
Epoch: 7, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.400 Vali Acc: 0.806 Test Loss: 0.400 Test Acc: 0.806
Validation loss decreased (-0.772218 --> -0.805552).  Saving model ...
Epoch: 8 cost time: 1.0738797187805176
Epoch: 8, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.394 Vali Acc: 0.822 Test Loss: 0.394 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 0.9454426765441895
Epoch: 9, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.363 Vali Acc: 0.800 Test Loss: 0.363 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.230623483657837
Epoch: 10, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.337 Vali Acc: 0.844 Test Loss: 0.337 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 1.1521854400634766
Epoch: 11, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2403197288513184
Epoch: 12, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.354 Vali Acc: 0.828 Test Loss: 0.354 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2397799491882324
Epoch: 13, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.339 Vali Acc: 0.817 Test Loss: 0.339 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1468369960784912
Epoch: 14, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.342 Vali Acc: 0.850 Test Loss: 0.342 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 1.2447583675384521
Epoch: 15, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.339 Vali Acc: 0.828 Test Loss: 0.339 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2361037731170654
Epoch: 16, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 17 cost time: 1.1346850395202637
Epoch: 17, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 18 cost time: 1.181628704071045
Epoch: 18, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 19 cost time: 1.1203346252441406
Epoch: 19, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 20 cost time: 1.2110400199890137
Epoch: 20, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.288 Vali Acc: 0.894 Test Loss: 0.288 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 1.114591360092163
Epoch: 21, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1826398372650146
Epoch: 22, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2202889919281006
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1047487258911133
Epoch: 24, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1294729709625244
Epoch: 25, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 1.2838380336761475
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0522947311401367
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.293 Vali Acc: 0.883 Test Loss: 0.293 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9957857131958008
Epoch: 28, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.297 Vali Acc: 0.883 Test Loss: 0.297 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0510377883911133
Epoch: 29, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.214874267578125
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.326 Vali Acc: 0.878 Test Loss: 0.326 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2040586471557617
Epoch: 31, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.294 Vali Acc: 0.894 Test Loss: 0.294 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2067904472351074
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.20430588722229
Epoch: 33, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.295 Vali Acc: 0.894 Test Loss: 0.295 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2716319561004639
Epoch: 34, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 35 cost time: 1.1197612285614014
Epoch: 35, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.314 Vali Acc: 0.878 Test Loss: 0.314 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1963684558868408
Epoch: 36, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.324 Vali Acc: 0.883 Test Loss: 0.324 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2099542617797852
Epoch: 37, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.404 Vali Acc: 0.844 Test Loss: 0.404 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2923099994659424
Epoch: 38, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.390 Vali Acc: 0.833 Test Loss: 0.390 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3242301940917969
Epoch: 39, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1224350929260254
Epoch: 40, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.374 Vali Acc: 0.867 Test Loss: 0.374 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.170412540435791
Epoch: 41, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.369 Vali Acc: 0.867 Test Loss: 0.369 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.117008924484253
Epoch: 42, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.196852207183838
Epoch: 43, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2005128860473633
Epoch: 44, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 105334
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.025214433670044
Epoch: 1, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.348 Vali Acc: 0.522 Test Loss: 1.348 Test Acc: 0.522
Validation loss decreased (inf --> -0.522209).  Saving model ...
Epoch: 2 cost time: 1.3117241859436035
Epoch: 2, Steps: 12 | Train Loss: 1.172 Vali Loss: 0.915 Vali Acc: 0.711 Test Loss: 0.915 Test Acc: 0.711
Validation loss decreased (-0.522209 --> -0.711102).  Saving model ...
Epoch: 3 cost time: 1.3913140296936035
Epoch: 3, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.686 Vali Acc: 0.711 Test Loss: 0.686 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.31191086769104
Epoch: 4, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.559 Vali Acc: 0.722 Test Loss: 0.559 Test Acc: 0.722
Validation loss decreased (-0.711104 --> -0.722217).  Saving model ...
Epoch: 5 cost time: 1.4443347454071045
Epoch: 5, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.504 Vali Acc: 0.733 Test Loss: 0.504 Test Acc: 0.733
Validation loss decreased (-0.722217 --> -0.733328).  Saving model ...
Epoch: 6 cost time: 1.4193224906921387
Epoch: 6, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.431 Vali Acc: 0.789 Test Loss: 0.431 Test Acc: 0.789
Validation loss decreased (-0.733328 --> -0.788885).  Saving model ...
Epoch: 7 cost time: 1.2622065544128418
Epoch: 7, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.385 Vali Acc: 0.817 Test Loss: 0.385 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.2422428131103516
Epoch: 8, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.379 Vali Acc: 0.822 Test Loss: 0.379 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 1.3730106353759766
Epoch: 9, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.352 Vali Acc: 0.811 Test Loss: 0.352 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3509960174560547
Epoch: 10, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 1.3353610038757324
Epoch: 11, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.326 Vali Acc: 0.828 Test Loss: 0.326 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3498499393463135
Epoch: 12, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.348 Vali Acc: 0.817 Test Loss: 0.348 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.20243239402771
Epoch: 13, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.326 Vali Acc: 0.817 Test Loss: 0.326 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.30889892578125
Epoch: 14, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.336 Vali Acc: 0.839 Test Loss: 0.336 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3717801570892334
Epoch: 15, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.344 Vali Acc: 0.817 Test Loss: 0.344 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3280565738677979
Epoch: 16, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.098701000213623
Epoch: 17, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.391310214996338
Epoch: 18, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3785476684570312
Epoch: 19, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 1.150359869003296
Epoch: 20, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 1.1998944282531738
Epoch: 21, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.533423900604248
Epoch: 22, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.340 Vali Acc: 0.833 Test Loss: 0.340 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3875629901885986
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2938518524169922
Epoch: 24, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3670272827148438
Epoch: 25, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 1.327117919921875
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2690544128417969
Epoch: 27, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5344510078430176
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5493998527526855
Epoch: 29, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.258831262588501
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.311 Vali Acc: 0.867 Test Loss: 0.311 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2634987831115723
Epoch: 31, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2199962139129639
Epoch: 32, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1654245853424072
Epoch: 33, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3541581630706787
Epoch: 34, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.312 Vali Acc: 0.878 Test Loss: 0.312 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3291099071502686
Epoch: 35, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 105334
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3199942111968994
Epoch: 1, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.410 Vali Acc: 0.550 Test Loss: 1.410 Test Acc: 0.550
Validation loss decreased (inf --> -0.549986).  Saving model ...
Epoch: 2 cost time: 0.9051854610443115
Epoch: 2, Steps: 12 | Train Loss: 1.201 Vali Loss: 0.988 Vali Acc: 0.694 Test Loss: 0.988 Test Acc: 0.694
Validation loss decreased (-0.549986 --> -0.694435).  Saving model ...
Epoch: 3 cost time: 1.1701829433441162
Epoch: 3, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.742 Vali Acc: 0.733 Test Loss: 0.742 Test Acc: 0.733
Validation loss decreased (-0.694435 --> -0.733326).  Saving model ...
Epoch: 4 cost time: 1.0875244140625
Epoch: 4, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.603 Vali Acc: 0.711 Test Loss: 0.603 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.160534381866455
Epoch: 5, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.535 Vali Acc: 0.733 Test Loss: 0.535 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733328).  Saving model ...
Epoch: 6 cost time: 1.2011139392852783
Epoch: 6, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.461 Vali Acc: 0.789 Test Loss: 0.461 Test Acc: 0.789
Validation loss decreased (-0.733328 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 1.025733232498169
Epoch: 7, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.419 Vali Acc: 0.800 Test Loss: 0.419 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799996).  Saving model ...
Epoch: 8 cost time: 1.19779634475708
Epoch: 8, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.410 Vali Acc: 0.806 Test Loss: 0.410 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805551).  Saving model ...
Epoch: 9 cost time: 1.1894426345825195
Epoch: 9, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.385 Vali Acc: 0.778 Test Loss: 0.385 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.021690845489502
Epoch: 10, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.363 Vali Acc: 0.839 Test Loss: 0.363 Test Acc: 0.839
Validation loss decreased (-0.805551 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 1.131584644317627
Epoch: 11, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.361 Vali Acc: 0.811 Test Loss: 0.361 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1566460132598877
Epoch: 12, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.051863670349121
Epoch: 13, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2958440780639648
Epoch: 14, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.358 Vali Acc: 0.839 Test Loss: 0.358 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 1.1934804916381836
Epoch: 15, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.373 Vali Acc: 0.811 Test Loss: 0.373 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1923720836639404
Epoch: 16, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 1.1130023002624512
Epoch: 17, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.338 Vali Acc: 0.828 Test Loss: 0.338 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.214226245880127
Epoch: 18, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.333 Vali Acc: 0.844 Test Loss: 0.333 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 1.0282680988311768
Epoch: 19, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.321 Vali Acc: 0.878 Test Loss: 0.321 Test Acc: 0.878
Validation loss decreased (-0.844441 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 1.0729928016662598
Epoch: 20, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.278243064880371
Epoch: 21, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0988383293151855
Epoch: 22, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.370 Vali Acc: 0.822 Test Loss: 0.370 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0713169574737549
Epoch: 23, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1245949268341064
Epoch: 24, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1636714935302734
Epoch: 25, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.122426986694336
Epoch: 26, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3361637592315674
Epoch: 27, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3075361251831055
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2323675155639648
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 105334
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1356873512268066
Epoch: 1, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.509 Vali Acc: 0.439 Test Loss: 1.509 Test Acc: 0.439
Validation loss decreased (inf --> -0.438874).  Saving model ...
Epoch: 2 cost time: 1.0932292938232422
Epoch: 2, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.198 Vali Acc: 0.600 Test Loss: 1.198 Test Acc: 0.600
Validation loss decreased (-0.438874 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 1.1721746921539307
Epoch: 3, Steps: 12 | Train Loss: 1.064 Vali Loss: 0.945 Vali Acc: 0.650 Test Loss: 0.945 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649991).  Saving model ...
Epoch: 4 cost time: 1.0486533641815186
Epoch: 4, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.789 Vali Acc: 0.694 Test Loss: 0.789 Test Acc: 0.694
Validation loss decreased (-0.649991 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 1.0824923515319824
Epoch: 5, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.683 Vali Acc: 0.733 Test Loss: 0.683 Test Acc: 0.733
Validation loss decreased (-0.694437 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 1.0127944946289062
Epoch: 6, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.612 Vali Acc: 0.739 Test Loss: 0.612 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 1.0355420112609863
Epoch: 7, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.540 Vali Acc: 0.767 Test Loss: 0.540 Test Acc: 0.767
Validation loss decreased (-0.738883 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 1.0529963970184326
Epoch: 8, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.509 Vali Acc: 0.778 Test Loss: 0.509 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.1812701225280762
Epoch: 9, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.471 Vali Acc: 0.789 Test Loss: 0.471 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 1.2660348415374756
Epoch: 10, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.441 Vali Acc: 0.811 Test Loss: 0.441 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 1.1466484069824219
Epoch: 11, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.434 Vali Acc: 0.811 Test Loss: 0.434 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 1.1425771713256836
Epoch: 12, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.403 Vali Acc: 0.828 Test Loss: 0.403 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 1.1696648597717285
Epoch: 13, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.383 Vali Acc: 0.822 Test Loss: 0.383 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1148898601531982
Epoch: 14, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.351 Vali Acc: 0.822 Test Loss: 0.351 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.182476282119751
Epoch: 15, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 16 cost time: 1.1985266208648682
Epoch: 16, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.334 Vali Acc: 0.833 Test Loss: 0.334 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.114332675933838
Epoch: 17, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 18 cost time: 1.2826189994812012
Epoch: 18, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2330808639526367
Epoch: 19, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1695225238800049
Epoch: 20, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 1.1871984004974365
Epoch: 21, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0333518981933594
Epoch: 22, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.307 Vali Acc: 0.839 Test Loss: 0.307 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2005627155303955
Epoch: 23, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2108027935028076
Epoch: 24, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.304 Vali Acc: 0.839 Test Loss: 0.304 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1901490688323975
Epoch: 25, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2216804027557373
Epoch: 26, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 27 cost time: 1.0656859874725342
Epoch: 27, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 28 cost time: 1.0362014770507812
Epoch: 28, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.325 Vali Acc: 0.822 Test Loss: 0.325 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3602557182312012
Epoch: 29, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2016856670379639
Epoch: 30, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.347 Vali Acc: 0.817 Test Loss: 0.347 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2547214031219482
Epoch: 31, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 1.1576716899871826
Epoch: 32, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1775314807891846
Epoch: 33, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3827893733978271
Epoch: 34, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0465948581695557
Epoch: 35, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.121161937713623
Epoch: 36, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.304 Vali Acc: 0.844 Test Loss: 0.304 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1215522289276123
Epoch: 37, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9941787719726562
Epoch: 38, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.197028636932373
Epoch: 39, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0943777561187744
Epoch: 40, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.169140338897705
Epoch: 41, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 298486
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2054789066314697
Epoch: 1, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.519 Vali Acc: 0.444 Test Loss: 1.519 Test Acc: 0.444
Validation loss decreased (inf --> -0.444429).  Saving model ...
Epoch: 2 cost time: 1.2799842357635498
Epoch: 2, Steps: 12 | Train Loss: 1.394 Vali Loss: 1.206 Vali Acc: 0.600 Test Loss: 1.206 Test Acc: 0.600
Validation loss decreased (-0.444429 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 0.9053618907928467
Epoch: 3, Steps: 12 | Train Loss: 1.062 Vali Loss: 0.950 Vali Acc: 0.633 Test Loss: 0.950 Test Acc: 0.633
Validation loss decreased (-0.599988 --> -0.633324).  Saving model ...
Epoch: 4 cost time: 1.0126636028289795
Epoch: 4, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.792 Vali Acc: 0.678 Test Loss: 0.792 Test Acc: 0.678
Validation loss decreased (-0.633324 --> -0.677770).  Saving model ...
Epoch: 5 cost time: 1.1065099239349365
Epoch: 5, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.684 Vali Acc: 0.739 Test Loss: 0.684 Test Acc: 0.739
Validation loss decreased (-0.677770 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 1.2051396369934082
Epoch: 6, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.106048822402954
Epoch: 7, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.536 Vali Acc: 0.750 Test Loss: 0.536 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749995).  Saving model ...
Epoch: 8 cost time: 1.1524755954742432
Epoch: 8, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
Validation loss decreased (-0.749995 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.2575280666351318
Epoch: 9, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.467 Vali Acc: 0.761 Test Loss: 0.467 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9704141616821289
Epoch: 10, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.435 Vali Acc: 0.800 Test Loss: 0.435 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799996).  Saving model ...
Epoch: 11 cost time: 1.1274333000183105
Epoch: 11, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.426 Vali Acc: 0.794 Test Loss: 0.426 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.066673755645752
Epoch: 12, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.401 Vali Acc: 0.817 Test Loss: 0.401 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 13 cost time: 1.118401288986206
Epoch: 13, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.382 Vali Acc: 0.817 Test Loss: 0.382 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 14 cost time: 1.144770860671997
Epoch: 14, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.347 Vali Acc: 0.817 Test Loss: 0.347 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 1.241211175918579
Epoch: 15, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 0.8991913795471191
Epoch: 16, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0841870307922363
Epoch: 17, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.327 Vali Acc: 0.828 Test Loss: 0.327 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0194714069366455
Epoch: 18, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.325 Vali Acc: 0.833 Test Loss: 0.325 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9324767589569092
Epoch: 19, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.312 Vali Acc: 0.828 Test Loss: 0.312 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9352519512176514
Epoch: 20, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 0.8445158004760742
Epoch: 21, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.305 Vali Acc: 0.833 Test Loss: 0.305 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0181701183319092
Epoch: 22, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.306 Vali Acc: 0.833 Test Loss: 0.306 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0990707874298096
Epoch: 23, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.298 Vali Acc: 0.839 Test Loss: 0.298 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9829096794128418
Epoch: 24, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.301 Vali Acc: 0.844 Test Loss: 0.301 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0706148147583008
Epoch: 25, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.294 Vali Acc: 0.833 Test Loss: 0.294 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9629092216491699
Epoch: 26, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 27 cost time: 1.1708359718322754
Epoch: 27, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 28 cost time: 1.1291759014129639
Epoch: 28, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.324 Vali Acc: 0.822 Test Loss: 0.324 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0509793758392334
Epoch: 29, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.333 Vali Acc: 0.844 Test Loss: 0.333 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1038694381713867
Epoch: 30, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.343 Vali Acc: 0.817 Test Loss: 0.343 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1963446140289307
Epoch: 31, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 1.0607764720916748
Epoch: 32, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.094397783279419
Epoch: 33, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 1.098747968673706
Epoch: 34, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.274 Vali Acc: 0.867 Test Loss: 0.274 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8605611324310303
Epoch: 35, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1125969886779785
Epoch: 36, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.298 Vali Acc: 0.844 Test Loss: 0.298 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0343914031982422
Epoch: 37, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 38 cost time: 1.1513333320617676
Epoch: 38, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.282 Vali Acc: 0.861 Test Loss: 0.282 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0967717170715332
Epoch: 39, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.228417158126831
Epoch: 40, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9459705352783203
Epoch: 41, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1979360580444336
Epoch: 42, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1225502490997314
Epoch: 43, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1682703495025635
Epoch: 44, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1589744091033936
Epoch: 45, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.2542164325714111
Epoch: 46, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.2960681915283203
Epoch: 47, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 298486
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4758434295654297
Epoch: 1, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.525 Vali Acc: 0.517 Test Loss: 1.525 Test Acc: 0.517
Validation loss decreased (inf --> -0.516651).  Saving model ...
Epoch: 2 cost time: 1.1785967350006104
Epoch: 2, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.204 Vali Acc: 0.606 Test Loss: 1.204 Test Acc: 0.606
Validation loss decreased (-0.516651 --> -0.605544).  Saving model ...
Epoch: 3 cost time: 1.0753815174102783
Epoch: 3, Steps: 12 | Train Loss: 1.076 Vali Loss: 0.938 Vali Acc: 0.639 Test Loss: 0.938 Test Acc: 0.639
Validation loss decreased (-0.605544 --> -0.638880).  Saving model ...
Epoch: 4 cost time: 0.9100437164306641
Epoch: 4, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.768 Vali Acc: 0.706 Test Loss: 0.768 Test Acc: 0.706
Validation loss decreased (-0.638880 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 1.0536963939666748
Epoch: 5, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.667 Vali Acc: 0.739 Test Loss: 0.667 Test Acc: 0.739
Validation loss decreased (-0.705548 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 1.1013894081115723
Epoch: 6, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.594 Vali Acc: 0.728 Test Loss: 0.594 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1772699356079102
Epoch: 7, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.519 Vali Acc: 0.772 Test Loss: 0.519 Test Acc: 0.772
Validation loss decreased (-0.738882 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 1.1205778121948242
Epoch: 8, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.488 Vali Acc: 0.756 Test Loss: 0.488 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0991520881652832
Epoch: 9, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.455 Vali Acc: 0.767 Test Loss: 0.455 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0178499221801758
Epoch: 10, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.425 Vali Acc: 0.794 Test Loss: 0.425 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 1.0299301147460938
Epoch: 11, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.414 Vali Acc: 0.800 Test Loss: 0.414 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 12 cost time: 1.0488567352294922
Epoch: 12, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.391 Vali Acc: 0.817 Test Loss: 0.391 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 13 cost time: 1.0767779350280762
Epoch: 13, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.377 Vali Acc: 0.789 Test Loss: 0.377 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.212280511856079
Epoch: 14, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.343 Vali Acc: 0.828 Test Loss: 0.343 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 15 cost time: 1.030470609664917
Epoch: 15, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.328 Vali Acc: 0.850 Test Loss: 0.328 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 0.9832537174224854
Epoch: 16, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.324 Vali Acc: 0.822 Test Loss: 0.324 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.919750452041626
Epoch: 17, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 18 cost time: 0.8742997646331787
Epoch: 18, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.317 Vali Acc: 0.833 Test Loss: 0.317 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0801353454589844
Epoch: 19, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 20 cost time: 1.1375908851623535
Epoch: 20, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 21 cost time: 1.2698633670806885
Epoch: 21, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 22 cost time: 1.143303632736206
Epoch: 22, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.296 Vali Acc: 0.833 Test Loss: 0.296 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1251966953277588
Epoch: 23, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 24 cost time: 1.0449607372283936
Epoch: 24, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0609376430511475
Epoch: 25, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1474928855895996
Epoch: 26, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1317644119262695
Epoch: 27, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 28 cost time: 1.0362262725830078
Epoch: 28, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.331 Vali Acc: 0.822 Test Loss: 0.331 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0760059356689453
Epoch: 29, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.075946569442749
Epoch: 30, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.322 Vali Acc: 0.828 Test Loss: 0.322 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0743141174316406
Epoch: 31, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.265 Vali Acc: 0.867 Test Loss: 0.265 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 32 cost time: 1.1412780284881592
Epoch: 32, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 33 cost time: 1.0620105266571045
Epoch: 33, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 34 cost time: 1.1480464935302734
Epoch: 34, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.265 Vali Acc: 0.872 Test Loss: 0.265 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.059760332107544
Epoch: 35, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.275 Vali Acc: 0.856 Test Loss: 0.275 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0892095565795898
Epoch: 36, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.305 Vali Acc: 0.839 Test Loss: 0.305 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.112229585647583
Epoch: 37, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.255 Vali Acc: 0.878 Test Loss: 0.255 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 38 cost time: 1.0721890926361084
Epoch: 38, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.275 Vali Acc: 0.867 Test Loss: 0.275 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0736193656921387
Epoch: 39, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 40 cost time: 1.0721631050109863
Epoch: 40, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.280 Vali Acc: 0.861 Test Loss: 0.280 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0558805465698242
Epoch: 41, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2266490459442139
Epoch: 42, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.101813793182373
Epoch: 43, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 44 cost time: 1.0300657749176025
Epoch: 44, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.262 Vali Acc: 0.872 Test Loss: 0.262 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.141892910003662
Epoch: 45, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0640411376953125
Epoch: 46, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.074920415878296
Epoch: 47, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.1853058338165283
Epoch: 48, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 1.1083412170410156
Epoch: 49, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.269 Vali Acc: 0.867 Test Loss: 0.269 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9598596096038818
Epoch: 50, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.1111466884613037
Epoch: 51, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9928362369537354
Epoch: 52, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.0199861526489258
Epoch: 53, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.096726417541504
Epoch: 54, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.9643497467041016
Epoch: 55, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.0944089889526367
Epoch: 56, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.9729087352752686
Epoch: 57, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.1798815727233887
Epoch: 58, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 298486
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2232775688171387
Epoch: 1, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.578 Vali Acc: 0.394 Test Loss: 1.578 Test Acc: 0.394
Validation loss decreased (inf --> -0.394429).  Saving model ...
Epoch: 2 cost time: 1.0151755809783936
Epoch: 2, Steps: 12 | Train Loss: 1.417 Vali Loss: 1.252 Vali Acc: 0.589 Test Loss: 1.252 Test Acc: 0.589
Validation loss decreased (-0.394429 --> -0.588876).  Saving model ...
Epoch: 3 cost time: 0.9357244968414307
Epoch: 3, Steps: 12 | Train Loss: 1.093 Vali Loss: 0.977 Vali Acc: 0.667 Test Loss: 0.977 Test Acc: 0.667
Validation loss decreased (-0.588876 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 0.97184157371521
Epoch: 4, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.799 Vali Acc: 0.689 Test Loss: 0.799 Test Acc: 0.689
Validation loss decreased (-0.666657 --> -0.688881).  Saving model ...
Epoch: 5 cost time: 1.0043056011199951
Epoch: 5, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.686 Vali Acc: 0.722 Test Loss: 0.686 Test Acc: 0.722
Validation loss decreased (-0.688881 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 1.1547739505767822
Epoch: 6, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.616 Vali Acc: 0.700 Test Loss: 0.616 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.943756103515625
Epoch: 7, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.540 Vali Acc: 0.750 Test Loss: 0.540 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749995).  Saving model ...
Epoch: 8 cost time: 0.8882672786712646
Epoch: 8, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
Validation loss decreased (-0.749995 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 1.0099680423736572
Epoch: 9, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.476 Vali Acc: 0.761 Test Loss: 0.476 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9659378528594971
Epoch: 10, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.448 Vali Acc: 0.772 Test Loss: 0.448 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0552701950073242
Epoch: 11, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.434 Vali Acc: 0.817 Test Loss: 0.434 Test Acc: 0.817
Validation loss decreased (-0.783328 --> -0.816662).  Saving model ...
Epoch: 12 cost time: 1.147620677947998
Epoch: 12, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.413 Vali Acc: 0.800 Test Loss: 0.413 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0998146533966064
Epoch: 13, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.396 Vali Acc: 0.794 Test Loss: 0.396 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1458017826080322
Epoch: 14, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.367 Vali Acc: 0.806 Test Loss: 0.367 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9418354034423828
Epoch: 15, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
Validation loss decreased (-0.816662 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 0.9715278148651123
Epoch: 16, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.351 Vali Acc: 0.828 Test Loss: 0.351 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9942338466644287
Epoch: 17, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.351 Vali Acc: 0.839 Test Loss: 0.351 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.134871244430542
Epoch: 18, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9119343757629395
Epoch: 19, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.316 Vali Acc: 0.844 Test Loss: 0.316 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8307764530181885
Epoch: 20, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0386414527893066
Epoch: 21, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0018534660339355
Epoch: 22, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.304 Vali Acc: 0.839 Test Loss: 0.304 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8238821029663086
Epoch: 23, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 24 cost time: 0.9429171085357666
Epoch: 24, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.054800033569336
Epoch: 25, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 26 cost time: 0.9561865329742432
Epoch: 26, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.308 Vali Acc: 0.833 Test Loss: 0.308 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0173659324645996
Epoch: 27, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.9671928882598877
Epoch: 28, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.341 Vali Acc: 0.806 Test Loss: 0.341 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.931359052658081
Epoch: 29, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0079355239868164
Epoch: 30, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.358 Vali Acc: 0.800 Test Loss: 0.358 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.944420576095581
Epoch: 31, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.282 Vali Acc: 0.867 Test Loss: 0.282 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8855977058410645
Epoch: 32, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.006120204925537
Epoch: 33, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8867373466491699
Epoch: 34, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.300 Vali Acc: 0.833 Test Loss: 0.300 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9555709362030029
Epoch: 35, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0670857429504395
Epoch: 36, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.341 Vali Acc: 0.817 Test Loss: 0.341 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0076076984405518
Epoch: 37, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 1.1186738014221191
Epoch: 38, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.311 Vali Acc: 0.839 Test Loss: 0.311 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9811089038848877
Epoch: 39, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.796602725982666
Epoch: 40, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1700084209442139
Epoch: 41, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9724316596984863
Epoch: 42, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.360 Vali Acc: 0.817 Test Loss: 0.360 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0385105609893799
Epoch: 43, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9608936309814453
Epoch: 44, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0060291290283203
Epoch: 45, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.0217578411102295
Epoch: 46, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.0709667205810547
Epoch: 47, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 298486
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2517900466918945
Epoch: 1, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.575 Vali Acc: 0.400 Test Loss: 1.575 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 1.1241436004638672
Epoch: 2, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.246 Vali Acc: 0.578 Test Loss: 1.246 Test Acc: 0.578
Validation loss decreased (-0.399984 --> -0.577765).  Saving model ...
Epoch: 3 cost time: 1.0254433155059814
Epoch: 3, Steps: 12 | Train Loss: 1.050 Vali Loss: 0.980 Vali Acc: 0.672 Test Loss: 0.980 Test Acc: 0.672
Validation loss decreased (-0.577765 --> -0.672212).  Saving model ...
Epoch: 4 cost time: 1.1754906177520752
Epoch: 4, Steps: 12 | Train Loss: 0.881 Vali Loss: 0.805 Vali Acc: 0.717 Test Loss: 0.805 Test Acc: 0.717
Validation loss decreased (-0.672212 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 1.2021205425262451
Epoch: 5, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.700 Vali Acc: 0.711 Test Loss: 0.700 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0887048244476318
Epoch: 6, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.613 Vali Acc: 0.739 Test Loss: 0.613 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 0.9860825538635254
Epoch: 7, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.557 Vali Acc: 0.739 Test Loss: 0.557 Test Acc: 0.739
Validation loss decreased (-0.738883 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 1.091989278793335
Epoch: 8, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
Validation loss decreased (-0.738883 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.115096092224121
Epoch: 9, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.489 Vali Acc: 0.767 Test Loss: 0.489 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.169492483139038
Epoch: 10, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.471 Vali Acc: 0.772 Test Loss: 0.471 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0962529182434082
Epoch: 11, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.429 Vali Acc: 0.789 Test Loss: 0.429 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788885).  Saving model ...
Epoch: 12 cost time: 0.9327089786529541
Epoch: 12, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.411 Vali Acc: 0.800 Test Loss: 0.411 Test Acc: 0.800
Validation loss decreased (-0.788885 --> -0.799996).  Saving model ...
Epoch: 13 cost time: 1.0566985607147217
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.388 Vali Acc: 0.806 Test Loss: 0.388 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 14 cost time: 1.0584216117858887
Epoch: 14, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.398 Vali Acc: 0.811 Test Loss: 0.398 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 15 cost time: 1.2233524322509766
Epoch: 15, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.378 Vali Acc: 0.806 Test Loss: 0.378 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0175962448120117
Epoch: 16, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 17 cost time: 0.9815642833709717
Epoch: 17, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.347 Vali Acc: 0.833 Test Loss: 0.347 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 18 cost time: 1.0934531688690186
Epoch: 18, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.355 Vali Acc: 0.811 Test Loss: 0.355 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.101588249206543
Epoch: 19, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.347 Vali Acc: 0.850 Test Loss: 0.347 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 20 cost time: 1.0767552852630615
Epoch: 20, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.334 Vali Acc: 0.856 Test Loss: 0.334 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 21 cost time: 1.1008713245391846
Epoch: 21, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.333 Vali Acc: 0.844 Test Loss: 0.333 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0792427062988281
Epoch: 22, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.324 Vali Acc: 0.844 Test Loss: 0.324 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0139689445495605
Epoch: 23, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.319 Vali Acc: 0.833 Test Loss: 0.319 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2099156379699707
Epoch: 24, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.338 Vali Acc: 0.844 Test Loss: 0.338 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0153710842132568
Epoch: 25, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1277906894683838
Epoch: 26, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0250580310821533
Epoch: 27, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 28 cost time: 1.0789427757263184
Epoch: 28, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2110168933868408
Epoch: 29, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.317 Vali Acc: 0.833 Test Loss: 0.317 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2101223468780518
Epoch: 30, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 31 cost time: 1.1967649459838867
Epoch: 31, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.273742914199829
Epoch: 32, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 33 cost time: 1.212153673171997
Epoch: 33, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.067840576171875
Epoch: 34, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 1.1235828399658203
Epoch: 35, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.325 Vali Acc: 0.856 Test Loss: 0.325 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9146268367767334
Epoch: 36, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2200851440429688
Epoch: 37, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0758378505706787
Epoch: 38, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.292 Vali Acc: 0.883 Test Loss: 0.292 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2196755409240723
Epoch: 39, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.2597858905792236
Epoch: 40, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0447089672088623
Epoch: 41, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 1.159607172012329
Epoch: 42, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1674575805664062
Epoch: 43, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0851004123687744
Epoch: 44, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2007951736450195
Epoch: 45, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.296 Vali Acc: 0.894 Test Loss: 0.296 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 46 cost time: 1.230614185333252
Epoch: 46, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2203474044799805
Epoch: 47, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1517665386199951
Epoch: 48, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9407651424407959
Epoch: 49, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1124475002288818
Epoch: 50, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.369 Vali Acc: 0.833 Test Loss: 0.369 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.2597899436950684
Epoch: 51, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.1804547309875488
Epoch: 52, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.293 Vali Acc: 0.883 Test Loss: 0.293 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.2784123420715332
Epoch: 53, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.357 Vali Acc: 0.828 Test Loss: 0.357 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.2043273448944092
Epoch: 54, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 55 cost time: 1.2390732765197754
Epoch: 55, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 56 cost time: 1.2272326946258545
Epoch: 56, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1573424339294434
Epoch: 57, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 58 cost time: 1.1492314338684082
Epoch: 58, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2576899528503418
Epoch: 59, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.318 Vali Acc: 0.872 Test Loss: 0.318 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.128180742263794
Epoch: 60, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.304 Vali Acc: 0.883 Test Loss: 0.304 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.2680327892303467
Epoch: 61, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.365 Vali Acc: 0.839 Test Loss: 0.365 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.0210602283477783
Epoch: 62, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.296 Vali Acc: 0.894 Test Loss: 0.296 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.9831669330596924
Epoch: 63, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.311 Vali Acc: 0.894 Test Loss: 0.311 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.182347297668457
Epoch: 64, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.9854483604431152
Epoch: 65, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 66 cost time: 0.9224090576171875
Epoch: 66, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0394251346588135
Epoch: 67, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.301 Vali Acc: 0.894 Test Loss: 0.301 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.9110405445098877
Epoch: 68, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9855988025665283
Epoch: 69, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.025944471359253
Epoch: 70, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.313 Vali Acc: 0.894 Test Loss: 0.313 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.1612427234649658
Epoch: 71, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.301 Vali Acc: 0.894 Test Loss: 0.301 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.0277645587921143
Epoch: 72, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.164717674255371
Epoch: 73, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.0913293361663818
Epoch: 74, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.1412105560302734
Epoch: 75, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 167414
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.524420976638794
Epoch: 1, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.567 Vali Acc: 0.411 Test Loss: 1.567 Test Acc: 0.411
Validation loss decreased (inf --> -0.411095).  Saving model ...
Epoch: 2 cost time: 1.1254770755767822
Epoch: 2, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.238 Vali Acc: 0.600 Test Loss: 1.238 Test Acc: 0.600
Validation loss decreased (-0.411095 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 1.0801355838775635
Epoch: 3, Steps: 12 | Train Loss: 1.049 Vali Loss: 0.968 Vali Acc: 0.678 Test Loss: 0.968 Test Acc: 0.678
Validation loss decreased (-0.599988 --> -0.677768).  Saving model ...
Epoch: 4 cost time: 1.0859158039093018
Epoch: 4, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.794 Vali Acc: 0.711 Test Loss: 0.794 Test Acc: 0.711
Validation loss decreased (-0.677768 --> -0.711103).  Saving model ...
Epoch: 5 cost time: 1.0743067264556885
Epoch: 5, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.691 Vali Acc: 0.722 Test Loss: 0.691 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 1.1130917072296143
Epoch: 6, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.604 Vali Acc: 0.739 Test Loss: 0.604 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 0.8979010581970215
Epoch: 7, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.546 Vali Acc: 0.733 Test Loss: 0.546 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0431556701660156
Epoch: 8, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
Validation loss decreased (-0.738883 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.0865116119384766
Epoch: 9, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.479 Vali Acc: 0.767 Test Loss: 0.479 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1262586116790771
Epoch: 10, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.458 Vali Acc: 0.772 Test Loss: 0.458 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0799527168273926
Epoch: 11, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.420 Vali Acc: 0.794 Test Loss: 0.420 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 12 cost time: 1.1056358814239502
Epoch: 12, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.402 Vali Acc: 0.794 Test Loss: 0.402 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 13 cost time: 1.050394058227539
Epoch: 13, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.379 Vali Acc: 0.817 Test Loss: 0.379 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816663).  Saving model ...
Epoch: 14 cost time: 1.02774977684021
Epoch: 14, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.388 Vali Acc: 0.817 Test Loss: 0.388 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.170557975769043
Epoch: 15, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.368 Vali Acc: 0.822 Test Loss: 0.368 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 16 cost time: 1.111100435256958
Epoch: 16, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.353 Vali Acc: 0.839 Test Loss: 0.353 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 1.1320807933807373
Epoch: 17, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.338 Vali Acc: 0.839 Test Loss: 0.338 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 18 cost time: 1.217343807220459
Epoch: 18, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.346 Vali Acc: 0.817 Test Loss: 0.346 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.127650260925293
Epoch: 19, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.340 Vali Acc: 0.844 Test Loss: 0.340 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 20 cost time: 1.1028220653533936
Epoch: 20, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.328 Vali Acc: 0.872 Test Loss: 0.328 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 21 cost time: 1.130584478378296
Epoch: 21, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.325 Vali Acc: 0.850 Test Loss: 0.325 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.066107988357544
Epoch: 22, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.12192964553833
Epoch: 23, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.307 Vali Acc: 0.828 Test Loss: 0.307 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.082839012145996
Epoch: 24, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9599361419677734
Epoch: 25, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.060213327407837
Epoch: 26, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0664558410644531
Epoch: 27, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.991584300994873
Epoch: 28, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0017945766448975
Epoch: 29, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.308 Vali Acc: 0.833 Test Loss: 0.308 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9467926025390625
Epoch: 30, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 31 cost time: 1.2174510955810547
Epoch: 31, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0172145366668701
Epoch: 32, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 1.020129919052124
Epoch: 33, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1218032836914062
Epoch: 34, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2933988571166992
Epoch: 35, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.316 Vali Acc: 0.839 Test Loss: 0.316 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1901655197143555
Epoch: 36, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1183075904846191
Epoch: 37, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9635999202728271
Epoch: 38, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0254530906677246
Epoch: 39, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.282 Vali Acc: 0.867 Test Loss: 0.282 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1375062465667725
Epoch: 40, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9421069622039795
Epoch: 41, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.287 Vali Acc: 0.894 Test Loss: 0.287 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 42 cost time: 1.3794434070587158
Epoch: 42, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.362 Vali Acc: 0.822 Test Loss: 0.362 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0958023071289062
Epoch: 43, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.313 Vali Acc: 0.878 Test Loss: 0.313 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3038914203643799
Epoch: 44, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.329 Vali Acc: 0.844 Test Loss: 0.329 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1922826766967773
Epoch: 45, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0161781311035156
Epoch: 46, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.293 Vali Acc: 0.883 Test Loss: 0.293 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2126195430755615
Epoch: 47, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2042503356933594
Epoch: 48, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.0634655952453613
Epoch: 49, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.1275224685668945
Epoch: 50, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.345 Vali Acc: 0.844 Test Loss: 0.345 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.2346885204315186
Epoch: 51, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 167414
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3471601009368896
Epoch: 1, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.555 Vali Acc: 0.400 Test Loss: 1.555 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 1.129150152206421
Epoch: 2, Steps: 12 | Train Loss: 1.390 Vali Loss: 1.227 Vali Acc: 0.628 Test Loss: 1.227 Test Acc: 0.628
Validation loss decreased (-0.399984 --> -0.627766).  Saving model ...
Epoch: 3 cost time: 1.2245726585388184
Epoch: 3, Steps: 12 | Train Loss: 1.051 Vali Loss: 0.954 Vali Acc: 0.717 Test Loss: 0.954 Test Acc: 0.717
Validation loss decreased (-0.627766 --> -0.716657).  Saving model ...
Epoch: 4 cost time: 1.1570558547973633
Epoch: 4, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.784 Vali Acc: 0.689 Test Loss: 0.784 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.210479974746704
Epoch: 5, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.674 Vali Acc: 0.739 Test Loss: 0.674 Test Acc: 0.739
Validation loss decreased (-0.716657 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 1.027310848236084
Epoch: 6, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.590 Vali Acc: 0.756 Test Loss: 0.590 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 1.199282169342041
Epoch: 7, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.531 Vali Acc: 0.744 Test Loss: 0.531 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1174228191375732
Epoch: 8, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.495 Vali Acc: 0.789 Test Loss: 0.495 Test Acc: 0.789
Validation loss decreased (-0.755550 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.0986592769622803
Epoch: 9, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.465 Vali Acc: 0.772 Test Loss: 0.465 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1053531169891357
Epoch: 10, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.442 Vali Acc: 0.767 Test Loss: 0.442 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1058025360107422
Epoch: 11, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.405 Vali Acc: 0.794 Test Loss: 0.405 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 12 cost time: 1.0780611038208008
Epoch: 12, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.391 Vali Acc: 0.811 Test Loss: 0.391 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 13 cost time: 1.0758366584777832
Epoch: 13, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.369 Vali Acc: 0.844 Test Loss: 0.369 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.1950643062591553
Epoch: 14, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.376 Vali Acc: 0.811 Test Loss: 0.376 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0703871250152588
Epoch: 15, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.077528953552246
Epoch: 16, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.343 Vali Acc: 0.828 Test Loss: 0.343 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8864567279815674
Epoch: 17, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.053668737411499
Epoch: 18, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.337 Vali Acc: 0.817 Test Loss: 0.337 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.135317087173462
Epoch: 19, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.332 Vali Acc: 0.833 Test Loss: 0.332 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1135363578796387
Epoch: 20, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894441).  Saving model ...
Epoch: 21 cost time: 0.9603536128997803
Epoch: 21, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9317362308502197
Epoch: 22, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.310 Vali Acc: 0.867 Test Loss: 0.310 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.053558111190796
Epoch: 23, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.300 Vali Acc: 0.844 Test Loss: 0.300 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.048530101776123
Epoch: 24, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.325 Vali Acc: 0.839 Test Loss: 0.325 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0612730979919434
Epoch: 25, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1273972988128662
Epoch: 26, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1479241847991943
Epoch: 27, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2165699005126953
Epoch: 28, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.143481731414795
Epoch: 29, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.308 Vali Acc: 0.828 Test Loss: 0.308 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1887080669403076
Epoch: 30, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 167414
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.860626697540283
Epoch: 1, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.633 Vali Acc: 0.400 Test Loss: 1.633 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 1.1388511657714844
Epoch: 2, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.311 Vali Acc: 0.561 Test Loss: 1.311 Test Acc: 0.561
Validation loss decreased (-0.399984 --> -0.561098).  Saving model ...
Epoch: 3 cost time: 1.0475270748138428
Epoch: 3, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.021 Vali Acc: 0.628 Test Loss: 1.021 Test Acc: 0.628
Validation loss decreased (-0.561098 --> -0.627768).  Saving model ...
Epoch: 4 cost time: 1.0233733654022217
Epoch: 4, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.839 Vali Acc: 0.661 Test Loss: 0.839 Test Acc: 0.661
Validation loss decreased (-0.627768 --> -0.661103).  Saving model ...
Epoch: 5 cost time: 0.9383368492126465
Epoch: 5, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.721 Vali Acc: 0.706 Test Loss: 0.721 Test Acc: 0.706
Validation loss decreased (-0.661103 --> -0.705548).  Saving model ...
Epoch: 6 cost time: 1.0557944774627686
Epoch: 6, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.620 Vali Acc: 0.750 Test Loss: 0.620 Test Acc: 0.750
Validation loss decreased (-0.705548 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 0.9245564937591553
Epoch: 7, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.549 Vali Acc: 0.733 Test Loss: 0.549 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.04901123046875
Epoch: 8, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.514 Vali Acc: 0.800 Test Loss: 0.514 Test Acc: 0.800
Validation loss decreased (-0.749994 --> -0.799995).  Saving model ...
Epoch: 9 cost time: 0.9718379974365234
Epoch: 9, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.480 Vali Acc: 0.783 Test Loss: 0.480 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0096378326416016
Epoch: 10, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.466 Vali Acc: 0.756 Test Loss: 0.466 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1114249229431152
Epoch: 11, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.429 Vali Acc: 0.800 Test Loss: 0.429 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799996).  Saving model ...
Epoch: 12 cost time: 1.1020469665527344
Epoch: 12, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.412 Vali Acc: 0.822 Test Loss: 0.412 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 0.9446954727172852
Epoch: 13, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.396 Vali Acc: 0.839 Test Loss: 0.396 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 14 cost time: 1.0308241844177246
Epoch: 14, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.425 Vali Acc: 0.794 Test Loss: 0.425 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1731319427490234
Epoch: 15, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.395 Vali Acc: 0.817 Test Loss: 0.395 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.080749750137329
Epoch: 16, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.373 Vali Acc: 0.844 Test Loss: 0.373 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 17 cost time: 1.103515863418579
Epoch: 17, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.363 Vali Acc: 0.856 Test Loss: 0.363 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 0.9276125431060791
Epoch: 18, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.371 Vali Acc: 0.800 Test Loss: 0.371 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3026127815246582
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.367 Vali Acc: 0.806 Test Loss: 0.367 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1105520725250244
Epoch: 20, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.352 Vali Acc: 0.872 Test Loss: 0.352 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 21 cost time: 0.9769101142883301
Epoch: 21, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.369 Vali Acc: 0.817 Test Loss: 0.369 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0369548797607422
Epoch: 22, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9264240264892578
Epoch: 23, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.326 Vali Acc: 0.861 Test Loss: 0.326 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9570043087005615
Epoch: 24, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.341 Vali Acc: 0.811 Test Loss: 0.341 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0715320110321045
Epoch: 25, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.323 Vali Acc: 0.861 Test Loss: 0.323 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0557887554168701
Epoch: 26, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.343 Vali Acc: 0.817 Test Loss: 0.343 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1148056983947754
Epoch: 27, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1307246685028076
Epoch: 28, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1349620819091797
Epoch: 29, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.353 Vali Acc: 0.800 Test Loss: 0.353 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9662778377532959
Epoch: 30, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.310 Vali Acc: 0.867 Test Loss: 0.310 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 167414
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0619380474090576
Epoch: 1, Steps: 12 | Train Loss: 1.999 Vali Loss: 1.765 Vali Acc: 0.272 Test Loss: 1.765 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 1.1136789321899414
Epoch: 2, Steps: 12 | Train Loss: 1.566 Vali Loss: 1.347 Vali Acc: 0.522 Test Loss: 1.347 Test Acc: 0.522
Validation loss decreased (-0.272205 --> -0.522209).  Saving model ...
Epoch: 3 cost time: 1.3153948783874512
Epoch: 3, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.030 Vali Acc: 0.611 Test Loss: 1.030 Test Acc: 0.611
Validation loss decreased (-0.522209 --> -0.611101).  Saving model ...
Epoch: 4 cost time: 1.098073959350586
Epoch: 4, Steps: 12 | Train Loss: 0.906 Vali Loss: 0.817 Vali Acc: 0.683 Test Loss: 0.817 Test Acc: 0.683
Validation loss decreased (-0.611101 --> -0.683325).  Saving model ...
Epoch: 5 cost time: 1.073934555053711
Epoch: 5, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.724 Vali Acc: 0.711 Test Loss: 0.724 Test Acc: 0.711
Validation loss decreased (-0.683325 --> -0.711104).  Saving model ...
Epoch: 6 cost time: 0.8543581962585449
Epoch: 6, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.632 Vali Acc: 0.733 Test Loss: 0.632 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733327).  Saving model ...
Epoch: 7 cost time: 1.0971615314483643
Epoch: 7, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.1609489917755127
Epoch: 8, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 1.1122300624847412
Epoch: 9, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.492 Vali Acc: 0.767 Test Loss: 0.492 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0890355110168457
Epoch: 10, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.474 Vali Acc: 0.783 Test Loss: 0.474 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 1.1442434787750244
Epoch: 11, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.449 Vali Acc: 0.772 Test Loss: 0.449 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0434644222259521
Epoch: 12, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.419 Vali Acc: 0.794 Test Loss: 0.419 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794440).  Saving model ...
Epoch: 13 cost time: 1.0402190685272217
Epoch: 13, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.408 Vali Acc: 0.783 Test Loss: 0.408 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2481434345245361
Epoch: 14, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.399 Vali Acc: 0.794 Test Loss: 0.399 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 15 cost time: 1.126373052597046
Epoch: 15, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.376 Vali Acc: 0.822 Test Loss: 0.376 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822218).  Saving model ...
Epoch: 16 cost time: 1.179640293121338
Epoch: 16, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.357 Vali Acc: 0.822 Test Loss: 0.357 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 17 cost time: 0.9116678237915039
Epoch: 17, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.354 Vali Acc: 0.817 Test Loss: 0.354 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0401105880737305
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.340 Vali Acc: 0.833 Test Loss: 0.340 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 19 cost time: 1.1144177913665771
Epoch: 19, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 20 cost time: 1.1659531593322754
Epoch: 20, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.329 Vali Acc: 0.833 Test Loss: 0.329 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.153144359588623
Epoch: 21, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0367865562438965
Epoch: 22, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 23 cost time: 1.1014831066131592
Epoch: 23, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.325 Vali Acc: 0.828 Test Loss: 0.325 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0371253490447998
Epoch: 24, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 25 cost time: 1.1505351066589355
Epoch: 25, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 26 cost time: 1.0385024547576904
Epoch: 26, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.325 Vali Acc: 0.850 Test Loss: 0.325 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0680086612701416
Epoch: 27, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 28 cost time: 1.1246681213378906
Epoch: 28, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0107977390289307
Epoch: 29, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9695031642913818
Epoch: 30, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0163321495056152
Epoch: 31, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 32 cost time: 0.94626784324646
Epoch: 32, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.327 Vali Acc: 0.817 Test Loss: 0.327 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0218369960784912
Epoch: 33, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.213301658630371
Epoch: 34, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0102558135986328
Epoch: 35, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1057610511779785
Epoch: 36, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1139137744903564
Epoch: 37, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9429633617401123
Epoch: 38, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 1.1586618423461914
Epoch: 39, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 40 cost time: 1.1120150089263916
Epoch: 40, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.323 Vali Acc: 0.839 Test Loss: 0.323 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0473837852478027
Epoch: 41, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.044689416885376
Epoch: 42, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1760303974151611
Epoch: 43, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0685811042785645
Epoch: 44, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.054640293121338
Epoch: 45, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.173222303390503
Epoch: 46, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.0109837055206299
Epoch: 47, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9498615264892578
Epoch: 48, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.1753220558166504
Epoch: 49, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 101878
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.471479892730713
Epoch: 1, Steps: 12 | Train Loss: 1.995 Vali Loss: 1.765 Vali Acc: 0.267 Test Loss: 1.765 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 1.1768829822540283
Epoch: 2, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.344 Vali Acc: 0.522 Test Loss: 1.344 Test Acc: 0.522
Validation loss decreased (-0.266649 --> -0.522209).  Saving model ...
Epoch: 3 cost time: 1.1061127185821533
Epoch: 3, Steps: 12 | Train Loss: 1.188 Vali Loss: 1.025 Vali Acc: 0.622 Test Loss: 1.025 Test Acc: 0.622
Validation loss decreased (-0.522209 --> -0.622212).  Saving model ...
Epoch: 4 cost time: 1.0915732383728027
Epoch: 4, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.810 Vali Acc: 0.689 Test Loss: 0.810 Test Acc: 0.689
Validation loss decreased (-0.622212 --> -0.688881).  Saving model ...
Epoch: 5 cost time: 1.0760655403137207
Epoch: 5, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
Validation loss decreased (-0.688881 --> -0.716659).  Saving model ...
Epoch: 6 cost time: 1.0983130931854248
Epoch: 6, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.624 Vali Acc: 0.733 Test Loss: 0.624 Test Acc: 0.733
Validation loss decreased (-0.716659 --> -0.733327).  Saving model ...
Epoch: 7 cost time: 1.0971496105194092
Epoch: 7, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.563 Vali Acc: 0.739 Test Loss: 0.563 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 0.9954750537872314
Epoch: 8, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
Validation loss decreased (-0.738883 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 0.8643770217895508
Epoch: 9, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.486 Vali Acc: 0.750 Test Loss: 0.486 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.02907133102417
Epoch: 10, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.467 Vali Acc: 0.783 Test Loss: 0.467 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 0.9309213161468506
Epoch: 11, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.438 Vali Acc: 0.778 Test Loss: 0.438 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0196516513824463
Epoch: 12, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.410 Vali Acc: 0.789 Test Loss: 0.410 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 13 cost time: 1.0738742351531982
Epoch: 13, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.398 Vali Acc: 0.783 Test Loss: 0.398 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0260870456695557
Epoch: 14, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.388 Vali Acc: 0.817 Test Loss: 0.388 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 1.0189383029937744
Epoch: 15, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 16 cost time: 0.9031648635864258
Epoch: 16, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.352 Vali Acc: 0.828 Test Loss: 0.352 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 17 cost time: 0.9680080413818359
Epoch: 17, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.350 Vali Acc: 0.817 Test Loss: 0.350 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.031053066253662
Epoch: 18, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.335 Vali Acc: 0.844 Test Loss: 0.335 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 1.0620934963226318
Epoch: 19, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.231574535369873
Epoch: 20, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.322 Vali Acc: 0.839 Test Loss: 0.322 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9806828498840332
Epoch: 21, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 22 cost time: 1.2758564949035645
Epoch: 22, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 23 cost time: 1.0913786888122559
Epoch: 23, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.318 Vali Acc: 0.839 Test Loss: 0.318 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0588350296020508
Epoch: 24, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.331 Vali Acc: 0.828 Test Loss: 0.331 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9585065841674805
Epoch: 25, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 26 cost time: 1.096128225326538
Epoch: 26, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.315 Vali Acc: 0.844 Test Loss: 0.315 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0931341648101807
Epoch: 27, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 1.0367567539215088
Epoch: 28, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2622783184051514
Epoch: 29, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2467312812805176
Epoch: 30, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0894184112548828
Epoch: 31, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 1.0419950485229492
Epoch: 32, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.323 Vali Acc: 0.822 Test Loss: 0.323 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1317968368530273
Epoch: 33, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1507315635681152
Epoch: 34, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.287 Vali Acc: 0.856 Test Loss: 0.287 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9835457801818848
Epoch: 35, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 1.1207633018493652
Epoch: 36, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0336809158325195
Epoch: 37, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0579781532287598
Epoch: 38, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8797760009765625
Epoch: 39, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1405134201049805
Epoch: 40, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.325 Vali Acc: 0.828 Test Loss: 0.325 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1803457736968994
Epoch: 41, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.302 Vali Acc: 0.883 Test Loss: 0.302 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0210533142089844
Epoch: 42, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 1.0883772373199463
Epoch: 43, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0860159397125244
Epoch: 44, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0672578811645508
Epoch: 45, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 46 cost time: 1.1198251247406006
Epoch: 46, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0967895984649658
Epoch: 47, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.300 Vali Acc: 0.867 Test Loss: 0.300 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1444039344787598
Epoch: 48, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0314557552337646
Epoch: 49, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1350889205932617
Epoch: 50, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.8896331787109375
Epoch: 51, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.024735689163208
Epoch: 52, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.277 Vali Acc: 0.894 Test Loss: 0.277 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 53 cost time: 0.9481701850891113
Epoch: 53, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0466558933258057
Epoch: 54, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8851549625396729
Epoch: 55, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9501919746398926
Epoch: 56, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9126300811767578
Epoch: 57, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.203212022781372
Epoch: 58, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.1714773178100586
Epoch: 59, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.0837023258209229
Epoch: 60, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.1262853145599365
Epoch: 61, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.314 Vali Acc: 0.883 Test Loss: 0.314 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.0890910625457764
Epoch: 62, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 101878
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1130964756011963
Epoch: 1, Steps: 12 | Train Loss: 1.966 Vali Loss: 1.744 Vali Acc: 0.294 Test Loss: 1.744 Test Acc: 0.294
Validation loss decreased (inf --> -0.294427).  Saving model ...
Epoch: 2 cost time: 1.0703632831573486
Epoch: 2, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.325 Vali Acc: 0.556 Test Loss: 1.325 Test Acc: 0.556
Validation loss decreased (-0.294427 --> -0.555542).  Saving model ...
Epoch: 3 cost time: 1.0200779438018799
Epoch: 3, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.004 Vali Acc: 0.661 Test Loss: 1.004 Test Acc: 0.661
Validation loss decreased (-0.555542 --> -0.661101).  Saving model ...
Epoch: 4 cost time: 1.0831198692321777
Epoch: 4, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.787 Vali Acc: 0.706 Test Loss: 0.787 Test Acc: 0.706
Validation loss decreased (-0.661101 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 0.9513270854949951
Epoch: 5, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.691 Vali Acc: 0.733 Test Loss: 0.691 Test Acc: 0.733
Validation loss decreased (-0.705548 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 1.0086016654968262
Epoch: 6, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
Validation loss decreased (-0.733326 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.108177661895752
Epoch: 7, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.544 Vali Acc: 0.756 Test Loss: 0.544 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755550).  Saving model ...
Epoch: 8 cost time: 0.9839975833892822
Epoch: 8, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
Validation loss decreased (-0.755550 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 0.9614377021789551
Epoch: 9, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.468 Vali Acc: 0.767 Test Loss: 0.468 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0296385288238525
Epoch: 10, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.441 Vali Acc: 0.783 Test Loss: 0.441 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.934298038482666
Epoch: 11, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.415 Vali Acc: 0.772 Test Loss: 0.415 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9778141975402832
Epoch: 12, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.390 Vali Acc: 0.817 Test Loss: 0.390 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816663).  Saving model ...
Epoch: 13 cost time: 0.993056058883667
Epoch: 13, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.378 Vali Acc: 0.822 Test Loss: 0.378 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 14 cost time: 1.0293004512786865
Epoch: 14, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.370 Vali Acc: 0.811 Test Loss: 0.370 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9783821105957031
Epoch: 15, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.355 Vali Acc: 0.828 Test Loss: 0.355 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 0.9791300296783447
Epoch: 16, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.340 Vali Acc: 0.822 Test Loss: 0.340 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8244566917419434
Epoch: 17, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.339 Vali Acc: 0.828 Test Loss: 0.339 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 18 cost time: 0.8716733455657959
Epoch: 18, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 19 cost time: 0.9111518859863281
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.324 Vali Acc: 0.828 Test Loss: 0.324 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0367844104766846
Epoch: 20, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 21 cost time: 1.098801612854004
Epoch: 21, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 22 cost time: 1.105353593826294
Epoch: 22, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.316 Vali Acc: 0.839 Test Loss: 0.316 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9829874038696289
Epoch: 23, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.311 Vali Acc: 0.844 Test Loss: 0.311 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9304463863372803
Epoch: 24, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.318 Vali Acc: 0.839 Test Loss: 0.318 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9498863220214844
Epoch: 25, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 26 cost time: 0.9089117050170898
Epoch: 26, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0336856842041016
Epoch: 27, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894442).  Saving model ...
Epoch: 28 cost time: 0.97019362449646
Epoch: 28, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1190903186798096
Epoch: 29, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0590300559997559
Epoch: 30, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0830726623535156
Epoch: 31, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.275 Vali Acc: 0.872 Test Loss: 0.275 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9518916606903076
Epoch: 32, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.314 Vali Acc: 0.822 Test Loss: 0.314 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.190680742263794
Epoch: 33, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9767975807189941
Epoch: 34, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9083836078643799
Epoch: 35, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0616035461425781
Epoch: 36, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9803638458251953
Epoch: 37, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 101878
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0944337844848633
Epoch: 1, Steps: 12 | Train Loss: 1.910 Vali Loss: 1.743 Vali Acc: 0.306 Test Loss: 1.743 Test Acc: 0.306
Validation loss decreased (inf --> -0.305538).  Saving model ...
Epoch: 2 cost time: 1.043975830078125
Epoch: 2, Steps: 12 | Train Loss: 1.537 Vali Loss: 1.350 Vali Acc: 0.539 Test Loss: 1.350 Test Acc: 0.539
Validation loss decreased (-0.305538 --> -0.538875).  Saving model ...
Epoch: 3 cost time: 1.090733528137207
Epoch: 3, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.035 Vali Acc: 0.644 Test Loss: 1.035 Test Acc: 0.644
Validation loss decreased (-0.538875 --> -0.644434).  Saving model ...
Epoch: 4 cost time: 0.9545309543609619
Epoch: 4, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.812 Vali Acc: 0.700 Test Loss: 0.812 Test Acc: 0.700
Validation loss decreased (-0.644434 --> -0.699992).  Saving model ...
Epoch: 5 cost time: 1.0934529304504395
Epoch: 5, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.712 Vali Acc: 0.717 Test Loss: 0.712 Test Acc: 0.717
Validation loss decreased (-0.699992 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 1.06101393699646
Epoch: 6, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.620 Vali Acc: 0.706 Test Loss: 0.620 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.017632246017456
Epoch: 7, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.552 Vali Acc: 0.744 Test Loss: 0.552 Test Acc: 0.744
Validation loss decreased (-0.716660 --> -0.744439).  Saving model ...
Epoch: 8 cost time: 1.0118687152862549
Epoch: 8, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
Validation loss decreased (-0.744439 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 1.0173838138580322
Epoch: 9, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.482 Vali Acc: 0.778 Test Loss: 0.482 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9429023265838623
Epoch: 10, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.462 Vali Acc: 0.800 Test Loss: 0.462 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 0.9344382286071777
Epoch: 11, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.431 Vali Acc: 0.817 Test Loss: 0.431 Test Acc: 0.817
Validation loss decreased (-0.799995 --> -0.816662).  Saving model ...
Epoch: 12 cost time: 1.028261423110962
Epoch: 12, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.408 Vali Acc: 0.817 Test Loss: 0.408 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 13 cost time: 0.9851672649383545
Epoch: 13, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.399 Vali Acc: 0.817 Test Loss: 0.399 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 14 cost time: 0.8752455711364746
Epoch: 14, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.387 Vali Acc: 0.794 Test Loss: 0.387 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8748996257781982
Epoch: 15, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 0.9741504192352295
Epoch: 16, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.351 Vali Acc: 0.822 Test Loss: 0.351 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0073328018188477
Epoch: 17, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.1066620349884033
Epoch: 18, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.020179271697998
Epoch: 19, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.345 Vali Acc: 0.817 Test Loss: 0.345 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.017380952835083
Epoch: 20, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.335 Vali Acc: 0.844 Test Loss: 0.335 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0711839199066162
Epoch: 21, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.335 Vali Acc: 0.817 Test Loss: 0.335 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.831913948059082
Epoch: 22, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.337 Vali Acc: 0.822 Test Loss: 0.337 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8223538398742676
Epoch: 23, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9477362632751465
Epoch: 24, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9174759387969971
Epoch: 25, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.320 Vali Acc: 0.839 Test Loss: 0.320 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9613087177276611
Epoch: 26, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9646356105804443
Epoch: 27, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 28 cost time: 0.9784145355224609
Epoch: 28, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0567266941070557
Epoch: 29, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0856542587280273
Epoch: 30, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.314 Vali Acc: 0.822 Test Loss: 0.314 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9665288925170898
Epoch: 31, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 32 cost time: 1.0670983791351318
Epoch: 32, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.352 Vali Acc: 0.794 Test Loss: 0.352 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9653589725494385
Epoch: 33, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.305 Vali Acc: 0.844 Test Loss: 0.305 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0352182388305664
Epoch: 34, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.317 Vali Acc: 0.817 Test Loss: 0.317 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0017552375793457
Epoch: 35, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899997).  Saving model ...
Epoch: 36 cost time: 1.0231757164001465
Epoch: 36, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.312 Vali Acc: 0.828 Test Loss: 0.312 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.099717617034912
Epoch: 37, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9873950481414795
Epoch: 38, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9092123508453369
Epoch: 39, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9421160221099854
Epoch: 40, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.346 Vali Acc: 0.811 Test Loss: 0.346 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.83193039894104
Epoch: 41, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9598643779754639
Epoch: 42, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9274873733520508
Epoch: 43, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.284 Vali Acc: 0.850 Test Loss: 0.284 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9868807792663574
Epoch: 44, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0640084743499756
Epoch: 45, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 101878
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1413886547088623
Epoch: 1, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.615 Vali Acc: 0.333 Test Loss: 1.615 Test Acc: 0.333
Validation loss decreased (inf --> -0.333317).  Saving model ...
Epoch: 2 cost time: 1.0723252296447754
Epoch: 2, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.256 Vali Acc: 0.572 Test Loss: 1.256 Test Acc: 0.572
Validation loss decreased (-0.333317 --> -0.572210).  Saving model ...
Epoch: 3 cost time: 0.9534602165222168
Epoch: 3, Steps: 12 | Train Loss: 1.124 Vali Loss: 0.979 Vali Acc: 0.678 Test Loss: 0.979 Test Acc: 0.678
Validation loss decreased (-0.572210 --> -0.677768).  Saving model ...
Epoch: 4 cost time: 1.0027625560760498
Epoch: 4, Steps: 12 | Train Loss: 0.851 Vali Loss: 0.811 Vali Acc: 0.700 Test Loss: 0.811 Test Acc: 0.700
Validation loss decreased (-0.677768 --> -0.699992).  Saving model ...
Epoch: 5 cost time: 1.0996952056884766
Epoch: 5, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.689 Vali Acc: 0.733 Test Loss: 0.689 Test Acc: 0.733
Validation loss decreased (-0.699992 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 0.9759299755096436
Epoch: 6, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.602 Vali Acc: 0.756 Test Loss: 0.602 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 1.0240857601165771
Epoch: 7, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.554 Vali Acc: 0.761 Test Loss: 0.554 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 0.9268393516540527
Epoch: 8, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.0191469192504883
Epoch: 9, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.475 Vali Acc: 0.778 Test Loss: 0.475 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1047782897949219
Epoch: 10, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.443 Vali Acc: 0.811 Test Loss: 0.443 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 1.0114436149597168
Epoch: 11, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.435 Vali Acc: 0.794 Test Loss: 0.435 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9722604751586914
Epoch: 12, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.410 Vali Acc: 0.772 Test Loss: 0.410 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.142155647277832
Epoch: 13, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.391 Vali Acc: 0.811 Test Loss: 0.391 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 0.968782901763916
Epoch: 14, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.363 Vali Acc: 0.817 Test Loss: 0.363 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 1.0912556648254395
Epoch: 15, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.362 Vali Acc: 0.811 Test Loss: 0.362 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.957087516784668
Epoch: 16, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.359 Vali Acc: 0.811 Test Loss: 0.359 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0074186325073242
Epoch: 17, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.344 Vali Acc: 0.811 Test Loss: 0.344 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1293048858642578
Epoch: 18, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.329 Vali Acc: 0.839 Test Loss: 0.329 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838886).  Saving model ...
Epoch: 19 cost time: 1.1399357318878174
Epoch: 19, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.331 Vali Acc: 0.822 Test Loss: 0.331 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2126739025115967
Epoch: 20, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.117020845413208
Epoch: 21, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 22 cost time: 1.0977895259857178
Epoch: 22, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2877168655395508
Epoch: 23, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 24 cost time: 1.043764352798462
Epoch: 24, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.306 Vali Acc: 0.844 Test Loss: 0.306 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0458464622497559
Epoch: 25, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 26 cost time: 0.9919259548187256
Epoch: 26, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.304 Vali Acc: 0.839 Test Loss: 0.304 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0141527652740479
Epoch: 27, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.300 Vali Acc: 0.867 Test Loss: 0.300 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 28 cost time: 1.028360366821289
Epoch: 28, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9806520938873291
Epoch: 29, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 30 cost time: 1.0791501998901367
Epoch: 30, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1584746837615967
Epoch: 31, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0261013507843018
Epoch: 32, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.318 Vali Acc: 0.822 Test Loss: 0.318 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0143001079559326
Epoch: 33, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.042853593826294
Epoch: 34, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.331 Vali Acc: 0.839 Test Loss: 0.331 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.078446388244629
Epoch: 35, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1564538478851318
Epoch: 36, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 37 cost time: 0.969855546951294
Epoch: 37, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.161520004272461
Epoch: 38, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0132648944854736
Epoch: 39, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0096142292022705
Epoch: 40, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0052452087402344
Epoch: 41, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 42 cost time: 1.1896398067474365
Epoch: 42, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1247014999389648
Epoch: 43, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0480854511260986
Epoch: 44, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0999631881713867
Epoch: 45, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.241807460784912
Epoch: 46, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0790908336639404
Epoch: 47, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9950883388519287
Epoch: 48, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.332 Vali Acc: 0.833 Test Loss: 0.332 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.048429250717163
Epoch: 49, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.0898704528808594
Epoch: 50, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.339 Vali Acc: 0.844 Test Loss: 0.339 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.0099372863769531
Epoch: 51, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.301 Vali Acc: 0.878 Test Loss: 0.301 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 69110
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0623598098754883
Epoch: 1, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.609 Vali Acc: 0.361 Test Loss: 1.609 Test Acc: 0.361
Validation loss decreased (inf --> -0.361095).  Saving model ...
Epoch: 2 cost time: 0.9714500904083252
Epoch: 2, Steps: 12 | Train Loss: 1.435 Vali Loss: 1.257 Vali Acc: 0.550 Test Loss: 1.257 Test Acc: 0.550
Validation loss decreased (-0.361095 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 1.1182441711425781
Epoch: 3, Steps: 12 | Train Loss: 1.118 Vali Loss: 0.981 Vali Acc: 0.667 Test Loss: 0.981 Test Acc: 0.667
Validation loss decreased (-0.549987 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 1.1386289596557617
Epoch: 4, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.810 Vali Acc: 0.711 Test Loss: 0.810 Test Acc: 0.711
Validation loss decreased (-0.666657 --> -0.711103).  Saving model ...
Epoch: 5 cost time: 0.8915283679962158
Epoch: 5, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.690 Vali Acc: 0.733 Test Loss: 0.690 Test Acc: 0.733
Validation loss decreased (-0.711103 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 0.9699783325195312
Epoch: 6, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.600 Vali Acc: 0.772 Test Loss: 0.600 Test Acc: 0.772
Validation loss decreased (-0.733326 --> -0.772216).  Saving model ...
Epoch: 7 cost time: 1.155073642730713
Epoch: 7, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.550 Vali Acc: 0.756 Test Loss: 0.550 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9883859157562256
Epoch: 8, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
Validation loss decreased (-0.772216 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 0.9280383586883545
Epoch: 9, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.475 Vali Acc: 0.772 Test Loss: 0.475 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0599067211151123
Epoch: 10, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.442 Vali Acc: 0.806 Test Loss: 0.442 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 1.0053870677947998
Epoch: 11, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.434 Vali Acc: 0.783 Test Loss: 0.434 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9673995971679688
Epoch: 12, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.409 Vali Acc: 0.772 Test Loss: 0.409 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9500279426574707
Epoch: 13, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.388 Vali Acc: 0.817 Test Loss: 0.388 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 14 cost time: 0.9904539585113525
Epoch: 14, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.358 Vali Acc: 0.828 Test Loss: 0.358 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 15 cost time: 1.066972255706787
Epoch: 15, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.357 Vali Acc: 0.817 Test Loss: 0.357 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.107118844985962
Epoch: 16, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.355 Vali Acc: 0.811 Test Loss: 0.355 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9968366622924805
Epoch: 17, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.341 Vali Acc: 0.822 Test Loss: 0.341 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.02716064453125
Epoch: 18, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 19 cost time: 1.0813305377960205
Epoch: 19, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.330 Vali Acc: 0.822 Test Loss: 0.330 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0571324825286865
Epoch: 20, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.319 Vali Acc: 0.833 Test Loss: 0.319 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 21 cost time: 0.9970719814300537
Epoch: 21, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 22 cost time: 0.906095027923584
Epoch: 22, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.311 Vali Acc: 0.850 Test Loss: 0.311 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 23 cost time: 0.9375793933868408
Epoch: 23, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 24 cost time: 0.922015905380249
Epoch: 24, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9047329425811768
Epoch: 25, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.301 Vali Acc: 0.844 Test Loss: 0.301 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9301803112030029
Epoch: 26, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.302 Vali Acc: 0.839 Test Loss: 0.302 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0350589752197266
Epoch: 27, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.301 Vali Acc: 0.844 Test Loss: 0.301 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0517001152038574
Epoch: 28, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
Validation loss decreased (-0.855553 --> -0.855553).  Saving model ...
Epoch: 29 cost time: 1.1836678981781006
Epoch: 29, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 30 cost time: 1.1954922676086426
Epoch: 30, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 31 cost time: 1.0916833877563477
Epoch: 31, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9731085300445557
Epoch: 32, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.322 Vali Acc: 0.822 Test Loss: 0.322 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1439435482025146
Epoch: 33, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9680559635162354
Epoch: 34, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.240534782409668
Epoch: 35, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1138267517089844
Epoch: 36, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2096776962280273
Epoch: 37, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 38 cost time: 1.16163969039917
Epoch: 38, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 39 cost time: 1.1718695163726807
Epoch: 39, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1504120826721191
Epoch: 40, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9882819652557373
Epoch: 41, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 42 cost time: 1.0731265544891357
Epoch: 42, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1317262649536133
Epoch: 43, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 44 cost time: 1.047806978225708
Epoch: 44, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1342639923095703
Epoch: 45, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9797255992889404
Epoch: 46, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0989816188812256
Epoch: 47, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.123610019683838
Epoch: 48, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.1863338947296143
Epoch: 49, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.0755603313446045
Epoch: 50, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.376 Vali Acc: 0.828 Test Loss: 0.376 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.021695613861084
Epoch: 51, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.3261034488677979
Epoch: 52, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.293 Vali Acc: 0.883 Test Loss: 0.293 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.1267120838165283
Epoch: 53, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 69110
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.653777837753296
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.602 Vali Acc: 0.367 Test Loss: 1.602 Test Acc: 0.367
Validation loss decreased (inf --> -0.366651).  Saving model ...
Epoch: 2 cost time: 0.9810681343078613
Epoch: 2, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.253 Vali Acc: 0.539 Test Loss: 1.253 Test Acc: 0.539
Validation loss decreased (-0.366651 --> -0.538876).  Saving model ...
Epoch: 3 cost time: 1.2572896480560303
Epoch: 3, Steps: 12 | Train Loss: 1.117 Vali Loss: 0.977 Vali Acc: 0.672 Test Loss: 0.977 Test Acc: 0.672
Validation loss decreased (-0.538876 --> -0.672212).  Saving model ...
Epoch: 4 cost time: 1.0628676414489746
Epoch: 4, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.805 Vali Acc: 0.700 Test Loss: 0.805 Test Acc: 0.700
Validation loss decreased (-0.672212 --> -0.699992).  Saving model ...
Epoch: 5 cost time: 1.0704281330108643
Epoch: 5, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.686 Vali Acc: 0.711 Test Loss: 0.686 Test Acc: 0.711
Validation loss decreased (-0.699992 --> -0.711104).  Saving model ...
Epoch: 6 cost time: 1.2104709148406982
Epoch: 6, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.595 Vali Acc: 0.761 Test Loss: 0.595 Test Acc: 0.761
Validation loss decreased (-0.711104 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 1.048997402191162
Epoch: 7, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.543 Vali Acc: 0.756 Test Loss: 0.543 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1142830848693848
Epoch: 8, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
Validation loss decreased (-0.761105 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 1.0551469326019287
Epoch: 9, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.467 Vali Acc: 0.778 Test Loss: 0.467 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9969418048858643
Epoch: 10, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.437 Vali Acc: 0.800 Test Loss: 0.437 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799996).  Saving model ...
Epoch: 11 cost time: 0.9562177658081055
Epoch: 11, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.429 Vali Acc: 0.794 Test Loss: 0.429 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8318603038787842
Epoch: 12, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.408 Vali Acc: 0.783 Test Loss: 0.408 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9976310729980469
Epoch: 13, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.386 Vali Acc: 0.811 Test Loss: 0.386 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 0.8037664890289307
Epoch: 14, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.360 Vali Acc: 0.822 Test Loss: 0.360 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 15 cost time: 0.8469736576080322
Epoch: 15, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.359 Vali Acc: 0.817 Test Loss: 0.359 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.042147159576416
Epoch: 16, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.355 Vali Acc: 0.811 Test Loss: 0.355 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.966388463973999
Epoch: 17, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.341 Vali Acc: 0.817 Test Loss: 0.341 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9360978603363037
Epoch: 18, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 19 cost time: 1.0575122833251953
Epoch: 19, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.331 Vali Acc: 0.817 Test Loss: 0.331 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0016963481903076
Epoch: 20, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 21 cost time: 0.8862061500549316
Epoch: 21, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 22 cost time: 1.0481910705566406
Epoch: 22, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1227340698242188
Epoch: 23, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 24 cost time: 1.136061191558838
Epoch: 24, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1999797821044922
Epoch: 25, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.310 Vali Acc: 0.839 Test Loss: 0.310 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.012676477432251
Epoch: 26, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9727048873901367
Epoch: 27, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.302 Vali Acc: 0.833 Test Loss: 0.302 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0846483707427979
Epoch: 28, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1835095882415771
Epoch: 29, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 30 cost time: 1.1630988121032715
Epoch: 30, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1088390350341797
Epoch: 31, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9852039813995361
Epoch: 32, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.344 Vali Acc: 0.822 Test Loss: 0.344 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0491561889648438
Epoch: 33, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.319 Vali Acc: 0.844 Test Loss: 0.319 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0520508289337158
Epoch: 34, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.344 Vali Acc: 0.817 Test Loss: 0.344 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1005370616912842
Epoch: 35, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 36 cost time: 0.9807219505310059
Epoch: 36, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.00935959815979
Epoch: 37, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 38 cost time: 0.9842560291290283
Epoch: 38, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 39 cost time: 0.8841242790222168
Epoch: 39, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8892757892608643
Epoch: 40, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9199526309967041
Epoch: 41, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 0.8827419281005859
Epoch: 42, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.070486307144165
Epoch: 43, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.034006118774414
Epoch: 44, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9873790740966797
Epoch: 45, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.275 Vali Acc: 0.872 Test Loss: 0.275 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0118772983551025
Epoch: 46, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0618016719818115
Epoch: 47, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0465917587280273
Epoch: 48, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.370 Vali Acc: 0.833 Test Loss: 0.370 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9248366355895996
Epoch: 49, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9996216297149658
Epoch: 50, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.0371832847595215
Epoch: 51, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.290 Vali Acc: 0.878 Test Loss: 0.290 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 69110
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1017062664031982
Epoch: 1, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.634 Vali Acc: 0.311 Test Loss: 1.634 Test Acc: 0.311
Validation loss decreased (inf --> -0.311095).  Saving model ...
Epoch: 2 cost time: 0.9172909259796143
Epoch: 2, Steps: 12 | Train Loss: 1.419 Vali Loss: 1.296 Vali Acc: 0.644 Test Loss: 1.296 Test Acc: 0.644
Validation loss decreased (-0.311095 --> -0.644431).  Saving model ...
Epoch: 3 cost time: 0.8005743026733398
Epoch: 3, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.019 Vali Acc: 0.667 Test Loss: 1.019 Test Acc: 0.667
Validation loss decreased (-0.644431 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 0.9529232978820801
Epoch: 4, Steps: 12 | Train Loss: 0.855 Vali Loss: 0.839 Vali Acc: 0.722 Test Loss: 0.839 Test Acc: 0.722
Validation loss decreased (-0.666656 --> -0.722214).  Saving model ...
Epoch: 5 cost time: 1.080451488494873
Epoch: 5, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.716 Vali Acc: 0.728 Test Loss: 0.716 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 1.0872290134429932
Epoch: 6, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.620 Vali Acc: 0.761 Test Loss: 0.620 Test Acc: 0.761
Validation loss decreased (-0.727771 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 1.0773415565490723
Epoch: 7, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.552 Vali Acc: 0.739 Test Loss: 0.552 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9867045879364014
Epoch: 8, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
Validation loss decreased (-0.761105 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 1.0650429725646973
Epoch: 9, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.472 Vali Acc: 0.783 Test Loss: 0.472 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 10 cost time: 1.0953624248504639
Epoch: 10, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.438 Vali Acc: 0.828 Test Loss: 0.438 Test Acc: 0.828
Validation loss decreased (-0.783329 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 0.9569606781005859
Epoch: 11, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.431 Vali Acc: 0.811 Test Loss: 0.431 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.020082950592041
Epoch: 12, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.415 Vali Acc: 0.800 Test Loss: 0.415 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1418352127075195
Epoch: 13, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.387 Vali Acc: 0.828 Test Loss: 0.387 Test Acc: 0.828
Validation loss decreased (-0.827773 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 1.0331194400787354
Epoch: 14, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.370 Vali Acc: 0.822 Test Loss: 0.370 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2734861373901367
Epoch: 15, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.370 Vali Acc: 0.822 Test Loss: 0.370 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2216312885284424
Epoch: 16, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.375 Vali Acc: 0.833 Test Loss: 0.375 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 17 cost time: 1.1485297679901123
Epoch: 17, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.356 Vali Acc: 0.806 Test Loss: 0.356 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0351154804229736
Epoch: 18, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.344 Vali Acc: 0.839 Test Loss: 0.344 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 19 cost time: 0.9990921020507812
Epoch: 19, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.337 Vali Acc: 0.828 Test Loss: 0.337 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9734945297241211
Epoch: 20, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.331 Vali Acc: 0.867 Test Loss: 0.331 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866663).  Saving model ...
Epoch: 21 cost time: 1.0955860614776611
Epoch: 21, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.317 Vali Acc: 0.883 Test Loss: 0.317 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 0.9588348865509033
Epoch: 22, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.033315896987915
Epoch: 23, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9152162075042725
Epoch: 24, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0783028602600098
Epoch: 25, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.310 Vali Acc: 0.839 Test Loss: 0.310 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8995223045349121
Epoch: 26, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.182934045791626
Epoch: 27, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.310 Vali Acc: 0.811 Test Loss: 0.310 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1857409477233887
Epoch: 28, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0234096050262451
Epoch: 29, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.077688217163086
Epoch: 30, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1633007526397705
Epoch: 31, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 1.1453535556793213
Epoch: 32, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.350 Vali Acc: 0.817 Test Loss: 0.350 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.195659875869751
Epoch: 33, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0716867446899414
Epoch: 34, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.355 Vali Acc: 0.811 Test Loss: 0.355 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0748023986816406
Epoch: 35, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.288 Vali Acc: 0.850 Test Loss: 0.288 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9996168613433838
Epoch: 36, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8722443580627441
Epoch: 37, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9248664379119873
Epoch: 38, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0006320476531982
Epoch: 39, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.319 Vali Acc: 0.833 Test Loss: 0.319 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1949751377105713
Epoch: 40, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.327 Vali Acc: 0.828 Test Loss: 0.327 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1566638946533203
Epoch: 41, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 69110
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1377298831939697
Epoch: 1, Steps: 12 | Train Loss: 1.949 Vali Loss: 1.746 Vali Acc: 0.239 Test Loss: 1.746 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 1.0201454162597656
Epoch: 2, Steps: 12 | Train Loss: 1.587 Vali Loss: 1.357 Vali Acc: 0.478 Test Loss: 1.357 Test Acc: 0.478
Validation loss decreased (-0.238871 --> -0.477764).  Saving model ...
Epoch: 3 cost time: 1.1232621669769287
Epoch: 3, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.041 Vali Acc: 0.667 Test Loss: 1.041 Test Acc: 0.667
Validation loss decreased (-0.477764 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 1.1702909469604492
Epoch: 4, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.834 Vali Acc: 0.717 Test Loss: 0.834 Test Acc: 0.717
Validation loss decreased (-0.666656 --> -0.716658).  Saving model ...
Epoch: 5 cost time: 1.1606757640838623
Epoch: 5, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.717 Vali Acc: 0.678 Test Loss: 0.717 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1614110469818115
Epoch: 6, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.635 Vali Acc: 0.717 Test Loss: 0.635 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716660).  Saving model ...
Epoch: 7 cost time: 1.2714941501617432
Epoch: 7, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.557 Vali Acc: 0.739 Test Loss: 0.557 Test Acc: 0.739
Validation loss decreased (-0.716660 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 1.2200536727905273
Epoch: 8, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.511 Vali Acc: 0.761 Test Loss: 0.511 Test Acc: 0.761
Validation loss decreased (-0.738883 --> -0.761106).  Saving model ...
Epoch: 9 cost time: 1.2575092315673828
Epoch: 9, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.476 Vali Acc: 0.778 Test Loss: 0.476 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777773).  Saving model ...
Epoch: 10 cost time: 1.1135802268981934
Epoch: 10, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.459 Vali Acc: 0.783 Test Loss: 0.459 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 1.0666630268096924
Epoch: 11, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.420 Vali Acc: 0.772 Test Loss: 0.420 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9900760650634766
Epoch: 12, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.400 Vali Acc: 0.833 Test Loss: 0.400 Test Acc: 0.833
Validation loss decreased (-0.783329 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 0.8948886394500732
Epoch: 13, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.387 Vali Acc: 0.800 Test Loss: 0.387 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9573526382446289
Epoch: 14, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.359 Vali Acc: 0.844 Test Loss: 0.359 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 0.9156436920166016
Epoch: 15, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.346 Vali Acc: 0.856 Test Loss: 0.346 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 0.9750981330871582
Epoch: 16, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.346 Vali Acc: 0.811 Test Loss: 0.346 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.041717529296875
Epoch: 17, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.334 Vali Acc: 0.822 Test Loss: 0.334 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9466724395751953
Epoch: 18, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2043941020965576
Epoch: 19, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.317 Vali Acc: 0.833 Test Loss: 0.317 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1196305751800537
Epoch: 20, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.245988368988037
Epoch: 21, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.308 Vali Acc: 0.839 Test Loss: 0.308 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1444180011749268
Epoch: 22, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.302 Vali Acc: 0.839 Test Loss: 0.302 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0003714561462402
Epoch: 23, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.309 Vali Acc: 0.839 Test Loss: 0.309 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2740321159362793
Epoch: 24, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2505404949188232
Epoch: 25, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.294 Vali Acc: 0.856 Test Loss: 0.294 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 26 cost time: 1.2853827476501465
Epoch: 26, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
Validation loss decreased (-0.855553 --> -0.855553).  Saving model ...
Epoch: 27 cost time: 1.2148902416229248
Epoch: 27, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
Validation loss decreased (-0.855553 --> -0.855553).  Saving model ...
Epoch: 28 cost time: 1.2151951789855957
Epoch: 28, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.290 Vali Acc: 0.844 Test Loss: 0.290 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2400407791137695
Epoch: 29, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 30 cost time: 1.164210319519043
Epoch: 30, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 31 cost time: 0.9916605949401855
Epoch: 31, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.286 Vali Acc: 0.856 Test Loss: 0.286 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2061505317687988
Epoch: 32, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 33 cost time: 1.2113277912139893
Epoch: 33, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1075999736785889
Epoch: 34, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.318 Vali Acc: 0.828 Test Loss: 0.318 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1850833892822266
Epoch: 35, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.162156343460083
Epoch: 36, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.281 Vali Acc: 0.844 Test Loss: 0.281 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.216839075088501
Epoch: 37, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 1.1600730419158936
Epoch: 38, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1645729541778564
Epoch: 39, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1712315082550049
Epoch: 40, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911109).  Saving model ...
Epoch: 41 cost time: 0.987189769744873
Epoch: 41, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0705344676971436
Epoch: 42, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1155750751495361
Epoch: 43, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1093721389770508
Epoch: 44, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0596537590026855
Epoch: 45, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9703023433685303
Epoch: 46, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.989351749420166
Epoch: 47, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.2367537021636963
Epoch: 48, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.277782678604126
Epoch: 49, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.2580389976501465
Epoch: 50, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 52726
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2729299068450928
Epoch: 1, Steps: 12 | Train Loss: 1.940 Vali Loss: 1.732 Vali Acc: 0.217 Test Loss: 1.732 Test Acc: 0.217
Validation loss decreased (inf --> -0.216649).  Saving model ...
Epoch: 2 cost time: 0.9807322025299072
Epoch: 2, Steps: 12 | Train Loss: 1.593 Vali Loss: 1.349 Vali Acc: 0.467 Test Loss: 1.349 Test Acc: 0.467
Validation loss decreased (-0.216649 --> -0.466653).  Saving model ...
Epoch: 3 cost time: 1.0574393272399902
Epoch: 3, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.033 Vali Acc: 0.656 Test Loss: 1.033 Test Acc: 0.656
Validation loss decreased (-0.466653 --> -0.655545).  Saving model ...
Epoch: 4 cost time: 0.9283270835876465
Epoch: 4, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.827 Vali Acc: 0.706 Test Loss: 0.827 Test Acc: 0.706
Validation loss decreased (-0.655545 --> -0.705547).  Saving model ...
Epoch: 5 cost time: 1.1306633949279785
Epoch: 5, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.712 Vali Acc: 0.678 Test Loss: 0.712 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3365402221679688
Epoch: 6, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.626 Vali Acc: 0.728 Test Loss: 0.626 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727772).  Saving model ...
Epoch: 7 cost time: 1.1686358451843262
Epoch: 7, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.553 Vali Acc: 0.739 Test Loss: 0.553 Test Acc: 0.739
Validation loss decreased (-0.727772 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 1.1149978637695312
Epoch: 8, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.507 Vali Acc: 0.767 Test Loss: 0.507 Test Acc: 0.767
Validation loss decreased (-0.738883 --> -0.766662).  Saving model ...
Epoch: 9 cost time: 1.1281094551086426
Epoch: 9, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.473 Vali Acc: 0.772 Test Loss: 0.473 Test Acc: 0.772
Validation loss decreased (-0.766662 --> -0.772217).  Saving model ...
Epoch: 10 cost time: 1.0704729557037354
Epoch: 10, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.452 Vali Acc: 0.778 Test Loss: 0.452 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 11 cost time: 1.2894902229309082
Epoch: 11, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.413 Vali Acc: 0.778 Test Loss: 0.413 Test Acc: 0.778
Validation loss decreased (-0.777773 --> -0.777774).  Saving model ...
Epoch: 12 cost time: 1.0554544925689697
Epoch: 12, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.392 Vali Acc: 0.833 Test Loss: 0.392 Test Acc: 0.833
Validation loss decreased (-0.777774 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 1.200655221939087
Epoch: 13, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.381 Vali Acc: 0.800 Test Loss: 0.381 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2514517307281494
Epoch: 14, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.353 Vali Acc: 0.850 Test Loss: 0.353 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 1.0493640899658203
Epoch: 15, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 1.061582326889038
Epoch: 16, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.344 Vali Acc: 0.811 Test Loss: 0.344 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2976574897766113
Epoch: 17, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.331 Vali Acc: 0.828 Test Loss: 0.331 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1336958408355713
Epoch: 18, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.311 Vali Acc: 0.867 Test Loss: 0.311 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 19 cost time: 0.9305727481842041
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.312 Vali Acc: 0.839 Test Loss: 0.312 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0606374740600586
Epoch: 20, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0952558517456055
Epoch: 21, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.305 Vali Acc: 0.844 Test Loss: 0.305 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1084251403808594
Epoch: 22, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0200450420379639
Epoch: 23, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.307 Vali Acc: 0.828 Test Loss: 0.307 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9364016056060791
Epoch: 24, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0924007892608643
Epoch: 25, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0833024978637695
Epoch: 26, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9537723064422607
Epoch: 27, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1196954250335693
Epoch: 28, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.282 Vali Acc: 0.850 Test Loss: 0.282 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 52726
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2152490615844727
Epoch: 1, Steps: 12 | Train Loss: 1.915 Vali Loss: 1.710 Vali Acc: 0.244 Test Loss: 1.710 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 1.0705931186676025
Epoch: 2, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.336 Vali Acc: 0.494 Test Loss: 1.336 Test Acc: 0.494
Validation loss decreased (-0.244427 --> -0.494431).  Saving model ...
Epoch: 3 cost time: 1.077369213104248
Epoch: 3, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.029 Vali Acc: 0.656 Test Loss: 1.029 Test Acc: 0.656
Validation loss decreased (-0.494431 --> -0.655545).  Saving model ...
Epoch: 4 cost time: 1.1177399158477783
Epoch: 4, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.826 Vali Acc: 0.672 Test Loss: 0.826 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672214).  Saving model ...
Epoch: 5 cost time: 1.0435447692871094
Epoch: 5, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.710 Vali Acc: 0.706 Test Loss: 0.710 Test Acc: 0.706
Validation loss decreased (-0.672214 --> -0.705548).  Saving model ...
Epoch: 6 cost time: 1.090484380722046
Epoch: 6, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.625 Vali Acc: 0.722 Test Loss: 0.625 Test Acc: 0.722
Validation loss decreased (-0.705548 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 1.0232434272766113
Epoch: 7, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.547 Vali Acc: 0.728 Test Loss: 0.547 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727772).  Saving model ...
Epoch: 8 cost time: 1.1889886856079102
Epoch: 8, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.502 Vali Acc: 0.739 Test Loss: 0.502 Test Acc: 0.739
Validation loss decreased (-0.727772 --> -0.738884).  Saving model ...
Epoch: 9 cost time: 1.0661659240722656
Epoch: 9, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.470 Vali Acc: 0.744 Test Loss: 0.470 Test Acc: 0.744
Validation loss decreased (-0.738884 --> -0.744440).  Saving model ...
Epoch: 10 cost time: 0.9596953392028809
Epoch: 10, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.447 Vali Acc: 0.767 Test Loss: 0.447 Test Acc: 0.767
Validation loss decreased (-0.744440 --> -0.766662).  Saving model ...
Epoch: 11 cost time: 1.1198773384094238
Epoch: 11, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.415 Vali Acc: 0.778 Test Loss: 0.415 Test Acc: 0.778
Validation loss decreased (-0.766662 --> -0.777774).  Saving model ...
Epoch: 12 cost time: 0.9326827526092529
Epoch: 12, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.391 Vali Acc: 0.806 Test Loss: 0.391 Test Acc: 0.806
Validation loss decreased (-0.777774 --> -0.805552).  Saving model ...
Epoch: 13 cost time: 1.0559799671173096
Epoch: 13, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.377 Vali Acc: 0.800 Test Loss: 0.377 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1485810279846191
Epoch: 14, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
Validation loss decreased (-0.805552 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 1.168689489364624
Epoch: 15, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.339 Vali Acc: 0.844 Test Loss: 0.339 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 16 cost time: 1.0588462352752686
Epoch: 16, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.339 Vali Acc: 0.806 Test Loss: 0.339 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1029284000396729
Epoch: 17, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.326 Vali Acc: 0.828 Test Loss: 0.326 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0490922927856445
Epoch: 18, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 1.1268796920776367
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.314 Vali Acc: 0.822 Test Loss: 0.314 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1648378372192383
Epoch: 20, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 21 cost time: 1.1437163352966309
Epoch: 21, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9292755126953125
Epoch: 22, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 23 cost time: 1.185539960861206
Epoch: 23, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.306 Vali Acc: 0.822 Test Loss: 0.306 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.154932975769043
Epoch: 24, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 25 cost time: 1.0824415683746338
Epoch: 25, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.290 Vali Acc: 0.844 Test Loss: 0.290 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.101553201675415
Epoch: 26, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9817683696746826
Epoch: 27, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.285 Vali Acc: 0.844 Test Loss: 0.285 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.056434154510498
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.281 Vali Acc: 0.844 Test Loss: 0.281 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0533041954040527
Epoch: 29, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.290 Vali Acc: 0.850 Test Loss: 0.290 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9689781665802002
Epoch: 30, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0816895961761475
Epoch: 31, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.288 Vali Acc: 0.839 Test Loss: 0.288 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0638093948364258
Epoch: 32, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 0.960425853729248
Epoch: 33, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9555644989013672
Epoch: 34, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.315 Vali Acc: 0.833 Test Loss: 0.315 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9707200527191162
Epoch: 35, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.949481725692749
Epoch: 36, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.291 Vali Acc: 0.839 Test Loss: 0.291 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0351288318634033
Epoch: 37, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0362019538879395
Epoch: 38, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.288 Vali Acc: 0.850 Test Loss: 0.288 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0323553085327148
Epoch: 39, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.262 Vali Acc: 0.867 Test Loss: 0.262 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.103391170501709
Epoch: 40, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.254 Vali Acc: 0.878 Test Loss: 0.254 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1371080875396729
Epoch: 41, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.256 Vali Acc: 0.878 Test Loss: 0.256 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0664913654327393
Epoch: 42, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 52726
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1624703407287598
Epoch: 1, Steps: 12 | Train Loss: 1.828 Vali Loss: 1.658 Vali Acc: 0.244 Test Loss: 1.658 Test Acc: 0.244
Validation loss decreased (inf --> -0.244428).  Saving model ...
Epoch: 2 cost time: 1.136315107345581
Epoch: 2, Steps: 12 | Train Loss: 1.520 Vali Loss: 1.321 Vali Acc: 0.544 Test Loss: 1.321 Test Acc: 0.544
Validation loss decreased (-0.244428 --> -0.544431).  Saving model ...
Epoch: 3 cost time: 1.0592758655548096
Epoch: 3, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.028 Vali Acc: 0.711 Test Loss: 1.028 Test Acc: 0.711
Validation loss decreased (-0.544431 --> -0.711101).  Saving model ...
Epoch: 4 cost time: 1.1609289646148682
Epoch: 4, Steps: 12 | Train Loss: 0.884 Vali Loss: 0.833 Vali Acc: 0.756 Test Loss: 0.833 Test Acc: 0.756
Validation loss decreased (-0.711101 --> -0.755547).  Saving model ...
Epoch: 5 cost time: 1.1087646484375
Epoch: 5, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.719 Vali Acc: 0.700 Test Loss: 0.719 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0859417915344238
Epoch: 6, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.634 Vali Acc: 0.733 Test Loss: 0.634 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0525667667388916
Epoch: 7, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.550 Vali Acc: 0.767 Test Loss: 0.550 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 0.8686048984527588
Epoch: 8, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.0105011463165283
Epoch: 9, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.472 Vali Acc: 0.794 Test Loss: 0.472 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 10 cost time: 1.0614442825317383
Epoch: 10, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.452 Vali Acc: 0.811 Test Loss: 0.452 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 0.9645178318023682
Epoch: 11, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.417 Vali Acc: 0.817 Test Loss: 0.417 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816662).  Saving model ...
Epoch: 12 cost time: 0.9499070644378662
Epoch: 12, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 1.0811398029327393
Epoch: 13, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.391 Vali Acc: 0.833 Test Loss: 0.391 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 0.9034624099731445
Epoch: 14, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.366 Vali Acc: 0.883 Test Loss: 0.366 Test Acc: 0.883
Validation loss decreased (-0.833329 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 0.9700403213500977
Epoch: 15, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 0.9144229888916016
Epoch: 16, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.361 Vali Acc: 0.817 Test Loss: 0.361 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9581682682037354
Epoch: 17, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.351 Vali Acc: 0.856 Test Loss: 0.351 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9663114547729492
Epoch: 18, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2793591022491455
Epoch: 19, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.332 Vali Acc: 0.867 Test Loss: 0.332 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1656861305236816
Epoch: 20, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9895060062408447
Epoch: 21, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1422884464263916
Epoch: 22, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1131350994110107
Epoch: 23, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.326 Vali Acc: 0.806 Test Loss: 0.326 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.13326096534729
Epoch: 24, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9345324039459229
Epoch: 25, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.319 Vali Acc: 0.833 Test Loss: 0.319 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 52726
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.929797649383545
Epoch: 1, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.566 Vali Acc: 0.339 Test Loss: 1.566 Test Acc: 0.339
Validation loss decreased (inf --> -0.338873).  Saving model ...
Epoch: 2 cost time: 1.1275863647460938
Epoch: 2, Steps: 12 | Train Loss: 1.394 Vali Loss: 1.210 Vali Acc: 0.633 Test Loss: 1.210 Test Acc: 0.633
Validation loss decreased (-0.338873 --> -0.633321).  Saving model ...
Epoch: 3 cost time: 1.1097497940063477
Epoch: 3, Steps: 12 | Train Loss: 1.101 Vali Loss: 0.942 Vali Acc: 0.683 Test Loss: 0.942 Test Acc: 0.683
Validation loss decreased (-0.633321 --> -0.683324).  Saving model ...
Epoch: 4 cost time: 0.8706414699554443
Epoch: 4, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.799 Vali Acc: 0.717 Test Loss: 0.799 Test Acc: 0.717
Validation loss decreased (-0.683324 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 1.0812180042266846
Epoch: 5, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.674 Vali Acc: 0.717 Test Loss: 0.674 Test Acc: 0.717
Validation loss decreased (-0.716659 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 1.0816800594329834
Epoch: 6, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.604 Vali Acc: 0.756 Test Loss: 0.604 Test Acc: 0.756
Validation loss decreased (-0.716660 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 1.0548372268676758
Epoch: 7, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.539 Vali Acc: 0.756 Test Loss: 0.539 Test Acc: 0.756
Validation loss decreased (-0.755550 --> -0.755550).  Saving model ...
Epoch: 8 cost time: 1.1731781959533691
Epoch: 8, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.492 Vali Acc: 0.772 Test Loss: 0.492 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 1.0273332595825195
Epoch: 9, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.465 Vali Acc: 0.783 Test Loss: 0.465 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 10 cost time: 1.0731399059295654
Epoch: 10, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.426 Vali Acc: 0.783 Test Loss: 0.426 Test Acc: 0.783
Validation loss decreased (-0.783329 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 1.065955638885498
Epoch: 11, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.421 Vali Acc: 0.800 Test Loss: 0.421 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 12 cost time: 1.0897536277770996
Epoch: 12, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.403 Vali Acc: 0.811 Test Loss: 0.403 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 13 cost time: 0.9035906791687012
Epoch: 13, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.391 Vali Acc: 0.811 Test Loss: 0.391 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 1.0380144119262695
Epoch: 14, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.380 Vali Acc: 0.828 Test Loss: 0.380 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 15 cost time: 1.1080255508422852
Epoch: 15, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.362 Vali Acc: 0.811 Test Loss: 0.362 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1434247493743896
Epoch: 16, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.346 Vali Acc: 0.811 Test Loss: 0.346 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2041900157928467
Epoch: 17, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.345 Vali Acc: 0.817 Test Loss: 0.345 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.060697078704834
Epoch: 18, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 19 cost time: 1.0412049293518066
Epoch: 19, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.334 Vali Acc: 0.822 Test Loss: 0.334 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1531813144683838
Epoch: 20, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.321 Vali Acc: 0.839 Test Loss: 0.321 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 21 cost time: 1.1455516815185547
Epoch: 21, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855552).  Saving model ...
Epoch: 22 cost time: 1.1396522521972656
Epoch: 22, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0008432865142822
Epoch: 23, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.302 Vali Acc: 0.844 Test Loss: 0.302 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1106436252593994
Epoch: 24, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.302 Vali Acc: 0.844 Test Loss: 0.302 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1415553092956543
Epoch: 25, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.073758840560913
Epoch: 26, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.296 Vali Acc: 0.850 Test Loss: 0.296 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1399776935577393
Epoch: 27, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.281 Vali Acc: 0.850 Test Loss: 0.281 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2093312740325928
Epoch: 28, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.855552 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 1.0967185497283936
Epoch: 29, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2147562503814697
Epoch: 30, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1364240646362305
Epoch: 31, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1695261001586914
Epoch: 32, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.09836745262146
Epoch: 33, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1957919597625732
Epoch: 34, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 35 cost time: 1.0589981079101562
Epoch: 35, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1601040363311768
Epoch: 36, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0584673881530762
Epoch: 37, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.300 Vali Acc: 0.844 Test Loss: 0.300 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0440497398376465
Epoch: 38, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 39 cost time: 1.0720748901367188
Epoch: 39, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1396512985229492
Epoch: 40, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.002518653869629
Epoch: 41, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9473450183868408
Epoch: 42, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 43 cost time: 0.983149528503418
Epoch: 43, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.266 Vali Acc: 0.872 Test Loss: 0.266 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1472852230072021
Epoch: 44, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9572153091430664
Epoch: 45, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.024672508239746
Epoch: 46, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.276 Vali Acc: 0.867 Test Loss: 0.276 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9838180541992188
Epoch: 47, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9694759845733643
Epoch: 48, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1082136631011963
Epoch: 49, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.1567015647888184
Epoch: 50, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.9851346015930176
Epoch: 51, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.1251907348632812
Epoch: 52, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 44534
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.557701349258423
Epoch: 1, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.570 Vali Acc: 0.356 Test Loss: 1.570 Test Acc: 0.356
Validation loss decreased (inf --> -0.355540).  Saving model ...
Epoch: 2 cost time: 1.2736616134643555
Epoch: 2, Steps: 12 | Train Loss: 1.384 Vali Loss: 1.215 Vali Acc: 0.617 Test Loss: 1.215 Test Acc: 0.617
Validation loss decreased (-0.355540 --> -0.616655).  Saving model ...
Epoch: 3 cost time: 1.086172103881836
Epoch: 3, Steps: 12 | Train Loss: 1.100 Vali Loss: 0.946 Vali Acc: 0.689 Test Loss: 0.946 Test Acc: 0.689
Validation loss decreased (-0.616655 --> -0.688879).  Saving model ...
Epoch: 4 cost time: 1.074544906616211
Epoch: 4, Steps: 12 | Train Loss: 0.874 Vali Loss: 0.799 Vali Acc: 0.711 Test Loss: 0.799 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711103).  Saving model ...
Epoch: 5 cost time: 1.1374897956848145
Epoch: 5, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.675 Vali Acc: 0.728 Test Loss: 0.675 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 1.1650714874267578
Epoch: 6, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.097280502319336
Epoch: 7, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.541 Vali Acc: 0.750 Test Loss: 0.541 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749995).  Saving model ...
Epoch: 8 cost time: 1.165562629699707
Epoch: 8, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.493 Vali Acc: 0.778 Test Loss: 0.493 Test Acc: 0.778
Validation loss decreased (-0.749995 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.1741182804107666
Epoch: 9, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.465 Vali Acc: 0.783 Test Loss: 0.465 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 10 cost time: 1.060384750366211
Epoch: 10, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.426 Vali Acc: 0.806 Test Loss: 0.426 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 1.2659740447998047
Epoch: 11, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.419 Vali Acc: 0.811 Test Loss: 0.419 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 1.1842708587646484
Epoch: 12, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.403 Vali Acc: 0.806 Test Loss: 0.403 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.232532024383545
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.392 Vali Acc: 0.806 Test Loss: 0.392 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0216612815856934
Epoch: 14, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.382 Vali Acc: 0.817 Test Loss: 0.382 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 1.0479016304016113
Epoch: 15, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 16 cost time: 1.022653579711914
Epoch: 16, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.344 Vali Acc: 0.817 Test Loss: 0.344 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 17 cost time: 0.9975578784942627
Epoch: 17, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 18 cost time: 0.9590630531311035
Epoch: 18, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.328 Vali Acc: 0.844 Test Loss: 0.328 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 1.217268466949463
Epoch: 19, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2341539859771729
Epoch: 20, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.322 Vali Acc: 0.839 Test Loss: 0.322 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0301055908203125
Epoch: 21, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 22 cost time: 1.1601872444152832
Epoch: 22, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0977349281311035
Epoch: 23, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 24 cost time: 1.2205543518066406
Epoch: 24, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2127654552459717
Epoch: 25, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.330601453781128
Epoch: 26, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0265216827392578
Epoch: 27, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 28 cost time: 1.209831714630127
Epoch: 28, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 1.1704206466674805
Epoch: 29, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.283 Vali Acc: 0.856 Test Loss: 0.283 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.023226261138916
Epoch: 30, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9456143379211426
Epoch: 31, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0106430053710938
Epoch: 32, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9422764778137207
Epoch: 33, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9291892051696777
Epoch: 34, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.904184103012085
Epoch: 35, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.895402193069458
Epoch: 36, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1274092197418213
Epoch: 37, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.313 Vali Acc: 0.828 Test Loss: 0.313 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9681968688964844
Epoch: 38, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 39 cost time: 1.187378168106079
Epoch: 39, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1435332298278809
Epoch: 40, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1876311302185059
Epoch: 41, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.275 Vali Acc: 0.861 Test Loss: 0.275 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1418707370758057
Epoch: 42, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 1.195227861404419
Epoch: 43, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9813389778137207
Epoch: 44, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1180381774902344
Epoch: 45, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0882353782653809
Epoch: 46, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2053818702697754
Epoch: 47, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.292 Vali Acc: 0.883 Test Loss: 0.292 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2639820575714111
Epoch: 48, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1437132358551025
Epoch: 49, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.1770110130310059
Epoch: 50, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.0081157684326172
Epoch: 51, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.220226764678955
Epoch: 52, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 44534
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4410643577575684
Epoch: 1, Steps: 12 | Train Loss: 1.727 Vali Loss: 1.568 Vali Acc: 0.361 Test Loss: 1.568 Test Acc: 0.361
Validation loss decreased (inf --> -0.361095).  Saving model ...
Epoch: 2 cost time: 0.891207218170166
Epoch: 2, Steps: 12 | Train Loss: 1.394 Vali Loss: 1.216 Vali Acc: 0.606 Test Loss: 1.216 Test Acc: 0.606
Validation loss decreased (-0.361095 --> -0.605543).  Saving model ...
Epoch: 3 cost time: 1.07786226272583
Epoch: 3, Steps: 12 | Train Loss: 1.102 Vali Loss: 0.947 Vali Acc: 0.667 Test Loss: 0.947 Test Acc: 0.667
Validation loss decreased (-0.605543 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 0.964275598526001
Epoch: 4, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.796 Vali Acc: 0.700 Test Loss: 0.796 Test Acc: 0.700
Validation loss decreased (-0.666657 --> -0.699992).  Saving model ...
Epoch: 5 cost time: 0.9851150512695312
Epoch: 5, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.678 Vali Acc: 0.706 Test Loss: 0.678 Test Acc: 0.706
Validation loss decreased (-0.699992 --> -0.705549).  Saving model ...
Epoch: 6 cost time: 1.0766265392303467
Epoch: 6, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.601 Vali Acc: 0.733 Test Loss: 0.601 Test Acc: 0.733
Validation loss decreased (-0.705549 --> -0.733327).  Saving model ...
Epoch: 7 cost time: 1.0635552406311035
Epoch: 7, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.539 Vali Acc: 0.744 Test Loss: 0.539 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744439).  Saving model ...
Epoch: 8 cost time: 1.044942855834961
Epoch: 8, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.491 Vali Acc: 0.794 Test Loss: 0.491 Test Acc: 0.794
Validation loss decreased (-0.744439 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 0.9479248523712158
Epoch: 9, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.466 Vali Acc: 0.772 Test Loss: 0.466 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0263690948486328
Epoch: 10, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.428 Vali Acc: 0.794 Test Loss: 0.428 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 1.0017423629760742
Epoch: 11, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.416 Vali Acc: 0.806 Test Loss: 0.416 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 12 cost time: 1.0269758701324463
Epoch: 12, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.398 Vali Acc: 0.806 Test Loss: 0.398 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805552).  Saving model ...
Epoch: 13 cost time: 0.8985815048217773
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.387 Vali Acc: 0.794 Test Loss: 0.387 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0714025497436523
Epoch: 14, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.377 Vali Acc: 0.822 Test Loss: 0.377 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 1.0747144222259521
Epoch: 15, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.360 Vali Acc: 0.817 Test Loss: 0.360 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1530280113220215
Epoch: 16, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.343 Vali Acc: 0.817 Test Loss: 0.343 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0995516777038574
Epoch: 17, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 18 cost time: 1.0428194999694824
Epoch: 18, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.328 Vali Acc: 0.844 Test Loss: 0.328 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 1.0078234672546387
Epoch: 19, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.332 Vali Acc: 0.822 Test Loss: 0.332 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0863151550292969
Epoch: 20, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.319 Vali Acc: 0.828 Test Loss: 0.319 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1027648448944092
Epoch: 21, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 22 cost time: 1.1517696380615234
Epoch: 22, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.307 Vali Acc: 0.822 Test Loss: 0.307 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2648539543151855
Epoch: 23, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 24 cost time: 0.919471025466919
Epoch: 24, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.305 Vali Acc: 0.844 Test Loss: 0.305 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.036372184753418
Epoch: 25, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
Validation loss decreased (-0.855553 --> -0.855553).  Saving model ...
Epoch: 26 cost time: 0.9598946571350098
Epoch: 26, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 27 cost time: 1.0896129608154297
Epoch: 27, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 28 cost time: 1.1014604568481445
Epoch: 28, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 29 cost time: 1.0479843616485596
Epoch: 29, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.286 Vali Acc: 0.856 Test Loss: 0.286 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.042518138885498
Epoch: 30, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0961236953735352
Epoch: 31, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0126702785491943
Epoch: 32, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9944117069244385
Epoch: 33, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 34 cost time: 0.7810649871826172
Epoch: 34, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9383578300476074
Epoch: 35, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.283 Vali Acc: 0.856 Test Loss: 0.283 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.063302755355835
Epoch: 36, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0875654220581055
Epoch: 37, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.303 Vali Acc: 0.833 Test Loss: 0.303 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0506176948547363
Epoch: 38, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0124735832214355
Epoch: 39, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.98439621925354
Epoch: 40, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.263 Vali Acc: 0.872 Test Loss: 0.263 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0574061870574951
Epoch: 41, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.273 Vali Acc: 0.861 Test Loss: 0.273 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.1517689228057861
Epoch: 42, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9499781131744385
Epoch: 43, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.275 Vali Acc: 0.867 Test Loss: 0.275 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 44534
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4874203205108643
Epoch: 1, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.584 Vali Acc: 0.383 Test Loss: 1.584 Test Acc: 0.383
Validation loss decreased (inf --> -0.383317).  Saving model ...
Epoch: 2 cost time: 0.9805536270141602
Epoch: 2, Steps: 12 | Train Loss: 1.423 Vali Loss: 1.263 Vali Acc: 0.567 Test Loss: 1.263 Test Acc: 0.567
Validation loss decreased (-0.383317 --> -0.566654).  Saving model ...
Epoch: 3 cost time: 0.9258871078491211
Epoch: 3, Steps: 12 | Train Loss: 1.125 Vali Loss: 0.997 Vali Acc: 0.672 Test Loss: 0.997 Test Acc: 0.672
Validation loss decreased (-0.566654 --> -0.672212).  Saving model ...
Epoch: 4 cost time: 1.134221076965332
Epoch: 4, Steps: 12 | Train Loss: 0.885 Vali Loss: 0.835 Vali Acc: 0.689 Test Loss: 0.835 Test Acc: 0.689
Validation loss decreased (-0.672212 --> -0.688881).  Saving model ...
Epoch: 5 cost time: 1.0869441032409668
Epoch: 5, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.714 Vali Acc: 0.706 Test Loss: 0.714 Test Acc: 0.706
Validation loss decreased (-0.688881 --> -0.705548).  Saving model ...
Epoch: 6 cost time: 0.9746646881103516
Epoch: 6, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.633 Vali Acc: 0.761 Test Loss: 0.633 Test Acc: 0.761
Validation loss decreased (-0.705548 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 0.9494550228118896
Epoch: 7, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9383668899536133
Epoch: 8, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.525 Vali Acc: 0.772 Test Loss: 0.525 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 1.0585720539093018
Epoch: 9, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 1.047163963317871
Epoch: 10, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.451 Vali Acc: 0.806 Test Loss: 0.451 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 1.0261633396148682
Epoch: 11, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.445 Vali Acc: 0.789 Test Loss: 0.445 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1107604503631592
Epoch: 12, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.430 Vali Acc: 0.789 Test Loss: 0.430 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9896817207336426
Epoch: 13, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.420 Vali Acc: 0.789 Test Loss: 0.420 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8671414852142334
Epoch: 14, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.409 Vali Acc: 0.806 Test Loss: 0.409 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805551).  Saving model ...
Epoch: 15 cost time: 0.9723954200744629
Epoch: 15, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.394 Vali Acc: 0.789 Test Loss: 0.394 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9618511199951172
Epoch: 16, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.372 Vali Acc: 0.811 Test Loss: 0.372 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 17 cost time: 1.0227158069610596
Epoch: 17, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.382 Vali Acc: 0.811 Test Loss: 0.382 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1138031482696533
Epoch: 18, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.362 Vali Acc: 0.861 Test Loss: 0.362 Test Acc: 0.861
Validation loss decreased (-0.811107 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 1.1038823127746582
Epoch: 19, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.366 Vali Acc: 0.817 Test Loss: 0.366 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9574785232543945
Epoch: 20, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.355 Vali Acc: 0.817 Test Loss: 0.355 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9362056255340576
Epoch: 21, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.344 Vali Acc: 0.861 Test Loss: 0.344 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 22 cost time: 0.9152917861938477
Epoch: 22, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.341 Vali Acc: 0.822 Test Loss: 0.341 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1464455127716064
Epoch: 23, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0125963687896729
Epoch: 24, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.349 Vali Acc: 0.817 Test Loss: 0.349 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.016125202178955
Epoch: 25, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.332 Vali Acc: 0.856 Test Loss: 0.332 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9431064128875732
Epoch: 26, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9699573516845703
Epoch: 27, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0155830383300781
Epoch: 28, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0569255352020264
Epoch: 29, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.326 Vali Acc: 0.839 Test Loss: 0.326 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9449172019958496
Epoch: 30, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9155478477478027
Epoch: 31, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 32 cost time: 0.847261905670166
Epoch: 32, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8048105239868164
Epoch: 33, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 34 cost time: 1.1545007228851318
Epoch: 34, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.076521873474121
Epoch: 35, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9482564926147461
Epoch: 36, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.043107271194458
Epoch: 37, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.329 Vali Acc: 0.828 Test Loss: 0.329 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1169548034667969
Epoch: 38, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.062053918838501
Epoch: 39, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 0.936396598815918
Epoch: 40, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0804617404937744
Epoch: 41, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.335 Vali Acc: 0.828 Test Loss: 0.335 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9942762851715088
Epoch: 42, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8784050941467285
Epoch: 43, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8443090915679932
Epoch: 44, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.316 Vali Acc: 0.872 Test Loss: 0.316 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8362140655517578
Epoch: 45, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8856065273284912
Epoch: 46, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8917601108551025
Epoch: 47, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9711477756500244
Epoch: 48, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.347 Vali Acc: 0.850 Test Loss: 0.347 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.2294368743896484
Epoch: 49, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 44534
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1155521869659424
Epoch: 1, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.590 Vali Acc: 0.344 Test Loss: 1.590 Test Acc: 0.344
Validation loss decreased (inf --> -0.344429).  Saving model ...
Epoch: 2 cost time: 0.9866955280303955
Epoch: 2, Steps: 12 | Train Loss: 1.566 Vali Loss: 1.424 Vali Acc: 0.528 Test Loss: 1.424 Test Acc: 0.528
Validation loss decreased (-0.344429 --> -0.527764).  Saving model ...
Epoch: 3 cost time: 1.0525696277618408
Epoch: 3, Steps: 12 | Train Loss: 1.355 Vali Loss: 1.242 Vali Acc: 0.600 Test Loss: 1.242 Test Acc: 0.600
Validation loss decreased (-0.527764 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 1.095484972000122
Epoch: 4, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.067 Vali Acc: 0.706 Test Loss: 1.067 Test Acc: 0.706
Validation loss decreased (-0.599988 --> -0.705545).  Saving model ...
Epoch: 5 cost time: 1.0637059211730957
Epoch: 5, Steps: 12 | Train Loss: 1.000 Vali Loss: 0.922 Vali Acc: 0.683 Test Loss: 0.922 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0307657718658447
Epoch: 6, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.804 Vali Acc: 0.694 Test Loss: 0.804 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0089960098266602
Epoch: 7, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.724 Vali Acc: 0.728 Test Loss: 0.724 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727771).  Saving model ...
Epoch: 8 cost time: 1.0781502723693848
Epoch: 8, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.658 Vali Acc: 0.756 Test Loss: 0.658 Test Acc: 0.756
Validation loss decreased (-0.727771 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 1.0843098163604736
Epoch: 9, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0566811561584473
Epoch: 10, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.565 Vali Acc: 0.744 Test Loss: 0.565 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0578393936157227
Epoch: 11, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.522 Vali Acc: 0.772 Test Loss: 0.522 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772217).  Saving model ...
Epoch: 12 cost time: 1.1181604862213135
Epoch: 12, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.494 Vali Acc: 0.767 Test Loss: 0.494 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0377678871154785
Epoch: 13, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.478 Vali Acc: 0.778 Test Loss: 0.478 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 14 cost time: 1.180893898010254
Epoch: 14, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.457 Vali Acc: 0.767 Test Loss: 0.457 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9849998950958252
Epoch: 15, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.436 Vali Acc: 0.794 Test Loss: 0.436 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 16 cost time: 1.0091938972473145
Epoch: 16, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.422 Vali Acc: 0.794 Test Loss: 0.422 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 17 cost time: 1.104295253753662
Epoch: 17, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.413 Vali Acc: 0.811 Test Loss: 0.413 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 18 cost time: 1.023745059967041
Epoch: 18, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.398 Vali Acc: 0.800 Test Loss: 0.398 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0266547203063965
Epoch: 19, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.374 Vali Acc: 0.828 Test Loss: 0.374 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 20 cost time: 1.0178301334381104
Epoch: 20, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.365 Vali Acc: 0.817 Test Loss: 0.365 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0056605339050293
Epoch: 21, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0003011226654053
Epoch: 22, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.358 Vali Acc: 0.811 Test Loss: 0.358 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0989487171173096
Epoch: 23, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 24 cost time: 0.946124792098999
Epoch: 24, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8852877616882324
Epoch: 25, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.325 Vali Acc: 0.856 Test Loss: 0.325 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 26 cost time: 0.9444112777709961
Epoch: 26, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9314610958099365
Epoch: 27, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.328 Vali Acc: 0.850 Test Loss: 0.328 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0939865112304688
Epoch: 28, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8949263095855713
Epoch: 29, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1706719398498535
Epoch: 30, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.319 Vali Acc: 0.856 Test Loss: 0.319 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 31 cost time: 1.1536104679107666
Epoch: 31, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.310 Vali Acc: 0.833 Test Loss: 0.310 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1582741737365723
Epoch: 32, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9981846809387207
Epoch: 33, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 34 cost time: 1.039459228515625
Epoch: 34, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.296 Vali Acc: 0.850 Test Loss: 0.296 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1073486804962158
Epoch: 35, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.294 Vali Acc: 0.850 Test Loss: 0.294 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1026887893676758
Epoch: 36, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 37 cost time: 1.0486335754394531
Epoch: 37, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0373499393463135
Epoch: 38, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0166659355163574
Epoch: 39, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.290 Vali Acc: 0.850 Test Loss: 0.290 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0547215938568115
Epoch: 40, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0887045860290527
Epoch: 41, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.277 Vali Acc: 0.856 Test Loss: 0.277 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1789345741271973
Epoch: 42, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 43 cost time: 1.133202075958252
Epoch: 43, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.275 Vali Acc: 0.850 Test Loss: 0.275 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.151994228363037
Epoch: 44, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.077209234237671
Epoch: 45, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 46 cost time: 0.9042234420776367
Epoch: 46, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.280 Vali Acc: 0.861 Test Loss: 0.280 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.847900390625
Epoch: 47, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.269 Vali Acc: 0.867 Test Loss: 0.269 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9288163185119629
Epoch: 48, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0742650032043457
Epoch: 49, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.0966236591339111
Epoch: 50, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.0332167148590088
Epoch: 51, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.270 Vali Acc: 0.867 Test Loss: 0.270 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0127429962158203
Epoch: 52, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.269 Vali Acc: 0.867 Test Loss: 0.269 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0136072635650635
Epoch: 53, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 54 cost time: 0.9652974605560303
Epoch: 54, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.258 Vali Acc: 0.872 Test Loss: 0.258 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0526044368743896
Epoch: 55, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.1115524768829346
Epoch: 56, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.263 Vali Acc: 0.867 Test Loss: 0.263 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.0050008296966553
Epoch: 57, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.266 Vali Acc: 0.867 Test Loss: 0.266 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.0045828819274902
Epoch: 58, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.9425222873687744
Epoch: 59, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.9724178314208984
Epoch: 60, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.0364232063293457
Epoch: 61, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.270 Vali Acc: 0.867 Test Loss: 0.270 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.0091595649719238
Epoch: 62, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 63 cost time: 1.1167817115783691
Epoch: 63, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.104928970336914
Epoch: 64, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.941838264465332
Epoch: 65, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.266 Vali Acc: 0.872 Test Loss: 0.266 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.0464413166046143
Epoch: 66, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.267 Vali Acc: 0.872 Test Loss: 0.267 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.0107371807098389
Epoch: 67, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.266 Vali Acc: 0.872 Test Loss: 0.266 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.9451909065246582
Epoch: 68, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.9299521446228027
Epoch: 69, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.9091701507568359
Epoch: 70, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.9432199001312256
Epoch: 71, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.1296908855438232
Epoch: 72, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.261 Vali Acc: 0.872 Test Loss: 0.261 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 147254
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6203763484954834
Epoch: 1, Steps: 12 | Train Loss: 1.705 Vali Loss: 1.596 Vali Acc: 0.350 Test Loss: 1.596 Test Acc: 0.350
Validation loss decreased (inf --> -0.349984).  Saving model ...
Epoch: 2 cost time: 0.9465625286102295
Epoch: 2, Steps: 12 | Train Loss: 1.542 Vali Loss: 1.430 Vali Acc: 0.528 Test Loss: 1.430 Test Acc: 0.528
Validation loss decreased (-0.349984 --> -0.527763).  Saving model ...
Epoch: 3 cost time: 0.926337718963623
Epoch: 3, Steps: 12 | Train Loss: 1.346 Vali Loss: 1.249 Vali Acc: 0.578 Test Loss: 1.249 Test Acc: 0.578
Validation loss decreased (-0.527763 --> -0.577765).  Saving model ...
Epoch: 4 cost time: 0.9432220458984375
Epoch: 4, Steps: 12 | Train Loss: 1.174 Vali Loss: 1.072 Vali Acc: 0.656 Test Loss: 1.072 Test Acc: 0.656
Validation loss decreased (-0.577765 --> -0.655545).  Saving model ...
Epoch: 5 cost time: 0.8559916019439697
Epoch: 5, Steps: 12 | Train Loss: 0.996 Vali Loss: 0.925 Vali Acc: 0.694 Test Loss: 0.925 Test Acc: 0.694
Validation loss decreased (-0.655545 --> -0.694435).  Saving model ...
Epoch: 6 cost time: 0.9093856811523438
Epoch: 6, Steps: 12 | Train Loss: 0.840 Vali Loss: 0.807 Vali Acc: 0.683 Test Loss: 0.807 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8288209438323975
Epoch: 7, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.724 Vali Acc: 0.694 Test Loss: 0.724 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694437).  Saving model ...
Epoch: 8 cost time: 0.8236076831817627
Epoch: 8, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.659 Vali Acc: 0.744 Test Loss: 0.659 Test Acc: 0.744
Validation loss decreased (-0.694437 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 0.9640722274780273
Epoch: 9, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.608 Vali Acc: 0.711 Test Loss: 0.608 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0627248287200928
Epoch: 10, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.564 Vali Acc: 0.739 Test Loss: 0.564 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9497871398925781
Epoch: 11, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.522 Vali Acc: 0.772 Test Loss: 0.522 Test Acc: 0.772
Validation loss decreased (-0.744438 --> -0.772217).  Saving model ...
Epoch: 12 cost time: 0.9963762760162354
Epoch: 12, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.494 Vali Acc: 0.767 Test Loss: 0.494 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0469892024993896
Epoch: 13, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.473 Vali Acc: 0.783 Test Loss: 0.473 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 14 cost time: 1.0756335258483887
Epoch: 14, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.452 Vali Acc: 0.767 Test Loss: 0.452 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8877694606781006
Epoch: 15, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.434 Vali Acc: 0.800 Test Loss: 0.434 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 16 cost time: 1.077361822128296
Epoch: 16, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.419 Vali Acc: 0.822 Test Loss: 0.419 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 17 cost time: 1.1374876499176025
Epoch: 17, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.410 Vali Acc: 0.800 Test Loss: 0.410 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0239315032958984
Epoch: 18, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.393 Vali Acc: 0.828 Test Loss: 0.393 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 1.0089917182922363
Epoch: 19, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.377 Vali Acc: 0.817 Test Loss: 0.377 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0182573795318604
Epoch: 20, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1062235832214355
Epoch: 21, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.361 Vali Acc: 0.817 Test Loss: 0.361 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.031921148300171
Epoch: 22, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.359 Vali Acc: 0.806 Test Loss: 0.359 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.019768476486206
Epoch: 23, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 24 cost time: 1.010185956954956
Epoch: 24, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.947007417678833
Epoch: 25, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 26 cost time: 1.013836145401001
Epoch: 26, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.319 Vali Acc: 0.856 Test Loss: 0.319 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 27 cost time: 1.0133781433105469
Epoch: 27, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.325 Vali Acc: 0.856 Test Loss: 0.325 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1166951656341553
Epoch: 28, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8310244083404541
Epoch: 29, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9491262435913086
Epoch: 30, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 31 cost time: 1.0178203582763672
Epoch: 31, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.317 Vali Acc: 0.811 Test Loss: 0.317 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0264060497283936
Epoch: 32, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9769411087036133
Epoch: 33, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 34 cost time: 1.0238323211669922
Epoch: 34, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0339922904968262
Epoch: 35, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.044687271118164
Epoch: 36, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 37 cost time: 0.883143424987793
Epoch: 37, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8413441181182861
Epoch: 38, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9458446502685547
Epoch: 39, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.290 Vali Acc: 0.850 Test Loss: 0.290 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.992464542388916
Epoch: 40, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9880597591400146
Epoch: 41, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 42 cost time: 0.902475118637085
Epoch: 42, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.113278865814209
Epoch: 43, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.273 Vali Acc: 0.861 Test Loss: 0.273 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9517889022827148
Epoch: 44, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0160915851593018
Epoch: 45, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 1.0198609828948975
Epoch: 46, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.282 Vali Acc: 0.867 Test Loss: 0.282 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0496299266815186
Epoch: 47, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0272488594055176
Epoch: 48, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1400806903839111
Epoch: 49, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.021622896194458
Epoch: 50, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.0996911525726318
Epoch: 51, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0671288967132568
Epoch: 52, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.272 Vali Acc: 0.867 Test Loss: 0.272 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.9637343883514404
Epoch: 53, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.0251755714416504
Epoch: 54, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.258 Vali Acc: 0.867 Test Loss: 0.258 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.9935324192047119
Epoch: 55, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.259 Vali Acc: 0.883 Test Loss: 0.259 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 147254
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1376638412475586
Epoch: 1, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.584 Vali Acc: 0.339 Test Loss: 1.584 Test Acc: 0.339
Validation loss decreased (inf --> -0.338873).  Saving model ...
Epoch: 2 cost time: 0.9637892246246338
Epoch: 2, Steps: 12 | Train Loss: 1.530 Vali Loss: 1.420 Vali Acc: 0.544 Test Loss: 1.420 Test Acc: 0.544
Validation loss decreased (-0.338873 --> -0.544430).  Saving model ...
Epoch: 3 cost time: 0.9447855949401855
Epoch: 3, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.240 Vali Acc: 0.583 Test Loss: 1.240 Test Acc: 0.583
Validation loss decreased (-0.544430 --> -0.583321).  Saving model ...
Epoch: 4 cost time: 1.0341377258300781
Epoch: 4, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.068 Vali Acc: 0.672 Test Loss: 1.068 Test Acc: 0.672
Validation loss decreased (-0.583321 --> -0.672212).  Saving model ...
Epoch: 5 cost time: 1.022111415863037
Epoch: 5, Steps: 12 | Train Loss: 0.981 Vali Loss: 0.917 Vali Acc: 0.700 Test Loss: 0.917 Test Acc: 0.700
Validation loss decreased (-0.672212 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 1.089895248413086
Epoch: 6, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.797 Vali Acc: 0.683 Test Loss: 0.797 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0755479335784912
Epoch: 7, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.716 Vali Acc: 0.717 Test Loss: 0.716 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716660).  Saving model ...
Epoch: 8 cost time: 1.0490822792053223
Epoch: 8, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.653 Vali Acc: 0.728 Test Loss: 0.653 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727771).  Saving model ...
Epoch: 9 cost time: 0.9746041297912598
Epoch: 9, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.604 Vali Acc: 0.717 Test Loss: 0.604 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1399593353271484
Epoch: 10, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.563 Vali Acc: 0.744 Test Loss: 0.563 Test Acc: 0.744
Validation loss decreased (-0.727771 --> -0.744439).  Saving model ...
Epoch: 11 cost time: 1.1347370147705078
Epoch: 11, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
Validation loss decreased (-0.744439 --> -0.761106).  Saving model ...
Epoch: 12 cost time: 1.1718676090240479
Epoch: 12, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.490 Vali Acc: 0.761 Test Loss: 0.490 Test Acc: 0.761
Validation loss decreased (-0.761106 --> -0.761106).  Saving model ...
Epoch: 13 cost time: 1.00416898727417
Epoch: 13, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.472 Vali Acc: 0.789 Test Loss: 0.472 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788884).  Saving model ...
Epoch: 14 cost time: 1.0577383041381836
Epoch: 14, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.448 Vali Acc: 0.794 Test Loss: 0.448 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 15 cost time: 1.1775414943695068
Epoch: 15, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.434 Vali Acc: 0.772 Test Loss: 0.434 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9593911170959473
Epoch: 16, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.419 Vali Acc: 0.778 Test Loss: 0.419 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0037825107574463
Epoch: 17, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.409 Vali Acc: 0.811 Test Loss: 0.409 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 18 cost time: 1.0394701957702637
Epoch: 18, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.387 Vali Acc: 0.800 Test Loss: 0.387 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1424190998077393
Epoch: 19, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.371 Vali Acc: 0.817 Test Loss: 0.371 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 20 cost time: 1.0610122680664062
Epoch: 20, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 21 cost time: 1.2079544067382812
Epoch: 21, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.355 Vali Acc: 0.828 Test Loss: 0.355 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.215552806854248
Epoch: 22, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0251238346099854
Epoch: 23, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 24 cost time: 1.056070327758789
Epoch: 24, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 1.1385283470153809
Epoch: 25, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.324 Vali Acc: 0.850 Test Loss: 0.324 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 26 cost time: 1.2648935317993164
Epoch: 26, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 27 cost time: 1.0787172317504883
Epoch: 27, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1090424060821533
Epoch: 28, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0706462860107422
Epoch: 29, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9474875926971436
Epoch: 30, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.094160556793213
Epoch: 31, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.314 Vali Acc: 0.822 Test Loss: 0.314 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.19515061378479
Epoch: 32, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.308 Vali Acc: 0.839 Test Loss: 0.308 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.186065673828125
Epoch: 33, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 34 cost time: 1.0289688110351562
Epoch: 34, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0961387157440186
Epoch: 35, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0318717956542969
Epoch: 36, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 37 cost time: 1.0620355606079102
Epoch: 37, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 38 cost time: 0.9694972038269043
Epoch: 38, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1134088039398193
Epoch: 39, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1160385608673096
Epoch: 40, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0856361389160156
Epoch: 41, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.282 Vali Acc: 0.867 Test Loss: 0.282 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1409614086151123
Epoch: 42, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1031334400177002
Epoch: 43, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.275 Vali Acc: 0.850 Test Loss: 0.275 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0961089134216309
Epoch: 44, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.285 Vali Acc: 0.856 Test Loss: 0.285 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0624723434448242
Epoch: 45, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 46 cost time: 0.8907396793365479
Epoch: 46, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.287 Vali Acc: 0.856 Test Loss: 0.287 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0603554248809814
Epoch: 47, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.281 Vali Acc: 0.856 Test Loss: 0.281 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9942014217376709
Epoch: 48, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.287 Vali Acc: 0.856 Test Loss: 0.287 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8959202766418457
Epoch: 49, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9441378116607666
Epoch: 50, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.255 Vali Acc: 0.894 Test Loss: 0.255 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 51 cost time: 1.0392119884490967
Epoch: 51, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.254 Vali Acc: 0.883 Test Loss: 0.254 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9938805103302002
Epoch: 52, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 53 cost time: 0.9423856735229492
Epoch: 53, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 54 cost time: 1.0707471370697021
Epoch: 54, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 55 cost time: 1.1858432292938232
Epoch: 55, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2346673011779785
Epoch: 56, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1002631187438965
Epoch: 57, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.053421974182129
Epoch: 58, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.9892992973327637
Epoch: 59, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.108959674835205
Epoch: 60, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.9234142303466797
Epoch: 61, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.239 Vali Acc: 0.889 Test Loss: 0.239 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.0121514797210693
Epoch: 62, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 63 cost time: 1.0067472457885742
Epoch: 63, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.040785551071167
Epoch: 64, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.254 Vali Acc: 0.878 Test Loss: 0.254 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.9291427135467529
Epoch: 65, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.9812850952148438
Epoch: 66, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.066643476486206
Epoch: 67, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.9977943897247314
Epoch: 68, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.256 Vali Acc: 0.878 Test Loss: 0.256 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.0085508823394775
Epoch: 69, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.245 Vali Acc: 0.894 Test Loss: 0.245 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.9748890399932861
Epoch: 70, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.9561769962310791
Epoch: 71, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.9379031658172607
Epoch: 72, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 147254
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3785367012023926
Epoch: 1, Steps: 12 | Train Loss: 1.674 Vali Loss: 1.560 Vali Acc: 0.444 Test Loss: 1.560 Test Acc: 0.444
Validation loss decreased (inf --> -0.444429).  Saving model ...
Epoch: 2 cost time: 1.0976061820983887
Epoch: 2, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.410 Vali Acc: 0.533 Test Loss: 1.410 Test Acc: 0.533
Validation loss decreased (-0.444429 --> -0.533319).  Saving model ...
Epoch: 3 cost time: 0.8873817920684814
Epoch: 3, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.245 Vali Acc: 0.628 Test Loss: 1.245 Test Acc: 0.628
Validation loss decreased (-0.533319 --> -0.627765).  Saving model ...
Epoch: 4 cost time: 1.067631483078003
Epoch: 4, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.082 Vali Acc: 0.672 Test Loss: 1.082 Test Acc: 0.672
Validation loss decreased (-0.627765 --> -0.672211).  Saving model ...
Epoch: 5 cost time: 0.9520525932312012
Epoch: 5, Steps: 12 | Train Loss: 1.004 Vali Loss: 0.936 Vali Acc: 0.694 Test Loss: 0.936 Test Acc: 0.694
Validation loss decreased (-0.672211 --> -0.694435).  Saving model ...
Epoch: 6 cost time: 1.0382213592529297
Epoch: 6, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.820 Vali Acc: 0.689 Test Loss: 0.820 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9306747913360596
Epoch: 7, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.743 Vali Acc: 0.700 Test Loss: 0.743 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699993).  Saving model ...
Epoch: 8 cost time: 0.8599178791046143
Epoch: 8, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.684 Vali Acc: 0.717 Test Loss: 0.684 Test Acc: 0.717
Validation loss decreased (-0.699993 --> -0.716660).  Saving model ...
Epoch: 9 cost time: 1.0264618396759033
Epoch: 9, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.636 Vali Acc: 0.722 Test Loss: 0.636 Test Acc: 0.722
Validation loss decreased (-0.716660 --> -0.722216).  Saving model ...
Epoch: 10 cost time: 0.9879889488220215
Epoch: 10, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.596 Vali Acc: 0.728 Test Loss: 0.596 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727772).  Saving model ...
Epoch: 11 cost time: 0.9876718521118164
Epoch: 11, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.553 Vali Acc: 0.767 Test Loss: 0.553 Test Acc: 0.767
Validation loss decreased (-0.727772 --> -0.766661).  Saving model ...
Epoch: 12 cost time: 1.003807783126831
Epoch: 12, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.526 Vali Acc: 0.761 Test Loss: 0.526 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0503709316253662
Epoch: 13, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788884).  Saving model ...
Epoch: 14 cost time: 1.0151190757751465
Epoch: 14, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.483 Vali Acc: 0.794 Test Loss: 0.483 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 15 cost time: 0.9034018516540527
Epoch: 15, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.459 Vali Acc: 0.789 Test Loss: 0.459 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9835062026977539
Epoch: 16, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.443 Vali Acc: 0.783 Test Loss: 0.443 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0600831508636475
Epoch: 17, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.436 Vali Acc: 0.811 Test Loss: 0.436 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 18 cost time: 1.0102739334106445
Epoch: 18, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.418 Vali Acc: 0.789 Test Loss: 0.418 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.954674243927002
Epoch: 19, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.397 Vali Acc: 0.811 Test Loss: 0.397 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 20 cost time: 0.897730827331543
Epoch: 20, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.386 Vali Acc: 0.833 Test Loss: 0.386 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833329).  Saving model ...
Epoch: 21 cost time: 1.078984022140503
Epoch: 21, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.376 Vali Acc: 0.844 Test Loss: 0.376 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844441).  Saving model ...
Epoch: 22 cost time: 1.0860085487365723
Epoch: 22, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.374 Vali Acc: 0.828 Test Loss: 0.374 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1193485260009766
Epoch: 23, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.369 Vali Acc: 0.844 Test Loss: 0.369 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 24 cost time: 0.993135929107666
Epoch: 24, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.361 Vali Acc: 0.872 Test Loss: 0.361 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 25 cost time: 0.9081382751464844
Epoch: 25, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0248184204101562
Epoch: 26, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9773755073547363
Epoch: 27, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.349 Vali Acc: 0.828 Test Loss: 0.349 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0161001682281494
Epoch: 28, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.013178825378418
Epoch: 29, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.333 Vali Acc: 0.867 Test Loss: 0.333 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9524071216583252
Epoch: 30, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.340 Vali Acc: 0.817 Test Loss: 0.340 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0726664066314697
Epoch: 31, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.329 Vali Acc: 0.833 Test Loss: 0.329 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.102783441543579
Epoch: 32, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1242988109588623
Epoch: 33, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9111785888671875
Epoch: 34, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 147254
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.898953676223755
Epoch: 1, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.735 Vali Acc: 0.239 Test Loss: 1.735 Test Acc: 0.239
Validation loss decreased (inf --> -0.238872).  Saving model ...
Epoch: 2 cost time: 0.8862602710723877
Epoch: 2, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.548 Vali Acc: 0.417 Test Loss: 1.548 Test Acc: 0.417
Validation loss decreased (-0.238872 --> -0.416651).  Saving model ...
Epoch: 3 cost time: 0.9134492874145508
Epoch: 3, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.336 Vali Acc: 0.583 Test Loss: 1.336 Test Acc: 0.583
Validation loss decreased (-0.416651 --> -0.583320).  Saving model ...
Epoch: 4 cost time: 0.8279502391815186
Epoch: 4, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.137 Vali Acc: 0.717 Test Loss: 1.137 Test Acc: 0.717
Validation loss decreased (-0.583320 --> -0.716655).  Saving model ...
Epoch: 5 cost time: 0.9978280067443848
Epoch: 5, Steps: 12 | Train Loss: 1.049 Vali Loss: 0.975 Vali Acc: 0.706 Test Loss: 0.975 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0245633125305176
Epoch: 6, Steps: 12 | Train Loss: 0.872 Vali Loss: 0.837 Vali Acc: 0.694 Test Loss: 0.837 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0066499710083008
Epoch: 7, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.735 Vali Acc: 0.700 Test Loss: 0.735 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.944765567779541
Epoch: 8, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.673 Vali Acc: 0.744 Test Loss: 0.673 Test Acc: 0.744
Validation loss decreased (-0.716655 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 0.8888759613037109
Epoch: 9, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.620 Vali Acc: 0.733 Test Loss: 0.620 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0120832920074463
Epoch: 10, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.588 Vali Acc: 0.744 Test Loss: 0.588 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744439).  Saving model ...
Epoch: 11 cost time: 1.1299540996551514
Epoch: 11, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.548 Vali Acc: 0.750 Test Loss: 0.548 Test Acc: 0.750
Validation loss decreased (-0.744439 --> -0.749995).  Saving model ...
Epoch: 12 cost time: 0.9709880352020264
Epoch: 12, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.527 Vali Acc: 0.750 Test Loss: 0.527 Test Acc: 0.750
Validation loss decreased (-0.749995 --> -0.749995).  Saving model ...
Epoch: 13 cost time: 1.0988945960998535
Epoch: 13, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
Validation loss decreased (-0.749995 --> -0.783328).  Saving model ...
Epoch: 14 cost time: 0.9124929904937744
Epoch: 14, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.476 Vali Acc: 0.794 Test Loss: 0.476 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 15 cost time: 0.9301731586456299
Epoch: 15, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.472 Vali Acc: 0.767 Test Loss: 0.472 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.018164873123169
Epoch: 16, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.437 Vali Acc: 0.800 Test Loss: 0.437 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 17 cost time: 0.8931465148925781
Epoch: 17, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.421 Vali Acc: 0.794 Test Loss: 0.421 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9369823932647705
Epoch: 18, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.410 Vali Acc: 0.800 Test Loss: 0.410 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 1.0947344303131104
Epoch: 19, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.406 Vali Acc: 0.789 Test Loss: 0.406 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9087228775024414
Epoch: 20, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.405 Vali Acc: 0.789 Test Loss: 0.405 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.077432632446289
Epoch: 21, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.387 Vali Acc: 0.800 Test Loss: 0.387 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 22 cost time: 1.086308240890503
Epoch: 22, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.381 Vali Acc: 0.811 Test Loss: 0.381 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 23 cost time: 1.0815634727478027
Epoch: 23, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.372 Vali Acc: 0.817 Test Loss: 0.372 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 24 cost time: 1.046097993850708
Epoch: 24, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.370 Vali Acc: 0.806 Test Loss: 0.370 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0709915161132812
Epoch: 25, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.365 Vali Acc: 0.817 Test Loss: 0.365 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 26 cost time: 1.1005418300628662
Epoch: 26, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 27 cost time: 1.1301028728485107
Epoch: 27, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.341 Vali Acc: 0.856 Test Loss: 0.341 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 28 cost time: 1.1977365016937256
Epoch: 28, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0611889362335205
Epoch: 29, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.325 Vali Acc: 0.833 Test Loss: 0.325 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1480693817138672
Epoch: 30, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.332 Vali Acc: 0.806 Test Loss: 0.332 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.006516456604004
Epoch: 31, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.334 Vali Acc: 0.828 Test Loss: 0.334 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.066326379776001
Epoch: 32, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.016120433807373
Epoch: 33, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.322 Vali Acc: 0.822 Test Loss: 0.322 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0996170043945312
Epoch: 34, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0486235618591309
Epoch: 35, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 36 cost time: 0.909623384475708
Epoch: 36, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 37 cost time: 0.9448494911193848
Epoch: 37, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 38 cost time: 0.892162561416626
Epoch: 38, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8971891403198242
Epoch: 39, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 40 cost time: 1.0629608631134033
Epoch: 40, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 41 cost time: 1.056981086730957
Epoch: 41, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9998965263366699
Epoch: 42, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0551331043243408
Epoch: 43, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.014425277709961
Epoch: 44, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0612225532531738
Epoch: 45, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 46 cost time: 0.9500865936279297
Epoch: 46, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0078420639038086
Epoch: 47, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.995110273361206
Epoch: 48, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9897656440734863
Epoch: 49, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1957740783691406
Epoch: 50, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.1425576210021973
Epoch: 51, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.1420190334320068
Epoch: 52, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 53 cost time: 1.0411994457244873
Epoch: 53, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9606523513793945
Epoch: 54, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 55 cost time: 0.9911816120147705
Epoch: 55, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0102968215942383
Epoch: 56, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.0759117603302002
Epoch: 57, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.0102221965789795
Epoch: 58, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.084075927734375
Epoch: 59, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.0269999504089355
Epoch: 60, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 61 cost time: 0.9912815093994141
Epoch: 61, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9602594375610352
Epoch: 62, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 63 cost time: 1.0700325965881348
Epoch: 63, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 64 cost time: 1.076746940612793
Epoch: 64, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.14589262008667
Epoch: 65, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.0508286952972412
Epoch: 66, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.0700466632843018
Epoch: 67, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.9755470752716064
Epoch: 68, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.976146936416626
Epoch: 69, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.96356201171875
Epoch: 70, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.0202114582061768
Epoch: 71, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.1143169403076172
Epoch: 72, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.1747214794158936
Epoch: 73, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 81718
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.916440963745117
Epoch: 1, Steps: 12 | Train Loss: 1.879 Vali Loss: 1.737 Vali Acc: 0.239 Test Loss: 1.737 Test Acc: 0.239
Validation loss decreased (inf --> -0.238872).  Saving model ...
Epoch: 2 cost time: 0.9138619899749756
Epoch: 2, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.549 Vali Acc: 0.467 Test Loss: 1.549 Test Acc: 0.467
Validation loss decreased (-0.238872 --> -0.466651).  Saving model ...
Epoch: 3 cost time: 0.9435913562774658
Epoch: 3, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.337 Vali Acc: 0.600 Test Loss: 1.337 Test Acc: 0.600
Validation loss decreased (-0.466651 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.9716954231262207
Epoch: 4, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.137 Vali Acc: 0.722 Test Loss: 1.137 Test Acc: 0.722
Validation loss decreased (-0.599987 --> -0.722211).  Saving model ...
Epoch: 5 cost time: 1.0481483936309814
Epoch: 5, Steps: 12 | Train Loss: 1.049 Vali Loss: 0.974 Vali Acc: 0.717 Test Loss: 0.974 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.119664192199707
Epoch: 6, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.836 Vali Acc: 0.706 Test Loss: 0.836 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9938340187072754
Epoch: 7, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.734 Vali Acc: 0.717 Test Loss: 0.734 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0392262935638428
Epoch: 8, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.672 Vali Acc: 0.728 Test Loss: 0.672 Test Acc: 0.728
Validation loss decreased (-0.722211 --> -0.727771).  Saving model ...
Epoch: 9 cost time: 0.9277369976043701
Epoch: 9, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.620 Vali Acc: 0.733 Test Loss: 0.620 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733327).  Saving model ...
Epoch: 10 cost time: 1.0665533542633057
Epoch: 10, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.589 Vali Acc: 0.756 Test Loss: 0.589 Test Acc: 0.756
Validation loss decreased (-0.733327 --> -0.755550).  Saving model ...
Epoch: 11 cost time: 0.8944849967956543
Epoch: 11, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.549 Vali Acc: 0.761 Test Loss: 0.549 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 12 cost time: 0.9714152812957764
Epoch: 12, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.526 Vali Acc: 0.761 Test Loss: 0.526 Test Acc: 0.761
Validation loss decreased (-0.761106 --> -0.761106).  Saving model ...
Epoch: 13 cost time: 0.9799203872680664
Epoch: 13, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783328).  Saving model ...
Epoch: 14 cost time: 0.9216132164001465
Epoch: 14, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.477 Vali Acc: 0.783 Test Loss: 0.477 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 15 cost time: 0.9717957973480225
Epoch: 15, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.472 Vali Acc: 0.778 Test Loss: 0.472 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9459223747253418
Epoch: 16, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.437 Vali Acc: 0.789 Test Loss: 0.437 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 17 cost time: 0.9544544219970703
Epoch: 17, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.422 Vali Acc: 0.800 Test Loss: 0.422 Test Acc: 0.800
Validation loss decreased (-0.788885 --> -0.799996).  Saving model ...
Epoch: 18 cost time: 1.0181379318237305
Epoch: 18, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.412 Vali Acc: 0.828 Test Loss: 0.412 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 1.0914757251739502
Epoch: 19, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.408 Vali Acc: 0.817 Test Loss: 0.408 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1050453186035156
Epoch: 20, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.406 Vali Acc: 0.806 Test Loss: 0.406 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0465972423553467
Epoch: 21, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.390 Vali Acc: 0.817 Test Loss: 0.390 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1343140602111816
Epoch: 22, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.383 Vali Acc: 0.817 Test Loss: 0.383 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.970038652420044
Epoch: 23, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.372 Vali Acc: 0.811 Test Loss: 0.372 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9417634010314941
Epoch: 24, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.372 Vali Acc: 0.811 Test Loss: 0.372 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8066656589508057
Epoch: 25, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9844419956207275
Epoch: 26, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.350 Vali Acc: 0.833 Test Loss: 0.350 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 27 cost time: 1.0859107971191406
Epoch: 27, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.340 Vali Acc: 0.839 Test Loss: 0.340 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 28 cost time: 0.9331624507904053
Epoch: 28, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.336 Vali Acc: 0.828 Test Loss: 0.336 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0599408149719238
Epoch: 29, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.329 Vali Acc: 0.828 Test Loss: 0.329 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0769901275634766
Epoch: 30, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.336 Vali Acc: 0.817 Test Loss: 0.336 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0594913959503174
Epoch: 31, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.339 Vali Acc: 0.822 Test Loss: 0.339 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9696955680847168
Epoch: 32, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.323 Vali Acc: 0.839 Test Loss: 0.323 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 33 cost time: 1.1478281021118164
Epoch: 33, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.155367136001587
Epoch: 34, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 35 cost time: 1.0600852966308594
Epoch: 35, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 36 cost time: 1.0266265869140625
Epoch: 36, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.310 Vali Acc: 0.839 Test Loss: 0.310 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0106942653656006
Epoch: 37, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7928562164306641
Epoch: 38, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.315 Vali Acc: 0.828 Test Loss: 0.315 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0031461715698242
Epoch: 39, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.98740553855896
Epoch: 40, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 41 cost time: 1.143728494644165
Epoch: 41, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.007310390472412
Epoch: 42, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1370511054992676
Epoch: 43, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.026928186416626
Epoch: 44, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.049793004989624
Epoch: 45, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 46 cost time: 0.9265222549438477
Epoch: 46, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.294 Vali Acc: 0.856 Test Loss: 0.294 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.042959213256836
Epoch: 47, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9613122940063477
Epoch: 48, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.009582757949829
Epoch: 49, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 50 cost time: 0.9719412326812744
Epoch: 50, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 51 cost time: 1.023430585861206
Epoch: 51, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1394076347351074
Epoch: 52, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 53 cost time: 1.207707166671753
Epoch: 53, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9545514583587646
Epoch: 54, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.875208854675293
Epoch: 55, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9070982933044434
Epoch: 56, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.0519559383392334
Epoch: 57, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9875309467315674
Epoch: 58, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.0647149085998535
Epoch: 59, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.070000410079956
Epoch: 60, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.1069483757019043
Epoch: 61, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.0117580890655518
Epoch: 62, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 81718
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.135864734649658
Epoch: 1, Steps: 12 | Train Loss: 1.882 Vali Loss: 1.726 Vali Acc: 0.244 Test Loss: 1.726 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 1.0269150733947754
Epoch: 2, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.538 Vali Acc: 0.422 Test Loss: 1.538 Test Acc: 0.422
Validation loss decreased (-0.244427 --> -0.422207).  Saving model ...
Epoch: 3 cost time: 0.8863072395324707
Epoch: 3, Steps: 12 | Train Loss: 1.485 Vali Loss: 1.327 Vali Acc: 0.639 Test Loss: 1.327 Test Acc: 0.639
Validation loss decreased (-0.422207 --> -0.638876).  Saving model ...
Epoch: 4 cost time: 0.9882454872131348
Epoch: 4, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.128 Vali Acc: 0.728 Test Loss: 1.128 Test Acc: 0.728
Validation loss decreased (-0.638876 --> -0.727767).  Saving model ...
Epoch: 5 cost time: 1.0560822486877441
Epoch: 5, Steps: 12 | Train Loss: 1.056 Vali Loss: 0.963 Vali Acc: 0.733 Test Loss: 0.963 Test Acc: 0.733
Validation loss decreased (-0.727767 --> -0.733324).  Saving model ...
Epoch: 6 cost time: 0.8679835796356201
Epoch: 6, Steps: 12 | Train Loss: 0.881 Vali Loss: 0.825 Vali Acc: 0.700 Test Loss: 0.825 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0160958766937256
Epoch: 7, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.722 Vali Acc: 0.706 Test Loss: 0.722 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9586255550384521
Epoch: 8, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.660 Vali Acc: 0.733 Test Loss: 0.660 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 0.8642170429229736
Epoch: 9, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.609 Vali Acc: 0.750 Test Loss: 0.609 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 0.9076199531555176
Epoch: 10, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.576 Vali Acc: 0.750 Test Loss: 0.576 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 0.8744034767150879
Epoch: 11, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.538 Vali Acc: 0.772 Test Loss: 0.538 Test Acc: 0.772
Validation loss decreased (-0.749994 --> -0.772217).  Saving model ...
Epoch: 12 cost time: 1.0268888473510742
Epoch: 12, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.514 Vali Acc: 0.761 Test Loss: 0.514 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8741917610168457
Epoch: 13, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.491 Vali Acc: 0.794 Test Loss: 0.491 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794440).  Saving model ...
Epoch: 14 cost time: 1.0654006004333496
Epoch: 14, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.469 Vali Acc: 0.800 Test Loss: 0.469 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799995).  Saving model ...
Epoch: 15 cost time: 1.0708365440368652
Epoch: 15, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.464 Vali Acc: 0.778 Test Loss: 0.464 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.036982536315918
Epoch: 16, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.433 Vali Acc: 0.806 Test Loss: 0.433 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 1.083280086517334
Epoch: 17, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.415 Vali Acc: 0.806 Test Loss: 0.415 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805551).  Saving model ...
Epoch: 18 cost time: 1.0519037246704102
Epoch: 18, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.401 Vali Acc: 0.811 Test Loss: 0.401 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 19 cost time: 0.9599864482879639
Epoch: 19, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.397 Vali Acc: 0.811 Test Loss: 0.397 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 20 cost time: 1.0295724868774414
Epoch: 20, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.392 Vali Acc: 0.800 Test Loss: 0.392 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0556747913360596
Epoch: 21, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.380 Vali Acc: 0.822 Test Loss: 0.380 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 22 cost time: 0.9672133922576904
Epoch: 22, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.375 Vali Acc: 0.806 Test Loss: 0.375 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9831843376159668
Epoch: 23, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.026848554611206
Epoch: 24, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.366 Vali Acc: 0.817 Test Loss: 0.366 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9105851650238037
Epoch: 25, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.357 Vali Acc: 0.828 Test Loss: 0.357 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 26 cost time: 0.7826323509216309
Epoch: 26, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 27 cost time: 0.925344705581665
Epoch: 27, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 28 cost time: 0.874215841293335
Epoch: 28, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 29 cost time: 0.9361772537231445
Epoch: 29, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.321 Vali Acc: 0.839 Test Loss: 0.321 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0146989822387695
Epoch: 30, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9398648738861084
Epoch: 31, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.330 Vali Acc: 0.844 Test Loss: 0.330 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8906264305114746
Epoch: 32, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 33 cost time: 0.9013350009918213
Epoch: 33, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9163596630096436
Epoch: 34, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.046891450881958
Epoch: 35, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 36 cost time: 0.9858312606811523
Epoch: 36, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.007767677307129
Epoch: 37, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.019026517868042
Epoch: 38, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.309 Vali Acc: 0.839 Test Loss: 0.309 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9882464408874512
Epoch: 39, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.294 Vali Acc: 0.856 Test Loss: 0.294 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0309350490570068
Epoch: 40, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 41 cost time: 0.9442088603973389
Epoch: 41, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0277953147888184
Epoch: 42, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0399847030639648
Epoch: 43, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9519257545471191
Epoch: 44, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 45 cost time: 0.8660156726837158
Epoch: 45, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 46 cost time: 0.9872915744781494
Epoch: 46, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.280 Vali Acc: 0.856 Test Loss: 0.280 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9593796730041504
Epoch: 47, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 48 cost time: 0.9677493572235107
Epoch: 48, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.275 Vali Acc: 0.856 Test Loss: 0.275 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8515238761901855
Epoch: 49, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.267 Vali Acc: 0.867 Test Loss: 0.267 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8600103855133057
Epoch: 50, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 51 cost time: 0.8747820854187012
Epoch: 51, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.294 Vali Acc: 0.856 Test Loss: 0.294 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9044375419616699
Epoch: 52, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 53 cost time: 0.8579790592193604
Epoch: 53, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.273 Vali Acc: 0.872 Test Loss: 0.273 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9011971950531006
Epoch: 54, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.248 Vali Acc: 0.894 Test Loss: 0.248 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9707581996917725
Epoch: 55, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.254 Vali Acc: 0.872 Test Loss: 0.254 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8943800926208496
Epoch: 56, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 57 cost time: 0.9666612148284912
Epoch: 57, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.252 Vali Acc: 0.883 Test Loss: 0.252 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0422313213348389
Epoch: 58, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9489631652832031
Epoch: 59, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8559224605560303
Epoch: 60, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 61 cost time: 0.8803973197937012
Epoch: 61, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.97322678565979
Epoch: 62, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.9856479167938232
Epoch: 63, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.072483777999878
Epoch: 64, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.241 Vali Acc: 0.883 Test Loss: 0.241 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.0078237056732178
Epoch: 65, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.1131913661956787
Epoch: 66, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.233 Vali Acc: 0.894 Test Loss: 0.233 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.9919266700744629
Epoch: 67, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.0111782550811768
Epoch: 68, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.9229466915130615
Epoch: 69, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.9438879489898682
Epoch: 70, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.255 Vali Acc: 0.883 Test Loss: 0.255 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 81718
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.341067314147949
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.714 Vali Acc: 0.289 Test Loss: 1.714 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 1.1155765056610107
Epoch: 2, Steps: 12 | Train Loss: 1.696 Vali Loss: 1.545 Vali Acc: 0.456 Test Loss: 1.545 Test Acc: 0.456
Validation loss decreased (-0.288872 --> -0.455540).  Saving model ...
Epoch: 3 cost time: 0.9598441123962402
Epoch: 3, Steps: 12 | Train Loss: 1.460 Vali Loss: 1.345 Vali Acc: 0.706 Test Loss: 1.345 Test Acc: 0.706
Validation loss decreased (-0.455540 --> -0.705542).  Saving model ...
Epoch: 4 cost time: 0.9986162185668945
Epoch: 4, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.153 Vali Acc: 0.756 Test Loss: 1.153 Test Acc: 0.756
Validation loss decreased (-0.705542 --> -0.755544).  Saving model ...
Epoch: 5 cost time: 1.0222363471984863
Epoch: 5, Steps: 12 | Train Loss: 1.063 Vali Loss: 0.991 Vali Acc: 0.733 Test Loss: 0.991 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.090550184249878
Epoch: 6, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.855 Vali Acc: 0.722 Test Loss: 0.855 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0346274375915527
Epoch: 7, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0615627765655518
Epoch: 8, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0430901050567627
Epoch: 9, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.633 Vali Acc: 0.733 Test Loss: 0.633 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9920353889465332
Epoch: 10, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.599 Vali Acc: 0.756 Test Loss: 0.599 Test Acc: 0.756
Validation loss decreased (-0.755544 --> -0.755550).  Saving model ...
Epoch: 11 cost time: 1.0175361633300781
Epoch: 11, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.557 Vali Acc: 0.778 Test Loss: 0.557 Test Acc: 0.778
Validation loss decreased (-0.755550 --> -0.777772).  Saving model ...
Epoch: 12 cost time: 1.0950586795806885
Epoch: 12, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.530 Vali Acc: 0.772 Test Loss: 0.530 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8968348503112793
Epoch: 13, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 14 cost time: 0.8702349662780762
Epoch: 14, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.489 Vali Acc: 0.783 Test Loss: 0.489 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0201809406280518
Epoch: 15, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.479 Vali Acc: 0.767 Test Loss: 0.479 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9136452674865723
Epoch: 16, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.450 Vali Acc: 0.811 Test Loss: 0.450 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811107).  Saving model ...
Epoch: 17 cost time: 0.9070861339569092
Epoch: 17, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.427 Vali Acc: 0.806 Test Loss: 0.427 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0416383743286133
Epoch: 18, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.416 Vali Acc: 0.811 Test Loss: 0.416 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 19 cost time: 0.9900703430175781
Epoch: 19, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.414 Vali Acc: 0.800 Test Loss: 0.414 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.036494255065918
Epoch: 20, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.406 Vali Acc: 0.800 Test Loss: 0.406 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1398272514343262
Epoch: 21, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.385 Vali Acc: 0.822 Test Loss: 0.385 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 22 cost time: 1.0560808181762695
Epoch: 22, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.374 Vali Acc: 0.817 Test Loss: 0.374 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1219043731689453
Epoch: 23, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.375 Vali Acc: 0.828 Test Loss: 0.375 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 24 cost time: 1.054288387298584
Epoch: 24, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.364 Vali Acc: 0.811 Test Loss: 0.364 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1125307083129883
Epoch: 25, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0359468460083008
Epoch: 26, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.351 Vali Acc: 0.844 Test Loss: 0.351 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 27 cost time: 0.9478476047515869
Epoch: 27, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.338 Vali Acc: 0.867 Test Loss: 0.338 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866663).  Saving model ...
Epoch: 28 cost time: 1.0940868854522705
Epoch: 28, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.94852614402771
Epoch: 29, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.914151668548584
Epoch: 30, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9530818462371826
Epoch: 31, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8990345001220703
Epoch: 32, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9653632640838623
Epoch: 33, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1900601387023926
Epoch: 34, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9731268882751465
Epoch: 35, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.994661808013916
Epoch: 36, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9693117141723633
Epoch: 37, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9427816867828369
Epoch: 38, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.296 Vali Acc: 0.856 Test Loss: 0.296 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0896649360656738
Epoch: 39, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 81718
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.295144557952881
Epoch: 1, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.731 Vali Acc: 0.289 Test Loss: 1.731 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 1.16361665725708
Epoch: 2, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.550 Vali Acc: 0.428 Test Loss: 1.550 Test Acc: 0.428
Validation loss decreased (-0.288872 --> -0.427762).  Saving model ...
Epoch: 3 cost time: 1.101914405822754
Epoch: 3, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.343 Vali Acc: 0.483 Test Loss: 1.343 Test Acc: 0.483
Validation loss decreased (-0.427762 --> -0.483320).  Saving model ...
Epoch: 4 cost time: 1.0032439231872559
Epoch: 4, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.148 Vali Acc: 0.561 Test Loss: 1.148 Test Acc: 0.561
Validation loss decreased (-0.483320 --> -0.561100).  Saving model ...
Epoch: 5 cost time: 0.9126121997833252
Epoch: 5, Steps: 12 | Train Loss: 1.029 Vali Loss: 0.989 Vali Acc: 0.667 Test Loss: 0.989 Test Acc: 0.667
Validation loss decreased (-0.561100 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 0.9950718879699707
Epoch: 6, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.871 Vali Acc: 0.683 Test Loss: 0.871 Test Acc: 0.683
Validation loss decreased (-0.666657 --> -0.683325).  Saving model ...
Epoch: 7 cost time: 0.9001891613006592
Epoch: 7, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.801 Vali Acc: 0.683 Test Loss: 0.801 Test Acc: 0.683
Validation loss decreased (-0.683325 --> -0.683325).  Saving model ...
Epoch: 8 cost time: 0.9938461780548096
Epoch: 8, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.723 Vali Acc: 0.700 Test Loss: 0.723 Test Acc: 0.700
Validation loss decreased (-0.683325 --> -0.699993).  Saving model ...
Epoch: 9 cost time: 1.0110397338867188
Epoch: 9, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.665 Vali Acc: 0.689 Test Loss: 0.665 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9836316108703613
Epoch: 10, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.642 Vali Acc: 0.711 Test Loss: 0.642 Test Acc: 0.711
Validation loss decreased (-0.699993 --> -0.711105).  Saving model ...
Epoch: 11 cost time: 0.9696090221405029
Epoch: 11, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.590 Vali Acc: 0.711 Test Loss: 0.590 Test Acc: 0.711
Validation loss decreased (-0.711105 --> -0.711105).  Saving model ...
Epoch: 12 cost time: 0.9549777507781982
Epoch: 12, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.542 Vali Acc: 0.750 Test Loss: 0.542 Test Acc: 0.750
Validation loss decreased (-0.711105 --> -0.749995).  Saving model ...
Epoch: 13 cost time: 1.0429272651672363
Epoch: 13, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.512 Vali Acc: 0.750 Test Loss: 0.512 Test Acc: 0.750
Validation loss decreased (-0.749995 --> -0.749995).  Saving model ...
Epoch: 14 cost time: 0.9786489009857178
Epoch: 14, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.491 Vali Acc: 0.761 Test Loss: 0.491 Test Acc: 0.761
Validation loss decreased (-0.749995 --> -0.761106).  Saving model ...
Epoch: 15 cost time: 1.0081989765167236
Epoch: 15, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.466 Vali Acc: 0.761 Test Loss: 0.466 Test Acc: 0.761
Validation loss decreased (-0.761106 --> -0.761106).  Saving model ...
Epoch: 16 cost time: 0.9256319999694824
Epoch: 16, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.451 Vali Acc: 0.778 Test Loss: 0.451 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777773).  Saving model ...
Epoch: 17 cost time: 0.9382264614105225
Epoch: 17, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.443 Vali Acc: 0.778 Test Loss: 0.443 Test Acc: 0.778
Validation loss decreased (-0.777773 --> -0.777773).  Saving model ...
Epoch: 18 cost time: 0.9056921005249023
Epoch: 18, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.437 Vali Acc: 0.750 Test Loss: 0.437 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0266218185424805
Epoch: 19, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.417 Vali Acc: 0.789 Test Loss: 0.417 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788885).  Saving model ...
Epoch: 20 cost time: 0.9804463386535645
Epoch: 20, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.411 Vali Acc: 0.789 Test Loss: 0.411 Test Acc: 0.789
Validation loss decreased (-0.788885 --> -0.788885).  Saving model ...
Epoch: 21 cost time: 0.9955973625183105
Epoch: 21, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.397 Vali Acc: 0.806 Test Loss: 0.397 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805552).  Saving model ...
Epoch: 22 cost time: 1.0129821300506592
Epoch: 22, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.383 Vali Acc: 0.844 Test Loss: 0.383 Test Acc: 0.844
Validation loss decreased (-0.805552 --> -0.844441).  Saving model ...
Epoch: 23 cost time: 0.9568495750427246
Epoch: 23, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.377 Vali Acc: 0.839 Test Loss: 0.377 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0579633712768555
Epoch: 24, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.369 Vali Acc: 0.822 Test Loss: 0.369 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9876551628112793
Epoch: 25, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.364 Vali Acc: 0.811 Test Loss: 0.364 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9363481998443604
Epoch: 26, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.365 Vali Acc: 0.817 Test Loss: 0.365 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8736765384674072
Epoch: 27, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.350 Vali Acc: 0.828 Test Loss: 0.350 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9762117862701416
Epoch: 28, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.357 Vali Acc: 0.822 Test Loss: 0.357 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9035611152648926
Epoch: 29, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9375996589660645
Epoch: 30, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 31 cost time: 1.0309727191925049
Epoch: 31, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.327 Vali Acc: 0.828 Test Loss: 0.327 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8761415481567383
Epoch: 32, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.996981143951416
Epoch: 33, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9444177150726318
Epoch: 34, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0344183444976807
Epoch: 35, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 36 cost time: 1.0434539318084717
Epoch: 36, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9739153385162354
Epoch: 37, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9918663501739502
Epoch: 38, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.308 Vali Acc: 0.839 Test Loss: 0.308 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9806582927703857
Epoch: 39, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9979753494262695
Epoch: 40, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 41 cost time: 0.9337387084960938
Epoch: 41, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0209240913391113
Epoch: 42, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 43 cost time: 0.9876589775085449
Epoch: 43, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9242470264434814
Epoch: 44, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9888579845428467
Epoch: 45, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0407402515411377
Epoch: 46, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.041837453842163
Epoch: 47, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.031421184539795
Epoch: 48, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0491609573364258
Epoch: 49, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.9946930408477783
Epoch: 50, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.018148422241211
Epoch: 51, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.289 Vali Acc: 0.850 Test Loss: 0.289 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.9294970035552979
Epoch: 52, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 48950
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2460598945617676
Epoch: 1, Steps: 12 | Train Loss: 1.872 Vali Loss: 1.738 Vali Acc: 0.278 Test Loss: 1.738 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 0.9938349723815918
Epoch: 2, Steps: 12 | Train Loss: 1.672 Vali Loss: 1.555 Vali Acc: 0.406 Test Loss: 1.555 Test Acc: 0.406
Validation loss decreased (-0.277760 --> -0.405540).  Saving model ...
Epoch: 3 cost time: 0.9444084167480469
Epoch: 3, Steps: 12 | Train Loss: 1.429 Vali Loss: 1.350 Vali Acc: 0.467 Test Loss: 1.350 Test Acc: 0.467
Validation loss decreased (-0.405540 --> -0.466653).  Saving model ...
Epoch: 4 cost time: 0.9784917831420898
Epoch: 4, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
Validation loss decreased (-0.466653 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.9723153114318848
Epoch: 5, Steps: 12 | Train Loss: 1.031 Vali Loss: 0.993 Vali Acc: 0.644 Test Loss: 0.993 Test Acc: 0.644
Validation loss decreased (-0.549988 --> -0.644435).  Saving model ...
Epoch: 6 cost time: 1.115034580230713
Epoch: 6, Steps: 12 | Train Loss: 0.866 Vali Loss: 0.872 Vali Acc: 0.683 Test Loss: 0.872 Test Acc: 0.683
Validation loss decreased (-0.644435 --> -0.683325).  Saving model ...
Epoch: 7 cost time: 1.0473663806915283
Epoch: 7, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.803 Vali Acc: 0.683 Test Loss: 0.803 Test Acc: 0.683
Validation loss decreased (-0.683325 --> -0.683325).  Saving model ...
Epoch: 8 cost time: 1.2378737926483154
Epoch: 8, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.719 Vali Acc: 0.700 Test Loss: 0.719 Test Acc: 0.700
Validation loss decreased (-0.683325 --> -0.699993).  Saving model ...
Epoch: 9 cost time: 1.0801491737365723
Epoch: 9, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.660 Vali Acc: 0.700 Test Loss: 0.660 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699993).  Saving model ...
Epoch: 10 cost time: 1.352630376815796
Epoch: 10, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.639 Vali Acc: 0.711 Test Loss: 0.639 Test Acc: 0.711
Validation loss decreased (-0.699993 --> -0.711105).  Saving model ...
Epoch: 11 cost time: 1.2178888320922852
Epoch: 11, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.589 Vali Acc: 0.717 Test Loss: 0.589 Test Acc: 0.717
Validation loss decreased (-0.711105 --> -0.716661).  Saving model ...
Epoch: 12 cost time: 1.2023520469665527
Epoch: 12, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.538 Vali Acc: 0.761 Test Loss: 0.538 Test Acc: 0.761
Validation loss decreased (-0.716661 --> -0.761106).  Saving model ...
Epoch: 13 cost time: 1.0876507759094238
Epoch: 13, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.508 Vali Acc: 0.756 Test Loss: 0.508 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0885679721832275
Epoch: 14, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.487 Vali Acc: 0.761 Test Loss: 0.487 Test Acc: 0.761
Validation loss decreased (-0.761106 --> -0.761106).  Saving model ...
Epoch: 15 cost time: 1.3728809356689453
Epoch: 15, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.460 Vali Acc: 0.761 Test Loss: 0.460 Test Acc: 0.761
Validation loss decreased (-0.761106 --> -0.761107).  Saving model ...
Epoch: 16 cost time: 1.006716251373291
Epoch: 16, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.446 Vali Acc: 0.778 Test Loss: 0.446 Test Acc: 0.778
Validation loss decreased (-0.761107 --> -0.777773).  Saving model ...
Epoch: 17 cost time: 1.115734338760376
Epoch: 17, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.439 Vali Acc: 0.767 Test Loss: 0.439 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.198693037033081
Epoch: 18, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.432 Vali Acc: 0.756 Test Loss: 0.432 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.139585018157959
Epoch: 19, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.410 Vali Acc: 0.789 Test Loss: 0.410 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788885).  Saving model ...
Epoch: 20 cost time: 1.0400121212005615
Epoch: 20, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.403 Vali Acc: 0.794 Test Loss: 0.403 Test Acc: 0.794
Validation loss decreased (-0.788885 --> -0.794440).  Saving model ...
Epoch: 21 cost time: 1.023167371749878
Epoch: 21, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.387 Vali Acc: 0.822 Test Loss: 0.387 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822218).  Saving model ...
Epoch: 22 cost time: 1.0293214321136475
Epoch: 22, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.374 Vali Acc: 0.839 Test Loss: 0.374 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 23 cost time: 0.9795653820037842
Epoch: 23, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.370 Vali Acc: 0.833 Test Loss: 0.370 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0078182220458984
Epoch: 24, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.365 Vali Acc: 0.822 Test Loss: 0.365 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1496758460998535
Epoch: 25, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0813884735107422
Epoch: 26, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.006183385848999
Epoch: 27, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0093321800231934
Epoch: 28, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0035743713378906
Epoch: 29, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.332 Vali Acc: 0.833 Test Loss: 0.332 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0786731243133545
Epoch: 30, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 31 cost time: 1.1182715892791748
Epoch: 31, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.321 Vali Acc: 0.828 Test Loss: 0.321 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9942488670349121
Epoch: 32, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.320 Vali Acc: 0.856 Test Loss: 0.320 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 33 cost time: 1.0212674140930176
Epoch: 33, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.311 Vali Acc: 0.839 Test Loss: 0.311 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1083273887634277
Epoch: 34, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.311 Vali Acc: 0.850 Test Loss: 0.311 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0225636959075928
Epoch: 35, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 36 cost time: 0.9831578731536865
Epoch: 36, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8710906505584717
Epoch: 37, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 38 cost time: 1.0639526844024658
Epoch: 38, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.301 Vali Acc: 0.839 Test Loss: 0.301 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.009021282196045
Epoch: 39, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 40 cost time: 1.1060614585876465
Epoch: 40, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 41 cost time: 0.9834365844726562
Epoch: 41, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9399654865264893
Epoch: 42, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 43 cost time: 1.0031671524047852
Epoch: 43, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9335713386535645
Epoch: 44, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1068243980407715
Epoch: 45, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0031194686889648
Epoch: 46, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 47 cost time: 1.1037402153015137
Epoch: 47, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9465360641479492
Epoch: 48, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0592775344848633
Epoch: 49, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2475483417510986
Epoch: 50, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.974755048751831
Epoch: 51, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9837279319763184
Epoch: 52, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.261 Vali Acc: 0.872 Test Loss: 0.261 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9165194034576416
Epoch: 53, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.081636905670166
Epoch: 54, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.268 Vali Acc: 0.872 Test Loss: 0.268 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.115846872329712
Epoch: 55, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.0458619594573975
Epoch: 56, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 48950
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.309202194213867
Epoch: 1, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.733 Vali Acc: 0.283 Test Loss: 1.733 Test Acc: 0.283
Validation loss decreased (inf --> -0.283316).  Saving model ...
Epoch: 2 cost time: 1.0013110637664795
Epoch: 2, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.555 Vali Acc: 0.417 Test Loss: 1.555 Test Acc: 0.417
Validation loss decreased (-0.283316 --> -0.416651).  Saving model ...
Epoch: 3 cost time: 0.8901958465576172
Epoch: 3, Steps: 12 | Train Loss: 1.427 Vali Loss: 1.348 Vali Acc: 0.483 Test Loss: 1.348 Test Acc: 0.483
Validation loss decreased (-0.416651 --> -0.483320).  Saving model ...
Epoch: 4 cost time: 1.126209020614624
Epoch: 4, Steps: 12 | Train Loss: 1.241 Vali Loss: 1.155 Vali Acc: 0.556 Test Loss: 1.155 Test Acc: 0.556
Validation loss decreased (-0.483320 --> -0.555544).  Saving model ...
Epoch: 5 cost time: 1.0476484298706055
Epoch: 5, Steps: 12 | Train Loss: 1.031 Vali Loss: 0.995 Vali Acc: 0.661 Test Loss: 0.995 Test Acc: 0.661
Validation loss decreased (-0.555544 --> -0.661101).  Saving model ...
Epoch: 6 cost time: 1.0335874557495117
Epoch: 6, Steps: 12 | Train Loss: 0.866 Vali Loss: 0.871 Vali Acc: 0.689 Test Loss: 0.871 Test Acc: 0.689
Validation loss decreased (-0.661101 --> -0.688880).  Saving model ...
Epoch: 7 cost time: 1.0415294170379639
Epoch: 7, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.793 Vali Acc: 0.700 Test Loss: 0.793 Test Acc: 0.700
Validation loss decreased (-0.688880 --> -0.699992).  Saving model ...
Epoch: 8 cost time: 0.9495217800140381
Epoch: 8, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.713 Vali Acc: 0.706 Test Loss: 0.713 Test Acc: 0.706
Validation loss decreased (-0.699992 --> -0.705548).  Saving model ...
Epoch: 9 cost time: 1.0278122425079346
Epoch: 9, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.656 Vali Acc: 0.711 Test Loss: 0.656 Test Acc: 0.711
Validation loss decreased (-0.705548 --> -0.711105).  Saving model ...
Epoch: 10 cost time: 1.000739336013794
Epoch: 10, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.631 Vali Acc: 0.722 Test Loss: 0.631 Test Acc: 0.722
Validation loss decreased (-0.711105 --> -0.722216).  Saving model ...
Epoch: 11 cost time: 1.117072582244873
Epoch: 11, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.578 Vali Acc: 0.750 Test Loss: 0.578 Test Acc: 0.750
Validation loss decreased (-0.722216 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 0.9395372867584229
Epoch: 12, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.523 Vali Acc: 0.778 Test Loss: 0.523 Test Acc: 0.778
Validation loss decreased (-0.749994 --> -0.777773).  Saving model ...
Epoch: 13 cost time: 0.9872176647186279
Epoch: 13, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.492 Vali Acc: 0.767 Test Loss: 0.492 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9278290271759033
Epoch: 14, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.472 Vali Acc: 0.750 Test Loss: 0.472 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9634034633636475
Epoch: 15, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.448 Vali Acc: 0.794 Test Loss: 0.448 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 16 cost time: 0.9096713066101074
Epoch: 16, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.434 Vali Acc: 0.789 Test Loss: 0.434 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9235587120056152
Epoch: 17, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.427 Vali Acc: 0.789 Test Loss: 0.427 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8715035915374756
Epoch: 18, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.422 Vali Acc: 0.767 Test Loss: 0.422 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9473371505737305
Epoch: 19, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.400 Vali Acc: 0.789 Test Loss: 0.400 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8550944328308105
Epoch: 20, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.396 Vali Acc: 0.806 Test Loss: 0.396 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 21 cost time: 1.0115623474121094
Epoch: 21, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.380 Vali Acc: 0.800 Test Loss: 0.380 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0621538162231445
Epoch: 22, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822219).  Saving model ...
Epoch: 23 cost time: 0.9726121425628662
Epoch: 23, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.359 Vali Acc: 0.828 Test Loss: 0.359 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 24 cost time: 0.98372483253479
Epoch: 24, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.350 Vali Acc: 0.828 Test Loss: 0.350 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 25 cost time: 0.912499189376831
Epoch: 25, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.349 Vali Acc: 0.806 Test Loss: 0.349 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9431538581848145
Epoch: 26, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.344 Vali Acc: 0.817 Test Loss: 0.344 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.153498888015747
Epoch: 27, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.336 Vali Acc: 0.828 Test Loss: 0.336 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 28 cost time: 1.0347838401794434
Epoch: 28, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.334 Vali Acc: 0.822 Test Loss: 0.334 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1039321422576904
Epoch: 29, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 30 cost time: 1.0849106311798096
Epoch: 30, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 31 cost time: 0.9636099338531494
Epoch: 31, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.317 Vali Acc: 0.828 Test Loss: 0.317 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0356216430664062
Epoch: 32, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.311 Vali Acc: 0.839 Test Loss: 0.311 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0986299514770508
Epoch: 33, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.308 Vali Acc: 0.833 Test Loss: 0.308 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9602773189544678
Epoch: 34, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.306 Vali Acc: 0.833 Test Loss: 0.306 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0290732383728027
Epoch: 35, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.296 Vali Acc: 0.850 Test Loss: 0.296 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 36 cost time: 0.8689229488372803
Epoch: 36, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8706753253936768
Epoch: 37, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.295 Vali Acc: 0.844 Test Loss: 0.295 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9252777099609375
Epoch: 38, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 39 cost time: 0.8915750980377197
Epoch: 39, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 40 cost time: 0.8864614963531494
Epoch: 40, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 41 cost time: 0.9676182270050049
Epoch: 41, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.284 Vali Acc: 0.850 Test Loss: 0.284 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9890508651733398
Epoch: 42, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 43 cost time: 1.0563740730285645
Epoch: 43, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 44 cost time: 0.9099647998809814
Epoch: 44, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.276 Vali Acc: 0.867 Test Loss: 0.276 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8968338966369629
Epoch: 45, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9014568328857422
Epoch: 46, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.278 Vali Acc: 0.850 Test Loss: 0.278 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9624073505401611
Epoch: 47, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.284 Vali Acc: 0.850 Test Loss: 0.284 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9114294052124023
Epoch: 48, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.267 Vali Acc: 0.867 Test Loss: 0.267 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.0668773651123047
Epoch: 49, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 50 cost time: 1.0456993579864502
Epoch: 50, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 51 cost time: 1.084441900253296
Epoch: 51, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.087273120880127
Epoch: 52, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.255 Vali Acc: 0.878 Test Loss: 0.255 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 53 cost time: 1.1144366264343262
Epoch: 53, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.254 Vali Acc: 0.883 Test Loss: 0.254 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 54 cost time: 1.1650168895721436
Epoch: 54, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.264 Vali Acc: 0.872 Test Loss: 0.264 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9254961013793945
Epoch: 55, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.278 Vali Acc: 0.867 Test Loss: 0.278 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.1378483772277832
Epoch: 56, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.069282054901123
Epoch: 57, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.9696149826049805
Epoch: 58, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.1782822608947754
Epoch: 59, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.261 Vali Acc: 0.872 Test Loss: 0.261 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.115401029586792
Epoch: 60, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.254 Vali Acc: 0.878 Test Loss: 0.254 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.8883118629455566
Epoch: 61, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.258 Vali Acc: 0.872 Test Loss: 0.258 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.9367208480834961
Epoch: 62, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.259 Vali Acc: 0.867 Test Loss: 0.259 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.9706764221191406
Epoch: 63, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.263 Vali Acc: 0.872 Test Loss: 0.263 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 48950
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9722743034362793
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.759 Vali Acc: 0.250 Test Loss: 1.759 Test Acc: 0.250
Validation loss decreased (inf --> -0.249982).  Saving model ...
Epoch: 2 cost time: 0.9097955226898193
Epoch: 2, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.594 Vali Acc: 0.361 Test Loss: 1.594 Test Acc: 0.361
Validation loss decreased (-0.249982 --> -0.361095).  Saving model ...
Epoch: 3 cost time: 0.9539687633514404
Epoch: 3, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.398 Vali Acc: 0.478 Test Loss: 1.398 Test Acc: 0.478
Validation loss decreased (-0.361095 --> -0.477764).  Saving model ...
Epoch: 4 cost time: 1.0509750843048096
Epoch: 4, Steps: 12 | Train Loss: 1.263 Vali Loss: 1.200 Vali Acc: 0.600 Test Loss: 1.200 Test Acc: 0.600
Validation loss decreased (-0.477764 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 1.041548490524292
Epoch: 5, Steps: 12 | Train Loss: 1.069 Vali Loss: 1.030 Vali Acc: 0.622 Test Loss: 1.030 Test Acc: 0.622
Validation loss decreased (-0.599988 --> -0.622212).  Saving model ...
Epoch: 6 cost time: 0.9910562038421631
Epoch: 6, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.898 Vali Acc: 0.650 Test Loss: 0.898 Test Acc: 0.650
Validation loss decreased (-0.622212 --> -0.649991).  Saving model ...
Epoch: 7 cost time: 0.8389382362365723
Epoch: 7, Steps: 12 | Train Loss: 0.778 Vali Loss: 0.814 Vali Acc: 0.678 Test Loss: 0.814 Test Acc: 0.678
Validation loss decreased (-0.649991 --> -0.677770).  Saving model ...
Epoch: 8 cost time: 0.8665595054626465
Epoch: 8, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.734 Vali Acc: 0.694 Test Loss: 0.734 Test Acc: 0.694
Validation loss decreased (-0.677770 --> -0.694437).  Saving model ...
Epoch: 9 cost time: 1.0094273090362549
Epoch: 9, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.673 Vali Acc: 0.694 Test Loss: 0.673 Test Acc: 0.694
Validation loss decreased (-0.694437 --> -0.694438).  Saving model ...
Epoch: 10 cost time: 1.0563864707946777
Epoch: 10, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.640 Vali Acc: 0.711 Test Loss: 0.640 Test Acc: 0.711
Validation loss decreased (-0.694438 --> -0.711105).  Saving model ...
Epoch: 11 cost time: 0.9905948638916016
Epoch: 11, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.592 Vali Acc: 0.733 Test Loss: 0.592 Test Acc: 0.733
Validation loss decreased (-0.711105 --> -0.733327).  Saving model ...
Epoch: 12 cost time: 0.9892618656158447
Epoch: 12, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.546 Vali Acc: 0.778 Test Loss: 0.546 Test Acc: 0.778
Validation loss decreased (-0.733327 --> -0.777772).  Saving model ...
Epoch: 13 cost time: 0.9045231342315674
Epoch: 13, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.512 Vali Acc: 0.739 Test Loss: 0.512 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.950603723526001
Epoch: 14, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.490 Vali Acc: 0.767 Test Loss: 0.490 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9331676959991455
Epoch: 15, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.470 Vali Acc: 0.761 Test Loss: 0.470 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9719078540802002
Epoch: 16, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.455 Vali Acc: 0.778 Test Loss: 0.455 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777773).  Saving model ...
Epoch: 17 cost time: 1.0254168510437012
Epoch: 17, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.443 Vali Acc: 0.761 Test Loss: 0.443 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0830113887786865
Epoch: 18, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.431 Vali Acc: 0.761 Test Loss: 0.431 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9943387508392334
Epoch: 19, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.416 Vali Acc: 0.761 Test Loss: 0.416 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0714006423950195
Epoch: 20, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.407 Vali Acc: 0.789 Test Loss: 0.407 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788885).  Saving model ...
Epoch: 21 cost time: 0.9993124008178711
Epoch: 21, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.385 Vali Acc: 0.811 Test Loss: 0.385 Test Acc: 0.811
Validation loss decreased (-0.788885 --> -0.811107).  Saving model ...
Epoch: 22 cost time: 0.9640686511993408
Epoch: 22, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.369 Vali Acc: 0.844 Test Loss: 0.369 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844441).  Saving model ...
Epoch: 23 cost time: 1.0098371505737305
Epoch: 23, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9718725681304932
Epoch: 24, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9723851680755615
Epoch: 25, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.357 Vali Acc: 0.806 Test Loss: 0.357 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0420420169830322
Epoch: 26, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.351 Vali Acc: 0.806 Test Loss: 0.351 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9652159214019775
Epoch: 27, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9352116584777832
Epoch: 28, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.336 Vali Acc: 0.811 Test Loss: 0.336 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0129868984222412
Epoch: 29, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.323 Vali Acc: 0.828 Test Loss: 0.323 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0444469451904297
Epoch: 30, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 31 cost time: 0.9592430591583252
Epoch: 31, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.315 Vali Acc: 0.844 Test Loss: 0.315 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.048407793045044
Epoch: 32, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.309 Vali Acc: 0.844 Test Loss: 0.309 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9050717353820801
Epoch: 33, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0754966735839844
Epoch: 34, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0185034275054932
Epoch: 35, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 36 cost time: 0.9376089572906494
Epoch: 36, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.307 Vali Acc: 0.828 Test Loss: 0.307 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9322681427001953
Epoch: 37, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9104745388031006
Epoch: 38, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 39 cost time: 1.0286636352539062
Epoch: 39, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.304 Vali Acc: 0.828 Test Loss: 0.304 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9842901229858398
Epoch: 40, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 41 cost time: 1.0192065238952637
Epoch: 41, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9492378234863281
Epoch: 42, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0079925060272217
Epoch: 43, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.292 Vali Acc: 0.822 Test Loss: 0.292 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0375969409942627
Epoch: 44, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.279 Vali Acc: 0.867 Test Loss: 0.279 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0945184230804443
Epoch: 45, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.284 Vali Acc: 0.850 Test Loss: 0.284 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9578771591186523
Epoch: 46, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.268 Vali Acc: 0.856 Test Loss: 0.268 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9982001781463623
Epoch: 47, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.285 Vali Acc: 0.856 Test Loss: 0.285 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0313129425048828
Epoch: 48, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.262 Vali Acc: 0.856 Test Loss: 0.262 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.054922103881836
Epoch: 49, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.255 Vali Acc: 0.872 Test Loss: 0.255 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872220).  Saving model ...
Epoch: 50 cost time: 1.0077245235443115
Epoch: 50, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.263 Vali Acc: 0.867 Test Loss: 0.263 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9137306213378906
Epoch: 51, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.273 Vali Acc: 0.850 Test Loss: 0.273 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0471534729003906
Epoch: 52, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.872220 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 1.0202727317810059
Epoch: 53, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.287 Vali Acc: 0.833 Test Loss: 0.287 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8724820613861084
Epoch: 54, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 55 cost time: 0.9356663227081299
Epoch: 55, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.294 Vali Acc: 0.833 Test Loss: 0.294 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0187747478485107
Epoch: 56, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.253 Vali Acc: 0.894 Test Loss: 0.253 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.0118095874786377
Epoch: 57, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.296 Vali Acc: 0.828 Test Loss: 0.296 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.9144752025604248
Epoch: 58, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.248 Vali Acc: 0.883 Test Loss: 0.248 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.9847862720489502
Epoch: 59, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.276 Vali Acc: 0.856 Test Loss: 0.276 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.9408674240112305
Epoch: 60, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 61 cost time: 0.9863584041595459
Epoch: 61, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9413547515869141
Epoch: 62, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.9110956192016602
Epoch: 63, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.9695842266082764
Epoch: 64, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.105358362197876
Epoch: 65, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.0768249034881592
Epoch: 66, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.0289599895477295
Epoch: 67, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.0474369525909424
Epoch: 68, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.9534268379211426
Epoch: 69, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 1.0792994499206543
Epoch: 70, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 48950
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.261077642440796
Epoch: 1, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.590 Vali Acc: 0.411 Test Loss: 1.590 Test Acc: 0.411
Validation loss decreased (inf --> -0.411095).  Saving model ...
Epoch: 2 cost time: 0.854668140411377
Epoch: 2, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.426 Vali Acc: 0.522 Test Loss: 1.426 Test Acc: 0.522
Validation loss decreased (-0.411095 --> -0.522208).  Saving model ...
Epoch: 3 cost time: 0.9686911106109619
Epoch: 3, Steps: 12 | Train Loss: 1.373 Vali Loss: 1.244 Vali Acc: 0.594 Test Loss: 1.244 Test Acc: 0.594
Validation loss decreased (-0.522208 --> -0.594432).  Saving model ...
Epoch: 4 cost time: 0.8874225616455078
Epoch: 4, Steps: 12 | Train Loss: 1.196 Vali Loss: 1.066 Vali Acc: 0.689 Test Loss: 1.066 Test Acc: 0.689
Validation loss decreased (-0.594432 --> -0.688878).  Saving model ...
Epoch: 5 cost time: 0.890864372253418
Epoch: 5, Steps: 12 | Train Loss: 1.022 Vali Loss: 0.916 Vali Acc: 0.678 Test Loss: 0.916 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0864284038543701
Epoch: 6, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.802 Vali Acc: 0.672 Test Loss: 0.802 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9159812927246094
Epoch: 7, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.710 Vali Acc: 0.706 Test Loss: 0.710 Test Acc: 0.706
Validation loss decreased (-0.688878 --> -0.705548).  Saving model ...
Epoch: 8 cost time: 0.9669272899627686
Epoch: 8, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.641 Vali Acc: 0.706 Test Loss: 0.641 Test Acc: 0.706
Validation loss decreased (-0.705548 --> -0.705549).  Saving model ...
Epoch: 9 cost time: 0.9796178340911865
Epoch: 9, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.591 Vali Acc: 0.700 Test Loss: 0.591 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0366806983947754
Epoch: 10, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.559 Vali Acc: 0.733 Test Loss: 0.559 Test Acc: 0.733
Validation loss decreased (-0.705549 --> -0.733328).  Saving model ...
Epoch: 11 cost time: 1.0130424499511719
Epoch: 11, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.530 Vali Acc: 0.739 Test Loss: 0.530 Test Acc: 0.739
Validation loss decreased (-0.733328 --> -0.738884).  Saving model ...
Epoch: 12 cost time: 1.0207688808441162
Epoch: 12, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.500 Vali Acc: 0.739 Test Loss: 0.500 Test Acc: 0.739
Validation loss decreased (-0.738884 --> -0.738884).  Saving model ...
Epoch: 13 cost time: 1.2216601371765137
Epoch: 13, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.479 Vali Acc: 0.750 Test Loss: 0.479 Test Acc: 0.750
Validation loss decreased (-0.738884 --> -0.749995).  Saving model ...
Epoch: 14 cost time: 1.0398359298706055
Epoch: 14, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.442 Vali Acc: 0.789 Test Loss: 0.442 Test Acc: 0.789
Validation loss decreased (-0.749995 --> -0.788884).  Saving model ...
Epoch: 15 cost time: 1.0765330791473389
Epoch: 15, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.420 Vali Acc: 0.794 Test Loss: 0.420 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 16 cost time: 1.0176081657409668
Epoch: 16, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.411 Vali Acc: 0.794 Test Loss: 0.411 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 17 cost time: 1.1408374309539795
Epoch: 17, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.408 Vali Acc: 0.783 Test Loss: 0.408 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9805793762207031
Epoch: 18, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.390 Vali Acc: 0.800 Test Loss: 0.390 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 1.0760726928710938
Epoch: 19, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 20 cost time: 1.1455698013305664
Epoch: 20, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.370 Vali Acc: 0.806 Test Loss: 0.370 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2950901985168457
Epoch: 21, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.357 Vali Acc: 0.806 Test Loss: 0.357 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9903476238250732
Epoch: 22, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.350 Vali Acc: 0.828 Test Loss: 0.350 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 23 cost time: 0.9813117980957031
Epoch: 23, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.341 Vali Acc: 0.844 Test Loss: 0.341 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 24 cost time: 1.0112884044647217
Epoch: 24, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8915402889251709
Epoch: 25, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.329 Vali Acc: 0.839 Test Loss: 0.329 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8647580146789551
Epoch: 26, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.322 Vali Acc: 0.839 Test Loss: 0.322 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9616987705230713
Epoch: 27, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 28 cost time: 0.9318208694458008
Epoch: 28, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 29 cost time: 0.9329500198364258
Epoch: 29, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 30 cost time: 1.0404596328735352
Epoch: 30, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 31 cost time: 1.0050668716430664
Epoch: 31, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9761447906494141
Epoch: 32, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0689191818237305
Epoch: 33, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.971778392791748
Epoch: 34, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9676542282104492
Epoch: 35, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9579744338989258
Epoch: 36, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.283 Vali Acc: 0.850 Test Loss: 0.283 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9133665561676025
Epoch: 37, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 38 cost time: 1.0705058574676514
Epoch: 38, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 39 cost time: 1.027658462524414
Epoch: 39, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9331638813018799
Epoch: 40, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.269 Vali Acc: 0.856 Test Loss: 0.269 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9694435596466064
Epoch: 41, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 42 cost time: 0.9818506240844727
Epoch: 42, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.9554877281188965
Epoch: 43, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.263 Vali Acc: 0.867 Test Loss: 0.263 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9397983551025391
Epoch: 44, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.255 Vali Acc: 0.894 Test Loss: 0.255 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 45 cost time: 1.016416072845459
Epoch: 45, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.254 Vali Acc: 0.883 Test Loss: 0.254 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8972527980804443
Epoch: 46, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.248 Vali Acc: 0.867 Test Loss: 0.248 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1109302043914795
Epoch: 47, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.250 Vali Acc: 0.867 Test Loss: 0.250 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0235393047332764
Epoch: 48, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.246 Vali Acc: 0.878 Test Loss: 0.246 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.055077314376831
Epoch: 49, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.244 Vali Acc: 0.872 Test Loss: 0.244 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.950063943862915
Epoch: 50, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.260 Vali Acc: 0.867 Test Loss: 0.260 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.0968918800354004
Epoch: 51, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.247 Vali Acc: 0.878 Test Loss: 0.247 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.0686676502227783
Epoch: 52, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.246 Vali Acc: 0.872 Test Loss: 0.246 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.9501166343688965
Epoch: 53, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.231 Vali Acc: 0.889 Test Loss: 0.231 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.000187635421753
Epoch: 54, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.233 Vali Acc: 0.883 Test Loss: 0.233 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 32566
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.991804599761963
Epoch: 1, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.596 Vali Acc: 0.378 Test Loss: 1.596 Test Acc: 0.378
Validation loss decreased (inf --> -0.377762).  Saving model ...
Epoch: 2 cost time: 0.9524080753326416
Epoch: 2, Steps: 12 | Train Loss: 1.625 Vali Loss: 1.429 Vali Acc: 0.511 Test Loss: 1.429 Test Acc: 0.511
Validation loss decreased (-0.377762 --> -0.511097).  Saving model ...
Epoch: 3 cost time: 1.0315148830413818
Epoch: 3, Steps: 12 | Train Loss: 1.373 Vali Loss: 1.243 Vali Acc: 0.633 Test Loss: 1.243 Test Acc: 0.633
Validation loss decreased (-0.511097 --> -0.633321).  Saving model ...
Epoch: 4 cost time: 0.9435374736785889
Epoch: 4, Steps: 12 | Train Loss: 1.196 Vali Loss: 1.064 Vali Acc: 0.667 Test Loss: 1.064 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666656).  Saving model ...
Epoch: 5 cost time: 0.9950449466705322
Epoch: 5, Steps: 12 | Train Loss: 1.025 Vali Loss: 0.913 Vali Acc: 0.678 Test Loss: 0.913 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677769).  Saving model ...
Epoch: 6 cost time: 0.9755198955535889
Epoch: 6, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.795 Vali Acc: 0.683 Test Loss: 0.795 Test Acc: 0.683
Validation loss decreased (-0.677769 --> -0.683325).  Saving model ...
Epoch: 7 cost time: 1.062312364578247
Epoch: 7, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.702 Vali Acc: 0.694 Test Loss: 0.702 Test Acc: 0.694
Validation loss decreased (-0.683325 --> -0.694437).  Saving model ...
Epoch: 8 cost time: 1.006559133529663
Epoch: 8, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.634 Vali Acc: 0.706 Test Loss: 0.634 Test Acc: 0.706
Validation loss decreased (-0.694437 --> -0.705549).  Saving model ...
Epoch: 9 cost time: 0.9048080444335938
Epoch: 9, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (-0.705549 --> -0.722216).  Saving model ...
Epoch: 10 cost time: 0.917433500289917
Epoch: 10, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.554 Vali Acc: 0.722 Test Loss: 0.554 Test Acc: 0.722
Validation loss decreased (-0.722216 --> -0.722217).  Saving model ...
Epoch: 11 cost time: 1.048236608505249
Epoch: 11, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.529 Vali Acc: 0.733 Test Loss: 0.529 Test Acc: 0.733
Validation loss decreased (-0.722217 --> -0.733328).  Saving model ...
Epoch: 12 cost time: 0.9403917789459229
Epoch: 12, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.499 Vali Acc: 0.750 Test Loss: 0.499 Test Acc: 0.750
Validation loss decreased (-0.733328 --> -0.749995).  Saving model ...
Epoch: 13 cost time: 1.0644831657409668
Epoch: 13, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.480 Vali Acc: 0.750 Test Loss: 0.480 Test Acc: 0.750
Validation loss decreased (-0.749995 --> -0.749995).  Saving model ...
Epoch: 14 cost time: 0.897430419921875
Epoch: 14, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.442 Vali Acc: 0.772 Test Loss: 0.442 Test Acc: 0.772
Validation loss decreased (-0.749995 --> -0.772218).  Saving model ...
Epoch: 15 cost time: 1.0514357089996338
Epoch: 15, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.419 Vali Acc: 0.794 Test Loss: 0.419 Test Acc: 0.794
Validation loss decreased (-0.772218 --> -0.794440).  Saving model ...
Epoch: 16 cost time: 0.9327285289764404
Epoch: 16, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.411 Vali Acc: 0.794 Test Loss: 0.411 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 17 cost time: 1.0438573360443115
Epoch: 17, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.408 Vali Acc: 0.783 Test Loss: 0.408 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0106592178344727
Epoch: 18, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.388 Vali Acc: 0.794 Test Loss: 0.388 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794441).  Saving model ...
Epoch: 19 cost time: 1.0174038410186768
Epoch: 19, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.375 Vali Acc: 0.817 Test Loss: 0.375 Test Acc: 0.817
Validation loss decreased (-0.794441 --> -0.816663).  Saving model ...
Epoch: 20 cost time: 1.015199899673462
Epoch: 20, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.368 Vali Acc: 0.806 Test Loss: 0.368 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0284528732299805
Epoch: 21, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.354 Vali Acc: 0.811 Test Loss: 0.354 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0049469470977783
Epoch: 22, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838885).  Saving model ...
Epoch: 23 cost time: 0.8884296417236328
Epoch: 23, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.338 Vali Acc: 0.844 Test Loss: 0.338 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 24 cost time: 0.9375455379486084
Epoch: 24, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.331 Vali Acc: 0.833 Test Loss: 0.331 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9177684783935547
Epoch: 25, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.329 Vali Acc: 0.839 Test Loss: 0.329 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0599067211151123
Epoch: 26, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 27 cost time: 0.9714651107788086
Epoch: 27, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 28 cost time: 1.113156795501709
Epoch: 28, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 29 cost time: 0.9846940040588379
Epoch: 29, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 30 cost time: 0.9359230995178223
Epoch: 30, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 31 cost time: 0.9942634105682373
Epoch: 31, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0135459899902344
Epoch: 32, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0396678447723389
Epoch: 33, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.005843162536621
Epoch: 34, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0871775150299072
Epoch: 35, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.005899429321289
Epoch: 36, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9824724197387695
Epoch: 37, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 38 cost time: 0.9770922660827637
Epoch: 38, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.269 Vali Acc: 0.867 Test Loss: 0.269 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8977556228637695
Epoch: 39, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 40 cost time: 0.9303390979766846
Epoch: 40, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.274 Vali Acc: 0.861 Test Loss: 0.274 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.931873083114624
Epoch: 41, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 42 cost time: 0.9476172924041748
Epoch: 42, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.9425821304321289
Epoch: 43, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.263 Vali Acc: 0.872 Test Loss: 0.263 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9716296195983887
Epoch: 44, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 1.1555824279785156
Epoch: 45, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.252 Vali Acc: 0.878 Test Loss: 0.252 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1014599800109863
Epoch: 46, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.244 Vali Acc: 0.872 Test Loss: 0.244 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.896176815032959
Epoch: 47, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.250 Vali Acc: 0.867 Test Loss: 0.250 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0292530059814453
Epoch: 48, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.245 Vali Acc: 0.872 Test Loss: 0.245 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9899289608001709
Epoch: 49, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.244 Vali Acc: 0.883 Test Loss: 0.244 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0056064128875732
Epoch: 50, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.257 Vali Acc: 0.872 Test Loss: 0.257 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.90220046043396
Epoch: 51, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.243 Vali Acc: 0.872 Test Loss: 0.243 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.0732731819152832
Epoch: 52, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 1.1265106201171875
Epoch: 53, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.229 Vali Acc: 0.894 Test Loss: 0.229 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 54 cost time: 1.1659624576568604
Epoch: 54, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.231 Vali Acc: 0.878 Test Loss: 0.231 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.926323413848877
Epoch: 55, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.233 Vali Acc: 0.883 Test Loss: 0.233 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.937150239944458
Epoch: 56, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.233 Vali Acc: 0.894 Test Loss: 0.233 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.9743809700012207
Epoch: 57, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.9600582122802734
Epoch: 58, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 59 cost time: 0.9946880340576172
Epoch: 59, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.260 Vali Acc: 0.872 Test Loss: 0.260 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9102509021759033
Epoch: 60, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.237 Vali Acc: 0.872 Test Loss: 0.237 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9673354625701904
Epoch: 61, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.9958531856536865
Epoch: 62, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.236 Vali Acc: 0.872 Test Loss: 0.236 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0097379684448242
Epoch: 63, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.0178320407867432
Epoch: 64, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.239 Vali Acc: 0.872 Test Loss: 0.239 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.047612190246582
Epoch: 65, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.249 Vali Acc: 0.878 Test Loss: 0.249 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.0777521133422852
Epoch: 66, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.1417441368103027
Epoch: 67, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.244 Vali Acc: 0.894 Test Loss: 0.244 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.0720393657684326
Epoch: 68, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.237 Vali Acc: 0.894 Test Loss: 0.237 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 32566
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.992438793182373
Epoch: 1, Steps: 12 | Train Loss: 1.741 Vali Loss: 1.598 Vali Acc: 0.372 Test Loss: 1.598 Test Acc: 0.372
Validation loss decreased (inf --> -0.372206).  Saving model ...
Epoch: 2 cost time: 1.096879005432129
Epoch: 2, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.433 Vali Acc: 0.517 Test Loss: 1.433 Test Acc: 0.517
Validation loss decreased (-0.372206 --> -0.516652).  Saving model ...
Epoch: 3 cost time: 0.9893529415130615
Epoch: 3, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.251 Vali Acc: 0.650 Test Loss: 1.251 Test Acc: 0.650
Validation loss decreased (-0.516652 --> -0.649987).  Saving model ...
Epoch: 4 cost time: 0.9442095756530762
Epoch: 4, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.068 Vali Acc: 0.678 Test Loss: 1.068 Test Acc: 0.678
Validation loss decreased (-0.649987 --> -0.677767).  Saving model ...
Epoch: 5 cost time: 0.9729764461517334
Epoch: 5, Steps: 12 | Train Loss: 1.016 Vali Loss: 0.914 Vali Acc: 0.700 Test Loss: 0.914 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 1.064321517944336
Epoch: 6, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.795 Vali Acc: 0.694 Test Loss: 0.795 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0487134456634521
Epoch: 7, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.701 Vali Acc: 0.694 Test Loss: 0.701 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2142300605773926
Epoch: 8, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.636 Vali Acc: 0.722 Test Loss: 0.636 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722216).  Saving model ...
Epoch: 9 cost time: 1.080894947052002
Epoch: 9, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.584 Vali Acc: 0.733 Test Loss: 0.584 Test Acc: 0.733
Validation loss decreased (-0.722216 --> -0.733327).  Saving model ...
Epoch: 10 cost time: 1.0334434509277344
Epoch: 10, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.550 Vali Acc: 0.767 Test Loss: 0.550 Test Acc: 0.767
Validation loss decreased (-0.733327 --> -0.766661).  Saving model ...
Epoch: 11 cost time: 1.0479202270507812
Epoch: 11, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.524 Vali Acc: 0.761 Test Loss: 0.524 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0626108646392822
Epoch: 12, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.496 Vali Acc: 0.756 Test Loss: 0.496 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0055336952209473
Epoch: 13, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.478 Vali Acc: 0.772 Test Loss: 0.478 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 14 cost time: 1.082981824874878
Epoch: 14, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.440 Vali Acc: 0.794 Test Loss: 0.440 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794440).  Saving model ...
Epoch: 15 cost time: 1.2312297821044922
Epoch: 15, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.420 Vali Acc: 0.794 Test Loss: 0.420 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 16 cost time: 1.1227977275848389
Epoch: 16, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.408 Vali Acc: 0.806 Test Loss: 0.408 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 0.9830658435821533
Epoch: 17, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.403 Vali Acc: 0.789 Test Loss: 0.403 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1248598098754883
Epoch: 18, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.388 Vali Acc: 0.800 Test Loss: 0.388 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0129621028900146
Epoch: 19, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.374 Vali Acc: 0.817 Test Loss: 0.374 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 20 cost time: 0.9631097316741943
Epoch: 20, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.366 Vali Acc: 0.806 Test Loss: 0.366 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9915311336517334
Epoch: 21, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.353 Vali Acc: 0.828 Test Loss: 0.353 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 22 cost time: 0.9925966262817383
Epoch: 22, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.349 Vali Acc: 0.822 Test Loss: 0.349 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.900719404220581
Epoch: 23, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.340 Vali Acc: 0.867 Test Loss: 0.340 Test Acc: 0.867
Validation loss decreased (-0.827774 --> -0.866663).  Saving model ...
Epoch: 24 cost time: 0.9536893367767334
Epoch: 24, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0835471153259277
Epoch: 25, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.327 Vali Acc: 0.861 Test Loss: 0.327 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1495625972747803
Epoch: 26, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.326 Vali Acc: 0.822 Test Loss: 0.326 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.136939525604248
Epoch: 27, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.315 Vali Acc: 0.844 Test Loss: 0.315 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0472888946533203
Epoch: 28, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1561219692230225
Epoch: 29, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0605473518371582
Epoch: 30, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 31 cost time: 1.0366795063018799
Epoch: 31, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.023932933807373
Epoch: 32, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.096578598022461
Epoch: 33, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1411025524139404
Epoch: 34, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 35 cost time: 1.1666386127471924
Epoch: 35, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.026045799255371
Epoch: 36, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.292 Vali Acc: 0.839 Test Loss: 0.292 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1487150192260742
Epoch: 37, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9680619239807129
Epoch: 38, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.263 Vali Acc: 0.867 Test Loss: 0.263 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 39 cost time: 1.083045482635498
Epoch: 39, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.253 Vali Acc: 0.883 Test Loss: 0.253 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 40 cost time: 0.9982693195343018
Epoch: 40, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.270 Vali Acc: 0.867 Test Loss: 0.270 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0401344299316406
Epoch: 41, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 1.0447027683258057
Epoch: 42, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.240 Vali Acc: 0.894 Test Loss: 0.240 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 43 cost time: 1.1392500400543213
Epoch: 43, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.254 Vali Acc: 0.872 Test Loss: 0.254 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1242578029632568
Epoch: 44, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.238 Vali Acc: 0.878 Test Loss: 0.238 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1245722770690918
Epoch: 45, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0581841468811035
Epoch: 46, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.811455488204956
Epoch: 47, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.240 Vali Acc: 0.878 Test Loss: 0.240 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0694165229797363
Epoch: 48, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9650564193725586
Epoch: 49, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.226 Vali Acc: 0.889 Test Loss: 0.226 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.9143974781036377
Epoch: 50, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.9799950122833252
Epoch: 51, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.232 Vali Acc: 0.883 Test Loss: 0.232 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.0016887187957764
Epoch: 52, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 32566
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.736314535140991
Epoch: 1, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.617 Vali Acc: 0.394 Test Loss: 1.617 Test Acc: 0.394
Validation loss decreased (inf --> -0.394428).  Saving model ...
Epoch: 2 cost time: 0.8938000202178955
Epoch: 2, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.462 Vali Acc: 0.544 Test Loss: 1.462 Test Acc: 0.544
Validation loss decreased (-0.394428 --> -0.544430).  Saving model ...
Epoch: 3 cost time: 0.8381974697113037
Epoch: 3, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.286 Vali Acc: 0.628 Test Loss: 1.286 Test Acc: 0.628
Validation loss decreased (-0.544430 --> -0.627765).  Saving model ...
Epoch: 4 cost time: 0.9945573806762695
Epoch: 4, Steps: 12 | Train Loss: 1.217 Vali Loss: 1.109 Vali Acc: 0.656 Test Loss: 1.109 Test Acc: 0.656
Validation loss decreased (-0.627765 --> -0.655544).  Saving model ...
Epoch: 5 cost time: 0.910606861114502
Epoch: 5, Steps: 12 | Train Loss: 1.033 Vali Loss: 0.956 Vali Acc: 0.683 Test Loss: 0.956 Test Acc: 0.683
Validation loss decreased (-0.655544 --> -0.683324).  Saving model ...
Epoch: 6 cost time: 0.8864679336547852
Epoch: 6, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.837 Vali Acc: 0.694 Test Loss: 0.837 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694436).  Saving model ...
Epoch: 7 cost time: 0.954352617263794
Epoch: 7, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.744 Vali Acc: 0.689 Test Loss: 0.744 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9889781475067139
Epoch: 8, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.672 Vali Acc: 0.700 Test Loss: 0.672 Test Acc: 0.700
Validation loss decreased (-0.694436 --> -0.699993).  Saving model ...
Epoch: 9 cost time: 0.9745707511901855
Epoch: 9, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.623 Vali Acc: 0.706 Test Loss: 0.623 Test Acc: 0.706
Validation loss decreased (-0.699993 --> -0.705549).  Saving model ...
Epoch: 10 cost time: 0.9797823429107666
Epoch: 10, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.585 Vali Acc: 0.739 Test Loss: 0.585 Test Acc: 0.739
Validation loss decreased (-0.705549 --> -0.738883).  Saving model ...
Epoch: 11 cost time: 1.0669825077056885
Epoch: 11, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.550 Vali Acc: 0.750 Test Loss: 0.550 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749995).  Saving model ...
Epoch: 12 cost time: 1.0123028755187988
Epoch: 12, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.523 Vali Acc: 0.761 Test Loss: 0.523 Test Acc: 0.761
Validation loss decreased (-0.749995 --> -0.761106).  Saving model ...
Epoch: 13 cost time: 0.9472556114196777
Epoch: 13, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.506 Vali Acc: 0.756 Test Loss: 0.506 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9260931015014648
Epoch: 14, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.469 Vali Acc: 0.811 Test Loss: 0.469 Test Acc: 0.811
Validation loss decreased (-0.761106 --> -0.811106).  Saving model ...
Epoch: 15 cost time: 0.9487402439117432
Epoch: 15, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.449 Vali Acc: 0.772 Test Loss: 0.449 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8893032073974609
Epoch: 16, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.435 Vali Acc: 0.778 Test Loss: 0.435 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9820678234100342
Epoch: 17, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.428 Vali Acc: 0.772 Test Loss: 0.428 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9723701477050781
Epoch: 18, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.407 Vali Acc: 0.811 Test Loss: 0.407 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811107).  Saving model ...
Epoch: 19 cost time: 1.0039262771606445
Epoch: 19, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.384 Vali Acc: 0.817 Test Loss: 0.384 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 20 cost time: 0.9102222919464111
Epoch: 20, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.375 Vali Acc: 0.794 Test Loss: 0.375 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9231576919555664
Epoch: 21, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.368 Vali Acc: 0.800 Test Loss: 0.368 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8933250904083252
Epoch: 22, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 23 cost time: 0.8441121578216553
Epoch: 23, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.345 Vali Acc: 0.822 Test Loss: 0.345 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9386403560638428
Epoch: 24, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 25 cost time: 0.82887864112854
Epoch: 25, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.333 Vali Acc: 0.817 Test Loss: 0.333 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9347279071807861
Epoch: 26, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.328 Vali Acc: 0.811 Test Loss: 0.328 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8855972290039062
Epoch: 27, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 28 cost time: 0.856961727142334
Epoch: 28, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9808988571166992
Epoch: 29, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.952111005783081
Epoch: 30, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9638521671295166
Epoch: 31, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.306 Vali Acc: 0.839 Test Loss: 0.306 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9927127361297607
Epoch: 32, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.296 Vali Acc: 0.839 Test Loss: 0.296 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0058350563049316
Epoch: 33, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.299 Vali Acc: 0.828 Test Loss: 0.299 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8948392868041992
Epoch: 34, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 0.993070125579834
Epoch: 35, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0220718383789062
Epoch: 36, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.291 Vali Acc: 0.839 Test Loss: 0.291 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.940197229385376
Epoch: 37, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9647665023803711
Epoch: 38, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9190607070922852
Epoch: 39, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.90958571434021
Epoch: 40, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.292 Vali Acc: 0.833 Test Loss: 0.292 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9486062526702881
Epoch: 41, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 42 cost time: 0.98606276512146
Epoch: 42, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.271 Vali Acc: 0.861 Test Loss: 0.271 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8813741207122803
Epoch: 43, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.885772705078125
Epoch: 44, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8284823894500732
Epoch: 45, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9189488887786865
Epoch: 46, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.265 Vali Acc: 0.867 Test Loss: 0.265 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9932363033294678
Epoch: 47, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.256 Vali Acc: 0.872 Test Loss: 0.256 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9820184707641602
Epoch: 48, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.258 Vali Acc: 0.867 Test Loss: 0.258 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9151134490966797
Epoch: 49, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.252 Vali Acc: 0.883 Test Loss: 0.252 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.011683702468872
Epoch: 50, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.281 Vali Acc: 0.833 Test Loss: 0.281 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.9736723899841309
Epoch: 51, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.252 Vali Acc: 0.872 Test Loss: 0.252 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 32566
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6830735206604004
Epoch: 1, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.630 Vali Acc: 0.300 Test Loss: 1.630 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.0300908088684082
Epoch: 2, Steps: 12 | Train Loss: 1.584 Vali Loss: 1.460 Vali Acc: 0.500 Test Loss: 1.460 Test Acc: 0.500
Validation loss decreased (-0.299984 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 0.9696273803710938
Epoch: 3, Steps: 12 | Train Loss: 1.397 Vali Loss: 1.269 Vali Acc: 0.622 Test Loss: 1.269 Test Acc: 0.622
Validation loss decreased (-0.499985 --> -0.622210).  Saving model ...
Epoch: 4 cost time: 1.027381420135498
Epoch: 4, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.082 Vali Acc: 0.650 Test Loss: 1.082 Test Acc: 0.650
Validation loss decreased (-0.622210 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 0.9783391952514648
Epoch: 5, Steps: 12 | Train Loss: 0.981 Vali Loss: 0.933 Vali Acc: 0.667 Test Loss: 0.933 Test Acc: 0.667
Validation loss decreased (-0.649989 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 0.9224112033843994
Epoch: 6, Steps: 12 | Train Loss: 0.801 Vali Loss: 0.814 Vali Acc: 0.706 Test Loss: 0.814 Test Acc: 0.706
Validation loss decreased (-0.666657 --> -0.705547).  Saving model ...
Epoch: 7 cost time: 1.0312700271606445
Epoch: 7, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.742 Vali Acc: 0.667 Test Loss: 0.742 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9737310409545898
Epoch: 8, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.670 Vali Acc: 0.700 Test Loss: 0.670 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9713947772979736
Epoch: 9, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.622 Vali Acc: 0.706 Test Loss: 0.622 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705549).  Saving model ...
Epoch: 10 cost time: 0.9103090763092041
Epoch: 10, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.573 Vali Acc: 0.756 Test Loss: 0.573 Test Acc: 0.756
Validation loss decreased (-0.705549 --> -0.755550).  Saving model ...
Epoch: 11 cost time: 0.9914979934692383
Epoch: 11, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.533 Vali Acc: 0.739 Test Loss: 0.533 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0590291023254395
Epoch: 12, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.513 Vali Acc: 0.744 Test Loss: 0.513 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.110144853591919
Epoch: 13, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.487 Vali Acc: 0.772 Test Loss: 0.487 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772217).  Saving model ...
Epoch: 14 cost time: 1.1529107093811035
Epoch: 14, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.465 Vali Acc: 0.778 Test Loss: 0.465 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 15 cost time: 1.089242935180664
Epoch: 15, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.448 Vali Acc: 0.783 Test Loss: 0.448 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 16 cost time: 1.1454987525939941
Epoch: 16, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.436 Vali Acc: 0.794 Test Loss: 0.436 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794440).  Saving model ...
Epoch: 17 cost time: 1.0168635845184326
Epoch: 17, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.425 Vali Acc: 0.794 Test Loss: 0.425 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 18 cost time: 1.0210180282592773
Epoch: 18, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.407 Vali Acc: 0.800 Test Loss: 0.407 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 19 cost time: 0.9921615123748779
Epoch: 19, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.394 Vali Acc: 0.789 Test Loss: 0.394 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9691429138183594
Epoch: 20, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.380 Vali Acc: 0.794 Test Loss: 0.380 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0510430335998535
Epoch: 21, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 22 cost time: 0.9713461399078369
Epoch: 22, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.367 Vali Acc: 0.806 Test Loss: 0.367 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.967780351638794
Epoch: 23, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.361 Vali Acc: 0.811 Test Loss: 0.361 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.961031436920166
Epoch: 24, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.349 Vali Acc: 0.800 Test Loss: 0.349 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.089550495147705
Epoch: 25, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.349 Vali Acc: 0.828 Test Loss: 0.349 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 26 cost time: 1.072648286819458
Epoch: 26, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.338 Vali Acc: 0.828 Test Loss: 0.338 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 27 cost time: 1.1743946075439453
Epoch: 27, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.341 Vali Acc: 0.822 Test Loss: 0.341 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1168415546417236
Epoch: 28, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 29 cost time: 1.1146214008331299
Epoch: 29, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.15623140335083
Epoch: 30, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.322 Vali Acc: 0.833 Test Loss: 0.322 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1348111629486084
Epoch: 31, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 32 cost time: 1.1132686138153076
Epoch: 32, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 33 cost time: 1.1344268321990967
Epoch: 33, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 34 cost time: 1.111541748046875
Epoch: 34, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0341730117797852
Epoch: 35, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.233433723449707
Epoch: 36, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.313 Vali Acc: 0.833 Test Loss: 0.313 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1065049171447754
Epoch: 37, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.306 Vali Acc: 0.844 Test Loss: 0.306 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1371302604675293
Epoch: 38, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1174449920654297
Epoch: 39, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.289 Vali Acc: 0.850 Test Loss: 0.289 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0459485054016113
Epoch: 40, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1173341274261475
Epoch: 41, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2067492008209229
Epoch: 42, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.276 Vali Acc: 0.861 Test Loss: 0.276 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0924575328826904
Epoch: 43, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.280 Vali Acc: 0.861 Test Loss: 0.280 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 24374
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.787363052368164
Epoch: 1, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.639 Vali Acc: 0.278 Test Loss: 1.639 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 1.0496768951416016
Epoch: 2, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.469 Vali Acc: 0.528 Test Loss: 1.469 Test Acc: 0.528
Validation loss decreased (-0.277761 --> -0.527763).  Saving model ...
Epoch: 3 cost time: 0.9682302474975586
Epoch: 3, Steps: 12 | Train Loss: 1.390 Vali Loss: 1.277 Vali Acc: 0.606 Test Loss: 1.277 Test Acc: 0.606
Validation loss decreased (-0.527763 --> -0.605543).  Saving model ...
Epoch: 4 cost time: 0.9790809154510498
Epoch: 4, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.088 Vali Acc: 0.656 Test Loss: 1.088 Test Acc: 0.656
Validation loss decreased (-0.605543 --> -0.655545).  Saving model ...
Epoch: 5 cost time: 1.083066701889038
Epoch: 5, Steps: 12 | Train Loss: 0.979 Vali Loss: 0.937 Vali Acc: 0.672 Test Loss: 0.937 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672213).  Saving model ...
Epoch: 6 cost time: 1.0400140285491943
Epoch: 6, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.816 Vali Acc: 0.700 Test Loss: 0.816 Test Acc: 0.700
Validation loss decreased (-0.672213 --> -0.699992).  Saving model ...
Epoch: 7 cost time: 0.9799890518188477
Epoch: 7, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.745 Vali Acc: 0.667 Test Loss: 0.745 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.159071922302246
Epoch: 8, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.669 Vali Acc: 0.700 Test Loss: 0.669 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699993).  Saving model ...
Epoch: 9 cost time: 0.9253401756286621
Epoch: 9, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.622 Vali Acc: 0.717 Test Loss: 0.622 Test Acc: 0.717
Validation loss decreased (-0.699993 --> -0.716660).  Saving model ...
Epoch: 10 cost time: 1.0495884418487549
Epoch: 10, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.571 Vali Acc: 0.761 Test Loss: 0.571 Test Acc: 0.761
Validation loss decreased (-0.716660 --> -0.761105).  Saving model ...
Epoch: 11 cost time: 0.9722752571105957
Epoch: 11, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.533 Vali Acc: 0.744 Test Loss: 0.533 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9347267150878906
Epoch: 12, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.513 Vali Acc: 0.756 Test Loss: 0.513 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0337498188018799
Epoch: 13, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.485 Vali Acc: 0.778 Test Loss: 0.485 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777773).  Saving model ...
Epoch: 14 cost time: 1.008878469467163
Epoch: 14, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.464 Vali Acc: 0.778 Test Loss: 0.464 Test Acc: 0.778
Validation loss decreased (-0.777773 --> -0.777773).  Saving model ...
Epoch: 15 cost time: 0.9755411148071289
Epoch: 15, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.445 Vali Acc: 0.794 Test Loss: 0.445 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 16 cost time: 0.9854550361633301
Epoch: 16, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.434 Vali Acc: 0.806 Test Loss: 0.434 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 0.9137744903564453
Epoch: 17, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.423 Vali Acc: 0.800 Test Loss: 0.423 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1219260692596436
Epoch: 18, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.404 Vali Acc: 0.800 Test Loss: 0.404 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8792648315429688
Epoch: 19, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.391 Vali Acc: 0.800 Test Loss: 0.391 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0359764099121094
Epoch: 20, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.376 Vali Acc: 0.800 Test Loss: 0.376 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0950729846954346
Epoch: 21, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.372 Vali Acc: 0.811 Test Loss: 0.372 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 22 cost time: 1.034242868423462
Epoch: 22, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 23 cost time: 1.0319719314575195
Epoch: 23, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.359 Vali Acc: 0.817 Test Loss: 0.359 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 24 cost time: 0.9742441177368164
Epoch: 24, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.348 Vali Acc: 0.817 Test Loss: 0.348 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 25 cost time: 0.9858114719390869
Epoch: 25, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.348 Vali Acc: 0.828 Test Loss: 0.348 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 26 cost time: 0.9946486949920654
Epoch: 26, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.338 Vali Acc: 0.850 Test Loss: 0.338 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 27 cost time: 1.0480270385742188
Epoch: 27, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0513978004455566
Epoch: 28, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.103830337524414
Epoch: 29, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 30 cost time: 1.0050654411315918
Epoch: 30, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.032759666442871
Epoch: 31, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 32 cost time: 1.0053908824920654
Epoch: 32, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.004849910736084
Epoch: 33, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 34 cost time: 0.9591832160949707
Epoch: 34, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9603867530822754
Epoch: 35, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0398685932159424
Epoch: 36, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9654114246368408
Epoch: 37, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8997769355773926
Epoch: 38, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9362986087799072
Epoch: 39, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 40 cost time: 1.0289926528930664
Epoch: 40, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.273 Vali Acc: 0.861 Test Loss: 0.273 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1216404438018799
Epoch: 41, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0841965675354004
Epoch: 42, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.266 Vali Acc: 0.872 Test Loss: 0.266 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872220).  Saving model ...
Epoch: 43 cost time: 1.0310919284820557
Epoch: 43, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.270 Vali Acc: 0.872 Test Loss: 0.270 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.148371696472168
Epoch: 44, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.277 Vali Acc: 0.861 Test Loss: 0.277 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0636444091796875
Epoch: 45, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.273 Vali Acc: 0.872 Test Loss: 0.273 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0007774829864502
Epoch: 46, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.270 Vali Acc: 0.867 Test Loss: 0.270 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9231538772583008
Epoch: 47, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0423681735992432
Epoch: 48, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.872220 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 0.9788274765014648
Epoch: 49, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.276 Vali Acc: 0.867 Test Loss: 0.276 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9686770439147949
Epoch: 50, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 0.8849959373474121
Epoch: 51, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 52 cost time: 1.0838167667388916
Epoch: 52, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0323832035064697
Epoch: 53, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.04158353805542
Epoch: 54, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.255 Vali Acc: 0.878 Test Loss: 0.255 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.0288867950439453
Epoch: 55, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.258 Vali Acc: 0.878 Test Loss: 0.258 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.041013240814209
Epoch: 56, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.0077369213104248
Epoch: 57, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.8948442935943604
Epoch: 58, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.253 Vali Acc: 0.883 Test Loss: 0.253 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.9303691387176514
Epoch: 59, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.245 Vali Acc: 0.894 Test Loss: 0.245 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.951082706451416
Epoch: 60, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.254 Vali Acc: 0.883 Test Loss: 0.254 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.0146939754486084
Epoch: 61, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.258 Vali Acc: 0.878 Test Loss: 0.258 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 24374
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.09511661529541
Epoch: 1, Steps: 12 | Train Loss: 1.721 Vali Loss: 1.655 Vali Acc: 0.294 Test Loss: 1.655 Test Acc: 0.294
Validation loss decreased (inf --> -0.294428).  Saving model ...
Epoch: 2 cost time: 0.9038958549499512
Epoch: 2, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.487 Vali Acc: 0.478 Test Loss: 1.487 Test Acc: 0.478
Validation loss decreased (-0.294428 --> -0.477763).  Saving model ...
Epoch: 3 cost time: 1.0854136943817139
Epoch: 3, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.296 Vali Acc: 0.617 Test Loss: 1.296 Test Acc: 0.617
Validation loss decreased (-0.477763 --> -0.616654).  Saving model ...
Epoch: 4 cost time: 1.0769329071044922
Epoch: 4, Steps: 12 | Train Loss: 1.196 Vali Loss: 1.101 Vali Acc: 0.644 Test Loss: 1.101 Test Acc: 0.644
Validation loss decreased (-0.616654 --> -0.644433).  Saving model ...
Epoch: 5 cost time: 0.9521222114562988
Epoch: 5, Steps: 12 | Train Loss: 0.980 Vali Loss: 0.945 Vali Acc: 0.683 Test Loss: 0.945 Test Acc: 0.683
Validation loss decreased (-0.644433 --> -0.683324).  Saving model ...
Epoch: 6 cost time: 0.9282369613647461
Epoch: 6, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.822 Vali Acc: 0.700 Test Loss: 0.822 Test Acc: 0.700
Validation loss decreased (-0.683324 --> -0.699992).  Saving model ...
Epoch: 7 cost time: 1.0035479068756104
Epoch: 7, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.747 Vali Acc: 0.689 Test Loss: 0.747 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9234466552734375
Epoch: 8, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.672 Vali Acc: 0.717 Test Loss: 0.672 Test Acc: 0.717
Validation loss decreased (-0.699992 --> -0.716660).  Saving model ...
Epoch: 9 cost time: 0.9291889667510986
Epoch: 9, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.625 Vali Acc: 0.711 Test Loss: 0.625 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0264194011688232
Epoch: 10, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
Validation loss decreased (-0.716660 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 0.9287042617797852
Epoch: 11, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755550).  Saving model ...
Epoch: 12 cost time: 1.0215396881103516
Epoch: 12, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.508 Vali Acc: 0.744 Test Loss: 0.508 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9773073196411133
Epoch: 13, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.479 Vali Acc: 0.778 Test Loss: 0.479 Test Acc: 0.778
Validation loss decreased (-0.755550 --> -0.777773).  Saving model ...
Epoch: 14 cost time: 0.9238684177398682
Epoch: 14, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.457 Vali Acc: 0.794 Test Loss: 0.457 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 15 cost time: 0.9776611328125
Epoch: 15, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.438 Vali Acc: 0.789 Test Loss: 0.438 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9652564525604248
Epoch: 16, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.425 Vali Acc: 0.806 Test Loss: 0.425 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 0.9570505619049072
Epoch: 17, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.416 Vali Acc: 0.794 Test Loss: 0.416 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9975478649139404
Epoch: 18, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.397 Vali Acc: 0.822 Test Loss: 0.397 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 19 cost time: 0.9595816135406494
Epoch: 19, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.385 Vali Acc: 0.828 Test Loss: 0.385 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 20 cost time: 0.9754946231842041
Epoch: 20, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.373 Vali Acc: 0.833 Test Loss: 0.373 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 21 cost time: 0.8532533645629883
Epoch: 21, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.369 Vali Acc: 0.839 Test Loss: 0.369 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 22 cost time: 0.9367308616638184
Epoch: 22, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9044997692108154
Epoch: 23, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.357 Vali Acc: 0.828 Test Loss: 0.357 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9127280712127686
Epoch: 24, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.347 Vali Acc: 0.817 Test Loss: 0.347 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.937859296798706
Epoch: 25, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.345 Vali Acc: 0.839 Test Loss: 0.345 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 26 cost time: 1.0130589008331299
Epoch: 26, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.331 Vali Acc: 0.861 Test Loss: 0.331 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 27 cost time: 1.0188374519348145
Epoch: 27, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0740315914154053
Epoch: 28, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.332 Vali Acc: 0.844 Test Loss: 0.332 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0369620323181152
Epoch: 29, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.974252462387085
Epoch: 30, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.320 Vali Acc: 0.872 Test Loss: 0.320 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 31 cost time: 1.060887098312378
Epoch: 31, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.309 Vali Acc: 0.844 Test Loss: 0.309 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9804260730743408
Epoch: 32, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0232853889465332
Epoch: 33, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0257916450500488
Epoch: 34, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0134422779083252
Epoch: 35, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9482414722442627
Epoch: 36, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9586279392242432
Epoch: 37, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.949371337890625
Epoch: 38, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 39 cost time: 0.899693489074707
Epoch: 39, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.277 Vali Acc: 0.861 Test Loss: 0.277 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0647814273834229
Epoch: 40, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872220).  Saving model ...
Epoch: 41 cost time: 1.0643315315246582
Epoch: 41, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.286 Vali Acc: 0.850 Test Loss: 0.286 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.115171194076538
Epoch: 42, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877775).  Saving model ...
Epoch: 43 cost time: 0.9619035720825195
Epoch: 43, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.264 Vali Acc: 0.867 Test Loss: 0.264 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9876327514648438
Epoch: 44, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9766883850097656
Epoch: 45, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 0.8773829936981201
Epoch: 46, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9915316104888916
Epoch: 47, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.267 Vali Acc: 0.867 Test Loss: 0.267 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9561710357666016
Epoch: 48, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.254 Vali Acc: 0.872 Test Loss: 0.254 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9196140766143799
Epoch: 49, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.264 Vali Acc: 0.861 Test Loss: 0.264 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9433448314666748
Epoch: 50, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.248 Vali Acc: 0.872 Test Loss: 0.248 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.138488531112671
Epoch: 51, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 52 cost time: 1.0793612003326416
Epoch: 52, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.252 Vali Acc: 0.867 Test Loss: 0.252 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9540629386901855
Epoch: 53, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 54 cost time: 1.0353705883026123
Epoch: 54, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.249 Vali Acc: 0.872 Test Loss: 0.249 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0768747329711914
Epoch: 55, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.067495584487915
Epoch: 56, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.244 Vali Acc: 0.883 Test Loss: 0.244 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.0197901725769043
Epoch: 57, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 58 cost time: 0.8725647926330566
Epoch: 58, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8908770084381104
Epoch: 59, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9504625797271729
Epoch: 60, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.8737680912017822
Epoch: 61, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.9509217739105225
Epoch: 62, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.247 Vali Acc: 0.883 Test Loss: 0.247 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.0800986289978027
Epoch: 63, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.0246882438659668
Epoch: 64, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.244 Vali Acc: 0.878 Test Loss: 0.244 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.0052940845489502
Epoch: 65, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.0522902011871338
Epoch: 66, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.245 Vali Acc: 0.878 Test Loss: 0.245 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.9909055233001709
Epoch: 67, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.245 Vali Acc: 0.894 Test Loss: 0.245 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 24374
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9529945850372314
Epoch: 1, Steps: 12 | Train Loss: 1.760 Vali Loss: 1.690 Vali Acc: 0.222 Test Loss: 1.690 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 0.970569372177124
Epoch: 2, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.527 Vali Acc: 0.472 Test Loss: 1.527 Test Acc: 0.472
Validation loss decreased (-0.222205 --> -0.472207).  Saving model ...
Epoch: 3 cost time: 0.9525814056396484
Epoch: 3, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.338 Vali Acc: 0.667 Test Loss: 1.338 Test Acc: 0.667
Validation loss decreased (-0.472207 --> -0.666653).  Saving model ...
Epoch: 4 cost time: 0.999610185623169
Epoch: 4, Steps: 12 | Train Loss: 1.248 Vali Loss: 1.145 Vali Acc: 0.678 Test Loss: 1.145 Test Acc: 0.678
Validation loss decreased (-0.666653 --> -0.677766).  Saving model ...
Epoch: 5 cost time: 0.9394197463989258
Epoch: 5, Steps: 12 | Train Loss: 1.030 Vali Loss: 0.986 Vali Acc: 0.711 Test Loss: 0.986 Test Acc: 0.711
Validation loss decreased (-0.677766 --> -0.711101).  Saving model ...
Epoch: 6 cost time: 1.0758693218231201
Epoch: 6, Steps: 12 | Train Loss: 0.850 Vali Loss: 0.857 Vali Acc: 0.717 Test Loss: 0.857 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716658).  Saving model ...
Epoch: 7 cost time: 0.9014809131622314
Epoch: 7, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.777 Vali Acc: 0.678 Test Loss: 0.777 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0103540420532227
Epoch: 8, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.705 Vali Acc: 0.706 Test Loss: 0.705 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1318950653076172
Epoch: 9, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.655 Vali Acc: 0.706 Test Loss: 0.655 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0565719604492188
Epoch: 10, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.608 Vali Acc: 0.733 Test Loss: 0.608 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733327).  Saving model ...
Epoch: 11 cost time: 1.0136971473693848
Epoch: 11, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0065486431121826
Epoch: 12, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.542 Vali Acc: 0.744 Test Loss: 0.542 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744439).  Saving model ...
Epoch: 13 cost time: 1.0191419124603271
Epoch: 13, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
Validation loss decreased (-0.744439 --> -0.783328).  Saving model ...
Epoch: 14 cost time: 1.067209243774414
Epoch: 14, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.490 Vali Acc: 0.783 Test Loss: 0.490 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783328).  Saving model ...
Epoch: 15 cost time: 0.8994314670562744
Epoch: 15, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.466 Vali Acc: 0.789 Test Loss: 0.466 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 16 cost time: 0.8930680751800537
Epoch: 16, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.451 Vali Acc: 0.800 Test Loss: 0.451 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799995).  Saving model ...
Epoch: 17 cost time: 0.9100725650787354
Epoch: 17, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.439 Vali Acc: 0.806 Test Loss: 0.439 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 18 cost time: 0.9775834083557129
Epoch: 18, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.419 Vali Acc: 0.789 Test Loss: 0.419 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9932208061218262
Epoch: 19, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.410 Vali Acc: 0.794 Test Loss: 0.410 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0058956146240234
Epoch: 20, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.386 Vali Acc: 0.811 Test Loss: 0.386 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 21 cost time: 0.9446475505828857
Epoch: 21, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.378 Vali Acc: 0.822 Test Loss: 0.378 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 22 cost time: 1.0464286804199219
Epoch: 22, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.375 Vali Acc: 0.806 Test Loss: 0.375 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9407269954681396
Epoch: 23, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.371 Vali Acc: 0.822 Test Loss: 0.371 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 24 cost time: 0.907569169998169
Epoch: 24, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.366 Vali Acc: 0.828 Test Loss: 0.366 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 25 cost time: 1.0680229663848877
Epoch: 25, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.361 Vali Acc: 0.817 Test Loss: 0.361 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.974083662033081
Epoch: 26, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.350 Vali Acc: 0.872 Test Loss: 0.350 Test Acc: 0.872
Validation loss decreased (-0.827774 --> -0.872219).  Saving model ...
Epoch: 27 cost time: 1.0257384777069092
Epoch: 27, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.355 Vali Acc: 0.828 Test Loss: 0.355 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.051703929901123
Epoch: 28, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.349 Vali Acc: 0.828 Test Loss: 0.349 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1818525791168213
Epoch: 29, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.337 Vali Acc: 0.828 Test Loss: 0.337 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.007720708847046
Epoch: 30, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.332 Vali Acc: 0.844 Test Loss: 0.332 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0529272556304932
Epoch: 31, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0201911926269531
Epoch: 32, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0556015968322754
Epoch: 33, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0205907821655273
Epoch: 34, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.317 Vali Acc: 0.872 Test Loss: 0.317 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 35 cost time: 0.9991400241851807
Epoch: 35, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.312 Vali Acc: 0.872 Test Loss: 0.312 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 36 cost time: 0.9548683166503906
Epoch: 36, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0107049942016602
Epoch: 37, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.900486946105957
Epoch: 38, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8800582885742188
Epoch: 39, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9852645397186279
Epoch: 40, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 41 cost time: 0.9804086685180664
Epoch: 41, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.317 Vali Acc: 0.828 Test Loss: 0.317 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0213584899902344
Epoch: 42, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9364638328552246
Epoch: 43, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9973225593566895
Epoch: 44, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0949180126190186
Epoch: 45, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 0.9750092029571533
Epoch: 46, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.293 Vali Acc: 0.883 Test Loss: 0.293 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0306825637817383
Epoch: 47, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0703403949737549
Epoch: 48, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0253887176513672
Epoch: 49, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9236907958984375
Epoch: 50, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9633336067199707
Epoch: 51, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9717717170715332
Epoch: 52, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.984783411026001
Epoch: 53, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.9707212448120117
Epoch: 54, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.9933750629425049
Epoch: 55, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 24374
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9900925159454346
Epoch: 1, Steps: 12 | Train Loss: 2.016 Vali Loss: 1.869 Vali Acc: 0.189 Test Loss: 1.869 Test Acc: 0.189
Validation loss decreased (inf --> -0.188870).  Saving model ...
Epoch: 2 cost time: 0.9532976150512695
Epoch: 2, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.622 Vali Acc: 0.339 Test Loss: 1.622 Test Acc: 0.339
Validation loss decreased (-0.188870 --> -0.338873).  Saving model ...
Epoch: 3 cost time: 0.9284474849700928
Epoch: 3, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.377 Vali Acc: 0.567 Test Loss: 1.377 Test Acc: 0.567
Validation loss decreased (-0.338873 --> -0.566653).  Saving model ...
Epoch: 4 cost time: 1.0219640731811523
Epoch: 4, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.169 Vali Acc: 0.644 Test Loss: 1.169 Test Acc: 0.644
Validation loss decreased (-0.566653 --> -0.644433).  Saving model ...
Epoch: 5 cost time: 1.0162792205810547
Epoch: 5, Steps: 12 | Train Loss: 1.073 Vali Loss: 0.992 Vali Acc: 0.700 Test Loss: 0.992 Test Acc: 0.700
Validation loss decreased (-0.644433 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 0.9483959674835205
Epoch: 6, Steps: 12 | Train Loss: 0.914 Vali Loss: 0.854 Vali Acc: 0.683 Test Loss: 0.854 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9748895168304443
Epoch: 7, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.752 Vali Acc: 0.739 Test Loss: 0.752 Test Acc: 0.739
Validation loss decreased (-0.699990 --> -0.738881).  Saving model ...
Epoch: 8 cost time: 1.1206626892089844
Epoch: 8, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.676 Vali Acc: 0.711 Test Loss: 0.676 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0732545852661133
Epoch: 9, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.613 Vali Acc: 0.761 Test Loss: 0.613 Test Acc: 0.761
Validation loss decreased (-0.738881 --> -0.761105).  Saving model ...
Epoch: 10 cost time: 1.1400480270385742
Epoch: 10, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.567 Vali Acc: 0.744 Test Loss: 0.567 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0076994895935059
Epoch: 11, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.531 Vali Acc: 0.756 Test Loss: 0.531 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9717905521392822
Epoch: 12, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.501 Vali Acc: 0.744 Test Loss: 0.501 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9947855472564697
Epoch: 13, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.486 Vali Acc: 0.772 Test Loss: 0.486 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772217).  Saving model ...
Epoch: 14 cost time: 1.0667622089385986
Epoch: 14, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.466 Vali Acc: 0.783 Test Loss: 0.466 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 15 cost time: 1.046593427658081
Epoch: 15, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.444 Vali Acc: 0.772 Test Loss: 0.444 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9948322772979736
Epoch: 16, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.427 Vali Acc: 0.789 Test Loss: 0.427 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 17 cost time: 1.0353991985321045
Epoch: 17, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.411 Vali Acc: 0.778 Test Loss: 0.411 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9806725978851318
Epoch: 18, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.401 Vali Acc: 0.794 Test Loss: 0.401 Test Acc: 0.794
Validation loss decreased (-0.788885 --> -0.794440).  Saving model ...
Epoch: 19 cost time: 0.963780403137207
Epoch: 19, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.394 Vali Acc: 0.806 Test Loss: 0.394 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 20 cost time: 1.0671043395996094
Epoch: 20, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.390 Vali Acc: 0.811 Test Loss: 0.390 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 21 cost time: 1.057079792022705
Epoch: 21, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 22 cost time: 1.0038056373596191
Epoch: 22, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.360 Vali Acc: 0.822 Test Loss: 0.360 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1266238689422607
Epoch: 23, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.347 Vali Acc: 0.833 Test Loss: 0.347 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 24 cost time: 0.9790947437286377
Epoch: 24, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.348 Vali Acc: 0.800 Test Loss: 0.348 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0349996089935303
Epoch: 25, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.340 Vali Acc: 0.822 Test Loss: 0.340 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1398842334747314
Epoch: 26, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 27 cost time: 1.1724069118499756
Epoch: 27, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.326 Vali Acc: 0.861 Test Loss: 0.326 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 28 cost time: 1.0094740390777588
Epoch: 28, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1245486736297607
Epoch: 29, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.977508544921875
Epoch: 30, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 31 cost time: 1.0809361934661865
Epoch: 31, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.311 Vali Acc: 0.850 Test Loss: 0.311 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9436852931976318
Epoch: 32, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.304 Vali Acc: 0.839 Test Loss: 0.304 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0133538246154785
Epoch: 33, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8930647373199463
Epoch: 34, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0120739936828613
Epoch: 35, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 36 cost time: 1.0188159942626953
Epoch: 36, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.289 Vali Acc: 0.844 Test Loss: 0.289 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0873205661773682
Epoch: 37, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 38 cost time: 0.9233145713806152
Epoch: 38, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.277 Vali Acc: 0.867 Test Loss: 0.277 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 39 cost time: 0.9986052513122559
Epoch: 39, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 0.9030818939208984
Epoch: 40, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1093876361846924
Epoch: 41, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0997250080108643
Epoch: 42, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.9648573398590088
Epoch: 43, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.268 Vali Acc: 0.867 Test Loss: 0.268 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.946474552154541
Epoch: 44, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.266 Vali Acc: 0.867 Test Loss: 0.266 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0767781734466553
Epoch: 45, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1726524829864502
Epoch: 46, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 47 cost time: 0.9933795928955078
Epoch: 47, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9890835285186768
Epoch: 48, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9617984294891357
Epoch: 49, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 50 cost time: 0.9690580368041992
Epoch: 50, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 0.9919478893280029
Epoch: 51, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 52 cost time: 0.9978322982788086
Epoch: 52, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9692187309265137
Epoch: 53, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9875931739807129
Epoch: 54, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.264 Vali Acc: 0.883 Test Loss: 0.264 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.0377447605133057
Epoch: 55, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9916834831237793
Epoch: 56, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.255 Vali Acc: 0.883 Test Loss: 0.255 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.1003952026367188
Epoch: 57, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.0870623588562012
Epoch: 58, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.9790029525756836
Epoch: 59, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.273 Vali Acc: 0.872 Test Loss: 0.273 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.0325744152069092
Epoch: 60, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.9934046268463135
Epoch: 61, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.243 Vali Acc: 0.872 Test Loss: 0.243 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 20278
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0424294471740723
Epoch: 1, Steps: 12 | Train Loss: 1.992 Vali Loss: 1.854 Vali Acc: 0.211 Test Loss: 1.854 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.9460458755493164
Epoch: 2, Steps: 12 | Train Loss: 1.780 Vali Loss: 1.614 Vali Acc: 0.339 Test Loss: 1.614 Test Acc: 0.339
Validation loss decreased (-0.211093 --> -0.338873).  Saving model ...
Epoch: 3 cost time: 1.050844669342041
Epoch: 3, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.370 Vali Acc: 0.550 Test Loss: 1.370 Test Acc: 0.550
Validation loss decreased (-0.338873 --> -0.549986).  Saving model ...
Epoch: 4 cost time: 0.9489884376525879
Epoch: 4, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.162 Vali Acc: 0.678 Test Loss: 1.162 Test Acc: 0.678
Validation loss decreased (-0.549986 --> -0.677766).  Saving model ...
Epoch: 5 cost time: 0.9235548973083496
Epoch: 5, Steps: 12 | Train Loss: 1.072 Vali Loss: 0.985 Vali Acc: 0.722 Test Loss: 0.985 Test Acc: 0.722
Validation loss decreased (-0.677766 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 0.99127197265625
Epoch: 6, Steps: 12 | Train Loss: 0.903 Vali Loss: 0.848 Vali Acc: 0.700 Test Loss: 0.848 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9585039615631104
Epoch: 7, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.747 Vali Acc: 0.744 Test Loss: 0.747 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744437).  Saving model ...
Epoch: 8 cost time: 0.9709162712097168
Epoch: 8, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.671 Vali Acc: 0.717 Test Loss: 0.671 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.013129472732544
Epoch: 9, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.608 Vali Acc: 0.767 Test Loss: 0.608 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 0.8814380168914795
Epoch: 10, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.562 Vali Acc: 0.756 Test Loss: 0.562 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9705314636230469
Epoch: 11, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.526 Vali Acc: 0.767 Test Loss: 0.526 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766661).  Saving model ...
Epoch: 12 cost time: 0.9843308925628662
Epoch: 12, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.499 Vali Acc: 0.756 Test Loss: 0.499 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0771639347076416
Epoch: 13, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.483 Vali Acc: 0.767 Test Loss: 0.483 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766662).  Saving model ...
Epoch: 14 cost time: 0.9436419010162354
Epoch: 14, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.460 Vali Acc: 0.783 Test Loss: 0.460 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783329).  Saving model ...
Epoch: 15 cost time: 0.9683341979980469
Epoch: 15, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.438 Vali Acc: 0.789 Test Loss: 0.438 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 16 cost time: 1.0242764949798584
Epoch: 16, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.421 Vali Acc: 0.806 Test Loss: 0.421 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 0.9874312877655029
Epoch: 17, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.408 Vali Acc: 0.794 Test Loss: 0.408 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.176802158355713
Epoch: 18, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.398 Vali Acc: 0.800 Test Loss: 0.398 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.146458387374878
Epoch: 19, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.389 Vali Acc: 0.817 Test Loss: 0.389 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 20 cost time: 0.9255325794219971
Epoch: 20, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.386 Vali Acc: 0.817 Test Loss: 0.386 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 21 cost time: 1.0077450275421143
Epoch: 21, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 0.9745759963989258
Epoch: 22, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.357 Vali Acc: 0.828 Test Loss: 0.357 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9562385082244873
Epoch: 23, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.342 Vali Acc: 0.856 Test Loss: 0.342 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 24 cost time: 1.0204124450683594
Epoch: 24, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9747154712677002
Epoch: 25, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.335 Vali Acc: 0.844 Test Loss: 0.335 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0803916454315186
Epoch: 26, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.324 Vali Acc: 0.844 Test Loss: 0.324 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9952864646911621
Epoch: 27, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 28 cost time: 0.9416441917419434
Epoch: 28, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.319 Vali Acc: 0.828 Test Loss: 0.319 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8769237995147705
Epoch: 29, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 30 cost time: 0.9156155586242676
Epoch: 30, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.303 Vali Acc: 0.856 Test Loss: 0.303 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8896312713623047
Epoch: 31, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0490999221801758
Epoch: 32, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0296108722686768
Epoch: 33, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9534893035888672
Epoch: 34, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0027565956115723
Epoch: 35, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.282 Vali Acc: 0.861 Test Loss: 0.282 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8713641166687012
Epoch: 36, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.284 Vali Acc: 0.839 Test Loss: 0.284 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9131970405578613
Epoch: 37, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 38 cost time: 1.0204076766967773
Epoch: 38, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.273 Vali Acc: 0.861 Test Loss: 0.273 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9863102436065674
Epoch: 39, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 40 cost time: 0.9103055000305176
Epoch: 40, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.268 Vali Acc: 0.872 Test Loss: 0.268 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8971741199493408
Epoch: 41, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.266 Vali Acc: 0.872 Test Loss: 0.266 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7986488342285156
Epoch: 42, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.9398279190063477
Epoch: 43, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.266 Vali Acc: 0.850 Test Loss: 0.266 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8824481964111328
Epoch: 44, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.262 Vali Acc: 0.872 Test Loss: 0.262 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9155457019805908
Epoch: 45, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8669264316558838
Epoch: 46, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.255 Vali Acc: 0.872 Test Loss: 0.255 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9670393466949463
Epoch: 47, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.263 Vali Acc: 0.867 Test Loss: 0.263 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9455423355102539
Epoch: 48, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.256 Vali Acc: 0.878 Test Loss: 0.256 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.8792352676391602
Epoch: 49, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.255 Vali Acc: 0.872 Test Loss: 0.255 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.9629309177398682
Epoch: 50, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.249 Vali Acc: 0.894 Test Loss: 0.249 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 51 cost time: 0.9317963123321533
Epoch: 51, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 52 cost time: 0.9601268768310547
Epoch: 52, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.257 Vali Acc: 0.856 Test Loss: 0.257 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.041203498840332
Epoch: 53, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9677109718322754
Epoch: 54, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.255 Vali Acc: 0.872 Test Loss: 0.255 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9919097423553467
Epoch: 55, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.249 Vali Acc: 0.883 Test Loss: 0.249 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9085948467254639
Epoch: 56, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.245 Vali Acc: 0.883 Test Loss: 0.245 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.9328954219818115
Epoch: 57, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.238 Vali Acc: 0.883 Test Loss: 0.238 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.9168689250946045
Epoch: 58, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.277 Vali Acc: 0.856 Test Loss: 0.277 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.8787412643432617
Epoch: 59, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.260 Vali Acc: 0.867 Test Loss: 0.260 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.892852783203125
Epoch: 60, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.255 Vali Acc: 0.878 Test Loss: 0.255 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.9495103359222412
Epoch: 61, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.241 Vali Acc: 0.883 Test Loss: 0.241 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 20278
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.864757537841797
Epoch: 1, Steps: 12 | Train Loss: 1.960 Vali Loss: 1.852 Vali Acc: 0.172 Test Loss: 1.852 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 1.0346646308898926
Epoch: 2, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.623 Vali Acc: 0.361 Test Loss: 1.623 Test Acc: 0.361
Validation loss decreased (-0.172204 --> -0.361095).  Saving model ...
Epoch: 3 cost time: 1.0275683403015137
Epoch: 3, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.385 Vali Acc: 0.544 Test Loss: 1.385 Test Acc: 0.544
Validation loss decreased (-0.361095 --> -0.544431).  Saving model ...
Epoch: 4 cost time: 0.91599440574646
Epoch: 4, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.176 Vali Acc: 0.706 Test Loss: 1.176 Test Acc: 0.706
Validation loss decreased (-0.544431 --> -0.705544).  Saving model ...
Epoch: 5 cost time: 0.9071590900421143
Epoch: 5, Steps: 12 | Train Loss: 1.063 Vali Loss: 0.996 Vali Acc: 0.717 Test Loss: 0.996 Test Acc: 0.717
Validation loss decreased (-0.705544 --> -0.716657).  Saving model ...
Epoch: 6 cost time: 0.8584744930267334
Epoch: 6, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.854 Vali Acc: 0.711 Test Loss: 0.854 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.888535737991333
Epoch: 7, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.750 Vali Acc: 0.717 Test Loss: 0.750 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716659).  Saving model ...
Epoch: 8 cost time: 0.8603813648223877
Epoch: 8, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.675 Vali Acc: 0.711 Test Loss: 0.675 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.94698166847229
Epoch: 9, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.612 Vali Acc: 0.756 Test Loss: 0.612 Test Acc: 0.756
Validation loss decreased (-0.716659 --> -0.755549).  Saving model ...
Epoch: 10 cost time: 0.9317278861999512
Epoch: 10, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.566 Vali Acc: 0.739 Test Loss: 0.566 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9766356945037842
Epoch: 11, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.528 Vali Acc: 0.750 Test Loss: 0.528 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9710032939910889
Epoch: 12, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.501 Vali Acc: 0.761 Test Loss: 0.501 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761106).  Saving model ...
Epoch: 13 cost time: 0.8835227489471436
Epoch: 13, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.481 Vali Acc: 0.789 Test Loss: 0.481 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788884).  Saving model ...
Epoch: 14 cost time: 0.9204051494598389
Epoch: 14, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.462 Vali Acc: 0.778 Test Loss: 0.462 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8364744186401367
Epoch: 15, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.440 Vali Acc: 0.794 Test Loss: 0.440 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 16 cost time: 0.9022941589355469
Epoch: 16, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.424 Vali Acc: 0.789 Test Loss: 0.424 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9230999946594238
Epoch: 17, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.409 Vali Acc: 0.800 Test Loss: 0.409 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 18 cost time: 0.9300453662872314
Epoch: 18, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.402 Vali Acc: 0.817 Test Loss: 0.402 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 19 cost time: 0.8865923881530762
Epoch: 19, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 20 cost time: 0.8981757164001465
Epoch: 20, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.393 Vali Acc: 0.806 Test Loss: 0.393 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8573145866394043
Epoch: 21, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.375 Vali Acc: 0.833 Test Loss: 0.375 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 0.8844239711761475
Epoch: 22, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9570879936218262
Epoch: 23, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.348 Vali Acc: 0.811 Test Loss: 0.348 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.987403392791748
Epoch: 24, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.347 Vali Acc: 0.828 Test Loss: 0.347 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8833529949188232
Epoch: 25, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.339 Vali Acc: 0.844 Test Loss: 0.339 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 26 cost time: 0.9319615364074707
Epoch: 26, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8666038513183594
Epoch: 27, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 28 cost time: 0.9565157890319824
Epoch: 28, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.320 Vali Acc: 0.867 Test Loss: 0.320 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866663).  Saving model ...
Epoch: 29 cost time: 0.8732693195343018
Epoch: 29, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9433941841125488
Epoch: 30, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9052238464355469
Epoch: 31, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 32 cost time: 0.9846162796020508
Epoch: 32, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8302175998687744
Epoch: 33, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9222633838653564
Epoch: 34, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8914492130279541
Epoch: 35, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.279 Vali Acc: 0.844 Test Loss: 0.279 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8162846565246582
Epoch: 36, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.273 Vali Acc: 0.867 Test Loss: 0.273 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8923285007476807
Epoch: 37, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.270 Vali Acc: 0.861 Test Loss: 0.270 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9515132904052734
Epoch: 38, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.260 Vali Acc: 0.872 Test Loss: 0.260 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9120349884033203
Epoch: 39, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.252 Vali Acc: 0.867 Test Loss: 0.252 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8741888999938965
Epoch: 40, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.254 Vali Acc: 0.861 Test Loss: 0.254 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8677201271057129
Epoch: 41, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.254 Vali Acc: 0.878 Test Loss: 0.254 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 42 cost time: 0.8990442752838135
Epoch: 42, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.249 Vali Acc: 0.883 Test Loss: 0.249 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 43 cost time: 0.9142160415649414
Epoch: 43, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.256 Vali Acc: 0.872 Test Loss: 0.256 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8855850696563721
Epoch: 44, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.249 Vali Acc: 0.872 Test Loss: 0.249 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.929518461227417
Epoch: 45, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0494046211242676
Epoch: 46, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.239 Vali Acc: 0.878 Test Loss: 0.239 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.952507495880127
Epoch: 47, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.249 Vali Acc: 0.872 Test Loss: 0.249 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8677411079406738
Epoch: 48, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.239 Vali Acc: 0.883 Test Loss: 0.239 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 49 cost time: 0.878206729888916
Epoch: 49, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.236 Vali Acc: 0.889 Test Loss: 0.236 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888887).  Saving model ...
Epoch: 50 cost time: 0.9172544479370117
Epoch: 50, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.241 Vali Acc: 0.883 Test Loss: 0.241 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8681132793426514
Epoch: 51, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
Validation loss decreased (-0.888887 --> -0.905553).  Saving model ...
Epoch: 52 cost time: 0.899277925491333
Epoch: 52, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.239 Vali Acc: 0.872 Test Loss: 0.239 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9724619388580322
Epoch: 53, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9513041973114014
Epoch: 54, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.239 Vali Acc: 0.883 Test Loss: 0.239 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9483106136322021
Epoch: 55, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.229 Vali Acc: 0.883 Test Loss: 0.229 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.8579339981079102
Epoch: 56, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.232 Vali Acc: 0.883 Test Loss: 0.232 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.958397626876831
Epoch: 57, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.225 Vali Acc: 0.894 Test Loss: 0.225 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.020261287689209
Epoch: 58, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.249 Vali Acc: 0.883 Test Loss: 0.249 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.8678617477416992
Epoch: 59, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.237 Vali Acc: 0.894 Test Loss: 0.237 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.9894876480102539
Epoch: 60, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.250 Vali Acc: 0.872 Test Loss: 0.250 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.9510762691497803
Epoch: 61, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 20278
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9226043224334717
Epoch: 1, Steps: 12 | Train Loss: 1.885 Vali Loss: 1.806 Vali Acc: 0.206 Test Loss: 1.806 Test Acc: 0.206
Validation loss decreased (inf --> -0.205537).  Saving model ...
Epoch: 2 cost time: 0.9577553272247314
Epoch: 2, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.615 Vali Acc: 0.378 Test Loss: 1.615 Test Acc: 0.378
Validation loss decreased (-0.205537 --> -0.377762).  Saving model ...
Epoch: 3 cost time: 0.9656670093536377
Epoch: 3, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.403 Vali Acc: 0.489 Test Loss: 1.403 Test Acc: 0.489
Validation loss decreased (-0.377762 --> -0.488875).  Saving model ...
Epoch: 4 cost time: 0.9779708385467529
Epoch: 4, Steps: 12 | Train Loss: 1.299 Vali Loss: 1.209 Vali Acc: 0.622 Test Loss: 1.209 Test Acc: 0.622
Validation loss decreased (-0.488875 --> -0.622210).  Saving model ...
Epoch: 5 cost time: 0.988971471786499
Epoch: 5, Steps: 12 | Train Loss: 1.074 Vali Loss: 1.035 Vali Acc: 0.683 Test Loss: 1.035 Test Acc: 0.683
Validation loss decreased (-0.622210 --> -0.683323).  Saving model ...
Epoch: 6 cost time: 0.9719257354736328
Epoch: 6, Steps: 12 | Train Loss: 0.911 Vali Loss: 0.897 Vali Acc: 0.689 Test Loss: 0.897 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688880).  Saving model ...
Epoch: 7 cost time: 0.8134133815765381
Epoch: 7, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.793 Vali Acc: 0.722 Test Loss: 0.793 Test Acc: 0.722
Validation loss decreased (-0.688880 --> -0.722214).  Saving model ...
Epoch: 8 cost time: 0.9386019706726074
Epoch: 8, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.716 Vali Acc: 0.706 Test Loss: 0.716 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9667749404907227
Epoch: 9, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.650 Vali Acc: 0.733 Test Loss: 0.650 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733327).  Saving model ...
Epoch: 10 cost time: 0.8870227336883545
Epoch: 10, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.601 Vali Acc: 0.739 Test Loss: 0.601 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738883).  Saving model ...
Epoch: 11 cost time: 0.86000657081604
Epoch: 11, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.558 Vali Acc: 0.778 Test Loss: 0.558 Test Acc: 0.778
Validation loss decreased (-0.738883 --> -0.777772).  Saving model ...
Epoch: 12 cost time: 0.9388363361358643
Epoch: 12, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783328).  Saving model ...
Epoch: 13 cost time: 0.9716935157775879
Epoch: 13, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.508 Vali Acc: 0.817 Test Loss: 0.508 Test Acc: 0.817
Validation loss decreased (-0.783328 --> -0.816662).  Saving model ...
Epoch: 14 cost time: 0.9830889701843262
Epoch: 14, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.502 Vali Acc: 0.778 Test Loss: 0.502 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9617271423339844
Epoch: 15, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.484 Vali Acc: 0.778 Test Loss: 0.484 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0461235046386719
Epoch: 16, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.466 Vali Acc: 0.800 Test Loss: 0.466 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0499944686889648
Epoch: 17, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.450 Vali Acc: 0.789 Test Loss: 0.450 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9650876522064209
Epoch: 18, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.443 Vali Acc: 0.772 Test Loss: 0.443 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8800349235534668
Epoch: 19, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.432 Vali Acc: 0.806 Test Loss: 0.432 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9764022827148438
Epoch: 20, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.430 Vali Acc: 0.806 Test Loss: 0.430 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8406398296356201
Epoch: 21, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.412 Vali Acc: 0.800 Test Loss: 0.412 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8885776996612549
Epoch: 22, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.398 Vali Acc: 0.817 Test Loss: 0.398 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 23 cost time: 0.8872451782226562
Epoch: 23, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.388 Vali Acc: 0.811 Test Loss: 0.388 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9089043140411377
Epoch: 24, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.386 Vali Acc: 0.800 Test Loss: 0.386 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.834113597869873
Epoch: 25, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 26 cost time: 0.8745806217193604
Epoch: 26, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 27 cost time: 0.7948307991027832
Epoch: 27, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.368 Vali Acc: 0.844 Test Loss: 0.368 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 28 cost time: 0.8249671459197998
Epoch: 28, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8688516616821289
Epoch: 29, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.350 Vali Acc: 0.844 Test Loss: 0.350 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 30 cost time: 0.8883857727050781
Epoch: 30, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.827502965927124
Epoch: 31, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.338 Vali Acc: 0.844 Test Loss: 0.338 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 32 cost time: 0.9459357261657715
Epoch: 32, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.336 Vali Acc: 0.828 Test Loss: 0.336 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9940185546875
Epoch: 33, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.332 Vali Acc: 0.833 Test Loss: 0.332 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9305238723754883
Epoch: 34, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.339 Vali Acc: 0.817 Test Loss: 0.339 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8884069919586182
Epoch: 35, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.327 Vali Acc: 0.822 Test Loss: 0.327 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9551143646240234
Epoch: 36, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9131293296813965
Epoch: 37, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.324 Vali Acc: 0.839 Test Loss: 0.324 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9820597171783447
Epoch: 38, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.315 Vali Acc: 0.856 Test Loss: 0.315 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 39 cost time: 0.9310648441314697
Epoch: 39, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 40 cost time: 0.9472103118896484
Epoch: 40, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8686938285827637
Epoch: 41, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9105758666992188
Epoch: 42, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9835782051086426
Epoch: 43, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9138813018798828
Epoch: 44, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9124469757080078
Epoch: 45, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0191116333007812
Epoch: 46, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.0065743923187256
Epoch: 47, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9430301189422607
Epoch: 48, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 49 cost time: 1.0085406303405762
Epoch: 49, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9318346977233887
Epoch: 50, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.862647294998169
Epoch: 51, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 52 cost time: 1.0077786445617676
Epoch: 52, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9889497756958008
Epoch: 53, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9868037700653076
Epoch: 54, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.89349365234375
Epoch: 55, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9580717086791992
Epoch: 56, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.9706358909606934
Epoch: 57, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.0113928318023682
Epoch: 58, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.8833978176116943
Epoch: 59, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.8099257946014404
Epoch: 60, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.319 Vali Acc: 0.856 Test Loss: 0.319 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.8793530464172363
Epoch: 61, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 62 cost time: 0.931354284286499
Epoch: 62, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9348785877227783
Epoch: 63, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.9323318004608154
Epoch: 64, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.8915431499481201
Epoch: 65, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.9318337440490723
Epoch: 66, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.9417517185211182
Epoch: 67, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.298 Vali Acc: 0.878 Test Loss: 0.298 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.9114503860473633
Epoch: 68, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.9927897453308105
Epoch: 69, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.9615719318389893
Epoch: 70, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.9707486629486084
Epoch: 71, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ETSformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 20278
model size : 0.70MB
