Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5958008766174316
Epoch: 1, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5815105438232422
Epoch: 2, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5532557964324951
Epoch: 3, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5442907810211182
Epoch: 4, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6331014633178711
Epoch: 5, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5406649112701416
Epoch: 6, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5098757743835449
Epoch: 7, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.299 Vali Acc: 0.267 Test Loss: 1.299 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5312495231628418
Epoch: 8, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.330 Vali Acc: 0.200 Test Loss: 1.330 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.582740068435669
Epoch: 9, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.416 Vali Acc: 0.267 Test Loss: 1.416 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5577418804168701
Epoch: 10, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.541 Vali Acc: 0.400 Test Loss: 1.541 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399985).  Saving model ...
Epoch: 11 cost time: 0.543062686920166
Epoch: 11, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.742 Vali Acc: 0.333 Test Loss: 1.742 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.556114673614502
Epoch: 12, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.966 Vali Acc: 0.267 Test Loss: 1.966 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5341007709503174
Epoch: 13, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.189 Vali Acc: 0.333 Test Loss: 2.189 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5109856128692627
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.388 Vali Acc: 0.333 Test Loss: 2.388 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.529618501663208
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.583 Vali Acc: 0.333 Test Loss: 2.583 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5341587066650391
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.778 Vali Acc: 0.333 Test Loss: 2.778 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5250427722930908
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.955 Vali Acc: 0.333 Test Loss: 2.955 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5744504928588867
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.129 Vali Acc: 0.333 Test Loss: 3.129 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5023906230926514
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.282 Vali Acc: 0.333 Test Loss: 3.282 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5525772571563721
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.440 Vali Acc: 0.333 Test Loss: 3.440 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6243379
model size : 33.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4265217781066895
Epoch: 1, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.555354118347168
Epoch: 2, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.612968921661377
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5766348838806152
Epoch: 4, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6019153594970703
Epoch: 5, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7267165184020996
Epoch: 6, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.304 Vali Acc: 0.267 Test Loss: 1.304 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5943019390106201
Epoch: 7, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.325 Vali Acc: 0.267 Test Loss: 1.325 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6118409633636475
Epoch: 8, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.346 Vali Acc: 0.267 Test Loss: 1.346 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6037561893463135
Epoch: 9, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.413 Vali Acc: 0.400 Test Loss: 1.413 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 0.6035277843475342
Epoch: 10, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.491 Vali Acc: 0.400 Test Loss: 1.491 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6082041263580322
Epoch: 11, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.641 Vali Acc: 0.400 Test Loss: 1.641 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6347630023956299
Epoch: 12, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.787 Vali Acc: 0.400 Test Loss: 1.787 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6352794170379639
Epoch: 13, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.932 Vali Acc: 0.400 Test Loss: 1.932 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6785848140716553
Epoch: 14, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.072 Vali Acc: 0.400 Test Loss: 2.072 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6101272106170654
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.220 Vali Acc: 0.400 Test Loss: 2.220 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6931741237640381
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.365 Vali Acc: 0.400 Test Loss: 2.365 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6535131931304932
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.509 Vali Acc: 0.400 Test Loss: 2.509 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7387323379516602
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.640 Vali Acc: 0.400 Test Loss: 2.640 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6583535671234131
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.774 Vali Acc: 0.400 Test Loss: 2.774 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6243379
model size : 33.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3867886066436768
Epoch: 1, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5286779403686523
Epoch: 2, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.58868408203125
Epoch: 3, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5980408191680908
Epoch: 4, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5737237930297852
Epoch: 5, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6018555164337158
Epoch: 6, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.237 Vali Acc: 0.267 Test Loss: 1.237 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5366270542144775
Epoch: 7, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5903172492980957
Epoch: 8, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.253 Vali Acc: 0.467 Test Loss: 1.253 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466654).  Saving model ...
Epoch: 9 cost time: 0.643883466720581
Epoch: 9, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.341 Vali Acc: 0.400 Test Loss: 1.341 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5885155200958252
Epoch: 10, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.404 Vali Acc: 0.400 Test Loss: 1.404 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5128843784332275
Epoch: 11, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.453 Vali Acc: 0.467 Test Loss: 1.453 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5791335105895996
Epoch: 12, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.552 Vali Acc: 0.467 Test Loss: 1.552 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5943663120269775
Epoch: 13, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.714 Vali Acc: 0.333 Test Loss: 1.714 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6026661396026611
Epoch: 14, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.860 Vali Acc: 0.400 Test Loss: 1.860 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6180641651153564
Epoch: 15, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.989 Vali Acc: 0.400 Test Loss: 1.989 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.575965166091919
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.114 Vali Acc: 0.533 Test Loss: 2.114 Test Acc: 0.533
Validation loss decreased (-0.466654 --> -0.533312).  Saving model ...
Epoch: 17 cost time: 0.6786439418792725
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.237 Vali Acc: 0.533 Test Loss: 2.237 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6509759426116943
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.345 Vali Acc: 0.533 Test Loss: 2.345 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.630681037902832
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.462 Vali Acc: 0.533 Test Loss: 2.462 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5966079235076904
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.563 Vali Acc: 0.467 Test Loss: 2.563 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5877079963684082
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.669 Vali Acc: 0.400 Test Loss: 2.669 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6132862567901611
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.765 Vali Acc: 0.400 Test Loss: 2.765 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6664786338806152
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.858 Vali Acc: 0.400 Test Loss: 2.858 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6205620765686035
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.945 Vali Acc: 0.400 Test Loss: 2.945 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6829097270965576
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.038 Vali Acc: 0.400 Test Loss: 3.038 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6581294536590576
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.114 Vali Acc: 0.400 Test Loss: 3.114 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6243379
model size : 33.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.617741584777832
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.6190402507781982
Epoch: 2, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.595165491104126
Epoch: 3, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6115820407867432
Epoch: 4, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.6591346263885498
Epoch: 5, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.6076083183288574
Epoch: 6, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6272006034851074
Epoch: 7, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6192150115966797
Epoch: 8, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6143529415130615
Epoch: 9, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5806629657745361
Epoch: 10, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.325 Vali Acc: 0.333 Test Loss: 1.325 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6371331214904785
Epoch: 11, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.322 Vali Acc: 0.333 Test Loss: 1.322 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6894972324371338
Epoch: 12, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.406 Vali Acc: 0.333 Test Loss: 1.406 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.640049934387207
Epoch: 13, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.618 Vali Acc: 0.333 Test Loss: 1.618 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6218831539154053
Epoch: 14, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.676 Vali Acc: 0.333 Test Loss: 1.676 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6183717250823975
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.707 Vali Acc: 0.267 Test Loss: 1.707 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6243379
model size : 33.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.280594825744629
Epoch: 1, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5447578430175781
Epoch: 2, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.558725118637085
Epoch: 3, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.574857234954834
Epoch: 4, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.6119976043701172
Epoch: 5, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4788057804107666
Epoch: 6, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5638206005096436
Epoch: 7, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.281 Vali Acc: 0.400 Test Loss: 1.281 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5396363735198975
Epoch: 8, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.396 Vali Acc: 0.400 Test Loss: 1.396 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5841996669769287
Epoch: 9, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.503 Vali Acc: 0.400 Test Loss: 1.503 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6259117126464844
Epoch: 10, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.724 Vali Acc: 0.400 Test Loss: 1.724 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5733137130737305
Epoch: 11, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.930 Vali Acc: 0.400 Test Loss: 1.930 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.593336820602417
Epoch: 12, Steps: 1 | Train Loss: 0.011 Vali Loss: 2.100 Vali Acc: 0.400 Test Loss: 2.100 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6016185283660889
Epoch: 13, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.303 Vali Acc: 0.333 Test Loss: 2.303 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6205441951751709
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.521 Vali Acc: 0.400 Test Loss: 2.521 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4146227
model size : 25.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.541048526763916
Epoch: 1, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6321134567260742
Epoch: 2, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6195070743560791
Epoch: 3, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5806810855865479
Epoch: 4, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6498374938964844
Epoch: 5, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5875558853149414
Epoch: 6, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6164026260375977
Epoch: 7, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.5921661853790283
Epoch: 8, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.297 Vali Acc: 0.333 Test Loss: 1.297 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5889804363250732
Epoch: 9, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.325 Vali Acc: 0.333 Test Loss: 1.325 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5947065353393555
Epoch: 10, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.425 Vali Acc: 0.400 Test Loss: 1.425 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5662682056427002
Epoch: 11, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.625 Vali Acc: 0.467 Test Loss: 1.625 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466650).  Saving model ...
Epoch: 12 cost time: 0.629647970199585
Epoch: 12, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.769 Vali Acc: 0.467 Test Loss: 1.769 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5955026149749756
Epoch: 13, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.933 Vali Acc: 0.333 Test Loss: 1.933 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6799378395080566
Epoch: 14, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.101 Vali Acc: 0.400 Test Loss: 2.101 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5706875324249268
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.261 Vali Acc: 0.400 Test Loss: 2.261 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6391911506652832
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.417 Vali Acc: 0.467 Test Loss: 2.417 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6320972442626953
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.567 Vali Acc: 0.467 Test Loss: 2.567 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6072614192962646
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.711 Vali Acc: 0.467 Test Loss: 2.711 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6088829040527344
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.854 Vali Acc: 0.467 Test Loss: 2.854 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6936430931091309
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.988 Vali Acc: 0.467 Test Loss: 2.988 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7093105316162109
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.117 Vali Acc: 0.467 Test Loss: 3.117 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4146227
model size : 25.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.18802547454834
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.116 Vali Acc: 0.067 Test Loss: 1.116 Test Acc: 0.067
Validation loss decreased (inf --> -0.066656).  Saving model ...
Epoch: 2 cost time: 0.6025114059448242
Epoch: 2, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.112 Vali Acc: 0.133 Test Loss: 1.112 Test Acc: 0.133
Validation loss decreased (-0.066656 --> -0.133322).  Saving model ...
Epoch: 3 cost time: 0.5517652034759521
Epoch: 3, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.595911979675293
Epoch: 4, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5628807544708252
Epoch: 5, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5249464511871338
Epoch: 6, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5506894588470459
Epoch: 7, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5002624988555908
Epoch: 8, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5398364067077637
Epoch: 9, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4837675094604492
Epoch: 10, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.345 Vali Acc: 0.400 Test Loss: 1.345 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5563163757324219
Epoch: 11, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.458 Vali Acc: 0.333 Test Loss: 1.458 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5677173137664795
Epoch: 12, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.549 Vali Acc: 0.400 Test Loss: 1.549 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5939862728118896
Epoch: 13, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.689 Vali Acc: 0.400 Test Loss: 1.689 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5766489505767822
Epoch: 14, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.849 Vali Acc: 0.467 Test Loss: 1.849 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4146227
model size : 25.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5758142471313477
Epoch: 1, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6197764873504639
Epoch: 2, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6017427444458008
Epoch: 3, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6585097312927246
Epoch: 4, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6033608913421631
Epoch: 5, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5644814968109131
Epoch: 6, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5385751724243164
Epoch: 7, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.546846866607666
Epoch: 8, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.521136999130249
Epoch: 9, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.562751054763794
Epoch: 10, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5681929588317871
Epoch: 11, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.329 Vali Acc: 0.333 Test Loss: 1.329 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.561500072479248
Epoch: 12, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.420 Vali Acc: 0.267 Test Loss: 1.420 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4146227
model size : 25.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.524914264678955
Epoch: 1, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
Validation loss decreased (inf --> -0.466657).  Saving model ...
Epoch: 2 cost time: 0.6428496837615967
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 3 cost time: 0.6308403015136719
Epoch: 3, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.017 Vali Acc: 0.600 Test Loss: 1.017 Test Acc: 0.600
Validation loss decreased (-0.466657 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.6096012592315674
Epoch: 4, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.042 Vali Acc: 0.333 Test Loss: 1.042 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6135404109954834
Epoch: 5, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6488656997680664
Epoch: 6, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6837399005889893
Epoch: 7, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6488564014434814
Epoch: 8, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.670189380645752
Epoch: 9, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.415 Vali Acc: 0.400 Test Loss: 1.415 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.602834939956665
Epoch: 10, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.565 Vali Acc: 0.333 Test Loss: 1.565 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5621066093444824
Epoch: 11, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.637 Vali Acc: 0.400 Test Loss: 1.637 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6159143447875977
Epoch: 12, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.721 Vali Acc: 0.333 Test Loss: 1.721 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5912196636199951
Epoch: 13, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.850 Vali Acc: 0.400 Test Loss: 1.850 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 3097651
model size : 21.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.319300413131714
Epoch: 1, Steps: 1 | Train Loss: 1.159 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.5775182247161865
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 0.996 Vali Acc: 0.600 Test Loss: 0.996 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.5438852310180664
Epoch: 3, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.010 Vali Acc: 0.400 Test Loss: 1.010 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5481595993041992
Epoch: 4, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.026 Vali Acc: 0.333 Test Loss: 1.026 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5371711254119873
Epoch: 5, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.034 Vali Acc: 0.333 Test Loss: 1.034 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5548474788665771
Epoch: 6, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.039 Vali Acc: 0.333 Test Loss: 1.039 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6019871234893799
Epoch: 7, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5475966930389404
Epoch: 8, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5761978626251221
Epoch: 9, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.274 Vali Acc: 0.400 Test Loss: 1.274 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5241975784301758
Epoch: 10, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.329 Vali Acc: 0.467 Test Loss: 1.329 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5464737415313721
Epoch: 11, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.412 Vali Acc: 0.400 Test Loss: 1.412 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5522308349609375
Epoch: 12, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.519 Vali Acc: 0.400 Test Loss: 1.519 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 3097651
model size : 21.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2714600563049316
Epoch: 1, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
Validation loss decreased (inf --> -0.466657).  Saving model ...
Epoch: 2 cost time: 0.6103222370147705
Epoch: 2, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5320103168487549
Epoch: 3, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5234944820404053
Epoch: 4, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5823180675506592
Epoch: 5, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5218780040740967
Epoch: 6, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5493090152740479
Epoch: 7, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5971918106079102
Epoch: 8, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5540964603424072
Epoch: 9, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5453414916992188
Epoch: 10, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.259 Vali Acc: 0.400 Test Loss: 1.259 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5824265480041504
Epoch: 11, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.310 Vali Acc: 0.333 Test Loss: 1.310 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3097651
model size : 21.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.222320556640625
Epoch: 1, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.5453310012817383
Epoch: 2, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5111048221588135
Epoch: 3, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.612945556640625
Epoch: 4, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5680263042449951
Epoch: 5, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5472257137298584
Epoch: 6, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5226976871490479
Epoch: 7, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5156986713409424
Epoch: 8, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5049018859863281
Epoch: 9, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4728434085845947
Epoch: 10, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5268096923828125
Epoch: 11, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 3097651
model size : 21.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2644786834716797
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5426981449127197
Epoch: 2, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5735466480255127
Epoch: 3, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5290515422821045
Epoch: 4, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5660088062286377
Epoch: 5, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5593736171722412
Epoch: 6, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.269 Vali Acc: 0.200 Test Loss: 1.269 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.557960033416748
Epoch: 7, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.323 Vali Acc: 0.333 Test Loss: 1.323 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5941131114959717
Epoch: 8, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.357 Vali Acc: 0.200 Test Loss: 1.357 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6420798301696777
Epoch: 9, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.456 Vali Acc: 0.200 Test Loss: 1.456 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6028482913970947
Epoch: 10, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.636 Vali Acc: 0.333 Test Loss: 1.636 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6273674964904785
Epoch: 11, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.932 Vali Acc: 0.400 Test Loss: 1.932 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399981).  Saving model ...
Epoch: 12 cost time: 0.6003537178039551
Epoch: 12, Steps: 1 | Train Loss: 0.017 Vali Loss: 2.107 Vali Acc: 0.400 Test Loss: 2.107 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5902647972106934
Epoch: 13, Steps: 1 | Train Loss: 0.006 Vali Loss: 2.235 Vali Acc: 0.400 Test Loss: 2.235 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6580986976623535
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.365 Vali Acc: 0.400 Test Loss: 2.365 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5733833312988281
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.507 Vali Acc: 0.333 Test Loss: 2.507 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6107969284057617
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.655 Vali Acc: 0.267 Test Loss: 2.655 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6184196472167969
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.811 Vali Acc: 0.267 Test Loss: 2.811 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5670926570892334
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.961 Vali Acc: 0.267 Test Loss: 2.961 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5731902122497559
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.099 Vali Acc: 0.267 Test Loss: 3.099 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6053812503814697
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.238 Vali Acc: 0.267 Test Loss: 3.238 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5673224925994873
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.375 Vali Acc: 0.267 Test Loss: 3.375 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2573363
model size : 19.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3351688385009766
Epoch: 1, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5374934673309326
Epoch: 2, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.185 Vali Acc: 0.133 Test Loss: 1.185 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5500607490539551
Epoch: 3, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.183 Vali Acc: 0.133 Test Loss: 1.183 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5601632595062256
Epoch: 4, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.185 Vali Acc: 0.133 Test Loss: 1.185 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5545103549957275
Epoch: 5, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5697989463806152
Epoch: 6, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5692293643951416
Epoch: 7, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.5673825740814209
Epoch: 8, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.281 Vali Acc: 0.400 Test Loss: 1.281 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.5367438793182373
Epoch: 9, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.344 Vali Acc: 0.200 Test Loss: 1.344 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.502751350402832
Epoch: 10, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.431 Vali Acc: 0.400 Test Loss: 1.431 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5734641551971436
Epoch: 11, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.695 Vali Acc: 0.400 Test Loss: 1.695 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6549813747406006
Epoch: 12, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.829 Vali Acc: 0.467 Test Loss: 1.829 Test Acc: 0.467
Validation loss decreased (-0.399987 --> -0.466648).  Saving model ...
Epoch: 13 cost time: 0.5893557071685791
Epoch: 13, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.886 Vali Acc: 0.400 Test Loss: 1.886 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5608823299407959
Epoch: 14, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.967 Vali Acc: 0.400 Test Loss: 1.967 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5835776329040527
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.081 Vali Acc: 0.267 Test Loss: 2.081 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.601635217666626
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.207 Vali Acc: 0.267 Test Loss: 2.207 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7368433475494385
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.332 Vali Acc: 0.267 Test Loss: 2.332 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5620992183685303
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.267 Test Loss: 2.447 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5396451950073242
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.561 Vali Acc: 0.267 Test Loss: 2.561 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5920233726501465
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.664 Vali Acc: 0.200 Test Loss: 2.664 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5707826614379883
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.758 Vali Acc: 0.200 Test Loss: 2.758 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6664254665374756
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.847 Vali Acc: 0.200 Test Loss: 2.847 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2573363
model size : 19.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.492097854614258
Epoch: 1, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5278584957122803
Epoch: 2, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.553370475769043
Epoch: 3, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5961964130401611
Epoch: 4, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5525012016296387
Epoch: 5, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5696041584014893
Epoch: 6, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5973944664001465
Epoch: 7, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5772705078125
Epoch: 8, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5687198638916016
Epoch: 9, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.254 Vali Acc: 0.200 Test Loss: 1.254 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5414929389953613
Epoch: 10, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.341 Vali Acc: 0.467 Test Loss: 1.341 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466653).  Saving model ...
Epoch: 11 cost time: 0.544020414352417
Epoch: 11, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.552 Vali Acc: 0.400 Test Loss: 1.552 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.603447675704956
Epoch: 12, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.598 Vali Acc: 0.333 Test Loss: 1.598 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6423120498657227
Epoch: 13, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.608 Vali Acc: 0.333 Test Loss: 1.608 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5849695205688477
Epoch: 14, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.706 Vali Acc: 0.333 Test Loss: 1.706 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5423846244812012
Epoch: 15, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.808 Vali Acc: 0.333 Test Loss: 1.808 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6495504379272461
Epoch: 16, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.912 Vali Acc: 0.333 Test Loss: 1.912 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5617938041687012
Epoch: 17, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.027 Vali Acc: 0.333 Test Loss: 2.027 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5839526653289795
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.159 Vali Acc: 0.400 Test Loss: 2.159 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5887494087219238
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.299 Vali Acc: 0.467 Test Loss: 2.299 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6406619548797607
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.444 Vali Acc: 0.533 Test Loss: 2.444 Test Acc: 0.533
Validation loss decreased (-0.466653 --> -0.533309).  Saving model ...
Epoch: 21 cost time: 0.570915937423706
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.591 Vali Acc: 0.533 Test Loss: 2.591 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5786540508270264
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.729 Vali Acc: 0.400 Test Loss: 2.729 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6500527858734131
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.869 Vali Acc: 0.400 Test Loss: 2.869 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5974650382995605
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.006 Vali Acc: 0.400 Test Loss: 3.006 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5675935745239258
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.135 Vali Acc: 0.400 Test Loss: 3.135 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5830190181732178
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.256 Vali Acc: 0.400 Test Loss: 3.256 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5968010425567627
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.374 Vali Acc: 0.400 Test Loss: 3.374 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5315823554992676
Epoch: 28, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.483 Vali Acc: 0.400 Test Loss: 3.483 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5293114185333252
Epoch: 29, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.586 Vali Acc: 0.400 Test Loss: 3.586 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5110306739807129
Epoch: 30, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.682 Vali Acc: 0.400 Test Loss: 3.682 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2573363
model size : 19.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.032503604888916
Epoch: 1, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.49637842178344727
Epoch: 2, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.137 Vali Acc: 0.133 Test Loss: 1.137 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5626261234283447
Epoch: 3, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5108127593994141
Epoch: 4, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5342223644256592
Epoch: 5, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5196917057037354
Epoch: 6, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6288888454437256
Epoch: 7, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5345616340637207
Epoch: 8, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.511871337890625
Epoch: 9, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.211 Vali Acc: 0.200 Test Loss: 1.211 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4839327335357666
Epoch: 10, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5312652587890625
Epoch: 11, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.441 Vali Acc: 0.333 Test Loss: 1.441 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5346865653991699
Epoch: 12, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.448 Vali Acc: 0.333 Test Loss: 1.448 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4975125789642334
Epoch: 13, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.441 Vali Acc: 0.133 Test Loss: 1.441 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.4947090148925781
Epoch: 14, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.552 Vali Acc: 0.133 Test Loss: 1.552 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2573363
model size : 19.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.361130952835083
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.200 Vali Acc: 0.467 Test Loss: 1.200 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.641127347946167
Epoch: 2, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.201 Vali Acc: 0.467 Test Loss: 1.201 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6552619934082031
Epoch: 3, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6298120021820068
Epoch: 4, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.208 Vali Acc: 0.467 Test Loss: 1.208 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5619497299194336
Epoch: 5, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5873904228210449
Epoch: 6, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.285 Vali Acc: 0.200 Test Loss: 1.285 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5631973743438721
Epoch: 7, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.366 Vali Acc: 0.333 Test Loss: 1.366 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.542595386505127
Epoch: 8, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.369 Vali Acc: 0.267 Test Loss: 1.369 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5165975093841553
Epoch: 9, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.434 Vali Acc: 0.267 Test Loss: 1.434 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4661123752593994
Epoch: 10, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.611 Vali Acc: 0.400 Test Loss: 1.611 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5555899143218994
Epoch: 11, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.864 Vali Acc: 0.400 Test Loss: 1.864 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2311219
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.073277711868286
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5640304088592529
Epoch: 2, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.204 Vali Acc: 0.133 Test Loss: 1.204 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5481986999511719
Epoch: 3, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.6227254867553711
Epoch: 4, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6123743057250977
Epoch: 5, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.596515417098999
Epoch: 6, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5988872051239014
Epoch: 7, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.298 Vali Acc: 0.200 Test Loss: 1.298 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6849427223205566
Epoch: 8, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.294 Vali Acc: 0.333 Test Loss: 1.294 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5832135677337646
Epoch: 9, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.333 Vali Acc: 0.267 Test Loss: 1.333 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5899927616119385
Epoch: 10, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.468 Vali Acc: 0.400 Test Loss: 1.468 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399985).  Saving model ...
Epoch: 11 cost time: 0.6242458820343018
Epoch: 11, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.672 Vali Acc: 0.333 Test Loss: 1.672 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5258884429931641
Epoch: 12, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.735 Vali Acc: 0.333 Test Loss: 1.735 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5699610710144043
Epoch: 13, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.822 Vali Acc: 0.400 Test Loss: 1.822 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6458535194396973
Epoch: 14, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.928 Vali Acc: 0.400 Test Loss: 1.928 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6496915817260742
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.040 Vali Acc: 0.400 Test Loss: 2.040 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5568065643310547
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.157 Vali Acc: 0.400 Test Loss: 2.157 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5738232135772705
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.267 Vali Acc: 0.400 Test Loss: 2.267 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6412086486816406
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.378 Vali Acc: 0.400 Test Loss: 2.378 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6229629516601562
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.484 Vali Acc: 0.400 Test Loss: 2.484 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6636192798614502
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.586 Vali Acc: 0.400 Test Loss: 2.586 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2311219
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2142298221588135
Epoch: 1, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.51338791847229
Epoch: 2, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5110495090484619
Epoch: 3, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5440466403961182
Epoch: 4, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.519744873046875
Epoch: 5, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5822594165802002
Epoch: 6, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.229 Vali Acc: 0.200 Test Loss: 1.229 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5705015659332275
Epoch: 7, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5516543388366699
Epoch: 8, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5498616695404053
Epoch: 9, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6662397384643555
Epoch: 10, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.362 Vali Acc: 0.333 Test Loss: 1.362 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5987169742584229
Epoch: 11, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.486 Vali Acc: 0.333 Test Loss: 1.486 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5209357738494873
Epoch: 12, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.519 Vali Acc: 0.400 Test Loss: 1.519 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399985).  Saving model ...
Epoch: 13 cost time: 0.6456325054168701
Epoch: 13, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.602 Vali Acc: 0.400 Test Loss: 1.602 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5817704200744629
Epoch: 14, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.724 Vali Acc: 0.400 Test Loss: 1.724 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5816373825073242
Epoch: 15, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.873 Vali Acc: 0.333 Test Loss: 1.873 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5652852058410645
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.030 Vali Acc: 0.333 Test Loss: 2.030 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5396554470062256
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.184 Vali Acc: 0.400 Test Loss: 2.184 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5637650489807129
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.329 Vali Acc: 0.400 Test Loss: 2.329 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6535336971282959
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.462 Vali Acc: 0.400 Test Loss: 2.462 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6040174961090088
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.589 Vali Acc: 0.400 Test Loss: 2.589 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.57682204246521
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.714 Vali Acc: 0.400 Test Loss: 2.714 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5736007690429688
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.827 Vali Acc: 0.400 Test Loss: 2.827 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2311219
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3084771633148193
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.5913619995117188
Epoch: 2, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (-0.133321 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6041581630706787
Epoch: 3, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5606794357299805
Epoch: 4, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5574512481689453
Epoch: 5, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.5166575908660889
Epoch: 6, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.47607970237731934
Epoch: 7, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.257 Vali Acc: 0.267 Test Loss: 1.257 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5180172920227051
Epoch: 8, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5615901947021484
Epoch: 9, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.46363019943237305
Epoch: 10, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.349 Vali Acc: 0.333 Test Loss: 1.349 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4562995433807373
Epoch: 11, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.383 Vali Acc: 0.333 Test Loss: 1.383 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5370430946350098
Epoch: 12, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.427 Vali Acc: 0.333 Test Loss: 1.427 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5171148777008057
Epoch: 13, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.570 Vali Acc: 0.333 Test Loss: 1.570 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5122506618499756
Epoch: 14, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.628 Vali Acc: 0.333 Test Loss: 1.628 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5108745098114014
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.690 Vali Acc: 0.333 Test Loss: 1.690 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2311219
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.263070821762085
Epoch: 1, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5231387615203857
Epoch: 2, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.137 Vali Acc: 0.067 Test Loss: 1.137 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5621912479400635
Epoch: 3, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5868320465087891
Epoch: 4, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5690388679504395
Epoch: 5, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5956151485443115
Epoch: 6, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5405993461608887
Epoch: 7, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6205501556396484
Epoch: 8, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6107394695281982
Epoch: 9, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.394 Vali Acc: 0.333 Test Loss: 1.394 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6347956657409668
Epoch: 10, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.552 Vali Acc: 0.333 Test Loss: 1.552 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.58500075340271
Epoch: 11, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.654 Vali Acc: 0.333 Test Loss: 1.654 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2180147
model size : 18.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2836172580718994
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.60563063621521
Epoch: 2, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6098415851593018
Epoch: 3, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6599705219268799
Epoch: 4, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.617713212966919
Epoch: 5, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5273270606994629
Epoch: 6, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5275588035583496
Epoch: 7, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.233 Vali Acc: 0.133 Test Loss: 1.233 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.569934606552124
Epoch: 8, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5431065559387207
Epoch: 9, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.367 Vali Acc: 0.200 Test Loss: 1.367 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5711746215820312
Epoch: 10, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.436 Vali Acc: 0.400 Test Loss: 1.436 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 0.5886039733886719
Epoch: 11, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.502 Vali Acc: 0.333 Test Loss: 1.502 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5625038146972656
Epoch: 12, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.614 Vali Acc: 0.333 Test Loss: 1.614 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.652285099029541
Epoch: 13, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.773 Vali Acc: 0.400 Test Loss: 1.773 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6012704372406006
Epoch: 14, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.971 Vali Acc: 0.400 Test Loss: 1.971 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6587486267089844
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.175 Vali Acc: 0.400 Test Loss: 2.175 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6833534240722656
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.378 Vali Acc: 0.400 Test Loss: 2.378 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5754599571228027
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.566 Vali Acc: 0.400 Test Loss: 2.566 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5870997905731201
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.740 Vali Acc: 0.400 Test Loss: 2.740 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5722694396972656
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.903 Vali Acc: 0.400 Test Loss: 2.903 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7466163635253906
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.053 Vali Acc: 0.400 Test Loss: 3.053 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2180147
model size : 18.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1930365562438965
Epoch: 1, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5580434799194336
Epoch: 2, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6334569454193115
Epoch: 3, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5607099533081055
Epoch: 4, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5678870677947998
Epoch: 5, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5747950077056885
Epoch: 6, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.611689567565918
Epoch: 7, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5733537673950195
Epoch: 8, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5863909721374512
Epoch: 9, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.323 Vali Acc: 0.267 Test Loss: 1.323 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5766143798828125
Epoch: 10, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.360 Vali Acc: 0.267 Test Loss: 1.360 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6436734199523926
Epoch: 11, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.448 Vali Acc: 0.267 Test Loss: 1.448 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5647034645080566
Epoch: 12, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.551 Vali Acc: 0.333 Test Loss: 1.551 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5623912811279297
Epoch: 13, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.725 Vali Acc: 0.400 Test Loss: 1.725 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399983).  Saving model ...
Epoch: 14 cost time: 0.5933539867401123
Epoch: 14, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.894 Vali Acc: 0.400 Test Loss: 1.894 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5452225208282471
Epoch: 15, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.006 Vali Acc: 0.400 Test Loss: 2.006 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5080780982971191
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.099 Vali Acc: 0.400 Test Loss: 2.099 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5815680027008057
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.186 Vali Acc: 0.400 Test Loss: 2.186 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.661616325378418
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.267 Vali Acc: 0.400 Test Loss: 2.267 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5630342960357666
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.350 Vali Acc: 0.533 Test Loss: 2.350 Test Acc: 0.533
Validation loss decreased (-0.399983 --> -0.533310).  Saving model ...
Epoch: 20 cost time: 0.5664114952087402
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.432 Vali Acc: 0.467 Test Loss: 2.432 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5224294662475586
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.517 Vali Acc: 0.467 Test Loss: 2.517 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5283420085906982
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.592 Vali Acc: 0.467 Test Loss: 2.592 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6444594860076904
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.670 Vali Acc: 0.467 Test Loss: 2.670 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5309195518493652
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.740 Vali Acc: 0.467 Test Loss: 2.740 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5337717533111572
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.812 Vali Acc: 0.400 Test Loss: 2.812 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6012787818908691
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.876 Vali Acc: 0.333 Test Loss: 2.876 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5482642650604248
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.947 Vali Acc: 0.333 Test Loss: 2.947 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5548052787780762
Epoch: 28, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.009 Vali Acc: 0.333 Test Loss: 3.009 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5549347400665283
Epoch: 29, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.066 Vali Acc: 0.333 Test Loss: 3.066 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2180147
model size : 18.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.446223497390747
Epoch: 1, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.119 Vali Acc: 0.067 Test Loss: 1.119 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.5207312107086182
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
Validation loss decreased (-0.066655 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.6943187713623047
Epoch: 3, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6221632957458496
Epoch: 4, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5738153457641602
Epoch: 5, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6068160533905029
Epoch: 6, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5985004901885986
Epoch: 7, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6201677322387695
Epoch: 8, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.6124813556671143
Epoch: 9, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6018681526184082
Epoch: 10, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6508657932281494
Epoch: 11, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.596501350402832
Epoch: 12, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.355 Vali Acc: 0.333 Test Loss: 1.355 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6028516292572021
Epoch: 13, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.458 Vali Acc: 0.333 Test Loss: 1.458 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5293307304382324
Epoch: 14, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.542 Vali Acc: 0.333 Test Loss: 1.542 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5805549621582031
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.627 Vali Acc: 0.333 Test Loss: 1.627 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5448949337005615
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.730 Vali Acc: 0.333 Test Loss: 1.730 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.557532787322998
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.838 Vali Acc: 0.333 Test Loss: 1.838 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5142300128936768
Epoch: 18, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.955 Vali Acc: 0.333 Test Loss: 1.955 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2180147
model size : 18.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.158958911895752
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.48947858810424805
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.503303050994873
Epoch: 3, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5437521934509277
Epoch: 4, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4703848361968994
Epoch: 5, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5140252113342285
Epoch: 6, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5988039970397949
Epoch: 7, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.256 Vali Acc: 0.200 Test Loss: 1.256 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5674972534179688
Epoch: 8, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5122866630554199
Epoch: 9, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.312 Vali Acc: 0.333 Test Loss: 1.312 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5181369781494141
Epoch: 10, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.379 Vali Acc: 0.267 Test Loss: 1.379 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5635411739349365
Epoch: 11, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.455 Vali Acc: 0.200 Test Loss: 1.455 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5391814708709717
Epoch: 12, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.522 Vali Acc: 0.200 Test Loss: 1.522 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2859571
model size : 15.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3471779823303223
Epoch: 1, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5536937713623047
Epoch: 2, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5780212879180908
Epoch: 3, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.575059175491333
Epoch: 4, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.523186206817627
Epoch: 5, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.211 Vali Acc: 0.200 Test Loss: 1.211 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5434572696685791
Epoch: 6, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5674746036529541
Epoch: 7, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5380094051361084
Epoch: 8, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5205731391906738
Epoch: 9, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5303611755371094
Epoch: 10, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5234601497650146
Epoch: 11, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.357 Vali Acc: 0.267 Test Loss: 1.357 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2859571
model size : 15.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.20863676071167
Epoch: 1, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.46726155281066895
Epoch: 2, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5092434883117676
Epoch: 3, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5706069469451904
Epoch: 4, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5352301597595215
Epoch: 5, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5291988849639893
Epoch: 6, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6185555458068848
Epoch: 7, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5437116622924805
Epoch: 8, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.513455867767334
Epoch: 9, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5217726230621338
Epoch: 10, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.526242733001709
Epoch: 11, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333320).  Saving model ...
Epoch: 12 cost time: 0.5933198928833008
Epoch: 12, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.358 Vali Acc: 0.333 Test Loss: 1.358 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5314207077026367
Epoch: 13, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.398 Vali Acc: 0.333 Test Loss: 1.398 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5334017276763916
Epoch: 14, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.473 Vali Acc: 0.333 Test Loss: 1.473 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5351104736328125
Epoch: 15, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.560 Vali Acc: 0.333 Test Loss: 1.560 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4572722911834717
Epoch: 16, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.631 Vali Acc: 0.400 Test Loss: 1.631 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399984).  Saving model ...
Epoch: 17 cost time: 0.49640917778015137
Epoch: 17, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.698 Vali Acc: 0.467 Test Loss: 1.698 Test Acc: 0.467
Validation loss decreased (-0.399984 --> -0.466650).  Saving model ...
Epoch: 18 cost time: 0.5442817211151123
Epoch: 18, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.785 Vali Acc: 0.467 Test Loss: 1.785 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5431623458862305
Epoch: 19, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.878 Vali Acc: 0.467 Test Loss: 1.878 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5669679641723633
Epoch: 20, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.975 Vali Acc: 0.467 Test Loss: 1.975 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5726606845855713
Epoch: 21, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.063 Vali Acc: 0.467 Test Loss: 2.063 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5462102890014648
Epoch: 22, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.153 Vali Acc: 0.400 Test Loss: 2.153 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6092586517333984
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.244 Vali Acc: 0.333 Test Loss: 2.244 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5989875793457031
Epoch: 24, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.329 Vali Acc: 0.333 Test Loss: 2.329 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5969552993774414
Epoch: 25, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.430 Vali Acc: 0.333 Test Loss: 2.430 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6316075325012207
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.507 Vali Acc: 0.333 Test Loss: 2.507 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5885844230651855
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.584 Vali Acc: 0.333 Test Loss: 2.584 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2859571
model size : 15.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.290160894393921
Epoch: 1, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.100 Vali Acc: 0.533 Test Loss: 1.100 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.5091516971588135
Epoch: 2, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5553114414215088
Epoch: 3, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.504082202911377
Epoch: 4, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.512014627456665
Epoch: 5, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.607006311416626
Epoch: 6, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5170619487762451
Epoch: 7, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5151457786560059
Epoch: 8, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5625607967376709
Epoch: 9, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5742430686950684
Epoch: 10, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5643551349639893
Epoch: 11, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2859571
model size : 15.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5129032135009766
Epoch: 1, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5480613708496094
Epoch: 2, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5923571586608887
Epoch: 3, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5482723712921143
Epoch: 4, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5229933261871338
Epoch: 5, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5665385723114014
Epoch: 6, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5972833633422852
Epoch: 7, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.559211254119873
Epoch: 8, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5517089366912842
Epoch: 9, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5793807506561279
Epoch: 10, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.269 Vali Acc: 0.200 Test Loss: 1.269 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5985593795776367
Epoch: 11, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.334 Vali Acc: 0.200 Test Loss: 1.334 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1810995
model size : 11.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.090715169906616
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.48592329025268555
Epoch: 2, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47922253608703613
Epoch: 3, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5689787864685059
Epoch: 4, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.524766206741333
Epoch: 5, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4086320400238037
Epoch: 6, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.42184019088745117
Epoch: 7, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.257 Vali Acc: 0.200 Test Loss: 1.257 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5163412094116211
Epoch: 8, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.280 Vali Acc: 0.200 Test Loss: 1.280 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.46291518211364746
Epoch: 9, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.270 Vali Acc: 0.267 Test Loss: 1.270 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4885087013244629
Epoch: 10, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.44905614852905273
Epoch: 11, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.316 Vali Acc: 0.267 Test Loss: 1.316 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.46480846405029297
Epoch: 12, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.383 Vali Acc: 0.333 Test Loss: 1.383 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5131096839904785
Epoch: 13, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.506 Vali Acc: 0.333 Test Loss: 1.506 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5653457641601562
Epoch: 14, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.579 Vali Acc: 0.333 Test Loss: 1.579 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4949977397918701
Epoch: 15, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.632 Vali Acc: 0.333 Test Loss: 1.632 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5890731811523438
Epoch: 16, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.707 Vali Acc: 0.267 Test Loss: 1.707 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5553300380706787
Epoch: 17, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.801 Vali Acc: 0.333 Test Loss: 1.801 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5687427520751953
Epoch: 18, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.903 Vali Acc: 0.333 Test Loss: 1.903 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5552620887756348
Epoch: 19, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.994 Vali Acc: 0.333 Test Loss: 1.994 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4904310703277588
Epoch: 20, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.084 Vali Acc: 0.400 Test Loss: 2.084 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399979).  Saving model ...
Epoch: 21 cost time: 0.5909006595611572
Epoch: 21, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.178 Vali Acc: 0.467 Test Loss: 2.178 Test Acc: 0.467
Validation loss decreased (-0.399979 --> -0.466645).  Saving model ...
Epoch: 22 cost time: 0.5294373035430908
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.268 Vali Acc: 0.400 Test Loss: 2.268 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5498862266540527
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.360 Vali Acc: 0.400 Test Loss: 2.360 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5024452209472656
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.444 Vali Acc: 0.400 Test Loss: 2.444 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4690070152282715
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.532 Vali Acc: 0.400 Test Loss: 2.532 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.49407196044921875
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.615 Vali Acc: 0.400 Test Loss: 2.615 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.555556058883667
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.692 Vali Acc: 0.400 Test Loss: 2.692 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5186653137207031
Epoch: 28, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.766 Vali Acc: 0.467 Test Loss: 2.766 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5603036880493164
Epoch: 29, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.838 Vali Acc: 0.467 Test Loss: 2.838 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.48796534538269043
Epoch: 30, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.903 Vali Acc: 0.467 Test Loss: 2.903 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.4707796573638916
Epoch: 31, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.966 Vali Acc: 0.467 Test Loss: 2.966 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1810995
model size : 11.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0159995555877686
Epoch: 1, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.45705437660217285
Epoch: 2, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4631161689758301
Epoch: 3, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.44388246536254883
Epoch: 4, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5251741409301758
Epoch: 5, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.47702503204345703
Epoch: 6, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4659395217895508
Epoch: 7, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.209 Vali Acc: 0.200 Test Loss: 1.209 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4761641025543213
Epoch: 8, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.530510425567627
Epoch: 9, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4765746593475342
Epoch: 10, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4721548557281494
Epoch: 11, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1810995
model size : 11.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.103267192840576
Epoch: 1, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.46526503562927246
Epoch: 2, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5808403491973877
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5050842761993408
Epoch: 4, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5264163017272949
Epoch: 5, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4748201370239258
Epoch: 6, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5229101181030273
Epoch: 7, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5495593547821045
Epoch: 8, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5092048645019531
Epoch: 9, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5988588333129883
Epoch: 10, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5112669467926025
Epoch: 11, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5741395950317383
Epoch: 12, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1810995
model size : 11.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3304836750030518
Epoch: 1, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5896162986755371
Epoch: 2, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5317702293395996
Epoch: 3, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6629464626312256
Epoch: 4, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5437512397766113
Epoch: 5, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5907754898071289
Epoch: 6, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5804867744445801
Epoch: 7, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6138684749603271
Epoch: 8, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6185035705566406
Epoch: 9, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.288 Vali Acc: 0.267 Test Loss: 1.288 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5877482891082764
Epoch: 10, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.359 Vali Acc: 0.267 Test Loss: 1.359 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5869343280792236
Epoch: 11, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.438 Vali Acc: 0.333 Test Loss: 1.438 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5389256477355957
Epoch: 12, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.502 Vali Acc: 0.333 Test Loss: 1.502 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1286707
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5487444400787354
Epoch: 1, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5232625007629395
Epoch: 2, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.5735595226287842
Epoch: 3, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5252842903137207
Epoch: 4, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.526339054107666
Epoch: 5, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5284247398376465
Epoch: 6, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5348911285400391
Epoch: 7, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5713951587677002
Epoch: 8, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5673809051513672
Epoch: 9, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5978238582611084
Epoch: 10, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5681126117706299
Epoch: 11, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.305 Vali Acc: 0.333 Test Loss: 1.305 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.56591796875
Epoch: 12, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.348 Vali Acc: 0.333 Test Loss: 1.348 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1286707
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.283475399017334
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5142364501953125
Epoch: 2, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.557081937789917
Epoch: 3, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5712409019470215
Epoch: 4, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49312663078308105
Epoch: 5, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.49968457221984863
Epoch: 6, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5234062671661377
Epoch: 7, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5872402191162109
Epoch: 8, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5345499515533447
Epoch: 9, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4915897846221924
Epoch: 10, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5561678409576416
Epoch: 11, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1286707
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2492551803588867
Epoch: 1, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.43141770362854004
Epoch: 2, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4776337146759033
Epoch: 3, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4686596393585205
Epoch: 4, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.45352649688720703
Epoch: 5, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.531848669052124
Epoch: 6, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.497483491897583
Epoch: 7, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4526641368865967
Epoch: 8, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3865046501159668
Epoch: 9, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5388021469116211
Epoch: 10, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5369298458099365
Epoch: 11, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1286707
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3416192531585693
Epoch: 1, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.4893608093261719
Epoch: 2, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5290277004241943
Epoch: 3, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5634808540344238
Epoch: 4, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.529552698135376
Epoch: 5, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4977536201477051
Epoch: 6, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5452995300292969
Epoch: 7, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4952523708343506
Epoch: 8, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5441255569458008
Epoch: 9, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4755263328552246
Epoch: 10, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.278 Vali Acc: 0.267 Test Loss: 1.278 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.46373748779296875
Epoch: 11, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.353 Vali Acc: 0.267 Test Loss: 1.353 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1024563
model size : 8.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0816078186035156
Epoch: 1, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.5275046825408936
Epoch: 2, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6169779300689697
Epoch: 3, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5105550289154053
Epoch: 4, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4960606098175049
Epoch: 5, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.545203685760498
Epoch: 6, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5507428646087646
Epoch: 7, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.605597972869873
Epoch: 8, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.586017370223999
Epoch: 9, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5483269691467285
Epoch: 10, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5817146301269531
Epoch: 11, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.301 Vali Acc: 0.333 Test Loss: 1.301 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1024563
model size : 8.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.390415906906128
Epoch: 1, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.559410810470581
Epoch: 2, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5198853015899658
Epoch: 3, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5577914714813232
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5216176509857178
Epoch: 5, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5180034637451172
Epoch: 6, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4995276927947998
Epoch: 7, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5569183826446533
Epoch: 8, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5096051692962646
Epoch: 9, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5589542388916016
Epoch: 10, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5127003192901611
Epoch: 11, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5608222484588623
Epoch: 12, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.282 Vali Acc: 0.333 Test Loss: 1.282 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4786093235015869
Epoch: 13, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.338 Vali Acc: 0.267 Test Loss: 1.338 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5210707187652588
Epoch: 14, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.378 Vali Acc: 0.267 Test Loss: 1.378 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1024563
model size : 8.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3113656044006348
Epoch: 1, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5207338333129883
Epoch: 2, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5241572856903076
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5573005676269531
Epoch: 4, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6309101581573486
Epoch: 5, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.528968334197998
Epoch: 6, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5059189796447754
Epoch: 7, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5463855266571045
Epoch: 8, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6237318515777588
Epoch: 9, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5590262413024902
Epoch: 10, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5272748470306396
Epoch: 11, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1024563
model size : 8.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.169158697128296
Epoch: 1, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.49071550369262695
Epoch: 2, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5135486125946045
Epoch: 3, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.49857664108276367
Epoch: 4, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.4810185432434082
Epoch: 5, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5328407287597656
Epoch: 6, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.48651576042175293
Epoch: 7, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5185766220092773
Epoch: 8, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5365407466888428
Epoch: 9, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5374324321746826
Epoch: 10, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5154471397399902
Epoch: 11, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.275 Vali Acc: 0.333 Test Loss: 1.275 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5495483875274658
Epoch: 12, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.420 Vali Acc: 0.467 Test Loss: 1.420 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4518764019012451
Epoch: 13, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.545 Vali Acc: 0.467 Test Loss: 1.545 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.48253369331359863
Epoch: 14, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.607 Vali Acc: 0.467 Test Loss: 1.607 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 893491
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.451902389526367
Epoch: 1, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5906574726104736
Epoch: 2, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5275640487670898
Epoch: 3, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5118167400360107
Epoch: 4, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.5375473499298096
Epoch: 5, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5636179447174072
Epoch: 6, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5589699745178223
Epoch: 7, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5033538341522217
Epoch: 8, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4824049472808838
Epoch: 9, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5114486217498779
Epoch: 10, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5774121284484863
Epoch: 11, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5158491134643555
Epoch: 12, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.347 Vali Acc: 0.333 Test Loss: 1.347 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5259342193603516
Epoch: 13, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.442 Vali Acc: 0.400 Test Loss: 1.442 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5729460716247559
Epoch: 14, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.469 Vali Acc: 0.400 Test Loss: 1.469 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 893491
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8779096603393555
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.47598862648010254
Epoch: 2, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
Validation loss decreased (-0.399989 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.46035337448120117
Epoch: 3, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.44481992721557617
Epoch: 4, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4556849002838135
Epoch: 5, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.48270106315612793
Epoch: 6, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4535641670227051
Epoch: 7, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4489421844482422
Epoch: 8, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4565300941467285
Epoch: 9, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4098014831542969
Epoch: 10, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4695608615875244
Epoch: 11, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.48363375663757324
Epoch: 12, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 893491
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1773521900177
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5507509708404541
Epoch: 2, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5265779495239258
Epoch: 3, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.5380990505218506
Epoch: 4, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5624856948852539
Epoch: 5, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5191745758056641
Epoch: 6, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5269608497619629
Epoch: 7, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5763916969299316
Epoch: 8, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6036562919616699
Epoch: 9, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5708158016204834
Epoch: 10, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5288949012756348
Epoch: 11, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6011731624603271
Epoch: 12, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5359153747558594
Epoch: 13, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 893491
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3159265518188477
Epoch: 1, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6039738655090332
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.569429874420166
Epoch: 3, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6047379970550537
Epoch: 4, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5454375743865967
Epoch: 5, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5850129127502441
Epoch: 6, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5896143913269043
Epoch: 7, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6335928440093994
Epoch: 8, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5903940200805664
Epoch: 9, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5979092121124268
Epoch: 10, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.274 Vali Acc: 0.333 Test Loss: 1.274 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5734679698944092
Epoch: 11, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.340 Vali Acc: 0.400 Test Loss: 1.340 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5894997119903564
Epoch: 12, Steps: 1 | Train Loss: 0.111 Vali Loss: 1.397 Vali Acc: 0.400 Test Loss: 1.397 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.544532299041748
Epoch: 13, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.476 Vali Acc: 0.400 Test Loss: 1.476 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 827955
model size : 8.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3205339908599854
Epoch: 1, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5240411758422852
Epoch: 2, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5173215866088867
Epoch: 3, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.497234582901001
Epoch: 4, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4824376106262207
Epoch: 5, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5521423816680908
Epoch: 6, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5591506958007812
Epoch: 7, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5199456214904785
Epoch: 8, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5395140647888184
Epoch: 9, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5638487339019775
Epoch: 10, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5744895935058594
Epoch: 11, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.239 Vali Acc: 0.467 Test Loss: 1.239 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5892760753631592
Epoch: 12, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.290 Vali Acc: 0.467 Test Loss: 1.290 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5262207984924316
Epoch: 13, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.327 Vali Acc: 0.400 Test Loss: 1.327 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 827955
model size : 8.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4557409286499023
Epoch: 1, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4543337821960449
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.553520917892456
Epoch: 3, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.4801356792449951
Epoch: 4, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5403454303741455
Epoch: 5, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.49117517471313477
Epoch: 6, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4976966381072998
Epoch: 7, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5534913539886475
Epoch: 8, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4675426483154297
Epoch: 9, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4810914993286133
Epoch: 10, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.44771361351013184
Epoch: 11, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4733405113220215
Epoch: 12, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4909639358520508
Epoch: 13, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.264 Vali Acc: 0.267 Test Loss: 1.264 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 827955
model size : 8.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.281071901321411
Epoch: 1, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5444557666778564
Epoch: 2, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.612952709197998
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5780253410339355
Epoch: 4, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5528659820556641
Epoch: 5, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5670676231384277
Epoch: 6, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6162149906158447
Epoch: 7, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5076858997344971
Epoch: 8, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5019545555114746
Epoch: 9, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.525092601776123
Epoch: 10, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6163191795349121
Epoch: 11, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5635182857513428
Epoch: 12, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5906078815460205
Epoch: 13, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 827955
model size : 8.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9699313640594482
Epoch: 1, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5201129913330078
Epoch: 2, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.49646854400634766
Epoch: 3, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49153780937194824
Epoch: 4, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5058631896972656
Epoch: 5, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5850968360900879
Epoch: 6, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.519808292388916
Epoch: 7, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5348258018493652
Epoch: 8, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5383248329162598
Epoch: 9, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5079789161682129
Epoch: 10, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4983103275299072
Epoch: 11, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1364275
model size : 7.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.414396286010742
Epoch: 1, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.5295510292053223
Epoch: 2, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5358390808105469
Epoch: 3, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.161 Vali Acc: 0.133 Test Loss: 1.161 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5538170337677002
Epoch: 4, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6086299419403076
Epoch: 5, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5866460800170898
Epoch: 6, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5692894458770752
Epoch: 7, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5514028072357178
Epoch: 8, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.180 Vali Acc: 0.467 Test Loss: 1.180 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5930576324462891
Epoch: 9, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.189 Vali Acc: 0.467 Test Loss: 1.189 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5909423828125
Epoch: 10, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6367998123168945
Epoch: 11, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1364275
model size : 7.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.332395076751709
Epoch: 1, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5182821750640869
Epoch: 2, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5724420547485352
Epoch: 3, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5212478637695312
Epoch: 4, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4944465160369873
Epoch: 5, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5933384895324707
Epoch: 6, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5944943428039551
Epoch: 7, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5148160457611084
Epoch: 8, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.52793288230896
Epoch: 9, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.49365830421447754
Epoch: 10, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5953342914581299
Epoch: 11, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5099551677703857
Epoch: 12, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6906039714813232
Epoch: 13, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5529987812042236
Epoch: 14, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5069105625152588
Epoch: 15, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5091133117675781
Epoch: 16, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5128867626190186
Epoch: 17, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.545799970626831
Epoch: 18, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1364275
model size : 7.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1125566959381104
Epoch: 1, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5515086650848389
Epoch: 2, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.49118757247924805
Epoch: 3, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7198977470397949
Epoch: 4, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5287947654724121
Epoch: 5, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4906957149505615
Epoch: 6, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5670154094696045
Epoch: 7, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5333976745605469
Epoch: 8, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5203948020935059
Epoch: 9, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.52634596824646
Epoch: 10, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.5020613670349121
Epoch: 11, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5379922389984131
Epoch: 12, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5262887477874756
Epoch: 13, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5247535705566406
Epoch: 14, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5565202236175537
Epoch: 15, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5382270812988281
Epoch: 16, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.47773003578186035
Epoch: 17, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.48449230194091797
Epoch: 18, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5233991146087646
Epoch: 19, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4781074523925781
Epoch: 20, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1364275
model size : 7.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0932576656341553
Epoch: 1, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4280388355255127
Epoch: 2, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45870399475097656
Epoch: 3, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5078780651092529
Epoch: 4, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5300695896148682
Epoch: 5, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4980475902557373
Epoch: 6, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5081655979156494
Epoch: 7, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5531497001647949
Epoch: 8, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5193111896514893
Epoch: 9, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.542816162109375
Epoch: 10, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5073225498199463
Epoch: 11, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5116221904754639
Epoch: 12, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5269274711608887
Epoch: 13, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.264 Vali Acc: 0.267 Test Loss: 1.264 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5460355281829834
Epoch: 14, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.305 Vali Acc: 0.267 Test Loss: 1.305 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 839987
model size : 5.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.26513934135437
Epoch: 1, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5743968486785889
Epoch: 2, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5753622055053711
Epoch: 3, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5363106727600098
Epoch: 4, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5100769996643066
Epoch: 5, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.49887776374816895
Epoch: 6, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5459423065185547
Epoch: 7, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.119 Vali Acc: 0.533 Test Loss: 1.119 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.5061447620391846
Epoch: 8, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.128 Vali Acc: 0.533 Test Loss: 1.128 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5469412803649902
Epoch: 9, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.47240209579467773
Epoch: 10, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5008249282836914
Epoch: 11, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5378713607788086
Epoch: 12, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5362880229949951
Epoch: 13, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5680630207061768
Epoch: 14, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5738444328308105
Epoch: 15, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.268 Vali Acc: 0.400 Test Loss: 1.268 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5250155925750732
Epoch: 16, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.626317024230957
Epoch: 17, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.301 Vali Acc: 0.400 Test Loss: 1.301 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 839987
model size : 5.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.324902057647705
Epoch: 1, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5334861278533936
Epoch: 2, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5534048080444336
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5275721549987793
Epoch: 4, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.511451244354248
Epoch: 5, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5860183238983154
Epoch: 6, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5396199226379395
Epoch: 7, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.5057098865509033
Epoch: 8, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5276942253112793
Epoch: 9, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5472238063812256
Epoch: 10, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6510348320007324
Epoch: 11, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.613872766494751
Epoch: 12, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.60337233543396
Epoch: 13, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5775673389434814
Epoch: 14, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5707087516784668
Epoch: 15, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6308798789978027
Epoch: 16, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5470869541168213
Epoch: 17, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 839987
model size : 5.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.026689052581787
Epoch: 1, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.49813365936279297
Epoch: 2, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4974937438964844
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4402761459350586
Epoch: 4, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.48377132415771484
Epoch: 5, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.47231483459472656
Epoch: 6, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.45322561264038086
Epoch: 7, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4490776062011719
Epoch: 8, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5046553611755371
Epoch: 9, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.46620750427246094
Epoch: 10, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5179035663604736
Epoch: 11, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 839987
model size : 5.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2540247440338135
Epoch: 1, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4960489273071289
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5093908309936523
Epoch: 3, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4788849353790283
Epoch: 4, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5331358909606934
Epoch: 5, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5712080001831055
Epoch: 6, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5388696193695068
Epoch: 7, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5323514938354492
Epoch: 8, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5071067810058594
Epoch: 9, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.519099235534668
Epoch: 10, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4908864498138428
Epoch: 11, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.49904370307922363
Epoch: 12, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5407652854919434
Epoch: 13, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.246 Vali Acc: 0.200 Test Loss: 1.246 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5588555335998535
Epoch: 14, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7062046527862549
Epoch: 15, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.337 Vali Acc: 0.333 Test Loss: 1.337 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6043863296508789
Epoch: 16, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.409 Vali Acc: 0.400 Test Loss: 1.409 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5304627418518066
Epoch: 17, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.478 Vali Acc: 0.400 Test Loss: 1.478 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4885678291320801
Epoch: 18, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.532 Vali Acc: 0.333 Test Loss: 1.532 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5489969253540039
Epoch: 19, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.589 Vali Acc: 0.333 Test Loss: 1.589 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.48531413078308105
Epoch: 20, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.646 Vali Acc: 0.333 Test Loss: 1.646 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5291826725006104
Epoch: 21, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.707 Vali Acc: 0.333 Test Loss: 1.707 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 577843
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.244723081588745
Epoch: 1, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5195426940917969
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5103895664215088
Epoch: 3, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5056161880493164
Epoch: 4, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5251462459564209
Epoch: 5, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5236315727233887
Epoch: 6, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6830143928527832
Epoch: 7, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5545706748962402
Epoch: 8, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5678858757019043
Epoch: 9, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5429422855377197
Epoch: 10, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5482509136199951
Epoch: 11, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 577843
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.351057291030884
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5811161994934082
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5859200954437256
Epoch: 3, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.574885368347168
Epoch: 4, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5671350955963135
Epoch: 5, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5486998558044434
Epoch: 6, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.48415660858154297
Epoch: 7, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5249271392822266
Epoch: 8, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.48301148414611816
Epoch: 9, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5474226474761963
Epoch: 10, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5137581825256348
Epoch: 11, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 577843
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3643932342529297
Epoch: 1, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.60129714012146
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5778121948242188
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5248663425445557
Epoch: 4, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6195371150970459
Epoch: 5, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5911462306976318
Epoch: 6, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6289608478546143
Epoch: 7, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5782737731933594
Epoch: 8, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.559396505355835
Epoch: 9, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.64345383644104
Epoch: 10, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5401511192321777
Epoch: 11, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.603468656539917
Epoch: 12, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5752706527709961
Epoch: 13, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 577843
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.305931329727173
Epoch: 1, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4726593494415283
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45894694328308105
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.107 Vali Acc: 0.200 Test Loss: 1.107 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4693024158477783
Epoch: 4, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.45510411262512207
Epoch: 5, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.40395140647888184
Epoch: 6, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5018727779388428
Epoch: 7, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.46245288848876953
Epoch: 8, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4712951183319092
Epoch: 9, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5276472568511963
Epoch: 10, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4548647403717041
Epoch: 11, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.42689013481140137
Epoch: 12, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.48447299003601074
Epoch: 13, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.47112083435058594
Epoch: 14, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.268 Vali Acc: 0.400 Test Loss: 1.268 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399987).  Saving model ...
Epoch: 15 cost time: 0.4975731372833252
Epoch: 15, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.306 Vali Acc: 0.400 Test Loss: 1.306 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4091062545776367
Epoch: 16, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.339 Vali Acc: 0.333 Test Loss: 1.339 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4357943534851074
Epoch: 17, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.368 Vali Acc: 0.333 Test Loss: 1.368 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4611663818359375
Epoch: 18, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.401 Vali Acc: 0.400 Test Loss: 1.401 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4914281368255615
Epoch: 19, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.452 Vali Acc: 0.400 Test Loss: 1.452 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.424954891204834
Epoch: 20, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.512 Vali Acc: 0.400 Test Loss: 1.512 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5027115345001221
Epoch: 21, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.578 Vali Acc: 0.400 Test Loss: 1.578 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5232977867126465
Epoch: 22, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.642 Vali Acc: 0.400 Test Loss: 1.642 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4797694683074951
Epoch: 23, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.702 Vali Acc: 0.400 Test Loss: 1.702 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5147135257720947
Epoch: 24, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.758 Vali Acc: 0.400 Test Loss: 1.758 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 446771
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.271343946456909
Epoch: 1, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4993114471435547
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.082 Vali Acc: 0.133 Test Loss: 1.082 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4551224708557129
Epoch: 3, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.085 Vali Acc: 0.200 Test Loss: 1.085 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.512120246887207
Epoch: 4, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.553109884262085
Epoch: 5, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.48479247093200684
Epoch: 6, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5339555740356445
Epoch: 7, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5370204448699951
Epoch: 8, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5282013416290283
Epoch: 9, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.515899658203125
Epoch: 10, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.47020530700683594
Epoch: 11, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.46407318115234375
Epoch: 12, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 0.4826467037200928
Epoch: 13, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5058374404907227
Epoch: 14, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4914126396179199
Epoch: 15, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.489363431930542
Epoch: 16, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5118355751037598
Epoch: 17, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.48615169525146484
Epoch: 18, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4343245029449463
Epoch: 19, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.300 Vali Acc: 0.400 Test Loss: 1.300 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.43125057220458984
Epoch: 20, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4311072826385498
Epoch: 21, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.421 Vali Acc: 0.400 Test Loss: 1.421 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.48020100593566895
Epoch: 22, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.486 Vali Acc: 0.400 Test Loss: 1.486 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 446771
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.114257574081421
Epoch: 1, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5331430435180664
Epoch: 2, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5443027019500732
Epoch: 3, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5431785583496094
Epoch: 4, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49889373779296875
Epoch: 5, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.526444673538208
Epoch: 6, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5385510921478271
Epoch: 7, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5391318798065186
Epoch: 8, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5938677787780762
Epoch: 9, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6149952411651611
Epoch: 10, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6488656997680664
Epoch: 11, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 446771
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.236504554748535
Epoch: 1, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5949578285217285
Epoch: 2, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5882308483123779
Epoch: 3, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.595496416091919
Epoch: 4, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5856289863586426
Epoch: 5, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.148 Vali Acc: 0.133 Test Loss: 1.148 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6445410251617432
Epoch: 6, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5753133296966553
Epoch: 7, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5467548370361328
Epoch: 8, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5742578506469727
Epoch: 9, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4877443313598633
Epoch: 10, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5100095272064209
Epoch: 11, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 446771
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.050880193710327
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.244 Vali Acc: 0.133 Test Loss: 1.244 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.5035858154296875
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5890250205993652
Epoch: 3, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.247 Vali Acc: 0.200 Test Loss: 1.247 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5465574264526367
Epoch: 4, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5574626922607422
Epoch: 5, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5968530178070068
Epoch: 6, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.572441816329956
Epoch: 7, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.266 Vali Acc: 0.200 Test Loss: 1.266 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5561378002166748
Epoch: 8, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5571067333221436
Epoch: 9, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.303 Vali Acc: 0.267 Test Loss: 1.303 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.58941650390625
Epoch: 10, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.320 Vali Acc: 0.267 Test Loss: 1.320 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5477807521820068
Epoch: 11, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.343 Vali Acc: 0.267 Test Loss: 1.343 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6100800037384033
Epoch: 12, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.366 Vali Acc: 0.267 Test Loss: 1.366 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5575249195098877
Epoch: 13, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.404 Vali Acc: 0.267 Test Loss: 1.404 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5131680965423584
Epoch: 14, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.440 Vali Acc: 0.333 Test Loss: 1.440 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 381235
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2550268173217773
Epoch: 1, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5511150360107422
Epoch: 2, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5095045566558838
Epoch: 3, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5355608463287354
Epoch: 4, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4995598793029785
Epoch: 5, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4355156421661377
Epoch: 6, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.45517683029174805
Epoch: 7, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.47498607635498047
Epoch: 8, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4949767589569092
Epoch: 9, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4300875663757324
Epoch: 10, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4393482208251953
Epoch: 11, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.209 Vali Acc: 0.200 Test Loss: 1.209 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.46571922302246094
Epoch: 12, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 381235
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2528185844421387
Epoch: 1, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5088872909545898
Epoch: 2, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.540212869644165
Epoch: 3, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5534019470214844
Epoch: 4, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6152369976043701
Epoch: 5, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5400495529174805
Epoch: 6, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5528891086578369
Epoch: 7, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.193 Vali Acc: 0.200 Test Loss: 1.193 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5219290256500244
Epoch: 8, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5355784893035889
Epoch: 9, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5615537166595459
Epoch: 10, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.48704075813293457
Epoch: 11, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4618980884552002
Epoch: 12, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 381235
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1779603958129883
Epoch: 1, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4551093578338623
Epoch: 2, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.142 Vali Acc: 0.067 Test Loss: 1.142 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5384416580200195
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.5231750011444092
Epoch: 4, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.46619224548339844
Epoch: 5, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5102193355560303
Epoch: 6, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4842870235443115
Epoch: 7, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4413416385650635
Epoch: 8, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4959590435028076
Epoch: 9, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5098235607147217
Epoch: 10, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5556964874267578
Epoch: 11, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.195 Vali Acc: 0.200 Test Loss: 1.195 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5162990093231201
Epoch: 12, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.47922658920288086
Epoch: 13, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4774472713470459
Epoch: 14, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 0.4821789264678955
Epoch: 15, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.458282470703125
Epoch: 16, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5279672145843506
Epoch: 17, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5291426181793213
Epoch: 18, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4818229675292969
Epoch: 19, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5758202075958252
Epoch: 20, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5206491947174072
Epoch: 21, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.295 Vali Acc: 0.267 Test Loss: 1.295 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5731198787689209
Epoch: 22, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.357 Vali Acc: 0.267 Test Loss: 1.357 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5667223930358887
Epoch: 23, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.432 Vali Acc: 0.333 Test Loss: 1.432 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333319).  Saving model ...
Epoch: 24 cost time: 0.5587670803070068
Epoch: 24, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.482 Vali Acc: 0.333 Test Loss: 1.482 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.508765697479248
Epoch: 25, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.508 Vali Acc: 0.333 Test Loss: 1.508 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5492310523986816
Epoch: 26, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.510 Vali Acc: 0.333 Test Loss: 1.510 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5302870273590088
Epoch: 27, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.516 Vali Acc: 0.333 Test Loss: 1.516 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5359516143798828
Epoch: 28, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.524 Vali Acc: 0.333 Test Loss: 1.524 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5964810848236084
Epoch: 29, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.541 Vali Acc: 0.267 Test Loss: 1.541 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5595290660858154
Epoch: 30, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.563 Vali Acc: 0.267 Test Loss: 1.563 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5622673034667969
Epoch: 31, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.589 Vali Acc: 0.267 Test Loss: 1.589 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5414314270019531
Epoch: 32, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.617 Vali Acc: 0.267 Test Loss: 1.617 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5631630420684814
Epoch: 33, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.650 Vali Acc: 0.267 Test Loss: 1.650 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 381235
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.255143404006958
Epoch: 1, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.4804677963256836
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.5142271518707275
Epoch: 3, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5636284351348877
Epoch: 4, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5181488990783691
Epoch: 5, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5912673473358154
Epoch: 6, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5374407768249512
Epoch: 7, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5031859874725342
Epoch: 8, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.553145170211792
Epoch: 9, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5605626106262207
Epoch: 10, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5598592758178711
Epoch: 11, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.48093271255493164
Epoch: 12, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 348467
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1704494953155518
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.497661828994751
Epoch: 2, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.533388614654541
Epoch: 3, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4996933937072754
Epoch: 4, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5493559837341309
Epoch: 5, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5070829391479492
Epoch: 6, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5157098770141602
Epoch: 7, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5425112247467041
Epoch: 8, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5686759948730469
Epoch: 9, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.506678581237793
Epoch: 10, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5309507846832275
Epoch: 11, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5387544631958008
Epoch: 12, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5721828937530518
Epoch: 13, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5073034763336182
Epoch: 14, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 348467
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1476168632507324
Epoch: 1, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5246148109436035
Epoch: 2, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.5061788558959961
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.48980093002319336
Epoch: 4, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.48125171661376953
Epoch: 5, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.48242926597595215
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.47112369537353516
Epoch: 7, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.46562814712524414
Epoch: 8, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4742450714111328
Epoch: 9, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4804074764251709
Epoch: 10, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5257680416107178
Epoch: 11, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4626884460449219
Epoch: 12, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.43582868576049805
Epoch: 13, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.48669004440307617
Epoch: 14, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.47034120559692383
Epoch: 15, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.4523444175720215
Epoch: 16, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 348467
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1697633266448975
Epoch: 1, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.517113447189331
Epoch: 2, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.554351806640625
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5135593414306641
Epoch: 4, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5210611820220947
Epoch: 5, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.49542713165283203
Epoch: 6, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4810826778411865
Epoch: 7, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5248289108276367
Epoch: 8, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5304367542266846
Epoch: 9, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4595065116882324
Epoch: 10, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5363166332244873
Epoch: 11, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.555708646774292
Epoch: 12, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 348467
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1348116397857666
Epoch: 1, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4817981719970703
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.483020544052124
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4698655605316162
Epoch: 4, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.452390193939209
Epoch: 5, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.4738905429840088
Epoch: 6, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5607748031616211
Epoch: 7, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.47319483757019043
Epoch: 8, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5349116325378418
Epoch: 9, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5668509006500244
Epoch: 10, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5878136157989502
Epoch: 11, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5140113830566406
Epoch: 12, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.237 Vali Acc: 0.267 Test Loss: 1.237 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5589218139648438
Epoch: 13, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6441001892089844
Epoch: 14, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5233125686645508
Epoch: 15, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 665779
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1739962100982666
Epoch: 1, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5841042995452881
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5957357883453369
Epoch: 3, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5979628562927246
Epoch: 4, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.559575080871582
Epoch: 5, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.5495195388793945
Epoch: 6, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.5344934463500977
Epoch: 7, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.137 Vali Acc: 0.533 Test Loss: 1.137 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.570864200592041
Epoch: 8, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5427286624908447
Epoch: 9, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5433895587921143
Epoch: 10, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5994975566864014
Epoch: 11, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5637071132659912
Epoch: 12, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.57887864112854
Epoch: 13, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5668618679046631
Epoch: 14, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6626241207122803
Epoch: 15, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5544052124023438
Epoch: 16, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 665779
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2568793296813965
Epoch: 1, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.47033071517944336
Epoch: 2, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45751261711120605
Epoch: 3, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5140092372894287
Epoch: 4, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4892299175262451
Epoch: 5, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4841432571411133
Epoch: 6, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5185694694519043
Epoch: 7, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4707210063934326
Epoch: 8, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.507786750793457
Epoch: 9, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5020296573638916
Epoch: 10, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4821186065673828
Epoch: 11, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 665779
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.176567316055298
Epoch: 1, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4708385467529297
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5146651268005371
Epoch: 3, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5061297416687012
Epoch: 4, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4344046115875244
Epoch: 5, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4777495861053467
Epoch: 6, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4797368049621582
Epoch: 7, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4999961853027344
Epoch: 8, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5365650653839111
Epoch: 9, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5133614540100098
Epoch: 10, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5089266300201416
Epoch: 11, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.52158522605896
Epoch: 12, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5087180137634277
Epoch: 13, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4772477149963379
Epoch: 14, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4756197929382324
Epoch: 15, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6027143001556396
Epoch: 16, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 665779
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.043142080307007
Epoch: 1, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4529433250427246
Epoch: 2, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.41349339485168457
Epoch: 3, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.456676721572876
Epoch: 4, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4494490623474121
Epoch: 5, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.49085140228271484
Epoch: 6, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4354434013366699
Epoch: 7, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.41976404190063477
Epoch: 8, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4844636917114258
Epoch: 9, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5806381702423096
Epoch: 10, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4636359214782715
Epoch: 11, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 403635
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.153057336807251
Epoch: 1, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.4374666213989258
Epoch: 2, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.43349671363830566
Epoch: 3, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.491896390914917
Epoch: 4, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.48963308334350586
Epoch: 5, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.48830366134643555
Epoch: 6, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4843006134033203
Epoch: 7, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5084309577941895
Epoch: 8, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4735100269317627
Epoch: 9, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5031025409698486
Epoch: 10, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4398787021636963
Epoch: 11, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5040762424468994
Epoch: 12, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 403635
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.148160457611084
Epoch: 1, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.49126362800598145
Epoch: 2, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.5352799892425537
Epoch: 3, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.500307559967041
Epoch: 4, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.5218691825866699
Epoch: 5, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4857664108276367
Epoch: 6, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.49793553352355957
Epoch: 7, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.49013304710388184
Epoch: 8, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6455032825469971
Epoch: 9, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5315790176391602
Epoch: 10, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.48068976402282715
Epoch: 11, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5283241271972656
Epoch: 12, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4959137439727783
Epoch: 13, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.49433040618896484
Epoch: 14, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 403635
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2126431465148926
Epoch: 1, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.5260725021362305
Epoch: 2, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.5715413093566895
Epoch: 3, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.5108625888824463
Epoch: 4, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.5156629085540771
Epoch: 5, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5532872676849365
Epoch: 6, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5463366508483887
Epoch: 7, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5693845748901367
Epoch: 8, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5588641166687012
Epoch: 9, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5442290306091309
Epoch: 10, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.518230676651001
Epoch: 11, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5803437232971191
Epoch: 12, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.517343282699585
Epoch: 13, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.48627471923828125
Epoch: 14, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 403635
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1241462230682373
Epoch: 1, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4033787250518799
Epoch: 2, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4564018249511719
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.45556044578552246
Epoch: 4, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.455608606338501
Epoch: 5, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.46675872802734375
Epoch: 6, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4337496757507324
Epoch: 7, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5445675849914551
Epoch: 8, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4660062789916992
Epoch: 9, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.46591901779174805
Epoch: 10, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.48089051246643066
Epoch: 11, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5055174827575684
Epoch: 12, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 272563
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0814921855926514
Epoch: 1, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5548717975616455
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5069437026977539
Epoch: 3, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5453500747680664
Epoch: 4, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.627500057220459
Epoch: 5, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.548541784286499
Epoch: 6, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5726602077484131
Epoch: 7, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.123 Vali Acc: 0.133 Test Loss: 1.123 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5558445453643799
Epoch: 8, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5068633556365967
Epoch: 9, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.464672327041626
Epoch: 10, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.42850399017333984
Epoch: 11, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.4707021713256836
Epoch: 12, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.44818902015686035
Epoch: 13, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.510019063949585
Epoch: 14, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 272563
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9962382316589355
Epoch: 1, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4544646739959717
Epoch: 2, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.50307297706604
Epoch: 3, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.48647022247314453
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4734804630279541
Epoch: 5, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5105640888214111
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.5819087028503418
Epoch: 7, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.509852409362793
Epoch: 8, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.105 Vali Acc: 0.200 Test Loss: 1.105 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5168092250823975
Epoch: 9, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.545954704284668
Epoch: 10, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4526066780090332
Epoch: 11, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.482738733291626
Epoch: 12, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.516026496887207
Epoch: 13, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.49453234672546387
Epoch: 14, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.47460365295410156
Epoch: 15, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.5233144760131836
Epoch: 16, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4744422435760498
Epoch: 17, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5772521495819092
Epoch: 18, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5149221420288086
Epoch: 19, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.47511720657348633
Epoch: 20, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5539524555206299
Epoch: 21, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6341168880462646
Epoch: 22, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5662760734558105
Epoch: 23, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6484189033508301
Epoch: 24, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.290 Vali Acc: 0.400 Test Loss: 1.290 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5724685192108154
Epoch: 25, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.323 Vali Acc: 0.333 Test Loss: 1.323 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 272563
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.131312608718872
Epoch: 1, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.5159969329833984
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.5347750186920166
Epoch: 3, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5012032985687256
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5773401260375977
Epoch: 5, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5192687511444092
Epoch: 6, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5954775810241699
Epoch: 7, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6009271144866943
Epoch: 8, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5464410781860352
Epoch: 9, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5774564743041992
Epoch: 10, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5679457187652588
Epoch: 11, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5430314540863037
Epoch: 12, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 272563
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0674893856048584
Epoch: 1, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.47037577629089355
Epoch: 2, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.272 Vali Acc: 0.267 Test Loss: 1.272 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5149383544921875
Epoch: 3, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.275 Vali Acc: 0.267 Test Loss: 1.275 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4967937469482422
Epoch: 4, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.278 Vali Acc: 0.267 Test Loss: 1.278 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4528193473815918
Epoch: 5, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.283 Vali Acc: 0.200 Test Loss: 1.283 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5049548149108887
Epoch: 6, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.288 Vali Acc: 0.267 Test Loss: 1.288 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.45467329025268555
Epoch: 7, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.296 Vali Acc: 0.267 Test Loss: 1.296 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4319493770599365
Epoch: 8, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.307 Vali Acc: 0.267 Test Loss: 1.307 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4734208583831787
Epoch: 9, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.319 Vali Acc: 0.267 Test Loss: 1.319 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4527907371520996
Epoch: 10, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.329 Vali Acc: 0.267 Test Loss: 1.329 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4624519348144531
Epoch: 11, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.344 Vali Acc: 0.267 Test Loss: 1.344 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 207027
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2348015308380127
Epoch: 1, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.5487394332885742
Epoch: 2, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5144045352935791
Epoch: 3, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.46356868743896484
Epoch: 4, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.48922061920166016
Epoch: 5, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.271 Vali Acc: 0.267 Test Loss: 1.271 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5479421615600586
Epoch: 6, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.275 Vali Acc: 0.267 Test Loss: 1.275 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5554912090301514
Epoch: 7, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4937918186187744
Epoch: 8, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.291 Vali Acc: 0.133 Test Loss: 1.291 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4687662124633789
Epoch: 9, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.301 Vali Acc: 0.133 Test Loss: 1.301 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5515010356903076
Epoch: 10, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.307 Vali Acc: 0.133 Test Loss: 1.307 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5253949165344238
Epoch: 11, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.313 Vali Acc: 0.133 Test Loss: 1.313 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 207027
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0518600940704346
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.253 Vali Acc: 0.200 Test Loss: 1.253 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.4227607250213623
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.252 Vali Acc: 0.200 Test Loss: 1.252 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.38219141960144043
Epoch: 3, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5228462219238281
Epoch: 4, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4632716178894043
Epoch: 5, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4449501037597656
Epoch: 6, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.44686460494995117
Epoch: 7, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.266 Vali Acc: 0.200 Test Loss: 1.266 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.48688292503356934
Epoch: 8, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.272 Vali Acc: 0.200 Test Loss: 1.272 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4094846248626709
Epoch: 9, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.280 Vali Acc: 0.200 Test Loss: 1.280 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.43837714195251465
Epoch: 10, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.285 Vali Acc: 0.267 Test Loss: 1.285 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.49158573150634766
Epoch: 11, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5142793655395508
Epoch: 12, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4501948356628418
Epoch: 13, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.302 Vali Acc: 0.200 Test Loss: 1.302 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 207027
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0058274269104004
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5117683410644531
Epoch: 2, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5779294967651367
Epoch: 3, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.213 Vali Acc: 0.200 Test Loss: 1.213 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4840054512023926
Epoch: 4, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5431051254272461
Epoch: 5, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5383734703063965
Epoch: 6, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5271377563476562
Epoch: 7, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.47036314010620117
Epoch: 8, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5258102416992188
Epoch: 9, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4754924774169922
Epoch: 10, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5057215690612793
Epoch: 11, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.518531084060669
Epoch: 12, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5181834697723389
Epoch: 13, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.499708890914917
Epoch: 14, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5643610954284668
Epoch: 15, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 207027
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.165220260620117
Epoch: 1, Steps: 1 | Train Loss: 1.315 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4579298496246338
Epoch: 2, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48229026794433594
Epoch: 3, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.068 Vali Acc: 0.200 Test Loss: 1.068 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.46709680557250977
Epoch: 4, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.48935937881469727
Epoch: 5, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.45659971237182617
Epoch: 6, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.5380456447601318
Epoch: 7, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.49776744842529297
Epoch: 8, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5517446994781494
Epoch: 9, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5477504730224609
Epoch: 10, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5018880367279053
Epoch: 11, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5723423957824707
Epoch: 12, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5471036434173584
Epoch: 13, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5913646221160889
Epoch: 14, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.536663293838501
Epoch: 15, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5165724754333496
Epoch: 16, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 174259
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.258331537246704
Epoch: 1, Steps: 1 | Train Loss: 1.305 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5167896747589111
Epoch: 2, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.5331203937530518
Epoch: 3, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.4887094497680664
Epoch: 4, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5266604423522949
Epoch: 5, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.5442371368408203
Epoch: 6, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5061588287353516
Epoch: 7, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5130801200866699
Epoch: 8, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5263025760650635
Epoch: 9, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6105577945709229
Epoch: 10, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.085 Vali Acc: 0.200 Test Loss: 1.085 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5219545364379883
Epoch: 11, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5290906429290771
Epoch: 12, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5478434562683105
Epoch: 13, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.49100589752197266
Epoch: 14, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.47150707244873047
Epoch: 15, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 174259
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.097659111022949
Epoch: 1, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.44796037673950195
Epoch: 2, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4634854793548584
Epoch: 3, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.46018409729003906
Epoch: 4, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.47269248962402344
Epoch: 5, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4576261043548584
Epoch: 6, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5022485256195068
Epoch: 7, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4966456890106201
Epoch: 8, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5408918857574463
Epoch: 9, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.124 Vali Acc: 0.133 Test Loss: 1.124 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5163607597351074
Epoch: 10, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.132 Vali Acc: 0.133 Test Loss: 1.132 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5031216144561768
Epoch: 11, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.140 Vali Acc: 0.133 Test Loss: 1.140 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.46059393882751465
Epoch: 12, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4725358486175537
Epoch: 13, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5000605583190918
Epoch: 14, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.465531587600708
Epoch: 15, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.4610252380371094
Epoch: 16, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 174259
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1486475467681885
Epoch: 1, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5122718811035156
Epoch: 2, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5050842761993408
Epoch: 3, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4877772331237793
Epoch: 4, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5049567222595215
Epoch: 5, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.4503793716430664
Epoch: 6, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5061707496643066
Epoch: 7, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5596356391906738
Epoch: 8, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4686574935913086
Epoch: 9, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4820265769958496
Epoch: 10, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4688270092010498
Epoch: 11, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4277057647705078
Epoch: 12, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.47398805618286133
Epoch: 13, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.42813849449157715
Epoch: 14, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5204684734344482
Epoch: 15, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 174259
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.161559581756592
Epoch: 1, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.45232295989990234
Epoch: 2, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5340449810028076
Epoch: 3, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5304274559020996
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.48145580291748047
Epoch: 5, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5329384803771973
Epoch: 6, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.49613523483276367
Epoch: 7, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.48296236991882324
Epoch: 8, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.4494819641113281
Epoch: 9, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5092387199401855
Epoch: 10, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.471066951751709
Epoch: 11, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.49396753311157227
Epoch: 12, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4662020206451416
Epoch: 13, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.256 Vali Acc: 0.200 Test Loss: 1.256 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.48632025718688965
Epoch: 14, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.48760414123535156
Epoch: 15, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5173287391662598
Epoch: 16, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.288 Vali Acc: 0.333 Test Loss: 1.288 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5278482437133789
Epoch: 17, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.304 Vali Acc: 0.267 Test Loss: 1.304 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5813875198364258
Epoch: 18, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.332 Vali Acc: 0.267 Test Loss: 1.332 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 157875
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0881266593933105
Epoch: 1, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5080771446228027
Epoch: 2, Steps: 1 | Train Loss: 1.252 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5194652080535889
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5127804279327393
Epoch: 4, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5558393001556396
Epoch: 5, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5104413032531738
Epoch: 6, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4941573143005371
Epoch: 7, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5448806285858154
Epoch: 8, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.5302698612213135
Epoch: 9, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5349042415618896
Epoch: 10, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6051027774810791
Epoch: 11, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.563239574432373
Epoch: 12, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5847086906433105
Epoch: 13, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5981535911560059
Epoch: 14, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5647478103637695
Epoch: 15, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6385669708251953
Epoch: 16, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.204 Vali Acc: 0.467 Test Loss: 1.204 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5811059474945068
Epoch: 17, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5571832656860352
Epoch: 18, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 157875
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3087761402130127
Epoch: 1, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5316317081451416
Epoch: 2, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5907764434814453
Epoch: 3, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.4755134582519531
Epoch: 4, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5805904865264893
Epoch: 5, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.49430251121520996
Epoch: 6, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5070199966430664
Epoch: 7, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5074903964996338
Epoch: 8, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5580155849456787
Epoch: 9, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.5498194694519043
Epoch: 10, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.47936463356018066
Epoch: 11, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5338823795318604
Epoch: 12, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.546278715133667
Epoch: 13, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.46045708656311035
Epoch: 14, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4870750904083252
Epoch: 15, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5193130970001221
Epoch: 16, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.4509754180908203
Epoch: 17, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4834599494934082
Epoch: 18, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.480513334274292
Epoch: 19, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4573707580566406
Epoch: 20, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.242 Vali Acc: 0.400 Test Loss: 1.242 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.4592165946960449
Epoch: 21, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.425091028213501
Epoch: 22, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.276 Vali Acc: 0.400 Test Loss: 1.276 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.44405603408813477
Epoch: 23, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.303 Vali Acc: 0.400 Test Loss: 1.303 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.4035658836364746
Epoch: 24, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.4715230464935303
Epoch: 25, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.357 Vali Acc: 0.333 Test Loss: 1.357 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4342160224914551
Epoch: 26, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.376 Vali Acc: 0.333 Test Loss: 1.376 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 157875
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.290640115737915
Epoch: 1, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5253515243530273
Epoch: 2, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5881907939910889
Epoch: 3, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6046469211578369
Epoch: 4, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5760252475738525
Epoch: 5, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5393762588500977
Epoch: 6, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5422770977020264
Epoch: 7, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6345195770263672
Epoch: 8, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6306536197662354
Epoch: 9, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5798671245574951
Epoch: 10, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5678668022155762
Epoch: 11, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5810918807983398
Epoch: 12, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5600142478942871
Epoch: 13, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5875396728515625
Epoch: 14, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 157875
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.071361780166626
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4755713939666748
Epoch: 2, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.069 Vali Acc: 0.267 Test Loss: 1.069 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.5376253128051758
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.51590895652771
Epoch: 4, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.527350902557373
Epoch: 5, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5037131309509277
Epoch: 6, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.48596811294555664
Epoch: 7, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5542519092559814
Epoch: 8, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.513293981552124
Epoch: 9, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5024781227111816
Epoch: 10, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5339858531951904
Epoch: 11, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5514092445373535
Epoch: 12, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 0.47099900245666504
Epoch: 13, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5435044765472412
Epoch: 14, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.139 Vali Acc: 0.533 Test Loss: 1.139 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.533473014831543
Epoch: 15, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.143 Vali Acc: 0.533 Test Loss: 1.143 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5002753734588623
Epoch: 16, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.153 Vali Acc: 0.533 Test Loss: 1.153 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5399389266967773
Epoch: 17, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.158 Vali Acc: 0.533 Test Loss: 1.158 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5384244918823242
Epoch: 18, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5609092712402344
Epoch: 19, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5888893604278564
Epoch: 20, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6152422428131104
Epoch: 21, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5967147350311279
Epoch: 22, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5611450672149658
Epoch: 23, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5521292686462402
Epoch: 24, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.240 Vali Acc: 0.400 Test Loss: 1.240 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 328819
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3449623584747314
Epoch: 1, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5353312492370605
Epoch: 2, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.5129814147949219
Epoch: 3, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.5280654430389404
Epoch: 4, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5126192569732666
Epoch: 5, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5201830863952637
Epoch: 6, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5659744739532471
Epoch: 7, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5142507553100586
Epoch: 8, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5823166370391846
Epoch: 9, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6193993091583252
Epoch: 10, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5204105377197266
Epoch: 11, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5156044960021973
Epoch: 12, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 0.5258097648620605
Epoch: 13, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.48880791664123535
Epoch: 14, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.138 Vali Acc: 0.533 Test Loss: 1.138 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.4740738868713379
Epoch: 15, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.142 Vali Acc: 0.533 Test Loss: 1.142 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4461228847503662
Epoch: 16, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.49117112159729004
Epoch: 17, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.49709439277648926
Epoch: 18, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.48371219635009766
Epoch: 19, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5061659812927246
Epoch: 20, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4360032081604004
Epoch: 21, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.188 Vali Acc: 0.467 Test Loss: 1.188 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5804011821746826
Epoch: 22, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.198 Vali Acc: 0.467 Test Loss: 1.198 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4937901496887207
Epoch: 23, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.211 Vali Acc: 0.467 Test Loss: 1.211 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4744720458984375
Epoch: 24, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 328819
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.237169027328491
Epoch: 1, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5766627788543701
Epoch: 2, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.5175759792327881
Epoch: 3, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5497913360595703
Epoch: 4, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.54632568359375
Epoch: 5, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5345778465270996
Epoch: 6, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4621388912200928
Epoch: 7, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.4534769058227539
Epoch: 8, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5388038158416748
Epoch: 9, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5413737297058105
Epoch: 10, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5155551433563232
Epoch: 11, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4851200580596924
Epoch: 12, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6430532932281494
Epoch: 13, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5336732864379883
Epoch: 14, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6006925106048584
Epoch: 15, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5047585964202881
Epoch: 16, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.4621551036834717
Epoch: 17, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 328819
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0221519470214844
Epoch: 1, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.38996410369873047
Epoch: 2, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.39064574241638184
Epoch: 3, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4701354503631592
Epoch: 4, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.41509318351745605
Epoch: 5, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.386516809463501
Epoch: 6, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5138866901397705
Epoch: 7, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4958150386810303
Epoch: 8, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.45972609519958496
Epoch: 9, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4288051128387451
Epoch: 10, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.43117856979370117
Epoch: 11, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4464380741119385
Epoch: 12, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4437530040740967
Epoch: 13, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4393045902252197
Epoch: 14, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.44226741790771484
Epoch: 15, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.45947861671447754
Epoch: 16, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5553157329559326
Epoch: 17, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4601411819458008
Epoch: 18, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 328819
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.183501958847046
Epoch: 1, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4588284492492676
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47229576110839844
Epoch: 3, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5125269889831543
Epoch: 4, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4693610668182373
Epoch: 5, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.44931602478027344
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4935574531555176
Epoch: 7, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.229 Vali Acc: 0.200 Test Loss: 1.229 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.46002888679504395
Epoch: 8, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.235 Vali Acc: 0.133 Test Loss: 1.235 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.42590928077697754
Epoch: 9, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4871959686279297
Epoch: 10, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.512286901473999
Epoch: 11, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 197747
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1370022296905518
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5811948776245117
Epoch: 2, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.246 Vali Acc: 0.200 Test Loss: 1.246 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5817327499389648
Epoch: 3, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5550684928894043
Epoch: 4, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5776569843292236
Epoch: 5, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6228659152984619
Epoch: 6, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.56429123878479
Epoch: 7, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.620903491973877
Epoch: 8, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.6529979705810547
Epoch: 9, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.268 Vali Acc: 0.267 Test Loss: 1.268 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5655674934387207
Epoch: 10, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5692417621612549
Epoch: 11, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.283 Vali Acc: 0.200 Test Loss: 1.283 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5379283428192139
Epoch: 12, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.292 Vali Acc: 0.200 Test Loss: 1.292 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.582352876663208
Epoch: 13, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.295 Vali Acc: 0.267 Test Loss: 1.295 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5857114791870117
Epoch: 14, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.302 Vali Acc: 0.267 Test Loss: 1.302 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5935378074645996
Epoch: 15, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.304 Vali Acc: 0.267 Test Loss: 1.304 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5531232357025146
Epoch: 16, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.314 Vali Acc: 0.200 Test Loss: 1.314 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5839858055114746
Epoch: 17, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.317 Vali Acc: 0.200 Test Loss: 1.317 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6501240730285645
Epoch: 18, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.320 Vali Acc: 0.200 Test Loss: 1.320 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 197747
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.188600540161133
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4913954734802246
Epoch: 2, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.49292898178100586
Epoch: 3, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.49328064918518066
Epoch: 4, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.44289064407348633
Epoch: 5, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4277684688568115
Epoch: 6, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.5186550617218018
Epoch: 7, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4643392562866211
Epoch: 8, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5069923400878906
Epoch: 9, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.479109525680542
Epoch: 10, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4950418472290039
Epoch: 11, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5308215618133545
Epoch: 12, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5230767726898193
Epoch: 13, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5841307640075684
Epoch: 14, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5708677768707275
Epoch: 15, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5006716251373291
Epoch: 16, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 197747
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2033770084381104
Epoch: 1, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4901440143585205
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.46016836166381836
Epoch: 3, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.435288667678833
Epoch: 4, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5022749900817871
Epoch: 5, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4587688446044922
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.44966650009155273
Epoch: 7, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.526719331741333
Epoch: 8, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.216 Vali Acc: 0.200 Test Loss: 1.216 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.46941447257995605
Epoch: 9, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.480466365814209
Epoch: 10, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.49410128593444824
Epoch: 11, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.47444915771484375
Epoch: 12, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.238 Vali Acc: 0.333 Test Loss: 1.238 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4813230037689209
Epoch: 13, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.243 Vali Acc: 0.400 Test Loss: 1.243 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 0.5159752368927002
Epoch: 14, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4481391906738281
Epoch: 15, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4175422191619873
Epoch: 16, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4630599021911621
Epoch: 17, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4305233955383301
Epoch: 18, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.257 Vali Acc: 0.267 Test Loss: 1.257 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.41396427154541016
Epoch: 19, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4713757038116455
Epoch: 20, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4999358654022217
Epoch: 21, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.42284440994262695
Epoch: 22, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.268 Vali Acc: 0.267 Test Loss: 1.268 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.43747663497924805
Epoch: 23, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 197747
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.177654981613159
Epoch: 1, Steps: 1 | Train Loss: 1.279 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5391712188720703
Epoch: 2, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.5467772483825684
Epoch: 3, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.6957130432128906
Epoch: 4, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5384719371795654
Epoch: 5, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5511085987091064
Epoch: 6, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5562729835510254
Epoch: 7, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5829424858093262
Epoch: 8, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5087382793426514
Epoch: 9, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5364043712615967
Epoch: 10, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5362935066223145
Epoch: 11, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.48648858070373535
Epoch: 12, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5412540435791016
Epoch: 13, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5381770133972168
Epoch: 14, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5957272052764893
Epoch: 15, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 132211
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.274914503097534
Epoch: 1, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5220122337341309
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5428228378295898
Epoch: 3, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5305271148681641
Epoch: 4, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.48039674758911133
Epoch: 5, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4705665111541748
Epoch: 6, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.49745917320251465
Epoch: 7, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.43791842460632324
Epoch: 8, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.47350120544433594
Epoch: 9, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4736349582672119
Epoch: 10, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5192925930023193
Epoch: 11, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.45250368118286133
Epoch: 12, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4791910648345947
Epoch: 13, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.5289323329925537
Epoch: 14, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5820949077606201
Epoch: 15, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5678532123565674
Epoch: 16, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5173940658569336
Epoch: 17, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5576202869415283
Epoch: 18, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5407516956329346
Epoch: 19, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5878517627716064
Epoch: 20, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5524671077728271
Epoch: 21, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.4977717399597168
Epoch: 22, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5628609657287598
Epoch: 23, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 132211
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3450448513031006
Epoch: 1, Steps: 1 | Train Loss: 1.277 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.572258472442627
Epoch: 2, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6512813568115234
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5289549827575684
Epoch: 4, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6410207748413086
Epoch: 5, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6194746494293213
Epoch: 6, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5995497703552246
Epoch: 7, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5833947658538818
Epoch: 8, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5834639072418213
Epoch: 9, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5707006454467773
Epoch: 10, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.536531925201416
Epoch: 11, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.49901318550109863
Epoch: 12, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5185441970825195
Epoch: 13, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.5076806545257568
Epoch: 14, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6022515296936035
Epoch: 15, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5056073665618896
Epoch: 16, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4769878387451172
Epoch: 17, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5730252265930176
Epoch: 18, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5983238220214844
Epoch: 19, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.588446855545044
Epoch: 20, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5911133289337158
Epoch: 21, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6353514194488525
Epoch: 22, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6344523429870605
Epoch: 23, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 132211
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1609175205230713
Epoch: 1, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4326190948486328
Epoch: 2, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.4760420322418213
Epoch: 3, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.48883938789367676
Epoch: 4, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.44304704666137695
Epoch: 5, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.452373743057251
Epoch: 6, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.49503183364868164
Epoch: 7, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5120079517364502
Epoch: 8, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.47894716262817383
Epoch: 9, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4850759506225586
Epoch: 10, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.47646665573120117
Epoch: 11, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.48990964889526367
Epoch: 12, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.48220229148864746
Epoch: 13, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5330584049224854
Epoch: 14, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4328129291534424
Epoch: 15, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4607083797454834
Epoch: 16, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.41068553924560547
Epoch: 17, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.455219030380249
Epoch: 18, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 132211
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0466806888580322
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.43053245544433594
Epoch: 2, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.45526814460754395
Epoch: 3, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4463670253753662
Epoch: 4, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.49677062034606934
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.49844908714294434
Epoch: 6, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5195295810699463
Epoch: 7, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.545356035232544
Epoch: 8, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5159754753112793
Epoch: 9, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4869201183319092
Epoch: 10, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5080780982971191
Epoch: 11, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5174307823181152
Epoch: 12, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4565896987915039
Epoch: 13, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.472531795501709
Epoch: 14, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 99443
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.297999620437622
Epoch: 1, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.073 Vali Acc: 0.267 Test Loss: 1.073 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5266263484954834
Epoch: 2, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.070 Vali Acc: 0.200 Test Loss: 1.070 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48741984367370605
Epoch: 3, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.49738645553588867
Epoch: 4, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.44594335556030273
Epoch: 5, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.4745159149169922
Epoch: 6, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4554777145385742
Epoch: 7, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.46224260330200195
Epoch: 8, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.46816062927246094
Epoch: 9, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.073 Vali Acc: 0.267 Test Loss: 1.073 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.45479488372802734
Epoch: 10, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.44434428215026855
Epoch: 11, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.48981165885925293
Epoch: 12, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4665029048919678
Epoch: 13, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.44997644424438477
Epoch: 14, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4953467845916748
Epoch: 15, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4991145133972168
Epoch: 16, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.45007824897766113
Epoch: 17, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 99443
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.27384877204895
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5052633285522461
Epoch: 2, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.4963417053222656
Epoch: 3, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.46842169761657715
Epoch: 4, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 0.479278564453125
Epoch: 5, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.5395159721374512
Epoch: 6, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4773528575897217
Epoch: 7, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5247848033905029
Epoch: 8, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.561927080154419
Epoch: 9, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5513510704040527
Epoch: 10, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5784134864807129
Epoch: 11, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5867798328399658
Epoch: 12, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5597259998321533
Epoch: 13, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5631310939788818
Epoch: 14, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.615267276763916
Epoch: 15, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.518035888671875
Epoch: 16, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5155949592590332
Epoch: 17, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4727015495300293
Epoch: 18, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 99443
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8794267177581787
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.4259796142578125
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.42655372619628906
Epoch: 3, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.478010892868042
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.022 Vali Acc: 0.733 Test Loss: 1.022 Test Acc: 0.733
Validation loss decreased (-0.599990 --> -0.733323).  Saving model ...
Epoch: 5 cost time: 0.44876933097839355
Epoch: 5, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.021 Vali Acc: 0.800 Test Loss: 1.021 Test Acc: 0.800
Validation loss decreased (-0.733323 --> -0.799990).  Saving model ...
Epoch: 6 cost time: 0.47556161880493164
Epoch: 6, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.022 Vali Acc: 0.800 Test Loss: 1.022 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.46450281143188477
Epoch: 7, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.023 Vali Acc: 0.733 Test Loss: 1.023 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4548335075378418
Epoch: 8, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4761478900909424
Epoch: 9, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.49031853675842285
Epoch: 10, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.49362778663635254
Epoch: 11, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4606056213378906
Epoch: 12, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5043587684631348
Epoch: 13, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.042 Vali Acc: 0.667 Test Loss: 1.042 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5203285217285156
Epoch: 14, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.45778799057006836
Epoch: 15, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.8
model parameter : 99443
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.111736536026001
Epoch: 1, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.39814162254333496
Epoch: 2, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5009973049163818
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5226902961730957
Epoch: 4, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4977753162384033
Epoch: 5, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4426536560058594
Epoch: 6, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5095160007476807
Epoch: 7, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4754340648651123
Epoch: 8, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5310029983520508
Epoch: 9, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5508854389190674
Epoch: 10, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.47742247581481934
Epoch: 11, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5174076557159424
Epoch: 12, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4825432300567627
Epoch: 13, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 83059
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.878126859664917
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.40749502182006836
Epoch: 2, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45641350746154785
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.38642382621765137
Epoch: 4, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4598371982574463
Epoch: 5, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.42815470695495605
Epoch: 6, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4602241516113281
Epoch: 7, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.48301219940185547
Epoch: 8, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4650146961212158
Epoch: 9, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.46683430671691895
Epoch: 10, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.49750447273254395
Epoch: 11, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 83059
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2631256580352783
Epoch: 1, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4840998649597168
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5280249118804932
Epoch: 3, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5188159942626953
Epoch: 4, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5085704326629639
Epoch: 5, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5148978233337402
Epoch: 6, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4672544002532959
Epoch: 7, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4733924865722656
Epoch: 8, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.479229211807251
Epoch: 9, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.45225954055786133
Epoch: 10, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.4738430976867676
Epoch: 11, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4637727737426758
Epoch: 12, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5207509994506836
Epoch: 13, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5724959373474121
Epoch: 14, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4714186191558838
Epoch: 15, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5093755722045898
Epoch: 16, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5137274265289307
Epoch: 17, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.48172497749328613
Epoch: 18, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4571363925933838
Epoch: 19, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.41561126708984375
Epoch: 20, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 83059
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.048656463623047
Epoch: 1, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5418977737426758
Epoch: 2, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4920077323913574
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5426352024078369
Epoch: 4, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.4972686767578125
Epoch: 5, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5320580005645752
Epoch: 6, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5409815311431885
Epoch: 7, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4819157123565674
Epoch: 8, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5198709964752197
Epoch: 9, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5491032600402832
Epoch: 10, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4921989440917969
Epoch: 11, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5762357711791992
Epoch: 12, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5310988426208496
Epoch: 13, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5196845531463623
Epoch: 14, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5616629123687744
Epoch: 15, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 83059
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3656976222991943
Epoch: 1, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.504000186920166
Epoch: 2, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.49181127548217773
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.44989752769470215
Epoch: 4, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4580566883087158
Epoch: 5, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5298886299133301
Epoch: 6, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4472799301147461
Epoch: 7, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.48696208000183105
Epoch: 8, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5090832710266113
Epoch: 9, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.46991777420043945
Epoch: 10, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.475506067276001
Epoch: 11, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5417530536651611
Epoch: 12, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 74867
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.202672243118286
Epoch: 1, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.46474194526672363
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.4374518394470215
Epoch: 3, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4635810852050781
Epoch: 4, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.44025230407714844
Epoch: 5, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5241084098815918
Epoch: 6, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.46263861656188965
Epoch: 7, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4774646759033203
Epoch: 8, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.48340821266174316
Epoch: 9, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5061900615692139
Epoch: 10, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5069525241851807
Epoch: 11, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4581260681152344
Epoch: 12, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 74867
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.016618251800537
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.4766104221343994
Epoch: 2, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.493760347366333
Epoch: 3, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.47010278701782227
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4596853256225586
Epoch: 5, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4648606777191162
Epoch: 6, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5320711135864258
Epoch: 7, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5157554149627686
Epoch: 8, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4749593734741211
Epoch: 9, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4394567012786865
Epoch: 10, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.43665027618408203
Epoch: 11, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 74867
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.278074026107788
Epoch: 1, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5158724784851074
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6116235256195068
Epoch: 3, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5039796829223633
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5577027797698975
Epoch: 5, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5392787456512451
Epoch: 6, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5564210414886475
Epoch: 7, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5667743682861328
Epoch: 8, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.563361644744873
Epoch: 9, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5535359382629395
Epoch: 10, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5072789192199707
Epoch: 11, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4697227478027344
Epoch: 12, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.47668027877807617
Epoch: 13, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5045487880706787
Epoch: 14, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5228936672210693
Epoch: 15, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5596985816955566
Epoch: 16, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5066807270050049
Epoch: 17, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5150480270385742
Epoch: 18, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 74867
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3101248741149902
Epoch: 1, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.5038435459136963
Epoch: 2, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5215742588043213
Epoch: 3, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.235 Vali Acc: 0.200 Test Loss: 1.235 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5548980236053467
Epoch: 4, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5099425315856934
Epoch: 5, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.241 Vali Acc: 0.200 Test Loss: 1.241 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5080809593200684
Epoch: 6, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.287 Vali Acc: 0.133 Test Loss: 1.287 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.500720739364624
Epoch: 7, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.313 Vali Acc: 0.200 Test Loss: 1.313 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5233912467956543
Epoch: 8, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.362 Vali Acc: 0.200 Test Loss: 1.362 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5455257892608643
Epoch: 9, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.472 Vali Acc: 0.267 Test Loss: 1.472 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4883251190185547
Epoch: 10, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.546 Vali Acc: 0.267 Test Loss: 1.546 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.47173333168029785
Epoch: 11, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.666 Vali Acc: 0.333 Test Loss: 1.666 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333317).  Saving model ...
Epoch: 12 cost time: 0.428297758102417
Epoch: 12, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.730 Vali Acc: 0.267 Test Loss: 1.730 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5194129943847656
Epoch: 13, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.847 Vali Acc: 0.200 Test Loss: 1.847 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.501617431640625
Epoch: 14, Steps: 1 | Train Loss: 0.006 Vali Loss: 2.032 Vali Acc: 0.267 Test Loss: 2.032 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5140745639801025
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.236 Vali Acc: 0.267 Test Loss: 2.236 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.49210643768310547
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.435 Vali Acc: 0.267 Test Loss: 2.435 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5124824047088623
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.625 Vali Acc: 0.267 Test Loss: 2.625 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5360867977142334
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.802 Vali Acc: 0.267 Test Loss: 2.802 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5090088844299316
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.970 Vali Acc: 0.267 Test Loss: 2.970 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5784046649932861
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.129 Vali Acc: 0.267 Test Loss: 3.129 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5045933723449707
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.279 Vali Acc: 0.267 Test Loss: 3.279 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3615771
model size : 23.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0835914611816406
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4731438159942627
Epoch: 2, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48047351837158203
Epoch: 3, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5256617069244385
Epoch: 4, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5404202938079834
Epoch: 5, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5023140907287598
Epoch: 6, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.228 Vali Acc: 0.200 Test Loss: 1.228 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4970548152923584
Epoch: 7, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.250 Vali Acc: 0.200 Test Loss: 1.250 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5208382606506348
Epoch: 8, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.287 Vali Acc: 0.267 Test Loss: 1.287 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.48166894912719727
Epoch: 9, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.365 Vali Acc: 0.267 Test Loss: 1.365 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4896230697631836
Epoch: 10, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.428 Vali Acc: 0.400 Test Loss: 1.428 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 0.4778001308441162
Epoch: 11, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.522 Vali Acc: 0.333 Test Loss: 1.522 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4307212829589844
Epoch: 12, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.586 Vali Acc: 0.333 Test Loss: 1.586 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5351974964141846
Epoch: 13, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.745 Vali Acc: 0.267 Test Loss: 1.745 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5131635665893555
Epoch: 14, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.937 Vali Acc: 0.267 Test Loss: 1.937 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4496777057647705
Epoch: 15, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.124 Vali Acc: 0.267 Test Loss: 2.124 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4584159851074219
Epoch: 16, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.291 Vali Acc: 0.267 Test Loss: 2.291 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4680500030517578
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.445 Vali Acc: 0.400 Test Loss: 2.445 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4812021255493164
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.584 Vali Acc: 0.400 Test Loss: 2.584 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5896289348602295
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.714 Vali Acc: 0.333 Test Loss: 2.714 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4989447593688965
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.833 Vali Acc: 0.333 Test Loss: 2.833 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3615771
model size : 23.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0752339363098145
Epoch: 1, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5038638114929199
Epoch: 2, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46642470359802246
Epoch: 3, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4670560359954834
Epoch: 4, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.152 Vali Acc: 0.133 Test Loss: 1.152 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.545886754989624
Epoch: 5, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.49312782287597656
Epoch: 6, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.515904426574707
Epoch: 7, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.214 Vali Acc: 0.133 Test Loss: 1.214 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.48969030380249023
Epoch: 8, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.232 Vali Acc: 0.200 Test Loss: 1.232 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.48437047004699707
Epoch: 9, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333320).  Saving model ...
Epoch: 10 cost time: 0.4331943988800049
Epoch: 10, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.343 Vali Acc: 0.267 Test Loss: 1.343 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4195365905761719
Epoch: 11, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.409 Vali Acc: 0.200 Test Loss: 1.409 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.46117639541625977
Epoch: 12, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.462 Vali Acc: 0.200 Test Loss: 1.462 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.48050665855407715
Epoch: 13, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.626 Vali Acc: 0.267 Test Loss: 1.626 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.49106478691101074
Epoch: 14, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.800 Vali Acc: 0.200 Test Loss: 1.800 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4966928958892822
Epoch: 15, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.937 Vali Acc: 0.267 Test Loss: 1.937 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5301554203033447
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 2.003 Vali Acc: 0.267 Test Loss: 2.003 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5179874897003174
Epoch: 17, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.047 Vali Acc: 0.200 Test Loss: 2.047 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5550925731658936
Epoch: 18, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.089 Vali Acc: 0.267 Test Loss: 2.089 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.4971647262573242
Epoch: 19, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.133 Vali Acc: 0.267 Test Loss: 2.133 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3615771
model size : 23.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0569067001342773
Epoch: 1, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.138 Vali Acc: 0.133 Test Loss: 1.138 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.43320250511169434
Epoch: 2, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.49025726318359375
Epoch: 3, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.500032901763916
Epoch: 4, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4741694927215576
Epoch: 5, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.45751380920410156
Epoch: 6, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4689018726348877
Epoch: 7, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4436764717102051
Epoch: 8, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.42284727096557617
Epoch: 9, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.46698832511901855
Epoch: 10, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5024454593658447
Epoch: 11, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.49677324295043945
Epoch: 12, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.295 Vali Acc: 0.133 Test Loss: 1.295 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5041162967681885
Epoch: 13, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.348 Vali Acc: 0.200 Test Loss: 1.348 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5017385482788086
Epoch: 14, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.373 Vali Acc: 0.133 Test Loss: 1.373 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4736933708190918
Epoch: 15, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.418 Vali Acc: 0.200 Test Loss: 1.418 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.489621639251709
Epoch: 16, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.479 Vali Acc: 0.200 Test Loss: 1.479 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3615771
model size : 23.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2350823879241943
Epoch: 1, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.506458044052124
Epoch: 2, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5614233016967773
Epoch: 3, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5296545028686523
Epoch: 4, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5082581043243408
Epoch: 5, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5556313991546631
Epoch: 6, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6126499176025391
Epoch: 7, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4899423122406006
Epoch: 8, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5199296474456787
Epoch: 9, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.360 Vali Acc: 0.333 Test Loss: 1.360 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.48459625244140625
Epoch: 10, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.445 Vali Acc: 0.333 Test Loss: 1.445 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5458030700683594
Epoch: 11, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.509 Vali Acc: 0.200 Test Loss: 1.509 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2567195
model size : 19.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8952257633209229
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.44110655784606934
Epoch: 2, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5040044784545898
Epoch: 3, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.45487260818481445
Epoch: 4, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.43652963638305664
Epoch: 5, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.49976396560668945
Epoch: 6, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4998762607574463
Epoch: 7, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.47547101974487305
Epoch: 8, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.47485804557800293
Epoch: 9, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.312 Vali Acc: 0.267 Test Loss: 1.312 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4746692180633545
Epoch: 10, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.367 Vali Acc: 0.333 Test Loss: 1.367 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4879608154296875
Epoch: 11, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.405 Vali Acc: 0.267 Test Loss: 1.405 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5590026378631592
Epoch: 12, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.525 Vali Acc: 0.267 Test Loss: 1.525 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2567195
model size : 19.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0959460735321045
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5212388038635254
Epoch: 2, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5488955974578857
Epoch: 3, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5947697162628174
Epoch: 4, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.547874927520752
Epoch: 5, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5027496814727783
Epoch: 6, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.567765474319458
Epoch: 7, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5350844860076904
Epoch: 8, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5499186515808105
Epoch: 9, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.254 Vali Acc: 0.200 Test Loss: 1.254 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6136784553527832
Epoch: 10, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.305 Vali Acc: 0.267 Test Loss: 1.305 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5133037567138672
Epoch: 11, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.349 Vali Acc: 0.200 Test Loss: 1.349 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2567195
model size : 19.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.956554889678955
Epoch: 1, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.118 Vali Acc: 0.133 Test Loss: 1.118 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.4696025848388672
Epoch: 2, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.133322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.45858216285705566
Epoch: 3, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.48540496826171875
Epoch: 4, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4852161407470703
Epoch: 5, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.48355817794799805
Epoch: 6, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.506171703338623
Epoch: 7, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5279459953308105
Epoch: 8, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5250732898712158
Epoch: 9, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.501215934753418
Epoch: 10, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5217068195343018
Epoch: 11, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.229 Vali Acc: 0.200 Test Loss: 1.229 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5207085609436035
Epoch: 12, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2567195
model size : 19.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.204749584197998
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5458390712738037
Epoch: 2, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5515694618225098
Epoch: 3, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5459232330322266
Epoch: 4, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5750465393066406
Epoch: 5, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.585716724395752
Epoch: 6, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6634275913238525
Epoch: 7, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5847277641296387
Epoch: 8, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5872015953063965
Epoch: 9, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.318 Vali Acc: 0.400 Test Loss: 1.318 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6264493465423584
Epoch: 10, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.375 Vali Acc: 0.400 Test Loss: 1.375 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5966978073120117
Epoch: 11, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.447 Vali Acc: 0.400 Test Loss: 1.447 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6012475490570068
Epoch: 12, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.571 Vali Acc: 0.400 Test Loss: 1.571 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5798990726470947
Epoch: 13, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.731 Vali Acc: 0.400 Test Loss: 1.731 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.578718900680542
Epoch: 14, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.901 Vali Acc: 0.400 Test Loss: 1.901 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2042907
model size : 17.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.242915630340576
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.5225322246551514
Epoch: 2, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5321617126464844
Epoch: 3, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.5603103637695312
Epoch: 4, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5393154621124268
Epoch: 5, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5437483787536621
Epoch: 6, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5041530132293701
Epoch: 7, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4766571521759033
Epoch: 8, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5819876194000244
Epoch: 9, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.224 Vali Acc: 0.467 Test Loss: 1.224 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.550300121307373
Epoch: 10, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.257 Vali Acc: 0.467 Test Loss: 1.257 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6201221942901611
Epoch: 11, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.317 Vali Acc: 0.400 Test Loss: 1.317 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6607987880706787
Epoch: 12, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.443 Vali Acc: 0.467 Test Loss: 1.443 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.518991231918335
Epoch: 13, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.612 Vali Acc: 0.533 Test Loss: 1.612 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533317).  Saving model ...
Epoch: 14 cost time: 0.6042962074279785
Epoch: 14, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.770 Vali Acc: 0.467 Test Loss: 1.770 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5366535186767578
Epoch: 15, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.906 Vali Acc: 0.467 Test Loss: 1.906 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.48718976974487305
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.022 Vali Acc: 0.467 Test Loss: 2.022 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5846424102783203
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.130 Vali Acc: 0.467 Test Loss: 2.130 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5433461666107178
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.231 Vali Acc: 0.400 Test Loss: 2.231 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.512274980545044
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.329 Vali Acc: 0.400 Test Loss: 2.329 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6131381988525391
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.422 Vali Acc: 0.333 Test Loss: 2.422 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5256936550140381
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.511 Vali Acc: 0.333 Test Loss: 2.511 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5046579837799072
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.596 Vali Acc: 0.333 Test Loss: 2.596 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5354599952697754
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.677 Vali Acc: 0.333 Test Loss: 2.677 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2042907
model size : 17.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.156275749206543
Epoch: 1, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5318067073822021
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5519258975982666
Epoch: 3, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5651533603668213
Epoch: 4, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.5117385387420654
Epoch: 5, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.589714765548706
Epoch: 6, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4614276885986328
Epoch: 7, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5106625556945801
Epoch: 8, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5943868160247803
Epoch: 9, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5330965518951416
Epoch: 10, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4604196548461914
Epoch: 11, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.309 Vali Acc: 0.267 Test Loss: 1.309 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5089333057403564
Epoch: 12, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.417 Vali Acc: 0.333 Test Loss: 1.417 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5706124305725098
Epoch: 13, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.530 Vali Acc: 0.333 Test Loss: 1.530 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5608212947845459
Epoch: 14, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.621 Vali Acc: 0.267 Test Loss: 1.621 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2042907
model size : 17.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1981961727142334
Epoch: 1, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4992105960845947
Epoch: 2, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4979410171508789
Epoch: 3, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.587897777557373
Epoch: 4, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5113060474395752
Epoch: 5, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5741665363311768
Epoch: 6, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.569270133972168
Epoch: 7, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5314323902130127
Epoch: 8, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.486175537109375
Epoch: 9, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5011739730834961
Epoch: 10, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.499453067779541
Epoch: 11, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.558875322341919
Epoch: 12, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5569744110107422
Epoch: 13, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.348 Vali Acc: 0.267 Test Loss: 1.348 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5929739475250244
Epoch: 14, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.352 Vali Acc: 0.267 Test Loss: 1.352 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.558652400970459
Epoch: 15, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.397 Vali Acc: 0.200 Test Loss: 1.397 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5257611274719238
Epoch: 16, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.470 Vali Acc: 0.200 Test Loss: 1.470 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5398247241973877
Epoch: 17, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.569 Vali Acc: 0.267 Test Loss: 1.569 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5454869270324707
Epoch: 18, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.672 Vali Acc: 0.333 Test Loss: 1.672 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2042907
model size : 17.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2667324542999268
Epoch: 1, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.170 Vali Acc: 0.467 Test Loss: 1.170 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.5376484394073486
Epoch: 2, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.5542416572570801
Epoch: 3, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.5299084186553955
Epoch: 4, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5506539344787598
Epoch: 5, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5085785388946533
Epoch: 6, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5310478210449219
Epoch: 7, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5858485698699951
Epoch: 8, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5144331455230713
Epoch: 9, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.346 Vali Acc: 0.267 Test Loss: 1.346 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5778908729553223
Epoch: 10, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.337 Vali Acc: 0.267 Test Loss: 1.337 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5374391078948975
Epoch: 11, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.502 Vali Acc: 0.333 Test Loss: 1.502 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5675623416900635
Epoch: 12, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.573 Vali Acc: 0.400 Test Loss: 1.573 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5917820930480957
Epoch: 13, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.669 Vali Acc: 0.267 Test Loss: 1.669 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1780763
model size : 16.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.321624755859375
Epoch: 1, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.5254247188568115
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.614429235458374
Epoch: 3, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5137739181518555
Epoch: 4, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5510733127593994
Epoch: 5, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5329208374023438
Epoch: 6, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5294029712677002
Epoch: 7, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5062987804412842
Epoch: 8, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5332489013671875
Epoch: 9, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.297 Vali Acc: 0.267 Test Loss: 1.297 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5095133781433105
Epoch: 10, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.293 Vali Acc: 0.333 Test Loss: 1.293 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5283098220825195
Epoch: 11, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.429 Vali Acc: 0.400 Test Loss: 1.429 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5434694290161133
Epoch: 12, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.485 Vali Acc: 0.467 Test Loss: 1.485 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1780763
model size : 16.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1924753189086914
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 0.42998743057250977
Epoch: 2, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4294466972351074
Epoch: 3, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.43221139907836914
Epoch: 4, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.46974635124206543
Epoch: 5, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.42581725120544434
Epoch: 6, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4811725616455078
Epoch: 7, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4146552085876465
Epoch: 8, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4786813259124756
Epoch: 9, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5057806968688965
Epoch: 10, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5044634342193604
Epoch: 11, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.331 Vali Acc: 0.333 Test Loss: 1.331 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1780763
model size : 16.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3275930881500244
Epoch: 1, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.49944472312927246
Epoch: 2, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.48528528213500977
Epoch: 3, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5160582065582275
Epoch: 4, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5136375427246094
Epoch: 5, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5140299797058105
Epoch: 6, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5107684135437012
Epoch: 7, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5523848533630371
Epoch: 8, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5018646717071533
Epoch: 9, Steps: 1 | Train Loss: 0.434 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.48352575302124023
Epoch: 10, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5037598609924316
Epoch: 11, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5159282684326172
Epoch: 12, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1780763
model size : 16.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9266726970672607
Epoch: 1, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5083115100860596
Epoch: 2, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.48671817779541016
Epoch: 3, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4773397445678711
Epoch: 4, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5278472900390625
Epoch: 5, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.46230220794677734
Epoch: 6, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.46747446060180664
Epoch: 7, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5311362743377686
Epoch: 8, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5029270648956299
Epoch: 9, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.369 Vali Acc: 0.200 Test Loss: 1.369 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5426123142242432
Epoch: 10, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.414 Vali Acc: 0.400 Test Loss: 1.414 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.49948716163635254
Epoch: 11, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.497 Vali Acc: 0.333 Test Loss: 1.497 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.49820828437805176
Epoch: 12, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.675 Vali Acc: 0.333 Test Loss: 1.675 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1649691
model size : 16.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.172017812728882
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5161805152893066
Epoch: 2, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.465609073638916
Epoch: 3, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5050802230834961
Epoch: 4, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5397534370422363
Epoch: 5, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.216 Vali Acc: 0.200 Test Loss: 1.216 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4874138832092285
Epoch: 6, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5331954956054688
Epoch: 7, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5257296562194824
Epoch: 8, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.306 Vali Acc: 0.267 Test Loss: 1.306 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5672447681427002
Epoch: 9, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.361 Vali Acc: 0.267 Test Loss: 1.361 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5221431255340576
Epoch: 10, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.393 Vali Acc: 0.333 Test Loss: 1.393 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333319).  Saving model ...
Epoch: 11 cost time: 0.5340096950531006
Epoch: 11, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.448 Vali Acc: 0.267 Test Loss: 1.448 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6356909275054932
Epoch: 12, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.605 Vali Acc: 0.267 Test Loss: 1.605 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5435452461242676
Epoch: 13, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.783 Vali Acc: 0.400 Test Loss: 1.783 Test Acc: 0.400
Validation loss decreased (-0.333319 --> -0.399982).  Saving model ...
Epoch: 14 cost time: 0.5196473598480225
Epoch: 14, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.945 Vali Acc: 0.333 Test Loss: 1.945 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5223522186279297
Epoch: 15, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.070 Vali Acc: 0.333 Test Loss: 2.070 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.48965024948120117
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.175 Vali Acc: 0.400 Test Loss: 2.175 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5042092800140381
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.268 Vali Acc: 0.400 Test Loss: 2.268 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5032520294189453
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.356 Vali Acc: 0.400 Test Loss: 2.356 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4959750175476074
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.442 Vali Acc: 0.333 Test Loss: 2.442 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4861011505126953
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.526 Vali Acc: 0.333 Test Loss: 2.526 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5050139427185059
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.608 Vali Acc: 0.333 Test Loss: 2.608 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5848150253295898
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.688 Vali Acc: 0.333 Test Loss: 2.688 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5141339302062988
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.763 Vali Acc: 0.333 Test Loss: 2.763 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1649691
model size : 16.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0482921600341797
Epoch: 1, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.147 Vali Acc: 0.000 Test Loss: 1.147 Test Acc: 0.000
Validation loss decreased (inf --> 0.000011).  Saving model ...
Epoch: 2 cost time: 0.5542247295379639
Epoch: 2, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (0.000011 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5692734718322754
Epoch: 3, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.583747148513794
Epoch: 4, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.604283332824707
Epoch: 5, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.541712760925293
Epoch: 6, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.5924170017242432
Epoch: 7, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.47480177879333496
Epoch: 8, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.49294400215148926
Epoch: 9, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5205881595611572
Epoch: 10, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.293 Vali Acc: 0.333 Test Loss: 1.293 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.556135892868042
Epoch: 11, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.349 Vali Acc: 0.333 Test Loss: 1.349 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5532350540161133
Epoch: 12, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.482 Vali Acc: 0.333 Test Loss: 1.482 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6067209243774414
Epoch: 13, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.600 Vali Acc: 0.267 Test Loss: 1.600 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5413227081298828
Epoch: 14, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.682 Vali Acc: 0.333 Test Loss: 1.682 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5284304618835449
Epoch: 15, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.748 Vali Acc: 0.333 Test Loss: 1.748 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5568621158599854
Epoch: 16, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.823 Vali Acc: 0.333 Test Loss: 1.823 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1649691
model size : 16.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2375614643096924
Epoch: 1, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5727903842926025
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.505742073059082
Epoch: 3, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5137209892272949
Epoch: 4, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.550072193145752
Epoch: 5, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5022578239440918
Epoch: 6, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4778921604156494
Epoch: 7, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5556559562683105
Epoch: 8, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.464125394821167
Epoch: 9, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.46151137351989746
Epoch: 10, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4408383369445801
Epoch: 11, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.47432947158813477
Epoch: 12, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.46637988090515137
Epoch: 13, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1649691
model size : 16.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1583025455474854
Epoch: 1, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5756685733795166
Epoch: 2, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5858497619628906
Epoch: 3, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5065169334411621
Epoch: 4, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5162789821624756
Epoch: 5, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.195 Vali Acc: 0.200 Test Loss: 1.195 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5344362258911133
Epoch: 6, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5258409976959229
Epoch: 7, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5648419857025146
Epoch: 8, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.323 Vali Acc: 0.267 Test Loss: 1.323 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6172163486480713
Epoch: 9, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.417 Vali Acc: 0.467 Test Loss: 1.417 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466652).  Saving model ...
Epoch: 10 cost time: 0.568164587020874
Epoch: 10, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.501 Vali Acc: 0.333 Test Loss: 1.501 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.535459041595459
Epoch: 11, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.584 Vali Acc: 0.267 Test Loss: 1.584 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5425412654876709
Epoch: 12, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.738 Vali Acc: 0.333 Test Loss: 1.738 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5094108581542969
Epoch: 13, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.913 Vali Acc: 0.333 Test Loss: 1.913 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5886297225952148
Epoch: 14, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.088 Vali Acc: 0.333 Test Loss: 2.088 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6088976860046387
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.258 Vali Acc: 0.333 Test Loss: 2.258 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.626413106918335
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.420 Vali Acc: 0.333 Test Loss: 2.420 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5054585933685303
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.575 Vali Acc: 0.333 Test Loss: 2.575 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5333704948425293
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.723 Vali Acc: 0.333 Test Loss: 2.723 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.572908878326416
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.862 Vali Acc: 0.333 Test Loss: 2.862 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1584155
model size : 15.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.975172996520996
Epoch: 1, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.41760849952697754
Epoch: 2, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40398550033569336
Epoch: 3, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.40134263038635254
Epoch: 4, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.44197916984558105
Epoch: 5, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4465668201446533
Epoch: 6, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4889223575592041
Epoch: 7, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.46428632736206055
Epoch: 8, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.43834924697875977
Epoch: 9, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4522862434387207
Epoch: 10, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.325 Vali Acc: 0.333 Test Loss: 1.325 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5023612976074219
Epoch: 11, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.412 Vali Acc: 0.333 Test Loss: 1.412 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.49959564208984375
Epoch: 12, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.608 Vali Acc: 0.400 Test Loss: 1.608 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5073282718658447
Epoch: 13, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.773 Vali Acc: 0.333 Test Loss: 1.773 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1584155
model size : 15.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.311246395111084
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.49776649475097656
Epoch: 2, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.531761884689331
Epoch: 3, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5129733085632324
Epoch: 4, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5491275787353516
Epoch: 5, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6149134635925293
Epoch: 6, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.504603385925293
Epoch: 7, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5293798446655273
Epoch: 8, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.49312710762023926
Epoch: 9, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5544557571411133
Epoch: 10, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.307 Vali Acc: 0.267 Test Loss: 1.307 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5151679515838623
Epoch: 11, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.381 Vali Acc: 0.267 Test Loss: 1.381 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1584155
model size : 15.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1533257961273193
Epoch: 1, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5287683010101318
Epoch: 2, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5480542182922363
Epoch: 3, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4815037250518799
Epoch: 4, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.44718122482299805
Epoch: 5, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4873661994934082
Epoch: 6, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5298871994018555
Epoch: 7, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5984454154968262
Epoch: 8, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5322222709655762
Epoch: 9, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5020341873168945
Epoch: 10, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5226151943206787
Epoch: 11, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5892362594604492
Epoch: 12, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.272 Vali Acc: 0.200 Test Loss: 1.272 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5684690475463867
Epoch: 13, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.325 Vali Acc: 0.200 Test Loss: 1.325 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5252792835235596
Epoch: 14, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.364 Vali Acc: 0.200 Test Loss: 1.364 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1584155
model size : 15.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.052499532699585
Epoch: 1, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.4934110641479492
Epoch: 2, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.463390588760376
Epoch: 3, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.47100353240966797
Epoch: 4, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4848625659942627
Epoch: 5, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.48938512802124023
Epoch: 6, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5426759719848633
Epoch: 7, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.48662376403808594
Epoch: 8, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4926748275756836
Epoch: 9, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5111362934112549
Epoch: 10, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.300 Vali Acc: 0.333 Test Loss: 1.300 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4602222442626953
Epoch: 11, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.351 Vali Acc: 0.267 Test Loss: 1.351 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.45302367210388184
Epoch: 12, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.398 Vali Acc: 0.333 Test Loss: 1.398 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4331016540527344
Epoch: 13, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.465 Vali Acc: 0.333 Test Loss: 1.465 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1676827
model size : 11.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.975006103515625
Epoch: 1, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5067167282104492
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45984363555908203
Epoch: 3, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.189 Vali Acc: 0.467 Test Loss: 1.189 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.4289994239807129
Epoch: 4, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.46305251121520996
Epoch: 5, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.192 Vali Acc: 0.467 Test Loss: 1.192 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5269148349761963
Epoch: 6, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4764695167541504
Epoch: 7, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.46376729011535645
Epoch: 8, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.275 Vali Acc: 0.333 Test Loss: 1.275 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4852738380432129
Epoch: 9, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6000218391418457
Epoch: 10, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.299 Vali Acc: 0.333 Test Loss: 1.299 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.492739200592041
Epoch: 11, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.336 Vali Acc: 0.333 Test Loss: 1.336 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4943728446960449
Epoch: 12, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.370 Vali Acc: 0.333 Test Loss: 1.370 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5013535022735596
Epoch: 13, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.441 Vali Acc: 0.333 Test Loss: 1.441 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1676827
model size : 11.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.181398391723633
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.43534159660339355
Epoch: 2, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.41120338439941406
Epoch: 3, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.185 Vali Acc: 0.533 Test Loss: 1.185 Test Acc: 0.533
Validation loss decreased (-0.399988 --> -0.533321).  Saving model ...
Epoch: 4 cost time: 0.49379849433898926
Epoch: 4, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.46674656867980957
Epoch: 5, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.42908191680908203
Epoch: 6, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5439777374267578
Epoch: 7, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.264 Vali Acc: 0.267 Test Loss: 1.264 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4486212730407715
Epoch: 8, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.288 Vali Acc: 0.333 Test Loss: 1.288 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4592008590698242
Epoch: 9, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.288 Vali Acc: 0.200 Test Loss: 1.288 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.46368861198425293
Epoch: 10, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.300 Vali Acc: 0.333 Test Loss: 1.300 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4586155414581299
Epoch: 11, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.327 Vali Acc: 0.400 Test Loss: 1.327 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.48671960830688477
Epoch: 12, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.354 Vali Acc: 0.400 Test Loss: 1.354 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4400501251220703
Epoch: 13, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.402 Vali Acc: 0.267 Test Loss: 1.402 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1676827
model size : 11.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.014420986175537
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4641706943511963
Epoch: 2, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45487308502197266
Epoch: 3, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4233212471008301
Epoch: 4, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.46790266036987305
Epoch: 5, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.44145655632019043
Epoch: 6, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4593188762664795
Epoch: 7, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.48312830924987793
Epoch: 8, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.42998552322387695
Epoch: 9, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4600212574005127
Epoch: 10, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4498894214630127
Epoch: 11, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5184726715087891
Epoch: 12, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.49777746200561523
Epoch: 13, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1676827
model size : 11.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1436891555786133
Epoch: 1, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.5072100162506104
Epoch: 2, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.5202949047088623
Epoch: 3, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5092532634735107
Epoch: 4, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.5356824398040771
Epoch: 5, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5224382877349854
Epoch: 6, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5912299156188965
Epoch: 7, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5737974643707275
Epoch: 8, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4751152992248535
Epoch: 9, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5108969211578369
Epoch: 10, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5257096290588379
Epoch: 11, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.258 Vali Acc: 0.200 Test Loss: 1.258 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5708661079406738
Epoch: 12, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.316 Vali Acc: 0.267 Test Loss: 1.316 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5520334243774414
Epoch: 13, Steps: 1 | Train Loss: 0.111 Vali Loss: 1.385 Vali Acc: 0.467 Test Loss: 1.385 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5480697154998779
Epoch: 14, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.460 Vali Acc: 0.400 Test Loss: 1.460 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1152539
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.134408950805664
Epoch: 1, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.48256635665893555
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47707605361938477
Epoch: 3, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5274319648742676
Epoch: 4, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5548238754272461
Epoch: 5, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5286300182342529
Epoch: 6, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.44512128829956055
Epoch: 7, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.44715452194213867
Epoch: 8, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4205625057220459
Epoch: 9, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4319746494293213
Epoch: 10, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.43009138107299805
Epoch: 11, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.248 Vali Acc: 0.200 Test Loss: 1.248 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1152539
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.304971933364868
Epoch: 1, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5606987476348877
Epoch: 2, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6344332695007324
Epoch: 3, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5621311664581299
Epoch: 4, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.487241268157959
Epoch: 5, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5268747806549072
Epoch: 6, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5510315895080566
Epoch: 7, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5312726497650146
Epoch: 8, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5439543724060059
Epoch: 9, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5178678035736084
Epoch: 10, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5050859451293945
Epoch: 11, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5409626960754395
Epoch: 12, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1152539
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0170388221740723
Epoch: 1, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4449198246002197
Epoch: 2, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.44582629203796387
Epoch: 3, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.43199753761291504
Epoch: 4, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4401423931121826
Epoch: 5, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5306301116943359
Epoch: 6, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4178447723388672
Epoch: 7, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.40987658500671387
Epoch: 8, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4223799705505371
Epoch: 9, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.38382554054260254
Epoch: 10, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.3972043991088867
Epoch: 11, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4085836410522461
Epoch: 12, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1152539
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.114046096801758
Epoch: 1, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.49605226516723633
Epoch: 2, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5019776821136475
Epoch: 3, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4959428310394287
Epoch: 4, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.45419931411743164
Epoch: 5, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5076289176940918
Epoch: 6, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.073 Vali Acc: 0.267 Test Loss: 1.073 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5331437587738037
Epoch: 7, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5400786399841309
Epoch: 8, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5248370170593262
Epoch: 9, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.501875638961792
Epoch: 10, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5318412780761719
Epoch: 11, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5136289596557617
Epoch: 12, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.275 Vali Acc: 0.400 Test Loss: 1.275 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 890395
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1624152660369873
Epoch: 1, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.46860575675964355
Epoch: 2, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5020170211791992
Epoch: 3, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.068 Vali Acc: 0.267 Test Loss: 1.068 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4883742332458496
Epoch: 4, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4548938274383545
Epoch: 5, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5521247386932373
Epoch: 6, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4693307876586914
Epoch: 7, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4667809009552002
Epoch: 8, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5027072429656982
Epoch: 9, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5131771564483643
Epoch: 10, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5363259315490723
Epoch: 11, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 890395
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.147078037261963
Epoch: 1, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5782272815704346
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5772912502288818
Epoch: 3, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5382041931152344
Epoch: 4, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5390975475311279
Epoch: 5, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5467803478240967
Epoch: 6, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5004630088806152
Epoch: 7, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5196988582611084
Epoch: 8, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4890453815460205
Epoch: 9, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.49310898780822754
Epoch: 10, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5201296806335449
Epoch: 11, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4998769760131836
Epoch: 12, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 890395
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2123935222625732
Epoch: 1, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4651467800140381
Epoch: 2, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4430835247039795
Epoch: 3, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.41385817527770996
Epoch: 4, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.44994688034057617
Epoch: 5, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4666774272918701
Epoch: 6, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.45091867446899414
Epoch: 7, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4364457130432129
Epoch: 8, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.460613489151001
Epoch: 9, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4463164806365967
Epoch: 10, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4560079574584961
Epoch: 11, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4250509738922119
Epoch: 12, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 890395
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.042759895324707
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5627715587615967
Epoch: 2, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4908158779144287
Epoch: 3, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5641698837280273
Epoch: 4, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4808473587036133
Epoch: 5, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5313842296600342
Epoch: 6, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.49717068672180176
Epoch: 7, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5169343948364258
Epoch: 8, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5052158832550049
Epoch: 9, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5084664821624756
Epoch: 10, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.515906572341919
Epoch: 11, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.296 Vali Acc: 0.267 Test Loss: 1.296 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.45629262924194336
Epoch: 12, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.363 Vali Acc: 0.333 Test Loss: 1.363 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 759323
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.104218006134033
Epoch: 1, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4894247055053711
Epoch: 2, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4196045398712158
Epoch: 3, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.42171788215637207
Epoch: 4, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4988391399383545
Epoch: 5, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.44300270080566406
Epoch: 6, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4457874298095703
Epoch: 7, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4403254985809326
Epoch: 8, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4580526351928711
Epoch: 9, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.40239787101745605
Epoch: 10, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.42441463470458984
Epoch: 11, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 759323
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.309542417526245
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4784228801727295
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4665513038635254
Epoch: 3, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5086855888366699
Epoch: 4, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5172388553619385
Epoch: 5, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.48590612411499023
Epoch: 6, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.45249152183532715
Epoch: 7, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5254309177398682
Epoch: 8, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6785845756530762
Epoch: 9, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5909678936004639
Epoch: 10, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.47014331817626953
Epoch: 11, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 759323
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2706031799316406
Epoch: 1, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5750527381896973
Epoch: 2, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5463151931762695
Epoch: 3, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49050092697143555
Epoch: 4, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5317583084106445
Epoch: 5, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4510986804962158
Epoch: 6, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5607748031616211
Epoch: 7, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.45059680938720703
Epoch: 8, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4795823097229004
Epoch: 9, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.47866225242614746
Epoch: 10, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.160 Vali Acc: 0.133 Test Loss: 1.160 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.44310426712036133
Epoch: 11, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.168 Vali Acc: 0.133 Test Loss: 1.168 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 759323
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2374422550201416
Epoch: 1, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.47892141342163086
Epoch: 2, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5001952648162842
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5658094882965088
Epoch: 4, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4905073642730713
Epoch: 5, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5517513751983643
Epoch: 6, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5594346523284912
Epoch: 7, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4831421375274658
Epoch: 8, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5720634460449219
Epoch: 9, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.261 Vali Acc: 0.133 Test Loss: 1.261 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.516991138458252
Epoch: 10, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.288 Vali Acc: 0.267 Test Loss: 1.288 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.47722792625427246
Epoch: 11, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.343 Vali Acc: 0.133 Test Loss: 1.343 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.45519375801086426
Epoch: 12, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.379 Vali Acc: 0.200 Test Loss: 1.379 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 693787
model size : 7.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1430416107177734
Epoch: 1, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5373663902282715
Epoch: 2, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4565999507904053
Epoch: 3, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4821507930755615
Epoch: 4, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5188066959381104
Epoch: 5, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.43070268630981445
Epoch: 6, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5023140907287598
Epoch: 7, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4699079990386963
Epoch: 8, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5618190765380859
Epoch: 9, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.216 Vali Acc: 0.200 Test Loss: 1.216 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.525348424911499
Epoch: 10, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.46085524559020996
Epoch: 11, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 693787
model size : 7.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4720141887664795
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4864039421081543
Epoch: 2, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5132710933685303
Epoch: 3, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.5110599994659424
Epoch: 4, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.47190189361572266
Epoch: 5, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5187973976135254
Epoch: 6, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5472867488861084
Epoch: 7, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.562321662902832
Epoch: 8, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.504326581954956
Epoch: 9, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5406355857849121
Epoch: 10, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5455572605133057
Epoch: 11, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5519442558288574
Epoch: 12, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5037593841552734
Epoch: 13, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 693787
model size : 7.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9631400108337402
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4282963275909424
Epoch: 2, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4144783020019531
Epoch: 3, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3962395191192627
Epoch: 4, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.40409421920776367
Epoch: 5, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4516935348510742
Epoch: 6, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.4084787368774414
Epoch: 7, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4284498691558838
Epoch: 8, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4671669006347656
Epoch: 9, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4247915744781494
Epoch: 10, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.3937797546386719
Epoch: 11, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.43236517906188965
Epoch: 12, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.170 Vali Acc: 0.133 Test Loss: 1.170 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4307889938354492
Epoch: 13, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.431354284286499
Epoch: 14, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.241 Vali Acc: 0.267 Test Loss: 1.241 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.48649144172668457
Epoch: 15, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.4644181728363037
Epoch: 16, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.260 Vali Acc: 0.200 Test Loss: 1.260 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 693787
model size : 7.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.285374641418457
Epoch: 1, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5025689601898193
Epoch: 2, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.6138765811920166
Epoch: 3, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.176 Vali Acc: 0.133 Test Loss: 1.176 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5031967163085938
Epoch: 4, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.177 Vali Acc: 0.133 Test Loss: 1.177 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.49323058128356934
Epoch: 5, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.179 Vali Acc: 0.067 Test Loss: 1.179 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5692012310028076
Epoch: 6, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.5011835098266602
Epoch: 7, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.5327966213226318
Epoch: 8, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.45493054389953613
Epoch: 9, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.266 Vali Acc: 0.133 Test Loss: 1.266 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4990253448486328
Epoch: 10, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.300 Vali Acc: 0.200 Test Loss: 1.300 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5356366634368896
Epoch: 11, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.366 Vali Acc: 0.200 Test Loss: 1.366 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5310914516448975
Epoch: 12, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.421 Vali Acc: 0.200 Test Loss: 1.421 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4779539108276367
Epoch: 13, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.472 Vali Acc: 0.200 Test Loss: 1.472 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5232043266296387
Epoch: 14, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.523 Vali Acc: 0.200 Test Loss: 1.523 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5636296272277832
Epoch: 15, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.596 Vali Acc: 0.267 Test Loss: 1.596 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4921846389770508
Epoch: 16, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.694 Vali Acc: 0.200 Test Loss: 1.694 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.49404120445251465
Epoch: 17, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.806 Vali Acc: 0.200 Test Loss: 1.806 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 661019
model size : 7.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1155574321746826
Epoch: 1, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.46611976623535156
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.48531007766723633
Epoch: 3, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4891834259033203
Epoch: 4, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4447627067565918
Epoch: 5, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5691976547241211
Epoch: 6, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.48566317558288574
Epoch: 7, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4858276844024658
Epoch: 8, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5178816318511963
Epoch: 9, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.265 Vali Acc: 0.200 Test Loss: 1.265 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5269069671630859
Epoch: 10, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.295 Vali Acc: 0.200 Test Loss: 1.295 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5241212844848633
Epoch: 11, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.351 Vali Acc: 0.267 Test Loss: 1.351 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5941345691680908
Epoch: 12, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.389 Vali Acc: 0.133 Test Loss: 1.389 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 661019
model size : 7.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0620598793029785
Epoch: 1, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.46959471702575684
Epoch: 2, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5019118785858154
Epoch: 3, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5058708190917969
Epoch: 4, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5147528648376465
Epoch: 5, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.599440336227417
Epoch: 6, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5013115406036377
Epoch: 7, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.5356831550598145
Epoch: 8, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5911591053009033
Epoch: 9, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5070700645446777
Epoch: 10, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.47665858268737793
Epoch: 11, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.306 Vali Acc: 0.133 Test Loss: 1.306 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5375120639801025
Epoch: 12, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.335 Vali Acc: 0.200 Test Loss: 1.335 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.45001959800720215
Epoch: 13, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.361 Vali Acc: 0.200 Test Loss: 1.361 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4656522274017334
Epoch: 14, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.390 Vali Acc: 0.200 Test Loss: 1.390 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5238971710205078
Epoch: 15, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.436 Vali Acc: 0.267 Test Loss: 1.436 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4963805675506592
Epoch: 16, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.520 Vali Acc: 0.067 Test Loss: 1.520 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5465197563171387
Epoch: 17, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.613 Vali Acc: 0.133 Test Loss: 1.613 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 661019
model size : 7.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.990725040435791
Epoch: 1, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.44565677642822266
Epoch: 2, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4668385982513428
Epoch: 3, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5103714466094971
Epoch: 4, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.128 Vali Acc: 0.133 Test Loss: 1.128 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4932272434234619
Epoch: 5, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.132 Vali Acc: 0.133 Test Loss: 1.132 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.47840261459350586
Epoch: 6, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.48702311515808105
Epoch: 7, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.4244072437286377
Epoch: 8, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.49480533599853516
Epoch: 9, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.46105122566223145
Epoch: 10, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4412667751312256
Epoch: 11, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.216 Vali Acc: 0.200 Test Loss: 1.216 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4803035259246826
Epoch: 12, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4657750129699707
Epoch: 13, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.49895310401916504
Epoch: 14, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.276 Vali Acc: 0.133 Test Loss: 1.276 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4611942768096924
Epoch: 15, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.297 Vali Acc: 0.200 Test Loss: 1.297 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.47779345512390137
Epoch: 16, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.341 Vali Acc: 0.267 Test Loss: 1.341 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.436753511428833
Epoch: 17, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.396 Vali Acc: 0.267 Test Loss: 1.396 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 661019
model size : 7.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.13381290435791
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5582005977630615
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5547580718994141
Epoch: 3, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5348963737487793
Epoch: 4, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5072264671325684
Epoch: 5, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5954713821411133
Epoch: 6, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6606638431549072
Epoch: 7, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5543649196624756
Epoch: 8, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6120400428771973
Epoch: 9, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6740517616271973
Epoch: 10, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8153996467590332
Epoch: 11, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6177759170532227
Epoch: 12, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.597048282623291
Epoch: 13, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.254 Vali Acc: 0.200 Test Loss: 1.254 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 805659
model size : 5.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.162576913833618
Epoch: 1, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.47720813751220703
Epoch: 2, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4552936553955078
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4349250793457031
Epoch: 4, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5262143611907959
Epoch: 5, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4268465042114258
Epoch: 6, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.48252248764038086
Epoch: 7, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5574228763580322
Epoch: 8, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4699108600616455
Epoch: 9, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.478740930557251
Epoch: 10, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4632883071899414
Epoch: 11, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5826554298400879
Epoch: 12, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.236 Vali Acc: 0.400 Test Loss: 1.236 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.5970094203948975
Epoch: 13, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5534877777099609
Epoch: 14, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.264 Vali Acc: 0.267 Test Loss: 1.264 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.49601125717163086
Epoch: 15, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.285 Vali Acc: 0.267 Test Loss: 1.285 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5650603771209717
Epoch: 16, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.322 Vali Acc: 0.267 Test Loss: 1.322 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5354609489440918
Epoch: 17, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.378 Vali Acc: 0.333 Test Loss: 1.378 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.48285913467407227
Epoch: 18, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.450 Vali Acc: 0.333 Test Loss: 1.450 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6008515357971191
Epoch: 19, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.511 Vali Acc: 0.400 Test Loss: 1.511 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5529770851135254
Epoch: 20, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.559 Vali Acc: 0.333 Test Loss: 1.559 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5743191242218018
Epoch: 21, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.610 Vali Acc: 0.267 Test Loss: 1.610 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.525963544845581
Epoch: 22, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.657 Vali Acc: 0.267 Test Loss: 1.657 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 805659
model size : 5.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.941223382949829
Epoch: 1, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4189009666442871
Epoch: 2, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.4053313732147217
Epoch: 3, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.4865086078643799
Epoch: 4, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.44440627098083496
Epoch: 5, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.3910214900970459
Epoch: 6, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4172227382659912
Epoch: 7, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4492671489715576
Epoch: 8, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.44073486328125
Epoch: 9, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.203 Vali Acc: 0.133 Test Loss: 1.203 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.45116710662841797
Epoch: 10, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.47677016258239746
Epoch: 11, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.241 Vali Acc: 0.267 Test Loss: 1.241 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4074127674102783
Epoch: 12, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.41539454460144043
Epoch: 13, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 805659
model size : 5.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1472699642181396
Epoch: 1, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4596998691558838
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.4280862808227539
Epoch: 3, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.4468955993652344
Epoch: 4, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.48537302017211914
Epoch: 5, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.46845006942749023
Epoch: 6, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.462430477142334
Epoch: 7, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5774438381195068
Epoch: 8, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.5298299789428711
Epoch: 9, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.48668694496154785
Epoch: 10, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.45273447036743164
Epoch: 11, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.43611741065979004
Epoch: 12, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4854445457458496
Epoch: 13, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.44767045974731445
Epoch: 14, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4233264923095703
Epoch: 15, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4428744316101074
Epoch: 16, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 17 cost time: 0.45450806617736816
Epoch: 17, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5224640369415283
Epoch: 18, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.452439546585083
Epoch: 19, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.45236849784851074
Epoch: 20, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5061824321746826
Epoch: 21, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.40621328353881836
Epoch: 22, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.242 Vali Acc: 0.400 Test Loss: 1.242 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4907195568084717
Epoch: 23, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.47518253326416016
Epoch: 24, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.42777252197265625
Epoch: 25, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.335 Vali Acc: 0.267 Test Loss: 1.335 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.3885812759399414
Epoch: 26, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.355 Vali Acc: 0.267 Test Loss: 1.355 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 805659
model size : 5.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1172149181365967
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4808335304260254
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.49738621711730957
Epoch: 3, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5362567901611328
Epoch: 4, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4836726188659668
Epoch: 5, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.153 Vali Acc: 0.133 Test Loss: 1.153 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5171725749969482
Epoch: 6, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.165 Vali Acc: 0.133 Test Loss: 1.165 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5001459121704102
Epoch: 7, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.193 Vali Acc: 0.200 Test Loss: 1.193 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.530043363571167
Epoch: 8, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5458447933197021
Epoch: 9, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5040652751922607
Epoch: 10, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5008485317230225
Epoch: 11, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.239 Vali Acc: 0.200 Test Loss: 1.239 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 543515
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.346942186355591
Epoch: 1, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.192 Vali Acc: 0.133 Test Loss: 1.192 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.5393249988555908
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.195 Vali Acc: 0.133 Test Loss: 1.195 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4552614688873291
Epoch: 3, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.196 Vali Acc: 0.133 Test Loss: 1.196 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5047287940979004
Epoch: 4, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.49625515937805176
Epoch: 5, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.4908280372619629
Epoch: 6, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5067205429077148
Epoch: 7, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.44575953483581543
Epoch: 8, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.253 Vali Acc: 0.200 Test Loss: 1.253 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4938476085662842
Epoch: 9, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.270 Vali Acc: 0.200 Test Loss: 1.270 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5000922679901123
Epoch: 10, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.4785740375518799
Epoch: 11, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.43674516677856445
Epoch: 12, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.280 Vali Acc: 0.133 Test Loss: 1.280 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.48474788665771484
Epoch: 13, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.312 Vali Acc: 0.133 Test Loss: 1.312 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4959871768951416
Epoch: 14, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.341 Vali Acc: 0.133 Test Loss: 1.341 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4564192295074463
Epoch: 15, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.364 Vali Acc: 0.200 Test Loss: 1.364 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4582099914550781
Epoch: 16, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.389 Vali Acc: 0.133 Test Loss: 1.389 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.466503381729126
Epoch: 17, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.432 Vali Acc: 0.200 Test Loss: 1.432 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4829704761505127
Epoch: 18, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.472 Vali Acc: 0.200 Test Loss: 1.472 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4677419662475586
Epoch: 19, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.518 Vali Acc: 0.133 Test Loss: 1.518 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.48571181297302246
Epoch: 20, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.571 Vali Acc: 0.133 Test Loss: 1.571 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.4840583801269531
Epoch: 21, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.633 Vali Acc: 0.200 Test Loss: 1.633 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 543515
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.210900068283081
Epoch: 1, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.088 Vali Acc: 0.133 Test Loss: 1.088 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.5138003826141357
Epoch: 2, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.43274641036987305
Epoch: 3, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4650285243988037
Epoch: 4, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5415279865264893
Epoch: 5, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5485610961914062
Epoch: 6, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4944896697998047
Epoch: 7, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5587506294250488
Epoch: 8, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4655935764312744
Epoch: 9, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5112965106964111
Epoch: 10, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4875192642211914
Epoch: 11, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5000612735748291
Epoch: 12, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5643618106842041
Epoch: 13, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 543515
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.989471197128296
Epoch: 1, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3737642765045166
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4248621463775635
Epoch: 3, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.39011311531066895
Epoch: 4, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4209902286529541
Epoch: 5, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4528923034667969
Epoch: 6, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4701399803161621
Epoch: 7, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.43497133255004883
Epoch: 8, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.102 Vali Acc: 0.600 Test Loss: 1.102 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.4518923759460449
Epoch: 9, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4313831329345703
Epoch: 10, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4356989860534668
Epoch: 11, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4106321334838867
Epoch: 12, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4417104721069336
Epoch: 13, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.088 Vali Acc: 0.200 Test Loss: 1.088 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4480729103088379
Epoch: 14, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.468949556350708
Epoch: 15, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.43677592277526855
Epoch: 16, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4404027462005615
Epoch: 17, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.47741150856018066
Epoch: 18, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 543515
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3029253482818604
Epoch: 1, Steps: 1 | Train Loss: 1.276 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5618460178375244
Epoch: 2, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.47391510009765625
Epoch: 3, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.4326481819152832
Epoch: 4, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.064 Vali Acc: 0.267 Test Loss: 1.064 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4224965572357178
Epoch: 5, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.067 Vali Acc: 0.200 Test Loss: 1.067 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4246039390563965
Epoch: 6, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.49491405487060547
Epoch: 7, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.37874507904052734
Epoch: 8, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.39871716499328613
Epoch: 9, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.38480043411254883
Epoch: 10, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.41785502433776855
Epoch: 11, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.43456101417541504
Epoch: 12, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4370391368865967
Epoch: 13, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4226553440093994
Epoch: 14, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4505314826965332
Epoch: 15, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4298520088195801
Epoch: 16, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.298 Vali Acc: 0.333 Test Loss: 1.298 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4182305335998535
Epoch: 17, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.345 Vali Acc: 0.333 Test Loss: 1.345 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.42179226875305176
Epoch: 18, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.407 Vali Acc: 0.333 Test Loss: 1.407 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 412443
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1319949626922607
Epoch: 1, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.45442914962768555
Epoch: 2, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.4486098289489746
Epoch: 3, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.060 Vali Acc: 0.267 Test Loss: 1.060 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.44562506675720215
Epoch: 4, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.44507551193237305
Epoch: 5, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.48518991470336914
Epoch: 6, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4928324222564697
Epoch: 7, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5253424644470215
Epoch: 8, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.520357608795166
Epoch: 9, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4964883327484131
Epoch: 10, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4510338306427002
Epoch: 11, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.46189403533935547
Epoch: 12, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.429706335067749
Epoch: 13, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.45682716369628906
Epoch: 14, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4650719165802002
Epoch: 15, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 412443
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.976180076599121
Epoch: 1, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.45285749435424805
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.109 Vali Acc: 0.200 Test Loss: 1.109 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4944460391998291
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4770946502685547
Epoch: 4, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.102 Vali Acc: 0.067 Test Loss: 1.102 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.43045639991760254
Epoch: 5, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4661264419555664
Epoch: 6, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4603705406188965
Epoch: 7, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5092813968658447
Epoch: 8, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4759790897369385
Epoch: 9, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4621853828430176
Epoch: 10, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4860224723815918
Epoch: 11, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 412443
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.217703342437744
Epoch: 1, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.491985559463501
Epoch: 2, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4919285774230957
Epoch: 3, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4324922561645508
Epoch: 4, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5349910259246826
Epoch: 5, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.42416977882385254
Epoch: 6, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4104447364807129
Epoch: 7, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.47745299339294434
Epoch: 8, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4728817939758301
Epoch: 9, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4647221565246582
Epoch: 10, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4686908721923828
Epoch: 11, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.47809815406799316
Epoch: 12, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4305417537689209
Epoch: 13, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.4407665729522705
Epoch: 14, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5212883949279785
Epoch: 15, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 412443
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9787683486938477
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.47137928009033203
Epoch: 2, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.49663591384887695
Epoch: 3, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4623098373413086
Epoch: 4, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.4904651641845703
Epoch: 5, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.44576168060302734
Epoch: 6, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.44604992866516113
Epoch: 7, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.195 Vali Acc: 0.200 Test Loss: 1.195 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.442615270614624
Epoch: 8, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5304980278015137
Epoch: 9, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4731171131134033
Epoch: 10, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5056159496307373
Epoch: 11, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.263 Vali Acc: 0.400 Test Loss: 1.263 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.513502836227417
Epoch: 12, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.277 Vali Acc: 0.333 Test Loss: 1.277 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5726797580718994
Epoch: 13, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.294 Vali Acc: 0.200 Test Loss: 1.294 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5271182060241699
Epoch: 14, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.316 Vali Acc: 0.267 Test Loss: 1.316 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.49105167388916016
Epoch: 15, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.348 Vali Acc: 0.267 Test Loss: 1.348 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5153543949127197
Epoch: 16, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.398 Vali Acc: 0.333 Test Loss: 1.398 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5107326507568359
Epoch: 17, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.462 Vali Acc: 0.333 Test Loss: 1.462 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5384964942932129
Epoch: 18, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.522 Vali Acc: 0.333 Test Loss: 1.522 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5192396640777588
Epoch: 19, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.582 Vali Acc: 0.333 Test Loss: 1.582 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.538275957107544
Epoch: 20, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.631 Vali Acc: 0.333 Test Loss: 1.631 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5257511138916016
Epoch: 21, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.674 Vali Acc: 0.333 Test Loss: 1.674 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 346907
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.231844902038574
Epoch: 1, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.165 Vali Acc: 0.133 Test Loss: 1.165 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.466400146484375
Epoch: 2, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.165 Vali Acc: 0.067 Test Loss: 1.165 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48106837272644043
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.166 Vali Acc: 0.133 Test Loss: 1.166 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4552905559539795
Epoch: 4, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.166 Vali Acc: 0.133 Test Loss: 1.166 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4954047203063965
Epoch: 5, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.4674184322357178
Epoch: 6, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.174 Vali Acc: 0.133 Test Loss: 1.174 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4177706241607666
Epoch: 7, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.186 Vali Acc: 0.133 Test Loss: 1.186 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.43210601806640625
Epoch: 8, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.199 Vali Acc: 0.067 Test Loss: 1.199 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.49627208709716797
Epoch: 9, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.211 Vali Acc: 0.133 Test Loss: 1.211 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.476917028427124
Epoch: 10, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.224 Vali Acc: 0.133 Test Loss: 1.224 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4123799800872803
Epoch: 11, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.238 Vali Acc: 0.200 Test Loss: 1.238 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4972972869873047
Epoch: 12, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.252 Vali Acc: 0.200 Test Loss: 1.252 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5751655101776123
Epoch: 13, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.271 Vali Acc: 0.200 Test Loss: 1.271 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.47603607177734375
Epoch: 14, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.293 Vali Acc: 0.200 Test Loss: 1.293 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.46682238578796387
Epoch: 15, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.317 Vali Acc: 0.200 Test Loss: 1.317 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 346907
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.212939500808716
Epoch: 1, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.169 Vali Acc: 0.067 Test Loss: 1.169 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.5529747009277344
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.170 Vali Acc: 0.067 Test Loss: 1.170 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5398056507110596
Epoch: 3, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
Validation loss decreased (-0.066655 --> -0.133322).  Saving model ...
Epoch: 4 cost time: 0.5087380409240723
Epoch: 4, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.172 Vali Acc: 0.133 Test Loss: 1.172 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5318875312805176
Epoch: 5, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.5638713836669922
Epoch: 6, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5012791156768799
Epoch: 7, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.49598217010498047
Epoch: 8, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5121033191680908
Epoch: 9, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5093228816986084
Epoch: 10, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.228 Vali Acc: 0.133 Test Loss: 1.228 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.48082971572875977
Epoch: 11, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.236 Vali Acc: 0.133 Test Loss: 1.236 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5547482967376709
Epoch: 12, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.248 Vali Acc: 0.133 Test Loss: 1.248 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5356385707855225
Epoch: 13, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5930197238922119
Epoch: 14, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.278 Vali Acc: 0.200 Test Loss: 1.278 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5528371334075928
Epoch: 15, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.294 Vali Acc: 0.200 Test Loss: 1.294 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.553912878036499
Epoch: 16, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.317 Vali Acc: 0.200 Test Loss: 1.317 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5545647144317627
Epoch: 17, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.354 Vali Acc: 0.267 Test Loss: 1.354 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 346907
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1295273303985596
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4451327323913574
Epoch: 2, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.4399116039276123
Epoch: 3, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4905366897583008
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4748506546020508
Epoch: 5, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.39797496795654297
Epoch: 6, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4559364318847656
Epoch: 7, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.44803881645202637
Epoch: 8, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.461759090423584
Epoch: 9, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.46353602409362793
Epoch: 10, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.421306848526001
Epoch: 11, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.4857175350189209
Epoch: 12, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.45092225074768066
Epoch: 13, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5237457752227783
Epoch: 14, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.46286988258361816
Epoch: 15, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.49843811988830566
Epoch: 16, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5276889801025391
Epoch: 17, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5493779182434082
Epoch: 18, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.48899364471435547
Epoch: 19, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4557003974914551
Epoch: 20, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.48367834091186523
Epoch: 21, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.232 Vali Acc: 0.067 Test Loss: 1.232 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4530625343322754
Epoch: 22, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.247 Vali Acc: 0.067 Test Loss: 1.247 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 346907
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.011045455932617
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 0.4495556354522705
Epoch: 2, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3970072269439697
Epoch: 3, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.107 Vali Acc: 0.600 Test Loss: 1.107 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4137153625488281
Epoch: 4, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3985908031463623
Epoch: 5, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3934144973754883
Epoch: 6, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4044344425201416
Epoch: 7, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4221055507659912
Epoch: 8, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4792494773864746
Epoch: 9, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.424990177154541
Epoch: 10, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.43784427642822266
Epoch: 11, Steps: 1 | Train Loss: 0.434 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 314139
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.119668483734131
Epoch: 1, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.47746944427490234
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48217153549194336
Epoch: 3, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4733426570892334
Epoch: 4, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.460033655166626
Epoch: 5, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4561269283294678
Epoch: 6, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4924302101135254
Epoch: 7, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4833962917327881
Epoch: 8, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4052741527557373
Epoch: 9, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4266510009765625
Epoch: 10, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.49744272232055664
Epoch: 11, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 314139
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.201676368713379
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5161950588226318
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4695878028869629
Epoch: 3, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5348117351531982
Epoch: 4, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5106303691864014
Epoch: 5, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5048167705535889
Epoch: 6, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5240347385406494
Epoch: 7, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5738315582275391
Epoch: 8, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.584526538848877
Epoch: 9, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7366788387298584
Epoch: 10, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6379895210266113
Epoch: 11, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4570028781890869
Epoch: 12, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.46240663528442383
Epoch: 13, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 314139
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.184464931488037
Epoch: 1, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.489760160446167
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.468656063079834
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4915597438812256
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5319125652313232
Epoch: 5, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5623526573181152
Epoch: 6, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.53643798828125
Epoch: 7, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5437355041503906
Epoch: 8, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4892096519470215
Epoch: 9, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5331246852874756
Epoch: 10, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5591394901275635
Epoch: 11, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5467836856842041
Epoch: 12, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.605933427810669
Epoch: 13, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.5268208980560303
Epoch: 14, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5386064052581787
Epoch: 15, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5344398021697998
Epoch: 16, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.49362850189208984
Epoch: 17, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5338411331176758
Epoch: 18, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.562039852142334
Epoch: 19, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.49632859230041504
Epoch: 20, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.48891139030456543
Epoch: 21, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.47823333740234375
Epoch: 22, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.44761109352111816
Epoch: 23, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 314139
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.82590651512146
Epoch: 1, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.232 Vali Acc: 0.200 Test Loss: 1.232 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4218015670776367
Epoch: 2, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.43167543411254883
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5338590145111084
Epoch: 4, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.222 Vali Acc: 0.133 Test Loss: 1.222 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4545736312866211
Epoch: 5, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.223 Vali Acc: 0.067 Test Loss: 1.223 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4632899761199951
Epoch: 6, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.232 Vali Acc: 0.200 Test Loss: 1.232 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.46507930755615234
Epoch: 7, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5780246257781982
Epoch: 8, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.251 Vali Acc: 0.200 Test Loss: 1.251 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4250619411468506
Epoch: 9, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.254 Vali Acc: 0.200 Test Loss: 1.254 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4535388946533203
Epoch: 10, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.45641613006591797
Epoch: 11, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.47045302391052246
Epoch: 12, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.293 Vali Acc: 0.200 Test Loss: 1.293 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.44635963439941406
Epoch: 13, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.322 Vali Acc: 0.200 Test Loss: 1.322 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 297755
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.138666868209839
Epoch: 1, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4276275634765625
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5044796466827393
Epoch: 3, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.529381275177002
Epoch: 4, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.189 Vali Acc: 0.133 Test Loss: 1.189 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4873056411743164
Epoch: 5, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5216867923736572
Epoch: 6, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.44913244247436523
Epoch: 7, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4468562602996826
Epoch: 8, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4380474090576172
Epoch: 9, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.235 Vali Acc: 0.200 Test Loss: 1.235 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.40295910835266113
Epoch: 10, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.41156554222106934
Epoch: 11, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4023289680480957
Epoch: 12, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 297755
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9907138347625732
Epoch: 1, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4630739688873291
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.437272310256958
Epoch: 3, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4174313545227051
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.4183368682861328
Epoch: 5, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.44930529594421387
Epoch: 6, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4812588691711426
Epoch: 7, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4646167755126953
Epoch: 8, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5115282535552979
Epoch: 9, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4962944984436035
Epoch: 10, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5448756217956543
Epoch: 11, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.48297595977783203
Epoch: 12, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.207 Vali Acc: 0.133 Test Loss: 1.207 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4522745609283447
Epoch: 13, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5596449375152588
Epoch: 14, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.245 Vali Acc: 0.133 Test Loss: 1.245 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.505042314529419
Epoch: 15, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 297755
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.190373659133911
Epoch: 1, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.131 Vali Acc: 0.133 Test Loss: 1.131 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.4454798698425293
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.133322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5237865447998047
Epoch: 3, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4390139579772949
Epoch: 4, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.41835451126098633
Epoch: 5, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.46852946281433105
Epoch: 6, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.43290019035339355
Epoch: 7, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.40189218521118164
Epoch: 8, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4743485450744629
Epoch: 9, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4362914562225342
Epoch: 10, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4325733184814453
Epoch: 11, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4787290096282959
Epoch: 12, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.43917179107666016
Epoch: 13, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 0.40020203590393066
Epoch: 14, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4177052974700928
Epoch: 15, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.46216726303100586
Epoch: 16, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.178 Vali Acc: 0.467 Test Loss: 1.178 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 17 cost time: 0.44851183891296387
Epoch: 17, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.186 Vali Acc: 0.467 Test Loss: 1.186 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.3964550495147705
Epoch: 18, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.3765418529510498
Epoch: 19, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.198 Vali Acc: 0.067 Test Loss: 1.198 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.46555089950561523
Epoch: 20, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.208 Vali Acc: 0.067 Test Loss: 1.208 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.41485595703125
Epoch: 21, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.228 Vali Acc: 0.133 Test Loss: 1.228 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.4025106430053711
Epoch: 22, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4201951026916504
Epoch: 23, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.299 Vali Acc: 0.467 Test Loss: 1.299 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.40562891960144043
Epoch: 24, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.326 Vali Acc: 0.400 Test Loss: 1.326 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.42871546745300293
Epoch: 25, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.339 Vali Acc: 0.400 Test Loss: 1.339 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.523944616317749
Epoch: 26, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.349 Vali Acc: 0.267 Test Loss: 1.349 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 297755
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1978955268859863
Epoch: 1, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4623708724975586
Epoch: 2, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4997696876525879
Epoch: 3, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.538048267364502
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5170609951019287
Epoch: 5, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5083706378936768
Epoch: 6, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5101914405822754
Epoch: 7, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4901235103607178
Epoch: 8, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5302410125732422
Epoch: 9, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4668586254119873
Epoch: 10, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4448227882385254
Epoch: 11, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.45884037017822266
Epoch: 12, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4465475082397461
Epoch: 13, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.272 Vali Acc: 0.267 Test Loss: 1.272 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5153007507324219
Epoch: 14, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.286 Vali Acc: 0.200 Test Loss: 1.286 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4688129425048828
Epoch: 15, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.298 Vali Acc: 0.200 Test Loss: 1.298 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.47669339179992676
Epoch: 16, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.314 Vali Acc: 0.200 Test Loss: 1.314 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 394651
model size : 2.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1161715984344482
Epoch: 1, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.45327329635620117
Epoch: 2, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4492757320404053
Epoch: 3, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.44267988204956055
Epoch: 4, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.47559213638305664
Epoch: 5, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5441551208496094
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.47821545600891113
Epoch: 7, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.41509413719177246
Epoch: 8, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.48296093940734863
Epoch: 9, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5149862766265869
Epoch: 10, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.506171464920044
Epoch: 11, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4965224266052246
Epoch: 12, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.236 Vali Acc: 0.400 Test Loss: 1.236 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5031802654266357
Epoch: 13, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5043950080871582
Epoch: 14, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6126551628112793
Epoch: 15, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.536759614944458
Epoch: 16, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5173349380493164
Epoch: 17, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.298 Vali Acc: 0.200 Test Loss: 1.298 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4824392795562744
Epoch: 18, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.321 Vali Acc: 0.133 Test Loss: 1.321 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 394651
model size : 2.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.145589590072632
Epoch: 1, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.5264816284179688
Epoch: 2, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.213 Vali Acc: 0.200 Test Loss: 1.213 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4966695308685303
Epoch: 3, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.209 Vali Acc: 0.200 Test Loss: 1.209 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5570242404937744
Epoch: 4, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.208 Vali Acc: 0.133 Test Loss: 1.208 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5066089630126953
Epoch: 5, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.4963679313659668
Epoch: 6, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4202408790588379
Epoch: 7, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.48480677604675293
Epoch: 8, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.42210817337036133
Epoch: 9, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4096643924713135
Epoch: 10, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.47001004219055176
Epoch: 11, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.251 Vali Acc: 0.200 Test Loss: 1.251 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.44843149185180664
Epoch: 12, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4423809051513672
Epoch: 13, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.4596290588378906
Epoch: 14, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.273 Vali Acc: 0.200 Test Loss: 1.273 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4464559555053711
Epoch: 15, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.280 Vali Acc: 0.267 Test Loss: 1.280 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 394651
model size : 2.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0952658653259277
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5180559158325195
Epoch: 2, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.49767160415649414
Epoch: 3, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.484180212020874
Epoch: 4, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.169 Vali Acc: 0.133 Test Loss: 1.169 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5071308612823486
Epoch: 5, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5288622379302979
Epoch: 6, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5637850761413574
Epoch: 7, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5167713165283203
Epoch: 8, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5948190689086914
Epoch: 9, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5166618824005127
Epoch: 10, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.47570371627807617
Epoch: 11, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5197489261627197
Epoch: 12, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.463822603225708
Epoch: 13, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5310671329498291
Epoch: 14, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.575089693069458
Epoch: 15, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4830291271209717
Epoch: 16, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5020713806152344
Epoch: 17, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5298221111297607
Epoch: 18, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5118207931518555
Epoch: 19, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5316662788391113
Epoch: 20, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4653477668762207
Epoch: 21, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5001142024993896
Epoch: 22, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 394651
model size : 2.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0450518131256104
Epoch: 1, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.43929123878479004
Epoch: 2, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4838409423828125
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.47017836570739746
Epoch: 4, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5003921985626221
Epoch: 5, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.178 Vali Acc: 0.133 Test Loss: 1.178 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5104966163635254
Epoch: 6, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5285828113555908
Epoch: 7, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.567065954208374
Epoch: 8, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5999138355255127
Epoch: 9, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5189225673675537
Epoch: 10, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5213577747344971
Epoch: 11, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 263579
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.328972101211548
Epoch: 1, Steps: 1 | Train Loss: 1.273 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.552335262298584
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5643641948699951
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5388083457946777
Epoch: 4, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6313877105712891
Epoch: 5, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5434873104095459
Epoch: 6, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5327908992767334
Epoch: 7, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5527586936950684
Epoch: 8, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6937680244445801
Epoch: 9, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5162253379821777
Epoch: 10, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5974111557006836
Epoch: 11, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4742257595062256
Epoch: 12, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4517090320587158
Epoch: 13, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 263579
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9318532943725586
Epoch: 1, Steps: 1 | Train Loss: 1.320 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.39598655700683594
Epoch: 2, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4682176113128662
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4975011348724365
Epoch: 4, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5660948753356934
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4998135566711426
Epoch: 6, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5014345645904541
Epoch: 7, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.49333834648132324
Epoch: 8, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5230002403259277
Epoch: 9, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5274326801300049
Epoch: 10, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4881775379180908
Epoch: 11, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4950218200683594
Epoch: 12, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 263579
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1388986110687256
Epoch: 1, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.497394323348999
Epoch: 2, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.4750020503997803
Epoch: 3, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.4746088981628418
Epoch: 4, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5043628215789795
Epoch: 5, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4764378070831299
Epoch: 6, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4733600616455078
Epoch: 7, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4359149932861328
Epoch: 8, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.46214985847473145
Epoch: 9, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4794652462005615
Epoch: 10, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.407245397567749
Epoch: 11, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4378812313079834
Epoch: 12, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.43318796157836914
Epoch: 13, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.3948822021484375
Epoch: 14, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4095888137817383
Epoch: 15, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.236 Vali Acc: 0.400 Test Loss: 1.236 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.48201680183410645
Epoch: 16, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.44235754013061523
Epoch: 17, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4236471652984619
Epoch: 18, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 263579
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.166536569595337
Epoch: 1, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.49024415016174316
Epoch: 2, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5333993434906006
Epoch: 3, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.46040844917297363
Epoch: 4, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5055286884307861
Epoch: 5, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.49314045906066895
Epoch: 6, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.49965786933898926
Epoch: 7, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5227112770080566
Epoch: 8, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.48591113090515137
Epoch: 9, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.45119643211364746
Epoch: 10, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.467085599899292
Epoch: 11, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.47810792922973633
Epoch: 12, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.49864792823791504
Epoch: 13, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4856564998626709
Epoch: 14, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6046881675720215
Epoch: 15, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5327811241149902
Epoch: 16, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.48384904861450195
Epoch: 17, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 198043
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1821155548095703
Epoch: 1, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.45813846588134766
Epoch: 2, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.47224974632263184
Epoch: 3, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4703354835510254
Epoch: 4, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4875457286834717
Epoch: 5, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.49725890159606934
Epoch: 6, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4805781841278076
Epoch: 7, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.49179601669311523
Epoch: 8, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5076904296875
Epoch: 9, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.47277092933654785
Epoch: 10, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5371999740600586
Epoch: 11, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5463130474090576
Epoch: 12, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.621293306350708
Epoch: 13, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6045939922332764
Epoch: 14, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5701920986175537
Epoch: 15, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5054068565368652
Epoch: 16, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5566654205322266
Epoch: 17, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5319023132324219
Epoch: 18, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.270 Vali Acc: 0.267 Test Loss: 1.270 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5455327033996582
Epoch: 19, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.295 Vali Acc: 0.267 Test Loss: 1.295 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 198043
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.256579875946045
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.49649667739868164
Epoch: 2, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.47063279151916504
Epoch: 3, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5442795753479004
Epoch: 4, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4540674686431885
Epoch: 5, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4619636535644531
Epoch: 6, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4729743003845215
Epoch: 7, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.447843074798584
Epoch: 8, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5172839164733887
Epoch: 9, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.462862491607666
Epoch: 10, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4038233757019043
Epoch: 11, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.45041561126708984
Epoch: 12, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4314455986022949
Epoch: 13, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.462177038192749
Epoch: 14, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4477427005767822
Epoch: 15, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.44340968132019043
Epoch: 16, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.40508079528808594
Epoch: 17, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.3917360305786133
Epoch: 18, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.48452115058898926
Epoch: 19, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5058493614196777
Epoch: 20, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.45124030113220215
Epoch: 21, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.275 Vali Acc: 0.267 Test Loss: 1.275 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5200784206390381
Epoch: 22, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.297 Vali Acc: 0.267 Test Loss: 1.297 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.46869730949401855
Epoch: 23, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.324 Vali Acc: 0.267 Test Loss: 1.324 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.4940836429595947
Epoch: 24, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.351 Vali Acc: 0.267 Test Loss: 1.351 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.48751211166381836
Epoch: 25, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.377 Vali Acc: 0.267 Test Loss: 1.377 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 198043
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.04583477973938
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4891963005065918
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4905853271484375
Epoch: 3, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.47952818870544434
Epoch: 4, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4597916603088379
Epoch: 5, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.43237829208374023
Epoch: 6, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.45386290550231934
Epoch: 7, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.45769739151000977
Epoch: 8, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.495877742767334
Epoch: 9, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5671079158782959
Epoch: 10, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5888998508453369
Epoch: 11, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4881300926208496
Epoch: 12, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 0.4692709445953369
Epoch: 13, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.45725417137145996
Epoch: 14, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4396669864654541
Epoch: 15, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.43219733238220215
Epoch: 16, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4427802562713623
Epoch: 17, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.459871768951416
Epoch: 18, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.46822571754455566
Epoch: 19, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.3994481563568115
Epoch: 20, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4638040065765381
Epoch: 21, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.49494338035583496
Epoch: 22, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 198043
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0757436752319336
Epoch: 1, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.518826961517334
Epoch: 2, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.47705841064453125
Epoch: 3, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4971194267272949
Epoch: 4, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5328078269958496
Epoch: 5, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5267415046691895
Epoch: 6, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4538393020629883
Epoch: 7, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4539034366607666
Epoch: 8, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.43945980072021484
Epoch: 9, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.44309186935424805
Epoch: 10, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5385677814483643
Epoch: 11, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5199990272521973
Epoch: 12, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 165275
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2377238273620605
Epoch: 1, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.5081830024719238
Epoch: 2, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.4636845588684082
Epoch: 3, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.517693281173706
Epoch: 4, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4787440299987793
Epoch: 5, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.46848130226135254
Epoch: 6, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4973876476287842
Epoch: 7, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.47417426109313965
Epoch: 8, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4554612636566162
Epoch: 9, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.49117517471313477
Epoch: 10, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4429447650909424
Epoch: 11, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.191 Vali Acc: 0.467 Test Loss: 1.191 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4847984313964844
Epoch: 12, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.207 Vali Acc: 0.467 Test Loss: 1.207 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 165275
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3712854385375977
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5389673709869385
Epoch: 2, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.49099087715148926
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.48734092712402344
Epoch: 4, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5149612426757812
Epoch: 5, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4999690055847168
Epoch: 6, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4943528175354004
Epoch: 7, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5462009906768799
Epoch: 8, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5325045585632324
Epoch: 9, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5510971546173096
Epoch: 10, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5511932373046875
Epoch: 11, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5028462409973145
Epoch: 12, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 165275
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.175229072570801
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5480589866638184
Epoch: 2, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5310142040252686
Epoch: 3, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4363384246826172
Epoch: 4, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4562876224517822
Epoch: 5, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4109833240509033
Epoch: 6, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.4527096748352051
Epoch: 7, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4398839473724365
Epoch: 8, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.39032626152038574
Epoch: 9, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4293384552001953
Epoch: 10, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4080667495727539
Epoch: 11, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4113485813140869
Epoch: 12, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.42334413528442383
Epoch: 13, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.46424365043640137
Epoch: 14, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.185 Vali Acc: 0.467 Test Loss: 1.185 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4644308090209961
Epoch: 15, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.4604606628417969
Epoch: 16, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.184 Vali Acc: 0.467 Test Loss: 1.184 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 165275
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4345602989196777
Epoch: 1, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5712051391601562
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5963840484619141
Epoch: 3, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.45538878440856934
Epoch: 4, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.42987608909606934
Epoch: 5, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4769141674041748
Epoch: 6, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6105742454528809
Epoch: 7, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5241987705230713
Epoch: 8, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5133700370788574
Epoch: 9, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.6019594669342041
Epoch: 10, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.6121227741241455
Epoch: 11, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5037388801574707
Epoch: 12, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.180 Vali Acc: 0.467 Test Loss: 1.180 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5804362297058105
Epoch: 13, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5973899364471436
Epoch: 14, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.49387621879577637
Epoch: 15, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4826967716217041
Epoch: 16, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4756894111633301
Epoch: 17, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5433347225189209
Epoch: 18, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.257 Vali Acc: 0.267 Test Loss: 1.257 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5057833194732666
Epoch: 19, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.288 Vali Acc: 0.267 Test Loss: 1.288 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5155928134918213
Epoch: 20, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.327 Vali Acc: 0.333 Test Loss: 1.327 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 148891
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2684032917022705
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5121705532073975
Epoch: 2, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5574376583099365
Epoch: 3, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.519556999206543
Epoch: 4, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6029148101806641
Epoch: 5, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5545608997344971
Epoch: 6, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5346207618713379
Epoch: 7, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5879566669464111
Epoch: 8, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.514991044998169
Epoch: 9, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5285005569458008
Epoch: 10, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5739190578460693
Epoch: 11, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5379166603088379
Epoch: 12, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 148891
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.167894124984741
Epoch: 1, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.46817922592163086
Epoch: 2, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4902479648590088
Epoch: 3, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4945955276489258
Epoch: 4, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.434145450592041
Epoch: 5, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4504532814025879
Epoch: 6, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.48406386375427246
Epoch: 7, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.46045970916748047
Epoch: 8, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.4938666820526123
Epoch: 9, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4205203056335449
Epoch: 10, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.41132473945617676
Epoch: 11, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.44661831855773926
Epoch: 12, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.42613792419433594
Epoch: 13, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.456256628036499
Epoch: 14, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4812300205230713
Epoch: 15, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4725377559661865
Epoch: 16, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.45231199264526367
Epoch: 17, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5518412590026855
Epoch: 18, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.588679313659668
Epoch: 19, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5019559860229492
Epoch: 20, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4455714225769043
Epoch: 21, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399987).  Saving model ...
Epoch: 22 cost time: 0.4609661102294922
Epoch: 22, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.306 Vali Acc: 0.333 Test Loss: 1.306 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4579145908355713
Epoch: 23, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.331 Vali Acc: 0.333 Test Loss: 1.331 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5157198905944824
Epoch: 24, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.352 Vali Acc: 0.400 Test Loss: 1.352 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.555152416229248
Epoch: 25, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.377 Vali Acc: 0.333 Test Loss: 1.377 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.482607364654541
Epoch: 26, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.405 Vali Acc: 0.333 Test Loss: 1.405 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.4806640148162842
Epoch: 27, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.435 Vali Acc: 0.333 Test Loss: 1.435 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.4963982105255127
Epoch: 28, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.467 Vali Acc: 0.267 Test Loss: 1.467 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5271987915039062
Epoch: 29, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.496 Vali Acc: 0.267 Test Loss: 1.496 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.427215576171875
Epoch: 30, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.524 Vali Acc: 0.333 Test Loss: 1.524 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.48699378967285156
Epoch: 31, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.550 Vali Acc: 0.333 Test Loss: 1.550 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 148891
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.083706855773926
Epoch: 1, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4634511470794678
Epoch: 2, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.48143458366394043
Epoch: 3, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4098637104034424
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4118669033050537
Epoch: 5, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.40390849113464355
Epoch: 6, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4438052177429199
Epoch: 7, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4312434196472168
Epoch: 8, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3946831226348877
Epoch: 9, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4005405902862549
Epoch: 10, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4039599895477295
Epoch: 11, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.473278284072876
Epoch: 12, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4925382137298584
Epoch: 13, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.39080286026000977
Epoch: 14, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4085359573364258
Epoch: 15, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.3888840675354004
Epoch: 16, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.42924046516418457
Epoch: 17, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 18 cost time: 0.476973295211792
Epoch: 18, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4375183582305908
Epoch: 19, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5751278400421143
Epoch: 20, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.47283053398132324
Epoch: 21, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5004832744598389
Epoch: 22, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.45478343963623047
Epoch: 23, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4468355178833008
Epoch: 24, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.48374080657958984
Epoch: 25, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.46787190437316895
Epoch: 26, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.43314433097839355
Epoch: 27, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 148891
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3415372371673584
Epoch: 1, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.48621392250061035
Epoch: 2, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47201967239379883
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.45043468475341797
Epoch: 4, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4080188274383545
Epoch: 5, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4560892581939697
Epoch: 6, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4131741523742676
Epoch: 7, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4438478946685791
Epoch: 8, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.37943148612976074
Epoch: 9, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.37645697593688965
Epoch: 10, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4152092933654785
Epoch: 11, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4336566925048828
Epoch: 12, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.42205309867858887
Epoch: 13, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 140699
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3452889919281006
Epoch: 1, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5325872898101807
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.522674560546875
Epoch: 3, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5291531085968018
Epoch: 4, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.561474084854126
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5495295524597168
Epoch: 6, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6369404792785645
Epoch: 7, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6052806377410889
Epoch: 8, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5328159332275391
Epoch: 9, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5621402263641357
Epoch: 10, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6060433387756348
Epoch: 11, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6089510917663574
Epoch: 12, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5572941303253174
Epoch: 13, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 140699
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.968841552734375
Epoch: 1, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4223196506500244
Epoch: 2, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.41388535499572754
Epoch: 3, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.419356107711792
Epoch: 4, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.40651726722717285
Epoch: 5, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.43185997009277344
Epoch: 6, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.44541430473327637
Epoch: 7, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.45317721366882324
Epoch: 8, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.49166369438171387
Epoch: 9, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.117 Vali Acc: 0.133 Test Loss: 1.117 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.42973923683166504
Epoch: 10, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.128 Vali Acc: 0.133 Test Loss: 1.128 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4505124092102051
Epoch: 11, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.138 Vali Acc: 0.133 Test Loss: 1.138 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.43500208854675293
Epoch: 12, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.147 Vali Acc: 0.133 Test Loss: 1.147 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5220417976379395
Epoch: 13, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 140699
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0896198749542236
Epoch: 1, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4774155616760254
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5209677219390869
Epoch: 3, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5284326076507568
Epoch: 4, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4715087413787842
Epoch: 5, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4802665710449219
Epoch: 6, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.43020009994506836
Epoch: 7, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4197678565979004
Epoch: 8, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5094451904296875
Epoch: 9, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.49203038215637207
Epoch: 10, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5027878284454346
Epoch: 11, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.46189117431640625
Epoch: 12, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.47441697120666504
Epoch: 13, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4971742630004883
Epoch: 14, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.459026575088501
Epoch: 15, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4514343738555908
Epoch: 16, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.3883695602416992
Epoch: 17, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 140699
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0160675048828125
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.46759557723999023
Epoch: 2, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.4720184803009033
Epoch: 3, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.4827418327331543
Epoch: 4, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.5831854343414307
Epoch: 5, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.48794078826904297
Epoch: 6, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.4289054870605469
Epoch: 7, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4669070243835449
Epoch: 8, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5326437950134277
Epoch: 9, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.233 Vali Acc: 0.133 Test Loss: 1.233 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4915444850921631
Epoch: 10, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.241 Vali Acc: 0.133 Test Loss: 1.241 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4371767044067383
Epoch: 11, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.250 Vali Acc: 0.133 Test Loss: 1.250 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.46895575523376465
Epoch: 12, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.260 Vali Acc: 0.133 Test Loss: 1.260 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.47814416885375977
Epoch: 13, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.269 Vali Acc: 0.133 Test Loss: 1.269 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4240291118621826
Epoch: 14, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.277 Vali Acc: 0.133 Test Loss: 1.277 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.44306468963623047
Epoch: 15, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.283 Vali Acc: 0.200 Test Loss: 1.283 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.4302027225494385
Epoch: 16, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.287 Vali Acc: 0.133 Test Loss: 1.287 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 195291
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8182055950164795
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.4790382385253906
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.5165712833404541
Epoch: 3, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5111849308013916
Epoch: 4, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.5227541923522949
Epoch: 5, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.4997577667236328
Epoch: 6, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5566010475158691
Epoch: 7, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.243 Vali Acc: 0.200 Test Loss: 1.243 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5786440372467041
Epoch: 8, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5894756317138672
Epoch: 9, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.251 Vali Acc: 0.067 Test Loss: 1.251 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5081534385681152
Epoch: 10, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.259 Vali Acc: 0.067 Test Loss: 1.259 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.45127320289611816
Epoch: 11, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.268 Vali Acc: 0.067 Test Loss: 1.268 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5380115509033203
Epoch: 12, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.278 Vali Acc: 0.133 Test Loss: 1.278 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5257506370544434
Epoch: 13, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.286 Vali Acc: 0.133 Test Loss: 1.286 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4674499034881592
Epoch: 14, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.292 Vali Acc: 0.133 Test Loss: 1.292 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4902212619781494
Epoch: 15, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.295 Vali Acc: 0.133 Test Loss: 1.295 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5223908424377441
Epoch: 16, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.297 Vali Acc: 0.133 Test Loss: 1.297 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 195291
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.05330491065979
Epoch: 1, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4454219341278076
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.232 Vali Acc: 0.200 Test Loss: 1.232 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.49274110794067383
Epoch: 3, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4967048168182373
Epoch: 4, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.46618103981018066
Epoch: 5, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4283139705657959
Epoch: 6, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.233 Vali Acc: 0.133 Test Loss: 1.233 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.41735339164733887
Epoch: 7, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5364062786102295
Epoch: 8, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.241 Vali Acc: 0.200 Test Loss: 1.241 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5159642696380615
Epoch: 9, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.248 Vali Acc: 0.200 Test Loss: 1.248 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5865213871002197
Epoch: 10, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.256 Vali Acc: 0.200 Test Loss: 1.256 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.47440028190612793
Epoch: 11, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.4963071346282959
Epoch: 12, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.273 Vali Acc: 0.133 Test Loss: 1.273 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5095858573913574
Epoch: 13, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.280 Vali Acc: 0.133 Test Loss: 1.280 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.48653364181518555
Epoch: 14, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.286 Vali Acc: 0.133 Test Loss: 1.286 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 195291
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2512950897216797
Epoch: 1, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.49352407455444336
Epoch: 2, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.528721809387207
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5069746971130371
Epoch: 4, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5020787715911865
Epoch: 5, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.109 Vali Acc: 0.200 Test Loss: 1.109 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5356426239013672
Epoch: 6, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5272974967956543
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5190017223358154
Epoch: 8, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4468064308166504
Epoch: 9, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5526297092437744
Epoch: 10, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5061759948730469
Epoch: 11, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.47252416610717773
Epoch: 12, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4847404956817627
Epoch: 13, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 195291
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1797592639923096
Epoch: 1, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.3783867359161377
Epoch: 2, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4051642417907715
Epoch: 3, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5488438606262207
Epoch: 4, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.253 Vali Acc: 0.200 Test Loss: 1.253 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3869590759277344
Epoch: 5, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.249 Vali Acc: 0.133 Test Loss: 1.249 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.40137362480163574
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.247 Vali Acc: 0.133 Test Loss: 1.247 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4229912757873535
Epoch: 7, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.245 Vali Acc: 0.067 Test Loss: 1.245 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4505627155303955
Epoch: 8, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.246 Vali Acc: 0.200 Test Loss: 1.246 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.42321228981018066
Epoch: 9, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.251 Vali Acc: 0.133 Test Loss: 1.251 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.45060276985168457
Epoch: 10, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.258 Vali Acc: 0.133 Test Loss: 1.258 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.45915865898132324
Epoch: 11, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.266 Vali Acc: 0.200 Test Loss: 1.266 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5197851657867432
Epoch: 12, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.275 Vali Acc: 0.200 Test Loss: 1.275 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.47544360160827637
Epoch: 13, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.285 Vali Acc: 0.200 Test Loss: 1.285 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 129755
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2181971073150635
Epoch: 1, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.535381555557251
Epoch: 2, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4629244804382324
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5847904682159424
Epoch: 4, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6435356140136719
Epoch: 5, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5661890506744385
Epoch: 6, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.213 Vali Acc: 0.133 Test Loss: 1.213 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4619002342224121
Epoch: 7, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.212 Vali Acc: 0.133 Test Loss: 1.212 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5580601692199707
Epoch: 8, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.214 Vali Acc: 0.133 Test Loss: 1.214 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.552781343460083
Epoch: 9, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.220 Vali Acc: 0.067 Test Loss: 1.220 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.49612855911254883
Epoch: 10, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.228 Vali Acc: 0.067 Test Loss: 1.228 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5355815887451172
Epoch: 11, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.238 Vali Acc: 0.067 Test Loss: 1.238 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5437881946563721
Epoch: 12, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.249 Vali Acc: 0.067 Test Loss: 1.249 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 129755
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6517789363861084
Epoch: 1, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6068239212036133
Epoch: 2, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.615788459777832
Epoch: 3, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5226767063140869
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4881014823913574
Epoch: 5, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5160117149353027
Epoch: 6, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5243325233459473
Epoch: 7, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.5281085968017578
Epoch: 8, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4778156280517578
Epoch: 9, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.198 Vali Acc: 0.133 Test Loss: 1.198 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4953436851501465
Epoch: 10, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.206 Vali Acc: 0.133 Test Loss: 1.206 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.47367215156555176
Epoch: 11, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.215 Vali Acc: 0.133 Test Loss: 1.215 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4839491844177246
Epoch: 12, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.225 Vali Acc: 0.133 Test Loss: 1.225 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5289919376373291
Epoch: 13, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.234 Vali Acc: 0.133 Test Loss: 1.234 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.48322153091430664
Epoch: 14, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.241 Vali Acc: 0.133 Test Loss: 1.241 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5190093517303467
Epoch: 15, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.246 Vali Acc: 0.133 Test Loss: 1.246 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5240092277526855
Epoch: 16, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.248 Vali Acc: 0.133 Test Loss: 1.248 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5437507629394531
Epoch: 17, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.247 Vali Acc: 0.133 Test Loss: 1.247 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 129755
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1729559898376465
Epoch: 1, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.569983720779419
Epoch: 2, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6069238185882568
Epoch: 3, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5243086814880371
Epoch: 4, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5198984146118164
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6085498332977295
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.172 Vali Acc: 0.133 Test Loss: 1.172 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5369477272033691
Epoch: 7, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.48818325996398926
Epoch: 8, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4651064872741699
Epoch: 9, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.493664026260376
Epoch: 10, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.197 Vali Acc: 0.133 Test Loss: 1.197 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5242245197296143
Epoch: 11, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.207 Vali Acc: 0.133 Test Loss: 1.207 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5261499881744385
Epoch: 12, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.216 Vali Acc: 0.200 Test Loss: 1.216 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5234167575836182
Epoch: 13, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 129755
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5869719982147217
Epoch: 1, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5683267116546631
Epoch: 2, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6004383563995361
Epoch: 3, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5131762027740479
Epoch: 4, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5917575359344482
Epoch: 5, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5892131328582764
Epoch: 6, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5181114673614502
Epoch: 7, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5209486484527588
Epoch: 8, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5067646503448486
Epoch: 9, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5521848201751709
Epoch: 10, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5431549549102783
Epoch: 11, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 96987
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2123863697052
Epoch: 1, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.46936678886413574
Epoch: 2, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5092372894287109
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4712049961090088
Epoch: 4, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.44325733184814453
Epoch: 5, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.504763126373291
Epoch: 6, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4963226318359375
Epoch: 7, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5227816104888916
Epoch: 8, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4881880283355713
Epoch: 9, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5306789875030518
Epoch: 10, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5504550933837891
Epoch: 11, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.5355861186981201
Epoch: 12, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5452492237091064
Epoch: 13, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.49565982818603516
Epoch: 14, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5263521671295166
Epoch: 15, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.49814748764038086
Epoch: 16, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5170409679412842
Epoch: 17, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5545847415924072
Epoch: 18, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6034049987792969
Epoch: 19, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.59977126121521
Epoch: 20, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5044386386871338
Epoch: 21, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 96987
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.324568033218384
Epoch: 1, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5198543071746826
Epoch: 2, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4645705223083496
Epoch: 3, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5207805633544922
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5205404758453369
Epoch: 5, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5188817977905273
Epoch: 6, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5114803314208984
Epoch: 7, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4324514865875244
Epoch: 8, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5274524688720703
Epoch: 9, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4596078395843506
Epoch: 10, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5175812244415283
Epoch: 11, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 96987
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2354989051818848
Epoch: 1, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.4386787414550781
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4130706787109375
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.44818878173828125
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4185919761657715
Epoch: 5, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.38007616996765137
Epoch: 6, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4012787342071533
Epoch: 7, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.45208287239074707
Epoch: 8, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4349184036254883
Epoch: 9, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3872973918914795
Epoch: 10, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.37635135650634766
Epoch: 11, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 96987
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.188795566558838
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.39957666397094727
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.46590709686279297
Epoch: 3, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4366731643676758
Epoch: 4, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.4525902271270752
Epoch: 5, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.45765161514282227
Epoch: 6, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4326283931732178
Epoch: 7, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.36852526664733887
Epoch: 8, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.382277250289917
Epoch: 9, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.43663859367370605
Epoch: 10, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4657614231109619
Epoch: 11, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.43712449073791504
Epoch: 12, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4633305072784424
Epoch: 13, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.4655447006225586
Epoch: 14, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.45280981063842773
Epoch: 15, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 80603
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.491270065307617
Epoch: 1, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4968099594116211
Epoch: 2, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.467634916305542
Epoch: 3, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.48873209953308105
Epoch: 4, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.4424753189086914
Epoch: 5, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4955711364746094
Epoch: 6, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5073056221008301
Epoch: 7, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4739053249359131
Epoch: 8, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4596738815307617
Epoch: 9, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5137200355529785
Epoch: 10, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4127163887023926
Epoch: 11, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4610323905944824
Epoch: 12, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5051295757293701
Epoch: 13, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4799182415008545
Epoch: 14, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.48052000999450684
Epoch: 15, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.45142626762390137
Epoch: 16, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.48535752296447754
Epoch: 17, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5067903995513916
Epoch: 18, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.45162248611450195
Epoch: 19, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.45885181427001953
Epoch: 20, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5278780460357666
Epoch: 21, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4325416088104248
Epoch: 22, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5109639167785645
Epoch: 23, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.44995617866516113
Epoch: 24, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.43766188621520996
Epoch: 25, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 80603
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5119640827178955
Epoch: 1, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.515038013458252
Epoch: 2, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.49541687965393066
Epoch: 3, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5180513858795166
Epoch: 4, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.506878137588501
Epoch: 5, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.538245439529419
Epoch: 6, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5033323764801025
Epoch: 7, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.43616580963134766
Epoch: 8, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.48555803298950195
Epoch: 9, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5771918296813965
Epoch: 10, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5179140567779541
Epoch: 11, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4512042999267578
Epoch: 12, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 80603
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4835565090179443
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5387258529663086
Epoch: 2, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6116824150085449
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6041970252990723
Epoch: 4, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5599229335784912
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.606436014175415
Epoch: 6, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.588343620300293
Epoch: 7, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5870633125305176
Epoch: 8, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5425326824188232
Epoch: 9, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5514609813690186
Epoch: 10, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5618932247161865
Epoch: 11, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6035737991333008
Epoch: 12, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 80603
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2589213848114014
Epoch: 1, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5237047672271729
Epoch: 2, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5433182716369629
Epoch: 3, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5324459075927734
Epoch: 4, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5224835872650146
Epoch: 5, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5773186683654785
Epoch: 6, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6322643756866455
Epoch: 7, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5282769203186035
Epoch: 8, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.125 Vali Acc: 0.133 Test Loss: 1.125 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5423040390014648
Epoch: 9, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.132 Vali Acc: 0.133 Test Loss: 1.132 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6004202365875244
Epoch: 10, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.139 Vali Acc: 0.133 Test Loss: 1.139 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5399508476257324
Epoch: 11, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.145 Vali Acc: 0.133 Test Loss: 1.145 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5643324851989746
Epoch: 12, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 72411
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4905731678009033
Epoch: 1, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.7018227577209473
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5333950519561768
Epoch: 3, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.5312514305114746
Epoch: 4, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.674175500869751
Epoch: 5, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.154 Vali Acc: 0.067 Test Loss: 1.154 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6707253456115723
Epoch: 6, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.55643630027771
Epoch: 7, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.5709600448608398
Epoch: 8, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6513164043426514
Epoch: 9, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5518798828125
Epoch: 10, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5617845058441162
Epoch: 11, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.522409200668335
Epoch: 12, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.193 Vali Acc: 0.200 Test Loss: 1.193 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.561715841293335
Epoch: 13, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5203659534454346
Epoch: 14, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5181066989898682
Epoch: 15, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6193315982818604
Epoch: 16, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6085348129272461
Epoch: 17, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.221 Vali Acc: 0.200 Test Loss: 1.221 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 72411
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.119702100753784
Epoch: 1, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4041562080383301
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4184226989746094
Epoch: 3, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.456298828125
Epoch: 4, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.47411608695983887
Epoch: 5, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4661526679992676
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.509056568145752
Epoch: 7, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4272754192352295
Epoch: 8, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4524064064025879
Epoch: 9, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.44316816329956055
Epoch: 10, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4491603374481201
Epoch: 11, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.43709611892700195
Epoch: 12, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4903299808502197
Epoch: 13, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.46779966354370117
Epoch: 14, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.44538116455078125
Epoch: 15, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.47298741340637207
Epoch: 16, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 72411
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4291629791259766
Epoch: 1, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4737718105316162
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4399738311767578
Epoch: 3, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.48447632789611816
Epoch: 4, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4583308696746826
Epoch: 5, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.512958288192749
Epoch: 6, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4810783863067627
Epoch: 7, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4657912254333496
Epoch: 8, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5693132877349854
Epoch: 9, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.478318452835083
Epoch: 10, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5032391548156738
Epoch: 11, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.42513179779052734
Epoch: 12, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4603703022003174
Epoch: 13, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.47114014625549316
Epoch: 14, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 72411
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.236628293991089
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.44301342964172363
Epoch: 2, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4095637798309326
Epoch: 3, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4155304431915283
Epoch: 4, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4259450435638428
Epoch: 5, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3955507278442383
Epoch: 6, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4083235263824463
Epoch: 7, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.4643256664276123
Epoch: 8, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.44213104248046875
Epoch: 9, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.44958066940307617
Epoch: 10, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4538295269012451
Epoch: 11, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4599285125732422
Epoch: 12, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.41040706634521484
Epoch: 13, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.399519681930542
Epoch: 14, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.529416561126709
Epoch: 15, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.4748516082763672
Epoch: 16, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4251120090484619
Epoch: 17, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4368553161621094
Epoch: 18, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4605696201324463
Epoch: 19, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.43355751037597656
Epoch: 20, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.46418285369873047
Epoch: 21, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4492614269256592
Epoch: 22, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.287 Vali Acc: 0.333 Test Loss: 1.287 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4540841579437256
Epoch: 23, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.302 Vali Acc: 0.333 Test Loss: 1.302 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.4737884998321533
Epoch: 24, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.318 Vali Acc: 0.333 Test Loss: 1.318 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5027132034301758
Epoch: 25, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.337 Vali Acc: 0.333 Test Loss: 1.337 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 68315
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2799062728881836
Epoch: 1, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4608571529388428
Epoch: 2, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.139 Vali Acc: 0.133 Test Loss: 1.139 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46353673934936523
Epoch: 3, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5526783466339111
Epoch: 4, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5242791175842285
Epoch: 5, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6757063865661621
Epoch: 6, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4884514808654785
Epoch: 7, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.153 Vali Acc: 0.133 Test Loss: 1.153 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5112338066101074
Epoch: 8, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5639293193817139
Epoch: 9, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.563814640045166
Epoch: 10, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4867854118347168
Epoch: 11, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 68315
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.501800060272217
Epoch: 1, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4685401916503906
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4860548973083496
Epoch: 3, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4883265495300293
Epoch: 4, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5173599720001221
Epoch: 5, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5077774524688721
Epoch: 6, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.48609066009521484
Epoch: 7, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.48325514793395996
Epoch: 8, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5073480606079102
Epoch: 9, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.45946168899536133
Epoch: 10, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4947812557220459
Epoch: 11, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5033705234527588
Epoch: 12, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5155928134918213
Epoch: 13, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.48005080223083496
Epoch: 14, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 68315
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3861472606658936
Epoch: 1, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6037087440490723
Epoch: 2, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.56784987449646
Epoch: 3, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6341836452484131
Epoch: 4, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5660824775695801
Epoch: 5, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.621288537979126
Epoch: 6, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5617196559906006
Epoch: 7, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5097882747650146
Epoch: 8, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5452055931091309
Epoch: 9, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6099255084991455
Epoch: 10, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5388808250427246
Epoch: 11, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5288159847259521
Epoch: 12, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6236693859100342
Epoch: 13, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.705533504486084
Epoch: 14, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5643858909606934
Epoch: 15, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6655824184417725
Epoch: 16, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5794761180877686
Epoch: 17, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_ETSformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 68315
model size : 0.88MB
