Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2596065
	speed: 0.0732s/iter; left time: 3017.1559s
	iters: 200, epoch: 1 | loss: 0.0958361
	speed: 0.0571s/iter; left time: 2348.4734s
	iters: 300, epoch: 1 | loss: 0.0116056
	speed: 0.0568s/iter; left time: 2329.1607s
	iters: 400, epoch: 1 | loss: 0.3003918
	speed: 0.0456s/iter; left time: 1863.4386s
Epoch: 1 cost time: 23.973548650741577
Epoch: 1, Steps: 413 | Train Loss: 0.293 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (inf --> -0.957706).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0009569
	speed: 0.1481s/iter; left time: 6039.2245s
	iters: 200, epoch: 2 | loss: 0.0055578
	speed: 0.0536s/iter; left time: 2182.7565s
	iters: 300, epoch: 2 | loss: 0.1648139
	speed: 0.0550s/iter; left time: 2232.3331s
	iters: 400, epoch: 2 | loss: 0.0020068
	speed: 0.0510s/iter; left time: 2065.4101s
Epoch: 2 cost time: 22.392266273498535
Epoch: 2, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.212 Vali Acc: 0.964 Test Loss: 0.212 Test Acc: 0.964
Validation loss decreased (-0.957706 --> -0.964072).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7073524
	speed: 0.1639s/iter; left time: 6615.6787s
	iters: 200, epoch: 3 | loss: 0.0015021
	speed: 0.0585s/iter; left time: 2354.8165s
	iters: 300, epoch: 3 | loss: 0.0001007
	speed: 0.0554s/iter; left time: 2226.3984s
	iters: 400, epoch: 3 | loss: 1.2777508
	speed: 0.0512s/iter; left time: 2052.7906s
Epoch: 3 cost time: 22.988799810409546
Epoch: 3, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.203 Vali Acc: 0.965 Test Loss: 0.203 Test Acc: 0.965
Validation loss decreased (-0.964072 --> -0.965437).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0259196
	speed: 0.1510s/iter; left time: 6033.1313s
	iters: 200, epoch: 4 | loss: 0.0042863
	speed: 0.0525s/iter; left time: 2092.3301s
	iters: 300, epoch: 4 | loss: 0.0002120
	speed: 0.0545s/iter; left time: 2165.4777s
	iters: 400, epoch: 4 | loss: 0.0017132
	speed: 0.0500s/iter; left time: 1984.1480s
Epoch: 4 cost time: 22.328632593154907
Epoch: 4, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.224 Vali Acc: 0.968 Test Loss: 0.224 Test Acc: 0.968
Validation loss decreased (-0.965437 --> -0.967710).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0910641
	speed: 0.1534s/iter; left time: 6064.9729s
	iters: 200, epoch: 5 | loss: 0.0000002
	speed: 0.0559s/iter; left time: 2204.7607s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 2185.6460s
	iters: 400, epoch: 5 | loss: 0.0737453
	speed: 0.0573s/iter; left time: 2247.9421s
Epoch: 5 cost time: 23.558876037597656
Epoch: 5, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.383 Vali Acc: 0.962 Test Loss: 0.383 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0014332
	speed: 0.1559s/iter; left time: 6100.5208s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 2239.6407s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 2245.4892s
	iters: 400, epoch: 6 | loss: 0.0000113
	speed: 0.0579s/iter; left time: 2248.5265s
Epoch: 6 cost time: 23.484389543533325
Epoch: 6, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.359 Vali Acc: 0.962 Test Loss: 0.359 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1493s/iter; left time: 5779.7444s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 2214.2432s
	iters: 300, epoch: 7 | loss: 0.0062683
	speed: 0.0564s/iter; left time: 2172.2144s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0564s/iter; left time: 2168.7705s
Epoch: 7 cost time: 23.428264379501343
Epoch: 7, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.327 Vali Acc: 0.971 Test Loss: 0.327 Test Acc: 0.971
Validation loss decreased (-0.967710 --> -0.970893).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1557s/iter; left time: 5964.0145s
	iters: 200, epoch: 8 | loss: 0.0000186
	speed: 0.0541s/iter; left time: 2066.6586s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 2037.9139s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 2070.1817s
Epoch: 8 cost time: 22.34877634048462
Epoch: 8, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.970893 --> -0.975441).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0002519
	speed: 0.1631s/iter; left time: 6180.1243s
	iters: 200, epoch: 9 | loss: 0.0000005
	speed: 0.0451s/iter; left time: 1705.9409s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 2200.6061s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 2159.2543s
Epoch: 9 cost time: 22.03818941116333
Epoch: 9, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.436 Vali Acc: 0.966 Test Loss: 0.436 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1724s/iter; left time: 6462.9579s
	iters: 200, epoch: 10 | loss: 0.0000280
	speed: 0.0480s/iter; left time: 1792.6217s
	iters: 300, epoch: 10 | loss: 0.1166217
	speed: 0.0435s/iter; left time: 1620.8120s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 1895.9311s
Epoch: 10 cost time: 20.893864393234253
Epoch: 10, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.551 Vali Acc: 0.965 Test Loss: 0.551 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1659s/iter; left time: 6150.0456s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 2023.8987s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0477s/iter; left time: 1760.5824s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.0453s/iter; left time: 1665.9182s
Epoch: 11 cost time: 21.46459197998047
Epoch: 11, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.532 Vali Acc: 0.962 Test Loss: 0.532 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.1494s/iter; left time: 5477.6985s
	iters: 200, epoch: 12 | loss: 0.0010557
	speed: 0.0523s/iter; left time: 1910.8875s
	iters: 300, epoch: 12 | loss: 0.0226750
	speed: 0.0537s/iter; left time: 1958.7232s
	iters: 400, epoch: 12 | loss: 1.4616427
	speed: 0.0453s/iter; left time: 1645.5078s
Epoch: 12 cost time: 21.055770874023438
Epoch: 12, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.536 Vali Acc: 0.965 Test Loss: 0.536 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1512s/iter; left time: 5480.6691s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0537s/iter; left time: 1940.9403s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 1970.1063s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 1920.8528s
Epoch: 13 cost time: 22.628150701522827
Epoch: 13, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.405 Vali Acc: 0.972 Test Loss: 0.405 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1391s/iter; left time: 4982.8926s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 2026.9681s
	iters: 300, epoch: 14 | loss: 0.0000019
	speed: 0.0586s/iter; left time: 2088.3648s
	iters: 400, epoch: 14 | loss: 0.0006534
	speed: 0.0595s/iter; left time: 2113.7816s
Epoch: 14 cost time: 23.31226897239685
Epoch: 14, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.504 Vali Acc: 0.966 Test Loss: 0.504 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1530s/iter; left time: 5419.8605s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 1719.6111s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 1978.0780s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 2010.8749s
Epoch: 15 cost time: 22.15912675857544
Epoch: 15, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.607 Vali Acc: 0.968 Test Loss: 0.607 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1655s/iter; left time: 5793.8600s
	iters: 200, epoch: 16 | loss: 0.0000751
	speed: 0.0488s/iter; left time: 1704.3072s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 1671.2973s
	iters: 400, epoch: 16 | loss: 0.0000018
	speed: 0.0547s/iter; left time: 1897.8328s
Epoch: 16 cost time: 21.6112322807312
Epoch: 16, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.476 Vali Acc: 0.970 Test Loss: 0.476 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1701s/iter; left time: 5885.8482s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 1960.0550s
	iters: 300, epoch: 17 | loss: 0.0089944
	speed: 0.0550s/iter; left time: 1889.9384s
	iters: 400, epoch: 17 | loss: 0.3621627
	speed: 0.0549s/iter; left time: 1883.1995s
Epoch: 17 cost time: 23.496586084365845
Epoch: 17, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.281 Vali Acc: 0.979 Test Loss: 0.281 Test Acc: 0.979
Validation loss decreased (-0.975441 --> -0.979079).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1456s/iter; left time: 4977.9163s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 1717.4106s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 1774.9105s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0541s/iter; left time: 1831.9415s
Epoch: 18 cost time: 21.73113751411438
Epoch: 18, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.217 Vali Acc: 0.986 Test Loss: 0.217 Test Acc: 0.986
Validation loss decreased (-0.979079 --> -0.986355).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1533s/iter; left time: 5176.4965s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 1834.0549s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0563s/iter; left time: 1889.9546s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 1870.9224s
Epoch: 19 cost time: 22.93055248260498
Epoch: 19, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.595 Vali Acc: 0.971 Test Loss: 0.595 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1665s/iter; left time: 5552.5517s
	iters: 200, epoch: 20 | loss: 0.5181619
	speed: 0.0476s/iter; left time: 1581.5228s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 1719.8358s
	iters: 400, epoch: 20 | loss: 0.0000011
	speed: 0.0542s/iter; left time: 1791.7216s
Epoch: 20 cost time: 21.162325859069824
Epoch: 20, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.309 Vali Acc: 0.982 Test Loss: 0.309 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1533s/iter; left time: 5049.9359s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1549.2157s
	iters: 300, epoch: 21 | loss: 0.8031071
	speed: 0.0509s/iter; left time: 1667.2031s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 1734.6040s
Epoch: 21 cost time: 20.977046728134155
Epoch: 21, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.389 Vali Acc: 0.978 Test Loss: 0.389 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1576s/iter; left time: 5127.3549s
	iters: 200, epoch: 22 | loss: 0.4855363
	speed: 0.0470s/iter; left time: 1523.8450s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 1411.5846s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 1683.6206s
Epoch: 22 cost time: 20.37867021560669
Epoch: 22, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.397 Vali Acc: 0.980 Test Loss: 0.397 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1637s/iter; left time: 5257.6876s
	iters: 200, epoch: 23 | loss: 0.0000832
	speed: 0.0490s/iter; left time: 1570.0062s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 1473.1749s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 1572.6033s
Epoch: 23 cost time: 20.867844104766846
Epoch: 23, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.491 Vali Acc: 0.975 Test Loss: 0.491 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 3.7819419
	speed: 0.1645s/iter; left time: 5215.6798s
	iters: 200, epoch: 24 | loss: 0.3353050
	speed: 0.0536s/iter; left time: 1692.5697s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 1560.0207s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0465s/iter; left time: 1460.5743s
Epoch: 24 cost time: 21.493283987045288
Epoch: 24, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.840 Vali Acc: 0.973 Test Loss: 0.840 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0230072
	speed: 0.1620s/iter; left time: 5067.3908s
	iters: 200, epoch: 25 | loss: 0.0000034
	speed: 0.0528s/iter; left time: 1645.9229s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1639.8196s
	iters: 400, epoch: 25 | loss: 0.0000081
	speed: 0.0478s/iter; left time: 1481.0649s
Epoch: 25 cost time: 21.71330499649048
Epoch: 25, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.351 Vali Acc: 0.983 Test Loss: 0.351 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1546s/iter; left time: 4774.4710s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 1640.3931s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 1587.5353s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 1508.9575s
Epoch: 26 cost time: 21.73088765144348
Epoch: 26, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.314 Vali Acc: 0.985 Test Loss: 0.314 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0021820
	speed: 0.1609s/iter; left time: 4902.7489s
	iters: 200, epoch: 27 | loss: 0.0000002
	speed: 0.0532s/iter; left time: 1615.3504s
	iters: 300, epoch: 27 | loss: 0.0004116
	speed: 0.0531s/iter; left time: 1607.8186s
	iters: 400, epoch: 27 | loss: 0.0000063
	speed: 0.0483s/iter; left time: 1455.8444s
Epoch: 27 cost time: 21.703402757644653
Epoch: 27, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.395 Vali Acc: 0.981 Test Loss: 0.395 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1517s/iter; left time: 4558.4972s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 1570.3136s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 1586.1614s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 1563.8988s
Epoch: 28 cost time: 22.138511896133423
Epoch: 28, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.645 Vali Acc: 0.975 Test Loss: 0.645 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 5776018
model size : 31.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2815561
	speed: 0.0688s/iter; left time: 2832.9118s
	iters: 200, epoch: 1 | loss: 0.0729649
	speed: 0.0453s/iter; left time: 1863.0608s
	iters: 300, epoch: 1 | loss: 0.0436120
	speed: 0.0463s/iter; left time: 1898.2511s
	iters: 400, epoch: 1 | loss: 0.2211749
	speed: 0.0470s/iter; left time: 1920.5165s
Epoch: 1 cost time: 21.441444635391235
Epoch: 1, Steps: 413 | Train Loss: 0.283 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (inf --> -0.967711).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4485131
	speed: 0.1611s/iter; left time: 6571.1237s
	iters: 200, epoch: 2 | loss: 0.0026610
	speed: 0.0476s/iter; left time: 1938.1709s
	iters: 300, epoch: 2 | loss: 0.0527939
	speed: 0.0468s/iter; left time: 1899.5347s
	iters: 400, epoch: 2 | loss: 0.0643917
	speed: 0.0441s/iter; left time: 1785.8550s
Epoch: 2 cost time: 19.990113973617554
Epoch: 2, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
Validation loss decreased (-0.967711 --> -0.968166).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2996895
	speed: 0.1627s/iter; left time: 6570.5959s
	iters: 200, epoch: 3 | loss: 0.0000001
	speed: 0.0493s/iter; left time: 1985.3918s
	iters: 300, epoch: 3 | loss: 0.0035277
	speed: 0.0498s/iter; left time: 1999.3468s
	iters: 400, epoch: 3 | loss: 0.0000859
	speed: 0.0501s/iter; left time: 2007.8555s
Epoch: 3 cost time: 21.040097951889038
Epoch: 3, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.215 Vali Acc: 0.964 Test Loss: 0.215 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6583977
	speed: 0.1426s/iter; left time: 5698.3606s
	iters: 200, epoch: 4 | loss: 0.0000441
	speed: 0.0477s/iter; left time: 1902.0955s
	iters: 300, epoch: 4 | loss: 0.0339664
	speed: 0.0475s/iter; left time: 1889.3254s
	iters: 400, epoch: 4 | loss: 0.0068763
	speed: 0.0472s/iter; left time: 1872.6762s
Epoch: 4 cost time: 19.739238023757935
Epoch: 4, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.596 Vali Acc: 0.929 Test Loss: 0.596 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000111
	speed: 0.1387s/iter; left time: 5484.2145s
	iters: 200, epoch: 5 | loss: 0.0000252
	speed: 0.0434s/iter; left time: 1710.6572s
	iters: 300, epoch: 5 | loss: 0.0000062
	speed: 0.0478s/iter; left time: 1879.5731s
	iters: 400, epoch: 5 | loss: 0.0000023
	speed: 0.0434s/iter; left time: 1703.0891s
Epoch: 5 cost time: 18.64447855949402
Epoch: 5, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.263 Vali Acc: 0.970 Test Loss: 0.263 Test Acc: 0.970
Validation loss decreased (-0.968166 --> -0.969984).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000067
	speed: 0.1315s/iter; left time: 5145.2808s
	iters: 200, epoch: 6 | loss: 0.0000063
	speed: 0.0421s/iter; left time: 1642.0629s
	iters: 300, epoch: 6 | loss: 0.0002716
	speed: 0.0437s/iter; left time: 1700.0877s
	iters: 400, epoch: 6 | loss: 0.6778393
	speed: 0.0459s/iter; left time: 1781.8951s
Epoch: 6 cost time: 18.331904649734497
Epoch: 6, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.341 Vali Acc: 0.970 Test Loss: 0.341 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0132435
	speed: 0.1495s/iter; left time: 5788.8334s
	iters: 200, epoch: 7 | loss: 0.0106964
	speed: 0.0429s/iter; left time: 1655.8952s
	iters: 300, epoch: 7 | loss: 0.0000020
	speed: 0.0437s/iter; left time: 1684.1144s
	iters: 400, epoch: 7 | loss: 0.0000082
	speed: 0.0423s/iter; left time: 1624.2630s
Epoch: 7 cost time: 18.52177619934082
Epoch: 7, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.209 Vali Acc: 0.974 Test Loss: 0.209 Test Acc: 0.974
Validation loss decreased (-0.969984 --> -0.974077).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1374331
	speed: 0.1466s/iter; left time: 5615.4504s
	iters: 200, epoch: 8 | loss: 0.0011868
	speed: 0.0449s/iter; left time: 1714.5169s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 1712.1514s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0434s/iter; left time: 1648.0202s
Epoch: 8 cost time: 18.845119953155518
Epoch: 8, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.485 Vali Acc: 0.966 Test Loss: 0.485 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.1513s/iter; left time: 5732.6608s
	iters: 200, epoch: 9 | loss: 0.0001302
	speed: 0.0474s/iter; left time: 1791.7996s
	iters: 300, epoch: 9 | loss: 0.0000002
	speed: 0.0471s/iter; left time: 1777.2997s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1646.0169s
Epoch: 9 cost time: 19.507888793945312
Epoch: 9, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.340 Vali Acc: 0.972 Test Loss: 0.340 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000010
	speed: 0.1295s/iter; left time: 4854.4996s
	iters: 200, epoch: 10 | loss: 0.8786461
	speed: 0.0460s/iter; left time: 1720.5427s
	iters: 300, epoch: 10 | loss: 0.8256745
	speed: 0.0477s/iter; left time: 1776.8782s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1725.4158s
Epoch: 10 cost time: 19.608014583587646
Epoch: 10, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.430 Vali Acc: 0.965 Test Loss: 0.430 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1416s/iter; left time: 5249.1305s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 1817.2368s
	iters: 300, epoch: 11 | loss: 0.0000004
	speed: 0.0550s/iter; left time: 2029.1047s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1928.8539s
Epoch: 11 cost time: 21.463850498199463
Epoch: 11, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.407 Vali Acc: 0.970 Test Loss: 0.407 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000006
	speed: 0.2180s/iter; left time: 7992.2799s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0849s/iter; left time: 3103.7634s
	iters: 300, epoch: 12 | loss: 1.4416730
	speed: 0.0908s/iter; left time: 3311.0367s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0880s/iter; left time: 3199.9293s
Epoch: 12 cost time: 36.04788398742676
Epoch: 12, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.242 Vali Acc: 0.983 Test Loss: 0.242 Test Acc: 0.983
Validation loss decreased (-0.974077 --> -0.982717).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2479s/iter; left time: 8985.6102s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 3301.0326s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0891s/iter; left time: 3210.0003s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0828s/iter; left time: 2976.5156s
Epoch: 13 cost time: 37.03274488449097
Epoch: 13, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.282 Vali Acc: 0.977 Test Loss: 0.282 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2636s/iter; left time: 9446.1265s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 3141.3374s
	iters: 300, epoch: 14 | loss: 0.0000316
	speed: 0.0824s/iter; left time: 2936.2714s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0829s/iter; left time: 2945.3098s
Epoch: 14 cost time: 35.9413366317749
Epoch: 14, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.268 Vali Acc: 0.977 Test Loss: 0.268 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2805s/iter; left time: 9934.9692s
	iters: 200, epoch: 15 | loss: 0.0000009
	speed: 0.0814s/iter; left time: 2875.6581s
	iters: 300, epoch: 15 | loss: 0.1239069
	speed: 0.0842s/iter; left time: 2967.0556s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 2951.7691s
Epoch: 15 cost time: 34.90278506278992
Epoch: 15, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.533 Vali Acc: 0.975 Test Loss: 0.533 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2459s/iter; left time: 8606.2431s
	iters: 200, epoch: 16 | loss: 0.0000003
	speed: 0.0836s/iter; left time: 2917.4234s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 2741.3010s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0908s/iter; left time: 3150.3424s
Epoch: 16 cost time: 35.4266631603241
Epoch: 16, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.179 Vali Acc: 0.984 Test Loss: 0.179 Test Acc: 0.984
Validation loss decreased (-0.982717 --> -0.984082).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2472s/iter; left time: 8551.3484s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0910s/iter; left time: 3137.8341s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 3215.5359s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0924s/iter; left time: 3169.3714s
Epoch: 17 cost time: 37.61914849281311
Epoch: 17, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.554 Vali Acc: 0.976 Test Loss: 0.554 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2700s/iter; left time: 9227.6008s
	iters: 200, epoch: 18 | loss: 0.0016823
	speed: 0.0896s/iter; left time: 3055.1921s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0726s/iter; left time: 2465.4250s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0856s/iter; left time: 2900.0077s
Epoch: 18 cost time: 35.610405683517456
Epoch: 18, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.501 Vali Acc: 0.976 Test Loss: 0.501 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2564s/iter; left time: 8656.9365s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 2682.8165s
	iters: 300, epoch: 19 | loss: 1.5308337
	speed: 0.0852s/iter; left time: 2861.0481s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0857s/iter; left time: 2868.1077s
Epoch: 19 cost time: 35.160555362701416
Epoch: 19, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.316 Vali Acc: 0.981 Test Loss: 0.316 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2442s/iter; left time: 8143.6926s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0811s/iter; left time: 2698.3078s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0843s/iter; left time: 2795.3484s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0851s/iter; left time: 2812.1115s
Epoch: 20 cost time: 34.5502712726593
Epoch: 20, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.669 Vali Acc: 0.971 Test Loss: 0.669 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.2581s/iter; left time: 8502.1014s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 2845.7018s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 2862.0356s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0803s/iter; left time: 2622.2795s
Epoch: 21 cost time: 35.013988971710205
Epoch: 21, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.439 Vali Acc: 0.977 Test Loss: 0.439 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2366s/iter; left time: 7695.3318s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0898s/iter; left time: 2911.8836s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 2695.3513s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0826s/iter; left time: 2662.4950s
Epoch: 22 cost time: 36.0476176738739
Epoch: 22, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.537 Vali Acc: 0.979 Test Loss: 0.537 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2458s/iter; left time: 7893.6365s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0813s/iter; left time: 2603.8114s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0866s/iter; left time: 2765.3587s
	iters: 400, epoch: 23 | loss: 0.0370459
	speed: 0.0865s/iter; left time: 2753.4452s
Epoch: 23 cost time: 35.59342432022095
Epoch: 23, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.585 Vali Acc: 0.975 Test Loss: 0.585 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2651s/iter; left time: 8404.3272s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0815s/iter; left time: 2576.8214s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 2445.7411s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 2562.2308s
Epoch: 24 cost time: 34.088990449905396
Epoch: 24, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.689 Vali Acc: 0.967 Test Loss: 0.689 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2620s/iter; left time: 8198.4034s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0825s/iter; left time: 2572.8366s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 2705.1001s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0803s/iter; left time: 2486.9035s
Epoch: 25 cost time: 34.840285301208496
Epoch: 25, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.510 Vali Acc: 0.975 Test Loss: 0.510 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2432s/iter; left time: 7510.4145s
	iters: 200, epoch: 26 | loss: 0.0000569
	speed: 0.0834s/iter; left time: 2568.0578s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0794s/iter; left time: 2435.9923s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2348.3860s
Epoch: 26 cost time: 34.179752588272095
Epoch: 26, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.976 Vali Acc: 0.959 Test Loss: 0.976 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 5776018
model size : 31.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3010126
	speed: 0.1115s/iter; left time: 4592.5498s
	iters: 200, epoch: 1 | loss: 0.2315329
	speed: 0.0890s/iter; left time: 3659.1463s
	iters: 300, epoch: 1 | loss: 0.0050925
	speed: 0.0855s/iter; left time: 3504.3254s
	iters: 400, epoch: 1 | loss: 0.0031442
	speed: 0.0944s/iter; left time: 3862.6191s
Epoch: 1 cost time: 39.43643808364868
Epoch: 1, Steps: 413 | Train Loss: 0.274 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
Validation loss decreased (inf --> -0.966347).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0009805
	speed: 0.2660s/iter; left time: 10851.3866s
	iters: 200, epoch: 2 | loss: 0.1030583
	speed: 0.0887s/iter; left time: 3609.5529s
	iters: 300, epoch: 2 | loss: 0.0017812
	speed: 0.0937s/iter; left time: 3804.7642s
	iters: 400, epoch: 2 | loss: 0.0005732
	speed: 0.0906s/iter; left time: 3667.2349s
Epoch: 2 cost time: 37.49747848510742
Epoch: 2, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
Validation loss decreased (-0.966347 --> -0.983628).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0010055
	speed: 0.2626s/iter; left time: 10601.0622s
	iters: 200, epoch: 3 | loss: 0.0000011
	speed: 0.0867s/iter; left time: 3493.2217s
	iters: 300, epoch: 3 | loss: 0.0137127
	speed: 0.0843s/iter; left time: 3388.3214s
	iters: 400, epoch: 3 | loss: 0.1969399
	speed: 0.0771s/iter; left time: 3088.8284s
Epoch: 3 cost time: 35.393542766571045
Epoch: 3, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0008553
	speed: 0.2772s/iter; left time: 11077.0815s
	iters: 200, epoch: 4 | loss: 0.0381800
	speed: 0.0838s/iter; left time: 3339.2799s
	iters: 300, epoch: 4 | loss: 0.0000005
	speed: 0.0853s/iter; left time: 3393.4066s
	iters: 400, epoch: 4 | loss: 0.0822391
	speed: 0.0951s/iter; left time: 3771.8719s
Epoch: 4 cost time: 36.33803915977478
Epoch: 4, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.195 Vali Acc: 0.970 Test Loss: 0.195 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0203377
	speed: 0.2674s/iter; left time: 10575.9379s
	iters: 200, epoch: 5 | loss: 0.0000029
	speed: 0.0914s/iter; left time: 3605.7102s
	iters: 300, epoch: 5 | loss: 0.0000067
	speed: 0.0835s/iter; left time: 3286.4471s
	iters: 400, epoch: 5 | loss: 0.0004043
	speed: 0.0815s/iter; left time: 3197.0639s
Epoch: 5 cost time: 36.03484082221985
Epoch: 5, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.369 Vali Acc: 0.960 Test Loss: 0.369 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0009521
	speed: 0.2625s/iter; left time: 10274.1574s
	iters: 200, epoch: 6 | loss: 0.0000032
	speed: 0.0839s/iter; left time: 3275.4339s
	iters: 300, epoch: 6 | loss: 0.0000052
	speed: 0.0893s/iter; left time: 3477.4496s
	iters: 400, epoch: 6 | loss: 0.9361571
	speed: 0.0894s/iter; left time: 3472.4651s
Epoch: 6 cost time: 36.43176460266113
Epoch: 6, Steps: 413 | Train Loss: 0.151 Vali Loss: 0.201 Vali Acc: 0.974 Test Loss: 0.201 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000003
	speed: 0.2717s/iter; left time: 10519.3717s
	iters: 200, epoch: 7 | loss: 0.0000004
	speed: 0.1001s/iter; left time: 3865.0886s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0849s/iter; left time: 3268.9141s
	iters: 400, epoch: 7 | loss: 0.1690647
	speed: 0.0879s/iter; left time: 3378.6318s
Epoch: 7 cost time: 38.0910542011261
Epoch: 7, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.245 Vali Acc: 0.976 Test Loss: 0.245 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000067
	speed: 0.2803s/iter; left time: 10738.4637s
	iters: 200, epoch: 8 | loss: 0.0000042
	speed: 0.0821s/iter; left time: 3135.7228s
	iters: 300, epoch: 8 | loss: 0.0261013
	speed: 0.0839s/iter; left time: 3198.4765s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0858s/iter; left time: 3260.7356s
Epoch: 8 cost time: 35.61607265472412
Epoch: 8, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.475 Vali Acc: 0.961 Test Loss: 0.475 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.3864277
	speed: 0.2471s/iter; left time: 9365.3095s
	iters: 200, epoch: 9 | loss: 0.0000312
	speed: 0.0853s/iter; left time: 3222.2089s
	iters: 300, epoch: 9 | loss: 0.0005198
	speed: 0.0889s/iter; left time: 3349.7062s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0813s/iter; left time: 3057.1140s
Epoch: 9 cost time: 35.549094676971436
Epoch: 9, Steps: 413 | Train Loss: 0.134 Vali Loss: 0.623 Vali Acc: 0.960 Test Loss: 0.623 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2630s/iter; left time: 9857.6655s
	iters: 200, epoch: 10 | loss: 0.0000255
	speed: 0.0823s/iter; left time: 3076.1544s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 2927.4647s
	iters: 400, epoch: 10 | loss: 1.8845769
	speed: 0.0858s/iter; left time: 3190.5337s
Epoch: 10 cost time: 35.242419958114624
Epoch: 10, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.323 Vali Acc: 0.968 Test Loss: 0.323 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000007
	speed: 0.2828s/iter; left time: 10484.5189s
	iters: 200, epoch: 11 | loss: 0.0000214
	speed: 0.0775s/iter; left time: 2866.8065s
	iters: 300, epoch: 11 | loss: 0.0000022
	speed: 0.0842s/iter; left time: 3104.7525s
	iters: 400, epoch: 11 | loss: 1.6878464
	speed: 0.0879s/iter; left time: 3232.8365s
Epoch: 11 cost time: 34.659982442855835
Epoch: 11, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.879 Vali Acc: 0.955 Test Loss: 0.879 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2499s/iter; left time: 9160.0842s
	iters: 200, epoch: 12 | loss: 0.0005297
	speed: 0.0879s/iter; left time: 3214.5828s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0883s/iter; left time: 3219.6942s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 3156.2661s
Epoch: 12 cost time: 36.667696952819824
Epoch: 12, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.323 Vali Acc: 0.981 Test Loss: 0.323 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 5776018
model size : 31.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1407487
	speed: 0.1047s/iter; left time: 4311.9140s
	iters: 200, epoch: 1 | loss: 0.2409762
	speed: 0.0875s/iter; left time: 3594.4788s
	iters: 300, epoch: 1 | loss: 0.0017674
	speed: 0.0795s/iter; left time: 3258.0838s
	iters: 400, epoch: 1 | loss: 0.0149970
	speed: 0.0789s/iter; left time: 3228.4440s
Epoch: 1 cost time: 36.06987977027893
Epoch: 1, Steps: 413 | Train Loss: 0.281 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0626630
	speed: 0.2731s/iter; left time: 11140.6297s
	iters: 200, epoch: 2 | loss: 0.0152148
	speed: 0.0754s/iter; left time: 3068.3104s
	iters: 300, epoch: 2 | loss: 0.0649115
	speed: 0.0720s/iter; left time: 2923.3016s
	iters: 400, epoch: 2 | loss: 0.0006340
	speed: 0.0775s/iter; left time: 3137.3663s
Epoch: 2 cost time: 31.944880962371826
Epoch: 2, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0182837
	speed: 0.2533s/iter; left time: 10227.4194s
	iters: 200, epoch: 3 | loss: 0.0087147
	speed: 0.0808s/iter; left time: 3255.8645s
	iters: 300, epoch: 3 | loss: 0.0124876
	speed: 0.0862s/iter; left time: 3462.7361s
	iters: 400, epoch: 3 | loss: 0.2477785
	speed: 0.0834s/iter; left time: 3342.5239s
Epoch: 3 cost time: 34.9953715801239
Epoch: 3, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.277 Vali Acc: 0.952 Test Loss: 0.277 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000001
	speed: 0.2463s/iter; left time: 9841.2015s
	iters: 200, epoch: 4 | loss: 0.0120606
	speed: 0.0810s/iter; left time: 3229.4759s
	iters: 300, epoch: 4 | loss: 0.0000007
	speed: 0.0783s/iter; left time: 3112.0072s
	iters: 400, epoch: 4 | loss: 0.1292519
	speed: 0.0822s/iter; left time: 3260.8296s
Epoch: 4 cost time: 33.750813722610474
Epoch: 4, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.279 Vali Acc: 0.964 Test Loss: 0.279 Test Acc: 0.964
Validation loss decreased (-0.957252 --> -0.963617).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000895
	speed: 0.2674s/iter; left time: 10575.8820s
	iters: 200, epoch: 5 | loss: 0.6731994
	speed: 0.0856s/iter; left time: 3375.6736s
	iters: 300, epoch: 5 | loss: 0.0150815
	speed: 0.0890s/iter; left time: 3501.2357s
	iters: 400, epoch: 5 | loss: 0.0085219
	speed: 0.0788s/iter; left time: 3092.6733s
Epoch: 5 cost time: 34.66512632369995
Epoch: 5, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.321 Vali Acc: 0.967 Test Loss: 0.321 Test Acc: 0.967
Validation loss decreased (-0.963617 --> -0.966800).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000221
	speed: 0.2477s/iter; left time: 9693.2293s
	iters: 200, epoch: 6 | loss: 0.0044093
	speed: 0.0861s/iter; left time: 3362.3979s
	iters: 300, epoch: 6 | loss: 0.0008302
	speed: 0.0863s/iter; left time: 3359.6354s
	iters: 400, epoch: 6 | loss: 1.1285774
	speed: 0.0850s/iter; left time: 3302.9414s
Epoch: 6 cost time: 35.65209460258484
Epoch: 6, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.364 Vali Acc: 0.971 Test Loss: 0.364 Test Acc: 0.971
Validation loss decreased (-0.966800 --> -0.970892).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0043465
	speed: 0.2579s/iter; left time: 9987.2351s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0851s/iter; left time: 3287.7064s
	iters: 300, epoch: 7 | loss: 0.0000022
	speed: 0.0774s/iter; left time: 2982.0367s
	iters: 400, epoch: 7 | loss: 0.0000333
	speed: 0.0854s/iter; left time: 3280.7176s
Epoch: 7 cost time: 34.81382703781128
Epoch: 7, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.489 Vali Acc: 0.955 Test Loss: 0.489 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0004598
	speed: 0.2792s/iter; left time: 10697.8252s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0793s/iter; left time: 3028.9330s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 3141.4426s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 3004.0038s
Epoch: 8 cost time: 33.371490240097046
Epoch: 8, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.979 Vali Acc: 0.950 Test Loss: 0.979 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.2665s/iter; left time: 10100.3170s
	iters: 200, epoch: 9 | loss: 0.0010255
	speed: 0.0827s/iter; left time: 3127.2436s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 3106.1492s
	iters: 400, epoch: 9 | loss: 0.0000096
	speed: 0.0796s/iter; left time: 2994.2471s
Epoch: 9 cost time: 34.40806436538696
Epoch: 9, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.353 Vali Acc: 0.979 Test Loss: 0.353 Test Acc: 0.979
Validation loss decreased (-0.970892 --> -0.979078).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2487s/iter; left time: 9322.8720s
	iters: 200, epoch: 10 | loss: 0.0000004
	speed: 0.0847s/iter; left time: 3166.8303s
	iters: 300, epoch: 10 | loss: 0.0178189
	speed: 0.0850s/iter; left time: 3169.6021s
	iters: 400, epoch: 10 | loss: 3.5708120
	speed: 0.0868s/iter; left time: 3227.0513s
Epoch: 10 cost time: 35.5087206363678
Epoch: 10, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2708s/iter; left time: 10037.1045s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0914s/iter; left time: 3378.6276s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0789s/iter; left time: 2910.8454s
	iters: 400, epoch: 11 | loss: 0.0004334
	speed: 0.0836s/iter; left time: 3072.4245s
Epoch: 11 cost time: 35.586670875549316
Epoch: 11, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.596 Vali Acc: 0.967 Test Loss: 0.596 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.2588s/iter; left time: 9488.3056s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1020s/iter; left time: 3728.4182s
	iters: 300, epoch: 12 | loss: 1.5456877
	speed: 0.1205s/iter; left time: 4391.7787s
	iters: 400, epoch: 12 | loss: 0.1633672
	speed: 0.0900s/iter; left time: 3272.7488s
Epoch: 12 cost time: 39.41355109214783
Epoch: 12, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.657 Vali Acc: 0.966 Test Loss: 0.657 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000028
	speed: 0.1822s/iter; left time: 6604.2693s
	iters: 200, epoch: 13 | loss: 0.0000066
	speed: 0.0820s/iter; left time: 2963.7830s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0978s/iter; left time: 3524.8770s
	iters: 400, epoch: 13 | loss: 0.4961166
	speed: 0.0962s/iter; left time: 3457.1472s
Epoch: 13 cost time: 34.13470149040222
Epoch: 13, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.581 Vali Acc: 0.969 Test Loss: 0.581 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000005
	speed: 0.2631s/iter; left time: 9428.3074s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0952s/iter; left time: 3402.3119s
	iters: 300, epoch: 14 | loss: 0.0008234
	speed: 0.0952s/iter; left time: 3392.9628s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 2928.3934s
Epoch: 14 cost time: 38.165952920913696
Epoch: 14, Steps: 413 | Train Loss: 0.167 Vali Loss: 0.394 Vali Acc: 0.977 Test Loss: 0.394 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2618s/iter; left time: 9272.8172s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0883s/iter; left time: 3117.5678s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0847s/iter; left time: 2982.1174s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1044s/iter; left time: 3666.9139s
Epoch: 15 cost time: 38.767677307128906
Epoch: 15, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.184 Vali Acc: 0.982 Test Loss: 0.184 Test Acc: 0.982
Validation loss decreased (-0.979078 --> -0.981808).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000007
	speed: 0.2918s/iter; left time: 10215.3251s
	iters: 200, epoch: 16 | loss: 0.0000029
	speed: 0.1009s/iter; left time: 3523.6196s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0925s/iter; left time: 3220.8296s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0769s/iter; left time: 2669.4337s
Epoch: 16 cost time: 37.80103945732117
Epoch: 16, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.455 Vali Acc: 0.975 Test Loss: 0.455 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0092089
	speed: 0.2679s/iter; left time: 9266.6492s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 2816.1454s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0856s/iter; left time: 2943.3246s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0946s/iter; left time: 3242.8938s
Epoch: 17 cost time: 37.31364440917969
Epoch: 17, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.387 Vali Acc: 0.979 Test Loss: 0.387 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2508s/iter; left time: 8571.3096s
	iters: 200, epoch: 18 | loss: 0.0000031
	speed: 0.0964s/iter; left time: 3284.5562s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0936s/iter; left time: 3180.4558s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0902s/iter; left time: 3054.5820s
Epoch: 18 cost time: 37.67382192611694
Epoch: 18, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.628 Vali Acc: 0.978 Test Loss: 0.628 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2875s/iter; left time: 9709.4162s
	iters: 200, epoch: 19 | loss: 0.8306626
	speed: 0.0850s/iter; left time: 2863.2363s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 2738.4327s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 2905.1022s
Epoch: 19 cost time: 36.515854597091675
Epoch: 19, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.575 Vali Acc: 0.972 Test Loss: 0.575 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2507s/iter; left time: 8361.1515s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0923s/iter; left time: 3070.2042s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0908s/iter; left time: 3010.0589s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0908s/iter; left time: 3000.1378s
Epoch: 20 cost time: 36.90388202667236
Epoch: 20, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.502 Vali Acc: 0.976 Test Loss: 0.502 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2508s/iter; left time: 8261.1819s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0984s/iter; left time: 3231.9767s
	iters: 300, epoch: 21 | loss: 0.0036988
	speed: 0.0936s/iter; left time: 3063.4437s
	iters: 400, epoch: 21 | loss: 0.1176961
	speed: 0.0815s/iter; left time: 2659.7702s
Epoch: 21 cost time: 37.698108434677124
Epoch: 21, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.552 Vali Acc: 0.975 Test Loss: 0.552 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2947s/iter; left time: 9586.9008s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 2765.1407s
	iters: 300, epoch: 22 | loss: 0.0354246
	speed: 0.0965s/iter; left time: 3120.6020s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0956s/iter; left time: 3082.2704s
Epoch: 22 cost time: 38.88461256027222
Epoch: 22, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.383 Vali Acc: 0.981 Test Loss: 0.383 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.2523738
	speed: 0.2684s/iter; left time: 8620.9742s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0957s/iter; left time: 3063.5347s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0938s/iter; left time: 2993.6009s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0780s/iter; left time: 2481.4671s
Epoch: 23 cost time: 37.2494478225708
Epoch: 23, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.779 Vali Acc: 0.978 Test Loss: 0.779 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.2930862
	speed: 0.2707s/iter; left time: 8581.0464s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0971s/iter; left time: 3069.2038s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 2892.2834s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 2542.6457s
Epoch: 24 cost time: 37.65907835960388
Epoch: 24, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.670 Vali Acc: 0.978 Test Loss: 0.670 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2878s/iter; left time: 9004.4818s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0794s/iter; left time: 2476.4491s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 2429.8371s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0884s/iter; left time: 2738.6320s
Epoch: 25 cost time: 35.61128497123718
Epoch: 25, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.484 Vali Acc: 0.982 Test Loss: 0.484 Test Acc: 0.982
Validation loss decreased (-0.981808 --> -0.982260).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2863s/iter; left time: 8838.9205s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0943s/iter; left time: 2901.5313s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0975s/iter; left time: 2992.2602s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0905s/iter; left time: 2768.2990s
Epoch: 26 cost time: 38.782543420791626
Epoch: 26, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.365 Vali Acc: 0.986 Test Loss: 0.365 Test Acc: 0.986
Validation loss decreased (-0.982260 --> -0.985899).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000078
	speed: 0.2680s/iter; left time: 8165.2325s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0876s/iter; left time: 2660.4787s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0842s/iter; left time: 2546.9063s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0968s/iter; left time: 2919.4066s
Epoch: 27 cost time: 38.26657843589783
Epoch: 27, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.646 Vali Acc: 0.980 Test Loss: 0.646 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2545s/iter; left time: 7647.1976s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0905s/iter; left time: 2711.6369s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0904s/iter; left time: 2699.1803s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 2660.7469s
Epoch: 28 cost time: 36.270371437072754
Epoch: 28, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.668 Vali Acc: 0.977 Test Loss: 0.668 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2838s/iter; left time: 8410.6822s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 2571.1950s
	iters: 300, epoch: 29 | loss: 0.4853573
	speed: 0.0915s/iter; left time: 2692.3086s
	iters: 400, epoch: 29 | loss: 1.2827604
	speed: 0.0825s/iter; left time: 2420.0652s
Epoch: 29 cost time: 36.53670001029968
Epoch: 29, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.625 Vali Acc: 0.979 Test Loss: 0.625 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2644s/iter; left time: 7727.3774s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0799s/iter; left time: 2327.9816s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0831s/iter; left time: 2412.2169s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 2535.4490s
Epoch: 30 cost time: 35.97031378746033
Epoch: 30, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.563 Vali Acc: 0.978 Test Loss: 0.563 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2463s/iter; left time: 7097.4448s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0804s/iter; left time: 2307.1377s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0910s/iter; left time: 2603.5570s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.1009s/iter; left time: 2875.7498s
Epoch: 31 cost time: 36.44558763504028
Epoch: 31, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.484 Vali Acc: 0.978 Test Loss: 0.484 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2766s/iter; left time: 7856.2901s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.1010s/iter; left time: 2859.4971s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0975s/iter; left time: 2748.4148s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 2151.7369s
Epoch: 32 cost time: 37.537455797195435
Epoch: 32, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.543 Vali Acc: 0.984 Test Loss: 0.543 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2650s/iter; left time: 7416.1431s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 2160.9610s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 2394.8362s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 2474.9589s
Epoch: 33 cost time: 35.96124529838562
Epoch: 33, Steps: 413 | Train Loss: 0.077 Vali Loss: 1.256 Vali Acc: 0.974 Test Loss: 1.256 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2588s/iter; left time: 7136.5062s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 2387.1449s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0826s/iter; left time: 2261.1839s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 2154.1132s
Epoch: 34 cost time: 35.25455141067505
Epoch: 34, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.769 Vali Acc: 0.974 Test Loss: 0.769 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2786s/iter; left time: 7565.2772s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 2378.5169s
	iters: 300, epoch: 35 | loss: 0.0000010
	speed: 0.0771s/iter; left time: 2079.5814s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0865s/iter; left time: 2322.2557s
Epoch: 35 cost time: 35.500656604766846
Epoch: 35, Steps: 413 | Train Loss: 0.074 Vali Loss: 1.217 Vali Acc: 0.974 Test Loss: 1.217 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2689s/iter; left time: 7190.8674s
	iters: 200, epoch: 36 | loss: 2.5778534
	speed: 0.0789s/iter; left time: 2101.1899s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0871s/iter; left time: 2311.7437s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 2254.7281s
Epoch: 36 cost time: 35.22973132133484
Epoch: 36, Steps: 413 | Train Loss: 0.108 Vali Loss: 1.500 Vali Acc: 0.971 Test Loss: 1.500 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 5776018
model size : 31.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3655299
	speed: 0.1145s/iter; left time: 4716.6027s
	iters: 200, epoch: 1 | loss: 0.0821145
	speed: 0.0799s/iter; left time: 3285.2479s
	iters: 300, epoch: 1 | loss: 0.0505594
	speed: 0.0978s/iter; left time: 4009.1204s
	iters: 400, epoch: 1 | loss: 0.0660855
	speed: 0.1007s/iter; left time: 4118.9016s
Epoch: 1 cost time: 40.70582342147827
Epoch: 1, Steps: 413 | Train Loss: 0.302 Vali Loss: 0.105 Vali Acc: 0.966 Test Loss: 0.105 Test Acc: 0.966
Validation loss decreased (inf --> -0.965893).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0938842
	speed: 0.2772s/iter; left time: 11306.2850s
	iters: 200, epoch: 2 | loss: 0.0041823
	speed: 0.0997s/iter; left time: 4055.4987s
	iters: 300, epoch: 2 | loss: 0.0001272
	speed: 0.0842s/iter; left time: 3418.9468s
	iters: 400, epoch: 2 | loss: 0.0002898
	speed: 0.0822s/iter; left time: 3328.6270s
Epoch: 2 cost time: 37.79676151275635
Epoch: 2, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
Validation loss decreased (-0.965893 --> -0.966802).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0087762
	speed: 0.2531s/iter; left time: 10217.3631s
	iters: 200, epoch: 3 | loss: 0.0103742
	speed: 0.0890s/iter; left time: 3583.3252s
	iters: 300, epoch: 3 | loss: 0.2430474
	speed: 0.0921s/iter; left time: 3699.0398s
	iters: 400, epoch: 3 | loss: 0.0974206
	speed: 0.0898s/iter; left time: 3596.9707s
Epoch: 3 cost time: 36.79286527633667
Epoch: 3, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.432 Vali Acc: 0.938 Test Loss: 0.432 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0026082
	speed: 0.2637s/iter; left time: 10539.5481s
	iters: 200, epoch: 4 | loss: 0.0000048
	speed: 0.0972s/iter; left time: 3873.9814s
	iters: 300, epoch: 4 | loss: 0.0012533
	speed: 0.0813s/iter; left time: 3231.3178s
	iters: 400, epoch: 4 | loss: 0.4111304
	speed: 0.0782s/iter; left time: 3102.6390s
Epoch: 4 cost time: 36.79634666442871
Epoch: 4, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.270 Vali Acc: 0.957 Test Loss: 0.270 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0001788
	speed: 0.2882s/iter; left time: 11397.8690s
	iters: 200, epoch: 5 | loss: 0.0000050
	speed: 0.0854s/iter; left time: 3370.8636s
	iters: 300, epoch: 5 | loss: 0.0000086
	speed: 0.0824s/iter; left time: 3240.6243s
	iters: 400, epoch: 5 | loss: 0.0348964
	speed: 0.0902s/iter; left time: 3539.9736s
Epoch: 5 cost time: 36.34990906715393
Epoch: 5, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.163 Vali Acc: 0.974 Test Loss: 0.163 Test Acc: 0.974
Validation loss decreased (-0.966802 --> -0.973623).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2638s/iter; left time: 10324.5876s
	iters: 200, epoch: 6 | loss: 0.0000026
	speed: 0.0951s/iter; left time: 3712.0553s
	iters: 300, epoch: 6 | loss: 0.0000001
	speed: 0.0932s/iter; left time: 3629.5347s
	iters: 400, epoch: 6 | loss: 0.1902001
	speed: 0.0841s/iter; left time: 3264.5900s
Epoch: 6 cost time: 37.13670611381531
Epoch: 6, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.973623 --> -0.975441).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000016
	speed: 0.2694s/iter; left time: 10432.2056s
	iters: 200, epoch: 7 | loss: 0.0000005
	speed: 0.0848s/iter; left time: 3276.2683s
	iters: 300, epoch: 7 | loss: 0.0000021
	speed: 0.0934s/iter; left time: 3598.3122s
	iters: 400, epoch: 7 | loss: 0.0570334
	speed: 0.0990s/iter; left time: 3803.5821s
Epoch: 7 cost time: 38.494099140167236
Epoch: 7, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.273 Vali Acc: 0.978 Test Loss: 0.273 Test Acc: 0.978
Validation loss decreased (-0.975441 --> -0.977714).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2760s/iter; left time: 10573.6837s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0934s/iter; left time: 3567.0556s
	iters: 300, epoch: 8 | loss: 0.2540994
	speed: 0.0810s/iter; left time: 3086.6436s
	iters: 400, epoch: 8 | loss: 1.1611322
	speed: 0.0870s/iter; left time: 3305.4211s
Epoch: 8 cost time: 36.79615664482117
Epoch: 8, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.640 Vali Acc: 0.961 Test Loss: 0.640 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000916
	speed: 0.2702s/iter; left time: 10241.3056s
	iters: 200, epoch: 9 | loss: 0.0002219
	speed: 0.0895s/iter; left time: 3382.7428s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0884s/iter; left time: 3332.5336s
	iters: 400, epoch: 9 | loss: 0.0063792
	speed: 0.0828s/iter; left time: 3113.7620s
Epoch: 9 cost time: 36.04162335395813
Epoch: 9, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.265 Vali Acc: 0.976 Test Loss: 0.265 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2482s/iter; left time: 9304.0514s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 3287.1715s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0839s/iter; left time: 3128.5833s
	iters: 400, epoch: 10 | loss: 0.0000090
	speed: 0.0919s/iter; left time: 3417.3808s
Epoch: 10 cost time: 36.220399379730225
Epoch: 10, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.191 Vali Acc: 0.980 Test Loss: 0.191 Test Acc: 0.980
Validation loss decreased (-0.977714 --> -0.980444).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0418518
	speed: 0.2660s/iter; left time: 9862.3955s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0968s/iter; left time: 3577.2229s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0847s/iter; left time: 3124.0540s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0878s/iter; left time: 3230.1194s
Epoch: 11 cost time: 37.949151277542114
Epoch: 11, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.669 Vali Acc: 0.965 Test Loss: 0.669 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000015
	speed: 0.2817s/iter; left time: 10325.3031s
	iters: 200, epoch: 12 | loss: 0.0001708
	speed: 0.0916s/iter; left time: 3348.9445s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0938s/iter; left time: 3419.0740s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 3153.7727s
Epoch: 12 cost time: 37.644898891448975
Epoch: 12, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.366 Vali Acc: 0.975 Test Loss: 0.366 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0157371
	speed: 0.2545s/iter; left time: 9224.7165s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0875s/iter; left time: 3163.1807s
	iters: 300, epoch: 13 | loss: 0.0007095
	speed: 0.0914s/iter; left time: 3294.1505s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0857s/iter; left time: 3081.6947s
Epoch: 13 cost time: 36.75217795372009
Epoch: 13, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.638 Vali Acc: 0.960 Test Loss: 0.638 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.4614782
	speed: 0.2576s/iter; left time: 9230.5486s
	iters: 200, epoch: 14 | loss: 0.3062086
	speed: 0.0859s/iter; left time: 3070.5071s
	iters: 300, epoch: 14 | loss: 0.0000004
	speed: 0.0848s/iter; left time: 3022.0303s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0947s/iter; left time: 3365.7741s
Epoch: 14 cost time: 36.941712379455566
Epoch: 14, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.507 Vali Acc: 0.963 Test Loss: 0.507 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0796718
	speed: 0.2798s/iter; left time: 9908.4855s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0945s/iter; left time: 3337.2140s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0850s/iter; left time: 2994.8958s
	iters: 400, epoch: 15 | loss: 0.0000165
	speed: 0.0853s/iter; left time: 2995.0122s
Epoch: 15 cost time: 36.6613826751709
Epoch: 15, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.508 Vali Acc: 0.974 Test Loss: 0.508 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2597s/iter; left time: 9091.8161s
	iters: 200, epoch: 16 | loss: 0.0835249
	speed: 0.0878s/iter; left time: 3065.6059s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0963s/iter; left time: 3351.9079s
	iters: 400, epoch: 16 | loss: 0.0002872
	speed: 0.0920s/iter; left time: 3192.8003s
Epoch: 16 cost time: 37.88649559020996
Epoch: 16, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.440 Vali Acc: 0.976 Test Loss: 0.440 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2630s/iter; left time: 9096.5012s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0885s/iter; left time: 3054.1962s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0954s/iter; left time: 3281.9479s
	iters: 400, epoch: 17 | loss: 0.2766240
	speed: 0.0926s/iter; left time: 3175.1460s
Epoch: 17 cost time: 38.64452075958252
Epoch: 17, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.624 Vali Acc: 0.966 Test Loss: 0.624 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2879s/iter; left time: 9840.7660s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0843s/iter; left time: 2871.5945s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0836s/iter; left time: 2839.7410s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0895s/iter; left time: 3033.4822s
Epoch: 18 cost time: 36.73500442504883
Epoch: 18, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.251 Vali Acc: 0.983 Test Loss: 0.251 Test Acc: 0.983
Validation loss decreased (-0.980444 --> -0.982717).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.2544s/iter; left time: 8589.1048s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0901s/iter; left time: 3032.7558s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0896s/iter; left time: 3007.7235s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0882s/iter; left time: 2952.8823s
Epoch: 19 cost time: 37.02906537055969
Epoch: 19, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.429 Vali Acc: 0.970 Test Loss: 0.429 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1312993
	speed: 0.2566s/iter; left time: 8558.3209s
	iters: 200, epoch: 20 | loss: 2.3900590
	speed: 0.0852s/iter; left time: 2832.9333s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 2875.4383s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0949s/iter; left time: 3136.7509s
Epoch: 20 cost time: 37.05677676200867
Epoch: 20, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.637 Vali Acc: 0.970 Test Loss: 0.637 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0002628
	speed: 0.2813s/iter; left time: 9267.3747s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0899s/iter; left time: 2953.5084s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0888s/iter; left time: 2906.2471s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 3008.3291s
Epoch: 21 cost time: 37.60615801811218
Epoch: 21, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.654 Vali Acc: 0.975 Test Loss: 0.654 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2663s/iter; left time: 8663.8204s
	iters: 200, epoch: 22 | loss: 0.0001008
	speed: 0.0918s/iter; left time: 2977.4513s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0915s/iter; left time: 2958.2876s
	iters: 400, epoch: 22 | loss: 0.0223963
	speed: 0.0847s/iter; left time: 2729.6556s
Epoch: 22 cost time: 37.54780721664429
Epoch: 22, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.690 Vali Acc: 0.965 Test Loss: 0.690 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2654s/iter; left time: 8522.8702s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 2938.2328s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0927s/iter; left time: 2958.5973s
	iters: 400, epoch: 23 | loss: 0.0988287
	speed: 0.0840s/iter; left time: 2674.0164s
Epoch: 23 cost time: 37.631229400634766
Epoch: 23, Steps: 413 | Train Loss: 0.049 Vali Loss: 1.541 Vali Acc: 0.945 Test Loss: 1.541 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2810s/iter; left time: 8909.2752s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0823s/iter; left time: 2600.7202s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0854s/iter; left time: 2690.9010s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0897s/iter; left time: 2815.5128s
Epoch: 24 cost time: 36.29036355018616
Epoch: 24, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.438 Vali Acc: 0.975 Test Loss: 0.438 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2649s/iter; left time: 8289.9792s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 2708.7521s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 2680.5148s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 2685.9925s
Epoch: 25 cost time: 36.21826720237732
Epoch: 25, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.599 Vali Acc: 0.977 Test Loss: 0.599 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.2577s/iter; left time: 7956.3572s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0891s/iter; left time: 2741.3537s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 2802.2146s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0902s/iter; left time: 2758.8236s
Epoch: 26 cost time: 37.44283437728882
Epoch: 26, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.567 Vali Acc: 0.978 Test Loss: 0.567 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000014
	speed: 0.2830s/iter; left time: 8620.4302s
	iters: 200, epoch: 27 | loss: 0.6833388
	speed: 0.0931s/iter; left time: 2825.7357s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0932s/iter; left time: 2819.6099s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0876s/iter; left time: 2642.2677s
Epoch: 27 cost time: 38.20369529724121
Epoch: 27, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.450 Vali Acc: 0.975 Test Loss: 0.450 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000735
	speed: 0.2772s/iter; left time: 8330.3988s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.1134s/iter; left time: 3396.2340s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.1071s/iter; left time: 3198.0026s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 1584.7870s
Epoch: 28 cost time: 37.5442898273468
Epoch: 28, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.570 Vali Acc: 0.976 Test Loss: 0.570 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 3678866
model size : 23.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3585703
	speed: 0.1039s/iter; left time: 4279.6995s
	iters: 200, epoch: 1 | loss: 0.0404826
	speed: 0.0825s/iter; left time: 3391.0722s
	iters: 300, epoch: 1 | loss: 0.0698478
	speed: 0.0834s/iter; left time: 3420.8559s
	iters: 400, epoch: 1 | loss: 0.0829898
	speed: 0.0816s/iter; left time: 3338.4082s
Epoch: 1 cost time: 36.336997747421265
Epoch: 1, Steps: 413 | Train Loss: 0.294 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0220355
	speed: 0.2447s/iter; left time: 9979.7425s
	iters: 200, epoch: 2 | loss: 0.0458761
	speed: 0.0839s/iter; left time: 3411.7103s
	iters: 300, epoch: 2 | loss: 0.0000024
	speed: 0.0793s/iter; left time: 3217.1722s
	iters: 400, epoch: 2 | loss: 0.3240957
	speed: 0.0835s/iter; left time: 3379.0695s
Epoch: 2 cost time: 34.500202655792236
Epoch: 2, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.957252 --> -0.980900).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2187298
	speed: 0.2701s/iter; left time: 10906.6628s
	iters: 200, epoch: 3 | loss: 0.0204313
	speed: 0.0775s/iter; left time: 3123.2043s
	iters: 300, epoch: 3 | loss: 0.0000345
	speed: 0.0802s/iter; left time: 3220.5077s
	iters: 400, epoch: 3 | loss: 0.0003325
	speed: 0.0863s/iter; left time: 3457.6331s
Epoch: 3 cost time: 33.77237892150879
Epoch: 3, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000420
	speed: 0.2493s/iter; left time: 9964.0348s
	iters: 200, epoch: 4 | loss: 0.0001804
	speed: 0.0833s/iter; left time: 3319.1604s
	iters: 300, epoch: 4 | loss: 0.0000263
	speed: 0.0836s/iter; left time: 3325.5177s
	iters: 400, epoch: 4 | loss: 0.0001289
	speed: 0.0781s/iter; left time: 3098.7424s
Epoch: 4 cost time: 34.42958664894104
Epoch: 4, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.262 Vali Acc: 0.967 Test Loss: 0.262 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0352967
	speed: 0.2394s/iter; left time: 9466.3106s
	iters: 200, epoch: 5 | loss: 0.0000001
	speed: 0.0838s/iter; left time: 3306.4214s
	iters: 300, epoch: 5 | loss: 0.0000003
	speed: 0.0864s/iter; left time: 3398.0329s
	iters: 400, epoch: 5 | loss: 0.0316977
	speed: 0.0844s/iter; left time: 3314.0000s
Epoch: 5 cost time: 35.30511212348938
Epoch: 5, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.267 Vali Acc: 0.965 Test Loss: 0.267 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0013627
	speed: 0.2562s/iter; left time: 10026.6911s
	iters: 200, epoch: 6 | loss: 0.0003783
	speed: 0.0811s/iter; left time: 3163.9871s
	iters: 300, epoch: 6 | loss: 0.0075024
	speed: 0.0761s/iter; left time: 2961.6277s
	iters: 400, epoch: 6 | loss: 0.0493838
	speed: 0.0795s/iter; left time: 3085.9112s
Epoch: 6 cost time: 33.36172151565552
Epoch: 6, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.280 Vali Acc: 0.968 Test Loss: 0.280 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2999815
	speed: 0.2686s/iter; left time: 10400.8446s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 3092.8461s
	iters: 300, epoch: 7 | loss: 0.1715658
	speed: 0.0830s/iter; left time: 3197.2595s
	iters: 400, epoch: 7 | loss: 0.0495310
	speed: 0.0845s/iter; left time: 3245.4467s
Epoch: 7 cost time: 34.0855348110199
Epoch: 7, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.357 Vali Acc: 0.964 Test Loss: 0.357 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0585754
	speed: 0.2598s/iter; left time: 9953.8276s
	iters: 200, epoch: 8 | loss: 0.0193858
	speed: 0.0872s/iter; left time: 3332.1213s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 3204.8482s
	iters: 400, epoch: 8 | loss: 1.4023956
	speed: 0.0803s/iter; left time: 3051.0144s
Epoch: 8 cost time: 35.44414925575256
Epoch: 8, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2536s/iter; left time: 9608.8540s
	iters: 200, epoch: 9 | loss: 0.0002273
	speed: 0.0860s/iter; left time: 3250.7435s
	iters: 300, epoch: 9 | loss: 0.4342944
	speed: 0.0869s/iter; left time: 3277.3825s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 3160.8669s
Epoch: 9 cost time: 36.1747190952301
Epoch: 9, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.190 Vali Acc: 0.983 Test Loss: 0.190 Test Acc: 0.983
Validation loss decreased (-0.980900 --> -0.983172).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2769s/iter; left time: 10379.9118s
	iters: 200, epoch: 10 | loss: 0.0004677
	speed: 0.0819s/iter; left time: 3063.3838s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0852s/iter; left time: 3178.2161s
	iters: 400, epoch: 10 | loss: 0.0000051
	speed: 0.0842s/iter; left time: 3132.7153s
Epoch: 10 cost time: 35.603652238845825
Epoch: 10, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.217 Vali Acc: 0.983 Test Loss: 0.217 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000020
	speed: 0.2538s/iter; left time: 9407.7542s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0809s/iter; left time: 2992.0990s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0823s/iter; left time: 3033.8467s
	iters: 400, epoch: 11 | loss: 0.0000751
	speed: 0.0822s/iter; left time: 3021.2109s
Epoch: 11 cost time: 34.64628291130066
Epoch: 11, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.482 Vali Acc: 0.970 Test Loss: 0.482 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2434s/iter; left time: 8922.6995s
	iters: 200, epoch: 12 | loss: 0.0001642
	speed: 0.0849s/iter; left time: 3103.9060s
	iters: 300, epoch: 12 | loss: 0.3252886
	speed: 0.0812s/iter; left time: 2960.4914s
	iters: 400, epoch: 12 | loss: 0.0000006
	speed: 0.0818s/iter; left time: 2972.8194s
Epoch: 12 cost time: 34.141234159469604
Epoch: 12, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.327 Vali Acc: 0.980 Test Loss: 0.327 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000044
	speed: 0.2628s/iter; left time: 9525.0380s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 2883.3091s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0793s/iter; left time: 2859.6402s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0808s/iter; left time: 2905.9456s
Epoch: 13 cost time: 33.97425389289856
Epoch: 13, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.666 Vali Acc: 0.963 Test Loss: 0.666 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2471s/iter; left time: 8854.9068s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 2915.8409s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0828s/iter; left time: 2951.0849s
	iters: 400, epoch: 14 | loss: 0.1732266
	speed: 0.0856s/iter; left time: 3043.1371s
Epoch: 14 cost time: 35.06679105758667
Epoch: 14, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.350 Vali Acc: 0.980 Test Loss: 0.350 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.0610957
	speed: 0.2415s/iter; left time: 8553.6788s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 2989.0126s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0849s/iter; left time: 2990.0514s
	iters: 400, epoch: 15 | loss: 0.0000008
	speed: 0.0870s/iter; left time: 3056.1873s
Epoch: 15 cost time: 35.40343761444092
Epoch: 15, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.280 Vali Acc: 0.977 Test Loss: 0.280 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0004582
	speed: 0.2596s/iter; left time: 9087.5470s
	iters: 200, epoch: 16 | loss: 0.0001133
	speed: 0.0852s/iter; left time: 2972.8734s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2684.5609s
	iters: 400, epoch: 16 | loss: 0.1248683
	speed: 0.0756s/iter; left time: 2624.5485s
Epoch: 16 cost time: 33.60582733154297
Epoch: 16, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.424 Vali Acc: 0.975 Test Loss: 0.424 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000291
	speed: 0.2557s/iter; left time: 8844.4091s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 2851.0726s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0808s/iter; left time: 2780.4226s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0826s/iter; left time: 2832.4646s
Epoch: 17 cost time: 34.46926188468933
Epoch: 17, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.317 Vali Acc: 0.983 Test Loss: 0.317 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2374s/iter; left time: 8114.0608s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0806s/iter; left time: 2746.5531s
	iters: 300, epoch: 18 | loss: 0.2060644
	speed: 0.0833s/iter; left time: 2831.8763s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0797s/iter; left time: 2699.8526s
Epoch: 18 cost time: 33.79040861129761
Epoch: 18, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.236 Vali Acc: 0.982 Test Loss: 0.236 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000164
	speed: 0.2701s/iter; left time: 9121.8396s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 2579.9084s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 2710.3482s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0829s/iter; left time: 2772.7412s
Epoch: 19 cost time: 33.794294595718384
Epoch: 19, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.456 Vali Acc: 0.972 Test Loss: 0.456 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 3678866
model size : 23.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3579268
	speed: 0.1013s/iter; left time: 4172.1588s
	iters: 200, epoch: 1 | loss: 0.0217464
	speed: 0.0784s/iter; left time: 3223.4985s
	iters: 300, epoch: 1 | loss: 0.0049239
	speed: 0.0762s/iter; left time: 3124.1089s
	iters: 400, epoch: 1 | loss: 0.0752161
	speed: 0.0799s/iter; left time: 3266.5051s
Epoch: 1 cost time: 34.784205198287964
Epoch: 1, Steps: 413 | Train Loss: 0.293 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
Validation loss decreased (inf --> -0.958616).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0233705
	speed: 0.2431s/iter; left time: 9915.0915s
	iters: 200, epoch: 2 | loss: 0.1733229
	speed: 0.0803s/iter; left time: 3267.0261s
	iters: 300, epoch: 2 | loss: 0.0007536
	speed: 0.0740s/iter; left time: 3003.9290s
	iters: 400, epoch: 2 | loss: 0.0001264
	speed: 0.0821s/iter; left time: 3322.6612s
Epoch: 2 cost time: 33.43537735939026
Epoch: 2, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
Validation loss decreased (-0.958616 --> -0.969530).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0001785
	speed: 0.2559s/iter; left time: 10331.5128s
	iters: 200, epoch: 3 | loss: 0.1264745
	speed: 0.0798s/iter; left time: 3215.8952s
	iters: 300, epoch: 3 | loss: 0.0356061
	speed: 0.0790s/iter; left time: 3175.5975s
	iters: 400, epoch: 3 | loss: 0.0003982
	speed: 0.0758s/iter; left time: 3037.1627s
Epoch: 3 cost time: 32.22713589668274
Epoch: 3, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.191 Vali Acc: 0.965 Test Loss: 0.191 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0019609
	speed: 0.2425s/iter; left time: 9690.0584s
	iters: 200, epoch: 4 | loss: 0.0000314
	speed: 0.0761s/iter; left time: 3034.7226s
	iters: 300, epoch: 4 | loss: 0.2597933
	speed: 0.0783s/iter; left time: 3113.9463s
	iters: 400, epoch: 4 | loss: 0.0020829
	speed: 0.0798s/iter; left time: 3166.5283s
Epoch: 4 cost time: 32.81568360328674
Epoch: 4, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
Validation loss decreased (-0.969530 --> -0.971804).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0005112
	speed: 0.2366s/iter; left time: 9357.2160s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0813s/iter; left time: 3206.8645s
	iters: 300, epoch: 5 | loss: 0.0000004
	speed: 0.0793s/iter; left time: 3120.4366s
	iters: 400, epoch: 5 | loss: 0.0001665
	speed: 0.0757s/iter; left time: 2969.3568s
Epoch: 5 cost time: 32.82571458816528
Epoch: 5, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.189 Vali Acc: 0.976 Test Loss: 0.189 Test Acc: 0.976
Validation loss decreased (-0.971804 --> -0.976351).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0640351
	speed: 0.2648s/iter; left time: 10364.3244s
	iters: 200, epoch: 6 | loss: 0.1005232
	speed: 0.0756s/iter; left time: 2950.1972s
	iters: 300, epoch: 6 | loss: 0.0018647
	speed: 0.0850s/iter; left time: 3308.0664s
	iters: 400, epoch: 6 | loss: 0.0059545
	speed: 0.0806s/iter; left time: 3128.3424s
Epoch: 6 cost time: 33.794147968292236
Epoch: 6, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.548 Vali Acc: 0.953 Test Loss: 0.548 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2243723
	speed: 0.2567s/iter; left time: 9940.4065s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0761s/iter; left time: 2937.8996s
	iters: 300, epoch: 7 | loss: 0.3327019
	speed: 0.0791s/iter; left time: 3046.2692s
	iters: 400, epoch: 7 | loss: 0.0421396
	speed: 0.0834s/iter; left time: 3203.3956s
Epoch: 7 cost time: 33.5249400138855
Epoch: 7, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.290 Vali Acc: 0.974 Test Loss: 0.290 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3611786
	speed: 0.2357s/iter; left time: 9028.6243s
	iters: 200, epoch: 8 | loss: 0.0001135
	speed: 0.0821s/iter; left time: 3136.0640s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 2981.6280s
	iters: 400, epoch: 8 | loss: 0.5498748
	speed: 0.0783s/iter; left time: 2976.4030s
Epoch: 8 cost time: 33.0889732837677
Epoch: 8, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.522 Vali Acc: 0.956 Test Loss: 0.522 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0001263
	speed: 0.2417s/iter; left time: 9158.2033s
	iters: 200, epoch: 9 | loss: 0.0000026
	speed: 0.0788s/iter; left time: 2977.4572s
	iters: 300, epoch: 9 | loss: 0.0002106
	speed: 0.0780s/iter; left time: 2938.8936s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 2880.7192s
Epoch: 9 cost time: 32.43852138519287
Epoch: 9, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.492 Vali Acc: 0.964 Test Loss: 0.492 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000093
	speed: 0.2604s/iter; left time: 9761.6229s
	iters: 200, epoch: 10 | loss: 0.2525041
	speed: 0.0754s/iter; left time: 2818.6262s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0818s/iter; left time: 3050.3973s
	iters: 400, epoch: 10 | loss: 0.0077820
	speed: 0.0771s/iter; left time: 2867.7230s
Epoch: 10 cost time: 33.027771949768066
Epoch: 10, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.427 Vali Acc: 0.970 Test Loss: 0.427 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000012
	speed: 0.2380s/iter; left time: 8822.9373s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0822s/iter; left time: 3038.4138s
	iters: 300, epoch: 11 | loss: 0.0000015
	speed: 0.0804s/iter; left time: 2966.0473s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0812s/iter; left time: 2985.5649s
Epoch: 11 cost time: 34.18723177909851
Epoch: 11, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.358 Vali Acc: 0.977 Test Loss: 0.358 Test Acc: 0.977
Validation loss decreased (-0.976351 --> -0.976804).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000931
	speed: 0.2297s/iter; left time: 8421.2317s
	iters: 200, epoch: 12 | loss: 0.4329588
	speed: 0.0821s/iter; left time: 3002.9612s
	iters: 300, epoch: 12 | loss: 0.5945879
	speed: 0.0824s/iter; left time: 3005.0931s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0914s/iter; left time: 3322.3203s
Epoch: 12 cost time: 34.58891677856445
Epoch: 12, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.366 Vali Acc: 0.971 Test Loss: 0.366 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.2476s/iter; left time: 8975.4340s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0793s/iter; left time: 2865.7582s
	iters: 300, epoch: 13 | loss: 1.1759989
	speed: 0.0774s/iter; left time: 2788.1098s
	iters: 400, epoch: 13 | loss: 0.0000004
	speed: 0.0774s/iter; left time: 2782.1521s
Epoch: 13 cost time: 32.65368628501892
Epoch: 13, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.399 Vali Acc: 0.979 Test Loss: 0.399 Test Acc: 0.979
Validation loss decreased (-0.976804 --> -0.978623).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000016
	speed: 0.2334s/iter; left time: 8364.8151s
	iters: 200, epoch: 14 | loss: 0.2767968
	speed: 0.0768s/iter; left time: 2746.0017s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0794s/iter; left time: 2830.5153s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 2835.6275s
Epoch: 14 cost time: 33.219191789627075
Epoch: 14, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.404 Vali Acc: 0.973 Test Loss: 0.404 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2361s/iter; left time: 8361.1949s
	iters: 200, epoch: 15 | loss: 0.0000022
	speed: 0.0734s/iter; left time: 2593.5063s
	iters: 300, epoch: 15 | loss: 0.0000019
	speed: 0.0772s/iter; left time: 2719.7401s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0776s/iter; left time: 2724.5243s
Epoch: 15 cost time: 32.168737173080444
Epoch: 15, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.493 Vali Acc: 0.972 Test Loss: 0.493 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.2469s/iter; left time: 8642.5396s
	iters: 200, epoch: 16 | loss: 2.3488879
	speed: 0.0743s/iter; left time: 2594.2341s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0787s/iter; left time: 2737.7752s
	iters: 400, epoch: 16 | loss: 0.0134636
	speed: 0.0829s/iter; left time: 2878.6374s
Epoch: 16 cost time: 32.522316694259644
Epoch: 16, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.572 Vali Acc: 0.959 Test Loss: 0.572 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0059032
	speed: 0.2725s/iter; left time: 9425.4787s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1644.8479s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0483s/iter; left time: 1662.3339s
	iters: 400, epoch: 17 | loss: 0.0315154
	speed: 0.0471s/iter; left time: 1613.8277s
Epoch: 17 cost time: 25.33393096923828
Epoch: 17, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.372 Vali Acc: 0.978 Test Loss: 0.372 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2196s/iter; left time: 7506.8903s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0815s/iter; left time: 2778.3370s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 2702.9699s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0780s/iter; left time: 2641.0938s
Epoch: 18 cost time: 33.31328248977661
Epoch: 18, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.408 Vali Acc: 0.976 Test Loss: 0.408 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2284s/iter; left time: 7713.6353s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 2657.0567s
	iters: 300, epoch: 19 | loss: 0.0000017
	speed: 0.0763s/iter; left time: 2562.3701s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 2648.2880s
Epoch: 19 cost time: 32.456183433532715
Epoch: 19, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.371 Vali Acc: 0.981 Test Loss: 0.371 Test Acc: 0.981
Validation loss decreased (-0.978623 --> -0.980897).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0282570
	speed: 0.2479s/iter; left time: 8267.2094s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 2357.0068s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0826s/iter; left time: 2739.7723s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0764s/iter; left time: 2525.3694s
Epoch: 20 cost time: 31.925307273864746
Epoch: 20, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.516 Vali Acc: 0.972 Test Loss: 0.516 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2547s/iter; left time: 8390.4691s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 2617.1911s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 2531.0616s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 2603.3100s
Epoch: 21 cost time: 33.167450189590454
Epoch: 21, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.449 Vali Acc: 0.969 Test Loss: 0.449 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2296s/iter; left time: 7468.3872s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 2661.9263s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0800s/iter; left time: 2586.1910s
	iters: 400, epoch: 22 | loss: 0.0000183
	speed: 0.0826s/iter; left time: 2661.6459s
Epoch: 22 cost time: 33.85783052444458
Epoch: 22, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.482 Vali Acc: 0.975 Test Loss: 0.482 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2358s/iter; left time: 7572.6830s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0835s/iter; left time: 2674.3546s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0861s/iter; left time: 2746.5741s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 2511.1494s
Epoch: 23 cost time: 34.398930072784424
Epoch: 23, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.577 Vali Acc: 0.969 Test Loss: 0.577 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000985
	speed: 0.2524s/iter; left time: 8002.0663s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0698s/iter; left time: 2206.4499s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 2515.0442s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 2465.0381s
Epoch: 24 cost time: 32.50033092498779
Epoch: 24, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.425 Vali Acc: 0.977 Test Loss: 0.425 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2304s/iter; left time: 7208.7842s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 2485.3215s
	iters: 300, epoch: 25 | loss: 0.1128334
	speed: 0.0799s/iter; left time: 2483.5462s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0806s/iter; left time: 2496.3733s
Epoch: 25 cost time: 33.283297300338745
Epoch: 25, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.218 Vali Acc: 0.986 Test Loss: 0.218 Test Acc: 0.986
Validation loss decreased (-0.980897 --> -0.985901).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2376s/iter; left time: 7337.2350s
	iters: 200, epoch: 26 | loss: 0.0188323
	speed: 0.0821s/iter; left time: 2525.7602s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 2388.5562s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0783s/iter; left time: 2392.8635s
Epoch: 26 cost time: 32.66121959686279
Epoch: 26, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.350 Vali Acc: 0.983 Test Loss: 0.350 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2416s/iter; left time: 7359.7599s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 2400.4817s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2324.9235s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 2387.0123s
Epoch: 27 cost time: 32.796751976013184
Epoch: 27, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.588 Vali Acc: 0.977 Test Loss: 0.588 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0000002
	speed: 0.2255s/iter; left time: 6777.7741s
	iters: 200, epoch: 28 | loss: 0.0000003
	speed: 0.0796s/iter; left time: 2383.2510s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0829s/iter; left time: 2475.5145s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 2374.0305s
Epoch: 28 cost time: 33.616523027420044
Epoch: 28, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.445 Vali Acc: 0.976 Test Loss: 0.445 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2305s/iter; left time: 6832.4393s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0806s/iter; left time: 2382.0199s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 2034.4081s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 2348.9758s
Epoch: 29 cost time: 32.58874487876892
Epoch: 29, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.670 Vali Acc: 0.975 Test Loss: 0.670 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2407s/iter; left time: 7034.1152s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 2093.6713s
	iters: 300, epoch: 30 | loss: 0.0000005
	speed: 0.0772s/iter; left time: 2241.7061s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 2141.5279s
Epoch: 30 cost time: 30.504230976104736
Epoch: 30, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.843 Vali Acc: 0.977 Test Loss: 0.843 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2124s/iter; left time: 6119.3172s
	iters: 200, epoch: 31 | loss: 0.1514147
	speed: 0.0791s/iter; left time: 2270.8805s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 2228.8074s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 2202.7359s
Epoch: 31 cost time: 32.21559739112854
Epoch: 31, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.602 Vali Acc: 0.980 Test Loss: 0.602 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2255s/iter; left time: 6403.9268s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0764s/iter; left time: 2160.9253s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0757s/iter; left time: 2135.4724s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 2206.2988s
Epoch: 32 cost time: 32.20531964302063
Epoch: 32, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.450 Vali Acc: 0.982 Test Loss: 0.450 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2380s/iter; left time: 6660.8934s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 2160.6251s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0813s/iter; left time: 2258.6889s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0796s/iter; left time: 2204.6976s
Epoch: 33 cost time: 33.04208779335022
Epoch: 33, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.616 Vali Acc: 0.978 Test Loss: 0.616 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2457s/iter; left time: 6774.6806s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0813s/iter; left time: 2234.8363s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0800s/iter; left time: 2191.0898s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0787s/iter; left time: 2145.1351s
Epoch: 34 cost time: 32.70682215690613
Epoch: 34, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.503 Vali Acc: 0.981 Test Loss: 0.503 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0021393
	speed: 0.2232s/iter; left time: 6061.8779s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0772s/iter; left time: 2088.0443s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0772s/iter; left time: 2080.2812s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0806s/iter; left time: 2164.2120s
Epoch: 35 cost time: 32.352603912353516
Epoch: 35, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.699 Vali Acc: 0.971 Test Loss: 0.699 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 3678866
model size : 23.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3507287
	speed: 0.0920s/iter; left time: 3789.4246s
	iters: 200, epoch: 1 | loss: 0.0404685
	speed: 0.0666s/iter; left time: 2738.4597s
	iters: 300, epoch: 1 | loss: 0.0222727
	speed: 0.0753s/iter; left time: 3088.8259s
	iters: 400, epoch: 1 | loss: 0.0014883
	speed: 0.0715s/iter; left time: 2926.1176s
Epoch: 1 cost time: 31.621516227722168
Epoch: 1, Steps: 413 | Train Loss: 0.298 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (inf --> -0.967711).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1505598
	speed: 0.2487s/iter; left time: 10143.4177s
	iters: 200, epoch: 2 | loss: 0.0212682
	speed: 0.0758s/iter; left time: 3083.1121s
	iters: 300, epoch: 2 | loss: 0.0016789
	speed: 0.0777s/iter; left time: 3154.3524s
	iters: 400, epoch: 2 | loss: 0.0161743
	speed: 0.0740s/iter; left time: 2996.2882s
Epoch: 2 cost time: 31.771974325180054
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.967711 --> -0.969985).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000063
	speed: 0.2286s/iter; left time: 9229.8969s
	iters: 200, epoch: 3 | loss: 0.0018478
	speed: 0.0786s/iter; left time: 3165.0374s
	iters: 300, epoch: 3 | loss: 0.3558756
	speed: 0.0768s/iter; left time: 3084.0626s
	iters: 400, epoch: 3 | loss: 0.3897686
	speed: 0.0780s/iter; left time: 3125.9967s
Epoch: 3 cost time: 32.79935884475708
Epoch: 3, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4249013
	speed: 0.2230s/iter; left time: 8909.9700s
	iters: 200, epoch: 4 | loss: 0.2806549
	speed: 0.0804s/iter; left time: 3203.6131s
	iters: 300, epoch: 4 | loss: 0.0193748
	speed: 0.0783s/iter; left time: 3114.1126s
	iters: 400, epoch: 4 | loss: 0.1920255
	speed: 0.0733s/iter; left time: 2906.0719s
Epoch: 4 cost time: 32.37783098220825
Epoch: 4, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.230 Vali Acc: 0.970 Test Loss: 0.230 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2541801
	speed: 0.2388s/iter; left time: 9442.4711s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0720s/iter; left time: 2841.8305s
	iters: 300, epoch: 5 | loss: 0.0122470
	speed: 0.0748s/iter; left time: 2944.5337s
	iters: 400, epoch: 5 | loss: 0.4009529
	speed: 0.0750s/iter; left time: 2942.9032s
Epoch: 5 cost time: 30.723639965057373
Epoch: 5, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.221 Vali Acc: 0.978 Test Loss: 0.221 Test Acc: 0.978
Validation loss decreased (-0.969985 --> -0.977715).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0005066
	speed: 0.2319s/iter; left time: 9075.4573s
	iters: 200, epoch: 6 | loss: 0.0969755
	speed: 0.0767s/iter; left time: 2994.5662s
	iters: 300, epoch: 6 | loss: 0.0148404
	speed: 0.0745s/iter; left time: 2898.9121s
	iters: 400, epoch: 6 | loss: 0.3508239
	speed: 0.0719s/iter; left time: 2791.5656s
Epoch: 6 cost time: 31.31265616416931
Epoch: 6, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.284 Vali Acc: 0.973 Test Loss: 0.284 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4900820
	speed: 0.2174s/iter; left time: 8420.2116s
	iters: 200, epoch: 7 | loss: 0.0000002
	speed: 0.0721s/iter; left time: 2784.6394s
	iters: 300, epoch: 7 | loss: 0.0043196
	speed: 0.0795s/iter; left time: 3064.4152s
	iters: 400, epoch: 7 | loss: 0.0265340
	speed: 0.0783s/iter; left time: 3010.3861s
Epoch: 7 cost time: 31.763604640960693
Epoch: 7, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.387 Vali Acc: 0.969 Test Loss: 0.387 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000044
	speed: 0.2397s/iter; left time: 9182.0497s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 3117.5459s
	iters: 300, epoch: 8 | loss: 0.5831675
	speed: 0.0840s/iter; left time: 3200.4660s
	iters: 400, epoch: 8 | loss: 0.0145485
	speed: 0.0684s/iter; left time: 2601.4053s
Epoch: 8 cost time: 32.69280791282654
Epoch: 8, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.323 Vali Acc: 0.968 Test Loss: 0.323 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.7652002
	speed: 0.2339s/iter; left time: 8862.9640s
	iters: 200, epoch: 9 | loss: 0.0000013
	speed: 0.0786s/iter; left time: 2971.3297s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 2947.4567s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0793s/iter; left time: 2982.3939s
Epoch: 9 cost time: 32.97041964530945
Epoch: 9, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.491 Vali Acc: 0.965 Test Loss: 0.491 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2331s/iter; left time: 8737.2668s
	iters: 200, epoch: 10 | loss: 2.5602696
	speed: 0.0797s/iter; left time: 2980.6033s
	iters: 300, epoch: 10 | loss: 0.9259599
	speed: 0.0715s/iter; left time: 2665.2152s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 2898.4066s
Epoch: 10 cost time: 31.9746253490448
Epoch: 10, Steps: 413 | Train Loss: 0.170 Vali Loss: 0.442 Vali Acc: 0.975 Test Loss: 0.442 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0005590
	speed: 0.2405s/iter; left time: 8914.9315s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0800s/iter; left time: 2956.5666s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2831.5170s
	iters: 400, epoch: 11 | loss: 0.0121831
	speed: 0.0708s/iter; left time: 2604.2553s
Epoch: 11 cost time: 31.37149143218994
Epoch: 11, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.557 Vali Acc: 0.968 Test Loss: 0.557 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000033
	speed: 0.2278s/iter; left time: 8350.4440s
	iters: 200, epoch: 12 | loss: 0.0000005
	speed: 0.0754s/iter; left time: 2754.9942s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 2779.9156s
	iters: 400, epoch: 12 | loss: 0.5904869
	speed: 0.0758s/iter; left time: 2757.3235s
Epoch: 12 cost time: 31.76584005355835
Epoch: 12, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.404 Vali Acc: 0.977 Test Loss: 0.404 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2291s/iter; left time: 8304.7077s
	iters: 200, epoch: 13 | loss: 0.0303683
	speed: 0.0771s/iter; left time: 2786.3045s
	iters: 300, epoch: 13 | loss: 0.0000122
	speed: 0.0766s/iter; left time: 2761.0861s
	iters: 400, epoch: 13 | loss: 0.0000375
	speed: 0.0709s/iter; left time: 2547.3895s
Epoch: 13 cost time: 31.54271125793457
Epoch: 13, Steps: 413 | Train Loss: 0.151 Vali Loss: 0.821 Vali Acc: 0.967 Test Loss: 0.821 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000004
	speed: 0.2503s/iter; left time: 8967.5121s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 2794.3712s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0756s/iter; left time: 2693.2424s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2729.3976s
Epoch: 14 cost time: 32.67466902732849
Epoch: 14, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.298 Vali Acc: 0.979 Test Loss: 0.298 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.978624).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2381s/iter; left time: 8434.2842s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0786s/iter; left time: 2774.6897s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 2752.4713s
	iters: 400, epoch: 15 | loss: 0.1205610
	speed: 0.0793s/iter; left time: 2785.2177s
Epoch: 15 cost time: 32.9745409488678
Epoch: 15, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.418 Vali Acc: 0.976 Test Loss: 0.418 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000687
	speed: 0.2314s/iter; left time: 8100.8021s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 2703.5178s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0777s/iter; left time: 2704.6136s
	iters: 400, epoch: 16 | loss: 0.0010900
	speed: 0.0751s/iter; left time: 2607.9472s
Epoch: 16 cost time: 32.15034627914429
Epoch: 16, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.499 Vali Acc: 0.968 Test Loss: 0.499 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2420s/iter; left time: 8370.2972s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 2605.5620s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 2287.3144s
	iters: 400, epoch: 17 | loss: 0.0000002
	speed: 0.0707s/iter; left time: 2425.7484s
Epoch: 17 cost time: 30.316299200057983
Epoch: 17, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.343 Vali Acc: 0.979 Test Loss: 0.343 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2375s/iter; left time: 8116.1803s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 2366.8682s
	iters: 300, epoch: 18 | loss: 0.0076821
	speed: 0.0754s/iter; left time: 2562.9885s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0751s/iter; left time: 2544.1410s
Epoch: 18 cost time: 30.159839391708374
Epoch: 18, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.935 Vali Acc: 0.966 Test Loss: 0.935 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2250s/iter; left time: 7597.5354s
	iters: 200, epoch: 19 | loss: 0.0009378
	speed: 0.0780s/iter; left time: 2626.4119s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 2656.0618s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0767s/iter; left time: 2566.2382s
Epoch: 19 cost time: 32.37319302558899
Epoch: 19, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.408 Vali Acc: 0.978 Test Loss: 0.408 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2290s/iter; left time: 7638.8017s
	iters: 200, epoch: 20 | loss: 3.3749328
	speed: 0.0733s/iter; left time: 2438.5215s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0749s/iter; left time: 2483.5000s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 2606.7067s
Epoch: 20 cost time: 32.11940145492554
Epoch: 20, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.682 Vali Acc: 0.973 Test Loss: 0.682 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.6296545
	speed: 0.2413s/iter; left time: 7949.6140s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 2429.7916s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0652s/iter; left time: 2134.9293s
	iters: 400, epoch: 21 | loss: 0.3791650
	speed: 0.0772s/iter; left time: 2519.1599s
Epoch: 21 cost time: 30.55229687690735
Epoch: 21, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.528 Vali Acc: 0.975 Test Loss: 0.528 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2244s/iter; left time: 7298.6658s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0743s/iter; left time: 2409.3995s
	iters: 300, epoch: 22 | loss: 0.0000047
	speed: 0.0774s/iter; left time: 2503.4894s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0744s/iter; left time: 2398.6672s
Epoch: 22 cost time: 31.648197174072266
Epoch: 22, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.449 Vali Acc: 0.975 Test Loss: 0.449 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000049
	speed: 0.2261s/iter; left time: 7260.4134s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0700s/iter; left time: 2240.5475s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0726s/iter; left time: 2316.3169s
	iters: 400, epoch: 23 | loss: 1.1753652
	speed: 0.0732s/iter; left time: 2329.8938s
Epoch: 23 cost time: 30.79658341407776
Epoch: 23, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.306 Vali Acc: 0.983 Test Loss: 0.306 Test Acc: 0.983
Validation loss decreased (-0.978624 --> -0.983171).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2442s/iter; left time: 7742.9610s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 2288.3801s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 2330.0837s
	iters: 400, epoch: 24 | loss: 0.0823260
	speed: 0.0765s/iter; left time: 2402.8339s
Epoch: 24 cost time: 30.90852403640747
Epoch: 24, Steps: 413 | Train Loss: 0.049 Vali Loss: 1.243 Vali Acc: 0.958 Test Loss: 1.243 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.2208s/iter; left time: 6909.5667s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2405.3024s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 2457.0272s
	iters: 400, epoch: 25 | loss: 0.2443985
	speed: 0.0768s/iter; left time: 2380.5235s
Epoch: 25 cost time: 32.42504382133484
Epoch: 25, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.892 Vali Acc: 0.969 Test Loss: 0.892 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2287s/iter; left time: 7061.6385s
	iters: 200, epoch: 26 | loss: 0.1193347
	speed: 0.0769s/iter; left time: 2366.1579s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0770s/iter; left time: 2361.0854s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0763s/iter; left time: 2334.2892s
Epoch: 26 cost time: 32.101754665374756
Epoch: 26, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.487 Vali Acc: 0.980 Test Loss: 0.487 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2396s/iter; left time: 7297.4678s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 2244.3357s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0689s/iter; left time: 2086.6191s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 2375.4655s
Epoch: 27 cost time: 30.67534899711609
Epoch: 27, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.731 Vali Acc: 0.972 Test Loss: 0.731 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2479s/iter; left time: 7448.3706s
	iters: 200, epoch: 28 | loss: 0.6478067
	speed: 0.0760s/iter; left time: 2276.9245s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 2269.1779s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0743s/iter; left time: 2211.5222s
Epoch: 28 cost time: 30.999724864959717
Epoch: 28, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.475 Vali Acc: 0.977 Test Loss: 0.475 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0552728
	speed: 0.2221s/iter; left time: 6581.0644s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0704s/iter; left time: 2078.8723s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 2200.5678s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0792s/iter; left time: 2322.5841s
Epoch: 29 cost time: 31.253458976745605
Epoch: 29, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.883 Vali Acc: 0.970 Test Loss: 0.883 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2357s/iter; left time: 6888.7439s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 2408.8929s
	iters: 300, epoch: 30 | loss: 0.4888338
	speed: 0.0837s/iter; left time: 2430.7499s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0767s/iter; left time: 2218.6629s
Epoch: 30 cost time: 33.491480112075806
Epoch: 30, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.988 Vali Acc: 0.974 Test Loss: 0.988 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2533s/iter; left time: 7296.8285s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 2245.4773s
	iters: 300, epoch: 31 | loss: 0.7230717
	speed: 0.0781s/iter; left time: 2235.3976s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 2267.1666s
Epoch: 31 cost time: 32.848325967788696
Epoch: 31, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.385 Vali Acc: 0.980 Test Loss: 0.385 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2352s/iter; left time: 6680.1613s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 2128.9094s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0794s/iter; left time: 2237.7358s
	iters: 400, epoch: 32 | loss: 0.0019751
	speed: 0.0756s/iter; left time: 2124.3329s
Epoch: 32 cost time: 32.08544206619263
Epoch: 32, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.588 Vali Acc: 0.978 Test Loss: 0.588 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2337s/iter; left time: 6540.1176s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 2116.4984s
	iters: 300, epoch: 33 | loss: 2.9953370
	speed: 0.0745s/iter; left time: 2070.4615s
	iters: 400, epoch: 33 | loss: 0.0000075
	speed: 0.0688s/iter; left time: 1903.5884s
Epoch: 33 cost time: 31.277705192565918
Epoch: 33, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.615 Vali Acc: 0.977 Test Loss: 0.615 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 3678866
model size : 23.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1650794
	speed: 0.1012s/iter; left time: 4169.9791s
	iters: 200, epoch: 1 | loss: 0.1559409
	speed: 0.0810s/iter; left time: 3329.9673s
	iters: 300, epoch: 1 | loss: 0.0142735
	speed: 0.0813s/iter; left time: 3331.5183s
	iters: 400, epoch: 1 | loss: 0.0017805
	speed: 0.0796s/iter; left time: 3255.2846s
Epoch: 1 cost time: 35.51310968399048
Epoch: 1, Steps: 413 | Train Loss: 0.305 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
Validation loss decreased (inf --> -0.971804).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0336352
	speed: 0.2349s/iter; left time: 9579.5091s
	iters: 200, epoch: 2 | loss: 0.0000615
	speed: 0.0834s/iter; left time: 3393.8705s
	iters: 300, epoch: 2 | loss: 0.0011588
	speed: 0.0813s/iter; left time: 3300.1363s
	iters: 400, epoch: 2 | loss: 0.0001265
	speed: 0.0853s/iter; left time: 3454.0745s
Epoch: 2 cost time: 34.69649147987366
Epoch: 2, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.176 Vali Acc: 0.960 Test Loss: 0.176 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0002299
	speed: 0.2404s/iter; left time: 9708.0666s
	iters: 200, epoch: 3 | loss: 0.0278255
	speed: 0.0870s/iter; left time: 3505.0943s
	iters: 300, epoch: 3 | loss: 0.0000196
	speed: 0.0852s/iter; left time: 3422.3132s
	iters: 400, epoch: 3 | loss: 0.0100705
	speed: 0.0865s/iter; left time: 3467.1399s
Epoch: 3 cost time: 35.731770277023315
Epoch: 3, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
Validation loss decreased (-0.971804 --> -0.974532).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1306370
	speed: 0.2543s/iter; left time: 10162.7163s
	iters: 200, epoch: 4 | loss: 0.0000024
	speed: 0.0807s/iter; left time: 3215.3756s
	iters: 300, epoch: 4 | loss: 0.0000175
	speed: 0.0813s/iter; left time: 3232.9800s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 3153.4088s
Epoch: 4 cost time: 33.85337948799133
Epoch: 4, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.242 Vali Acc: 0.971 Test Loss: 0.242 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0003485
	speed: 0.2340s/iter; left time: 9253.5269s
	iters: 200, epoch: 5 | loss: 0.0016030
	speed: 0.0804s/iter; left time: 3171.3852s
	iters: 300, epoch: 5 | loss: 0.8104821
	speed: 0.0805s/iter; left time: 3166.0467s
	iters: 400, epoch: 5 | loss: 0.3052768
	speed: 0.0842s/iter; left time: 3304.1969s
Epoch: 5 cost time: 34.067235708236694
Epoch: 5, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.467 Vali Acc: 0.955 Test Loss: 0.467 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2307s/iter; left time: 9027.6215s
	iters: 200, epoch: 6 | loss: 0.0002368
	speed: 0.0879s/iter; left time: 3432.9432s
	iters: 300, epoch: 6 | loss: 0.7018955
	speed: 0.0851s/iter; left time: 3314.4883s
	iters: 400, epoch: 6 | loss: 0.0000001
	speed: 0.0773s/iter; left time: 3003.2943s
Epoch: 6 cost time: 34.09625744819641
Epoch: 6, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.617 Vali Acc: 0.961 Test Loss: 0.617 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2547s/iter; left time: 9864.3611s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 2739.0903s
	iters: 300, epoch: 7 | loss: 0.0000006
	speed: 0.0775s/iter; left time: 2984.2930s
	iters: 400, epoch: 7 | loss: 0.7825298
	speed: 0.0829s/iter; left time: 3184.9458s
Epoch: 7 cost time: 32.897114515304565
Epoch: 7, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.348 Vali Acc: 0.968 Test Loss: 0.348 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000335
	speed: 0.2272s/iter; left time: 8702.6626s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0823s/iter; left time: 3145.2609s
	iters: 300, epoch: 8 | loss: 0.1452853
	speed: 0.0831s/iter; left time: 3167.4296s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 3249.2661s
Epoch: 8 cost time: 34.739797592163086
Epoch: 8, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.350 Vali Acc: 0.974 Test Loss: 0.350 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0001047
	speed: 0.2354s/iter; left time: 8919.9880s
	iters: 200, epoch: 9 | loss: 0.0584177
	speed: 0.0831s/iter; left time: 3139.7283s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0839s/iter; left time: 3161.7188s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0865s/iter; left time: 3250.4631s
Epoch: 9 cost time: 34.962538957595825
Epoch: 9, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.276 Vali Acc: 0.972 Test Loss: 0.276 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000014
	speed: 0.2568s/iter; left time: 9624.9989s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0777s/iter; left time: 2906.3126s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 2962.6198s
	iters: 400, epoch: 10 | loss: 0.2657514
	speed: 0.0793s/iter; left time: 2948.9513s
Epoch: 10 cost time: 33.185033321380615
Epoch: 10, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.546 Vali Acc: 0.966 Test Loss: 0.546 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.3592387
	speed: 0.2255s/iter; left time: 8359.3547s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2877.7033s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 2894.9726s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0800s/iter; left time: 2940.6047s
Epoch: 11 cost time: 32.8895628452301
Epoch: 11, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.461 Vali Acc: 0.969 Test Loss: 0.461 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2242s/iter; left time: 8217.5992s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0811s/iter; left time: 2965.3363s
	iters: 300, epoch: 12 | loss: 0.0000034
	speed: 0.0813s/iter; left time: 2962.7374s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 2784.5901s
Epoch: 12 cost time: 32.88841891288757
Epoch: 12, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.508 Vali Acc: 0.967 Test Loss: 0.508 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2597s/iter; left time: 9412.3983s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0727s/iter; left time: 2627.0841s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0859s/iter; left time: 3095.3803s
	iters: 400, epoch: 13 | loss: 0.5486407
	speed: 0.0854s/iter; left time: 3068.9346s
Epoch: 13 cost time: 34.46016502380371
Epoch: 13, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.242 Vali Acc: 0.986 Test Loss: 0.242 Test Acc: 0.986
Validation loss decreased (-0.974532 --> -0.985900).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2452s/iter; left time: 8785.6023s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0823s/iter; left time: 2940.4264s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0820s/iter; left time: 2922.6921s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 2903.4388s
Epoch: 14 cost time: 34.2943434715271
Epoch: 14, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.273 Vali Acc: 0.985 Test Loss: 0.273 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2274s/iter; left time: 8052.9855s
	iters: 200, epoch: 15 | loss: 0.4187975
	speed: 0.0803s/iter; left time: 2837.5263s
	iters: 300, epoch: 15 | loss: 0.0011767
	speed: 0.0782s/iter; left time: 2755.1411s
	iters: 400, epoch: 15 | loss: 0.0002755
	speed: 0.0818s/iter; left time: 2871.7781s
Epoch: 15 cost time: 33.55261850357056
Epoch: 15, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.316 Vali Acc: 0.977 Test Loss: 0.316 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2443s/iter; left time: 8551.8531s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 2708.9361s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 2786.6480s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0774s/iter; left time: 2685.9080s
Epoch: 16 cost time: 32.47443652153015
Epoch: 16, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.590 Vali Acc: 0.976 Test Loss: 0.590 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2555s/iter; left time: 8837.7393s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0793s/iter; left time: 2734.0753s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0803s/iter; left time: 2763.1197s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0786s/iter; left time: 2696.8373s
Epoch: 17 cost time: 33.195640325546265
Epoch: 17, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.543 Vali Acc: 0.971 Test Loss: 0.543 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2265s/iter; left time: 7742.6832s
	iters: 200, epoch: 18 | loss: 0.0000235
	speed: 0.0801s/iter; left time: 2728.2440s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0786s/iter; left time: 2671.2503s
	iters: 400, epoch: 18 | loss: 0.6091810
	speed: 0.0843s/iter; left time: 2857.1255s
Epoch: 18 cost time: 33.68153619766235
Epoch: 18, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.453 Vali Acc: 0.976 Test Loss: 0.453 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2271s/iter; left time: 7668.2915s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 2941.0967s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 2942.7605s
	iters: 400, epoch: 19 | loss: 0.0000008
	speed: 0.0842s/iter; left time: 2817.5301s
Epoch: 19 cost time: 35.167781829833984
Epoch: 19, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.280 Vali Acc: 0.981 Test Loss: 0.280 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2623s/iter; left time: 8749.7320s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 2797.3730s
	iters: 300, epoch: 20 | loss: 0.0000785
	speed: 0.0761s/iter; left time: 2522.7176s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0811s/iter; left time: 2679.1867s
Epoch: 20 cost time: 34.45815467834473
Epoch: 20, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.400 Vali Acc: 0.974 Test Loss: 0.400 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2282s/iter; left time: 7517.6438s
	iters: 200, epoch: 21 | loss: 0.0011792
	speed: 0.0805s/iter; left time: 2644.4904s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 2643.6956s
	iters: 400, epoch: 21 | loss: 0.4143109
	speed: 0.0806s/iter; left time: 2631.6862s
Epoch: 21 cost time: 33.39941120147705
Epoch: 21, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.456 Vali Acc: 0.977 Test Loss: 0.456 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2332s/iter; left time: 7584.5361s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0771s/iter; left time: 2499.2223s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 2577.8780s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 2489.7343s
Epoch: 22 cost time: 32.915836334228516
Epoch: 22, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.288 Vali Acc: 0.983 Test Loss: 0.288 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2612s/iter; left time: 8390.0346s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 2552.8457s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0792s/iter; left time: 2526.1460s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 2572.3168s
Epoch: 23 cost time: 33.70333790779114
Epoch: 23, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.462 Vali Acc: 0.979 Test Loss: 0.462 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 2630290
model size : 19.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1386812
	speed: 0.0915s/iter; left time: 3768.1699s
	iters: 200, epoch: 1 | loss: 0.0744458
	speed: 0.0780s/iter; left time: 3206.3170s
	iters: 300, epoch: 1 | loss: 0.0303939
	speed: 0.0762s/iter; left time: 3122.9602s
	iters: 400, epoch: 1 | loss: 0.0330479
	speed: 0.0790s/iter; left time: 3230.4304s
Epoch: 1 cost time: 33.65695524215698
Epoch: 1, Steps: 413 | Train Loss: 0.300 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0033395
	speed: 0.2241s/iter; left time: 9140.9158s
	iters: 200, epoch: 2 | loss: 0.0006172
	speed: 0.0796s/iter; left time: 3236.8050s
	iters: 300, epoch: 2 | loss: 0.0012365
	speed: 0.0815s/iter; left time: 3307.4491s
	iters: 400, epoch: 2 | loss: 0.0204701
	speed: 0.0843s/iter; left time: 3412.6455s
Epoch: 2 cost time: 33.716471672058105
Epoch: 2, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.970895 --> -0.974532).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000642
	speed: 0.2579s/iter; left time: 10411.1665s
	iters: 200, epoch: 3 | loss: 0.1034476
	speed: 0.0770s/iter; left time: 3100.5320s
	iters: 300, epoch: 3 | loss: 0.0059598
	speed: 0.0780s/iter; left time: 3132.7675s
	iters: 400, epoch: 3 | loss: 0.0001183
	speed: 0.0720s/iter; left time: 2886.6902s
Epoch: 3 cost time: 32.097660541534424
Epoch: 3, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.355 Vali Acc: 0.951 Test Loss: 0.355 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1228040
	speed: 0.2330s/iter; left time: 9311.0834s
	iters: 200, epoch: 4 | loss: 0.0137959
	speed: 0.0771s/iter; left time: 3074.3140s
	iters: 300, epoch: 4 | loss: 0.0077644
	speed: 0.0729s/iter; left time: 2898.2178s
	iters: 400, epoch: 4 | loss: 0.0000753
	speed: 0.0772s/iter; left time: 3061.6933s
Epoch: 4 cost time: 32.01572561264038
Epoch: 4, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000032
	speed: 0.2273s/iter; left time: 8988.1615s
	iters: 200, epoch: 5 | loss: 0.0049894
	speed: 0.0768s/iter; left time: 3030.9069s
	iters: 300, epoch: 5 | loss: 0.0068955
	speed: 0.0741s/iter; left time: 2916.6058s
	iters: 400, epoch: 5 | loss: 0.0000007
	speed: 0.0746s/iter; left time: 2927.9692s
Epoch: 5 cost time: 31.711368083953857
Epoch: 5, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.199 Vali Acc: 0.970 Test Loss: 0.199 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0405239
	speed: 0.2508s/iter; left time: 9816.5899s
	iters: 200, epoch: 6 | loss: 0.0000001
	speed: 0.0792s/iter; left time: 3091.2185s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0800s/iter; left time: 3113.8915s
	iters: 400, epoch: 6 | loss: 0.8091193
	speed: 0.0795s/iter; left time: 3086.8087s
Epoch: 6 cost time: 33.067039251327515
Epoch: 6, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.353 Vali Acc: 0.962 Test Loss: 0.353 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0025451
	speed: 0.2317s/iter; left time: 8972.5443s
	iters: 200, epoch: 7 | loss: 0.0000010
	speed: 0.0776s/iter; left time: 2996.7056s
	iters: 300, epoch: 7 | loss: 0.4317769
	speed: 0.0774s/iter; left time: 2982.9911s
	iters: 400, epoch: 7 | loss: 0.0043852
	speed: 0.0787s/iter; left time: 3025.7870s
Epoch: 7 cost time: 32.43549156188965
Epoch: 7, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.346 Vali Acc: 0.969 Test Loss: 0.346 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000215
	speed: 0.2249s/iter; left time: 8614.7700s
	iters: 200, epoch: 8 | loss: 0.0000003
	speed: 0.0796s/iter; left time: 3043.1167s
	iters: 300, epoch: 8 | loss: 0.0012923
	speed: 0.0730s/iter; left time: 2783.9237s
	iters: 400, epoch: 8 | loss: 0.9811270
	speed: 0.0743s/iter; left time: 2824.0809s
Epoch: 8 cost time: 31.828813314437866
Epoch: 8, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.392 Vali Acc: 0.962 Test Loss: 0.392 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0006084
	speed: 0.2397s/iter; left time: 9083.8930s
	iters: 200, epoch: 9 | loss: 0.0000229
	speed: 0.0740s/iter; left time: 2796.1439s
	iters: 300, epoch: 9 | loss: 0.3348770
	speed: 0.0726s/iter; left time: 2737.4161s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2924.8730s
Epoch: 9 cost time: 31.495601415634155
Epoch: 9, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.413 Vali Acc: 0.974 Test Loss: 0.413 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2401s/iter; left time: 8999.1114s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 2840.0652s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 2854.5891s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0780s/iter; left time: 2898.7804s
Epoch: 10 cost time: 31.338134765625
Epoch: 10, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.508 Vali Acc: 0.974 Test Loss: 0.508 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.3358568
	speed: 0.2229s/iter; left time: 8263.3788s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0753s/iter; left time: 2784.8655s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0750s/iter; left time: 2767.1230s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0745s/iter; left time: 2739.2991s
Epoch: 11 cost time: 31.418476104736328
Epoch: 11, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.281 Vali Acc: 0.974 Test Loss: 0.281 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2178s/iter; left time: 7983.6782s
	iters: 200, epoch: 12 | loss: 0.0000007
	speed: 0.0785s/iter; left time: 2868.1195s
	iters: 300, epoch: 12 | loss: 0.0693654
	speed: 0.0800s/iter; left time: 2916.8155s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0860s/iter; left time: 3128.3361s
Epoch: 12 cost time: 33.490094900131226
Epoch: 12, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.546 Vali Acc: 0.968 Test Loss: 0.546 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9745338790359254
model parameter : 2630290
model size : 19.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1061797
	speed: 0.0959s/iter; left time: 3953.0948s
	iters: 200, epoch: 1 | loss: 0.0468738
	speed: 0.0763s/iter; left time: 3134.4498s
	iters: 300, epoch: 1 | loss: 0.0638502
	speed: 0.0753s/iter; left time: 3087.2436s
	iters: 400, epoch: 1 | loss: 0.2504982
	speed: 0.0747s/iter; left time: 3054.0002s
Epoch: 1 cost time: 33.385509729385376
Epoch: 1, Steps: 413 | Train Loss: 0.296 Vali Loss: 0.231 Vali Acc: 0.940 Test Loss: 0.231 Test Acc: 0.940
Validation loss decreased (inf --> -0.939970).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0005826
	speed: 0.2264s/iter; left time: 9235.4587s
	iters: 200, epoch: 2 | loss: 0.0037076
	speed: 0.0745s/iter; left time: 3030.4946s
	iters: 300, epoch: 2 | loss: 0.0019521
	speed: 0.0756s/iter; left time: 3067.2823s
	iters: 400, epoch: 2 | loss: 0.0022650
	speed: 0.0759s/iter; left time: 3071.7467s
Epoch: 2 cost time: 31.25307607650757
Epoch: 2, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.198 Vali Acc: 0.961 Test Loss: 0.198 Test Acc: 0.961
Validation loss decreased (-0.939970 --> -0.960889).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0712885
	speed: 0.2365s/iter; left time: 9548.6699s
	iters: 200, epoch: 3 | loss: 0.2196652
	speed: 0.0758s/iter; left time: 3052.3399s
	iters: 300, epoch: 3 | loss: 0.0000002
	speed: 0.0735s/iter; left time: 2951.9032s
	iters: 400, epoch: 3 | loss: 0.0000054
	speed: 0.0716s/iter; left time: 2869.0667s
Epoch: 3 cost time: 30.77519965171814
Epoch: 3, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.194 Vali Acc: 0.971 Test Loss: 0.194 Test Acc: 0.971
Validation loss decreased (-0.960889 --> -0.971349).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0247853
	speed: 0.2440s/iter; left time: 9751.7611s
	iters: 200, epoch: 4 | loss: 0.0004362
	speed: 0.0744s/iter; left time: 2967.5470s
	iters: 300, epoch: 4 | loss: 0.0001260
	speed: 0.0740s/iter; left time: 2940.8183s
	iters: 400, epoch: 4 | loss: 0.0000018
	speed: 0.0749s/iter; left time: 2969.4611s
Epoch: 4 cost time: 31.051018238067627
Epoch: 4, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.971349 --> -0.983173).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0009971
	speed: 0.2185s/iter; left time: 8640.8597s
	iters: 200, epoch: 5 | loss: 0.0000051
	speed: 0.0766s/iter; left time: 3020.0841s
	iters: 300, epoch: 5 | loss: 0.5037043
	speed: 0.0776s/iter; left time: 3053.5073s
	iters: 400, epoch: 5 | loss: 0.0000723
	speed: 0.0769s/iter; left time: 3016.5554s
Epoch: 5 cost time: 31.947699069976807
Epoch: 5, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.236 Vali Acc: 0.969 Test Loss: 0.236 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2260s/iter; left time: 8846.3941s
	iters: 200, epoch: 6 | loss: 0.0000525
	speed: 0.0809s/iter; left time: 3157.4205s
	iters: 300, epoch: 6 | loss: 0.0000138
	speed: 0.0789s/iter; left time: 3073.6995s
	iters: 400, epoch: 6 | loss: 0.0002319
	speed: 0.0719s/iter; left time: 2793.2341s
Epoch: 6 cost time: 32.241029500961304
Epoch: 6, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.448 Vali Acc: 0.960 Test Loss: 0.448 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1498090
	speed: 0.2451s/iter; left time: 9490.6495s
	iters: 200, epoch: 7 | loss: 0.0040906
	speed: 0.0723s/iter; left time: 2790.8666s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0701s/iter; left time: 2699.2369s
	iters: 400, epoch: 7 | loss: 0.0455811
	speed: 0.0749s/iter; left time: 2876.8388s
Epoch: 7 cost time: 31.00374126434326
Epoch: 7, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.328 Vali Acc: 0.967 Test Loss: 0.328 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000004
	speed: 0.2168s/iter; left time: 8306.1537s
	iters: 200, epoch: 8 | loss: 0.0000001
	speed: 0.0748s/iter; left time: 2856.8711s
	iters: 300, epoch: 8 | loss: 0.1544732
	speed: 0.0762s/iter; left time: 2902.9748s
	iters: 400, epoch: 8 | loss: 0.0396255
	speed: 0.0745s/iter; left time: 2833.3833s
Epoch: 8 cost time: 31.21977162361145
Epoch: 8, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.302 Vali Acc: 0.972 Test Loss: 0.302 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.9362518
	speed: 0.2189s/iter; left time: 8296.0496s
	iters: 200, epoch: 9 | loss: 0.0961921
	speed: 0.0724s/iter; left time: 2735.8840s
	iters: 300, epoch: 9 | loss: 0.1295244
	speed: 0.0731s/iter; left time: 2753.8362s
	iters: 400, epoch: 9 | loss: 0.0084701
	speed: 0.0716s/iter; left time: 2691.4323s
Epoch: 9 cost time: 30.64080572128296
Epoch: 9, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.401 Vali Acc: 0.960 Test Loss: 0.401 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2514s/iter; left time: 9423.6431s
	iters: 200, epoch: 10 | loss: 0.0000183
	speed: 0.0722s/iter; left time: 2697.8975s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0756s/iter; left time: 2819.6420s
	iters: 400, epoch: 10 | loss: 0.0000263
	speed: 0.0788s/iter; left time: 2928.5107s
Epoch: 10 cost time: 31.912955045700073
Epoch: 10, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.353 Vali Acc: 0.968 Test Loss: 0.353 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.6707997
	speed: 0.2178s/iter; left time: 8072.5644s
	iters: 200, epoch: 11 | loss: 0.0001503
	speed: 0.0767s/iter; left time: 2835.7575s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 2822.9388s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0792s/iter; left time: 2911.1675s
Epoch: 11 cost time: 32.29932260513306
Epoch: 11, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.327 Vali Acc: 0.978 Test Loss: 0.327 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2145s/iter; left time: 7862.0796s
	iters: 200, epoch: 12 | loss: 0.0000133
	speed: 0.0787s/iter; left time: 2878.2083s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0780s/iter; left time: 2843.7842s
	iters: 400, epoch: 12 | loss: 0.0000003
	speed: 0.0747s/iter; left time: 2716.1868s
Epoch: 12 cost time: 31.99983286857605
Epoch: 12, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.457 Vali Acc: 0.973 Test Loss: 0.457 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2546s/iter; left time: 9227.1558s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0722s/iter; left time: 2608.5140s
	iters: 300, epoch: 13 | loss: 0.0000267
	speed: 0.0721s/iter; left time: 2599.7333s
	iters: 400, epoch: 13 | loss: 0.0000079
	speed: 0.0708s/iter; left time: 2546.0300s
Epoch: 13 cost time: 30.867282390594482
Epoch: 13, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.428 Vali Acc: 0.973 Test Loss: 0.428 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2473s/iter; left time: 8862.2225s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0703s/iter; left time: 2511.5941s
	iters: 300, epoch: 14 | loss: 0.0000002
	speed: 0.0729s/iter; left time: 2599.2519s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2763.4341s
Epoch: 14 cost time: 30.43848443031311
Epoch: 14, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.292 Vali Acc: 0.984 Test Loss: 0.292 Test Acc: 0.984
Validation loss decreased (-0.983173 --> -0.983626).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0123268
	speed: 0.2214s/iter; left time: 7842.8841s
	iters: 200, epoch: 15 | loss: 1.9065576
	speed: 0.0779s/iter; left time: 2751.2900s
	iters: 300, epoch: 15 | loss: 0.0999440
	speed: 0.0747s/iter; left time: 2631.8122s
	iters: 400, epoch: 15 | loss: 0.0003983
	speed: 0.0762s/iter; left time: 2676.2457s
Epoch: 15 cost time: 31.84490132331848
Epoch: 15, Steps: 413 | Train Loss: 0.102 Vali Loss: 1.073 Vali Acc: 0.951 Test Loss: 1.073 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2283s/iter; left time: 7990.5905s
	iters: 200, epoch: 16 | loss: 1.3102945
	speed: 0.0771s/iter; left time: 2690.3046s
	iters: 300, epoch: 16 | loss: 0.1022588
	speed: 0.0810s/iter; left time: 2819.3474s
	iters: 400, epoch: 16 | loss: 0.0000031
	speed: 0.0745s/iter; left time: 2584.5404s
Epoch: 16 cost time: 33.05923867225647
Epoch: 16, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.460 Vali Acc: 0.975 Test Loss: 0.460 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2592s/iter; left time: 8967.7336s
	iters: 200, epoch: 17 | loss: 0.0000138
	speed: 0.0739s/iter; left time: 2548.1046s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 2612.8448s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2634.9732s
Epoch: 17 cost time: 32.168784856796265
Epoch: 17, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.410 Vali Acc: 0.981 Test Loss: 0.410 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2142s/iter; left time: 7321.3117s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0767s/iter; left time: 2613.7702s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 2495.6416s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0772s/iter; left time: 2614.6117s
Epoch: 18 cost time: 31.83599352836609
Epoch: 18, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.372 Vali Acc: 0.973 Test Loss: 0.372 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2220s/iter; left time: 7497.8676s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 2332.4967s
	iters: 300, epoch: 19 | loss: 0.0000622
	speed: 0.0743s/iter; left time: 2495.5081s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0743s/iter; left time: 2485.5292s
Epoch: 19 cost time: 30.835391998291016
Epoch: 19, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.457 Vali Acc: 0.975 Test Loss: 0.457 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2427s/iter; left time: 8095.1748s
	iters: 200, epoch: 20 | loss: 0.0000618
	speed: 0.0766s/iter; left time: 2546.3100s
	iters: 300, epoch: 20 | loss: 0.0000014
	speed: 0.0769s/iter; left time: 2550.2422s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0748s/iter; left time: 2474.0100s
Epoch: 20 cost time: 31.543912649154663
Epoch: 20, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.361 Vali Acc: 0.978 Test Loss: 0.361 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2273s/iter; left time: 7488.6156s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2512.3086s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 2388.3077s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2540.4574s
Epoch: 21 cost time: 31.79647135734558
Epoch: 21, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.369 Vali Acc: 0.979 Test Loss: 0.369 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2232s/iter; left time: 7261.4133s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0758s/iter; left time: 2457.4531s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0787s/iter; left time: 2545.3931s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 2496.4788s
Epoch: 22 cost time: 32.38079833984375
Epoch: 22, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.291 Vali Acc: 0.987 Test Loss: 0.291 Test Acc: 0.987
Validation loss decreased (-0.983626 --> -0.986809).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000001
	speed: 0.2532s/iter; left time: 8130.3104s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 2336.3337s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 2612.4788s
	iters: 400, epoch: 23 | loss: 0.1211923
	speed: 0.0780s/iter; left time: 2482.5775s
Epoch: 23 cost time: 32.455219745635986
Epoch: 23, Steps: 413 | Train Loss: 0.082 Vali Loss: 1.163 Vali Acc: 0.957 Test Loss: 1.163 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2394s/iter; left time: 7588.4604s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0753s/iter; left time: 2378.2268s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 2328.8552s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2403.6655s
Epoch: 24 cost time: 31.618915557861328
Epoch: 24, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.440 Vali Acc: 0.982 Test Loss: 0.440 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0004364
	speed: 0.2274s/iter; left time: 7114.5970s
	iters: 200, epoch: 25 | loss: 0.9648342
	speed: 0.0742s/iter; left time: 2313.7191s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 2413.9008s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 2330.7153s
Epoch: 25 cost time: 31.503547191619873
Epoch: 25, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.534 Vali Acc: 0.977 Test Loss: 0.534 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000944
	speed: 0.2551s/iter; left time: 7876.2359s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 2386.6209s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0758s/iter; left time: 2326.6441s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 2188.9103s
Epoch: 26 cost time: 31.867528200149536
Epoch: 26, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.564 Vali Acc: 0.977 Test Loss: 0.564 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0063373
	speed: 0.2432s/iter; left time: 7407.6446s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0757s/iter; left time: 2297.6141s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0761s/iter; left time: 2303.2977s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0780s/iter; left time: 2351.8885s
Epoch: 27 cost time: 31.69620108604431
Epoch: 27, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.393 Vali Acc: 0.979 Test Loss: 0.393 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2226s/iter; left time: 6688.1945s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 2322.7428s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 2187.1996s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0707s/iter; left time: 2104.7829s
Epoch: 28 cost time: 30.92396092414856
Epoch: 28, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.461 Vali Acc: 0.975 Test Loss: 0.461 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2420s/iter; left time: 7173.1364s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0804s/iter; left time: 2375.4104s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 2406.2509s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 2035.3965s
Epoch: 29 cost time: 33.135934591293335
Epoch: 29, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.571 Vali Acc: 0.970 Test Loss: 0.571 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2567s/iter; left time: 7500.4862s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 2124.4685s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 2307.3181s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2249.8876s
Epoch: 30 cost time: 32.63263249397278
Epoch: 30, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.479 Vali Acc: 0.981 Test Loss: 0.479 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2175s/iter; left time: 6266.6481s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2234.8051s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2188.3876s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0767s/iter; left time: 2185.4759s
Epoch: 31 cost time: 31.968947887420654
Epoch: 31, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.382 Vali Acc: 0.984 Test Loss: 0.382 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2279s/iter; left time: 6472.6169s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0757s/iter; left time: 2143.1567s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2155.8679s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 2121.4652s
Epoch: 32 cost time: 31.38644528388977
Epoch: 32, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.575 Vali Acc: 0.977 Test Loss: 0.575 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 2630290
model size : 19.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0640397
	speed: 0.1183s/iter; left time: 4875.9216s
	iters: 200, epoch: 1 | loss: 0.0075860
	speed: 0.0954s/iter; left time: 3920.4968s
	iters: 300, epoch: 1 | loss: 0.0979838
	speed: 0.0663s/iter; left time: 2716.9745s
	iters: 400, epoch: 1 | loss: 0.0154439
	speed: 0.0495s/iter; left time: 2024.3010s
Epoch: 1 cost time: 33.64054489135742
Epoch: 1, Steps: 413 | Train Loss: 0.306 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (inf --> -0.967711).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0062824
	speed: 0.1939s/iter; left time: 7907.6196s
	iters: 200, epoch: 2 | loss: 0.0241441
	speed: 0.0726s/iter; left time: 2954.3140s
	iters: 300, epoch: 2 | loss: 0.0064605
	speed: 0.0728s/iter; left time: 2954.6562s
	iters: 400, epoch: 2 | loss: 0.0026973
	speed: 0.0749s/iter; left time: 3033.7006s
Epoch: 2 cost time: 30.83795952796936
Epoch: 2, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
Validation loss decreased (-0.967711 --> -0.982264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0884899
	speed: 0.2134s/iter; left time: 8616.7639s
	iters: 200, epoch: 3 | loss: 0.0564074
	speed: 0.0746s/iter; left time: 3003.3151s
	iters: 300, epoch: 3 | loss: 0.0003320
	speed: 0.0745s/iter; left time: 2991.5122s
	iters: 400, epoch: 3 | loss: 0.0001939
	speed: 0.0720s/iter; left time: 2884.0858s
Epoch: 3 cost time: 30.62824845314026
Epoch: 3, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.144 Vali Acc: 0.978 Test Loss: 0.144 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5631824
	speed: 0.2122s/iter; left time: 8481.5551s
	iters: 200, epoch: 4 | loss: 0.0000015
	speed: 0.0681s/iter; left time: 2713.4942s
	iters: 300, epoch: 4 | loss: 0.5459381
	speed: 0.0728s/iter; left time: 2892.9313s
	iters: 400, epoch: 4 | loss: 0.0000004
	speed: 0.0692s/iter; left time: 2745.0269s
Epoch: 4 cost time: 29.58070468902588
Epoch: 4, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.2456s/iter; left time: 9714.5812s
	iters: 200, epoch: 5 | loss: 0.0000033
	speed: 0.0678s/iter; left time: 2676.2615s
	iters: 300, epoch: 5 | loss: 0.2843094
	speed: 0.0696s/iter; left time: 2739.5849s
	iters: 400, epoch: 5 | loss: 0.0000338
	speed: 0.0713s/iter; left time: 2796.6693s
Epoch: 5 cost time: 29.368531942367554
Epoch: 5, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.326 Vali Acc: 0.959 Test Loss: 0.326 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000120
	speed: 0.2140s/iter; left time: 8377.0287s
	iters: 200, epoch: 6 | loss: 0.6554933
	speed: 0.0713s/iter; left time: 2784.4079s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0732s/iter; left time: 2851.9192s
	iters: 400, epoch: 6 | loss: 0.0041422
	speed: 0.0717s/iter; left time: 2785.8836s
Epoch: 6 cost time: 30.00587487220764
Epoch: 6, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.462 Vali Acc: 0.953 Test Loss: 0.462 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2264s/iter; left time: 8765.5476s
	iters: 200, epoch: 7 | loss: 0.0002379
	speed: 0.0736s/iter; left time: 2841.3727s
	iters: 300, epoch: 7 | loss: 0.2917476
	speed: 0.0771s/iter; left time: 2970.6453s
	iters: 400, epoch: 7 | loss: 0.0000251
	speed: 0.0743s/iter; left time: 2856.2805s
Epoch: 7 cost time: 30.97107458114624
Epoch: 7, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.331 Vali Acc: 0.969 Test Loss: 0.331 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2401s/iter; left time: 9198.9472s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 3023.0663s
	iters: 300, epoch: 8 | loss: 0.5550736
	speed: 0.0672s/iter; left time: 2560.0742s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 2817.7395s
Epoch: 8 cost time: 30.80661630630493
Epoch: 8, Steps: 413 | Train Loss: 0.173 Vali Loss: 0.188 Vali Acc: 0.983 Test Loss: 0.188 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.982718).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2159s/iter; left time: 8180.3495s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0712s/iter; left time: 2690.1609s
	iters: 300, epoch: 9 | loss: 0.0102838
	speed: 0.0734s/iter; left time: 2768.5276s
	iters: 400, epoch: 9 | loss: 0.0113858
	speed: 0.0711s/iter; left time: 2672.6816s
Epoch: 9 cost time: 30.257906675338745
Epoch: 9, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.434 Vali Acc: 0.972 Test Loss: 0.434 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000010
	speed: 0.2259s/iter; left time: 8468.6434s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0678s/iter; left time: 2535.6379s
	iters: 300, epoch: 10 | loss: 0.0734196
	speed: 0.0713s/iter; left time: 2660.0111s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 2724.8080s
Epoch: 10 cost time: 29.948382139205933
Epoch: 10, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.175 Vali Acc: 0.980 Test Loss: 0.175 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000167
	speed: 0.2321s/iter; left time: 8604.6183s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0735s/iter; left time: 2719.1953s
	iters: 300, epoch: 11 | loss: 0.0002881
	speed: 0.0715s/iter; left time: 2635.7121s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0673s/iter; left time: 2474.0142s
Epoch: 11 cost time: 29.81330895423889
Epoch: 11, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.206 Vali Acc: 0.980 Test Loss: 0.206 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2208s/iter; left time: 8093.6025s
	iters: 200, epoch: 12 | loss: 1.1892943
	speed: 0.0720s/iter; left time: 2633.1751s
	iters: 300, epoch: 12 | loss: 0.0195641
	speed: 0.0723s/iter; left time: 2636.2251s
	iters: 400, epoch: 12 | loss: 0.0000704
	speed: 0.0719s/iter; left time: 2615.8444s
Epoch: 12 cost time: 30.20796227455139
Epoch: 12, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.439 Vali Acc: 0.977 Test Loss: 0.439 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.7462766
	speed: 0.2199s/iter; left time: 7970.9968s
	iters: 200, epoch: 13 | loss: 0.0121164
	speed: 0.0760s/iter; left time: 2745.3572s
	iters: 300, epoch: 13 | loss: 1.5167400
	speed: 0.0686s/iter; left time: 2474.4606s
	iters: 400, epoch: 13 | loss: 0.0000006
	speed: 0.0748s/iter; left time: 2687.9474s
Epoch: 13 cost time: 30.546149730682373
Epoch: 13, Steps: 413 | Train Loss: 0.159 Vali Loss: 0.625 Vali Acc: 0.965 Test Loss: 0.625 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2426s/iter; left time: 8693.2035s
	iters: 200, epoch: 14 | loss: 0.0000015
	speed: 0.0756s/iter; left time: 2702.4380s
	iters: 300, epoch: 14 | loss: 0.6841019
	speed: 0.0741s/iter; left time: 2641.4501s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0711s/iter; left time: 2525.1708s
Epoch: 14 cost time: 30.866305351257324
Epoch: 14, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.974 Vali Acc: 0.965 Test Loss: 0.974 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.2286s/iter; left time: 8096.4315s
	iters: 200, epoch: 15 | loss: 1.8060489
	speed: 0.0714s/iter; left time: 2521.6292s
	iters: 300, epoch: 15 | loss: 0.0000002
	speed: 0.0723s/iter; left time: 2547.3443s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 2575.9899s
Epoch: 15 cost time: 30.28959083557129
Epoch: 15, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.717 Vali Acc: 0.963 Test Loss: 0.717 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2138s/iter; left time: 7484.4261s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0735s/iter; left time: 2565.5087s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0712s/iter; left time: 2476.7228s
	iters: 400, epoch: 16 | loss: 0.6036298
	speed: 0.0687s/iter; left time: 2384.5309s
Epoch: 16 cost time: 29.752135276794434
Epoch: 16, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.894 Vali Acc: 0.962 Test Loss: 0.894 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2404s/iter; left time: 8317.6895s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 2369.0573s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.0728s/iter; left time: 2505.4772s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0678s/iter; left time: 2323.3907s
Epoch: 17 cost time: 29.699866771697998
Epoch: 17, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.494 Vali Acc: 0.971 Test Loss: 0.494 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2371s/iter; left time: 8105.2213s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0740s/iter; left time: 2523.5869s
	iters: 300, epoch: 18 | loss: 0.0000045
	speed: 0.0717s/iter; left time: 2436.4235s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 2430.3846s
Epoch: 18 cost time: 30.348206758499146
Epoch: 18, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.680 Vali Acc: 0.975 Test Loss: 0.680 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 2630290
model size : 19.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2129108
	speed: 0.0943s/iter; left time: 3885.1479s
	iters: 200, epoch: 1 | loss: 0.0933290
	speed: 0.0748s/iter; left time: 3075.5072s
	iters: 300, epoch: 1 | loss: 0.0122458
	speed: 0.0776s/iter; left time: 3179.7543s
	iters: 400, epoch: 1 | loss: 0.2235500
	speed: 0.0851s/iter; left time: 3482.2095s
Epoch: 1 cost time: 34.346590518951416
Epoch: 1, Steps: 413 | Train Loss: 0.320 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (inf --> -0.952249).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0087713
	speed: 0.2464s/iter; left time: 10048.3919s
	iters: 200, epoch: 2 | loss: 0.0054429
	speed: 0.0730s/iter; left time: 2968.7052s
	iters: 300, epoch: 2 | loss: 0.0058763
	speed: 0.0798s/iter; left time: 3237.2032s
	iters: 400, epoch: 2 | loss: 0.3006812
	speed: 0.0773s/iter; left time: 3128.8495s
Epoch: 2 cost time: 31.73108148574829
Epoch: 2, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.230 Vali Acc: 0.957 Test Loss: 0.230 Test Acc: 0.957
Validation loss decreased (-0.952249 --> -0.956796).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0047687
	speed: 0.2201s/iter; left time: 8884.8299s
	iters: 200, epoch: 3 | loss: 0.0014216
	speed: 0.0744s/iter; left time: 2996.6735s
	iters: 300, epoch: 3 | loss: 0.0045306
	speed: 0.0733s/iter; left time: 2944.6472s
	iters: 400, epoch: 3 | loss: 0.0000082
	speed: 0.0746s/iter; left time: 2991.2269s
Epoch: 3 cost time: 31.05698251724243
Epoch: 3, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.272 Vali Acc: 0.959 Test Loss: 0.272 Test Acc: 0.959
Validation loss decreased (-0.956796 --> -0.958615).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0189060
	speed: 0.2290s/iter; left time: 9149.9708s
	iters: 200, epoch: 4 | loss: 0.0239031
	speed: 0.0739s/iter; left time: 2945.6426s
	iters: 300, epoch: 4 | loss: 0.0000881
	speed: 0.0720s/iter; left time: 2861.5094s
	iters: 400, epoch: 4 | loss: 0.0000001
	speed: 0.0719s/iter; left time: 2851.8201s
Epoch: 4 cost time: 30.71527671813965
Epoch: 4, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.451 Vali Acc: 0.950 Test Loss: 0.451 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000814
	speed: 0.2577s/iter; left time: 10192.1520s
	iters: 200, epoch: 5 | loss: 0.0465030
	speed: 0.0777s/iter; left time: 3065.9731s
	iters: 300, epoch: 5 | loss: 0.0000003
	speed: 0.0837s/iter; left time: 3293.3574s
	iters: 400, epoch: 5 | loss: 0.0000005
	speed: 0.0800s/iter; left time: 3141.8124s
Epoch: 5 cost time: 33.56067085266113
Epoch: 5, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.395 Vali Acc: 0.952 Test Loss: 0.395 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2280s/iter; left time: 8921.9722s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0761s/iter; left time: 2970.3644s
	iters: 300, epoch: 6 | loss: 0.0000001
	speed: 0.0758s/iter; left time: 2949.8166s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0774s/iter; left time: 3005.4175s
Epoch: 6 cost time: 32.21336650848389
Epoch: 6, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.562 Vali Acc: 0.950 Test Loss: 0.562 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2198s/iter; left time: 8511.4328s
	iters: 200, epoch: 7 | loss: 0.0070498
	speed: 0.0744s/iter; left time: 2872.0524s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 2883.3222s
	iters: 400, epoch: 7 | loss: 0.1730354
	speed: 0.0755s/iter; left time: 2899.9640s
Epoch: 7 cost time: 31.32861614227295
Epoch: 7, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.459 Vali Acc: 0.963 Test Loss: 0.459 Test Acc: 0.963
Validation loss decreased (-0.958615 --> -0.963160).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9233662
	speed: 0.2484s/iter; left time: 9517.3759s
	iters: 200, epoch: 8 | loss: 0.8201450
	speed: 0.0749s/iter; left time: 2860.2553s
	iters: 300, epoch: 8 | loss: 0.0004219
	speed: 0.0736s/iter; left time: 2805.1460s
	iters: 400, epoch: 8 | loss: 0.0000288
	speed: 0.0754s/iter; left time: 2867.7137s
Epoch: 8 cost time: 31.81250762939453
Epoch: 8, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.730 Vali Acc: 0.949 Test Loss: 0.730 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2892s/iter; left time: 10961.3608s
	iters: 200, epoch: 9 | loss: 0.0001233
	speed: 0.0946s/iter; left time: 3573.9825s
	iters: 300, epoch: 9 | loss: 0.5775194
	speed: 0.1000s/iter; left time: 3768.9840s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1001s/iter; left time: 3765.0710s
Epoch: 9 cost time: 40.57468867301941
Epoch: 9, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.268 Vali Acc: 0.972 Test Loss: 0.268 Test Acc: 0.972
Validation loss decreased (-0.963160 --> -0.972257).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2788s/iter; left time: 10451.3774s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0959s/iter; left time: 3583.6129s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0958s/iter; left time: 3572.4318s
	iters: 400, epoch: 10 | loss: 0.0363425
	speed: 0.1053s/iter; left time: 3913.6754s
Epoch: 10 cost time: 41.28834414482117
Epoch: 10, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.363 Vali Acc: 0.974 Test Loss: 0.363 Test Acc: 0.974
Validation loss decreased (-0.972257 --> -0.974075).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000022
	speed: 0.2729s/iter; left time: 10117.3132s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1096s/iter; left time: 4053.8046s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0925s/iter; left time: 3408.8530s
	iters: 400, epoch: 11 | loss: 0.3352497
	speed: 0.0971s/iter; left time: 3571.6286s
Epoch: 11 cost time: 41.49601602554321
Epoch: 11, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.473 Vali Acc: 0.968 Test Loss: 0.473 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.3027s/iter; left time: 11095.5691s
	iters: 200, epoch: 12 | loss: 0.8608158
	speed: 0.0870s/iter; left time: 3179.7204s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1055s/iter; left time: 3844.7697s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0966s/iter; left time: 3511.4613s
Epoch: 12 cost time: 40.438300371170044
Epoch: 12, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.306 Vali Acc: 0.980 Test Loss: 0.306 Test Acc: 0.980
Validation loss decreased (-0.974075 --> -0.979533).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0016504
	speed: 0.2847s/iter; left time: 10319.4813s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0907s/iter; left time: 3278.8991s
	iters: 300, epoch: 13 | loss: 0.1972689
	speed: 0.0930s/iter; left time: 3351.1062s
	iters: 400, epoch: 13 | loss: 0.1338095
	speed: 0.0963s/iter; left time: 3460.4550s
Epoch: 13 cost time: 40.18211817741394
Epoch: 13, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.226 Vali Acc: 0.981 Test Loss: 0.226 Test Acc: 0.981
Validation loss decreased (-0.979533 --> -0.980898).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2741s/iter; left time: 9822.4819s
	iters: 200, epoch: 14 | loss: 0.1650645
	speed: 0.1030s/iter; left time: 3680.1211s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0925s/iter; left time: 3294.4477s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0986s/iter; left time: 3504.1483s
Epoch: 14 cost time: 40.52163100242615
Epoch: 14, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.317 Vali Acc: 0.981 Test Loss: 0.317 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.2966s/iter; left time: 10505.3255s
	iters: 200, epoch: 15 | loss: 1.5800638
	speed: 0.0928s/iter; left time: 3276.9967s
	iters: 300, epoch: 15 | loss: 0.0000002
	speed: 0.1074s/iter; left time: 3783.5308s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1077s/iter; left time: 3782.1128s
Epoch: 15 cost time: 41.40612459182739
Epoch: 15, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.286 Vali Acc: 0.977 Test Loss: 0.286 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5889319
	speed: 0.2812s/iter; left time: 9843.0180s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0978s/iter; left time: 3414.5155s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1000s/iter; left time: 3478.9741s
	iters: 400, epoch: 16 | loss: 1.4365420
	speed: 0.1008s/iter; left time: 3496.9942s
Epoch: 16 cost time: 42.19386887550354
Epoch: 16, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.371 Vali Acc: 0.977 Test Loss: 0.371 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.4389942
	speed: 0.2840s/iter; left time: 9824.8288s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1052s/iter; left time: 3628.4585s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1015s/iter; left time: 3491.9979s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0962s/iter; left time: 3300.6923s
Epoch: 17 cost time: 41.67897129058838
Epoch: 17, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.308 Vali Acc: 0.980 Test Loss: 0.308 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000002
	speed: 0.2884s/iter; left time: 9855.8524s
	iters: 200, epoch: 18 | loss: 0.0000105
	speed: 0.1012s/iter; left time: 3450.4108s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1043s/iter; left time: 3543.4853s
	iters: 400, epoch: 18 | loss: 0.0000024
	speed: 0.1021s/iter; left time: 3457.9829s
Epoch: 18 cost time: 41.48069190979004
Epoch: 18, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.314 Vali Acc: 0.976 Test Loss: 0.314 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.6597773
	speed: 0.3029s/iter; left time: 10228.2004s
	iters: 200, epoch: 19 | loss: 0.0000002
	speed: 0.0955s/iter; left time: 3214.9362s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0936s/iter; left time: 3143.1376s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0987s/iter; left time: 3304.4587s
Epoch: 19 cost time: 40.72723865509033
Epoch: 19, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.318 Vali Acc: 0.980 Test Loss: 0.318 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000669
	speed: 0.2737s/iter; left time: 9128.0937s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1016s/iter; left time: 3377.5252s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0947s/iter; left time: 3140.5328s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0926s/iter; left time: 3061.5892s
Epoch: 20 cost time: 40.18896675109863
Epoch: 20, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.450 Vali Acc: 0.976 Test Loss: 0.450 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0011901
	speed: 0.2801s/iter; left time: 9227.5849s
	iters: 200, epoch: 21 | loss: 1.1320348
	speed: 0.0931s/iter; left time: 3058.4447s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1186s/iter; left time: 3881.6215s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0978s/iter; left time: 3193.3900s
Epoch: 21 cost time: 42.06123471260071
Epoch: 21, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.285 Vali Acc: 0.979 Test Loss: 0.285 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000006
	speed: 0.3107s/iter; left time: 10107.3248s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0994s/iter; left time: 3222.2071s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 2863.3837s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1236s/iter; left time: 3982.3448s
Epoch: 22 cost time: 44.67164731025696
Epoch: 22, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.812 Vali Acc: 0.975 Test Loss: 0.812 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2548s/iter; left time: 8182.9482s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0800s/iter; left time: 2560.0974s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 3042.5391s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0947s/iter; left time: 3013.0787s
Epoch: 23 cost time: 35.04789066314697
Epoch: 23, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.509 Vali Acc: 0.980 Test Loss: 0.509 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 2106002
model size : 17.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2123577
	speed: 0.1130s/iter; left time: 4656.1959s
	iters: 200, epoch: 1 | loss: 0.0884440
	speed: 0.0902s/iter; left time: 3709.1770s
	iters: 300, epoch: 1 | loss: 0.0266221
	speed: 0.0861s/iter; left time: 3528.7124s
	iters: 400, epoch: 1 | loss: 0.3130318
	speed: 0.0879s/iter; left time: 3594.5758s
Epoch: 1 cost time: 39.221535205841064
Epoch: 1, Steps: 413 | Train Loss: 0.314 Vali Loss: 0.192 Vali Acc: 0.945 Test Loss: 0.192 Test Acc: 0.945
Validation loss decreased (inf --> -0.944518).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0028312
	speed: 0.2734s/iter; left time: 11150.2872s
	iters: 200, epoch: 2 | loss: 0.0005101
	speed: 0.0925s/iter; left time: 3764.6621s
	iters: 300, epoch: 2 | loss: 0.0008787
	speed: 0.1062s/iter; left time: 4310.2572s
	iters: 400, epoch: 2 | loss: 0.0000402
	speed: 0.0943s/iter; left time: 3816.9991s
Epoch: 2 cost time: 40.29449415206909
Epoch: 2, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
Validation loss decreased (-0.944518 --> -0.964528).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000023
	speed: 0.3016s/iter; left time: 12178.4034s
	iters: 200, epoch: 3 | loss: 0.0287534
	speed: 0.0903s/iter; left time: 3635.6404s
	iters: 300, epoch: 3 | loss: 0.0006519
	speed: 0.0877s/iter; left time: 3523.7852s
	iters: 400, epoch: 3 | loss: 0.0000804
	speed: 0.1010s/iter; left time: 4049.2849s
Epoch: 3 cost time: 39.90216374397278
Epoch: 3, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.268 Vali Acc: 0.960 Test Loss: 0.268 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0069525
	speed: 0.2664s/iter; left time: 10647.2742s
	iters: 200, epoch: 4 | loss: 0.5981103
	speed: 0.0989s/iter; left time: 3940.4413s
	iters: 300, epoch: 4 | loss: 0.0000037
	speed: 0.0913s/iter; left time: 3632.0285s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 3641.3123s
Epoch: 4 cost time: 39.08024215698242
Epoch: 4, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.233 Vali Acc: 0.968 Test Loss: 0.233 Test Acc: 0.968
Validation loss decreased (-0.964528 --> -0.967710).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000115
	speed: 0.2702s/iter; left time: 10687.2165s
	iters: 200, epoch: 5 | loss: 0.0000195
	speed: 0.0883s/iter; left time: 3481.5357s
	iters: 300, epoch: 5 | loss: 0.0000011
	speed: 0.0978s/iter; left time: 3849.5318s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0946s/iter; left time: 3714.2259s
Epoch: 5 cost time: 38.7412645816803
Epoch: 5, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.346 Vali Acc: 0.957 Test Loss: 0.346 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000021
	speed: 0.3017s/iter; left time: 11807.6098s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0919s/iter; left time: 3588.9253s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 3357.6378s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0972s/iter; left time: 3775.2582s
Epoch: 6 cost time: 39.63940191268921
Epoch: 6, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.167 Vali Acc: 0.980 Test Loss: 0.167 Test Acc: 0.980
Validation loss decreased (-0.967710 --> -0.979989).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0002383
	speed: 0.2664s/iter; left time: 10314.5801s
	iters: 200, epoch: 7 | loss: 0.0000055
	speed: 0.0922s/iter; left time: 3562.0267s
	iters: 300, epoch: 7 | loss: 0.0247858
	speed: 0.0952s/iter; left time: 3668.1876s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 3377.6204s
Epoch: 7 cost time: 37.93107628822327
Epoch: 7, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.250 Vali Acc: 0.976 Test Loss: 0.250 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.2707s/iter; left time: 10372.2612s
	iters: 200, epoch: 8 | loss: 0.0030227
	speed: 0.0901s/iter; left time: 3442.4616s
	iters: 300, epoch: 8 | loss: 1.5098079
	speed: 0.0912s/iter; left time: 3475.1694s
	iters: 400, epoch: 8 | loss: 0.0308162
	speed: 0.0945s/iter; left time: 3590.9986s
Epoch: 8 cost time: 39.103219509124756
Epoch: 8, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.418 Vali Acc: 0.969 Test Loss: 0.418 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2867s/iter; left time: 10866.0696s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1039s/iter; left time: 3926.5662s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0932s/iter; left time: 3514.3494s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0940s/iter; left time: 3535.6325s
Epoch: 9 cost time: 41.02505540847778
Epoch: 9, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.628 Vali Acc: 0.955 Test Loss: 0.628 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2870s/iter; left time: 10756.9593s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0902s/iter; left time: 3370.7383s
	iters: 300, epoch: 10 | loss: 0.3213055
	speed: 0.0940s/iter; left time: 3505.0569s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0942s/iter; left time: 3502.9327s
Epoch: 10 cost time: 38.04669404029846
Epoch: 10, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.293 Vali Acc: 0.971 Test Loss: 0.293 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2730s/iter; left time: 10122.0938s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0905s/iter; left time: 3345.4177s
	iters: 300, epoch: 11 | loss: 0.0000005
	speed: 0.0881s/iter; left time: 3246.7157s
	iters: 400, epoch: 11 | loss: 1.1950871
	speed: 0.0918s/iter; left time: 3374.2755s
Epoch: 11 cost time: 38.56869053840637
Epoch: 11, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.508 Vali Acc: 0.970 Test Loss: 0.508 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0304641
	speed: 0.2670s/iter; left time: 9785.9808s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0960s/iter; left time: 3509.5453s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0982s/iter; left time: 3578.8847s
	iters: 400, epoch: 12 | loss: 0.0002007
	speed: 0.0891s/iter; left time: 3238.9248s
Epoch: 12 cost time: 38.54487109184265
Epoch: 12, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.488 Vali Acc: 0.968 Test Loss: 0.488 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2926s/iter; left time: 10604.3198s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0920s/iter; left time: 3326.1519s
	iters: 300, epoch: 13 | loss: 1.0391482
	speed: 0.0926s/iter; left time: 3337.5002s
	iters: 400, epoch: 13 | loss: 0.3500612
	speed: 0.0995s/iter; left time: 3577.7816s
Epoch: 13 cost time: 39.955121994018555
Epoch: 13, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.365 Vali Acc: 0.979 Test Loss: 0.365 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2681s/iter; left time: 9608.3366s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 2920.9865s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0696s/iter; left time: 2481.0309s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0872s/iter; left time: 3099.6738s
Epoch: 14 cost time: 34.54237198829651
Epoch: 14, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.272 Vali Acc: 0.983 Test Loss: 0.272 Test Acc: 0.983
Validation loss decreased (-0.979989 --> -0.982717).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2741s/iter; left time: 9710.0480s
	iters: 200, epoch: 15 | loss: 0.0410638
	speed: 0.0960s/iter; left time: 3389.4762s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 3209.8191s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 2928.5569s
Epoch: 15 cost time: 37.95260548591614
Epoch: 15, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.343 Vali Acc: 0.980 Test Loss: 0.343 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.1100132
	speed: 0.2944s/iter; left time: 10305.1967s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0832s/iter; left time: 2903.1878s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0993s/iter; left time: 3456.7523s
	iters: 400, epoch: 16 | loss: 0.1068038
	speed: 0.0980s/iter; left time: 3401.1271s
Epoch: 16 cost time: 38.75550436973572
Epoch: 16, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.616 Vali Acc: 0.968 Test Loss: 0.616 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2810s/iter; left time: 9720.7954s
	iters: 200, epoch: 17 | loss: 0.0002009
	speed: 0.0882s/iter; left time: 3043.4257s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0892s/iter; left time: 3068.7975s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0974s/iter; left time: 3340.9583s
Epoch: 17 cost time: 38.32515048980713
Epoch: 17, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.512 Vali Acc: 0.974 Test Loss: 0.512 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000022
	speed: 0.2806s/iter; left time: 9592.0435s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0916s/iter; left time: 3120.7401s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0899s/iter; left time: 3053.7004s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 3108.9433s
Epoch: 18 cost time: 38.55423140525818
Epoch: 18, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.363 Vali Acc: 0.984 Test Loss: 0.363 Test Acc: 0.984
Validation loss decreased (-0.982717 --> -0.983625).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000014
	speed: 0.2707s/iter; left time: 9140.2964s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1043s/iter; left time: 3511.0527s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0968s/iter; left time: 3249.8810s
	iters: 400, epoch: 19 | loss: 0.0000004
	speed: 0.0935s/iter; left time: 3127.9275s
Epoch: 19 cost time: 40.364707469940186
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.343 Vali Acc: 0.980 Test Loss: 0.343 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0002172
	speed: 0.2931s/iter; left time: 9776.7288s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0934s/iter; left time: 3104.7359s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0898s/iter; left time: 2976.7606s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0960s/iter; left time: 3172.9693s
Epoch: 20 cost time: 38.99536681175232
Epoch: 20, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.403 Vali Acc: 0.978 Test Loss: 0.403 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2703s/iter; left time: 8902.5683s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 2835.6416s
	iters: 300, epoch: 21 | loss: 0.4584999
	speed: 0.0867s/iter; left time: 2838.0928s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 3052.7886s
Epoch: 21 cost time: 37.95665764808655
Epoch: 21, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.423 Vali Acc: 0.975 Test Loss: 0.423 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2760s/iter; left time: 8978.3607s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 2978.0286s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 2804.2183s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0905s/iter; left time: 2915.5102s
Epoch: 22 cost time: 37.646517515182495
Epoch: 22, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.729 Vali Acc: 0.970 Test Loss: 0.729 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2836s/iter; left time: 9106.3177s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0917s/iter; left time: 2934.5012s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1001s/iter; left time: 3195.7820s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.0949s/iter; left time: 3020.0422s
Epoch: 23 cost time: 38.69601368904114
Epoch: 23, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.439 Vali Acc: 0.984 Test Loss: 0.439 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2709s/iter; left time: 8589.4286s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0900s/iter; left time: 2845.0896s
	iters: 300, epoch: 24 | loss: 0.0000002
	speed: 0.0912s/iter; left time: 2873.6835s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0973s/iter; left time: 3055.0521s
Epoch: 24 cost time: 38.85463809967041
Epoch: 24, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.449 Vali Acc: 0.982 Test Loss: 0.449 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0704881
	speed: 0.2658s/iter; left time: 8315.9782s
	iters: 200, epoch: 25 | loss: 3.0319953
	speed: 0.0716s/iter; left time: 2233.8729s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0707s/iter; left time: 2199.1747s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 2857.3683s
Epoch: 25 cost time: 34.503931760787964
Epoch: 25, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.355 Vali Acc: 0.983 Test Loss: 0.355 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2704s/iter; left time: 8347.7888s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0972s/iter; left time: 2990.0078s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 2617.1778s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0840s/iter; left time: 2567.7207s
Epoch: 26 cost time: 37.820716381073
Epoch: 26, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.681 Vali Acc: 0.977 Test Loss: 0.681 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.4859303
	speed: 0.2785s/iter; left time: 8484.1854s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 2455.6593s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0933s/iter; left time: 2822.2002s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0857s/iter; left time: 2584.6156s
Epoch: 27 cost time: 35.71439552307129
Epoch: 27, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.374 Vali Acc: 0.982 Test Loss: 0.374 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2680s/iter; left time: 8053.7977s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0832s/iter; left time: 2491.2337s
	iters: 300, epoch: 28 | loss: 0.0000005
	speed: 0.0864s/iter; left time: 2579.8885s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0901s/iter; left time: 2681.7022s
Epoch: 28 cost time: 36.572283029556274
Epoch: 28, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.702 Vali Acc: 0.974 Test Loss: 0.702 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 2106002
model size : 17.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2174152
	speed: 0.1094s/iter; left time: 4509.0046s
	iters: 200, epoch: 1 | loss: 0.1516565
	speed: 0.1006s/iter; left time: 4134.6896s
	iters: 300, epoch: 1 | loss: 0.0122640
	speed: 0.0921s/iter; left time: 3776.5858s
	iters: 400, epoch: 1 | loss: 0.0583237
	speed: 0.0840s/iter; left time: 3434.0730s
Epoch: 1 cost time: 39.654443979263306
Epoch: 1, Steps: 413 | Train Loss: 0.311 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
Validation loss decreased (inf --> -0.971350).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000535
	speed: 0.2717s/iter; left time: 11082.7835s
	iters: 200, epoch: 2 | loss: 0.0002266
	speed: 0.0845s/iter; left time: 3438.0328s
	iters: 300, epoch: 2 | loss: 0.0090829
	speed: 0.0907s/iter; left time: 3680.2011s
	iters: 400, epoch: 2 | loss: 0.2991731
	speed: 0.0892s/iter; left time: 3613.0000s
Epoch: 2 cost time: 36.50740098953247
Epoch: 2, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000247
	speed: 0.2602s/iter; left time: 10507.1854s
	iters: 200, epoch: 3 | loss: 0.3604841
	speed: 0.0838s/iter; left time: 3374.0628s
	iters: 300, epoch: 3 | loss: 0.0501718
	speed: 0.0866s/iter; left time: 3477.2712s
	iters: 400, epoch: 3 | loss: 0.1660058
	speed: 0.0890s/iter; left time: 3567.3428s
Epoch: 3 cost time: 36.866167068481445
Epoch: 3, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.423 Vali Acc: 0.943 Test Loss: 0.423 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1585597
	speed: 0.2550s/iter; left time: 10192.0345s
	iters: 200, epoch: 4 | loss: 0.0000688
	speed: 0.0901s/iter; left time: 3590.5584s
	iters: 300, epoch: 4 | loss: 0.0000051
	speed: 0.0843s/iter; left time: 3351.2921s
	iters: 400, epoch: 4 | loss: 0.0000056
	speed: 0.0862s/iter; left time: 3416.8835s
Epoch: 4 cost time: 36.110410928726196
Epoch: 4, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.310 Vali Acc: 0.952 Test Loss: 0.310 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.5369009
	speed: 0.2680s/iter; left time: 10599.9262s
	iters: 200, epoch: 5 | loss: 0.0012748
	speed: 0.0896s/iter; left time: 3536.5986s
	iters: 300, epoch: 5 | loss: 0.6549776
	speed: 0.0964s/iter; left time: 3793.2579s
	iters: 400, epoch: 5 | loss: 0.0000015
	speed: 0.0860s/iter; left time: 3376.2606s
Epoch: 5 cost time: 36.47760033607483
Epoch: 5, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.227 Vali Acc: 0.974 Test Loss: 0.227 Test Acc: 0.974
Validation loss decreased (-0.971350 --> -0.974077).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0238654
	speed: 0.2547s/iter; left time: 9967.6008s
	iters: 200, epoch: 6 | loss: 0.0000867
	speed: 0.0840s/iter; left time: 3279.3083s
	iters: 300, epoch: 6 | loss: 0.0002403
	speed: 0.0871s/iter; left time: 3391.4015s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0931s/iter; left time: 3616.6349s
Epoch: 6 cost time: 36.65062594413757
Epoch: 6, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.258 Vali Acc: 0.968 Test Loss: 0.258 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1017564
	speed: 0.2558s/iter; left time: 9905.1460s
	iters: 200, epoch: 7 | loss: 0.0028201
	speed: 0.0907s/iter; left time: 3503.4876s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0890s/iter; left time: 3428.3729s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 3341.9744s
Epoch: 7 cost time: 37.18677282333374
Epoch: 7, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.426 Vali Acc: 0.960 Test Loss: 0.426 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0005179
	speed: 0.2347s/iter; left time: 8990.2891s
	iters: 200, epoch: 8 | loss: 0.0005795
	speed: 0.0994s/iter; left time: 3798.2052s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 3129.7221s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0880s/iter; left time: 3343.2616s
Epoch: 8 cost time: 36.715948820114136
Epoch: 8, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.367 Vali Acc: 0.969 Test Loss: 0.367 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0245787
	speed: 0.2631s/iter; left time: 9972.3108s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0896s/iter; left time: 3388.2352s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1109s/iter; left time: 4178.8398s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0988s/iter; left time: 3715.7577s
Epoch: 9 cost time: 38.63978981971741
Epoch: 9, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.211 Vali Acc: 0.978 Test Loss: 0.211 Test Acc: 0.978
Validation loss decreased (-0.974077 --> -0.978170).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0053523
	speed: 0.2114s/iter; left time: 7924.6431s
	iters: 200, epoch: 10 | loss: 0.0495924
	speed: 0.0838s/iter; left time: 3131.7083s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0909s/iter; left time: 3388.0186s
	iters: 400, epoch: 10 | loss: 0.0001949
	speed: 0.0831s/iter; left time: 3089.5031s
Epoch: 10 cost time: 34.16205859184265
Epoch: 10, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.620 Vali Acc: 0.967 Test Loss: 0.620 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0002153
	speed: 0.2494s/iter; left time: 9245.3059s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0808s/iter; left time: 2985.7457s
	iters: 300, epoch: 11 | loss: 0.0000004
	speed: 0.0834s/iter; left time: 3073.4640s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 3348.5460s
Epoch: 11 cost time: 35.656187295913696
Epoch: 11, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.306 Vali Acc: 0.973 Test Loss: 0.306 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2526s/iter; left time: 9260.0324s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0930s/iter; left time: 3400.2221s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0888s/iter; left time: 3236.9626s
	iters: 400, epoch: 12 | loss: 0.3103324
	speed: 0.0932s/iter; left time: 3389.7898s
Epoch: 12 cost time: 38.146366596221924
Epoch: 12, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.568 Vali Acc: 0.969 Test Loss: 0.568 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2794s/iter; left time: 10127.9273s
	iters: 200, epoch: 13 | loss: 0.0000051
	speed: 0.0996s/iter; left time: 3599.4722s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 3128.7371s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0876s/iter; left time: 3149.1760s
Epoch: 13 cost time: 38.233311891555786
Epoch: 13, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.319 Vali Acc: 0.978 Test Loss: 0.319 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2539s/iter; left time: 9098.9759s
	iters: 200, epoch: 14 | loss: 0.0000013
	speed: 0.0845s/iter; left time: 3018.6555s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0899s/iter; left time: 3202.8648s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0837s/iter; left time: 2973.2370s
Epoch: 14 cost time: 35.728617668151855
Epoch: 14, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.375 Vali Acc: 0.981 Test Loss: 0.375 Test Acc: 0.981
Validation loss decreased (-0.978170 --> -0.980897).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.9933600
	speed: 0.2532s/iter; left time: 8968.0155s
	iters: 200, epoch: 15 | loss: 1.1174195
	speed: 0.0835s/iter; left time: 2949.2807s
	iters: 300, epoch: 15 | loss: 0.0000746
	speed: 0.0862s/iter; left time: 3035.8764s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0954s/iter; left time: 3351.5749s
Epoch: 15 cost time: 36.51398158073425
Epoch: 15, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.686 Vali Acc: 0.970 Test Loss: 0.686 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2785s/iter; left time: 9748.1275s
	iters: 200, epoch: 16 | loss: 0.2146532
	speed: 0.0834s/iter; left time: 2910.7308s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 2772.9602s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0891s/iter; left time: 3091.4809s
Epoch: 16 cost time: 36.430553913116455
Epoch: 16, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.442 Vali Acc: 0.977 Test Loss: 0.442 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2456s/iter; left time: 8496.1128s
	iters: 200, epoch: 17 | loss: 5.9897881
	speed: 0.0892s/iter; left time: 3076.3550s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 2967.0488s
	iters: 400, epoch: 17 | loss: 0.0415064
	speed: 0.0834s/iter; left time: 2860.6141s
Epoch: 17 cost time: 35.62870264053345
Epoch: 17, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.602 Vali Acc: 0.976 Test Loss: 0.602 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2458s/iter; left time: 8399.7888s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 2965.6562s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0891s/iter; left time: 3026.7165s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0854s/iter; left time: 2893.7856s
Epoch: 18 cost time: 36.05793285369873
Epoch: 18, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.462 Vali Acc: 0.978 Test Loss: 0.462 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2653s/iter; left time: 8958.1964s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0844s/iter; left time: 2841.9749s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0890s/iter; left time: 2987.3696s
	iters: 400, epoch: 19 | loss: 0.0451017
	speed: 0.0908s/iter; left time: 3040.3720s
Epoch: 19 cost time: 36.57283568382263
Epoch: 19, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.536 Vali Acc: 0.973 Test Loss: 0.536 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0054655
	speed: 0.2724s/iter; left time: 9084.1467s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0829s/iter; left time: 2756.5407s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0825s/iter; left time: 2736.0402s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 2852.3232s
Epoch: 20 cost time: 35.57406973838806
Epoch: 20, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.429 Vali Acc: 0.978 Test Loss: 0.429 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2446s/iter; left time: 8058.1349s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0884s/iter; left time: 2901.9119s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 2643.2062s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 2723.2922s
Epoch: 21 cost time: 34.94192981719971
Epoch: 21, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.667 Vali Acc: 0.973 Test Loss: 0.667 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2442s/iter; left time: 7943.8187s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 2833.2245s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0944s/iter; left time: 3050.8402s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0858s/iter; left time: 2763.9224s
Epoch: 22 cost time: 36.212414264678955
Epoch: 22, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.656 Vali Acc: 0.975 Test Loss: 0.656 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2761s/iter; left time: 8867.3797s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 2708.8407s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0873s/iter; left time: 2787.2819s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0902s/iter; left time: 2871.1000s
Epoch: 23 cost time: 36.72993230819702
Epoch: 23, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.836 Vali Acc: 0.966 Test Loss: 0.836 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2532s/iter; left time: 8026.5050s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 2731.3179s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 2664.7270s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0905s/iter; left time: 2841.3842s
Epoch: 24 cost time: 36.78697657585144
Epoch: 24, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.575 Vali Acc: 0.978 Test Loss: 0.575 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 2106002
model size : 17.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2056507
	speed: 0.0970s/iter; left time: 3997.7418s
	iters: 200, epoch: 1 | loss: 0.1373236
	speed: 0.0848s/iter; left time: 3487.1395s
	iters: 300, epoch: 1 | loss: 0.0172894
	speed: 0.0958s/iter; left time: 3926.7063s
	iters: 400, epoch: 1 | loss: 0.0179328
	speed: 0.0802s/iter; left time: 3278.4950s
Epoch: 1 cost time: 37.036635875701904
Epoch: 1, Steps: 413 | Train Loss: 0.320 Vali Loss: 0.127 Vali Acc: 0.958 Test Loss: 0.127 Test Acc: 0.958
Validation loss decreased (inf --> -0.958162).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0306794
	speed: 0.2745s/iter; left time: 11197.6693s
	iters: 200, epoch: 2 | loss: 0.0002329
	speed: 0.0828s/iter; left time: 3367.4846s
	iters: 300, epoch: 2 | loss: 0.3284566
	speed: 0.0814s/iter; left time: 3302.4521s
	iters: 400, epoch: 2 | loss: 0.1984312
	speed: 0.0884s/iter; left time: 3580.0316s
Epoch: 2 cost time: 35.879605531692505
Epoch: 2, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
Validation loss decreased (-0.958162 --> -0.960435).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0003436
	speed: 0.2505s/iter; left time: 10112.5013s
	iters: 200, epoch: 3 | loss: 0.0689566
	speed: 0.0865s/iter; left time: 3484.5687s
	iters: 300, epoch: 3 | loss: 0.0064786
	speed: 0.0822s/iter; left time: 3302.5315s
	iters: 400, epoch: 3 | loss: 0.0000400
	speed: 0.0839s/iter; left time: 3362.5672s
Epoch: 3 cost time: 35.386200189590454
Epoch: 3, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
Validation loss decreased (-0.960435 --> -0.972258).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000144
	speed: 0.2507s/iter; left time: 10018.8757s
	iters: 200, epoch: 4 | loss: 0.0009656
	speed: 0.0924s/iter; left time: 3681.4783s
	iters: 300, epoch: 4 | loss: 0.0000001
	speed: 0.0844s/iter; left time: 3356.2927s
	iters: 400, epoch: 4 | loss: 0.0003626
	speed: 0.0825s/iter; left time: 3270.4131s
Epoch: 4 cost time: 35.843135595321655
Epoch: 4, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.284 Vali Acc: 0.960 Test Loss: 0.284 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000180
	speed: 0.2439s/iter; left time: 9645.8232s
	iters: 200, epoch: 5 | loss: 0.0000041
	speed: 0.0999s/iter; left time: 3940.1027s
	iters: 300, epoch: 5 | loss: 0.2015348
	speed: 0.0962s/iter; left time: 3784.6888s
	iters: 400, epoch: 5 | loss: 0.0854548
	speed: 0.0852s/iter; left time: 3343.5240s
Epoch: 5 cost time: 36.70677876472473
Epoch: 5, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.264 Vali Acc: 0.965 Test Loss: 0.264 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2640s/iter; left time: 10332.5899s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 3337.9157s
	iters: 300, epoch: 6 | loss: 0.1277659
	speed: 0.0874s/iter; left time: 3404.0712s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0917s/iter; left time: 3560.1829s
Epoch: 6 cost time: 36.70754837989807
Epoch: 6, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.285 Vali Acc: 0.971 Test Loss: 0.285 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000015
	speed: 0.2596s/iter; left time: 10052.1276s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0892s/iter; left time: 3444.5781s
	iters: 300, epoch: 7 | loss: 0.0000062
	speed: 0.0825s/iter; left time: 3179.0018s
	iters: 400, epoch: 7 | loss: 0.0000025
	speed: 0.0856s/iter; left time: 3288.0425s
Epoch: 7 cost time: 36.34080100059509
Epoch: 7, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.342 Vali Acc: 0.965 Test Loss: 0.342 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2653s/iter; left time: 10164.8891s
	iters: 200, epoch: 8 | loss: 0.0104964
	speed: 0.0927s/iter; left time: 3540.8045s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0952s/iter; left time: 3627.5831s
	iters: 400, epoch: 8 | loss: 0.0000349
	speed: 0.0789s/iter; left time: 2999.9378s
Epoch: 8 cost time: 36.44242596626282
Epoch: 8, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.419 Vali Acc: 0.965 Test Loss: 0.419 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2827s/iter; left time: 10712.1726s
	iters: 200, epoch: 9 | loss: 0.7875856
	speed: 0.0877s/iter; left time: 3313.5729s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 3271.3294s
	iters: 400, epoch: 9 | loss: 0.1002621
	speed: 0.0907s/iter; left time: 3409.5415s
Epoch: 9 cost time: 37.18190932273865
Epoch: 9, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.283 Vali Acc: 0.980 Test Loss: 0.283 Test Acc: 0.980
Validation loss decreased (-0.972258 --> -0.980443).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0009460
	speed: 0.2647s/iter; left time: 9922.5281s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0901s/iter; left time: 3367.3359s
	iters: 300, epoch: 10 | loss: 0.0000006
	speed: 0.0875s/iter; left time: 3262.6994s
	iters: 400, epoch: 10 | loss: 0.0000011
	speed: 0.0877s/iter; left time: 3262.4959s
Epoch: 10 cost time: 37.53534412384033
Epoch: 10, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.445 Vali Acc: 0.978 Test Loss: 0.445 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000046
	speed: 0.2617s/iter; left time: 9701.6100s
	iters: 200, epoch: 11 | loss: 0.0000136
	speed: 0.0921s/iter; left time: 3406.7197s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0892s/iter; left time: 3289.8207s
	iters: 400, epoch: 11 | loss: 0.0002381
	speed: 0.0841s/iter; left time: 3092.9906s
Epoch: 11 cost time: 36.720407485961914
Epoch: 11, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.496 Vali Acc: 0.966 Test Loss: 0.496 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2812s/iter; left time: 10308.3819s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0850s/iter; left time: 3108.7880s
	iters: 300, epoch: 12 | loss: 0.0000003
	speed: 0.0860s/iter; left time: 3135.1810s
	iters: 400, epoch: 12 | loss: 0.0000017
	speed: 0.0911s/iter; left time: 3313.0966s
Epoch: 12 cost time: 36.43215084075928
Epoch: 12, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.416 Vali Acc: 0.973 Test Loss: 0.416 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2532s/iter; left time: 9178.3397s
	iters: 200, epoch: 13 | loss: 0.0000084
	speed: 0.0892s/iter; left time: 3225.0119s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0831s/iter; left time: 2995.7018s
	iters: 400, epoch: 13 | loss: 1.8308809
	speed: 0.0836s/iter; left time: 3003.2814s
Epoch: 13 cost time: 35.94181299209595
Epoch: 13, Steps: 413 | Train Loss: 0.172 Vali Loss: 0.251 Vali Acc: 0.980 Test Loss: 0.251 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2528s/iter; left time: 9059.5524s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0866s/iter; left time: 3093.3603s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0889s/iter; left time: 3166.0626s
	iters: 400, epoch: 14 | loss: 0.4872030
	speed: 0.0828s/iter; left time: 2942.5533s
Epoch: 14 cost time: 35.63887310028076
Epoch: 14, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.575 Vali Acc: 0.968 Test Loss: 0.575 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2869s/iter; left time: 10162.8060s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0840s/iter; left time: 2965.5299s
	iters: 300, epoch: 15 | loss: 0.4039090
	speed: 0.0888s/iter; left time: 3127.2747s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0988s/iter; left time: 3470.2162s
Epoch: 15 cost time: 38.45588660240173
Epoch: 15, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.286 Vali Acc: 0.981 Test Loss: 0.286 Test Acc: 0.981
Validation loss decreased (-0.980443 --> -0.980898).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4900087
	speed: 0.2727s/iter; left time: 9545.1005s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0906s/iter; left time: 3161.9157s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 3006.9021s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 2918.6165s
Epoch: 16 cost time: 36.73107147216797
Epoch: 16, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.433 Vali Acc: 0.978 Test Loss: 0.433 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2559s/iter; left time: 8851.2119s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 3014.1737s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0898s/iter; left time: 3087.0494s
	iters: 400, epoch: 17 | loss: 0.0000126
	speed: 0.0835s/iter; left time: 2862.5778s
Epoch: 17 cost time: 35.635130405426025
Epoch: 17, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.440 Vali Acc: 0.981 Test Loss: 0.440 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2616s/iter; left time: 8943.1703s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 2797.5834s
	iters: 300, epoch: 18 | loss: 0.0000011
	speed: 0.0841s/iter; left time: 2857.2895s
	iters: 400, epoch: 18 | loss: 0.8611482
	speed: 0.0930s/iter; left time: 3151.3696s
Epoch: 18 cost time: 36.599026679992676
Epoch: 18, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.403 Vali Acc: 0.983 Test Loss: 0.403 Test Acc: 0.983
Validation loss decreased (-0.980898 --> -0.983170).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000304
	speed: 0.2719s/iter; left time: 9179.8174s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0916s/iter; left time: 3084.5821s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 2755.3403s
	iters: 400, epoch: 19 | loss: 0.0000593
	speed: 0.0849s/iter; left time: 2842.6108s
Epoch: 19 cost time: 35.91102194786072
Epoch: 19, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.537 Vali Acc: 0.979 Test Loss: 0.537 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000006
	speed: 0.2480s/iter; left time: 8270.9227s
	iters: 200, epoch: 20 | loss: 1.5155991
	speed: 0.0851s/iter; left time: 2829.8419s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0800s/iter; left time: 2650.6768s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0668s/iter; left time: 2207.5043s
Epoch: 20 cost time: 32.8236129283905
Epoch: 20, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.586 Vali Acc: 0.979 Test Loss: 0.586 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2446s/iter; left time: 8058.9006s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 2801.3981s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0900s/iter; left time: 2947.8839s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0939s/iter; left time: 3064.5773s
Epoch: 21 cost time: 36.992409229278564
Epoch: 21, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.563 Vali Acc: 0.977 Test Loss: 0.563 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2900s/iter; left time: 9434.1090s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2523.4152s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 2517.9271s
	iters: 400, epoch: 22 | loss: 0.0852003
	speed: 0.0887s/iter; left time: 2859.2108s
Epoch: 22 cost time: 35.76051092147827
Epoch: 22, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.300 Vali Acc: 0.982 Test Loss: 0.300 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2463s/iter; left time: 7910.6420s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0916s/iter; left time: 2931.4709s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0842s/iter; left time: 2687.8298s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0832s/iter; left time: 2647.0957s
Epoch: 23 cost time: 35.4638454914093
Epoch: 23, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.978 Vali Acc: 0.969 Test Loss: 0.978 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2469s/iter; left time: 7827.2125s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 2702.3521s
	iters: 300, epoch: 24 | loss: 0.0000003
	speed: 0.0879s/iter; left time: 2770.1490s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0836s/iter; left time: 2624.6104s
Epoch: 24 cost time: 35.23314118385315
Epoch: 24, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.755 Vali Acc: 0.970 Test Loss: 0.755 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2660s/iter; left time: 8322.3340s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 2559.7207s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 2733.1064s
	iters: 400, epoch: 25 | loss: 0.9642816
	speed: 0.0965s/iter; left time: 2991.7650s
Epoch: 25 cost time: 36.235559940338135
Epoch: 25, Steps: 413 | Train Loss: 0.076 Vali Loss: 1.036 Vali Acc: 0.969 Test Loss: 1.036 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2795s/iter; left time: 8631.0880s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.1072s/iter; left time: 3298.9021s
	iters: 300, epoch: 26 | loss: 0.0282333
	speed: 0.1072s/iter; left time: 3287.6359s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 1920.8244s
Epoch: 26 cost time: 38.20149612426758
Epoch: 26, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.811 Vali Acc: 0.970 Test Loss: 0.811 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2307s/iter; left time: 7027.2338s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0893s/iter; left time: 2710.6172s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0832s/iter; left time: 2516.4158s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0857s/iter; left time: 2585.3542s
Epoch: 27 cost time: 36.08928918838501
Epoch: 27, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.408 Vali Acc: 0.984 Test Loss: 0.408 Test Acc: 0.984
Validation loss decreased (-0.983170 --> -0.983625).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2541s/iter; left time: 7635.9925s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 2625.2025s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 2550.7957s
	iters: 400, epoch: 28 | loss: 0.1313927
	speed: 0.0839s/iter; left time: 2495.6306s
Epoch: 28 cost time: 35.17905807495117
Epoch: 28, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.670 Vali Acc: 0.980 Test Loss: 0.670 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2514s/iter; left time: 7450.3196s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 2411.8775s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 2714.2907s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0857s/iter; left time: 2514.6324s
Epoch: 29 cost time: 35.298399925231934
Epoch: 29, Steps: 413 | Train Loss: 0.095 Vali Loss: 1.179 Vali Acc: 0.963 Test Loss: 1.179 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2790s/iter; left time: 8152.7377s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 2252.0755s
	iters: 300, epoch: 30 | loss: 0.0002703
	speed: 0.0827s/iter; left time: 2398.8931s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0885s/iter; left time: 2560.8779s
Epoch: 30 cost time: 35.941202878952026
Epoch: 30, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.617 Vali Acc: 0.976 Test Loss: 0.617 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2531s/iter; left time: 7290.6633s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0905s/iter; left time: 2596.9271s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0838s/iter; left time: 2398.0088s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0876s/iter; left time: 2497.6095s
Epoch: 31 cost time: 36.40336036682129
Epoch: 31, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.383 Vali Acc: 0.985 Test Loss: 0.383 Test Acc: 0.985
Validation loss decreased (-0.983625 --> -0.984989).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000904
	speed: 0.2564s/iter; left time: 7280.0395s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0895s/iter; left time: 2533.6570s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0942s/iter; left time: 2655.9311s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 2438.6738s
Epoch: 32 cost time: 37.03958439826965
Epoch: 32, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.458 Vali Acc: 0.987 Test Loss: 0.458 Test Acc: 0.987
Validation loss decreased (-0.984989 --> -0.986808).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.8065502
	speed: 0.2751s/iter; left time: 7697.8959s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0852s/iter; left time: 2375.0634s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 2647.1155s
	iters: 400, epoch: 33 | loss: 0.0000001
	speed: 0.0842s/iter; left time: 2330.2593s
Epoch: 33 cost time: 36.019383668899536
Epoch: 33, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.525 Vali Acc: 0.979 Test Loss: 0.525 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2523s/iter; left time: 6956.9828s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 2224.7174s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0847s/iter; left time: 2317.6803s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0901s/iter; left time: 2456.5659s
Epoch: 34 cost time: 36.09206795692444
Epoch: 34, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.498 Vali Acc: 0.981 Test Loss: 0.498 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2560s/iter; left time: 6951.7254s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 2345.4008s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0820s/iter; left time: 2210.5601s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 2321.9159s
Epoch: 35 cost time: 35.74793314933777
Epoch: 35, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.735 Vali Acc: 0.978 Test Loss: 0.735 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2704s/iter; left time: 7232.9728s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0906s/iter; left time: 2414.5997s
	iters: 300, epoch: 36 | loss: 0.2060455
	speed: 0.0713s/iter; left time: 1893.1458s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 1893.6716s
Epoch: 36 cost time: 32.76602911949158
Epoch: 36, Steps: 413 | Train Loss: 0.132 Vali Loss: 1.630 Vali Acc: 0.969 Test Loss: 1.630 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.2610s/iter; left time: 6872.2182s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0873s/iter; left time: 2289.2560s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0883s/iter; left time: 2307.8025s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0833s/iter; left time: 2169.3306s
Epoch: 37 cost time: 35.85196900367737
Epoch: 37, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.811 Vali Acc: 0.979 Test Loss: 0.811 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2513s/iter; left time: 6514.0554s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0820s/iter; left time: 2118.4208s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0900s/iter; left time: 2314.4781s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0831s/iter; left time: 2127.8855s
Epoch: 38 cost time: 35.2931125164032
Epoch: 38, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.571 Vali Acc: 0.985 Test Loss: 0.571 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2581s/iter; left time: 6583.8788s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0844s/iter; left time: 2144.9469s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0882s/iter; left time: 2231.6777s
	iters: 400, epoch: 39 | loss: 0.0084641
	speed: 0.0929s/iter; left time: 2340.6818s
Epoch: 39 cost time: 36.41241908073425
Epoch: 39, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.908 Vali Acc: 0.971 Test Loss: 0.908 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.2694s/iter; left time: 6760.0471s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0835s/iter; left time: 2087.0648s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0831s/iter; left time: 2068.3543s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0851s/iter; left time: 2109.0549s
Epoch: 40 cost time: 35.44542384147644
Epoch: 40, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.856 Vali Acc: 0.978 Test Loss: 0.856 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.2516s/iter; left time: 6210.1069s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 2121.4230s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0845s/iter; left time: 2069.0338s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 2079.4149s
Epoch: 41 cost time: 35.77086687088013
Epoch: 41, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.840 Vali Acc: 0.977 Test Loss: 0.840 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.1453842
	speed: 0.2535s/iter; left time: 6152.1695s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.1010s/iter; left time: 2441.2310s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0905s/iter; left time: 2178.0063s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 2065.6152s
Epoch: 42 cost time: 37.428231954574585
Epoch: 42, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.711 Vali Acc: 0.982 Test Loss: 0.711 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 2106002
model size : 17.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1337357
	speed: 0.1133s/iter; left time: 4666.2073s
	iters: 200, epoch: 1 | loss: 0.1395783
	speed: 0.0901s/iter; left time: 3705.1685s
	iters: 300, epoch: 1 | loss: 0.0352251
	speed: 0.0895s/iter; left time: 3671.0240s
	iters: 400, epoch: 1 | loss: 0.0026102
	speed: 0.0941s/iter; left time: 3848.9081s
Epoch: 1 cost time: 40.010693073272705
Epoch: 1, Steps: 413 | Train Loss: 0.310 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
Validation loss decreased (inf --> -0.958616).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0079836
	speed: 0.2616s/iter; left time: 10669.0770s
	iters: 200, epoch: 2 | loss: 0.3215718
	speed: 0.0896s/iter; left time: 3646.5316s
	iters: 300, epoch: 2 | loss: 0.3749253
	speed: 0.0874s/iter; left time: 3546.9743s
	iters: 400, epoch: 2 | loss: 0.2982805
	speed: 0.0944s/iter; left time: 3821.8846s
Epoch: 2 cost time: 38.250346183776855
Epoch: 2, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.958616 --> -0.981354).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0043646
	speed: 0.2671s/iter; left time: 10785.0620s
	iters: 200, epoch: 3 | loss: 0.3165274
	speed: 0.0965s/iter; left time: 3885.4926s
	iters: 300, epoch: 3 | loss: 0.0345531
	speed: 0.0842s/iter; left time: 3384.6152s
	iters: 400, epoch: 3 | loss: 0.0000001
	speed: 0.0802s/iter; left time: 3213.0309s
Epoch: 3 cost time: 37.84366750717163
Epoch: 3, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000006
	speed: 0.2568s/iter; left time: 10261.1396s
	iters: 200, epoch: 4 | loss: 0.0733484
	speed: 0.0907s/iter; left time: 3616.9616s
	iters: 300, epoch: 4 | loss: 0.0001372
	speed: 0.0894s/iter; left time: 3552.9155s
	iters: 400, epoch: 4 | loss: 0.0090541
	speed: 0.0904s/iter; left time: 3585.5604s
Epoch: 4 cost time: 37.33356332778931
Epoch: 4, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0003285
	speed: 0.2607s/iter; left time: 10309.9263s
	iters: 200, epoch: 5 | loss: 0.0000057
	speed: 0.0962s/iter; left time: 3794.0882s
	iters: 300, epoch: 5 | loss: 0.0000053
	speed: 0.0910s/iter; left time: 3582.4086s
	iters: 400, epoch: 5 | loss: 0.0432473
	speed: 0.0881s/iter; left time: 3458.7741s
Epoch: 5 cost time: 38.077885150909424
Epoch: 5, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.338 Vali Acc: 0.969 Test Loss: 0.338 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2547s/iter; left time: 9967.6849s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 3584.6411s
	iters: 300, epoch: 6 | loss: 0.0027099
	speed: 0.0931s/iter; left time: 3624.8988s
	iters: 400, epoch: 6 | loss: 0.0001472
	speed: 0.0916s/iter; left time: 3558.9956s
Epoch: 6 cost time: 38.07739734649658
Epoch: 6, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.448 Vali Acc: 0.965 Test Loss: 0.448 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0154216
	speed: 0.2699s/iter; left time: 10452.4803s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0844s/iter; left time: 3259.2109s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0986s/iter; left time: 3799.7181s
	iters: 400, epoch: 7 | loss: 0.5684992
	speed: 0.0849s/iter; left time: 3263.6668s
Epoch: 7 cost time: 37.09668707847595
Epoch: 7, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.233 Vali Acc: 0.968 Test Loss: 0.233 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2537s/iter; left time: 9720.1997s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0852s/iter; left time: 3255.4081s
	iters: 300, epoch: 8 | loss: 0.0007918
	speed: 0.0899s/iter; left time: 3426.3040s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0885s/iter; left time: 3364.3772s
Epoch: 8 cost time: 36.809343338012695
Epoch: 8, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.186 Vali Acc: 0.979 Test Loss: 0.186 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2569s/iter; left time: 9737.5682s
	iters: 200, epoch: 9 | loss: 0.0000607
	speed: 0.0858s/iter; left time: 3242.1838s
	iters: 300, epoch: 9 | loss: 0.0000023
	speed: 0.0858s/iter; left time: 3232.8525s
	iters: 400, epoch: 9 | loss: 1.1051087
	speed: 0.0978s/iter; left time: 3677.6047s
Epoch: 9 cost time: 37.57079720497131
Epoch: 9, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.323 Vali Acc: 0.972 Test Loss: 0.323 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000004
	speed: 0.2763s/iter; left time: 10355.8074s
	iters: 200, epoch: 10 | loss: 0.0000103
	speed: 0.0931s/iter; left time: 3478.7676s
	iters: 300, epoch: 10 | loss: 0.0000083
	speed: 0.0907s/iter; left time: 3381.1356s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0984s/iter; left time: 3658.6075s
Epoch: 10 cost time: 39.3225679397583
Epoch: 10, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.488 Vali Acc: 0.967 Test Loss: 0.488 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2600s/iter; left time: 9638.7137s
	iters: 200, epoch: 11 | loss: 0.0000141
	speed: 0.0926s/iter; left time: 3423.0272s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0883s/iter; left time: 3256.3875s
	iters: 400, epoch: 11 | loss: 0.0000016
	speed: 0.0887s/iter; left time: 3261.7016s
Epoch: 11 cost time: 37.819597244262695
Epoch: 11, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.263 Vali Acc: 0.972 Test Loss: 0.263 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.5363145
	speed: 0.2548s/iter; left time: 9340.1984s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0928s/iter; left time: 3394.1363s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 3205.3475s
	iters: 400, epoch: 12 | loss: 0.0000013
	speed: 0.0853s/iter; left time: 3102.4932s
Epoch: 12 cost time: 36.853323459625244
Epoch: 12, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.265 Vali Acc: 0.980 Test Loss: 0.265 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 1843858
model size : 16.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1204560
	speed: 0.1037s/iter; left time: 4273.5470s
	iters: 200, epoch: 1 | loss: 0.1533103
	speed: 0.0851s/iter; left time: 3495.9989s
	iters: 300, epoch: 1 | loss: 0.1524510
	speed: 0.0920s/iter; left time: 3771.9365s
	iters: 400, epoch: 1 | loss: 0.0000875
	speed: 0.0935s/iter; left time: 3823.3274s
Epoch: 1 cost time: 38.67949080467224
Epoch: 1, Steps: 413 | Train Loss: 0.298 Vali Loss: 0.099 Vali Acc: 0.966 Test Loss: 0.099 Test Acc: 0.966
Validation loss decreased (inf --> -0.965893).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0005167
	speed: 0.2495s/iter; left time: 10174.7377s
	iters: 200, epoch: 2 | loss: 0.0934073
	speed: 0.0828s/iter; left time: 3368.8426s
	iters: 300, epoch: 2 | loss: 0.0954105
	speed: 0.0808s/iter; left time: 3280.3755s
	iters: 400, epoch: 2 | loss: 0.6131598
	speed: 0.0913s/iter; left time: 3696.2771s
Epoch: 2 cost time: 35.87892508506775
Epoch: 2, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.205 Vali Acc: 0.963 Test Loss: 0.205 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0334600
	speed: 0.2489s/iter; left time: 10049.5489s
	iters: 200, epoch: 3 | loss: 0.0002456
	speed: 0.0858s/iter; left time: 3454.6575s
	iters: 300, epoch: 3 | loss: 0.1720821
	speed: 0.0848s/iter; left time: 3405.7833s
	iters: 400, epoch: 3 | loss: 0.0000012
	speed: 0.0850s/iter; left time: 3404.4198s
Epoch: 3 cost time: 35.603203773498535
Epoch: 3, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
Validation loss decreased (-0.965893 --> -0.974078).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0014545
	speed: 0.2720s/iter; left time: 10868.5458s
	iters: 200, epoch: 4 | loss: 0.2728883
	speed: 0.0982s/iter; left time: 3915.0351s
	iters: 300, epoch: 4 | loss: 0.0041762
	speed: 0.0854s/iter; left time: 3394.9363s
	iters: 400, epoch: 4 | loss: 0.4756413
	speed: 0.0882s/iter; left time: 3499.6411s
Epoch: 4 cost time: 37.68752717971802
Epoch: 4, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.266 Vali Acc: 0.965 Test Loss: 0.266 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0042589
	speed: 0.2355s/iter; left time: 9314.2559s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0865s/iter; left time: 3413.4064s
	iters: 300, epoch: 5 | loss: 0.0001255
	speed: 0.0899s/iter; left time: 3537.4771s
	iters: 400, epoch: 5 | loss: 0.0001412
	speed: 0.0852s/iter; left time: 3345.4396s
Epoch: 5 cost time: 33.6531035900116
Epoch: 5, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.346 Vali Acc: 0.960 Test Loss: 0.346 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0087355
	speed: 0.2567s/iter; left time: 10044.6349s
	iters: 200, epoch: 6 | loss: 0.0027144
	speed: 0.0852s/iter; left time: 3325.6725s
	iters: 300, epoch: 6 | loss: 0.0003792
	speed: 0.0894s/iter; left time: 3480.8434s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0920s/iter; left time: 3571.4553s
Epoch: 6 cost time: 36.84516167640686
Epoch: 6, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.308 Vali Acc: 0.967 Test Loss: 0.308 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0020108
	speed: 0.2611s/iter; left time: 10110.4070s
	iters: 200, epoch: 7 | loss: 0.0012484
	speed: 0.0854s/iter; left time: 3297.5184s
	iters: 300, epoch: 7 | loss: 0.0000003
	speed: 0.0884s/iter; left time: 3403.5119s
	iters: 400, epoch: 7 | loss: 0.0000703
	speed: 0.0882s/iter; left time: 3388.0170s
Epoch: 7 cost time: 37.284055948257446
Epoch: 7, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.252 Vali Acc: 0.969 Test Loss: 0.252 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2849s/iter; left time: 10913.4016s
	iters: 200, epoch: 8 | loss: 0.0000055
	speed: 0.1006s/iter; left time: 3844.3058s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0898s/iter; left time: 3420.6880s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0872s/iter; left time: 3313.5255s
Epoch: 8 cost time: 38.601107358932495
Epoch: 8, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.606 Vali Acc: 0.950 Test Loss: 0.606 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2600s/iter; left time: 9853.8536s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0891s/iter; left time: 3369.1626s
	iters: 300, epoch: 9 | loss: 0.0077119
	speed: 0.0922s/iter; left time: 3474.0032s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0932s/iter; left time: 3504.5481s
Epoch: 9 cost time: 37.839449644088745
Epoch: 9, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.327 Vali Acc: 0.970 Test Loss: 0.327 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2555s/iter; left time: 9576.9697s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0871s/iter; left time: 3255.2360s
	iters: 300, epoch: 10 | loss: 0.0000007
	speed: 0.0866s/iter; left time: 3228.5338s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0906s/iter; left time: 3368.3779s
Epoch: 10 cost time: 37.36813735961914
Epoch: 10, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.397 Vali Acc: 0.975 Test Loss: 0.397 Test Acc: 0.975
Validation loss decreased (-0.974078 --> -0.975439).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2819s/iter; left time: 10451.7829s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0979s/iter; left time: 3617.7814s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0882s/iter; left time: 3253.8277s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.0827s/iter; left time: 3039.8585s
Epoch: 11 cost time: 37.48068976402283
Epoch: 11, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.452 Vali Acc: 0.973 Test Loss: 0.452 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2646s/iter; left time: 9699.2282s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0852s/iter; left time: 3113.8925s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0917s/iter; left time: 3342.9714s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0892s/iter; left time: 3243.8577s
Epoch: 12 cost time: 36.559120178222656
Epoch: 12, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.229 Vali Acc: 0.981 Test Loss: 0.229 Test Acc: 0.981
Validation loss decreased (-0.975439 --> -0.980898).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2650s/iter; left time: 9604.4107s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 3159.4375s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 3136.3166s
	iters: 400, epoch: 13 | loss: 2.1092577
	speed: 0.0929s/iter; left time: 3340.5604s
Epoch: 13 cost time: 37.703410148620605
Epoch: 13, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.426 Vali Acc: 0.972 Test Loss: 0.426 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000006
	speed: 0.2701s/iter; left time: 9679.2166s
	iters: 200, epoch: 14 | loss: 0.0020685
	speed: 0.1022s/iter; left time: 3653.1092s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 3286.0730s
	iters: 400, epoch: 14 | loss: 0.0000119
	speed: 0.0833s/iter; left time: 2958.7798s
Epoch: 14 cost time: 38.72016739845276
Epoch: 14, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.381 Vali Acc: 0.979 Test Loss: 0.381 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2812s/iter; left time: 9960.2106s
	iters: 200, epoch: 15 | loss: 0.1816958
	speed: 0.0875s/iter; left time: 3089.7047s
	iters: 300, epoch: 15 | loss: 0.0071486
	speed: 0.0905s/iter; left time: 3188.6317s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0901s/iter; left time: 3164.8310s
Epoch: 15 cost time: 37.46356964111328
Epoch: 15, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.463 Vali Acc: 0.975 Test Loss: 0.463 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000261
	speed: 0.2613s/iter; left time: 9147.6925s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 3017.5289s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0832s/iter; left time: 2896.6037s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0905s/iter; left time: 3141.3633s
Epoch: 16 cost time: 37.0607373714447
Epoch: 16, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.370 Vali Acc: 0.976 Test Loss: 0.370 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2467s/iter; left time: 8532.8211s
	iters: 200, epoch: 17 | loss: 0.0005194
	speed: 0.0921s/iter; left time: 3176.1982s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 2910.7069s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0837s/iter; left time: 2870.0233s
Epoch: 17 cost time: 36.0120325088501
Epoch: 17, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.323 Vali Acc: 0.984 Test Loss: 0.323 Test Acc: 0.984
Validation loss decreased (-0.980898 --> -0.983626).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0263125
	speed: 0.2736s/iter; left time: 9352.1628s
	iters: 200, epoch: 18 | loss: 0.0000004
	speed: 0.0818s/iter; left time: 2786.1730s
	iters: 300, epoch: 18 | loss: 0.5344824
	speed: 0.0904s/iter; left time: 3071.8697s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0957s/iter; left time: 3242.4798s
Epoch: 18 cost time: 36.49470400810242
Epoch: 18, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.619 Vali Acc: 0.975 Test Loss: 0.619 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2565s/iter; left time: 8661.4129s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 3008.7303s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 2896.0944s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0875s/iter; left time: 2928.5696s
Epoch: 19 cost time: 37.254891872406006
Epoch: 19, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.387 Vali Acc: 0.982 Test Loss: 0.387 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2541s/iter; left time: 8473.8914s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0890s/iter; left time: 2958.4762s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0912s/iter; left time: 3025.0087s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 2870.2451s
Epoch: 20 cost time: 36.86314630508423
Epoch: 20, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.567 Vali Acc: 0.977 Test Loss: 0.567 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2705s/iter; left time: 8911.2947s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0802s/iter; left time: 2634.7102s
	iters: 300, epoch: 21 | loss: 0.9833620
	speed: 0.0853s/iter; left time: 2792.0464s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1012s/iter; left time: 3304.8114s
Epoch: 21 cost time: 37.09263491630554
Epoch: 21, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.372 Vali Acc: 0.982 Test Loss: 0.372 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.1224957
	speed: 0.2724s/iter; left time: 8859.6677s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 2816.3333s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0823s/iter; left time: 2660.9370s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 2797.8833s
Epoch: 22 cost time: 36.06193733215332
Epoch: 22, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.372 Vali Acc: 0.979 Test Loss: 0.372 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2525s/iter; left time: 8107.9462s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 2797.2013s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0892s/iter; left time: 2847.6047s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 2652.8942s
Epoch: 23 cost time: 35.74590492248535
Epoch: 23, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.231 Vali Acc: 0.986 Test Loss: 0.231 Test Acc: 0.986
Validation loss decreased (-0.983626 --> -0.985900).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2549s/iter; left time: 8080.3329s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0837s/iter; left time: 2644.2140s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0896s/iter; left time: 2823.9507s
	iters: 400, epoch: 24 | loss: 0.0000102
	speed: 0.1029s/iter; left time: 3229.8918s
Epoch: 24 cost time: 37.69460439682007
Epoch: 24, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.957 Vali Acc: 0.966 Test Loss: 0.957 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2797s/iter; left time: 8750.5212s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0975s/iter; left time: 3039.5190s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0783s/iter; left time: 2434.8725s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0872s/iter; left time: 2701.0508s
Epoch: 25 cost time: 37.207043170928955
Epoch: 25, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.486 Vali Acc: 0.979 Test Loss: 0.486 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2086s/iter; left time: 6441.6461s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0878s/iter; left time: 2702.3583s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 2688.8237s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0826s/iter; left time: 2526.1496s
Epoch: 26 cost time: 33.87109017372131
Epoch: 26, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.557 Vali Acc: 0.980 Test Loss: 0.557 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2497s/iter; left time: 7606.4861s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 2485.7881s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0934s/iter; left time: 2826.2762s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 2552.2007s
Epoch: 27 cost time: 35.961719036102295
Epoch: 27, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.534 Vali Acc: 0.981 Test Loss: 0.534 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2753s/iter; left time: 8273.9470s
	iters: 200, epoch: 28 | loss: 0.0000014
	speed: 0.0839s/iter; left time: 2512.7616s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0814s/iter; left time: 2429.6917s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0980s/iter; left time: 2916.7910s
Epoch: 28 cost time: 37.200679540634155
Epoch: 28, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.310 Vali Acc: 0.981 Test Loss: 0.310 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2606s/iter; left time: 7722.3866s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0905s/iter; left time: 2673.3302s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0826s/iter; left time: 2432.5647s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 2426.3094s
Epoch: 29 cost time: 35.83316230773926
Epoch: 29, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.707 Vali Acc: 0.975 Test Loss: 0.707 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2596s/iter; left time: 7585.6453s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 2604.2580s
	iters: 300, epoch: 30 | loss: 0.0000001
	speed: 0.0924s/iter; left time: 2680.6253s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0858s/iter; left time: 2480.9750s
Epoch: 30 cost time: 37.08369064331055
Epoch: 30, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.782 Vali Acc: 0.975 Test Loss: 0.782 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2583s/iter; left time: 7442.2975s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0903s/iter; left time: 2591.3948s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0962s/iter; left time: 2752.6724s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0934s/iter; left time: 2662.7465s
Epoch: 31 cost time: 38.47538137435913
Epoch: 31, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.666 Vali Acc: 0.974 Test Loss: 0.666 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2828s/iter; left time: 8031.3346s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0829s/iter; left time: 2344.8744s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0813s/iter; left time: 2293.1685s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 2591.0870s
Epoch: 32 cost time: 37.20206046104431
Epoch: 32, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.530 Vali Acc: 0.980 Test Loss: 0.530 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0007293
	speed: 0.2570s/iter; left time: 7191.8832s
	iters: 200, epoch: 33 | loss: 1.8681710
	speed: 0.0883s/iter; left time: 2462.9855s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 2337.4141s
	iters: 400, epoch: 33 | loss: 0.0000002
	speed: 0.0853s/iter; left time: 2361.6130s
Epoch: 33 cost time: 36.3317551612854
Epoch: 33, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.505 Vali Acc: 0.983 Test Loss: 0.505 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 1843858
model size : 16.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1016351
	speed: 0.1025s/iter; left time: 4223.4599s
	iters: 200, epoch: 1 | loss: 0.1435932
	speed: 0.0776s/iter; left time: 3188.7691s
	iters: 300, epoch: 1 | loss: 0.0264625
	speed: 0.0900s/iter; left time: 3688.7674s
	iters: 400, epoch: 1 | loss: 0.0007147
	speed: 0.0948s/iter; left time: 3879.0639s
Epoch: 1 cost time: 37.77127504348755
Epoch: 1, Steps: 413 | Train Loss: 0.290 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (inf --> -0.977716).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0044459
	speed: 0.2828s/iter; left time: 11536.4894s
	iters: 200, epoch: 2 | loss: 0.0004000
	speed: 0.0880s/iter; left time: 3582.3132s
	iters: 300, epoch: 2 | loss: 0.0676021
	speed: 0.0847s/iter; left time: 3437.2383s
	iters: 400, epoch: 2 | loss: 0.0424044
	speed: 0.0893s/iter; left time: 3616.8297s
Epoch: 2 cost time: 37.342806339263916
Epoch: 2, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000384
	speed: 0.2546s/iter; left time: 10277.6506s
	iters: 200, epoch: 3 | loss: 0.0716052
	speed: 0.0901s/iter; left time: 3629.4713s
	iters: 300, epoch: 3 | loss: 0.4806937
	speed: 0.0868s/iter; left time: 3485.9649s
	iters: 400, epoch: 3 | loss: 0.0006397
	speed: 0.0867s/iter; left time: 3476.1448s
Epoch: 3 cost time: 36.97615361213684
Epoch: 3, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.455 Vali Acc: 0.936 Test Loss: 0.455 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0015559
	speed: 0.2513s/iter; left time: 10040.5102s
	iters: 200, epoch: 4 | loss: 0.0000128
	speed: 0.0869s/iter; left time: 3465.9549s
	iters: 300, epoch: 4 | loss: 0.0039456
	speed: 0.0913s/iter; left time: 3630.9755s
	iters: 400, epoch: 4 | loss: 0.0199502
	speed: 0.0832s/iter; left time: 3298.8909s
Epoch: 4 cost time: 35.99405813217163
Epoch: 4, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.300 Vali Acc: 0.961 Test Loss: 0.300 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.2212507
	speed: 0.2687s/iter; left time: 10628.3849s
	iters: 200, epoch: 5 | loss: 0.0001585
	speed: 0.0828s/iter; left time: 3268.1476s
	iters: 300, epoch: 5 | loss: 0.0003666
	speed: 0.0877s/iter; left time: 3449.9417s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 3448.7240s
Epoch: 5 cost time: 35.37253522872925
Epoch: 5, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.242 Vali Acc: 0.970 Test Loss: 0.242 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000173
	speed: 0.2593s/iter; left time: 10146.2419s
	iters: 200, epoch: 6 | loss: 0.0000120
	speed: 0.0827s/iter; left time: 3226.4718s
	iters: 300, epoch: 6 | loss: 0.0000070
	speed: 0.0813s/iter; left time: 3165.1304s
	iters: 400, epoch: 6 | loss: 0.0000008
	speed: 0.0875s/iter; left time: 3400.0501s
Epoch: 6 cost time: 35.864381074905396
Epoch: 6, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.281 Vali Acc: 0.973 Test Loss: 0.281 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.1595589
	speed: 0.2645s/iter; left time: 10242.5978s
	iters: 200, epoch: 7 | loss: 0.0000013
	speed: 0.0905s/iter; left time: 3496.2460s
	iters: 300, epoch: 7 | loss: 0.0000027
	speed: 0.0870s/iter; left time: 3352.7656s
	iters: 400, epoch: 7 | loss: 0.0001430
	speed: 0.0875s/iter; left time: 3361.8398s
Epoch: 7 cost time: 37.1474769115448
Epoch: 7, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.349 Vali Acc: 0.970 Test Loss: 0.349 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0002384
	speed: 0.2806s/iter; left time: 10748.4766s
	iters: 200, epoch: 8 | loss: 0.0000002
	speed: 0.0938s/iter; left time: 3585.8034s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0958s/iter; left time: 3650.0387s
	iters: 400, epoch: 8 | loss: 0.6996070
	speed: 0.0890s/iter; left time: 3382.7797s
Epoch: 8 cost time: 38.285863399505615
Epoch: 8, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.444 Vali Acc: 0.954 Test Loss: 0.444 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000003
	speed: 0.2660s/iter; left time: 10081.5200s
	iters: 200, epoch: 9 | loss: 0.0066647
	speed: 0.0838s/iter; left time: 3167.6725s
	iters: 300, epoch: 9 | loss: 0.0013996
	speed: 0.0923s/iter; left time: 3478.3423s
	iters: 400, epoch: 9 | loss: 0.5404053
	speed: 0.0868s/iter; left time: 3261.8394s
Epoch: 9 cost time: 36.297585010528564
Epoch: 9, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.316 Vali Acc: 0.975 Test Loss: 0.316 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2586s/iter; left time: 9694.9289s
	iters: 200, epoch: 10 | loss: 0.0000003
	speed: 0.0836s/iter; left time: 3125.2480s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0851s/iter; left time: 3174.0688s
	iters: 400, epoch: 10 | loss: 0.0398991
	speed: 0.0895s/iter; left time: 3326.5805s
Epoch: 10 cost time: 36.00351524353027
Epoch: 10, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.478 Vali Acc: 0.966 Test Loss: 0.478 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0008362
	speed: 0.2764s/iter; left time: 10244.6084s
	iters: 200, epoch: 11 | loss: 0.0027808
	speed: 0.0818s/iter; left time: 3025.9420s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0826s/iter; left time: 3046.3162s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0866s/iter; left time: 3186.1360s
Epoch: 11 cost time: 36.33784890174866
Epoch: 11, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.501 Vali Acc: 0.975 Test Loss: 0.501 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 1843858
model size : 16.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1171376
	speed: 0.1011s/iter; left time: 4166.4687s
	iters: 200, epoch: 1 | loss: 0.0824472
	speed: 0.0837s/iter; left time: 3440.6273s
	iters: 300, epoch: 1 | loss: 0.0077668
	speed: 0.0902s/iter; left time: 3698.2149s
	iters: 400, epoch: 1 | loss: 0.0019922
	speed: 0.0791s/iter; left time: 3235.3474s
Epoch: 1 cost time: 36.66508507728577
Epoch: 1, Steps: 413 | Train Loss: 0.299 Vali Loss: 0.059 Vali Acc: 0.981 Test Loss: 0.059 Test Acc: 0.981
Validation loss decreased (inf --> -0.981355).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1914882
	speed: 0.2518s/iter; left time: 10271.2476s
	iters: 200, epoch: 2 | loss: 0.0732204
	speed: 0.0844s/iter; left time: 3435.0640s
	iters: 300, epoch: 2 | loss: 0.1276667
	speed: 0.0877s/iter; left time: 3561.0153s
	iters: 400, epoch: 2 | loss: 0.1486750
	speed: 0.0874s/iter; left time: 3537.9130s
Epoch: 2 cost time: 36.14125156402588
Epoch: 2, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.296 Vali Acc: 0.952 Test Loss: 0.296 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0001022
	speed: 0.2606s/iter; left time: 10523.7069s
	iters: 200, epoch: 3 | loss: 0.2658461
	speed: 0.0839s/iter; left time: 3379.6651s
	iters: 300, epoch: 3 | loss: 0.0162113
	speed: 0.0792s/iter; left time: 3183.5204s
	iters: 400, epoch: 3 | loss: 0.9559775
	speed: 0.0847s/iter; left time: 3392.8114s
Epoch: 3 cost time: 36.01125764846802
Epoch: 3, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000038
	speed: 0.2754s/iter; left time: 11006.4761s
	iters: 200, epoch: 4 | loss: 0.8143184
	speed: 0.0877s/iter; left time: 3494.2144s
	iters: 300, epoch: 4 | loss: 0.3769012
	speed: 0.0805s/iter; left time: 3200.6463s
	iters: 400, epoch: 4 | loss: 0.0011249
	speed: 0.0800s/iter; left time: 3174.1443s
Epoch: 4 cost time: 35.04911661148071
Epoch: 4, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.221 Vali Acc: 0.980 Test Loss: 0.221 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0000135
	speed: 0.2206s/iter; left time: 8725.5660s
	iters: 200, epoch: 5 | loss: 0.0335431
	speed: 0.0893s/iter; left time: 3522.3287s
	iters: 300, epoch: 5 | loss: 0.0000028
	speed: 0.0816s/iter; left time: 3211.2532s
	iters: 400, epoch: 5 | loss: 0.0000005
	speed: 0.0797s/iter; left time: 3126.3538s
Epoch: 5 cost time: 33.36350965499878
Epoch: 5, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.213 Vali Acc: 0.973 Test Loss: 0.213 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2468s/iter; left time: 9659.9486s
	iters: 200, epoch: 6 | loss: 0.0000004
	speed: 0.0842s/iter; left time: 3288.5829s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0937s/iter; left time: 3650.2313s
	iters: 400, epoch: 6 | loss: 0.0000002
	speed: 0.0782s/iter; left time: 3036.9476s
Epoch: 6 cost time: 34.84073877334595
Epoch: 6, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.274 Vali Acc: 0.972 Test Loss: 0.274 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000310
	speed: 0.2740s/iter; left time: 10608.7826s
	iters: 200, epoch: 7 | loss: 0.1531352
	speed: 0.0855s/iter; left time: 3301.3258s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0823s/iter; left time: 3171.8768s
	iters: 400, epoch: 7 | loss: 0.0000521
	speed: 0.0886s/iter; left time: 3402.8687s
Epoch: 7 cost time: 36.18087601661682
Epoch: 7, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.357 Vali Acc: 0.965 Test Loss: 0.357 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2514s/iter; left time: 9631.8320s
	iters: 200, epoch: 8 | loss: 0.1015284
	speed: 0.0837s/iter; left time: 3197.4005s
	iters: 300, epoch: 8 | loss: 0.2808869
	speed: 0.0816s/iter; left time: 3108.6584s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0858s/iter; left time: 3260.0809s
Epoch: 8 cost time: 35.74376845359802
Epoch: 8, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.642 Vali Acc: 0.960 Test Loss: 0.642 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2489s/iter; left time: 9433.0652s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0844s/iter; left time: 3190.4485s
	iters: 300, epoch: 9 | loss: 0.0000021
	speed: 0.0752s/iter; left time: 2834.2578s
	iters: 400, epoch: 9 | loss: 0.0000144
	speed: 0.0781s/iter; left time: 2936.4370s
Epoch: 9 cost time: 33.84473538398743
Epoch: 9, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.519 Vali Acc: 0.969 Test Loss: 0.519 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000008
	speed: 0.2653s/iter; left time: 9943.7556s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 3343.4342s
	iters: 300, epoch: 10 | loss: 0.0000642
	speed: 0.0834s/iter; left time: 3109.7509s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 2673.8601s
Epoch: 10 cost time: 33.553155183792114
Epoch: 10, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.745 Vali Acc: 0.957 Test Loss: 0.745 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2567s/iter; left time: 9514.5005s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 2938.8282s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0876s/iter; left time: 3228.6595s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0818s/iter; left time: 3008.2233s
Epoch: 11 cost time: 34.294925689697266
Epoch: 11, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.522 Vali Acc: 0.973 Test Loss: 0.522 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 1843858
model size : 16.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2121018
	speed: 0.1155s/iter; left time: 4759.1240s
	iters: 200, epoch: 1 | loss: 0.1137640
	speed: 0.0911s/iter; left time: 3743.0799s
	iters: 300, epoch: 1 | loss: 0.0142783
	speed: 0.0872s/iter; left time: 3575.2369s
	iters: 400, epoch: 1 | loss: 0.1589442
	speed: 0.1024s/iter; left time: 4187.8927s
Epoch: 1 cost time: 41.16047763824463
Epoch: 1, Steps: 413 | Train Loss: 0.300 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0002355
	speed: 0.2791s/iter; left time: 11385.2765s
	iters: 200, epoch: 2 | loss: 0.0098677
	speed: 0.1022s/iter; left time: 4159.9581s
	iters: 300, epoch: 2 | loss: 0.0039508
	speed: 0.0876s/iter; left time: 3554.7982s
	iters: 400, epoch: 2 | loss: 0.0021275
	speed: 0.0820s/iter; left time: 3320.9539s
Epoch: 2 cost time: 37.747894048690796
Epoch: 2, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.226 Vali Acc: 0.956 Test Loss: 0.226 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0056784
	speed: 0.2703s/iter; left time: 10913.7346s
	iters: 200, epoch: 3 | loss: 0.0000018
	speed: 0.0863s/iter; left time: 3473.8793s
	iters: 300, epoch: 3 | loss: 0.0011955
	speed: 0.0630s/iter; left time: 2531.1791s
	iters: 400, epoch: 3 | loss: 0.0095054
	speed: 0.0556s/iter; left time: 2227.4658s
Epoch: 3 cost time: 32.64217972755432
Epoch: 3, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.165 Vali Acc: 0.968 Test Loss: 0.165 Test Acc: 0.968
Validation loss decreased (-0.962709 --> -0.968166).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0003573
	speed: 0.2400s/iter; left time: 9589.4331s
	iters: 200, epoch: 4 | loss: 0.0011982
	speed: 0.0870s/iter; left time: 3468.4440s
	iters: 300, epoch: 4 | loss: 0.0607574
	speed: 0.0935s/iter; left time: 3715.9979s
	iters: 400, epoch: 4 | loss: 0.0000073
	speed: 0.0877s/iter; left time: 3477.0644s
Epoch: 4 cost time: 36.837881326675415
Epoch: 4, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.257 Vali Acc: 0.964 Test Loss: 0.257 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0015646
	speed: 0.2531s/iter; left time: 10011.4445s
	iters: 200, epoch: 5 | loss: 0.2314540
	speed: 0.0863s/iter; left time: 3406.3015s
	iters: 300, epoch: 5 | loss: 0.0000001
	speed: 0.0902s/iter; left time: 3549.1908s
	iters: 400, epoch: 5 | loss: 0.0325199
	speed: 0.0910s/iter; left time: 3571.7755s
Epoch: 5 cost time: 37.04481291770935
Epoch: 5, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.254 Vali Acc: 0.973 Test Loss: 0.254 Test Acc: 0.973
Validation loss decreased (-0.968166 --> -0.972712).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000007
	speed: 0.2800s/iter; left time: 10957.2339s
	iters: 200, epoch: 6 | loss: 0.3007855
	speed: 0.0896s/iter; left time: 3499.4263s
	iters: 300, epoch: 6 | loss: 0.0007509
	speed: 0.0874s/iter; left time: 3403.6629s
	iters: 400, epoch: 6 | loss: 0.0001545
	speed: 0.1022s/iter; left time: 3970.4401s
Epoch: 6 cost time: 39.75209188461304
Epoch: 6, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.329 Vali Acc: 0.971 Test Loss: 0.329 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000858
	speed: 0.2793s/iter; left time: 10814.5115s
	iters: 200, epoch: 7 | loss: 0.0000024
	speed: 0.0900s/iter; left time: 3475.1232s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0889s/iter; left time: 3424.7674s
	iters: 400, epoch: 7 | loss: 0.0000002
	speed: 0.0931s/iter; left time: 3576.5705s
Epoch: 7 cost time: 38.50301480293274
Epoch: 7, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.288 Vali Acc: 0.974 Test Loss: 0.288 Test Acc: 0.974
Validation loss decreased (-0.972712 --> -0.974076).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0081885
	speed: 0.2573s/iter; left time: 9858.1549s
	iters: 200, epoch: 8 | loss: 0.2627631
	speed: 0.0905s/iter; left time: 3456.7715s
	iters: 300, epoch: 8 | loss: 1.0057828
	speed: 0.0843s/iter; left time: 3212.7110s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0897s/iter; left time: 3410.8165s
Epoch: 8 cost time: 37.21416354179382
Epoch: 8, Steps: 413 | Train Loss: 0.157 Vali Loss: 0.178 Vali Acc: 0.981 Test Loss: 0.178 Test Acc: 0.981
Validation loss decreased (-0.974076 --> -0.981353).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2552s/iter; left time: 9671.8968s
	iters: 200, epoch: 9 | loss: 0.0000003
	speed: 0.0983s/iter; left time: 3715.5549s
	iters: 300, epoch: 9 | loss: 0.0000146
	speed: 0.0863s/iter; left time: 3254.8705s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0804s/iter; left time: 3022.8718s
Epoch: 9 cost time: 36.70158910751343
Epoch: 9, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.232 Vali Acc: 0.979 Test Loss: 0.232 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000012
	speed: 0.2737s/iter; left time: 10258.6103s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0844s/iter; left time: 3154.5168s
	iters: 300, epoch: 10 | loss: 0.0000005
	speed: 0.0944s/iter; left time: 3521.1369s
	iters: 400, epoch: 10 | loss: 0.7510848
	speed: 0.0856s/iter; left time: 3182.0025s
Epoch: 10 cost time: 36.65191292762756
Epoch: 10, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.435 Vali Acc: 0.970 Test Loss: 0.435 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2286676
	speed: 0.2559s/iter; left time: 9487.9007s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 3203.6872s
	iters: 300, epoch: 11 | loss: 0.0000098
	speed: 0.0910s/iter; left time: 3354.6155s
	iters: 400, epoch: 11 | loss: 0.4238417
	speed: 0.0900s/iter; left time: 3308.1789s
Epoch: 11 cost time: 37.12893509864807
Epoch: 11, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.240 Vali Acc: 0.980 Test Loss: 0.240 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2514s/iter; left time: 9214.5147s
	iters: 200, epoch: 12 | loss: 3.3917696
	speed: 0.0795s/iter; left time: 2908.0302s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0820s/iter; left time: 2989.0590s
	iters: 400, epoch: 12 | loss: 0.0000013
	speed: 0.0986s/iter; left time: 3584.4522s
Epoch: 12 cost time: 36.84755849838257
Epoch: 12, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.451 Vali Acc: 0.975 Test Loss: 0.451 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.2850s/iter; left time: 10328.3860s
	iters: 200, epoch: 13 | loss: 0.0829123
	speed: 0.0915s/iter; left time: 3306.4282s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0916s/iter; left time: 3302.8840s
	iters: 400, epoch: 13 | loss: 0.0000388
	speed: 0.0913s/iter; left time: 3283.0672s
Epoch: 13 cost time: 39.774447202682495
Epoch: 13, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.507 Vali Acc: 0.970 Test Loss: 0.507 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000124
	speed: 0.2545s/iter; left time: 9120.8445s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0949s/iter; left time: 3389.4736s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0885s/iter; left time: 3152.3531s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0932s/iter; left time: 3310.7074s
Epoch: 14 cost time: 38.334903955459595
Epoch: 14, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.640 Vali Acc: 0.971 Test Loss: 0.640 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2546s/iter; left time: 9019.2323s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 3301.8288s
	iters: 300, epoch: 15 | loss: 0.0000018
	speed: 0.0883s/iter; left time: 3108.6921s
	iters: 400, epoch: 15 | loss: 0.0011584
	speed: 0.0843s/iter; left time: 2960.4115s
Epoch: 15 cost time: 36.56573843955994
Epoch: 15, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.452 Vali Acc: 0.977 Test Loss: 0.452 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2765s/iter; left time: 9679.4481s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 2876.1874s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0987s/iter; left time: 3434.9991s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 3011.6166s
Epoch: 16 cost time: 36.86897015571594
Epoch: 16, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.716 Vali Acc: 0.967 Test Loss: 0.716 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2647s/iter; left time: 9156.5971s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0849s/iter; left time: 2928.2092s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0909s/iter; left time: 3125.8910s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0906s/iter; left time: 3105.9841s
Epoch: 17 cost time: 37.048471450805664
Epoch: 17, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.600 Vali Acc: 0.972 Test Loss: 0.600 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.2743899
	speed: 0.2563s/iter; left time: 8761.5293s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0895s/iter; left time: 3050.4142s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0901s/iter; left time: 3062.5387s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0980s/iter; left time: 3320.7191s
Epoch: 18 cost time: 38.57843470573425
Epoch: 18, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.645 Vali Acc: 0.971 Test Loss: 0.645 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 1712786
model size : 16.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1687886
	speed: 0.1067s/iter; left time: 4396.7795s
	iters: 200, epoch: 1 | loss: 0.0770099
	speed: 0.0969s/iter; left time: 3982.4430s
	iters: 300, epoch: 1 | loss: 0.0166984
	speed: 0.0892s/iter; left time: 3656.4255s
	iters: 400, epoch: 1 | loss: 0.8111341
	speed: 0.0884s/iter; left time: 3615.7786s
Epoch: 1 cost time: 39.420042514801025
Epoch: 1, Steps: 413 | Train Loss: 0.305 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (inf --> -0.961799).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0002332
	speed: 0.2600s/iter; left time: 10605.6578s
	iters: 200, epoch: 2 | loss: 0.0000610
	speed: 0.0817s/iter; left time: 3325.2066s
	iters: 300, epoch: 2 | loss: 0.0055831
	speed: 0.0717s/iter; left time: 2909.6929s
	iters: 400, epoch: 2 | loss: 0.0303194
	speed: 0.0648s/iter; left time: 2622.2050s
Epoch: 2 cost time: 31.3595232963562
Epoch: 2, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.200 Vali Acc: 0.960 Test Loss: 0.200 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3703483
	speed: 0.2382s/iter; left time: 9615.4803s
	iters: 200, epoch: 3 | loss: 0.0005228
	speed: 0.0823s/iter; left time: 3313.0894s
	iters: 300, epoch: 3 | loss: 0.0009298
	speed: 0.0895s/iter; left time: 3597.5461s
	iters: 400, epoch: 3 | loss: 0.0000618
	speed: 0.0799s/iter; left time: 3203.0088s
Epoch: 3 cost time: 34.36667275428772
Epoch: 3, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
Validation loss decreased (-0.961799 --> -0.967256).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0011861
	speed: 0.2564s/iter; left time: 10244.6253s
	iters: 200, epoch: 4 | loss: 0.0039018
	speed: 0.0810s/iter; left time: 3230.7763s
	iters: 300, epoch: 4 | loss: 0.0347064
	speed: 0.0866s/iter; left time: 3442.7475s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 3479.1016s
Epoch: 4 cost time: 35.082006216049194
Epoch: 4, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.173 Vali Acc: 0.969 Test Loss: 0.173 Test Acc: 0.969
Validation loss decreased (-0.967256 --> -0.969075).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000002
	speed: 0.2754s/iter; left time: 10891.8999s
	iters: 200, epoch: 5 | loss: 0.0000008
	speed: 0.0817s/iter; left time: 3223.0615s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0830s/iter; left time: 3266.9257s
	iters: 400, epoch: 5 | loss: 0.0086554
	speed: 0.0904s/iter; left time: 3546.8965s
Epoch: 5 cost time: 36.419658184051514
Epoch: 5, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.247 Vali Acc: 0.973 Test Loss: 0.247 Test Acc: 0.973
Validation loss decreased (-0.969075 --> -0.972712).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0003527
	speed: 0.2516s/iter; left time: 9845.0728s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 3367.3346s
	iters: 300, epoch: 6 | loss: 0.0000052
	speed: 0.0844s/iter; left time: 3286.5070s
	iters: 400, epoch: 6 | loss: 0.5998643
	speed: 0.0859s/iter; left time: 3336.9744s
Epoch: 6 cost time: 36.23215079307556
Epoch: 6, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.432 Vali Acc: 0.961 Test Loss: 0.432 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0026753
	speed: 0.2481s/iter; left time: 9606.0950s
	iters: 200, epoch: 7 | loss: 0.0031532
	speed: 0.0868s/iter; left time: 3351.0767s
	iters: 300, epoch: 7 | loss: 0.0111739
	speed: 0.0787s/iter; left time: 3032.0900s
	iters: 400, epoch: 7 | loss: 0.0423560
	speed: 0.0802s/iter; left time: 3081.5352s
Epoch: 7 cost time: 34.19864773750305
Epoch: 7, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.535 Vali Acc: 0.960 Test Loss: 0.535 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2604s/iter; left time: 9976.1346s
	iters: 200, epoch: 8 | loss: 0.0000004
	speed: 0.0902s/iter; left time: 3446.4063s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 3316.4629s
	iters: 400, epoch: 8 | loss: 0.0028910
	speed: 0.0757s/iter; left time: 2876.3094s
Epoch: 8 cost time: 34.87907361984253
Epoch: 8, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.493 Vali Acc: 0.969 Test Loss: 0.493 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0001262
	speed: 0.2444s/iter; left time: 9261.1904s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0806s/iter; left time: 3047.8868s
	iters: 300, epoch: 9 | loss: 0.3401348
	speed: 0.0876s/iter; left time: 3302.9135s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0818s/iter; left time: 3076.4498s
Epoch: 9 cost time: 34.429131507873535
Epoch: 9, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.320 Vali Acc: 0.975 Test Loss: 0.320 Test Acc: 0.975
Validation loss decreased (-0.972712 --> -0.974985).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2508s/iter; left time: 9400.2590s
	iters: 200, epoch: 10 | loss: 0.0000149
	speed: 0.0816s/iter; left time: 3051.8353s
	iters: 300, epoch: 10 | loss: 0.0000015
	speed: 0.0853s/iter; left time: 3178.5232s
	iters: 400, epoch: 10 | loss: 0.0000005
	speed: 0.0846s/iter; left time: 3146.3306s
Epoch: 10 cost time: 34.970598459243774
Epoch: 10, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.974985 --> -0.974986).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2794s/iter; left time: 10357.1921s
	iters: 200, epoch: 11 | loss: 0.0000047
	speed: 0.0833s/iter; left time: 3078.8170s
	iters: 300, epoch: 11 | loss: 0.0015709
	speed: 0.0841s/iter; left time: 3100.8139s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0958s/iter; left time: 3522.2885s
Epoch: 11 cost time: 37.40825700759888
Epoch: 11, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.284 Vali Acc: 0.976 Test Loss: 0.284 Test Acc: 0.976
Validation loss decreased (-0.974986 --> -0.976350).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2660s/iter; left time: 9750.4771s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0872s/iter; left time: 3187.2565s
	iters: 300, epoch: 12 | loss: 0.2726392
	speed: 0.0840s/iter; left time: 3060.8676s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0843s/iter; left time: 3063.4853s
Epoch: 12 cost time: 35.926454067230225
Epoch: 12, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.561 Vali Acc: 0.968 Test Loss: 0.561 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2458s/iter; left time: 8907.8977s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 3145.9318s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 2918.5458s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 2970.8968s
Epoch: 13 cost time: 35.040547132492065
Epoch: 13, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.454 Vali Acc: 0.969 Test Loss: 0.454 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2461s/iter; left time: 8818.7828s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0900s/iter; left time: 3214.3431s
	iters: 300, epoch: 14 | loss: 0.0330426
	speed: 0.0861s/iter; left time: 3068.9924s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2727.5627s
Epoch: 14 cost time: 34.885887145996094
Epoch: 14, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.278 Vali Acc: 0.978 Test Loss: 0.278 Test Acc: 0.978
Validation loss decreased (-0.976350 --> -0.978169).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.2678s/iter; left time: 9485.7164s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0758s/iter; left time: 2677.6953s
	iters: 300, epoch: 15 | loss: 0.0000011
	speed: 0.0882s/iter; left time: 3105.9086s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 2905.9067s
Epoch: 15 cost time: 34.26470613479614
Epoch: 15, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.635 Vali Acc: 0.970 Test Loss: 0.635 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2502s/iter; left time: 8757.4151s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0822s/iter; left time: 2870.4783s
	iters: 300, epoch: 16 | loss: 0.3941646
	speed: 0.0855s/iter; left time: 2974.5218s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0884s/iter; left time: 3069.0771s
Epoch: 16 cost time: 35.95569372177124
Epoch: 16, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.325 Vali Acc: 0.976 Test Loss: 0.325 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2516s/iter; left time: 8704.3386s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0835s/iter; left time: 2881.1510s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 2659.1921s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0923s/iter; left time: 3166.9302s
Epoch: 17 cost time: 36.04499530792236
Epoch: 17, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.626 Vali Acc: 0.965 Test Loss: 0.626 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2715s/iter; left time: 9280.1072s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0859s/iter; left time: 2928.8368s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 2666.3410s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 2694.6544s
Epoch: 18 cost time: 35.05231714248657
Epoch: 18, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.462 Vali Acc: 0.974 Test Loss: 0.462 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2439s/iter; left time: 8234.4292s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0849s/iter; left time: 2858.7902s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0832s/iter; left time: 2791.7341s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0805s/iter; left time: 2693.3085s
Epoch: 19 cost time: 34.5967173576355
Epoch: 19, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.754 Vali Acc: 0.968 Test Loss: 0.754 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2446s/iter; left time: 8157.8200s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0820s/iter; left time: 2728.2767s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 2936.8738s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0831s/iter; left time: 2746.3918s
Epoch: 20 cost time: 34.815897941589355
Epoch: 20, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.533 Vali Acc: 0.978 Test Loss: 0.533 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2615s/iter; left time: 8614.2013s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 2595.8566s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 2687.2055s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0902s/iter; left time: 2945.0294s
Epoch: 21 cost time: 35.024521350860596
Epoch: 21, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.418 Vali Acc: 0.978 Test Loss: 0.418 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0005635
	speed: 0.2681s/iter; left time: 8719.9799s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0856s/iter; left time: 2774.3790s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0829s/iter; left time: 2679.9410s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0883s/iter; left time: 2847.1780s
Epoch: 22 cost time: 36.61102914810181
Epoch: 22, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.745 Vali Acc: 0.974 Test Loss: 0.745 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0158130
	speed: 0.2458s/iter; left time: 7892.7466s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0875s/iter; left time: 2800.9239s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 2604.5929s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0851s/iter; left time: 2706.7627s
Epoch: 23 cost time: 35.72889304161072
Epoch: 23, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.653 Vali Acc: 0.975 Test Loss: 0.653 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2459s/iter; left time: 7795.6464s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 2761.2600s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0812s/iter; left time: 2558.7713s
	iters: 400, epoch: 24 | loss: 0.0000059
	speed: 0.0765s/iter; left time: 2401.6003s
Epoch: 24 cost time: 34.28063225746155
Epoch: 24, Steps: 413 | Train Loss: 0.086 Vali Loss: 1.047 Vali Acc: 0.967 Test Loss: 1.047 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 1712786
model size : 16.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1935861
	speed: 0.1018s/iter; left time: 4196.1809s
	iters: 200, epoch: 1 | loss: 0.0814759
	speed: 0.0759s/iter; left time: 3120.2448s
	iters: 300, epoch: 1 | loss: 0.0034159
	speed: 0.0811s/iter; left time: 3325.0854s
	iters: 400, epoch: 1 | loss: 0.1703472
	speed: 0.0873s/iter; left time: 3569.2533s
Epoch: 1 cost time: 35.823914527893066
Epoch: 1, Steps: 413 | Train Loss: 0.293 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
Validation loss decreased (inf --> -0.960435).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0005761
	speed: 0.2443s/iter; left time: 9965.2797s
	iters: 200, epoch: 2 | loss: 0.0006978
	speed: 0.0820s/iter; left time: 3336.6030s
	iters: 300, epoch: 2 | loss: 0.0004438
	speed: 0.0777s/iter; left time: 3154.4417s
	iters: 400, epoch: 2 | loss: 0.0101550
	speed: 0.0876s/iter; left time: 3548.2248s
Epoch: 2 cost time: 35.00568699836731
Epoch: 2, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
Validation loss decreased (-0.960435 --> -0.970894).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0131371
	speed: 0.2483s/iter; left time: 10026.7938s
	iters: 200, epoch: 3 | loss: 0.0136711
	speed: 0.0833s/iter; left time: 3352.8965s
	iters: 300, epoch: 3 | loss: 0.0000507
	speed: 0.0862s/iter; left time: 3463.9249s
	iters: 400, epoch: 3 | loss: 0.0000016
	speed: 0.0869s/iter; left time: 3482.2866s
Epoch: 3 cost time: 35.964133977890015
Epoch: 3, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.287 Vali Acc: 0.963 Test Loss: 0.287 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0033856
	speed: 0.2622s/iter; left time: 10476.4326s
	iters: 200, epoch: 4 | loss: 0.0045101
	speed: 0.0945s/iter; left time: 3767.8436s
	iters: 300, epoch: 4 | loss: 0.0141962
	speed: 0.0867s/iter; left time: 3446.8458s
	iters: 400, epoch: 4 | loss: 0.0000168
	speed: 0.0789s/iter; left time: 3129.3762s
Epoch: 4 cost time: 35.649675369262695
Epoch: 4, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.422 Vali Acc: 0.947 Test Loss: 0.422 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.2410s/iter; left time: 9529.4674s
	iters: 200, epoch: 5 | loss: 0.0000555
	speed: 0.0793s/iter; left time: 3128.3932s
	iters: 300, epoch: 5 | loss: 0.0005711
	speed: 0.0741s/iter; left time: 2913.8983s
	iters: 400, epoch: 5 | loss: 0.0232961
	speed: 0.0647s/iter; left time: 2538.6454s
Epoch: 5 cost time: 30.79727530479431
Epoch: 5, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.283 Vali Acc: 0.971 Test Loss: 0.283 Test Acc: 0.971
Validation loss decreased (-0.970894 --> -0.971348).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0011894
	speed: 0.2506s/iter; left time: 9808.2781s
	iters: 200, epoch: 6 | loss: 0.0000021
	speed: 0.0826s/iter; left time: 3226.0599s
	iters: 300, epoch: 6 | loss: 0.3841792
	speed: 0.0899s/iter; left time: 3499.5969s
	iters: 400, epoch: 6 | loss: 0.0000009
	speed: 0.0846s/iter; left time: 3285.6629s
Epoch: 6 cost time: 35.66158962249756
Epoch: 6, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.401 Vali Acc: 0.966 Test Loss: 0.401 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6555363
	speed: 0.2768s/iter; left time: 10718.2571s
	iters: 200, epoch: 7 | loss: 0.7474554
	speed: 0.0841s/iter; left time: 3248.7076s
	iters: 300, epoch: 7 | loss: 0.0000661
	speed: 0.0803s/iter; left time: 3092.7880s
	iters: 400, epoch: 7 | loss: 0.0000094
	speed: 0.0858s/iter; left time: 3295.5235s
Epoch: 7 cost time: 36.21046996116638
Epoch: 7, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.569 Vali Acc: 0.964 Test Loss: 0.569 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000244
	speed: 0.2635s/iter; left time: 10093.5870s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0902s/iter; left time: 3448.4275s
	iters: 300, epoch: 8 | loss: 0.0000003
	speed: 0.0908s/iter; left time: 3459.2104s
	iters: 400, epoch: 8 | loss: 0.0000137
	speed: 0.0846s/iter; left time: 3214.4611s
Epoch: 8 cost time: 36.26580286026001
Epoch: 8, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.406 Vali Acc: 0.961 Test Loss: 0.406 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2581s/iter; left time: 9781.8642s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 3224.1095s
	iters: 300, epoch: 9 | loss: 0.3068153
	speed: 0.0899s/iter; left time: 3389.6012s
	iters: 400, epoch: 9 | loss: 0.0000139
	speed: 0.0944s/iter; left time: 3548.2616s
Epoch: 9 cost time: 37.05100107192993
Epoch: 9, Steps: 413 | Train Loss: 0.151 Vali Loss: 0.360 Vali Acc: 0.975 Test Loss: 0.360 Test Acc: 0.975
Validation loss decreased (-0.971348 --> -0.975440).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.2584s/iter; left time: 9684.8346s
	iters: 200, epoch: 10 | loss: 0.0001254
	speed: 0.0947s/iter; left time: 3541.1771s
	iters: 300, epoch: 10 | loss: 0.0000011
	speed: 0.0793s/iter; left time: 2955.2442s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0823s/iter; left time: 3061.8963s
Epoch: 10 cost time: 35.897465229034424
Epoch: 10, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.478 Vali Acc: 0.976 Test Loss: 0.478 Test Acc: 0.976
Validation loss decreased (-0.975440 --> -0.975893).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0018068
	speed: 0.2599s/iter; left time: 9633.0498s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0845s/iter; left time: 3123.7364s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0910s/iter; left time: 3356.0111s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0861s/iter; left time: 3164.5673s
Epoch: 11 cost time: 35.34498834609985
Epoch: 11, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.390 Vali Acc: 0.978 Test Loss: 0.390 Test Acc: 0.978
Validation loss decreased (-0.975893 --> -0.978168).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2542s/iter; left time: 9318.1653s
	iters: 200, epoch: 12 | loss: 0.0809605
	speed: 0.0813s/iter; left time: 2972.3423s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 3015.6558s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0912s/iter; left time: 3315.9199s
Epoch: 12 cost time: 35.960294246673584
Epoch: 12, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.355 Vali Acc: 0.977 Test Loss: 0.355 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.4185508
	speed: 0.2526s/iter; left time: 9154.8592s
	iters: 200, epoch: 13 | loss: 0.0128423
	speed: 0.0916s/iter; left time: 3309.3607s
	iters: 300, epoch: 13 | loss: 0.9599570
	speed: 0.0811s/iter; left time: 2924.9350s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 2911.7193s
Epoch: 13 cost time: 35.44161343574524
Epoch: 13, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.520 Vali Acc: 0.973 Test Loss: 0.520 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000121
	speed: 0.2665s/iter; left time: 9548.6932s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0904s/iter; left time: 3228.6972s
	iters: 300, epoch: 14 | loss: 0.0220407
	speed: 0.0974s/iter; left time: 3469.7336s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0925s/iter; left time: 3285.8979s
Epoch: 14 cost time: 37.24929070472717
Epoch: 14, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.336 Vali Acc: 0.979 Test Loss: 0.336 Test Acc: 0.979
Validation loss decreased (-0.978168 --> -0.979078).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2854s/iter; left time: 10108.7704s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1033s/iter; left time: 3648.7325s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 2115.7467s
	iters: 400, epoch: 15 | loss: 0.0013174
	speed: 0.0600s/iter; left time: 2108.2308s
Epoch: 15 cost time: 34.772178649902344
Epoch: 15, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.302 Vali Acc: 0.978 Test Loss: 0.302 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2349s/iter; left time: 8223.4871s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 3185.9542s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 2967.4358s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 2840.8042s
Epoch: 16 cost time: 35.44743752479553
Epoch: 16, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.406 Vali Acc: 0.979 Test Loss: 0.406 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000417
	speed: 0.2522s/iter; left time: 8724.6334s
	iters: 200, epoch: 17 | loss: 0.9136009
	speed: 0.0844s/iter; left time: 2912.6853s
	iters: 300, epoch: 17 | loss: 0.0209694
	speed: 0.0874s/iter; left time: 3007.6467s
	iters: 400, epoch: 17 | loss: 0.0614458
	speed: 0.0873s/iter; left time: 2993.9805s
Epoch: 17 cost time: 35.63476634025574
Epoch: 17, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.363 Vali Acc: 0.980 Test Loss: 0.363 Test Acc: 0.980
Validation loss decreased (-0.979078 --> -0.979533).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2551s/iter; left time: 8718.5461s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 2265.6403s
	iters: 300, epoch: 18 | loss: 0.0000031
	speed: 0.0775s/iter; left time: 2632.7593s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0925s/iter; left time: 3135.1280s
Epoch: 18 cost time: 32.56443500518799
Epoch: 18, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.521 Vali Acc: 0.975 Test Loss: 0.521 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000105
	speed: 0.2777s/iter; left time: 9378.0348s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0861s/iter; left time: 2899.6031s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0852s/iter; left time: 2858.4844s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0876s/iter; left time: 2932.8834s
Epoch: 19 cost time: 36.731449604034424
Epoch: 19, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.266 Vali Acc: 0.982 Test Loss: 0.266 Test Acc: 0.982
Validation loss decreased (-0.979533 --> -0.981807).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3165042
	speed: 0.2516s/iter; left time: 8391.2952s
	iters: 200, epoch: 20 | loss: 0.0097610
	speed: 0.0928s/iter; left time: 3085.5963s
	iters: 300, epoch: 20 | loss: 0.0000008
	speed: 0.0859s/iter; left time: 2849.2348s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0842s/iter; left time: 2781.6928s
Epoch: 20 cost time: 36.30636548995972
Epoch: 20, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.431 Vali Acc: 0.980 Test Loss: 0.431 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1990799
	speed: 0.2512s/iter; left time: 8276.0179s
	iters: 200, epoch: 21 | loss: 0.0000022
	speed: 0.0884s/iter; left time: 2903.9304s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0928s/iter; left time: 3037.6135s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0831s/iter; left time: 2711.2927s
Epoch: 21 cost time: 36.1148681640625
Epoch: 21, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.404 Vali Acc: 0.977 Test Loss: 0.404 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.5730130
	speed: 0.2707s/iter; left time: 8806.8717s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 2554.7948s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 2642.6434s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 2826.6059s
Epoch: 22 cost time: 35.25702977180481
Epoch: 22, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.471 Vali Acc: 0.980 Test Loss: 0.471 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2516s/iter; left time: 8081.0483s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 2774.9703s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 2542.3937s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 2575.6734s
Epoch: 23 cost time: 34.93517327308655
Epoch: 23, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.375 Vali Acc: 0.980 Test Loss: 0.375 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 3.0377507
	speed: 0.2551s/iter; left time: 8087.1176s
	iters: 200, epoch: 24 | loss: 0.0011732
	speed: 0.0888s/iter; left time: 2807.0873s
	iters: 300, epoch: 24 | loss: 0.7691794
	speed: 0.0860s/iter; left time: 2708.5888s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2421.7633s
Epoch: 24 cost time: 34.877411127090454
Epoch: 24, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.527 Vali Acc: 0.979 Test Loss: 0.527 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000023
	speed: 0.2794s/iter; left time: 8741.5125s
	iters: 200, epoch: 25 | loss: 0.0000707
	speed: 0.0851s/iter; left time: 2653.5592s
	iters: 300, epoch: 25 | loss: 0.6445634
	speed: 0.0967s/iter; left time: 3006.5610s
	iters: 400, epoch: 25 | loss: 0.9131737
	speed: 0.0923s/iter; left time: 2859.8020s
Epoch: 25 cost time: 37.86009931564331
Epoch: 25, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.627 Vali Acc: 0.978 Test Loss: 0.627 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2641s/iter; left time: 8154.5835s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 2546.4372s
	iters: 300, epoch: 26 | loss: 0.0001111
	speed: 0.0816s/iter; left time: 2503.4502s
	iters: 400, epoch: 26 | loss: 4.2615623
	speed: 0.0925s/iter; left time: 2827.5611s
Epoch: 26 cost time: 36.5664963722229
Epoch: 26, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.352 Vali Acc: 0.984 Test Loss: 0.352 Test Acc: 0.984
Validation loss decreased (-0.981807 --> -0.983625).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2596s/iter; left time: 7909.6834s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 2690.6865s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0805s/iter; left time: 2436.4319s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0815s/iter; left time: 2459.7302s
Epoch: 27 cost time: 35.25320291519165
Epoch: 27, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.268 Vali Acc: 0.982 Test Loss: 0.268 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2650s/iter; left time: 7964.2204s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0881s/iter; left time: 2639.1745s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0921s/iter; left time: 2749.9953s
	iters: 400, epoch: 28 | loss: 0.0002108
	speed: 0.0796s/iter; left time: 2368.8375s
Epoch: 28 cost time: 35.46946430206299
Epoch: 28, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.494 Vali Acc: 0.982 Test Loss: 0.494 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2698s/iter; left time: 7996.7506s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2268.2601s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0856s/iter; left time: 2520.7394s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0880s/iter; left time: 2580.3758s
Epoch: 29 cost time: 34.95955562591553
Epoch: 29, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.740 Vali Acc: 0.975 Test Loss: 0.740 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0003535
	speed: 0.2495s/iter; left time: 7292.8134s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0861s/iter; left time: 2506.4375s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0832s/iter; left time: 2414.1172s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0881s/iter; left time: 2547.0343s
Epoch: 30 cost time: 36.23071646690369
Epoch: 30, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.426 Vali Acc: 0.981 Test Loss: 0.426 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2462s/iter; left time: 7094.1032s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0983s/iter; left time: 2821.8260s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 2472.5675s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 2340.1597s
Epoch: 31 cost time: 36.41734504699707
Epoch: 31, Steps: 413 | Train Loss: 0.045 Vali Loss: 1.062 Vali Acc: 0.970 Test Loss: 1.062 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2681s/iter; left time: 7612.8512s
	iters: 200, epoch: 32 | loss: 0.0071071
	speed: 0.0862s/iter; left time: 2438.2793s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 2431.8322s
	iters: 400, epoch: 32 | loss: 0.1550720
	speed: 0.0836s/iter; left time: 2350.2537s
Epoch: 32 cost time: 35.49085998535156
Epoch: 32, Steps: 413 | Train Loss: 0.078 Vali Loss: 1.216 Vali Acc: 0.970 Test Loss: 1.216 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2548s/iter; left time: 7131.1066s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 2258.8538s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0792s/iter; left time: 2199.5602s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0878s/iter; left time: 2429.8246s
Epoch: 33 cost time: 35.45382380485535
Epoch: 33, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.368 Vali Acc: 0.982 Test Loss: 0.368 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2457s/iter; left time: 6775.3236s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 2402.1050s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 2133.0434s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0799s/iter; left time: 2178.9356s
Epoch: 34 cost time: 34.57475185394287
Epoch: 34, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.232 Vali Acc: 0.986 Test Loss: 0.232 Test Acc: 0.986
Validation loss decreased (-0.983625 --> -0.986355).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2625s/iter; left time: 7128.3708s
	iters: 200, epoch: 35 | loss: 0.0000277
	speed: 0.0799s/iter; left time: 2161.5523s
	iters: 300, epoch: 35 | loss: 0.0093310
	speed: 0.0919s/iter; left time: 2478.8548s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0850s/iter; left time: 2283.3019s
Epoch: 35 cost time: 34.91913342475891
Epoch: 35, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.486 Vali Acc: 0.983 Test Loss: 0.486 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2344s/iter; left time: 6268.9753s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 1742.1841s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2047.1511s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 2342.7993s
Epoch: 36 cost time: 32.21063017845154
Epoch: 36, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.649 Vali Acc: 0.979 Test Loss: 0.649 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0000001
	speed: 0.2523s/iter; left time: 6644.5764s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0822s/iter; left time: 2157.6219s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0814s/iter; left time: 2127.9933s
	iters: 400, epoch: 37 | loss: 1.2811755
	speed: 0.0885s/iter; left time: 2302.6742s
Epoch: 37 cost time: 35.842281103134155
Epoch: 37, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.457 Vali Acc: 0.982 Test Loss: 0.457 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2511s/iter; left time: 6507.7019s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0878s/iter; left time: 2265.8215s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 1952.3336s
	iters: 400, epoch: 38 | loss: 2.3220623
	speed: 0.0739s/iter; left time: 1892.1607s
Epoch: 38 cost time: 33.57740664482117
Epoch: 38, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.713 Vali Acc: 0.973 Test Loss: 0.713 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2559s/iter; left time: 6527.3668s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0738s/iter; left time: 1873.8897s
	iters: 300, epoch: 39 | loss: 0.0000139
	speed: 0.0867s/iter; left time: 2193.5759s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 2009.5184s
Epoch: 39 cost time: 33.23761987686157
Epoch: 39, Steps: 413 | Train Loss: 0.087 Vali Loss: 1.210 Vali Acc: 0.968 Test Loss: 1.210 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.2425s/iter; left time: 6084.4613s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0796s/iter; left time: 1988.8364s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 2034.2372s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0838s/iter; left time: 2076.5108s
Epoch: 40 cost time: 33.8720805644989
Epoch: 40, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.687 Vali Acc: 0.980 Test Loss: 0.687 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.2479s/iter; left time: 6117.4626s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0764s/iter; left time: 1877.7099s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0800s/iter; left time: 1958.9682s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0904s/iter; left time: 2204.1764s
Epoch: 41 cost time: 34.95439648628235
Epoch: 41, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.665 Vali Acc: 0.980 Test Loss: 0.665 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.2677s/iter; left time: 6497.1905s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0925s/iter; left time: 2234.3335s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0814s/iter; left time: 1958.7840s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 1955.7453s
Epoch: 42 cost time: 35.44264054298401
Epoch: 42, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.629 Vali Acc: 0.980 Test Loss: 0.629 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.2366s/iter; left time: 5645.0754s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0843s/iter; left time: 2001.4287s
	iters: 300, epoch: 43 | loss: 0.0000031
	speed: 0.0883s/iter; left time: 2088.9731s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.0808s/iter; left time: 1902.6651s
Epoch: 43 cost time: 34.756439208984375
Epoch: 43, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.766 Vali Acc: 0.976 Test Loss: 0.766 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.2469s/iter; left time: 5788.8024s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 1847.0159s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.0802s/iter; left time: 1863.8117s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 2006.5060s
Epoch: 44 cost time: 34.40279817581177
Epoch: 44, Steps: 413 | Train Loss: 0.060 Vali Loss: 1.005 Vali Acc: 0.973 Test Loss: 1.005 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 1712786
model size : 16.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0899602
	speed: 0.0944s/iter; left time: 3890.7389s
	iters: 200, epoch: 1 | loss: 0.0672418
	speed: 0.0889s/iter; left time: 3655.1425s
	iters: 300, epoch: 1 | loss: 0.0018403
	speed: 0.0824s/iter; left time: 3376.7060s
	iters: 400, epoch: 1 | loss: 0.0304885
	speed: 0.0718s/iter; left time: 2937.0512s
Epoch: 1 cost time: 34.88164687156677
Epoch: 1, Steps: 413 | Train Loss: 0.300 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (inf --> -0.973169).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0331732
	speed: 0.2431s/iter; left time: 9913.9800s
	iters: 200, epoch: 2 | loss: 0.0304802
	speed: 0.0778s/iter; left time: 3165.9315s
	iters: 300, epoch: 2 | loss: 0.0004778
	speed: 0.0868s/iter; left time: 3523.9151s
	iters: 400, epoch: 2 | loss: 0.0001453
	speed: 0.0835s/iter; left time: 3381.8119s
Epoch: 2 cost time: 34.22896385192871
Epoch: 2, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3545706
	speed: 0.2453s/iter; left time: 9903.2568s
	iters: 200, epoch: 3 | loss: 0.0000097
	speed: 0.0809s/iter; left time: 3258.2867s
	iters: 300, epoch: 3 | loss: 0.0001019
	speed: 0.0811s/iter; left time: 3256.8151s
	iters: 400, epoch: 3 | loss: 0.0121100
	speed: 0.0893s/iter; left time: 3578.3773s
Epoch: 3 cost time: 35.486138343811035
Epoch: 3, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.178 Vali Acc: 0.969 Test Loss: 0.178 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000764
	speed: 0.2497s/iter; left time: 9979.8848s
	iters: 200, epoch: 4 | loss: 0.0000544
	speed: 0.0718s/iter; left time: 2860.7816s
	iters: 300, epoch: 4 | loss: 0.0000319
	speed: 0.0633s/iter; left time: 2518.3351s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 3212.3395s
Epoch: 4 cost time: 31.46480107307434
Epoch: 4, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.247 Vali Acc: 0.970 Test Loss: 0.247 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0007475
	speed: 0.2630s/iter; left time: 10401.8796s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 3148.5665s
	iters: 300, epoch: 5 | loss: 0.0006465
	speed: 0.0784s/iter; left time: 3086.5185s
	iters: 400, epoch: 5 | loss: 0.0054801
	speed: 0.0790s/iter; left time: 3099.7158s
Epoch: 5 cost time: 33.36780142784119
Epoch: 5, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.975441).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.2422s/iter; left time: 9478.3525s
	iters: 200, epoch: 6 | loss: 0.0000006
	speed: 0.0857s/iter; left time: 3344.8132s
	iters: 300, epoch: 6 | loss: 0.0498169
	speed: 0.0785s/iter; left time: 3056.8113s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0754s/iter; left time: 2930.1445s
Epoch: 6 cost time: 32.96955180168152
Epoch: 6, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.262 Vali Acc: 0.973 Test Loss: 0.262 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0154136
	speed: 0.2349s/iter; left time: 9095.2740s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0823s/iter; left time: 3180.1159s
	iters: 300, epoch: 7 | loss: 0.9758598
	speed: 0.0846s/iter; left time: 3258.7970s
	iters: 400, epoch: 7 | loss: 0.0029163
	speed: 0.0764s/iter; left time: 2933.9042s
Epoch: 7 cost time: 33.068294048309326
Epoch: 7, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.244 Vali Acc: 0.972 Test Loss: 0.244 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.2542s/iter; left time: 9739.9385s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0793s/iter; left time: 3031.5340s
	iters: 300, epoch: 8 | loss: 0.3530623
	speed: 0.0840s/iter; left time: 3201.5819s
	iters: 400, epoch: 8 | loss: 0.0000113
	speed: 0.0824s/iter; left time: 3131.9027s
Epoch: 8 cost time: 34.25121760368347
Epoch: 8, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.270 Vali Acc: 0.977 Test Loss: 0.270 Test Acc: 0.977
Validation loss decreased (-0.975441 --> -0.977260).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4710793
	speed: 0.2421s/iter; left time: 9173.7190s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 3056.0257s
	iters: 300, epoch: 9 | loss: 0.0004112
	speed: 0.0793s/iter; left time: 2989.2653s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 3182.1705s
Epoch: 9 cost time: 34.83882236480713
Epoch: 9, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.304 Vali Acc: 0.981 Test Loss: 0.304 Test Acc: 0.981
Validation loss decreased (-0.977260 --> -0.980897).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2420s/iter; left time: 9070.7821s
	iters: 200, epoch: 10 | loss: 0.0171039
	speed: 0.0819s/iter; left time: 3061.6517s
	iters: 300, epoch: 10 | loss: 0.0017122
	speed: 0.0762s/iter; left time: 2841.4617s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0721s/iter; left time: 2682.6571s
Epoch: 10 cost time: 32.66521453857422
Epoch: 10, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.323 Vali Acc: 0.979 Test Loss: 0.323 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2628s/iter; left time: 9740.7070s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0842s/iter; left time: 3112.9030s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 2974.5201s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 2685.9276s
Epoch: 11 cost time: 32.51605248451233
Epoch: 11, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.765 Vali Acc: 0.962 Test Loss: 0.765 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2511s/iter; left time: 9206.0811s
	iters: 200, epoch: 12 | loss: 6.8751101
	speed: 0.0744s/iter; left time: 2720.6642s
	iters: 300, epoch: 12 | loss: 0.0153730
	speed: 0.0828s/iter; left time: 3020.3365s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0764s/iter; left time: 2777.6162s
Epoch: 12 cost time: 32.422815799713135
Epoch: 12, Steps: 413 | Train Loss: 0.162 Vali Loss: 0.311 Vali Acc: 0.980 Test Loss: 0.311 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0014609
	speed: 0.2428s/iter; left time: 8800.1380s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0783s/iter; left time: 2829.1771s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0861s/iter; left time: 3102.4069s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 3023.4446s
Epoch: 13 cost time: 34.57552623748779
Epoch: 13, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.494 Vali Acc: 0.977 Test Loss: 0.494 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2552s/iter; left time: 9145.3258s
	iters: 200, epoch: 14 | loss: 0.0778947
	speed: 0.0807s/iter; left time: 2884.9682s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 2946.0439s
	iters: 400, epoch: 14 | loss: 0.0000601
	speed: 0.0907s/iter; left time: 3223.3744s
Epoch: 14 cost time: 36.40854454040527
Epoch: 14, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.344 Vali Acc: 0.980 Test Loss: 0.344 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0039401
	speed: 0.2742s/iter; left time: 9712.5791s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0772s/iter; left time: 2726.3131s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 3339.8202s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0986s/iter; left time: 3461.4672s
Epoch: 15 cost time: 37.95154905319214
Epoch: 15, Steps: 413 | Train Loss: 0.170 Vali Loss: 0.739 Vali Acc: 0.970 Test Loss: 0.739 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0032493
	speed: 0.2029s/iter; left time: 7104.2681s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1652.3584s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0618s/iter; left time: 2151.3960s
	iters: 400, epoch: 16 | loss: 0.0326431
	speed: 0.0701s/iter; left time: 2432.8472s
Epoch: 16 cost time: 24.90117073059082
Epoch: 16, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.602 Vali Acc: 0.970 Test Loss: 0.602 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2466s/iter; left time: 8530.6291s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0852s/iter; left time: 2940.4936s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0873s/iter; left time: 3004.2192s
	iters: 400, epoch: 17 | loss: 0.0924936
	speed: 0.0823s/iter; left time: 2820.8193s
Epoch: 17 cost time: 34.90278244018555
Epoch: 17, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.413 Vali Acc: 0.979 Test Loss: 0.413 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0012407
	speed: 0.2478s/iter; left time: 8471.4590s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 2791.1798s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0880s/iter; left time: 2989.2715s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0924s/iter; left time: 3130.3349s
Epoch: 18 cost time: 35.8517005443573
Epoch: 18, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.756 Vali Acc: 0.975 Test Loss: 0.756 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000006
	speed: 0.2779s/iter; left time: 9385.0718s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0878s/iter; left time: 2956.8348s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0840s/iter; left time: 2818.3910s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0860s/iter; left time: 2878.5104s
Epoch: 19 cost time: 37.41005516052246
Epoch: 19, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.874 Vali Acc: 0.964 Test Loss: 0.874 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 1712786
model size : 16.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3250755
	speed: 0.1023s/iter; left time: 4215.4042s
	iters: 200, epoch: 1 | loss: 0.1557120
	speed: 0.0793s/iter; left time: 3260.5693s
	iters: 300, epoch: 1 | loss: 0.0236258
	speed: 0.0830s/iter; left time: 3404.0430s
	iters: 400, epoch: 1 | loss: 0.0857131
	speed: 0.0849s/iter; left time: 3473.8480s
Epoch: 1 cost time: 36.111464738845825
Epoch: 1, Steps: 413 | Train Loss: 0.307 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (inf --> -0.979535).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0068464
	speed: 0.2474s/iter; left time: 10089.4346s
	iters: 200, epoch: 2 | loss: 0.0031356
	speed: 0.0799s/iter; left time: 3250.7470s
	iters: 300, epoch: 2 | loss: 0.0018172
	speed: 0.0768s/iter; left time: 3116.6105s
	iters: 400, epoch: 2 | loss: 0.0025284
	speed: 0.0786s/iter; left time: 3184.2440s
Epoch: 2 cost time: 33.69752764701843
Epoch: 2, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0241643
	speed: 0.2643s/iter; left time: 10671.1280s
	iters: 200, epoch: 3 | loss: 0.0023709
	speed: 0.0796s/iter; left time: 3204.9210s
	iters: 300, epoch: 3 | loss: 0.2639759
	speed: 0.0950s/iter; left time: 3815.5466s
	iters: 400, epoch: 3 | loss: 0.0780167
	speed: 0.0754s/iter; left time: 3019.7740s
Epoch: 3 cost time: 34.400254011154175
Epoch: 3, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.169 Vali Acc: 0.961 Test Loss: 0.169 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0084276
	speed: 0.2403s/iter; left time: 9602.9821s
	iters: 200, epoch: 4 | loss: 0.0027148
	speed: 0.0778s/iter; left time: 3099.4273s
	iters: 300, epoch: 4 | loss: 0.0000698
	speed: 0.0776s/iter; left time: 3086.1842s
	iters: 400, epoch: 4 | loss: 0.0089643
	speed: 0.0848s/iter; left time: 3361.7087s
Epoch: 4 cost time: 33.860034227371216
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
Validation loss decreased (-0.979535 --> -0.982264).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1710472
	speed: 0.2465s/iter; left time: 9748.8834s
	iters: 200, epoch: 5 | loss: 0.0004655
	speed: 0.0883s/iter; left time: 3482.9151s
	iters: 300, epoch: 5 | loss: 0.0153706
	speed: 0.0825s/iter; left time: 3245.0098s
	iters: 400, epoch: 5 | loss: 0.0051834
	speed: 0.0794s/iter; left time: 3116.8278s
Epoch: 5 cost time: 34.657909631729126
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0002095
	speed: 0.2597s/iter; left time: 10164.5625s
	iters: 200, epoch: 6 | loss: 0.1058648
	speed: 0.0786s/iter; left time: 3070.1465s
	iters: 300, epoch: 6 | loss: 0.0085854
	speed: 0.0946s/iter; left time: 3682.3041s
	iters: 400, epoch: 6 | loss: 0.0139375
	speed: 0.0855s/iter; left time: 3321.5783s
Epoch: 6 cost time: 35.83909225463867
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0028223
	speed: 0.2748s/iter; left time: 10641.8870s
	iters: 200, epoch: 7 | loss: 0.0002688
	speed: 0.0778s/iter; left time: 3003.3373s
	iters: 300, epoch: 7 | loss: 0.0000055
	speed: 0.0765s/iter; left time: 2947.0729s
	iters: 400, epoch: 7 | loss: 0.0000005
	speed: 0.0836s/iter; left time: 3213.4197s
Epoch: 7 cost time: 34.66542196273804
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2468s/iter; left time: 9455.1890s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0857s/iter; left time: 3274.9650s
	iters: 300, epoch: 8 | loss: 0.0000001
	speed: 0.0809s/iter; left time: 3082.9291s
	iters: 400, epoch: 8 | loss: 0.0173025
	speed: 0.0773s/iter; left time: 2938.9099s
Epoch: 8 cost time: 33.72657918930054
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.157 Vali Acc: 0.977 Test Loss: 0.157 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000141
	speed: 0.2423s/iter; left time: 9182.3969s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0749s/iter; left time: 2829.4409s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0843s/iter; left time: 3176.4067s
	iters: 400, epoch: 9 | loss: 0.0000002
	speed: 0.0876s/iter; left time: 3293.0339s
Epoch: 9 cost time: 33.923419713974
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.307 Vali Acc: 0.966 Test Loss: 0.307 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000003
	speed: 0.2747s/iter; left time: 10296.3737s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0840s/iter; left time: 3140.6357s
	iters: 300, epoch: 10 | loss: 0.0003400
	speed: 0.0739s/iter; left time: 2755.9093s
	iters: 400, epoch: 10 | loss: 0.0000128
	speed: 0.0756s/iter; left time: 2812.7938s
Epoch: 10 cost time: 33.81318545341492
Epoch: 10, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.256 Vali Acc: 0.973 Test Loss: 0.256 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000004
	speed: 0.2498s/iter; left time: 9261.0238s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0803s/iter; left time: 2967.7364s
	iters: 300, epoch: 11 | loss: 0.0002232
	speed: 0.0860s/iter; left time: 3172.7488s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0829s/iter; left time: 3047.9539s
Epoch: 11 cost time: 34.457292795181274
Epoch: 11, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.981 Test Loss: 0.134 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000032
	speed: 0.2524s/iter; left time: 9251.2151s
	iters: 200, epoch: 12 | loss: 0.0000232
	speed: 0.0803s/iter; left time: 2935.3978s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0799s/iter; left time: 2912.7772s
	iters: 400, epoch: 12 | loss: 0.0000066
	speed: 0.0873s/iter; left time: 3175.6488s
Epoch: 12 cost time: 35.00720715522766
Epoch: 12, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.379 Vali Acc: 0.964 Test Loss: 0.379 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000003
	speed: 0.2493s/iter; left time: 9034.4958s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 3300.9937s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0812s/iter; left time: 2927.3442s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0711s/iter; left time: 2554.5683s
Epoch: 13 cost time: 33.973193407058716
Epoch: 13, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.255 Vali Acc: 0.970 Test Loss: 0.255 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000004
	speed: 0.2655s/iter; left time: 9514.0904s
	iters: 200, epoch: 14 | loss: 0.0004943
	speed: 0.0703s/iter; left time: 2510.3415s
	iters: 300, epoch: 14 | loss: 0.0001117
	speed: 0.0805s/iter; left time: 2869.0051s
	iters: 400, epoch: 14 | loss: 0.0000520
	speed: 0.0840s/iter; left time: 2983.7286s
Epoch: 14 cost time: 32.87884211540222
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 2625938
model size : 14.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3013569
	speed: 0.0985s/iter; left time: 4058.3463s
	iters: 200, epoch: 1 | loss: 0.1157940
	speed: 0.0799s/iter; left time: 3284.8069s
	iters: 300, epoch: 1 | loss: 0.0220761
	speed: 0.0818s/iter; left time: 3352.1119s
	iters: 400, epoch: 1 | loss: 0.0530453
	speed: 0.0753s/iter; left time: 3081.8573s
Epoch: 1 cost time: 34.68069767951965
Epoch: 1, Steps: 413 | Train Loss: 0.304 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (inf --> -0.979990).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0068889
	speed: 0.2535s/iter; left time: 10338.5669s
	iters: 200, epoch: 2 | loss: 0.0011959
	speed: 0.0847s/iter; left time: 3446.0850s
	iters: 300, epoch: 2 | loss: 0.0012822
	speed: 0.0803s/iter; left time: 3257.8810s
	iters: 400, epoch: 2 | loss: 0.0038601
	speed: 0.0901s/iter; left time: 3648.5228s
Epoch: 2 cost time: 35.63661313056946
Epoch: 2, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.251 Vali Acc: 0.940 Test Loss: 0.251 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0098420
	speed: 0.2614s/iter; left time: 10555.4554s
	iters: 200, epoch: 3 | loss: 0.0042867
	speed: 0.0669s/iter; left time: 2693.5265s
	iters: 300, epoch: 3 | loss: 0.0095955
	speed: 0.0605s/iter; left time: 2431.6970s
	iters: 400, epoch: 3 | loss: 0.1639035
	speed: 0.0658s/iter; left time: 2635.5202s
Epoch: 3 cost time: 29.130002975463867
Epoch: 3, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.225 Vali Acc: 0.955 Test Loss: 0.225 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000760
	speed: 0.2388s/iter; left time: 9540.9608s
	iters: 200, epoch: 4 | loss: 0.0113335
	speed: 0.0819s/iter; left time: 3264.2058s
	iters: 300, epoch: 4 | loss: 0.0008393
	speed: 0.0789s/iter; left time: 3138.0968s
	iters: 400, epoch: 4 | loss: 0.0008735
	speed: 0.0758s/iter; left time: 3007.0840s
Epoch: 4 cost time: 32.743547439575195
Epoch: 4, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0021873
	speed: 0.2452s/iter; left time: 9698.8054s
	iters: 200, epoch: 5 | loss: 0.0177810
	speed: 0.0722s/iter; left time: 2849.5041s
	iters: 300, epoch: 5 | loss: 0.0000700
	speed: 0.0790s/iter; left time: 3107.6377s
	iters: 400, epoch: 5 | loss: 0.0004103
	speed: 0.0850s/iter; left time: 3335.5924s
Epoch: 5 cost time: 32.7762975692749
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000594
	speed: 0.2646s/iter; left time: 10353.8175s
	iters: 200, epoch: 6 | loss: 0.0002011
	speed: 0.0788s/iter; left time: 3075.7606s
	iters: 300, epoch: 6 | loss: 0.0000899
	speed: 0.0718s/iter; left time: 2795.0519s
	iters: 400, epoch: 6 | loss: 0.3102749
	speed: 0.0767s/iter; left time: 2977.5698s
Epoch: 6 cost time: 33.16256785392761
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000171
	speed: 0.2405s/iter; left time: 9312.9288s
	iters: 200, epoch: 7 | loss: 0.2188052
	speed: 0.0818s/iter; left time: 3159.2555s
	iters: 300, epoch: 7 | loss: 0.0000273
	speed: 0.0799s/iter; left time: 3078.8162s
	iters: 400, epoch: 7 | loss: 0.0244490
	speed: 0.0755s/iter; left time: 2900.9961s
Epoch: 7 cost time: 32.73970556259155
Epoch: 7, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2400s/iter; left time: 9195.3089s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0786s/iter; left time: 3004.6561s
	iters: 300, epoch: 8 | loss: 0.0651512
	speed: 0.0837s/iter; left time: 3189.3906s
	iters: 400, epoch: 8 | loss: 0.0007115
	speed: 0.0826s/iter; left time: 3138.4218s
Epoch: 8 cost time: 33.74165320396423
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.241 Vali Acc: 0.966 Test Loss: 0.241 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2620s/iter; left time: 9927.5580s
	iters: 200, epoch: 9 | loss: 0.0182961
	speed: 0.0758s/iter; left time: 2865.1834s
	iters: 300, epoch: 9 | loss: 0.0386105
	speed: 0.0794s/iter; left time: 2992.4069s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0823s/iter; left time: 3093.5916s
Epoch: 9 cost time: 34.33185291290283
Epoch: 9, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.165 Vali Acc: 0.976 Test Loss: 0.165 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.2552s/iter; left time: 9566.5196s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0836s/iter; left time: 3126.3275s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0756s/iter; left time: 2818.9311s
	iters: 400, epoch: 10 | loss: 0.0000407
	speed: 0.0752s/iter; left time: 2796.2594s
Epoch: 10 cost time: 32.01736402511597
Epoch: 10, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.255 Vali Acc: 0.971 Test Loss: 0.255 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0002217
	speed: 0.2336s/iter; left time: 8658.5512s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 2672.4101s
	iters: 300, epoch: 11 | loss: 0.0000181
	speed: 0.0797s/iter; left time: 2937.6786s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2835.4183s
Epoch: 11 cost time: 31.782048225402832
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.245 Vali Acc: 0.977 Test Loss: 0.245 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 2625938
model size : 14.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3448752
	speed: 0.0942s/iter; left time: 3882.1284s
	iters: 200, epoch: 1 | loss: 0.0797308
	speed: 0.0871s/iter; left time: 3581.3720s
	iters: 300, epoch: 1 | loss: 0.0429936
	speed: 0.0735s/iter; left time: 3013.8408s
	iters: 400, epoch: 1 | loss: 0.0420531
	speed: 0.0654s/iter; left time: 2673.8462s
Epoch: 1 cost time: 33.08714199066162
Epoch: 1, Steps: 413 | Train Loss: 0.302 Vali Loss: 0.058 Vali Acc: 0.979 Test Loss: 0.058 Test Acc: 0.979
Validation loss decreased (inf --> -0.978626).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0193197
	speed: 0.2492s/iter; left time: 10164.5358s
	iters: 200, epoch: 2 | loss: 0.0005469
	speed: 0.0724s/iter; left time: 2947.7077s
	iters: 300, epoch: 2 | loss: 0.0038298
	speed: 0.0780s/iter; left time: 3164.2385s
	iters: 400, epoch: 2 | loss: 0.0111409
	speed: 0.0835s/iter; left time: 3379.2433s
Epoch: 2 cost time: 31.738807201385498
Epoch: 2, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0187896
	speed: 0.2346s/iter; left time: 9472.8627s
	iters: 200, epoch: 3 | loss: 0.0000668
	speed: 0.0799s/iter; left time: 3216.9673s
	iters: 300, epoch: 3 | loss: 0.0008841
	speed: 0.0756s/iter; left time: 3037.6606s
	iters: 400, epoch: 3 | loss: 0.0007991
	speed: 0.0790s/iter; left time: 3165.8600s
Epoch: 3 cost time: 33.094446659088135
Epoch: 3, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.978626 --> -0.980445).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000002
	speed: 0.2343s/iter; left time: 9362.9281s
	iters: 200, epoch: 4 | loss: 0.0002287
	speed: 0.0782s/iter; left time: 3117.8842s
	iters: 300, epoch: 4 | loss: 0.0001331
	speed: 0.0771s/iter; left time: 3067.1518s
	iters: 400, epoch: 4 | loss: 0.0051583
	speed: 0.0688s/iter; left time: 2726.8815s
Epoch: 4 cost time: 31.176412105560303
Epoch: 4, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.980445 --> -0.983173).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000468
	speed: 0.2494s/iter; left time: 9862.6903s
	iters: 200, epoch: 5 | loss: 0.0005817
	speed: 0.0676s/iter; left time: 2667.6997s
	iters: 300, epoch: 5 | loss: 0.0004226
	speed: 0.0741s/iter; left time: 2914.7401s
	iters: 400, epoch: 5 | loss: 0.0000493
	speed: 0.0889s/iter; left time: 3489.5190s
Epoch: 5 cost time: 32.08532929420471
Epoch: 5, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0038396
	speed: 0.2397s/iter; left time: 9381.4771s
	iters: 200, epoch: 6 | loss: 0.1243044
	speed: 0.0790s/iter; left time: 3082.1638s
	iters: 300, epoch: 6 | loss: 0.5167798
	speed: 0.0733s/iter; left time: 2852.7714s
	iters: 400, epoch: 6 | loss: 0.0001392
	speed: 0.0727s/iter; left time: 2822.6258s
Epoch: 6 cost time: 31.34208393096924
Epoch: 6, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.186 Vali Acc: 0.964 Test Loss: 0.186 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000007
	speed: 0.2335s/iter; left time: 9041.1487s
	iters: 200, epoch: 7 | loss: 0.0040242
	speed: 0.0726s/iter; left time: 2805.4321s
	iters: 300, epoch: 7 | loss: 0.0000856
	speed: 0.0832s/iter; left time: 3203.2799s
	iters: 400, epoch: 7 | loss: 0.3175503
	speed: 0.0743s/iter; left time: 2853.0150s
Epoch: 7 cost time: 31.77744174003601
Epoch: 7, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2382s/iter; left time: 9125.6809s
	iters: 200, epoch: 8 | loss: 0.0000001
	speed: 0.0746s/iter; left time: 2851.6431s
	iters: 300, epoch: 8 | loss: 0.0000008
	speed: 0.0722s/iter; left time: 2751.1706s
	iters: 400, epoch: 8 | loss: 0.0268957
	speed: 0.0845s/iter; left time: 3209.9702s
Epoch: 8 cost time: 32.72621560096741
Epoch: 8, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.173 Vali Acc: 0.973 Test Loss: 0.173 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.2454s/iter; left time: 9299.5258s
	iters: 200, epoch: 9 | loss: 0.3993291
	speed: 0.0881s/iter; left time: 3331.4420s
	iters: 300, epoch: 9 | loss: 0.1139732
	speed: 0.0799s/iter; left time: 3012.0920s
	iters: 400, epoch: 9 | loss: 0.0000939
	speed: 0.0737s/iter; left time: 2771.3570s
Epoch: 9 cost time: 33.286858797073364
Epoch: 9, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
Validation loss decreased (-0.983173 --> -0.987266).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9696808
	speed: 0.2332s/iter; left time: 8742.7899s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 2764.3176s
	iters: 300, epoch: 10 | loss: 0.0000607
	speed: 0.0781s/iter; left time: 2911.3098s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0773s/iter; left time: 2875.6092s
Epoch: 10 cost time: 31.887776851654053
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0153011
	speed: 0.2289s/iter; left time: 8487.1613s
	iters: 200, epoch: 11 | loss: 0.0000007
	speed: 0.0749s/iter; left time: 2769.0396s
	iters: 300, epoch: 11 | loss: 0.0003481
	speed: 0.0714s/iter; left time: 2633.0982s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.0712s/iter; left time: 2619.8136s
Epoch: 11 cost time: 31.457381010055542
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1355703
	speed: 0.2486s/iter; left time: 9112.6978s
	iters: 200, epoch: 12 | loss: 0.0000006
	speed: 0.0849s/iter; left time: 3102.1032s
	iters: 300, epoch: 12 | loss: 0.1259027
	speed: 0.0727s/iter; left time: 2651.8980s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0710s/iter; left time: 2582.5225s
Epoch: 12 cost time: 31.282152891159058
Epoch: 12, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0236158
	speed: 0.2539s/iter; left time: 9203.1748s
	iters: 200, epoch: 13 | loss: 0.0000028
	speed: 0.0731s/iter; left time: 2643.2856s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0746s/iter; left time: 2687.7107s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 2390.0485s
Epoch: 13 cost time: 30.017963409423828
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.178 Vali Acc: 0.985 Test Loss: 0.178 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0002907
	speed: 0.2178s/iter; left time: 7803.2882s
	iters: 200, epoch: 14 | loss: 0.0003398
	speed: 0.0762s/iter; left time: 2721.0278s
	iters: 300, epoch: 14 | loss: 0.4011932
	speed: 0.0752s/iter; left time: 2678.6566s
	iters: 400, epoch: 14 | loss: 0.0000150
	speed: 0.0838s/iter; left time: 2976.4807s
Epoch: 14 cost time: 33.154680490493774
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.327 Vali Acc: 0.968 Test Loss: 0.327 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0005371
	speed: 0.2315s/iter; left time: 8198.6375s
	iters: 200, epoch: 15 | loss: 0.0000134
	speed: 0.0849s/iter; left time: 2998.0155s
	iters: 300, epoch: 15 | loss: 0.0000743
	speed: 0.0760s/iter; left time: 2676.8941s
	iters: 400, epoch: 15 | loss: 0.0430582
	speed: 0.0754s/iter; left time: 2647.9962s
Epoch: 15 cost time: 32.77493691444397
Epoch: 15, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000010
	speed: 0.2508s/iter; left time: 8778.3330s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0767s/iter; left time: 2676.1813s
	iters: 300, epoch: 16 | loss: 0.0000017
	speed: 0.0809s/iter; left time: 2815.6027s
	iters: 400, epoch: 16 | loss: 0.7572892
	speed: 0.0711s/iter; left time: 2469.0053s
Epoch: 16 cost time: 31.8573899269104
Epoch: 16, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.982 Test Loss: 0.137 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2381s/iter; left time: 8235.0446s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 2478.8645s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0746s/iter; left time: 2565.3717s
	iters: 400, epoch: 17 | loss: 0.0002102
	speed: 0.0798s/iter; left time: 2736.8312s
Epoch: 17 cost time: 31.419860124588013
Epoch: 17, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.208 Vali Acc: 0.977 Test Loss: 0.208 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000010
	speed: 0.2440s/iter; left time: 8341.3083s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0750s/iter; left time: 2555.2561s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0701s/iter; left time: 2381.5757s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 2570.5762s
Epoch: 18 cost time: 31.7391037940979
Epoch: 18, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.257 Vali Acc: 0.974 Test Loss: 0.257 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2487s/iter; left time: 8399.3496s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0815s/iter; left time: 2745.2249s
	iters: 300, epoch: 19 | loss: 0.1387217
	speed: 0.0779s/iter; left time: 2614.0678s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0725s/iter; left time: 2426.4627s
Epoch: 19 cost time: 31.658920526504517
Epoch: 19, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.488 Vali Acc: 0.967 Test Loss: 0.488 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 2625938
model size : 14.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4245807
	speed: 0.1023s/iter; left time: 4216.0201s
	iters: 200, epoch: 1 | loss: 0.1254553
	speed: 0.0741s/iter; left time: 3045.4595s
	iters: 300, epoch: 1 | loss: 0.0293500
	speed: 0.0739s/iter; left time: 3029.4474s
	iters: 400, epoch: 1 | loss: 0.0325309
	speed: 0.0776s/iter; left time: 3175.9495s
Epoch: 1 cost time: 34.047420501708984
Epoch: 1, Steps: 413 | Train Loss: 0.324 Vali Loss: 0.070 Vali Acc: 0.972 Test Loss: 0.070 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0015310
	speed: 0.2285s/iter; left time: 9318.3553s
	iters: 200, epoch: 2 | loss: 0.0185285
	speed: 0.0821s/iter; left time: 3339.6752s
	iters: 300, epoch: 2 | loss: 0.0044840
	speed: 0.0731s/iter; left time: 2968.8692s
	iters: 400, epoch: 2 | loss: 0.0349407
	speed: 0.0689s/iter; left time: 2790.1310s
Epoch: 2 cost time: 31.02742314338684
Epoch: 2, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.972259 --> -0.979990).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0082599
	speed: 0.2486s/iter; left time: 10038.1169s
	iters: 200, epoch: 3 | loss: 0.0279543
	speed: 0.0685s/iter; left time: 2757.8210s
	iters: 300, epoch: 3 | loss: 0.0725003
	speed: 0.0748s/iter; left time: 3003.9755s
	iters: 400, epoch: 3 | loss: 0.0005383
	speed: 0.0806s/iter; left time: 3230.1871s
Epoch: 3 cost time: 30.73160433769226
Epoch: 3, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0004195
	speed: 0.2388s/iter; left time: 9541.1278s
	iters: 200, epoch: 4 | loss: 0.3229587
	speed: 0.0934s/iter; left time: 3722.6321s
	iters: 300, epoch: 4 | loss: 0.0002851
	speed: 0.0856s/iter; left time: 3403.6214s
	iters: 400, epoch: 4 | loss: 0.0260202
	speed: 0.0560s/iter; left time: 2221.4825s
Epoch: 4 cost time: 32.48184823989868
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1628000
	speed: 0.1665s/iter; left time: 6585.2976s
	iters: 200, epoch: 5 | loss: 0.0000355
	speed: 0.0659s/iter; left time: 2598.4996s
	iters: 300, epoch: 5 | loss: 0.1332317
	speed: 0.0790s/iter; left time: 3108.6391s
	iters: 400, epoch: 5 | loss: 0.0638011
	speed: 0.0697s/iter; left time: 2736.3264s
Epoch: 5 cost time: 27.574432373046875
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3676108
	speed: 0.2314s/iter; left time: 9056.0607s
	iters: 200, epoch: 6 | loss: 0.0000455
	speed: 0.0739s/iter; left time: 2885.2603s
	iters: 300, epoch: 6 | loss: 0.0256506
	speed: 0.0748s/iter; left time: 2913.8256s
	iters: 400, epoch: 6 | loss: 0.0020453
	speed: 0.0815s/iter; left time: 3163.4419s
Epoch: 6 cost time: 32.57246470451355
Epoch: 6, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0030364
	speed: 0.2314s/iter; left time: 8960.8196s
	iters: 200, epoch: 7 | loss: 0.0006747
	speed: 0.0776s/iter; left time: 2996.0925s
	iters: 300, epoch: 7 | loss: 0.0619292
	speed: 0.0759s/iter; left time: 2924.8151s
	iters: 400, epoch: 7 | loss: 0.0003519
	speed: 0.0719s/iter; left time: 2760.9574s
Epoch: 7 cost time: 31.62669563293457
Epoch: 7, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979990 --> -0.980444).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000010
	speed: 0.2542s/iter; left time: 9740.2010s
	iters: 200, epoch: 8 | loss: 0.0020260
	speed: 0.0715s/iter; left time: 2730.2476s
	iters: 300, epoch: 8 | loss: 0.0008786
	speed: 0.0853s/iter; left time: 3251.0369s
	iters: 400, epoch: 8 | loss: 0.0000102
	speed: 0.0751s/iter; left time: 2853.0408s
Epoch: 8 cost time: 31.971590280532837
Epoch: 8, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.206 Vali Acc: 0.973 Test Loss: 0.206 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000245
	speed: 0.2305s/iter; left time: 8735.6703s
	iters: 200, epoch: 9 | loss: 0.0009607
	speed: 0.0725s/iter; left time: 2740.4087s
	iters: 300, epoch: 9 | loss: 0.0000754
	speed: 0.0703s/iter; left time: 2650.5621s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 2914.4126s
Epoch: 9 cost time: 31.38550066947937
Epoch: 9, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.2279s/iter; left time: 8541.2908s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 2979.3517s
	iters: 300, epoch: 10 | loss: 0.0000002
	speed: 0.0749s/iter; left time: 2792.8997s
	iters: 400, epoch: 10 | loss: 0.0000163
	speed: 0.0692s/iter; left time: 2574.8380s
Epoch: 10 cost time: 30.869281768798828
Epoch: 10, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
Validation loss decreased (-0.980444 --> -0.981354).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0012408
	speed: 0.2441s/iter; left time: 9048.5522s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0731s/iter; left time: 2702.1837s
	iters: 300, epoch: 11 | loss: 0.0000013
	speed: 0.0805s/iter; left time: 2967.4211s
	iters: 400, epoch: 11 | loss: 0.0000347
	speed: 0.0747s/iter; left time: 2745.7272s
Epoch: 11 cost time: 31.084692001342773
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.179 Vali Acc: 0.981 Test Loss: 0.179 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000027
	speed: 0.2532s/iter; left time: 9283.2040s
	iters: 200, epoch: 12 | loss: 0.0000544
	speed: 0.0735s/iter; left time: 2687.6645s
	iters: 300, epoch: 12 | loss: 0.0000017
	speed: 0.0756s/iter; left time: 2757.8041s
	iters: 400, epoch: 12 | loss: 0.0000016
	speed: 0.0808s/iter; left time: 2937.9153s
Epoch: 12 cost time: 32.37351107597351
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.198 Vali Acc: 0.977 Test Loss: 0.198 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000010
	speed: 0.2300s/iter; left time: 8337.8998s
	iters: 200, epoch: 13 | loss: 0.0000002
	speed: 0.0823s/iter; left time: 2974.2882s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 2720.3431s
	iters: 400, epoch: 13 | loss: 0.0000009
	speed: 0.0760s/iter; left time: 2731.7583s
Epoch: 13 cost time: 32.18520402908325
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.310 Vali Acc: 0.974 Test Loss: 0.310 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000013
	speed: 0.1947s/iter; left time: 6976.2187s
	iters: 200, epoch: 14 | loss: 0.0005015
	speed: 0.0706s/iter; left time: 2524.1337s
	iters: 300, epoch: 14 | loss: 0.0045365
	speed: 0.0818s/iter; left time: 2912.9879s
	iters: 400, epoch: 14 | loss: 0.0000065
	speed: 0.0697s/iter; left time: 2477.0712s
Epoch: 14 cost time: 29.215532779693604
Epoch: 14, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.224 Vali Acc: 0.979 Test Loss: 0.224 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.2502s/iter; left time: 8862.1187s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0707s/iter; left time: 2495.5692s
	iters: 300, epoch: 15 | loss: 0.0000095
	speed: 0.0697s/iter; left time: 2456.0725s
	iters: 400, epoch: 15 | loss: 0.4034997
	speed: 0.0766s/iter; left time: 2688.4947s
Epoch: 15 cost time: 30.616878986358643
Epoch: 15, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.967 Test Loss: 0.299 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0300324
	speed: 0.2239s/iter; left time: 7837.9029s
	iters: 200, epoch: 16 | loss: 0.0000039
	speed: 0.0736s/iter; left time: 2567.5343s
	iters: 300, epoch: 16 | loss: 0.0000002
	speed: 0.0712s/iter; left time: 2478.1317s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0714s/iter; left time: 2478.4809s
Epoch: 16 cost time: 30.543866395950317
Epoch: 16, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.169 Vali Acc: 0.979 Test Loss: 0.169 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2193s/iter; left time: 7586.2744s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 2547.4505s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 2510.3117s
	iters: 400, epoch: 17 | loss: 0.0000017
	speed: 0.0725s/iter; left time: 2485.3754s
Epoch: 17 cost time: 30.11240243911743
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.192 Vali Acc: 0.981 Test Loss: 0.192 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.8481500
	speed: 0.2470s/iter; left time: 8442.9402s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0700s/iter; left time: 2385.9502s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 2748.3620s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0845s/iter; left time: 2861.6005s
Epoch: 18 cost time: 31.98205041885376
Epoch: 18, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.297 Vali Acc: 0.973 Test Loss: 0.297 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.2408s/iter; left time: 8130.2791s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0749s/iter; left time: 2523.2254s
	iters: 300, epoch: 19 | loss: 0.0001283
	speed: 0.0720s/iter; left time: 2418.3821s
	iters: 400, epoch: 19 | loss: 0.0065266
	speed: 0.0793s/iter; left time: 2652.6097s
Epoch: 19 cost time: 31.97654104232788
Epoch: 19, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.273 Vali Acc: 0.978 Test Loss: 0.273 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2227s/iter; left time: 7427.1444s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0769s/iter; left time: 2557.0720s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 2363.9639s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0689s/iter; left time: 2276.6762s
Epoch: 20 cost time: 30.4324893951416
Epoch: 20, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.170 Vali Acc: 0.984 Test Loss: 0.170 Test Acc: 0.984
Validation loss decreased (-0.981354 --> -0.983627).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2195s/iter; left time: 7230.0843s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0743s/iter; left time: 2440.0466s
	iters: 300, epoch: 21 | loss: 0.0000067
	speed: 0.0779s/iter; left time: 2551.1571s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 2337.2653s
Epoch: 21 cost time: 30.52896809577942
Epoch: 21, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.170 Vali Acc: 0.983 Test Loss: 0.170 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2495s/iter; left time: 8116.1063s
	iters: 200, epoch: 22 | loss: 0.0001404
	speed: 0.0710s/iter; left time: 2302.0711s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0669s/iter; left time: 2163.8464s
	iters: 400, epoch: 22 | loss: 0.0017469
	speed: 0.0771s/iter; left time: 2484.8807s
Epoch: 22 cost time: 30.384824991226196
Epoch: 22, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.170 Vali Acc: 0.984 Test Loss: 0.170 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2250s/iter; left time: 7226.1377s
	iters: 200, epoch: 23 | loss: 0.0000005
	speed: 0.0743s/iter; left time: 2378.1860s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 2276.5503s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0745s/iter; left time: 2370.1916s
Epoch: 23 cost time: 31.022627353668213
Epoch: 23, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.985 Test Loss: 0.150 Test Acc: 0.985
Validation loss decreased (-0.983627 --> -0.985446).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2279s/iter; left time: 7224.3939s
	iters: 200, epoch: 24 | loss: 0.0011769
	speed: 0.0807s/iter; left time: 2550.0875s
	iters: 300, epoch: 24 | loss: 0.0000030
	speed: 0.0751s/iter; left time: 2364.4519s
	iters: 400, epoch: 24 | loss: 0.0000011
	speed: 0.0687s/iter; left time: 2157.8784s
Epoch: 24 cost time: 31.146741151809692
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.985 Test Loss: 0.123 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000252
	speed: 0.2517s/iter; left time: 7875.9164s
	iters: 200, epoch: 25 | loss: 0.0276026
	speed: 0.0707s/iter; left time: 2204.6709s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0835s/iter; left time: 2596.2151s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2369.7418s
Epoch: 25 cost time: 32.069559812545776
Epoch: 25, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.397 Vali Acc: 0.976 Test Loss: 0.397 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.2371s/iter; left time: 7319.3925s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 2228.7969s
	iters: 300, epoch: 26 | loss: 0.0000300
	speed: 0.0691s/iter; left time: 2121.1988s
	iters: 400, epoch: 26 | loss: 0.0000426
	speed: 0.0739s/iter; left time: 2259.8999s
Epoch: 26 cost time: 30.80198907852173
Epoch: 26, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.331 Vali Acc: 0.977 Test Loss: 0.331 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2231s/iter; left time: 6796.1098s
	iters: 200, epoch: 27 | loss: 0.0000033
	speed: 0.0765s/iter; left time: 2324.1508s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 2157.3129s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 2118.0738s
Epoch: 27 cost time: 30.39157724380493
Epoch: 27, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.630 Vali Acc: 0.960 Test Loss: 0.630 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2229s/iter; left time: 6699.5065s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0735s/iter; left time: 2202.6299s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0818s/iter; left time: 2442.0140s
	iters: 400, epoch: 28 | loss: 0.3744476
	speed: 0.0690s/iter; left time: 2052.1517s
Epoch: 28 cost time: 30.88985252380371
Epoch: 28, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.174 Vali Acc: 0.983 Test Loss: 0.174 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2584s/iter; left time: 7658.9695s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 2032.5886s
	iters: 300, epoch: 29 | loss: 0.0435702
	speed: 0.0737s/iter; left time: 2170.1676s
	iters: 400, epoch: 29 | loss: 0.0024459
	speed: 0.0803s/iter; left time: 2354.9185s
Epoch: 29 cost time: 31.79728865623474
Epoch: 29, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.170 Vali Acc: 0.988 Test Loss: 0.170 Test Acc: 0.988
Validation loss decreased (-0.985446 --> -0.987720).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2323s/iter; left time: 6788.0915s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 2231.8742s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 2115.7553s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0767s/iter; left time: 2217.3533s
Epoch: 30 cost time: 31.79743480682373
Epoch: 30, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.986 Test Loss: 0.191 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000001
	speed: 0.2230s/iter; left time: 6425.0378s
	iters: 200, epoch: 31 | loss: 0.0000002
	speed: 0.0809s/iter; left time: 2324.1292s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 2052.3250s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 1982.3528s
Epoch: 31 cost time: 30.963013887405396
Epoch: 31, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.330 Vali Acc: 0.982 Test Loss: 0.330 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2291s/iter; left time: 6505.7142s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0669s/iter; left time: 1894.3527s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 2385.9386s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0777s/iter; left time: 2182.9212s
Epoch: 32 cost time: 30.24298906326294
Epoch: 32, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.291 Vali Acc: 0.980 Test Loss: 0.291 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2444s/iter; left time: 6838.9182s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0757s/iter; left time: 2111.2852s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 2055.9784s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2152.6051s
Epoch: 33 cost time: 32.42949390411377
Epoch: 33, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.346 Vali Acc: 0.981 Test Loss: 0.346 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2319s/iter; left time: 6394.9938s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0780s/iter; left time: 2141.7399s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0799s/iter; left time: 2185.7294s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0751s/iter; left time: 2047.1644s
Epoch: 34 cost time: 32.00426626205444
Epoch: 34, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.987 Test Loss: 0.153 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2473s/iter; left time: 6717.7378s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 2106.9446s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0761s/iter; left time: 2052.3883s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0851s/iter; left time: 2285.2889s
Epoch: 35 cost time: 33.60314178466797
Epoch: 35, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.348 Vali Acc: 0.978 Test Loss: 0.348 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2606s/iter; left time: 6968.7081s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 2149.1414s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 2095.7204s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 2006.8337s
Epoch: 36 cost time: 32.65082097053528
Epoch: 36, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.324 Vali Acc: 0.985 Test Loss: 0.324 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.2337s/iter; left time: 6153.3854s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0758s/iter; left time: 1988.3313s
	iters: 300, epoch: 37 | loss: 0.0000028
	speed: 0.0770s/iter; left time: 2012.3919s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 2107.2461s
Epoch: 37 cost time: 32.20677161216736
Epoch: 37, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.239 Vali Acc: 0.983 Test Loss: 0.239 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2377s/iter; left time: 6162.4178s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 1913.5933s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0732s/iter; left time: 1882.8406s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 1958.9759s
Epoch: 38 cost time: 32.170287132263184
Epoch: 38, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.253 Vali Acc: 0.983 Test Loss: 0.253 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2544s/iter; left time: 6488.9412s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 1882.7648s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0840s/iter; left time: 2125.8116s
	iters: 400, epoch: 39 | loss: 0.0003175
	speed: 0.0788s/iter; left time: 1987.0028s
Epoch: 39 cost time: 32.61654186248779
Epoch: 39, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.324 Vali Acc: 0.982 Test Loss: 0.324 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 2625938
model size : 14.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1278407
	speed: 0.0933s/iter; left time: 3845.0021s
	iters: 200, epoch: 1 | loss: 0.2316157
	speed: 0.0850s/iter; left time: 3494.2487s
	iters: 300, epoch: 1 | loss: 0.0475667
	speed: 0.0780s/iter; left time: 3198.4129s
	iters: 400, epoch: 1 | loss: 0.0519818
	speed: 0.0767s/iter; left time: 3135.7710s
Epoch: 1 cost time: 34.518147230148315
Epoch: 1, Steps: 413 | Train Loss: 0.324 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (inf --> -0.961800).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0132773
	speed: 0.2362s/iter; left time: 9632.3087s
	iters: 200, epoch: 2 | loss: 0.0753837
	speed: 0.0732s/iter; left time: 2980.3251s
	iters: 300, epoch: 2 | loss: 0.0112038
	speed: 0.0799s/iter; left time: 3243.6668s
	iters: 400, epoch: 2 | loss: 1.2351086
	speed: 0.0920s/iter; left time: 3723.4716s
Epoch: 2 cost time: 33.835803747177124
Epoch: 2, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.961800 --> -0.968166).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0005543
	speed: 0.2585s/iter; left time: 10437.6416s
	iters: 200, epoch: 3 | loss: 0.3937696
	speed: 0.0880s/iter; left time: 3544.8985s
	iters: 300, epoch: 3 | loss: 0.0017894
	speed: 0.0786s/iter; left time: 3156.9303s
	iters: 400, epoch: 3 | loss: 0.0682222
	speed: 0.0685s/iter; left time: 2745.3910s
Epoch: 3 cost time: 33.410409927368164
Epoch: 3, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.182 Vali Acc: 0.968 Test Loss: 0.182 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4889983
	speed: 0.2343s/iter; left time: 9362.4157s
	iters: 200, epoch: 4 | loss: 0.0001673
	speed: 0.0742s/iter; left time: 2955.7706s
	iters: 300, epoch: 4 | loss: 0.0004189
	speed: 0.0782s/iter; left time: 3108.1519s
	iters: 400, epoch: 4 | loss: 0.0298376
	speed: 0.0810s/iter; left time: 3213.3765s
Epoch: 4 cost time: 32.091150522232056
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
Validation loss decreased (-0.968166 --> -0.969530).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000962
	speed: 0.2350s/iter; left time: 9292.4882s
	iters: 200, epoch: 5 | loss: 0.0014379
	speed: 0.0794s/iter; left time: 3130.9506s
	iters: 300, epoch: 5 | loss: 0.0089919
	speed: 0.0742s/iter; left time: 2920.8825s
	iters: 400, epoch: 5 | loss: 0.0000105
	speed: 0.0744s/iter; left time: 2918.6480s
Epoch: 5 cost time: 32.509300231933594
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
Validation loss decreased (-0.969530 --> -0.972713).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.2499s/iter; left time: 9780.8949s
	iters: 200, epoch: 6 | loss: 0.0004693
	speed: 0.0774s/iter; left time: 3022.3489s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0828s/iter; left time: 3223.7620s
	iters: 400, epoch: 6 | loss: 0.1019600
	speed: 0.0768s/iter; left time: 2984.4193s
Epoch: 6 cost time: 32.73768591880798
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.972713 --> -0.975442).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2530468
	speed: 0.2615s/iter; left time: 10124.9832s
	iters: 200, epoch: 7 | loss: 0.0094541
	speed: 0.0770s/iter; left time: 2975.2520s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 2849.2376s
	iters: 400, epoch: 7 | loss: 0.0004314
	speed: 0.0791s/iter; left time: 3041.0643s
Epoch: 7 cost time: 32.88126230239868
Epoch: 7, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
Validation loss decreased (-0.975442 --> -0.976806).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000030
	speed: 0.2348s/iter; left time: 8996.1733s
	iters: 200, epoch: 8 | loss: 0.0000696
	speed: 0.0833s/iter; left time: 3183.2567s
	iters: 300, epoch: 8 | loss: 0.0000002
	speed: 0.0817s/iter; left time: 3114.9392s
	iters: 400, epoch: 8 | loss: 0.0000037
	speed: 0.0766s/iter; left time: 2911.8071s
Epoch: 8 cost time: 33.45484113693237
Epoch: 8, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.976806 --> -0.979990).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1711871
	speed: 0.2362s/iter; left time: 8949.8252s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0747s/iter; left time: 2824.9696s
	iters: 300, epoch: 9 | loss: 0.0000208
	speed: 0.0750s/iter; left time: 2827.6216s
	iters: 400, epoch: 9 | loss: 0.0000169
	speed: 0.0858s/iter; left time: 3224.4757s
Epoch: 9 cost time: 33.02147579193115
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.982 Test Loss: 0.114 Test Acc: 0.982
Validation loss decreased (-0.979990 --> -0.981809).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0005170
	speed: 0.2605s/iter; left time: 9764.0191s
	iters: 200, epoch: 10 | loss: 0.0002985
	speed: 0.0857s/iter; left time: 3203.6571s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 2719.3189s
	iters: 400, epoch: 10 | loss: 0.0018785
	speed: 0.0734s/iter; left time: 2728.9890s
Epoch: 10 cost time: 32.6114284992218
Epoch: 10, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.206 Vali Acc: 0.980 Test Loss: 0.206 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.2362s/iter; left time: 8755.1904s
	iters: 200, epoch: 11 | loss: 0.3437190
	speed: 0.0754s/iter; left time: 2786.7183s
	iters: 300, epoch: 11 | loss: 0.0000002
	speed: 0.0808s/iter; left time: 2979.4315s
	iters: 400, epoch: 11 | loss: 0.0000652
	speed: 0.0797s/iter; left time: 2932.2181s
Epoch: 11 cost time: 32.328227281570435
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.444 Vali Acc: 0.957 Test Loss: 0.444 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2377s/iter; left time: 8714.3728s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0772s/iter; left time: 2822.6794s
	iters: 300, epoch: 12 | loss: 0.0008041
	speed: 0.0746s/iter; left time: 2720.9845s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 2816.6030s
Epoch: 12 cost time: 32.61015868186951
Epoch: 12, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.245 Vali Acc: 0.978 Test Loss: 0.245 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.2489s/iter; left time: 9020.5670s
	iters: 200, epoch: 13 | loss: 0.0000166
	speed: 0.0880s/iter; left time: 3180.2153s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0852s/iter; left time: 3072.3685s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 2822.8020s
Epoch: 13 cost time: 34.28760528564453
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.237 Vali Acc: 0.977 Test Loss: 0.237 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.8141332
	speed: 0.2399s/iter; left time: 8596.6917s
	iters: 200, epoch: 14 | loss: 0.0007467
	speed: 0.0587s/iter; left time: 2096.8882s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0735s/iter; left time: 2619.7878s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.0839s/iter; left time: 2982.7486s
Epoch: 14 cost time: 29.2183940410614
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.269 Vali Acc: 0.971 Test Loss: 0.269 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1802223
	speed: 0.2374s/iter; left time: 8408.0036s
	iters: 200, epoch: 15 | loss: 0.0000006
	speed: 0.0786s/iter; left time: 2774.8914s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0747s/iter; left time: 2630.4682s
	iters: 400, epoch: 15 | loss: 0.0000004
	speed: 0.0766s/iter; left time: 2688.7382s
Epoch: 15 cost time: 32.75203037261963
Epoch: 15, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0004447
	speed: 0.2359s/iter; left time: 8258.6926s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0892s/iter; left time: 3112.2393s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 2666.2580s
	iters: 400, epoch: 16 | loss: 0.1786727
	speed: 0.0712s/iter; left time: 2470.3773s
Epoch: 16 cost time: 32.622119665145874
Epoch: 16, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.361 Vali Acc: 0.973 Test Loss: 0.361 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2581s/iter; left time: 8927.8901s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0751s/iter; left time: 2589.6708s
	iters: 300, epoch: 17 | loss: 0.0100014
	speed: 0.0806s/iter; left time: 2773.4853s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0786s/iter; left time: 2696.5877s
Epoch: 17 cost time: 32.239925384521484
Epoch: 17, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.210 Vali Acc: 0.979 Test Loss: 0.210 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2418s/iter; left time: 8266.2931s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 2596.1960s
	iters: 300, epoch: 18 | loss: 0.1409859
	speed: 0.0741s/iter; left time: 2518.7882s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 2669.1129s
Epoch: 18 cost time: 32.76353144645691
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.269 Vali Acc: 0.980 Test Loss: 0.269 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2399s/iter; left time: 8102.1870s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 2685.8741s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 2510.7910s
	iters: 400, epoch: 19 | loss: 0.0000446
	speed: 0.0747s/iter; left time: 2500.7330s
Epoch: 19 cost time: 32.37448453903198
Epoch: 19, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.402 Vali Acc: 0.970 Test Loss: 0.402 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 1577362
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1409267
	speed: 0.0992s/iter; left time: 4087.3487s
	iters: 200, epoch: 1 | loss: 0.2693311
	speed: 0.0772s/iter; left time: 3172.5512s
	iters: 300, epoch: 1 | loss: 0.0510756
	speed: 0.0716s/iter; left time: 2937.3812s
	iters: 400, epoch: 1 | loss: 0.1397620
	speed: 0.0844s/iter; left time: 3453.5780s
Epoch: 1 cost time: 34.52134346961975
Epoch: 1, Steps: 413 | Train Loss: 0.319 Vali Loss: 0.088 Vali Acc: 0.969 Test Loss: 0.088 Test Acc: 0.969
Validation loss decreased (inf --> -0.968621).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0081137
	speed: 0.2302s/iter; left time: 9387.7361s
	iters: 200, epoch: 2 | loss: 0.0174422
	speed: 0.0801s/iter; left time: 3257.8489s
	iters: 300, epoch: 2 | loss: 0.0001727
	speed: 0.0753s/iter; left time: 3054.7993s
	iters: 400, epoch: 2 | loss: 1.2787182
	speed: 0.0768s/iter; left time: 3108.2091s
Epoch: 2 cost time: 32.65693950653076
Epoch: 2, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
Validation loss decreased (-0.968621 --> -0.971349).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0002239
	speed: 0.2310s/iter; left time: 9328.1478s
	iters: 200, epoch: 3 | loss: 0.0118202
	speed: 0.0791s/iter; left time: 3187.1178s
	iters: 300, epoch: 3 | loss: 0.0024466
	speed: 0.0765s/iter; left time: 3071.5826s
	iters: 400, epoch: 3 | loss: 0.0858686
	speed: 0.0694s/iter; left time: 2783.2005s
Epoch: 3 cost time: 31.30824565887451
Epoch: 3, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
Validation loss decreased (-0.971349 --> -0.972259).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3047485
	speed: 0.2522s/iter; left time: 10079.4496s
	iters: 200, epoch: 4 | loss: 0.0528346
	speed: 0.0695s/iter; left time: 2770.0058s
	iters: 300, epoch: 4 | loss: 0.0014499
	speed: 0.0734s/iter; left time: 2918.3492s
	iters: 400, epoch: 4 | loss: 0.0008764
	speed: 0.0829s/iter; left time: 3286.3673s
Epoch: 4 cost time: 31.805766105651855
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.050 Vali Acc: 0.986 Test Loss: 0.050 Test Acc: 0.986
Validation loss decreased (-0.972259 --> -0.985902).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0540188
	speed: 0.2441s/iter; left time: 9652.8343s
	iters: 200, epoch: 5 | loss: 0.0017513
	speed: 0.0787s/iter; left time: 3104.7993s
	iters: 300, epoch: 5 | loss: 0.0000477
	speed: 0.0719s/iter; left time: 2830.5670s
	iters: 400, epoch: 5 | loss: 0.0014144
	speed: 0.0732s/iter; left time: 2871.4640s
Epoch: 5 cost time: 31.265010595321655
Epoch: 5, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.234 Vali Acc: 0.963 Test Loss: 0.234 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0005106
	speed: 0.2244s/iter; left time: 8781.0763s
	iters: 200, epoch: 6 | loss: 0.0005116
	speed: 0.0727s/iter; left time: 2839.4383s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 3196.8665s
	iters: 400, epoch: 6 | loss: 0.0019347
	speed: 0.0746s/iter; left time: 2897.2903s
Epoch: 6 cost time: 31.44885277748108
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0016173
	speed: 0.2396s/iter; left time: 9276.7966s
	iters: 200, epoch: 7 | loss: 0.0000004
	speed: 0.0740s/iter; left time: 2859.6754s
	iters: 300, epoch: 7 | loss: 0.0000950
	speed: 0.0750s/iter; left time: 2888.5537s
	iters: 400, epoch: 7 | loss: 0.0055698
	speed: 0.0844s/iter; left time: 3242.2927s
Epoch: 7 cost time: 33.28063917160034
Epoch: 7, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.295 Vali Acc: 0.961 Test Loss: 0.295 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0049711
	speed: 0.2540s/iter; left time: 9730.1715s
	iters: 200, epoch: 8 | loss: 0.0416209
	speed: 0.0876s/iter; left time: 3347.0206s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 2904.1705s
	iters: 400, epoch: 8 | loss: 0.3632493
	speed: 0.0732s/iter; left time: 2782.0823s
Epoch: 8 cost time: 32.79801321029663
Epoch: 8, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.2603913
	speed: 0.2305s/iter; left time: 8735.2749s
	iters: 200, epoch: 9 | loss: 0.0102508
	speed: 0.0723s/iter; left time: 2732.1975s
	iters: 300, epoch: 9 | loss: 0.0008110
	speed: 0.0814s/iter; left time: 3068.2386s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0748s/iter; left time: 2813.2619s
Epoch: 9 cost time: 31.59849500656128
Epoch: 9, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
Validation loss decreased (-0.985902 --> -0.986811).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2333s/iter; left time: 8743.7572s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0738s/iter; left time: 2759.1398s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0685s/iter; left time: 2555.1167s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0784s/iter; left time: 2914.6967s
Epoch: 10 cost time: 31.591196298599243
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.189 Vali Acc: 0.976 Test Loss: 0.189 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0004576
	speed: 0.2520s/iter; left time: 9340.9083s
	iters: 200, epoch: 11 | loss: 0.0060474
	speed: 0.0836s/iter; left time: 3092.2739s
	iters: 300, epoch: 11 | loss: 0.0959305
	speed: 0.0757s/iter; left time: 2789.3617s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0692s/iter; left time: 2544.4684s
Epoch: 11 cost time: 31.233431816101074
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2374s/iter; left time: 8702.9995s
	iters: 200, epoch: 12 | loss: 0.0001205
	speed: 0.0726s/iter; left time: 2653.3938s
	iters: 300, epoch: 12 | loss: 0.0000278
	speed: 0.0772s/iter; left time: 2815.7293s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0786s/iter; left time: 2856.3767s
Epoch: 12 cost time: 31.674182176589966
Epoch: 12, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.185 Vali Acc: 0.982 Test Loss: 0.185 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0002019
	speed: 0.2361s/iter; left time: 8556.9587s
	iters: 200, epoch: 13 | loss: 0.0011169
	speed: 0.0775s/iter; left time: 2800.0337s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0764s/iter; left time: 2755.5155s
	iters: 400, epoch: 13 | loss: 0.0004645
	speed: 0.0795s/iter; left time: 2855.9469s
Epoch: 13 cost time: 33.24249219894409
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2332s/iter; left time: 8354.3376s
	iters: 200, epoch: 14 | loss: 0.0006814
	speed: 0.0866s/iter; left time: 3095.4086s
	iters: 300, epoch: 14 | loss: 0.0000019
	speed: 0.0797s/iter; left time: 2839.1478s
	iters: 400, epoch: 14 | loss: 0.0000059
	speed: 0.0726s/iter; left time: 2579.5447s
Epoch: 14 cost time: 32.835959672927856
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.153 Vali Acc: 0.986 Test Loss: 0.153 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000195
	speed: 0.2497s/iter; left time: 8843.0994s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 2375.0420s
	iters: 300, epoch: 15 | loss: 0.0000004
	speed: 0.0744s/iter; left time: 2621.4499s
	iters: 400, epoch: 15 | loss: 0.0000013
	speed: 0.0819s/iter; left time: 2877.7655s
Epoch: 15 cost time: 30.834468841552734
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.191 Vali Acc: 0.983 Test Loss: 0.191 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000302
	speed: 0.2375s/iter; left time: 8313.9386s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2691.0245s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0744s/iter; left time: 2591.2177s
	iters: 400, epoch: 16 | loss: 0.3780476
	speed: 0.0741s/iter; left time: 2571.6666s
Epoch: 16 cost time: 31.959404945373535
Epoch: 16, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.186 Vali Acc: 0.982 Test Loss: 0.186 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000002
	speed: 0.2308s/iter; left time: 7982.6030s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0781s/iter; left time: 2694.2284s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0770s/iter; left time: 2647.7864s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 2368.2149s
Epoch: 17 cost time: 30.90297222137451
Epoch: 17, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.306 Vali Acc: 0.972 Test Loss: 0.306 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0019846
	speed: 0.2490s/iter; left time: 8509.2907s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0714s/iter; left time: 2433.3119s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 2338.9096s
	iters: 400, epoch: 18 | loss: 0.0014746
	speed: 0.0871s/iter; left time: 2951.7708s
Epoch: 18 cost time: 31.34198808670044
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.231 Vali Acc: 0.983 Test Loss: 0.231 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2399s/iter; left time: 8099.4893s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 2718.4402s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0749s/iter; left time: 2514.2570s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0744s/iter; left time: 2490.6707s
Epoch: 19 cost time: 32.23198342323303
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 1577362
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1239577
	speed: 0.0947s/iter; left time: 3903.5846s
	iters: 200, epoch: 1 | loss: 0.2592819
	speed: 0.0724s/iter; left time: 2977.2144s
	iters: 300, epoch: 1 | loss: 0.0551040
	speed: 0.0735s/iter; left time: 3015.3366s
	iters: 400, epoch: 1 | loss: 0.0269797
	speed: 0.0838s/iter; left time: 3428.4778s
Epoch: 1 cost time: 33.42249512672424
Epoch: 1, Steps: 413 | Train Loss: 0.318 Vali Loss: 0.098 Vali Acc: 0.967 Test Loss: 0.098 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0018813
	speed: 0.2490s/iter; left time: 10155.0611s
	iters: 200, epoch: 2 | loss: 0.0214300
	speed: 0.0791s/iter; left time: 3217.4653s
	iters: 300, epoch: 2 | loss: 0.0127484
	speed: 0.0713s/iter; left time: 2892.5624s
	iters: 400, epoch: 2 | loss: 1.0505229
	speed: 0.0761s/iter; left time: 3082.5303s
Epoch: 2 cost time: 31.35813331604004
Epoch: 2, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0004028
	speed: 0.2341s/iter; left time: 9452.1613s
	iters: 200, epoch: 3 | loss: 0.0624018
	speed: 0.0728s/iter; left time: 2931.3067s
	iters: 300, epoch: 3 | loss: 0.0033238
	speed: 0.0808s/iter; left time: 3247.6801s
	iters: 400, epoch: 3 | loss: 0.0002447
	speed: 0.0711s/iter; left time: 2850.5903s
Epoch: 3 cost time: 30.610654830932617
Epoch: 3, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.254 Vali Acc: 0.954 Test Loss: 0.254 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9164244
	speed: 0.2342s/iter; left time: 9358.8439s
	iters: 200, epoch: 4 | loss: 0.0020623
	speed: 0.0698s/iter; left time: 2781.7391s
	iters: 300, epoch: 4 | loss: 0.0001993
	speed: 0.0729s/iter; left time: 2899.1235s
	iters: 400, epoch: 4 | loss: 0.0009250
	speed: 0.0804s/iter; left time: 3189.1236s
Epoch: 4 cost time: 31.35655117034912
Epoch: 4, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.966802 --> -0.972713).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1571523
	speed: 0.2386s/iter; left time: 9438.3339s
	iters: 200, epoch: 5 | loss: 0.0001368
	speed: 0.0846s/iter; left time: 3338.2197s
	iters: 300, epoch: 5 | loss: 0.0915067
	speed: 0.0739s/iter; left time: 2906.9540s
	iters: 400, epoch: 5 | loss: 0.0000018
	speed: 0.0743s/iter; left time: 2917.5258s
Epoch: 5 cost time: 32.69909191131592
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.194 Vali Acc: 0.966 Test Loss: 0.194 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000117
	speed: 0.2553s/iter; left time: 9990.6471s
	iters: 200, epoch: 6 | loss: 0.0085988
	speed: 0.0734s/iter; left time: 2864.3055s
	iters: 300, epoch: 6 | loss: 0.0000048
	speed: 0.0848s/iter; left time: 3302.9195s
	iters: 400, epoch: 6 | loss: 0.1205344
	speed: 0.0761s/iter; left time: 2956.9377s
Epoch: 6 cost time: 32.110647439956665
Epoch: 6, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.191 Vali Acc: 0.968 Test Loss: 0.191 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000095
	speed: 0.2335s/iter; left time: 9040.3806s
	iters: 200, epoch: 7 | loss: 0.0000010
	speed: 0.0725s/iter; left time: 2801.0463s
	iters: 300, epoch: 7 | loss: 0.0000008
	speed: 0.0702s/iter; left time: 2702.6833s
	iters: 400, epoch: 7 | loss: 0.0213295
	speed: 0.0815s/iter; left time: 3132.2398s
Epoch: 7 cost time: 31.554569005966187
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.104 Vali Acc: 0.985 Test Loss: 0.104 Test Acc: 0.985
Validation loss decreased (-0.972713 --> -0.984992).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000005
	speed: 0.2289s/iter; left time: 8769.6336s
	iters: 200, epoch: 8 | loss: 0.0000008
	speed: 0.0786s/iter; left time: 3002.9079s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 2781.3243s
	iters: 400, epoch: 8 | loss: 0.7490271
	speed: 0.0697s/iter; left time: 2649.7999s
Epoch: 8 cost time: 30.98042368888855
Epoch: 8, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0882025
	speed: 0.2434s/iter; left time: 9225.6725s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0703s/iter; left time: 2656.8407s
	iters: 300, epoch: 9 | loss: 0.0012217
	speed: 0.0822s/iter; left time: 3098.1928s
	iters: 400, epoch: 9 | loss: 0.0000146
	speed: 0.0795s/iter; left time: 2988.3879s
Epoch: 9 cost time: 31.608076810836792
Epoch: 9, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000009
	speed: 0.2381s/iter; left time: 8926.5337s
	iters: 200, epoch: 10 | loss: 0.0009399
	speed: 0.0749s/iter; left time: 2800.4107s
	iters: 300, epoch: 10 | loss: 0.0000127
	speed: 0.0702s/iter; left time: 2615.8581s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0766s/iter; left time: 2848.0487s
Epoch: 10 cost time: 31.842108488082886
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.142 Vali Acc: 0.980 Test Loss: 0.142 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2297s/iter; left time: 8515.7150s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 3034.2257s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0780s/iter; left time: 2874.6318s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0747s/iter; left time: 2746.4267s
Epoch: 11 cost time: 32.35013771057129
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.980 Test Loss: 0.166 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000316
	speed: 0.2462s/iter; left time: 9025.8200s
	iters: 200, epoch: 12 | loss: 0.0000224
	speed: 0.0768s/iter; left time: 2806.1555s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 2991.5317s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0842s/iter; left time: 3063.1162s
Epoch: 12 cost time: 32.78581166267395
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.323 Vali Acc: 0.970 Test Loss: 0.323 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2455s/iter; left time: 8898.7779s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0883s/iter; left time: 3191.2929s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 3193.2690s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0674s/iter; left time: 2423.8540s
Epoch: 13 cost time: 32.46236777305603
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.983 Test Loss: 0.125 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1320s/iter; left time: 4729.6932s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0618s/iter; left time: 2207.2099s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0759s/iter; left time: 2703.1250s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0726s/iter; left time: 2580.1938s
Epoch: 14 cost time: 26.14608144760132
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000007
	speed: 0.2278s/iter; left time: 8068.8644s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0732s/iter; left time: 2585.2620s
	iters: 300, epoch: 15 | loss: 0.0001929
	speed: 0.0748s/iter; left time: 2635.8726s
	iters: 400, epoch: 15 | loss: 0.0009542
	speed: 0.0786s/iter; left time: 2758.6441s
Epoch: 15 cost time: 31.411690711975098
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.141 Vali Acc: 0.982 Test Loss: 0.141 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0002966
	speed: 0.2330s/iter; left time: 8155.4325s
	iters: 200, epoch: 16 | loss: 0.2927901
	speed: 0.0738s/iter; left time: 2577.5296s
	iters: 300, epoch: 16 | loss: 0.0000005
	speed: 0.0747s/iter; left time: 2600.5381s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 2681.3234s
Epoch: 16 cost time: 32.118414640426636
Epoch: 16, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.179 Vali Acc: 0.981 Test Loss: 0.179 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000004
	speed: 0.2504s/iter; left time: 8662.6814s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 2875.6762s
	iters: 300, epoch: 17 | loss: 0.2419101
	speed: 0.0805s/iter; left time: 2768.1786s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 2478.4823s
Epoch: 17 cost time: 32.52240562438965
Epoch: 17, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.196 Vali Acc: 0.978 Test Loss: 0.196 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 1577362
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1629819
	speed: 0.0970s/iter; left time: 3995.2831s
	iters: 200, epoch: 1 | loss: 0.2022317
	speed: 0.0697s/iter; left time: 2864.9184s
	iters: 300, epoch: 1 | loss: 0.0261766
	speed: 0.0705s/iter; left time: 2892.3316s
	iters: 400, epoch: 1 | loss: 0.0890658
	speed: 0.0757s/iter; left time: 3096.4093s
Epoch: 1 cost time: 32.484262228012085
Epoch: 1, Steps: 413 | Train Loss: 0.341 Vali Loss: 0.067 Vali Acc: 0.972 Test Loss: 0.067 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0013895
	speed: 0.2244s/iter; left time: 9151.7620s
	iters: 200, epoch: 2 | loss: 0.0076350
	speed: 0.0813s/iter; left time: 3307.5727s
	iters: 300, epoch: 2 | loss: 0.1126888
	speed: 0.0721s/iter; left time: 2925.1997s
	iters: 400, epoch: 2 | loss: 2.0860522
	speed: 0.0687s/iter; left time: 2782.5296s
Epoch: 2 cost time: 30.063424825668335
Epoch: 2, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0293833
	speed: 0.2439s/iter; left time: 9849.1642s
	iters: 200, epoch: 3 | loss: 0.0003448
	speed: 0.0697s/iter; left time: 2806.4966s
	iters: 300, epoch: 3 | loss: 0.0154230
	speed: 0.0781s/iter; left time: 3136.3785s
	iters: 400, epoch: 3 | loss: 0.0000075
	speed: 0.0735s/iter; left time: 2945.4267s
Epoch: 3 cost time: 30.32504892349243
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.167 Vali Acc: 0.970 Test Loss: 0.167 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2071175
	speed: 0.2267s/iter; left time: 9058.1974s
	iters: 200, epoch: 4 | loss: 0.0000851
	speed: 0.0705s/iter; left time: 2808.2802s
	iters: 300, epoch: 4 | loss: 0.0000075
	speed: 0.0683s/iter; left time: 2713.9898s
	iters: 400, epoch: 4 | loss: 0.0000738
	speed: 0.0746s/iter; left time: 2957.4067s
Epoch: 4 cost time: 30.550752639770508
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.974988).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0481355
	speed: 0.2247s/iter; left time: 8885.2374s
	iters: 200, epoch: 5 | loss: 0.0058428
	speed: 0.0794s/iter; left time: 3132.4365s
	iters: 300, epoch: 5 | loss: 0.0000427
	speed: 0.0732s/iter; left time: 2878.7696s
	iters: 400, epoch: 5 | loss: 0.0000217
	speed: 0.0681s/iter; left time: 2672.3784s
Epoch: 5 cost time: 30.557734489440918
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.974988 --> -0.977261).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5609457
	speed: 0.2487s/iter; left time: 9734.5765s
	iters: 200, epoch: 6 | loss: 0.0000290
	speed: 0.0675s/iter; left time: 2635.6958s
	iters: 300, epoch: 6 | loss: 0.0000092
	speed: 0.0871s/iter; left time: 3391.6653s
	iters: 400, epoch: 6 | loss: 0.0000227
	speed: 0.0766s/iter; left time: 2973.5412s
Epoch: 6 cost time: 31.77257752418518
Epoch: 6, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000070
	speed: 0.2414s/iter; left time: 9346.5452s
	iters: 200, epoch: 7 | loss: 0.0000190
	speed: 0.0699s/iter; left time: 2700.5460s
	iters: 300, epoch: 7 | loss: 0.0000252
	speed: 0.0698s/iter; left time: 2688.0793s
	iters: 400, epoch: 7 | loss: 0.0013630
	speed: 0.0761s/iter; left time: 2924.5949s
Epoch: 7 cost time: 30.479788064956665
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.977261 --> -0.980445).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000585
	speed: 0.2273s/iter; left time: 8707.8476s
	iters: 200, epoch: 8 | loss: 0.0121102
	speed: 0.0757s/iter; left time: 2892.5321s
	iters: 300, epoch: 8 | loss: 0.3615934
	speed: 0.0713s/iter; left time: 2718.2815s
	iters: 400, epoch: 8 | loss: 0.0008201
	speed: 0.0693s/iter; left time: 2635.5891s
Epoch: 8 cost time: 30.246644496917725
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.209 Vali Acc: 0.979 Test Loss: 0.209 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0455262
	speed: 0.2214s/iter; left time: 8390.7246s
	iters: 200, epoch: 9 | loss: 0.0000925
	speed: 0.0690s/iter; left time: 2609.4246s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0811s/iter; left time: 3057.1041s
	iters: 400, epoch: 9 | loss: 0.0012588
	speed: 0.0758s/iter; left time: 2851.0802s
Epoch: 9 cost time: 30.742825031280518
Epoch: 9, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.158 Vali Acc: 0.974 Test Loss: 0.158 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2476s/iter; left time: 9279.6766s
	iters: 200, epoch: 10 | loss: 0.0114925
	speed: 0.0688s/iter; left time: 2570.3471s
	iters: 300, epoch: 10 | loss: 0.0000519
	speed: 0.0670s/iter; left time: 2497.2006s
	iters: 400, epoch: 10 | loss: 0.3699850
	speed: 0.0730s/iter; left time: 2714.8746s
Epoch: 10 cost time: 29.800031900405884
Epoch: 10, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.219 Vali Acc: 0.971 Test Loss: 0.219 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1051370
	speed: 0.1813s/iter; left time: 6722.3498s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0781s/iter; left time: 2888.0162s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 2560.9600s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0705s/iter; left time: 2594.0677s
Epoch: 11 cost time: 29.61566925048828
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.292 Vali Acc: 0.970 Test Loss: 0.292 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0010200
	speed: 0.2188s/iter; left time: 8019.2480s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0743s/iter; left time: 2716.5524s
	iters: 300, epoch: 12 | loss: 0.0000370
	speed: 0.0756s/iter; left time: 2756.7084s
	iters: 400, epoch: 12 | loss: 0.0000012
	speed: 0.0665s/iter; left time: 2418.9132s
Epoch: 12 cost time: 30.06776213645935
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.288 Vali Acc: 0.968 Test Loss: 0.288 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2451s/iter; left time: 8883.6282s
	iters: 200, epoch: 13 | loss: 0.0015793
	speed: 0.0664s/iter; left time: 2400.0956s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2778.4246s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0763s/iter; left time: 2744.3462s
Epoch: 13 cost time: 30.113201141357422
Epoch: 13, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.498 Vali Acc: 0.960 Test Loss: 0.498 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2436s/iter; left time: 8727.1127s
	iters: 200, epoch: 14 | loss: 0.0000076
	speed: 0.0708s/iter; left time: 2529.4291s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0686s/iter; left time: 2442.9129s
	iters: 400, epoch: 14 | loss: 0.0000003
	speed: 0.0741s/iter; left time: 2633.5028s
Epoch: 14 cost time: 30.41414976119995
Epoch: 14, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.423 Vali Acc: 0.970 Test Loss: 0.423 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0001358
	speed: 0.2295s/iter; left time: 8127.0892s
	iters: 200, epoch: 15 | loss: 0.0007220
	speed: 0.0735s/iter; left time: 2595.9027s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0700s/iter; left time: 2463.9338s
	iters: 400, epoch: 15 | loss: 0.0000349
	speed: 0.0694s/iter; left time: 2437.6812s
Epoch: 15 cost time: 29.99883484840393
Epoch: 15, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.328 Vali Acc: 0.964 Test Loss: 0.328 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2244s/iter; left time: 7856.0154s
	iters: 200, epoch: 16 | loss: 0.0016370
	speed: 0.0778s/iter; left time: 2714.9951s
	iters: 300, epoch: 16 | loss: 0.0933463
	speed: 0.0808s/iter; left time: 2811.9826s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0721s/iter; left time: 2502.5912s
Epoch: 16 cost time: 31.231722831726074
Epoch: 16, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.200 Vali Acc: 0.982 Test Loss: 0.200 Test Acc: 0.982
Validation loss decreased (-0.980445 --> -0.981808).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2864879
	speed: 0.2502s/iter; left time: 8654.6016s
	iters: 200, epoch: 17 | loss: 0.0132442
	speed: 0.0698s/iter; left time: 2405.9023s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0774s/iter; left time: 2663.3509s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0742s/iter; left time: 2545.1947s
Epoch: 17 cost time: 30.69281768798828
Epoch: 17, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.244 Vali Acc: 0.980 Test Loss: 0.244 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0118564
	speed: 0.2212s/iter; left time: 7561.0788s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0700s/iter; left time: 2385.9134s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0726s/iter; left time: 2465.9855s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2610.9188s
Epoch: 18 cost time: 30.989428997039795
Epoch: 18, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.302 Vali Acc: 0.973 Test Loss: 0.302 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2191s/iter; left time: 7399.2603s
	iters: 200, epoch: 19 | loss: 0.0002319
	speed: 0.0694s/iter; left time: 2337.8064s
	iters: 300, epoch: 19 | loss: 0.0000098
	speed: 0.0673s/iter; left time: 2259.2525s
	iters: 400, epoch: 19 | loss: 0.0000088
	speed: 0.0683s/iter; left time: 2284.3401s
Epoch: 19 cost time: 28.887686729431152
Epoch: 19, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.978 Test Loss: 0.197 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000190
	speed: 0.2409s/iter; left time: 8033.7509s
	iters: 200, epoch: 20 | loss: 0.0000179
	speed: 0.0700s/iter; left time: 2328.9972s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 2621.6637s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0668s/iter; left time: 2206.7956s
Epoch: 20 cost time: 29.50576114654541
Epoch: 20, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.308 Vali Acc: 0.981 Test Loss: 0.308 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2218s/iter; left time: 7306.1736s
	iters: 200, epoch: 21 | loss: 1.1603085
	speed: 0.0665s/iter; left time: 2185.2171s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0673s/iter; left time: 2201.9784s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 2454.8178s
Epoch: 21 cost time: 29.595070362091064
Epoch: 21, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.156 Vali Acc: 0.983 Test Loss: 0.156 Test Acc: 0.983
Validation loss decreased (-0.981808 --> -0.983173).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2278s/iter; left time: 7408.9308s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 2311.8308s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0712s/iter; left time: 2302.9262s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 2308.2245s
Epoch: 22 cost time: 30.12337374687195
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.600 Vali Acc: 0.971 Test Loss: 0.600 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2419s/iter; left time: 7769.2129s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0793s/iter; left time: 2538.0873s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0731s/iter; left time: 2334.2304s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 2258.6749s
Epoch: 23 cost time: 31.077038288116455
Epoch: 23, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.236 Vali Acc: 0.978 Test Loss: 0.236 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0595198
	speed: 0.2353s/iter; left time: 7460.5907s
	iters: 200, epoch: 24 | loss: 0.2824101
	speed: 0.0705s/iter; left time: 2227.7237s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0757s/iter; left time: 2383.4466s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0714s/iter; left time: 2242.5800s
Epoch: 24 cost time: 29.726255416870117
Epoch: 24, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.342 Vali Acc: 0.979 Test Loss: 0.342 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2153s/iter; left time: 6736.6725s
	iters: 200, epoch: 25 | loss: 0.0000011
	speed: 0.0566s/iter; left time: 1766.2444s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 1793.2683s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 2292.9613s
Epoch: 25 cost time: 26.442711353302002
Epoch: 25, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.400 Vali Acc: 0.976 Test Loss: 0.400 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000018
	speed: 0.2177s/iter; left time: 6721.0713s
	iters: 200, epoch: 26 | loss: 0.3997090
	speed: 0.0678s/iter; left time: 2086.0779s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 2070.4313s
	iters: 400, epoch: 26 | loss: 0.0000055
	speed: 0.0724s/iter; left time: 2213.9107s
Epoch: 26 cost time: 29.24488115310669
Epoch: 26, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.255 Vali Acc: 0.979 Test Loss: 0.255 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2412s/iter; left time: 7346.8464s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 2229.0844s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0663s/iter; left time: 2007.1691s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0652s/iter; left time: 1967.8399s
Epoch: 27 cost time: 28.916752099990845
Epoch: 27, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.391 Vali Acc: 0.976 Test Loss: 0.391 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2198s/iter; left time: 6605.6815s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 2149.1209s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 2176.2277s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0704s/iter; left time: 2093.4945s
Epoch: 28 cost time: 29.74851393699646
Epoch: 28, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.239 Vali Acc: 0.982 Test Loss: 0.239 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2139s/iter; left time: 6339.9894s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 2072.4118s
	iters: 300, epoch: 29 | loss: 0.0000004
	speed: 0.0749s/iter; left time: 2203.4332s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 2034.7373s
Epoch: 29 cost time: 29.663864612579346
Epoch: 29, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.214 Vali Acc: 0.983 Test Loss: 0.214 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2451s/iter; left time: 7163.0279s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 1841.0856s
	iters: 300, epoch: 30 | loss: 0.0000020
	speed: 0.0728s/iter; left time: 2112.7014s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 2094.8834s
Epoch: 30 cost time: 29.26508092880249
Epoch: 30, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.987 Test Loss: 0.135 Test Acc: 0.987
Validation loss decreased (-0.983173 --> -0.986811).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2368s/iter; left time: 6821.1835s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 1928.9854s
	iters: 300, epoch: 31 | loss: 0.0000005
	speed: 0.0676s/iter; left time: 1932.7639s
	iters: 400, epoch: 31 | loss: 0.0048158
	speed: 0.0747s/iter; left time: 2130.7917s
Epoch: 31 cost time: 29.348400831222534
Epoch: 31, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.274 Vali Acc: 0.982 Test Loss: 0.274 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2225s/iter; left time: 6318.7785s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 1954.6694s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0681s/iter; left time: 1921.6412s
	iters: 400, epoch: 32 | loss: 0.2945527
	speed: 0.0723s/iter; left time: 2030.2516s
Epoch: 32 cost time: 29.789700031280518
Epoch: 32, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.303 Vali Acc: 0.978 Test Loss: 0.303 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2388s/iter; left time: 6683.9870s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 1980.0081s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0644s/iter; left time: 1788.1645s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 1810.0049s
Epoch: 33 cost time: 28.750101566314697
Epoch: 33, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.303 Vali Acc: 0.980 Test Loss: 0.303 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2363s/iter; left time: 6516.0147s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 1812.7404s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0887s/iter; left time: 2428.4376s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0849s/iter; left time: 2316.4324s
Epoch: 34 cost time: 32.20638823509216
Epoch: 34, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.691 Vali Acc: 0.971 Test Loss: 0.691 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1889s/iter; left time: 5129.5911s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0537s/iter; left time: 1452.4442s
	iters: 300, epoch: 35 | loss: 0.0000001
	speed: 0.0726s/iter; left time: 1956.7575s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 1884.5180s
Epoch: 35 cost time: 25.849759817123413
Epoch: 35, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.281 Vali Acc: 0.983 Test Loss: 0.281 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0000051
	speed: 0.2190s/iter; left time: 5858.1974s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0683s/iter; left time: 1819.1911s
	iters: 300, epoch: 36 | loss: 0.0015982
	speed: 0.0705s/iter; left time: 1870.5753s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0679s/iter; left time: 1795.9290s
Epoch: 36 cost time: 28.99731683731079
Epoch: 36, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.237 Vali Acc: 0.985 Test Loss: 0.237 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0000002
	speed: 0.2054s/iter; left time: 5409.5863s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1383.5797s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 1494.5398s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 1923.2806s
Epoch: 37 cost time: 25.66070556640625
Epoch: 37, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.387 Vali Acc: 0.974 Test Loss: 0.387 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2567s/iter; left time: 6653.5268s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 1742.9294s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0658s/iter; left time: 1692.1685s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0699s/iter; left time: 1791.5930s
Epoch: 38 cost time: 29.47990345954895
Epoch: 38, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.175 Vali Acc: 0.983 Test Loss: 0.175 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2208s/iter; left time: 5631.0148s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0700s/iter; left time: 1779.5601s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0671s/iter; left time: 1697.6312s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0681s/iter; left time: 1717.0083s
Epoch: 39 cost time: 28.946587800979614
Epoch: 39, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.986 Test Loss: 0.204 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.2220s/iter; left time: 5572.0897s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 1789.2805s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0679s/iter; left time: 1690.0753s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0707s/iter; left time: 1753.3417s
Epoch: 40 cost time: 29.570374250411987
Epoch: 40, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.466 Vali Acc: 0.977 Test Loss: 0.466 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 1577362
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6842910
	speed: 0.0911s/iter; left time: 3752.2877s
	iters: 200, epoch: 1 | loss: 0.2904026
	speed: 0.0777s/iter; left time: 3192.9214s
	iters: 300, epoch: 1 | loss: 0.0860921
	speed: 0.0737s/iter; left time: 3021.0061s
	iters: 400, epoch: 1 | loss: 0.0827999
	speed: 0.0666s/iter; left time: 2723.9535s
Epoch: 1 cost time: 31.99475598335266
Epoch: 1, Steps: 413 | Train Loss: 0.331 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0192065
	speed: 0.2106s/iter; left time: 8587.9529s
	iters: 200, epoch: 2 | loss: 0.0054092
	speed: 0.0675s/iter; left time: 2744.4615s
	iters: 300, epoch: 2 | loss: 0.0564027
	speed: 0.0708s/iter; left time: 2873.0740s
	iters: 400, epoch: 2 | loss: 0.0581645
	speed: 0.0670s/iter; left time: 2710.9380s
Epoch: 2 cost time: 28.507059335708618
Epoch: 2, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
Validation loss decreased (-0.962709 --> -0.974533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0381389
	speed: 0.2181s/iter; left time: 8806.7062s
	iters: 200, epoch: 3 | loss: 0.0001391
	speed: 0.0681s/iter; left time: 2743.8364s
	iters: 300, epoch: 3 | loss: 0.0010244
	speed: 0.0713s/iter; left time: 2865.8622s
	iters: 400, epoch: 3 | loss: 0.0017958
	speed: 0.0650s/iter; left time: 2606.2224s
Epoch: 3 cost time: 28.57491135597229
Epoch: 3, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.229 Vali Acc: 0.951 Test Loss: 0.229 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000801
	speed: 0.2387s/iter; left time: 9537.5309s
	iters: 200, epoch: 4 | loss: 0.0002047
	speed: 0.0649s/iter; left time: 2586.2118s
	iters: 300, epoch: 4 | loss: 0.0000475
	speed: 0.0682s/iter; left time: 2711.0957s
	iters: 400, epoch: 4 | loss: 0.0249188
	speed: 0.0765s/iter; left time: 3034.9380s
Epoch: 4 cost time: 29.52554750442505
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.192 Vali Acc: 0.965 Test Loss: 0.192 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0130292
	speed: 0.2383s/iter; left time: 9424.3798s
	iters: 200, epoch: 5 | loss: 0.0000001
	speed: 0.0675s/iter; left time: 2663.8930s
	iters: 300, epoch: 5 | loss: 0.1486867
	speed: 0.0660s/iter; left time: 2597.6621s
	iters: 400, epoch: 5 | loss: 0.0009451
	speed: 0.0740s/iter; left time: 2906.1488s
Epoch: 5 cost time: 29.200974702835083
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.974533 --> -0.979535).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000041
	speed: 0.2187s/iter; left time: 8560.7135s
	iters: 200, epoch: 6 | loss: 0.0000090
	speed: 0.0717s/iter; left time: 2800.0170s
	iters: 300, epoch: 6 | loss: 0.0000005
	speed: 0.0705s/iter; left time: 2746.4699s
	iters: 400, epoch: 6 | loss: 0.0002800
	speed: 0.0688s/iter; left time: 2671.3026s
Epoch: 6 cost time: 29.59960126876831
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.963 Test Loss: 0.221 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0173174
	speed: 0.1816s/iter; left time: 7031.9243s
	iters: 200, epoch: 7 | loss: 0.0000045
	speed: 0.0791s/iter; left time: 3055.9843s
	iters: 300, epoch: 7 | loss: 0.0000334
	speed: 0.0711s/iter; left time: 2740.8324s
	iters: 400, epoch: 7 | loss: 0.0022952
	speed: 0.0707s/iter; left time: 2715.8088s
Epoch: 7 cost time: 29.72538471221924
Epoch: 7, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.259 Vali Acc: 0.967 Test Loss: 0.259 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000073
	speed: 0.2415s/iter; left time: 9252.9322s
	iters: 200, epoch: 8 | loss: 0.0463703
	speed: 0.0737s/iter; left time: 2816.7361s
	iters: 300, epoch: 8 | loss: 0.0875506
	speed: 0.0714s/iter; left time: 2719.8714s
	iters: 400, epoch: 8 | loss: 0.0000070
	speed: 0.0642s/iter; left time: 2441.5610s
Epoch: 8 cost time: 29.322664499282837
Epoch: 8, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.208 Vali Acc: 0.969 Test Loss: 0.208 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0078595
	speed: 0.2112s/iter; left time: 8004.7952s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 2620.3841s
	iters: 300, epoch: 9 | loss: 0.0007260
	speed: 0.0685s/iter; left time: 2582.1286s
	iters: 400, epoch: 9 | loss: 0.0000033
	speed: 0.0657s/iter; left time: 2468.6015s
Epoch: 9 cost time: 28.17901086807251
Epoch: 9, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.140 Vali Acc: 0.980 Test Loss: 0.140 Test Acc: 0.980
Validation loss decreased (-0.979535 --> -0.980444).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2113951
	speed: 0.2111s/iter; left time: 7913.2190s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 2568.7813s
	iters: 300, epoch: 10 | loss: 0.0000002
	speed: 0.0700s/iter; left time: 2608.5312s
	iters: 400, epoch: 10 | loss: 0.0001052
	speed: 0.0655s/iter; left time: 2434.9994s
Epoch: 10 cost time: 28.562032222747803
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
Validation loss decreased (-0.980444 --> -0.982264).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000884
	speed: 0.2435s/iter; left time: 9027.7448s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 2513.7345s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0736s/iter; left time: 2713.4956s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0704s/iter; left time: 2587.1038s
Epoch: 11 cost time: 29.42126202583313
Epoch: 11, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.979 Test Loss: 0.158 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2309s/iter; left time: 8462.6961s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 2532.0599s
	iters: 300, epoch: 12 | loss: 0.0167629
	speed: 0.0723s/iter; left time: 2636.7431s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 2496.0038s
Epoch: 12 cost time: 29.283673524856567
Epoch: 12, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.091 Vali Acc: 0.986 Test Loss: 0.091 Test Acc: 0.986
Validation loss decreased (-0.982264 --> -0.985902).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2232s/iter; left time: 8091.4089s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0708s/iter; left time: 2558.6815s
	iters: 300, epoch: 13 | loss: 0.0000008
	speed: 0.0752s/iter; left time: 2711.3993s
	iters: 400, epoch: 13 | loss: 0.0000035
	speed: 0.0695s/iter; left time: 2498.1428s
Epoch: 13 cost time: 29.79236364364624
Epoch: 13, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.982 Test Loss: 0.116 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0085954
	speed: 0.2146s/iter; left time: 7690.1247s
	iters: 200, epoch: 14 | loss: 0.0152133
	speed: 0.0691s/iter; left time: 2468.1401s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0772s/iter; left time: 2751.5184s
	iters: 400, epoch: 14 | loss: 0.0000116
	speed: 0.0686s/iter; left time: 2438.6277s
Epoch: 14 cost time: 29.700139045715332
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.221 Vali Acc: 0.977 Test Loss: 0.221 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.2371s/iter; left time: 8397.5329s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0690s/iter; left time: 2437.7588s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0660s/iter; left time: 2325.1444s
	iters: 400, epoch: 15 | loss: 0.0000272
	speed: 0.0701s/iter; left time: 2460.4994s
Epoch: 15 cost time: 28.987276792526245
Epoch: 15, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.327 Vali Acc: 0.971 Test Loss: 0.327 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000003
	speed: 0.2269s/iter; left time: 7942.9096s
	iters: 200, epoch: 16 | loss: 0.0001013
	speed: 0.0653s/iter; left time: 2279.0731s
	iters: 300, epoch: 16 | loss: 0.0000002
	speed: 0.0671s/iter; left time: 2334.6326s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 2543.2278s
Epoch: 16 cost time: 28.924114227294922
Epoch: 16, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000019
	speed: 0.2154s/iter; left time: 7451.7484s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 2295.0693s
	iters: 300, epoch: 17 | loss: 0.0000075
	speed: 0.0684s/iter; left time: 2353.1281s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0783s/iter; left time: 2684.5503s
Epoch: 17 cost time: 29.90661644935608
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.977 Test Loss: 0.203 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2544s/iter; left time: 8696.1231s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0716s/iter; left time: 2438.6143s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 2385.5641s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0706s/iter; left time: 2390.9202s
Epoch: 18 cost time: 30.860978841781616
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.196 Vali Acc: 0.979 Test Loss: 0.196 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2163s/iter; left time: 7305.2319s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 2416.8455s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0690s/iter; left time: 2317.1826s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0711s/iter; left time: 2381.1258s
Epoch: 19 cost time: 29.649128437042236
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.226 Vali Acc: 0.982 Test Loss: 0.226 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2143s/iter; left time: 7147.9310s
	iters: 200, epoch: 20 | loss: 0.0640618
	speed: 0.0692s/iter; left time: 2302.3287s
	iters: 300, epoch: 20 | loss: 0.0000001
	speed: 0.0688s/iter; left time: 2282.1128s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0695s/iter; left time: 2296.4514s
Epoch: 20 cost time: 28.874178647994995
Epoch: 20, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.987 Test Loss: 0.134 Test Acc: 0.987
Validation loss decreased (-0.985902 --> -0.986811).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0031164
	speed: 0.2469s/iter; left time: 8133.4930s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0711s/iter; left time: 2336.3712s
	iters: 300, epoch: 21 | loss: 0.0000050
	speed: 0.0647s/iter; left time: 2118.4814s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 2266.5878s
Epoch: 21 cost time: 29.08947491645813
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.151 Vali Acc: 0.986 Test Loss: 0.151 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2108s/iter; left time: 6856.9481s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 2179.4120s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0669s/iter; left time: 2161.5780s
	iters: 400, epoch: 22 | loss: 0.0000259
	speed: 0.0663s/iter; left time: 2137.4793s
Epoch: 22 cost time: 27.310182332992554
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.988 Test Loss: 0.145 Test Acc: 0.988
Validation loss decreased (-0.986811 --> -0.987720).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2168s/iter; left time: 6962.8254s
	iters: 200, epoch: 23 | loss: 0.0000036
	speed: 0.0720s/iter; left time: 2303.9706s
	iters: 300, epoch: 23 | loss: 0.0000019
	speed: 0.0684s/iter; left time: 2183.8980s
	iters: 400, epoch: 23 | loss: 0.0000028
	speed: 0.0698s/iter; left time: 2219.3615s
Epoch: 23 cost time: 29.14828610420227
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.980 Test Loss: 0.206 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2171s/iter; left time: 6881.6976s
	iters: 200, epoch: 24 | loss: 0.0000062
	speed: 0.0747s/iter; left time: 2362.2384s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0707s/iter; left time: 2228.7285s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0698s/iter; left time: 2191.3503s
Epoch: 24 cost time: 29.5959734916687
Epoch: 24, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.215 Vali Acc: 0.981 Test Loss: 0.215 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2345s/iter; left time: 7337.1316s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0747s/iter; left time: 2329.5207s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 2097.8340s
	iters: 400, epoch: 25 | loss: 0.0000064
	speed: 0.0649s/iter; left time: 2012.3837s
Epoch: 25 cost time: 29.09933614730835
Epoch: 25, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.301 Vali Acc: 0.973 Test Loss: 0.301 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2173s/iter; left time: 6709.0704s
	iters: 200, epoch: 26 | loss: 0.0661472
	speed: 0.0676s/iter; left time: 2081.4614s
	iters: 300, epoch: 26 | loss: 0.0000219
	speed: 0.0682s/iter; left time: 2091.5846s
	iters: 400, epoch: 26 | loss: 0.0000002
	speed: 0.0643s/iter; left time: 1966.8882s
Epoch: 26 cost time: 27.903680086135864
Epoch: 26, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.210 Vali Acc: 0.983 Test Loss: 0.210 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2096s/iter; left time: 6384.9452s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0658s/iter; left time: 1998.2680s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0667s/iter; left time: 2019.0318s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 1992.4881s
Epoch: 27 cost time: 27.900384664535522
Epoch: 27, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.177 Vali Acc: 0.984 Test Loss: 0.177 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2322s/iter; left time: 6979.0144s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0699s/iter; left time: 2094.5050s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0753s/iter; left time: 2246.2397s
	iters: 400, epoch: 28 | loss: 0.0052036
	speed: 0.0691s/iter; left time: 2056.3258s
Epoch: 28 cost time: 29.426244258880615
Epoch: 28, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.384 Vali Acc: 0.973 Test Loss: 0.384 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000006
	speed: 0.2220s/iter; left time: 6579.3013s
	iters: 200, epoch: 29 | loss: 0.0001674
	speed: 0.0672s/iter; left time: 1985.2681s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 2086.4342s
	iters: 400, epoch: 29 | loss: 0.0000672
	speed: 0.0694s/iter; left time: 2035.4824s
Epoch: 29 cost time: 28.604372024536133
Epoch: 29, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.279 Vali Acc: 0.977 Test Loss: 0.279 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2098s/iter; left time: 6132.1769s
	iters: 200, epoch: 30 | loss: 0.0000210
	speed: 0.0668s/iter; left time: 1946.8947s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 2102.1124s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 1953.2360s
Epoch: 30 cost time: 28.81084680557251
Epoch: 30, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.985 Test Loss: 0.200 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2283s/iter; left time: 6576.2979s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 2046.7543s
	iters: 300, epoch: 31 | loss: 0.0000005
	speed: 0.0749s/iter; left time: 2143.8640s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 1849.1373s
Epoch: 31 cost time: 29.514140129089355
Epoch: 31, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.319 Vali Acc: 0.974 Test Loss: 0.319 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000542
	speed: 0.2395s/iter; left time: 6802.3834s
	iters: 200, epoch: 32 | loss: 0.0000001
	speed: 0.0633s/iter; left time: 1791.7999s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0692s/iter; left time: 1951.6380s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0663s/iter; left time: 1861.8614s
Epoch: 32 cost time: 27.955145359039307
Epoch: 32, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.146 Vali Acc: 0.985 Test Loss: 0.146 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 1053074
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6231328
	speed: 0.0793s/iter; left time: 3267.4116s
	iters: 200, epoch: 1 | loss: 0.3476389
	speed: 0.0547s/iter; left time: 2247.1998s
	iters: 300, epoch: 1 | loss: 0.0799155
	speed: 0.0641s/iter; left time: 2626.6153s
	iters: 400, epoch: 1 | loss: 0.1063443
	speed: 0.0712s/iter; left time: 2912.7342s
Epoch: 1 cost time: 27.978702306747437
Epoch: 1, Steps: 413 | Train Loss: 0.328 Vali Loss: 0.109 Vali Acc: 0.966 Test Loss: 0.109 Test Acc: 0.966
Validation loss decreased (inf --> -0.966347).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0122923
	speed: 0.2423s/iter; left time: 9881.4124s
	iters: 200, epoch: 2 | loss: 0.0057585
	speed: 0.0683s/iter; left time: 2781.0207s
	iters: 300, epoch: 2 | loss: 0.0357790
	speed: 0.0638s/iter; left time: 2588.5468s
	iters: 400, epoch: 2 | loss: 0.3837081
	speed: 0.0742s/iter; left time: 3004.1404s
Epoch: 2 cost time: 29.37012791633606
Epoch: 2, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
Validation loss decreased (-0.966347 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0048325
	speed: 0.2198s/iter; left time: 8872.6643s
	iters: 200, epoch: 3 | loss: 0.0000880
	speed: 0.0811s/iter; left time: 3266.5538s
	iters: 300, epoch: 3 | loss: 0.1139329
	speed: 0.0837s/iter; left time: 3362.6223s
	iters: 400, epoch: 3 | loss: 0.1797697
	speed: 0.0806s/iter; left time: 3231.7543s
Epoch: 3 cost time: 31.16920495033264
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000620
	speed: 0.1734s/iter; left time: 6929.3846s
	iters: 200, epoch: 4 | loss: 0.1831034
	speed: 0.0722s/iter; left time: 2876.4012s
	iters: 300, epoch: 4 | loss: 0.1476654
	speed: 0.0674s/iter; left time: 2678.1017s
	iters: 400, epoch: 4 | loss: 0.0002352
	speed: 0.0675s/iter; left time: 2675.8560s
Epoch: 4 cost time: 27.348188877105713
Epoch: 4, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.205 Vali Acc: 0.962 Test Loss: 0.205 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0014489
	speed: 0.2117s/iter; left time: 8371.9632s
	iters: 200, epoch: 5 | loss: 0.0005142
	speed: 0.0711s/iter; left time: 2803.1250s
	iters: 300, epoch: 5 | loss: 0.4386930
	speed: 0.0682s/iter; left time: 2683.4126s
	iters: 400, epoch: 5 | loss: 0.1111947
	speed: 0.0677s/iter; left time: 2655.4756s
Epoch: 5 cost time: 28.65580987930298
Epoch: 5, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
Validation loss decreased (-0.970440 --> -0.972259).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0003331
	speed: 0.2106s/iter; left time: 8241.0722s
	iters: 200, epoch: 6 | loss: 0.0643690
	speed: 0.0684s/iter; left time: 2671.5237s
	iters: 300, epoch: 6 | loss: 0.0000017
	speed: 0.0731s/iter; left time: 2844.7136s
	iters: 400, epoch: 6 | loss: 0.2316138
	speed: 0.0698s/iter; left time: 2708.8186s
Epoch: 6 cost time: 28.913012981414795
Epoch: 6, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.214 Vali Acc: 0.970 Test Loss: 0.214 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000001
	speed: 0.2436s/iter; left time: 9434.0609s
	iters: 200, epoch: 7 | loss: 0.0000003
	speed: 0.0663s/iter; left time: 2561.4363s
	iters: 300, epoch: 7 | loss: 0.0000098
	speed: 0.0684s/iter; left time: 2635.8585s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.0690s/iter; left time: 2652.8570s
Epoch: 7 cost time: 28.73433208465576
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.974987).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000266
	speed: 0.2136s/iter; left time: 8181.3783s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0652s/iter; left time: 2490.1995s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0648s/iter; left time: 2469.6895s
	iters: 400, epoch: 8 | loss: 0.0000011
	speed: 0.0725s/iter; left time: 2755.4470s
Epoch: 8 cost time: 28.89310359954834
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000833
	speed: 0.2220s/iter; left time: 8411.6210s
	iters: 200, epoch: 9 | loss: 0.0001737
	speed: 0.0719s/iter; left time: 2719.2895s
	iters: 300, epoch: 9 | loss: 0.0077638
	speed: 0.0669s/iter; left time: 2521.9393s
	iters: 400, epoch: 9 | loss: 0.0000362
	speed: 0.0680s/iter; left time: 2558.2916s
Epoch: 9 cost time: 28.89662790298462
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.974987 --> -0.984993).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000270
	speed: 0.2400s/iter; left time: 8994.6835s
	iters: 200, epoch: 10 | loss: 2.1688700
	speed: 0.0761s/iter; left time: 2843.2380s
	iters: 300, epoch: 10 | loss: 0.0000237
	speed: 0.0724s/iter; left time: 2699.9969s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 2578.4696s
Epoch: 10 cost time: 30.365195989608765
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0195027
	speed: 0.2350s/iter; left time: 8713.4486s
	iters: 200, epoch: 11 | loss: 0.2872965
	speed: 0.0659s/iter; left time: 2437.4599s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0727s/iter; left time: 2682.3461s
	iters: 400, epoch: 11 | loss: 0.0000110
	speed: 0.0660s/iter; left time: 2426.6763s
Epoch: 11 cost time: 28.372246503829956
Epoch: 11, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.9211252
	speed: 0.2224s/iter; left time: 8152.0309s
	iters: 200, epoch: 12 | loss: 0.0001335
	speed: 0.0649s/iter; left time: 2373.4314s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0658s/iter; left time: 2400.6684s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0686s/iter; left time: 2495.3025s
Epoch: 12 cost time: 27.969112396240234
Epoch: 12, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.197 Vali Acc: 0.978 Test Loss: 0.197 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000441
	speed: 0.2161s/iter; left time: 7833.9097s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0713s/iter; left time: 2575.3970s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 2386.6858s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 2563.5376s
Epoch: 13 cost time: 30.00181293487549
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.164 Vali Acc: 0.983 Test Loss: 0.164 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000328
	speed: 0.2473s/iter; left time: 8862.3109s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0751s/iter; left time: 2683.4153s
	iters: 300, epoch: 14 | loss: 0.0000031
	speed: 0.0644s/iter; left time: 2293.4089s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 2456.1308s
Epoch: 14 cost time: 29.164771556854248
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000005
	speed: 0.2117s/iter; left time: 7499.5111s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0704s/iter; left time: 2487.1040s
	iters: 300, epoch: 15 | loss: 0.0000909
	speed: 0.0702s/iter; left time: 2473.0692s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0676s/iter; left time: 2372.8267s
Epoch: 15 cost time: 28.849786281585693
Epoch: 15, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.196 Vali Acc: 0.974 Test Loss: 0.196 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2139s/iter; left time: 7487.6957s
	iters: 200, epoch: 16 | loss: 0.0000028
	speed: 0.0673s/iter; left time: 2349.5093s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 2537.2108s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0699s/iter; left time: 2427.2112s
Epoch: 16 cost time: 29.047704458236694
Epoch: 16, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.309 Vali Acc: 0.967 Test Loss: 0.309 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2495s/iter; left time: 8630.5316s
	iters: 200, epoch: 17 | loss: 0.0000079
	speed: 0.0638s/iter; left time: 2199.6296s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0670s/iter; left time: 2304.3853s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 2590.8083s
Epoch: 17 cost time: 29.41850209236145
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.248 Vali Acc: 0.978 Test Loss: 0.248 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2287s/iter; left time: 7818.0084s
	iters: 200, epoch: 18 | loss: 0.0000022
	speed: 0.0672s/iter; left time: 2288.9313s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 2166.6076s
	iters: 400, epoch: 18 | loss: 0.0004372
	speed: 0.0646s/iter; left time: 2186.9855s
Epoch: 18 cost time: 27.899129152297974
Epoch: 18, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.175 Vali Acc: 0.983 Test Loss: 0.175 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.2212s/iter; left time: 7469.0361s
	iters: 200, epoch: 19 | loss: 0.0000075
	speed: 0.0715s/iter; left time: 2406.8948s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 2214.2884s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0646s/iter; left time: 2161.1617s
Epoch: 19 cost time: 28.137710571289062
Epoch: 19, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.148 Vali Acc: 0.984 Test Loss: 0.148 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 1053074
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5478377
	speed: 0.0521s/iter; left time: 2147.5975s
	iters: 200, epoch: 1 | loss: 0.3300493
	speed: 0.0349s/iter; left time: 1434.3128s
	iters: 300, epoch: 1 | loss: 0.0816799
	speed: 0.0342s/iter; left time: 1401.3232s
	iters: 400, epoch: 1 | loss: 0.0791913
	speed: 0.0340s/iter; left time: 1389.4890s
Epoch: 1 cost time: 16.073718786239624
Epoch: 1, Steps: 413 | Train Loss: 0.321 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
Validation loss decreased (inf --> -0.974078).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0057036
	speed: 0.0959s/iter; left time: 3912.2978s
	iters: 200, epoch: 2 | loss: 0.0035056
	speed: 0.0335s/iter; left time: 1364.0944s
	iters: 300, epoch: 2 | loss: 0.0111067
	speed: 0.0354s/iter; left time: 1436.0933s
	iters: 400, epoch: 2 | loss: 0.0007785
	speed: 0.0350s/iter; left time: 1418.9488s
Epoch: 2 cost time: 14.73276662826538
Epoch: 2, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.089 Vali Acc: 0.971 Test Loss: 0.089 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0053875
	speed: 0.0945s/iter; left time: 3815.8744s
	iters: 200, epoch: 3 | loss: 0.0000835
	speed: 0.0344s/iter; left time: 1386.5448s
	iters: 300, epoch: 3 | loss: 0.1312923
	speed: 0.0355s/iter; left time: 1424.8732s
	iters: 400, epoch: 3 | loss: 0.4652237
	speed: 0.0352s/iter; left time: 1409.8606s
Epoch: 3 cost time: 14.690072298049927
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000296
	speed: 0.0903s/iter; left time: 3607.2135s
	iters: 200, epoch: 4 | loss: 0.0001435
	speed: 0.0354s/iter; left time: 1410.3500s
	iters: 300, epoch: 4 | loss: 0.0000059
	speed: 0.0357s/iter; left time: 1420.2882s
	iters: 400, epoch: 4 | loss: 0.0029432
	speed: 0.0344s/iter; left time: 1363.3643s
Epoch: 4 cost time: 14.804611682891846
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974078 --> -0.974533).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0001093
	speed: 0.0946s/iter; left time: 3740.5276s
	iters: 200, epoch: 5 | loss: 0.0000278
	speed: 0.0338s/iter; left time: 1332.0175s
	iters: 300, epoch: 5 | loss: 0.0035268
	speed: 0.0353s/iter; left time: 1389.9131s
	iters: 400, epoch: 5 | loss: 0.0001039
	speed: 0.0359s/iter; left time: 1410.8583s
Epoch: 5 cost time: 14.711650609970093
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
Validation loss decreased (-0.974533 --> -0.982264).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000126
	speed: 0.0954s/iter; left time: 3731.9282s
	iters: 200, epoch: 6 | loss: 0.0800513
	speed: 0.0344s/iter; left time: 1342.0874s
	iters: 300, epoch: 6 | loss: 0.0000006
	speed: 0.0367s/iter; left time: 1428.4131s
	iters: 400, epoch: 6 | loss: 0.0358134
	speed: 0.0364s/iter; left time: 1414.4434s
Epoch: 6 cost time: 14.994619369506836
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.976 Test Loss: 0.164 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000013
	speed: 0.0963s/iter; left time: 3727.7257s
	iters: 200, epoch: 7 | loss: 0.0000033
	speed: 0.0365s/iter; left time: 1407.9759s
	iters: 300, epoch: 7 | loss: 0.0000076
	speed: 0.0412s/iter; left time: 1586.9977s
	iters: 400, epoch: 7 | loss: 0.0023397
	speed: 0.0429s/iter; left time: 1647.2514s
Epoch: 7 cost time: 16.338988542556763
Epoch: 7, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.159 Vali Acc: 0.978 Test Loss: 0.159 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0012937
	speed: 0.0906s/iter; left time: 3469.2848s
	iters: 200, epoch: 8 | loss: 0.0000005
	speed: 0.0377s/iter; left time: 1439.4882s
	iters: 300, epoch: 8 | loss: 0.0000419
	speed: 0.0339s/iter; left time: 1290.0344s
	iters: 400, epoch: 8 | loss: 0.0014032
	speed: 0.0327s/iter; left time: 1241.4878s
Epoch: 8 cost time: 14.729629755020142
Epoch: 8, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.125 Vali Acc: 0.981 Test Loss: 0.125 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1230782
	speed: 0.0874s/iter; left time: 3310.3616s
	iters: 200, epoch: 9 | loss: 0.0009373
	speed: 0.0405s/iter; left time: 1530.8453s
	iters: 300, epoch: 9 | loss: 0.0000337
	speed: 0.0386s/iter; left time: 1456.4400s
	iters: 400, epoch: 9 | loss: 0.0001011
	speed: 0.0356s/iter; left time: 1337.5094s
Epoch: 9 cost time: 15.899232149124146
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.982 Test Loss: 0.134 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000304
	speed: 0.0932s/iter; left time: 3493.2775s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1435.5667s
	iters: 300, epoch: 10 | loss: 0.0017534
	speed: 0.0385s/iter; left time: 1435.8095s
	iters: 400, epoch: 10 | loss: 0.0000003
	speed: 0.0367s/iter; left time: 1364.6767s
Epoch: 10 cost time: 16.019438982009888
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.147 Vali Acc: 0.981 Test Loss: 0.147 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000030
	speed: 0.0884s/iter; left time: 3275.4564s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1324.6302s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0372s/iter; left time: 1370.1034s
	iters: 400, epoch: 11 | loss: 0.4177337
	speed: 0.0379s/iter; left time: 1393.3767s
Epoch: 11 cost time: 15.422865629196167
Epoch: 11, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.232 Vali Acc: 0.966 Test Loss: 0.232 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0904s/iter; left time: 3315.6310s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0364s/iter; left time: 1331.5516s
	iters: 300, epoch: 12 | loss: 0.0001155
	speed: 0.0292s/iter; left time: 1062.7958s
	iters: 400, epoch: 12 | loss: 0.0001243
	speed: 0.0381s/iter; left time: 1386.8300s
Epoch: 12 cost time: 14.807375431060791
Epoch: 12, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.359 Vali Acc: 0.968 Test Loss: 0.359 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000294
	speed: 0.1025s/iter; left time: 3714.3045s
	iters: 200, epoch: 13 | loss: 0.0000005
	speed: 0.0445s/iter; left time: 1607.7911s
	iters: 300, epoch: 13 | loss: 0.0000005
	speed: 0.0458s/iter; left time: 1649.5976s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0360s/iter; left time: 1295.2042s
Epoch: 13 cost time: 18.157864570617676
Epoch: 13, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.238 Vali Acc: 0.973 Test Loss: 0.238 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0012524
	speed: 0.0905s/iter; left time: 3244.5517s
	iters: 200, epoch: 14 | loss: 0.0242087
	speed: 0.0336s/iter; left time: 1201.9213s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1265.5247s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0363s/iter; left time: 1289.2616s
Epoch: 14 cost time: 14.880467176437378
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.170 Vali Acc: 0.983 Test Loss: 0.170 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.983172).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0920s/iter; left time: 3256.8741s
	iters: 200, epoch: 15 | loss: 0.0003868
	speed: 0.0343s/iter; left time: 1210.0062s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 1205.2707s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 1239.8086s
Epoch: 15 cost time: 14.696659564971924
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.209 Vali Acc: 0.980 Test Loss: 0.209 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000008
	speed: 0.0969s/iter; left time: 3393.6533s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0344s/iter; left time: 1199.7920s
	iters: 300, epoch: 16 | loss: 0.0000638
	speed: 0.0346s/iter; left time: 1204.6291s
	iters: 400, epoch: 16 | loss: 0.0000012
	speed: 0.0343s/iter; left time: 1191.5498s
Epoch: 16 cost time: 14.817463636398315
Epoch: 16, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.215 Vali Acc: 0.974 Test Loss: 0.215 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000004
	speed: 0.0918s/iter; left time: 3176.2730s
	iters: 200, epoch: 17 | loss: 0.0000003
	speed: 0.0380s/iter; left time: 1311.4050s
	iters: 300, epoch: 17 | loss: 0.0059547
	speed: 0.0366s/iter; left time: 1257.7272s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 1239.8919s
Epoch: 17 cost time: 15.326966285705566
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.137 Vali Acc: 0.985 Test Loss: 0.137 Test Acc: 0.985
Validation loss decreased (-0.983172 --> -0.984992).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000027
	speed: 0.0977s/iter; left time: 3340.6288s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 1286.8054s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 1193.0630s
	iters: 400, epoch: 18 | loss: 0.0011816
	speed: 0.0355s/iter; left time: 1204.1233s
Epoch: 18 cost time: 15.333454370498657
Epoch: 18, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.282 Vali Acc: 0.980 Test Loss: 0.282 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000008
	speed: 0.0973s/iter; left time: 3286.6671s
	iters: 200, epoch: 19 | loss: 0.0001919
	speed: 0.0351s/iter; left time: 1180.7682s
	iters: 300, epoch: 19 | loss: 0.0000436
	speed: 0.0366s/iter; left time: 1228.9597s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 1234.6525s
Epoch: 19 cost time: 15.179160356521606
Epoch: 19, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.172 Vali Acc: 0.980 Test Loss: 0.172 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1019s/iter; left time: 3398.4884s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 1233.7483s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 1198.3142s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 1148.2021s
Epoch: 20 cost time: 15.469993352890015
Epoch: 20, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.207 Vali Acc: 0.980 Test Loss: 0.207 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0010275
	speed: 0.0996s/iter; left time: 3280.7628s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 1197.8406s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 1224.2512s
	iters: 400, epoch: 21 | loss: 0.0000003
	speed: 0.0366s/iter; left time: 1193.7539s
Epoch: 21 cost time: 15.679771661758423
Epoch: 21, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.166 Vali Acc: 0.983 Test Loss: 0.166 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0954s/iter; left time: 3101.9961s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1149.7600s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 1219.0366s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1259.7800s
Epoch: 22 cost time: 15.665464878082275
Epoch: 22, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.303 Vali Acc: 0.981 Test Loss: 0.303 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0977s/iter; left time: 3138.3078s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 1156.4539s
	iters: 300, epoch: 23 | loss: 0.0002640
	speed: 0.0359s/iter; left time: 1144.4386s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 1103.0663s
Epoch: 23 cost time: 15.351688146591187
Epoch: 23, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.237 Vali Acc: 0.981 Test Loss: 0.237 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 3005.2988s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1196.3260s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1181.0543s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0372s/iter; left time: 1167.8608s
Epoch: 24 cost time: 15.598997354507446
Epoch: 24, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.219 Vali Acc: 0.985 Test Loss: 0.219 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0950s/iter; left time: 2973.4777s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 1126.2560s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1193.1408s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1206.3729s
Epoch: 25 cost time: 15.69007396697998
Epoch: 25, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.988 Test Loss: 0.168 Test Acc: 0.988
Validation loss decreased (-0.984992 --> -0.988175).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000057
	speed: 0.0928s/iter; left time: 2865.3119s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 1038.3848s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0363s/iter; left time: 1112.3866s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0363s/iter; left time: 1109.2988s
Epoch: 26 cost time: 14.762027740478516
Epoch: 26, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.209 Vali Acc: 0.980 Test Loss: 0.209 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0940s/iter; left time: 2863.8017s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1076.7444s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1136.0558s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 1081.7808s
Epoch: 27 cost time: 15.16905951499939
Epoch: 27, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.233 Vali Acc: 0.982 Test Loss: 0.233 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.9015321
	speed: 0.0926s/iter; left time: 2781.5936s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 1084.4367s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 1104.0080s
	iters: 400, epoch: 28 | loss: 0.0005019
	speed: 0.0370s/iter; left time: 1101.3228s
Epoch: 28 cost time: 15.494941234588623
Epoch: 28, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.362 Vali Acc: 0.974 Test Loss: 0.362 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.0962s/iter; left time: 2849.9822s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 1053.1255s
	iters: 300, epoch: 29 | loss: 0.0000001
	speed: 0.0336s/iter; left time: 990.2507s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 1000.5869s
Epoch: 29 cost time: 14.679924726486206
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.335 Vali Acc: 0.970 Test Loss: 0.335 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.0932s/iter; left time: 2723.4439s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 968.6771s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 1004.2360s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 979.3814s
Epoch: 30 cost time: 14.46192216873169
Epoch: 30, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.483 Vali Acc: 0.972 Test Loss: 0.483 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.0950s/iter; left time: 2735.7058s
	iters: 200, epoch: 31 | loss: 0.0000131
	speed: 0.0361s/iter; left time: 1037.0211s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0363s/iter; left time: 1038.1012s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1020.7317s
Epoch: 31 cost time: 15.291314125061035
Epoch: 31, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.319 Vali Acc: 0.980 Test Loss: 0.319 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.0979s/iter; left time: 2779.6468s
	iters: 200, epoch: 32 | loss: 0.3473076
	speed: 0.0348s/iter; left time: 984.9093s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 1013.4456s
	iters: 400, epoch: 32 | loss: 0.0000006
	speed: 0.0342s/iter; left time: 960.9717s
Epoch: 32 cost time: 14.848186254501343
Epoch: 32, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.0959s/iter; left time: 2684.9292s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 976.1179s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 997.9137s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 1026.7338s
Epoch: 33 cost time: 15.17902398109436
Epoch: 33, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.329 Vali Acc: 0.980 Test Loss: 0.329 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.0932s/iter; left time: 2569.0498s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 929.4003s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 933.8342s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 958.2464s
Epoch: 34 cost time: 14.446796894073486
Epoch: 34, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.989 Test Loss: 0.106 Test Acc: 0.989
Validation loss decreased (-0.988175 --> -0.989085).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.0994s/iter; left time: 2699.3153s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 920.9861s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0390s/iter; left time: 1050.5850s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 959.6275s
Epoch: 35 cost time: 15.418803453445435
Epoch: 35, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.141 Vali Acc: 0.984 Test Loss: 0.141 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.0957s/iter; left time: 2559.2905s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 927.1566s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1011.3621s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1008.0175s
Epoch: 36 cost time: 15.654303550720215
Epoch: 36, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.290 Vali Acc: 0.980 Test Loss: 0.290 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.0907s/iter; left time: 2389.0194s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0363s/iter; left time: 951.7838s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 887.3618s
	iters: 400, epoch: 37 | loss: 0.0000001
	speed: 0.0350s/iter; left time: 912.3784s
Epoch: 37 cost time: 14.597347974777222
Epoch: 37, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.479 Vali Acc: 0.972 Test Loss: 0.479 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 2470.1290s
	iters: 200, epoch: 38 | loss: 0.3058020
	speed: 0.0354s/iter; left time: 912.8397s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 964.3006s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 899.3745s
Epoch: 38 cost time: 15.224221229553223
Epoch: 38, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.196 Vali Acc: 0.985 Test Loss: 0.196 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.0944s/iter; left time: 2408.4378s
	iters: 200, epoch: 39 | loss: 0.0221729
	speed: 0.0358s/iter; left time: 908.4028s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 914.3956s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 837.5437s
Epoch: 39 cost time: 15.036483526229858
Epoch: 39, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.349 Vali Acc: 0.983 Test Loss: 0.349 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.0909s/iter; left time: 2280.7427s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0354s/iter; left time: 884.4876s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 886.4916s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 685.5712s
Epoch: 40 cost time: 14.166636228561401
Epoch: 40, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.158 Vali Acc: 0.989 Test Loss: 0.158 Test Acc: 0.989
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.0927s/iter; left time: 2288.6398s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 1006.6370s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 952.6382s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 991.2316s
Epoch: 41 cost time: 16.707893133163452
Epoch: 41, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.263 Vali Acc: 0.984 Test Loss: 0.263 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 2236.8820s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 953.8100s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 898.4890s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0364s/iter; left time: 873.0691s
Epoch: 42 cost time: 15.936728477478027
Epoch: 42, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.986 Test Loss: 0.137 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 2198.4935s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 890.3237s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 870.8369s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 808.9821s
Epoch: 43 cost time: 15.467445611953735
Epoch: 43, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.246 Vali Acc: 0.982 Test Loss: 0.246 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.0932s/iter; left time: 2185.1007s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 856.2251s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 740.2155s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 814.4777s
Epoch: 44 cost time: 14.769083023071289
Epoch: 44, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.165 Vali Acc: 0.986 Test Loss: 0.165 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 1053074
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5377264
	speed: 0.0700s/iter; left time: 2882.0619s
	iters: 200, epoch: 1 | loss: 0.2581501
	speed: 0.0663s/iter; left time: 2724.1514s
	iters: 300, epoch: 1 | loss: 0.0930836
	speed: 0.0649s/iter; left time: 2659.9443s
	iters: 400, epoch: 1 | loss: 0.1329519
	speed: 0.0664s/iter; left time: 2717.4954s
Epoch: 1 cost time: 27.861215591430664
Epoch: 1, Steps: 413 | Train Loss: 0.345 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (inf --> -0.973169).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0121883
	speed: 0.2128s/iter; left time: 8681.6202s
	iters: 200, epoch: 2 | loss: 0.0028575
	speed: 0.0673s/iter; left time: 2738.2698s
	iters: 300, epoch: 2 | loss: 0.0460493
	speed: 0.0634s/iter; left time: 2572.6583s
	iters: 400, epoch: 2 | loss: 0.0004980
	speed: 0.0669s/iter; left time: 2710.5680s
Epoch: 2 cost time: 27.556515216827393
Epoch: 2, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.973169 --> -0.979536).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0023076
	speed: 0.2052s/iter; left time: 8283.7246s
	iters: 200, epoch: 3 | loss: 0.0001684
	speed: 0.0677s/iter; left time: 2725.5727s
	iters: 300, epoch: 3 | loss: 0.2162766
	speed: 0.0640s/iter; left time: 2572.4732s
	iters: 400, epoch: 3 | loss: 0.0356510
	speed: 0.0652s/iter; left time: 2613.7235s
Epoch: 3 cost time: 27.061334371566772
Epoch: 3, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0003573
	speed: 0.2188s/iter; left time: 8744.8241s
	iters: 200, epoch: 4 | loss: 0.0000515
	speed: 0.0694s/iter; left time: 2766.4993s
	iters: 300, epoch: 4 | loss: 0.0004688
	speed: 0.0637s/iter; left time: 2531.0482s
	iters: 400, epoch: 4 | loss: 0.0106259
	speed: 0.0636s/iter; left time: 2524.3134s
Epoch: 4 cost time: 27.18977665901184
Epoch: 4, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.236 Vali Acc: 0.957 Test Loss: 0.236 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1435359
	speed: 0.2018s/iter; left time: 7982.1331s
	iters: 200, epoch: 5 | loss: 0.0020184
	speed: 0.0639s/iter; left time: 2522.3632s
	iters: 300, epoch: 5 | loss: 0.1797773
	speed: 0.0686s/iter; left time: 2701.1804s
	iters: 400, epoch: 5 | loss: 0.0106011
	speed: 0.0649s/iter; left time: 2548.9195s
Epoch: 5 cost time: 27.223604917526245
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.2023s/iter; left time: 7919.1074s
	iters: 200, epoch: 6 | loss: 0.0000772
	speed: 0.0676s/iter; left time: 2640.4895s
	iters: 300, epoch: 6 | loss: 0.0463136
	speed: 0.0656s/iter; left time: 2555.8076s
	iters: 400, epoch: 6 | loss: 0.0003166
	speed: 0.0648s/iter; left time: 2517.1572s
Epoch: 6 cost time: 27.576257467269897
Epoch: 6, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.209 Vali Acc: 0.969 Test Loss: 0.209 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000744
	speed: 0.2290s/iter; left time: 8868.3938s
	iters: 200, epoch: 7 | loss: 0.0000497
	speed: 0.0678s/iter; left time: 2619.4189s
	iters: 300, epoch: 7 | loss: 0.0128958
	speed: 0.0743s/iter; left time: 2860.8133s
	iters: 400, epoch: 7 | loss: 0.0000056
	speed: 0.0679s/iter; left time: 2607.4156s
Epoch: 7 cost time: 28.716291427612305
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000139
	speed: 0.2165s/iter; left time: 8293.1165s
	iters: 200, epoch: 8 | loss: 0.0000002
	speed: 0.0628s/iter; left time: 2399.7370s
	iters: 300, epoch: 8 | loss: 0.0000002
	speed: 0.0694s/iter; left time: 2644.1885s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 2437.1728s
Epoch: 8 cost time: 27.25295877456665
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.184 Vali Acc: 0.974 Test Loss: 0.184 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2078s/iter; left time: 7874.4386s
	iters: 200, epoch: 9 | loss: 0.0000004
	speed: 0.0642s/iter; left time: 2425.6027s
	iters: 300, epoch: 9 | loss: 0.0001406
	speed: 0.0660s/iter; left time: 2489.6528s
	iters: 400, epoch: 9 | loss: 0.1372537
	speed: 0.0635s/iter; left time: 2385.7676s
Epoch: 9 cost time: 26.788540363311768
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.081 Vali Acc: 0.986 Test Loss: 0.081 Test Acc: 0.986
Validation loss decreased (-0.979536 --> -0.985902).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2158s/iter; left time: 8090.5585s
	iters: 200, epoch: 10 | loss: 0.0007331
	speed: 0.0637s/iter; left time: 2382.6218s
	iters: 300, epoch: 10 | loss: 0.0000019
	speed: 0.0616s/iter; left time: 2298.1267s
	iters: 400, epoch: 10 | loss: 0.0012446
	speed: 0.0673s/iter; left time: 2502.3703s
Epoch: 10 cost time: 27.028287172317505
Epoch: 10, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.142 Vali Acc: 0.978 Test Loss: 0.142 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0632515
	speed: 0.2271s/iter; left time: 8419.7243s
	iters: 200, epoch: 11 | loss: 0.0000116
	speed: 0.0624s/iter; left time: 2305.4331s
	iters: 300, epoch: 11 | loss: 0.1043540
	speed: 0.0669s/iter; left time: 2465.2275s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0690s/iter; left time: 2535.8918s
Epoch: 11 cost time: 27.897921323776245
Epoch: 11, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0004161
	speed: 0.2098s/iter; left time: 7690.3059s
	iters: 200, epoch: 12 | loss: 0.0000065
	speed: 0.0638s/iter; left time: 2330.9673s
	iters: 300, epoch: 12 | loss: 0.0000008
	speed: 0.0645s/iter; left time: 2352.0857s
	iters: 400, epoch: 12 | loss: 0.0000005
	speed: 0.0691s/iter; left time: 2511.4028s
Epoch: 12 cost time: 27.871724605560303
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.983 Test Loss: 0.125 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.2042s/iter; left time: 7399.9492s
	iters: 200, epoch: 13 | loss: 0.0000003
	speed: 0.0633s/iter; left time: 2288.8084s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0657s/iter; left time: 2366.8491s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 2561.6044s
Epoch: 13 cost time: 28.133278846740723
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.173 Vali Acc: 0.980 Test Loss: 0.173 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2347s/iter; left time: 8408.4660s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.0658s/iter; left time: 2352.4826s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0633s/iter; left time: 2254.2130s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 2122.9702s
Epoch: 14 cost time: 27.449202299118042
Epoch: 14, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.142 Vali Acc: 0.983 Test Loss: 0.142 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000531
	speed: 0.2074s/iter; left time: 7345.9391s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 2373.4467s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0620s/iter; left time: 2183.3705s
	iters: 400, epoch: 15 | loss: 0.0015952
	speed: 0.0627s/iter; left time: 2201.3925s
Epoch: 15 cost time: 26.742486715316772
Epoch: 15, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.986 Test Loss: 0.115 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2054s/iter; left time: 7190.7917s
	iters: 200, epoch: 16 | loss: 0.0000025
	speed: 0.0670s/iter; left time: 2338.9554s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0633s/iter; left time: 2203.4825s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 2040.6015s
Epoch: 16 cost time: 26.544551610946655
Epoch: 16, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.171 Vali Acc: 0.984 Test Loss: 0.171 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000493
	speed: 0.2179s/iter; left time: 7537.5586s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 2110.4132s
	iters: 300, epoch: 17 | loss: 0.0295998
	speed: 0.0631s/iter; left time: 2169.1267s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 2040.6718s
Epoch: 17 cost time: 25.849863529205322
Epoch: 17, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.113 Vali Acc: 0.987 Test Loss: 0.113 Test Acc: 0.987
Validation loss decreased (-0.985902 --> -0.986811).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2070s/iter; left time: 7075.3369s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 2255.9014s
	iters: 300, epoch: 18 | loss: 0.0000085
	speed: 0.0657s/iter; left time: 2232.4958s
	iters: 400, epoch: 18 | loss: 0.0103396
	speed: 0.0639s/iter; left time: 2165.1651s
Epoch: 18 cost time: 27.17256188392639
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.984 Test Loss: 0.178 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2000s/iter; left time: 6753.1348s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0651s/iter; left time: 2192.5432s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0672s/iter; left time: 2255.2308s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0636s/iter; left time: 2129.9772s
Epoch: 19 cost time: 27.0677490234375
Epoch: 19, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.269 Vali Acc: 0.973 Test Loss: 0.269 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.2077s/iter; left time: 6929.0981s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 2145.9131s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 2349.7333s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0633s/iter; left time: 2090.8190s
Epoch: 20 cost time: 27.462106466293335
Epoch: 20, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.253 Vali Acc: 0.980 Test Loss: 0.253 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0001104
	speed: 0.2299s/iter; left time: 7572.5881s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0625s/iter; left time: 2054.1427s
	iters: 300, epoch: 21 | loss: 0.0000390
	speed: 0.0629s/iter; left time: 2058.9191s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0642s/iter; left time: 2096.3504s
Epoch: 21 cost time: 26.56479048728943
Epoch: 21, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.329 Vali Acc: 0.973 Test Loss: 0.329 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2109s/iter; left time: 6860.2789s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0629s/iter; left time: 2038.8625s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0637s/iter; left time: 2059.4056s
	iters: 400, epoch: 22 | loss: 0.0000832
	speed: 0.0650s/iter; left time: 2094.7528s
Epoch: 22 cost time: 26.807960271835327
Epoch: 22, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.462 Vali Acc: 0.977 Test Loss: 0.462 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.6053045
	speed: 0.2070s/iter; left time: 6647.4928s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0611s/iter; left time: 1955.9802s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.0688s/iter; left time: 2196.4489s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0744s/iter; left time: 2368.6256s
Epoch: 23 cost time: 28.142034769058228
Epoch: 23, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.446 Vali Acc: 0.982 Test Loss: 0.446 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2308s/iter; left time: 7316.4128s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0689s/iter; left time: 2178.7139s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0644s/iter; left time: 2029.5837s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0640s/iter; left time: 2011.1990s
Epoch: 24 cost time: 28.307836532592773
Epoch: 24, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.236 Vali Acc: 0.981 Test Loss: 0.236 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2063s/iter; left time: 6455.2425s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 2072.4641s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 1992.1762s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0630s/iter; left time: 1951.7617s
Epoch: 25 cost time: 27.20095729827881
Epoch: 25, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.983 Test Loss: 0.178 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000056
	speed: 0.2048s/iter; left time: 6323.4250s
	iters: 200, epoch: 26 | loss: 0.0000336
	speed: 0.0646s/iter; left time: 1986.8312s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0607s/iter; left time: 1861.9394s
	iters: 400, epoch: 26 | loss: 1.4780012
	speed: 0.0628s/iter; left time: 1918.9492s
Epoch: 26 cost time: 26.442639589309692
Epoch: 26, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.408 Vali Acc: 0.970 Test Loss: 0.408 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0019787
	speed: 0.2345s/iter; left time: 7143.4548s
	iters: 200, epoch: 27 | loss: 0.0000018
	speed: 0.0610s/iter; left time: 1852.9044s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 1911.5428s
	iters: 400, epoch: 27 | loss: 0.0947900
	speed: 0.0640s/iter; left time: 1931.3286s
Epoch: 27 cost time: 26.506346225738525
Epoch: 27, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.282 Vali Acc: 0.984 Test Loss: 0.282 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 1053074
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0972966
	speed: 0.0836s/iter; left time: 3445.2720s
	iters: 200, epoch: 1 | loss: 0.3419352
	speed: 0.0662s/iter; left time: 2719.9729s
	iters: 300, epoch: 1 | loss: 0.1378359
	speed: 0.0645s/iter; left time: 2645.9125s
	iters: 400, epoch: 1 | loss: 0.0297806
	speed: 0.0638s/iter; left time: 2608.7544s
Epoch: 1 cost time: 28.84404420852661
Epoch: 1, Steps: 413 | Train Loss: 0.336 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
Validation loss decreased (inf --> -0.969076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5670204
	speed: 0.2041s/iter; left time: 8325.9463s
	iters: 200, epoch: 2 | loss: 0.1905880
	speed: 0.0682s/iter; left time: 2774.9662s
	iters: 300, epoch: 2 | loss: 0.0057502
	speed: 0.0649s/iter; left time: 2632.6562s
	iters: 400, epoch: 2 | loss: 0.3081901
	speed: 0.0656s/iter; left time: 2657.4684s
Epoch: 2 cost time: 27.7753849029541
Epoch: 2, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
Validation loss decreased (-0.969076 --> -0.973169).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0016054
	speed: 0.2249s/iter; left time: 9082.0110s
	iters: 200, epoch: 3 | loss: 0.0000664
	speed: 0.0720s/iter; left time: 2901.8119s
	iters: 300, epoch: 3 | loss: 0.0012837
	speed: 0.0717s/iter; left time: 2882.1948s
	iters: 400, epoch: 3 | loss: 0.3496706
	speed: 0.0684s/iter; left time: 2739.2472s
Epoch: 3 cost time: 29.195685863494873
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0014609
	speed: 0.2038s/iter; left time: 8145.9191s
	iters: 200, epoch: 4 | loss: 0.0002280
	speed: 0.0637s/iter; left time: 2539.5061s
	iters: 300, epoch: 4 | loss: 0.0014254
	speed: 0.0691s/iter; left time: 2748.2694s
	iters: 400, epoch: 4 | loss: 0.0094906
	speed: 0.0646s/iter; left time: 2563.8946s
Epoch: 4 cost time: 27.237232208251953
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0301685
	speed: 0.2050s/iter; left time: 8108.7408s
	iters: 200, epoch: 5 | loss: 0.0003021
	speed: 0.0642s/iter; left time: 2531.0040s
	iters: 300, epoch: 5 | loss: 0.0003003
	speed: 0.0668s/iter; left time: 2628.1912s
	iters: 400, epoch: 5 | loss: 0.0218585
	speed: 0.0652s/iter; left time: 2559.0770s
Epoch: 5 cost time: 27.24459743499756
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.174 Vali Acc: 0.966 Test Loss: 0.174 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0020925
	speed: 0.2291s/iter; left time: 8965.5812s
	iters: 200, epoch: 6 | loss: 0.0000037
	speed: 0.0651s/iter; left time: 2540.6802s
	iters: 300, epoch: 6 | loss: 0.0030713
	speed: 0.0632s/iter; left time: 2459.6414s
	iters: 400, epoch: 6 | loss: 0.0000297
	speed: 0.0667s/iter; left time: 2591.1984s
Epoch: 6 cost time: 27.455279111862183
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.973169 --> -0.981354).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000004
	speed: 0.2206s/iter; left time: 8543.7810s
	iters: 200, epoch: 7 | loss: 0.0000114
	speed: 0.0652s/iter; left time: 2519.4624s
	iters: 300, epoch: 7 | loss: 0.0374525
	speed: 0.0660s/iter; left time: 2540.8982s
	iters: 400, epoch: 7 | loss: 0.0097354
	speed: 0.0702s/iter; left time: 2695.5276s
Epoch: 7 cost time: 28.276573419570923
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000023
	speed: 0.2117s/iter; left time: 8110.5737s
	iters: 200, epoch: 8 | loss: 0.0000203
	speed: 0.0703s/iter; left time: 2686.3367s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 2529.9925s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0689s/iter; left time: 2619.6351s
Epoch: 8 cost time: 28.83729076385498
Epoch: 8, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.217 Vali Acc: 0.970 Test Loss: 0.217 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000005
	speed: 0.2082s/iter; left time: 7890.8797s
	iters: 200, epoch: 9 | loss: 0.9556541
	speed: 0.0798s/iter; left time: 3014.3113s
	iters: 300, epoch: 9 | loss: 0.0000390
	speed: 0.0726s/iter; left time: 2736.0295s
	iters: 400, epoch: 9 | loss: 0.0000014
	speed: 0.0693s/iter; left time: 2606.3637s
Epoch: 9 cost time: 30.065266132354736
Epoch: 9, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.361 Vali Acc: 0.956 Test Loss: 0.361 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0002249
	speed: 0.2296s/iter; left time: 8607.5659s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 2448.7337s
	iters: 300, epoch: 10 | loss: 0.0070460
	speed: 0.0746s/iter; left time: 2783.2105s
	iters: 400, epoch: 10 | loss: 0.0858172
	speed: 0.0653s/iter; left time: 2427.7719s
Epoch: 10 cost time: 28.45495891571045
Epoch: 10, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.972 Test Loss: 0.222 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0017352
	speed: 0.2116s/iter; left time: 7845.4790s
	iters: 200, epoch: 11 | loss: 0.0000119
	speed: 0.0667s/iter; left time: 2465.0447s
	iters: 300, epoch: 11 | loss: 0.0000005
	speed: 0.0677s/iter; left time: 2496.3379s
	iters: 400, epoch: 11 | loss: 0.0000109
	speed: 0.0685s/iter; left time: 2517.6570s
Epoch: 11 cost time: 28.118892192840576
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.359 Vali Acc: 0.967 Test Loss: 0.359 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000222
	speed: 0.2178s/iter; left time: 7982.9070s
	iters: 200, epoch: 12 | loss: 0.0000007
	speed: 0.0650s/iter; left time: 2375.0592s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 2350.1595s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0727s/iter; left time: 2642.6781s
Epoch: 12 cost time: 28.515209674835205
Epoch: 12, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2817409
	speed: 0.2389s/iter; left time: 8660.0810s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0711s/iter; left time: 2569.7468s
	iters: 300, epoch: 13 | loss: 0.0036597
	speed: 0.0667s/iter; left time: 2403.9638s
	iters: 400, epoch: 13 | loss: 0.0000284
	speed: 0.0711s/iter; left time: 2554.0716s
Epoch: 13 cost time: 29.190923929214478
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2219s/iter; left time: 7950.2551s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 2566.5168s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0692s/iter; left time: 2467.1057s
	iters: 400, epoch: 14 | loss: 0.4679040
	speed: 0.0678s/iter; left time: 2408.5608s
Epoch: 14 cost time: 28.77555537223816
Epoch: 14, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.151 Vali Acc: 0.985 Test Loss: 0.151 Test Acc: 0.985
Validation loss decreased (-0.981354 --> -0.984537).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2106s/iter; left time: 7459.6181s
	iters: 200, epoch: 15 | loss: 0.0000014
	speed: 0.0692s/iter; left time: 2442.4890s
	iters: 300, epoch: 15 | loss: 0.0304469
	speed: 0.0715s/iter; left time: 2517.1195s
	iters: 400, epoch: 15 | loss: 0.0002673
	speed: 0.0669s/iter; left time: 2348.9303s
Epoch: 15 cost time: 28.79630184173584
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.182 Vali Acc: 0.979 Test Loss: 0.182 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000436
	speed: 0.2156s/iter; left time: 7548.5438s
	iters: 200, epoch: 16 | loss: 0.1128977
	speed: 0.0661s/iter; left time: 2306.9549s
	iters: 300, epoch: 16 | loss: 0.7207169
	speed: 0.0750s/iter; left time: 2608.8842s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 2303.6457s
Epoch: 16 cost time: 28.585238218307495
Epoch: 16, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.252 Vali Acc: 0.979 Test Loss: 0.252 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2383s/iter; left time: 8244.2644s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0614s/iter; left time: 2116.5030s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 2206.1900s
	iters: 400, epoch: 17 | loss: 0.0000004
	speed: 0.0702s/iter; left time: 2407.6568s
Epoch: 17 cost time: 27.943134784698486
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.980 Test Loss: 0.183 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.2191s/iter; left time: 7489.3433s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0670s/iter; left time: 2283.0779s
	iters: 300, epoch: 18 | loss: 0.0000085
	speed: 0.0654s/iter; left time: 2222.9009s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 2332.5198s
Epoch: 18 cost time: 28.489782333374023
Epoch: 18, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.153 Vali Acc: 0.986 Test Loss: 0.153 Test Acc: 0.986
Validation loss decreased (-0.984537 --> -0.985901).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0061991
	speed: 0.2170s/iter; left time: 7327.7360s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0727s/iter; left time: 2448.4509s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0679s/iter; left time: 2278.7327s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 2312.1679s
Epoch: 19 cost time: 28.890146493911743
Epoch: 19, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.988 Test Loss: 0.139 Test Acc: 0.988
Validation loss decreased (-0.985901 --> -0.988175).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2364s/iter; left time: 7884.3986s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0744s/iter; left time: 2475.0254s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0707s/iter; left time: 2345.6347s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0650s/iter; left time: 2148.7057s
Epoch: 20 cost time: 29.070510387420654
Epoch: 20, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.138 Vali Acc: 0.987 Test Loss: 0.138 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000005
	speed: 0.2009s/iter; left time: 6616.5279s
	iters: 200, epoch: 21 | loss: 0.0191531
	speed: 0.0630s/iter; left time: 2067.5345s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 2344.5386s
	iters: 400, epoch: 21 | loss: 0.1874284
	speed: 0.0678s/iter; left time: 2212.0920s
Epoch: 21 cost time: 27.69104266166687
Epoch: 21, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.175 Vali Acc: 0.982 Test Loss: 0.175 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1992s/iter; left time: 6480.1980s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 1868.1701s
	iters: 300, epoch: 22 | loss: 0.0000548
	speed: 0.0665s/iter; left time: 2149.1459s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 2333.3326s
Epoch: 22 cost time: 26.852829456329346
Epoch: 22, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.206 Vali Acc: 0.988 Test Loss: 0.206 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2359s/iter; left time: 7576.7627s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 2222.6415s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0699s/iter; left time: 2231.7838s
	iters: 400, epoch: 23 | loss: 0.0049004
	speed: 0.0739s/iter; left time: 2352.1316s
Epoch: 23 cost time: 29.498717069625854
Epoch: 23, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.248 Vali Acc: 0.980 Test Loss: 0.248 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000017
	speed: 0.2201s/iter; left time: 6977.8713s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 2017.1185s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 2043.7468s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 2170.6082s
Epoch: 24 cost time: 28.113218307495117
Epoch: 24, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.623 Vali Acc: 0.966 Test Loss: 0.623 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2204s/iter; left time: 6896.1238s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 2077.0641s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0648s/iter; left time: 2013.1592s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 2092.2957s
Epoch: 25 cost time: 28.18618655204773
Epoch: 25, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.222 Vali Acc: 0.981 Test Loss: 0.222 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2398s/iter; left time: 7403.8946s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0711s/iter; left time: 2187.3191s
	iters: 300, epoch: 26 | loss: 0.0015219
	speed: 0.0633s/iter; left time: 1942.9463s
	iters: 400, epoch: 26 | loss: 0.2991647
	speed: 0.0669s/iter; left time: 2046.8610s
Epoch: 26 cost time: 28.281786680221558
Epoch: 26, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.982 Test Loss: 0.207 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2367s/iter; left time: 7211.3961s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 2176.7248s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.0668s/iter; left time: 2021.9718s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 1974.7641s
Epoch: 27 cost time: 27.947957754135132
Epoch: 27, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.260 Vali Acc: 0.980 Test Loss: 0.260 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2102s/iter; left time: 6317.3769s
	iters: 200, epoch: 28 | loss: 0.0012725
	speed: 0.0715s/iter; left time: 2142.7296s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 2028.7706s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 1974.2518s
Epoch: 28 cost time: 28.524962663650513
Epoch: 28, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.226 Vali Acc: 0.985 Test Loss: 0.226 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2101s/iter; left time: 6225.9024s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0707s/iter; left time: 2087.1364s
	iters: 300, epoch: 29 | loss: 0.0019207
	speed: 0.0743s/iter; left time: 2186.3275s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 1950.3871s
Epoch: 29 cost time: 29.04463505744934
Epoch: 29, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.269 Vali Acc: 0.984 Test Loss: 0.269 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9881764438381082
model parameter : 790930
model size : 7.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0947280
	speed: 0.0830s/iter; left time: 3418.0917s
	iters: 200, epoch: 1 | loss: 0.3682419
	speed: 0.0635s/iter; left time: 2611.0409s
	iters: 300, epoch: 1 | loss: 0.1264224
	speed: 0.0666s/iter; left time: 2731.9386s
	iters: 400, epoch: 1 | loss: 0.0339558
	speed: 0.0665s/iter; left time: 2719.6980s
Epoch: 1 cost time: 28.848431825637817
Epoch: 1, Steps: 413 | Train Loss: 0.336 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
Validation loss decreased (inf --> -0.974988).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5184711
	speed: 0.2080s/iter; left time: 8483.6258s
	iters: 200, epoch: 2 | loss: 0.2007594
	speed: 0.0629s/iter; left time: 2560.9220s
	iters: 300, epoch: 2 | loss: 0.0111706
	speed: 0.0641s/iter; left time: 2603.4030s
	iters: 400, epoch: 2 | loss: 0.0524483
	speed: 0.0683s/iter; left time: 2763.7576s
Epoch: 2 cost time: 27.56304383277893
Epoch: 2, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
Validation loss decreased (-0.974988 --> -0.974988).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0028551
	speed: 0.2202s/iter; left time: 8892.3474s
	iters: 200, epoch: 3 | loss: 0.0184426
	speed: 0.0669s/iter; left time: 2695.2110s
	iters: 300, epoch: 3 | loss: 0.0307529
	speed: 0.0648s/iter; left time: 2602.2421s
	iters: 400, epoch: 3 | loss: 0.5267910
	speed: 0.0667s/iter; left time: 2673.3819s
Epoch: 3 cost time: 28.67421007156372
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0574890
	speed: 0.2286s/iter; left time: 9135.6187s
	iters: 200, epoch: 4 | loss: 0.0000069
	speed: 0.0746s/iter; left time: 2973.0479s
	iters: 300, epoch: 4 | loss: 0.0000279
	speed: 0.0638s/iter; left time: 2536.1009s
	iters: 400, epoch: 4 | loss: 0.0079145
	speed: 0.0655s/iter; left time: 2596.9530s
Epoch: 4 cost time: 28.650567770004272
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.183 Vali Acc: 0.962 Test Loss: 0.183 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0008104
	speed: 0.2031s/iter; left time: 8030.4353s
	iters: 200, epoch: 5 | loss: 0.0000911
	speed: 0.0709s/iter; left time: 2797.5846s
	iters: 300, epoch: 5 | loss: 0.0000468
	speed: 0.0654s/iter; left time: 2575.3837s
	iters: 400, epoch: 5 | loss: 0.0000112
	speed: 0.0667s/iter; left time: 2616.7425s
Epoch: 5 cost time: 28.022687673568726
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.091 Vali Acc: 0.985 Test Loss: 0.091 Test Acc: 0.985
Validation loss decreased (-0.974988 --> -0.985447).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0536618
	speed: 0.2082s/iter; left time: 8146.6370s
	iters: 200, epoch: 6 | loss: 0.0000316
	speed: 0.0690s/iter; left time: 2693.4087s
	iters: 300, epoch: 6 | loss: 0.0230526
	speed: 0.0654s/iter; left time: 2544.8869s
	iters: 400, epoch: 6 | loss: 0.0092646
	speed: 0.0662s/iter; left time: 2569.9448s
Epoch: 6 cost time: 27.773075103759766
Epoch: 6, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000003
	speed: 0.2331s/iter; left time: 9025.6799s
	iters: 200, epoch: 7 | loss: 0.0000110
	speed: 0.0670s/iter; left time: 2589.3854s
	iters: 300, epoch: 7 | loss: 0.0005254
	speed: 0.0750s/iter; left time: 2888.2268s
	iters: 400, epoch: 7 | loss: 0.0000014
	speed: 0.0675s/iter; left time: 2594.1248s
Epoch: 7 cost time: 28.63567566871643
Epoch: 7, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000088
	speed: 0.2252s/iter; left time: 8625.9392s
	iters: 200, epoch: 8 | loss: 0.0000006
	speed: 0.0658s/iter; left time: 2514.3635s
	iters: 300, epoch: 8 | loss: 0.0000020
	speed: 0.0696s/iter; left time: 2653.6074s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0674s/iter; left time: 2561.9127s
Epoch: 8 cost time: 28.123667240142822
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000126
	speed: 0.2175s/iter; left time: 8241.8453s
	iters: 200, epoch: 9 | loss: 0.0000015
	speed: 0.0660s/iter; left time: 2496.0654s
	iters: 300, epoch: 9 | loss: 0.0029636
	speed: 0.0680s/iter; left time: 2562.9515s
	iters: 400, epoch: 9 | loss: 0.0000800
	speed: 0.0666s/iter; left time: 2505.2715s
Epoch: 9 cost time: 28.017985343933105
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.309 Vali Acc: 0.958 Test Loss: 0.309 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000008
	speed: 0.2411s/iter; left time: 9035.9345s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 2723.6326s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0686s/iter; left time: 2558.2650s
	iters: 400, epoch: 10 | loss: 0.0000190
	speed: 0.0766s/iter; left time: 2847.1406s
Epoch: 10 cost time: 30.49839496612549
Epoch: 10, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.341 Vali Acc: 0.963 Test Loss: 0.341 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2378s/iter; left time: 8814.8899s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 2460.7483s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 2507.6881s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 2581.7215s
Epoch: 11 cost time: 28.799049615859985
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.977 Test Loss: 0.209 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000177
	speed: 0.2129s/iter; left time: 7805.8932s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0653s/iter; left time: 2385.7410s
	iters: 300, epoch: 12 | loss: 0.0265462
	speed: 0.0654s/iter; left time: 2386.0902s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 2550.9233s
Epoch: 12 cost time: 28.25620985031128
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.166 Vali Acc: 0.980 Test Loss: 0.166 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000014
	speed: 0.2256s/iter; left time: 8175.4165s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 2389.5112s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 2338.0735s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0686s/iter; left time: 2464.6602s
Epoch: 13 cost time: 28.74454689025879
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.982 Test Loss: 0.121 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2444s/iter; left time: 8755.8018s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 2052.4442s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0536s/iter; left time: 1910.2378s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0629s/iter; left time: 2234.0566s
Epoch: 14 cost time: 25.28642773628235
Epoch: 14, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.241 Vali Acc: 0.978 Test Loss: 0.241 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000056
	speed: 0.2187s/iter; left time: 7745.3061s
	iters: 200, epoch: 15 | loss: 0.3377251
	speed: 0.0675s/iter; left time: 2384.6783s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 2323.0139s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0673s/iter; left time: 2362.1550s
Epoch: 15 cost time: 28.250362873077393
Epoch: 15, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.195 Vali Acc: 0.978 Test Loss: 0.195 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 790930
model size : 7.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0915623
	speed: 0.0862s/iter; left time: 3551.2752s
	iters: 200, epoch: 1 | loss: 0.3269478
	speed: 0.0720s/iter; left time: 2960.3597s
	iters: 300, epoch: 1 | loss: 0.1094676
	speed: 0.0629s/iter; left time: 2579.1584s
	iters: 400, epoch: 1 | loss: 0.0325460
	speed: 0.0644s/iter; left time: 2634.3990s
Epoch: 1 cost time: 29.47088384628296
Epoch: 1, Steps: 413 | Train Loss: 0.337 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
Validation loss decreased (inf --> -0.975443).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1817798
	speed: 0.2182s/iter; left time: 8898.2680s
	iters: 200, epoch: 2 | loss: 0.1648040
	speed: 0.0642s/iter; left time: 2614.0200s
	iters: 300, epoch: 2 | loss: 0.0073712
	speed: 0.0639s/iter; left time: 2594.0302s
	iters: 400, epoch: 2 | loss: 0.0017705
	speed: 0.0618s/iter; left time: 2501.9592s
Epoch: 2 cost time: 26.152631521224976
Epoch: 2, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.057 Vali Acc: 0.978 Test Loss: 0.057 Test Acc: 0.978
Validation loss decreased (-0.975443 --> -0.977717).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0138753
	speed: 0.2000s/iter; left time: 8076.9392s
	iters: 200, epoch: 3 | loss: 0.0003315
	speed: 0.0623s/iter; left time: 2510.9127s
	iters: 300, epoch: 3 | loss: 0.0102763
	speed: 0.0661s/iter; left time: 2655.5056s
	iters: 400, epoch: 3 | loss: 0.6493569
	speed: 0.0613s/iter; left time: 2456.4391s
Epoch: 3 cost time: 26.50610613822937
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0261666
	speed: 0.1969s/iter; left time: 7867.7181s
	iters: 200, epoch: 4 | loss: 0.0002149
	speed: 0.0655s/iter; left time: 2610.7928s
	iters: 300, epoch: 4 | loss: 0.0003278
	speed: 0.0685s/iter; left time: 2722.1818s
	iters: 400, epoch: 4 | loss: 0.0000432
	speed: 0.0626s/iter; left time: 2482.6882s
Epoch: 4 cost time: 26.754477739334106
Epoch: 4, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.173 Vali Acc: 0.966 Test Loss: 0.173 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000221
	speed: 0.2242s/iter; left time: 8865.8194s
	iters: 200, epoch: 5 | loss: 0.0083320
	speed: 0.0606s/iter; left time: 2389.7446s
	iters: 300, epoch: 5 | loss: 0.0001498
	speed: 0.0645s/iter; left time: 2539.9112s
	iters: 400, epoch: 5 | loss: 0.0004501
	speed: 0.0664s/iter; left time: 2604.8908s
Epoch: 5 cost time: 26.57672667503357
Epoch: 5, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000246
	speed: 0.2102s/iter; left time: 8226.2116s
	iters: 200, epoch: 6 | loss: 0.1906594
	speed: 0.0646s/iter; left time: 2520.1826s
	iters: 300, epoch: 6 | loss: 0.0000003
	speed: 0.0647s/iter; left time: 2517.4862s
	iters: 400, epoch: 6 | loss: 0.0059335
	speed: 0.0702s/iter; left time: 2725.0536s
Epoch: 6 cost time: 28.42189049720764
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.194 Vali Acc: 0.966 Test Loss: 0.194 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0003376
	speed: 0.2145s/iter; left time: 8304.4542s
	iters: 200, epoch: 7 | loss: 0.0000011
	speed: 0.0658s/iter; left time: 2542.5154s
	iters: 300, epoch: 7 | loss: 0.0024110
	speed: 0.0662s/iter; left time: 2550.7543s
	iters: 400, epoch: 7 | loss: 0.0001168
	speed: 0.0689s/iter; left time: 2646.1803s
Epoch: 7 cost time: 28.518653392791748
Epoch: 7, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.149 Vali Acc: 0.982 Test Loss: 0.149 Test Acc: 0.982
Validation loss decreased (-0.977717 --> -0.981808).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000011
	speed: 0.2347s/iter; left time: 8990.1233s
	iters: 200, epoch: 8 | loss: 0.0004020
	speed: 0.0626s/iter; left time: 2390.3299s
	iters: 300, epoch: 8 | loss: 0.0000011
	speed: 0.0629s/iter; left time: 2396.8386s
	iters: 400, epoch: 8 | loss: 0.0000124
	speed: 0.0666s/iter; left time: 2532.8565s
Epoch: 8 cost time: 27.70300602912903
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.216 Vali Acc: 0.970 Test Loss: 0.216 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000015
	speed: 0.2218s/iter; left time: 8404.2430s
	iters: 200, epoch: 9 | loss: 0.0000030
	speed: 0.0653s/iter; left time: 2467.1421s
	iters: 300, epoch: 9 | loss: 0.0001895
	speed: 0.0624s/iter; left time: 2350.9847s
	iters: 400, epoch: 9 | loss: 0.0000052
	speed: 0.0639s/iter; left time: 2403.5268s
Epoch: 9 cost time: 27.094510316848755
Epoch: 9, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.981808 --> -0.982718).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000003
	speed: 0.2049s/iter; left time: 7681.9786s
	iters: 200, epoch: 10 | loss: 0.0000035
	speed: 0.0665s/iter; left time: 2486.8537s
	iters: 300, epoch: 10 | loss: 0.0000008
	speed: 0.0631s/iter; left time: 2353.8258s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0635s/iter; left time: 2362.8327s
Epoch: 10 cost time: 27.087648153305054
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.205 Vali Acc: 0.973 Test Loss: 0.205 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2173s/iter; left time: 8057.1468s
	iters: 200, epoch: 11 | loss: 0.1298707
	speed: 0.0689s/iter; left time: 2545.9963s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0676s/iter; left time: 2493.7342s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 2213.4031s
Epoch: 11 cost time: 27.462982416152954
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.301 Vali Acc: 0.973 Test Loss: 0.301 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.2357s/iter; left time: 8640.1562s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.0591s/iter; left time: 2161.9029s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0851s/iter; left time: 3103.8104s
	iters: 400, epoch: 12 | loss: 0.0224514
	speed: 0.0821s/iter; left time: 2984.9415s
Epoch: 12 cost time: 30.944381952285767
Epoch: 12, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.100 Vali Acc: 0.987 Test Loss: 0.100 Test Acc: 0.987
Validation loss decreased (-0.982718 --> -0.987266).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1703s/iter; left time: 6170.9045s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1884.7729s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 2364.4945s
	iters: 400, epoch: 13 | loss: 0.0093840
	speed: 0.0607s/iter; left time: 2180.2051s
Epoch: 13 cost time: 23.81020998954773
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.265 Vali Acc: 0.971 Test Loss: 0.265 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0035668
	speed: 0.1987s/iter; left time: 7120.6991s
	iters: 200, epoch: 14 | loss: 0.0000003
	speed: 0.0574s/iter; left time: 2050.5876s
	iters: 300, epoch: 14 | loss: 0.0000654
	speed: 0.0628s/iter; left time: 2239.2925s
	iters: 400, epoch: 14 | loss: 0.0001376
	speed: 0.0605s/iter; left time: 2149.1175s
Epoch: 14 cost time: 25.201879262924194
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000019
	speed: 0.1959s/iter; left time: 6939.0554s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 2093.1421s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 2094.9389s
	iters: 400, epoch: 15 | loss: 0.0120932
	speed: 0.0680s/iter; left time: 2386.7785s
Epoch: 15 cost time: 25.75809335708618
Epoch: 15, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.115 Vali Acc: 0.985 Test Loss: 0.115 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2205s/iter; left time: 7718.8303s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 2057.5761s
	iters: 300, epoch: 16 | loss: 0.0062284
	speed: 0.0559s/iter; left time: 1946.2363s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 2142.2067s
Epoch: 16 cost time: 25.57349181175232
Epoch: 16, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
Validation loss decreased (-0.987266 --> -0.987266).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2017s/iter; left time: 6975.7390s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 2054.8793s
	iters: 300, epoch: 17 | loss: 0.0083253
	speed: 0.0568s/iter; left time: 1954.8013s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0648s/iter; left time: 2221.8926s
Epoch: 17 cost time: 25.73060154914856
Epoch: 17, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.336 Vali Acc: 0.965 Test Loss: 0.336 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000019
	speed: 0.1975s/iter; left time: 6750.9086s
	iters: 200, epoch: 18 | loss: 0.2421045
	speed: 0.0619s/iter; left time: 2110.7153s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0636s/iter; left time: 2162.2443s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0633s/iter; left time: 2143.5080s
Epoch: 18 cost time: 26.46757173538208
Epoch: 18, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.134 Vali Acc: 0.985 Test Loss: 0.134 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.2194s/iter; left time: 7407.7404s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0696s/iter; left time: 2342.3979s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 2108.8061s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0590s/iter; left time: 1973.2646s
Epoch: 19 cost time: 26.683279514312744
Epoch: 19, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.177 Vali Acc: 0.980 Test Loss: 0.177 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1961s/iter; left time: 6540.8775s
	iters: 200, epoch: 20 | loss: 0.0000387
	speed: 0.0613s/iter; left time: 2039.6346s
	iters: 300, epoch: 20 | loss: 0.0000001
	speed: 0.0615s/iter; left time: 2039.8026s
	iters: 400, epoch: 20 | loss: 0.0000065
	speed: 0.0574s/iter; left time: 1896.0463s
Epoch: 20 cost time: 25.18098497390747
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.979 Test Loss: 0.191 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0016849
	speed: 0.1991s/iter; left time: 6560.1208s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 1908.4731s
	iters: 300, epoch: 21 | loss: 0.1800456
	speed: 0.0644s/iter; left time: 2107.8058s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 1936.9728s
Epoch: 21 cost time: 25.080519437789917
Epoch: 21, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.535 Vali Acc: 0.971 Test Loss: 0.535 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2137s/iter; left time: 6951.3926s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 1929.5567s
	iters: 300, epoch: 22 | loss: 0.0000278
	speed: 0.0622s/iter; left time: 2010.1119s
	iters: 400, epoch: 22 | loss: 0.0000130
	speed: 0.0636s/iter; left time: 2050.1553s
Epoch: 22 cost time: 25.50721311569214
Epoch: 22, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.397 Vali Acc: 0.968 Test Loss: 0.397 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1987s/iter; left time: 6380.5717s
	iters: 200, epoch: 23 | loss: 0.0000002
	speed: 0.0576s/iter; left time: 1843.7052s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 1964.4070s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 2066.1550s
Epoch: 23 cost time: 25.84861731529236
Epoch: 23, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.211 Vali Acc: 0.980 Test Loss: 0.211 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000617
	speed: 0.1929s/iter; left time: 6116.7375s
	iters: 200, epoch: 24 | loss: 0.0000176
	speed: 0.0522s/iter; left time: 1649.7270s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1652.4333s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 2084.7654s
Epoch: 24 cost time: 24.22431445121765
Epoch: 24, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.203 Vali Acc: 0.984 Test Loss: 0.203 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2225s/iter; left time: 6962.7535s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0630s/iter; left time: 1965.7946s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 1870.3745s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 1976.5992s
Epoch: 25 cost time: 26.406020164489746
Epoch: 25, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.301 Vali Acc: 0.980 Test Loss: 0.301 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1932s/iter; left time: 5963.9955s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 1820.8271s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 1739.8671s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 1818.3541s
Epoch: 26 cost time: 24.6268150806427
Epoch: 26, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.986 Test Loss: 0.174 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 790930
model size : 7.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1529250
	speed: 0.0472s/iter; left time: 1943.9757s
	iters: 200, epoch: 1 | loss: 0.2612539
	speed: 0.0347s/iter; left time: 1424.8281s
	iters: 300, epoch: 1 | loss: 0.1862034
	speed: 0.0316s/iter; left time: 1295.6191s
	iters: 400, epoch: 1 | loss: 0.0295473
	speed: 0.0336s/iter; left time: 1374.3825s
Epoch: 1 cost time: 15.240149974822998
Epoch: 1, Steps: 413 | Train Loss: 0.365 Vali Loss: 0.064 Vali Acc: 0.977 Test Loss: 0.064 Test Acc: 0.977
Validation loss decreased (inf --> -0.977262).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1177379
	speed: 0.0857s/iter; left time: 3493.9946s
	iters: 200, epoch: 2 | loss: 0.0257041
	speed: 0.0337s/iter; left time: 1371.5322s
	iters: 300, epoch: 2 | loss: 0.0426931
	speed: 0.0311s/iter; left time: 1263.5292s
	iters: 400, epoch: 2 | loss: 0.0358618
	speed: 0.0321s/iter; left time: 1298.9454s
Epoch: 2 cost time: 13.518542766571045
Epoch: 2, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0006996
	speed: 0.0911s/iter; left time: 3676.7857s
	iters: 200, epoch: 3 | loss: 0.0099108
	speed: 0.0339s/iter; left time: 1366.4431s
	iters: 300, epoch: 3 | loss: 0.0005615
	speed: 0.0344s/iter; left time: 1382.2554s
	iters: 400, epoch: 3 | loss: 0.0727626
	speed: 0.0350s/iter; left time: 1400.8079s
Epoch: 3 cost time: 14.558929681777954
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.977262 --> -0.979535).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3923023
	speed: 0.0863s/iter; left time: 3447.0022s
	iters: 200, epoch: 4 | loss: 0.0000338
	speed: 0.0336s/iter; left time: 1341.1661s
	iters: 300, epoch: 4 | loss: 0.4968433
	speed: 0.0334s/iter; left time: 1329.6312s
	iters: 400, epoch: 4 | loss: 0.0004310
	speed: 0.0310s/iter; left time: 1230.4418s
Epoch: 4 cost time: 14.098650932312012
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
Validation loss decreased (-0.979535 --> -0.981809).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0465508
	speed: 0.0867s/iter; left time: 3430.7947s
	iters: 200, epoch: 5 | loss: 0.0000103
	speed: 0.0345s/iter; left time: 1359.7615s
	iters: 300, epoch: 5 | loss: 0.0000181
	speed: 0.0326s/iter; left time: 1282.3675s
	iters: 400, epoch: 5 | loss: 0.0006307
	speed: 0.0398s/iter; left time: 1562.4783s
Epoch: 5 cost time: 14.863497972488403
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.981809 --> -0.982719).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0145375
	speed: 0.0910s/iter; left time: 3562.6166s
	iters: 200, epoch: 6 | loss: 0.0002959
	speed: 0.0337s/iter; left time: 1315.1578s
	iters: 300, epoch: 6 | loss: 0.0000883
	speed: 0.0304s/iter; left time: 1184.0611s
	iters: 400, epoch: 6 | loss: 0.0022646
	speed: 0.0340s/iter; left time: 1322.3148s
Epoch: 6 cost time: 14.102941274642944
Epoch: 6, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000477
	speed: 0.0855s/iter; left time: 3311.6136s
	iters: 200, epoch: 7 | loss: 0.0000105
	speed: 0.0292s/iter; left time: 1126.3040s
	iters: 300, epoch: 7 | loss: 0.5447310
	speed: 0.0402s/iter; left time: 1547.8630s
	iters: 400, epoch: 7 | loss: 0.0017984
	speed: 0.0368s/iter; left time: 1412.7066s
Epoch: 7 cost time: 14.691721439361572
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000033
	speed: 0.0858s/iter; left time: 3288.1069s
	iters: 200, epoch: 8 | loss: 0.0000007
	speed: 0.0350s/iter; left time: 1336.0202s
	iters: 300, epoch: 8 | loss: 0.0000956
	speed: 0.0324s/iter; left time: 1234.5714s
	iters: 400, epoch: 8 | loss: 0.0000027
	speed: 0.0293s/iter; left time: 1113.2202s
Epoch: 8 cost time: 13.857502460479736
Epoch: 8, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.176 Vali Acc: 0.977 Test Loss: 0.176 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1718919
	speed: 0.0868s/iter; left time: 3289.8640s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 1321.5993s
	iters: 300, epoch: 9 | loss: 0.0002116
	speed: 0.0337s/iter; left time: 1270.0318s
	iters: 400, epoch: 9 | loss: 0.0000151
	speed: 0.0342s/iter; left time: 1284.0040s
Epoch: 9 cost time: 14.20858097076416
Epoch: 9, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.0875s/iter; left time: 3280.8008s
	iters: 200, epoch: 10 | loss: 0.0000779
	speed: 0.0332s/iter; left time: 1240.7121s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0311s/iter; left time: 1160.8612s
	iters: 400, epoch: 10 | loss: 0.0932659
	speed: 0.0364s/iter; left time: 1354.7039s
Epoch: 10 cost time: 14.290479898452759
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
Validation loss decreased (-0.982719 --> -0.986811).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000023
	speed: 0.0883s/iter; left time: 3274.0912s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0319s/iter; left time: 1179.9679s
	iters: 300, epoch: 11 | loss: 0.0001994
	speed: 0.0307s/iter; left time: 1132.3896s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 1201.8598s
Epoch: 11 cost time: 13.782339096069336
Epoch: 11, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000087
	speed: 0.0899s/iter; left time: 3294.1426s
	iters: 200, epoch: 12 | loss: 0.0047770
	speed: 0.0325s/iter; left time: 1189.8081s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 1234.4239s
	iters: 400, epoch: 12 | loss: 0.0000084
	speed: 0.0335s/iter; left time: 1218.1346s
Epoch: 12 cost time: 14.22007441520691
Epoch: 12, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 3342.7982s
	iters: 200, epoch: 13 | loss: 0.0000176
	speed: 0.0320s/iter; left time: 1156.9607s
	iters: 300, epoch: 13 | loss: 0.0000003
	speed: 0.0318s/iter; left time: 1146.9416s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 1295.4098s
Epoch: 13 cost time: 14.17337965965271
Epoch: 13, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.206 Vali Acc: 0.974 Test Loss: 0.206 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.1549551
	speed: 0.0890s/iter; left time: 3190.4455s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 1162.8838s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 1190.1803s
	iters: 400, epoch: 14 | loss: 0.0002064
	speed: 0.0317s/iter; left time: 1127.6727s
Epoch: 14 cost time: 13.883149147033691
Epoch: 14, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.128 Vali Acc: 0.982 Test Loss: 0.128 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000072
	speed: 0.0899s/iter; left time: 3184.5779s
	iters: 200, epoch: 15 | loss: 0.0000013
	speed: 0.0320s/iter; left time: 1131.0737s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 1147.4690s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 1137.1225s
Epoch: 15 cost time: 13.770941019058228
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.181 Vali Acc: 0.977 Test Loss: 0.181 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 3187.7704s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.0329s/iter; left time: 1148.1469s
	iters: 300, epoch: 16 | loss: 0.0003289
	speed: 0.0331s/iter; left time: 1150.7568s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0328s/iter; left time: 1136.7559s
Epoch: 16 cost time: 14.002502202987671
Epoch: 16, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.170 Vali Acc: 0.981 Test Loss: 0.170 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0875s/iter; left time: 3025.1846s
	iters: 200, epoch: 17 | loss: 0.0006127
	speed: 0.0332s/iter; left time: 1144.4276s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 1131.4110s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 1062.6198s
Epoch: 17 cost time: 13.94457459449768
Epoch: 17, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.987 Test Loss: 0.110 Test Acc: 0.987
Validation loss decreased (-0.986811 --> -0.987266).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0914s/iter; left time: 3124.5001s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 1102.9723s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 1194.5203s
	iters: 400, epoch: 18 | loss: 0.0243885
	speed: 0.0312s/iter; left time: 1058.4087s
Epoch: 18 cost time: 14.16950798034668
Epoch: 18, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000114
	speed: 0.0855s/iter; left time: 2887.7126s
	iters: 200, epoch: 19 | loss: 0.0000007
	speed: 0.0306s/iter; left time: 1030.3649s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 1160.1559s
	iters: 400, epoch: 19 | loss: 0.0000003
	speed: 0.0350s/iter; left time: 1170.2338s
Epoch: 19 cost time: 14.036819696426392
Epoch: 19, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.145 Vali Acc: 0.984 Test Loss: 0.145 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000025
	speed: 0.0856s/iter; left time: 2856.7525s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 1099.8981s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 1038.1452s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 1149.5177s
Epoch: 20 cost time: 13.907409429550171
Epoch: 20, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.270 Vali Acc: 0.977 Test Loss: 0.270 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0856s/iter; left time: 2818.1977s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 1199.0353s
	iters: 300, epoch: 21 | loss: 0.0001445
	speed: 0.0329s/iter; left time: 1078.5740s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 1080.1999s
Epoch: 21 cost time: 14.41887354850769
Epoch: 21, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.163 Vali Acc: 0.987 Test Loss: 0.163 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0915s/iter; left time: 2976.1925s
	iters: 200, epoch: 22 | loss: 0.0000019
	speed: 0.0336s/iter; left time: 1090.7440s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 1125.9017s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1152.6715s
Epoch: 22 cost time: 14.827945709228516
Epoch: 22, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.312 Vali Acc: 0.973 Test Loss: 0.312 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0833s/iter; left time: 2674.1617s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 1040.0482s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 1092.5774s
	iters: 400, epoch: 23 | loss: 0.0003379
	speed: 0.0326s/iter; left time: 1035.7934s
Epoch: 23 cost time: 13.756090879440308
Epoch: 23, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.308 Vali Acc: 0.980 Test Loss: 0.308 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0888s/iter; left time: 2814.6825s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 981.0201s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0314s/iter; left time: 989.9809s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 1032.2921s
Epoch: 24 cost time: 13.713148832321167
Epoch: 24, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.255 Vali Acc: 0.983 Test Loss: 0.255 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000042
	speed: 0.0950s/iter; left time: 2972.3207s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 1094.8859s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 1061.4582s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 1148.0864s
Epoch: 25 cost time: 15.218323707580566
Epoch: 25, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.172 Vali Acc: 0.985 Test Loss: 0.172 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 2835.0281s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 1023.5285s
	iters: 300, epoch: 26 | loss: 0.0000965
	speed: 0.0350s/iter; left time: 1072.5368s
	iters: 400, epoch: 26 | loss: 0.0000086
	speed: 0.0338s/iter; left time: 1033.8582s
Epoch: 26 cost time: 14.55147409439087
Epoch: 26, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.342 Vali Acc: 0.973 Test Loss: 0.342 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000927
	speed: 0.0916s/iter; left time: 2790.6188s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 1034.7031s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 995.3338s
	iters: 400, epoch: 27 | loss: 0.0000001
	speed: 0.0339s/iter; left time: 1023.8262s
Epoch: 27 cost time: 14.283833742141724
Epoch: 27, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.271 Vali Acc: 0.976 Test Loss: 0.271 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 790930
model size : 7.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1625509
	speed: 0.0846s/iter; left time: 3484.2153s
	iters: 200, epoch: 1 | loss: 0.1958453
	speed: 0.0606s/iter; left time: 2491.6547s
	iters: 300, epoch: 1 | loss: 0.1413364
	speed: 0.0598s/iter; left time: 2450.0414s
	iters: 400, epoch: 1 | loss: 0.0092914
	speed: 0.0643s/iter; left time: 2630.1896s
Epoch: 1 cost time: 27.935736894607544
Epoch: 1, Steps: 413 | Train Loss: 0.320 Vali Loss: 0.097 Vali Acc: 0.967 Test Loss: 0.097 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0035037
	speed: 0.1982s/iter; left time: 8085.9015s
	iters: 200, epoch: 2 | loss: 0.0003826
	speed: 0.0652s/iter; left time: 2654.2484s
	iters: 300, epoch: 2 | loss: 0.0753088
	speed: 0.0587s/iter; left time: 2382.5915s
	iters: 400, epoch: 2 | loss: 0.5365891
	speed: 0.0588s/iter; left time: 2379.3561s
Epoch: 2 cost time: 25.596606492996216
Epoch: 2, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
Validation loss decreased (-0.966802 --> -0.967711).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0244111
	speed: 0.1951s/iter; left time: 7876.5503s
	iters: 200, epoch: 3 | loss: 0.0000977
	speed: 0.0684s/iter; left time: 2756.7890s
	iters: 300, epoch: 3 | loss: 0.0000209
	speed: 0.0639s/iter; left time: 2568.4257s
	iters: 400, epoch: 3 | loss: 0.3498701
	speed: 0.0634s/iter; left time: 2539.5500s
Epoch: 3 cost time: 26.918776750564575
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.967711 --> -0.969530).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0002091
	speed: 0.2197s/iter; left time: 8780.3953s
	iters: 200, epoch: 4 | loss: 0.0137245
	speed: 0.0694s/iter; left time: 2767.9958s
	iters: 300, epoch: 4 | loss: 0.0001003
	speed: 0.0692s/iter; left time: 2750.3307s
	iters: 400, epoch: 4 | loss: 0.0016427
	speed: 0.0646s/iter; left time: 2561.3735s
Epoch: 4 cost time: 28.099113702774048
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.969530 --> -0.975442).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000001
	speed: 0.2095s/iter; left time: 8286.3382s
	iters: 200, epoch: 5 | loss: 0.0003557
	speed: 0.0621s/iter; left time: 2448.7967s
	iters: 300, epoch: 5 | loss: 0.0076528
	speed: 0.0664s/iter; left time: 2612.0760s
	iters: 400, epoch: 5 | loss: 0.0000173
	speed: 0.0610s/iter; left time: 2395.0171s
Epoch: 5 cost time: 26.049834966659546
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000606
	speed: 0.2045s/iter; left time: 8002.3044s
	iters: 200, epoch: 6 | loss: 0.0000284
	speed: 0.0601s/iter; left time: 2347.5527s
	iters: 300, epoch: 6 | loss: 0.4556666
	speed: 0.0666s/iter; left time: 2592.9056s
	iters: 400, epoch: 6 | loss: 0.0000039
	speed: 0.0622s/iter; left time: 2416.2155s
Epoch: 6 cost time: 26.192790031433105
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0046672
	speed: 0.2078s/iter; left time: 8046.9764s
	iters: 200, epoch: 7 | loss: 0.0000890
	speed: 0.0615s/iter; left time: 2376.7697s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0623s/iter; left time: 2398.4787s
	iters: 400, epoch: 7 | loss: 0.0070693
	speed: 0.0703s/iter; left time: 2700.7258s
Epoch: 7 cost time: 26.865161180496216
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.140 Vali Acc: 0.983 Test Loss: 0.140 Test Acc: 0.983
Validation loss decreased (-0.975442 --> -0.982718).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2268s/iter; left time: 8687.4210s
	iters: 200, epoch: 8 | loss: 0.0000038
	speed: 0.0598s/iter; left time: 2283.8843s
	iters: 300, epoch: 8 | loss: 0.0974679
	speed: 0.0596s/iter; left time: 2272.9501s
	iters: 400, epoch: 8 | loss: 0.0000606
	speed: 0.0650s/iter; left time: 2470.5664s
Epoch: 8 cost time: 26.40214228630066
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.173 Vali Acc: 0.973 Test Loss: 0.173 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000020
	speed: 0.2014s/iter; left time: 7633.0588s
	iters: 200, epoch: 9 | loss: 0.0000086
	speed: 0.0646s/iter; left time: 2442.1512s
	iters: 300, epoch: 9 | loss: 0.0001129
	speed: 0.0626s/iter; left time: 2358.7711s
	iters: 400, epoch: 9 | loss: 0.0000224
	speed: 0.0657s/iter; left time: 2469.3715s
Epoch: 9 cost time: 27.43290615081787
Epoch: 9, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.133 Vali Acc: 0.979 Test Loss: 0.133 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0119103
	speed: 0.2123s/iter; left time: 7959.2003s
	iters: 200, epoch: 10 | loss: 0.1646951
	speed: 0.0686s/iter; left time: 2562.6811s
	iters: 300, epoch: 10 | loss: 0.0011438
	speed: 0.0649s/iter; left time: 2421.4855s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 2301.6903s
Epoch: 10 cost time: 28.15647530555725
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2147s/iter; left time: 7957.6878s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 2420.5179s
	iters: 300, epoch: 11 | loss: 0.0003911
	speed: 0.0617s/iter; left time: 2273.2344s
	iters: 400, epoch: 11 | loss: 0.0000007
	speed: 0.0617s/iter; left time: 2268.6381s
Epoch: 11 cost time: 26.30014729499817
Epoch: 11, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.251 Vali Acc: 0.969 Test Loss: 0.251 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2035s/iter; left time: 7460.9686s
	iters: 200, epoch: 12 | loss: 0.0001035
	speed: 0.0620s/iter; left time: 2264.7763s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 2007.6414s
	iters: 400, epoch: 12 | loss: 0.0000033
	speed: 0.0513s/iter; left time: 1863.6217s
Epoch: 12 cost time: 24.02402925491333
Epoch: 12, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.3236052
	speed: 0.1906s/iter; left time: 6908.2563s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 2147.5702s
	iters: 300, epoch: 13 | loss: 0.0000066
	speed: 0.0645s/iter; left time: 2325.3156s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0629s/iter; left time: 2260.7269s
Epoch: 13 cost time: 25.76680636405945
Epoch: 13, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.242 Vali Acc: 0.977 Test Loss: 0.242 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000020
	speed: 0.2218s/iter; left time: 7948.8798s
	iters: 200, epoch: 14 | loss: 0.0000607
	speed: 0.0597s/iter; left time: 2134.8864s
	iters: 300, epoch: 14 | loss: 0.0000387
	speed: 0.0638s/iter; left time: 2271.9912s
	iters: 400, epoch: 14 | loss: 0.0053246
	speed: 0.0597s/iter; left time: 2120.9692s
Epoch: 14 cost time: 25.612615823745728
Epoch: 14, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0001420
	speed: 0.1957s/iter; left time: 6933.0383s
	iters: 200, epoch: 15 | loss: 0.0000156
	speed: 0.0617s/iter; left time: 2179.0546s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 2166.1380s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0657s/iter; left time: 2308.5350s
Epoch: 15 cost time: 26.597943544387817
Epoch: 15, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.987 Test Loss: 0.126 Test Acc: 0.987
Validation loss decreased (-0.982718 --> -0.986811).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0029604
	speed: 0.2022s/iter; left time: 7079.3918s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0618s/iter; left time: 2155.5589s
	iters: 300, epoch: 16 | loss: 0.9970476
	speed: 0.0598s/iter; left time: 2080.6342s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0697s/iter; left time: 2418.7966s
Epoch: 16 cost time: 26.897058725357056
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.377 Vali Acc: 0.974 Test Loss: 0.377 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2166s/iter; left time: 7491.9749s
	iters: 200, epoch: 17 | loss: 0.0005345
	speed: 0.0594s/iter; left time: 2050.1339s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 2095.8958s
	iters: 400, epoch: 17 | loss: 0.0579857
	speed: 0.0699s/iter; left time: 2397.5050s
Epoch: 17 cost time: 26.58163857460022
Epoch: 17, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.977 Test Loss: 0.207 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.2045s/iter; left time: 6990.1571s
	iters: 200, epoch: 18 | loss: 0.0005702
	speed: 0.0607s/iter; left time: 2069.6597s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0603s/iter; left time: 2047.6549s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0634s/iter; left time: 2147.2212s
Epoch: 18 cost time: 26.32904601097107
Epoch: 18, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.983 Test Loss: 0.157 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000005
	speed: 0.2093s/iter; left time: 7067.5544s
	iters: 200, epoch: 19 | loss: 0.0000166
	speed: 0.0604s/iter; left time: 2034.3156s
	iters: 300, epoch: 19 | loss: 0.0575484
	speed: 0.0602s/iter; left time: 2020.3071s
	iters: 400, epoch: 19 | loss: 0.0010513
	speed: 0.0627s/iter; left time: 2098.6369s
Epoch: 19 cost time: 26.488086462020874
Epoch: 19, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.144 Vali Acc: 0.986 Test Loss: 0.144 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2264s/iter; left time: 7552.2642s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 2003.2399s
	iters: 300, epoch: 20 | loss: 0.0000174
	speed: 0.0606s/iter; left time: 2010.4252s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0614s/iter; left time: 2029.8833s
Epoch: 20 cost time: 26.395758628845215
Epoch: 20, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.267 Vali Acc: 0.980 Test Loss: 0.267 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2335s/iter; left time: 7691.4192s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0822s/iter; left time: 2701.1385s
	iters: 300, epoch: 21 | loss: 0.0000067
	speed: 0.0462s/iter; left time: 1513.7156s
	iters: 400, epoch: 21 | loss: 0.0884732
	speed: 0.0472s/iter; left time: 1541.1162s
Epoch: 21 cost time: 26.62994122505188
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.541 Vali Acc: 0.965 Test Loss: 0.541 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0879872
	speed: 0.1732s/iter; left time: 5634.9298s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 2127.7339s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 1941.4833s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 2023.7110s
Epoch: 22 cost time: 26.265121698379517
Epoch: 22, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.249 Vali Acc: 0.981 Test Loss: 0.249 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1981s/iter; left time: 6362.6060s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0651s/iter; left time: 2085.6036s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 1933.4634s
	iters: 400, epoch: 23 | loss: 0.0000002
	speed: 0.0586s/iter; left time: 1865.8103s
Epoch: 23 cost time: 25.79042100906372
Epoch: 23, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.139 Vali Acc: 0.986 Test Loss: 0.139 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2015s/iter; left time: 6386.8494s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 2182.1373s
	iters: 300, epoch: 24 | loss: 0.0052558
	speed: 0.0607s/iter; left time: 1912.4717s
	iters: 400, epoch: 24 | loss: 0.0508356
	speed: 0.0589s/iter; left time: 1848.1038s
Epoch: 24 cost time: 26.376676321029663
Epoch: 24, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.262 Vali Acc: 0.977 Test Loss: 0.262 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2158s/iter; left time: 6752.3516s
	iters: 200, epoch: 25 | loss: 0.1694877
	speed: 0.0626s/iter; left time: 1952.0248s
	iters: 300, epoch: 25 | loss: 0.0010255
	speed: 0.0633s/iter; left time: 1967.7828s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 1859.4052s
Epoch: 25 cost time: 26.016749143600464
Epoch: 25, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.324 Vali Acc: 0.976 Test Loss: 0.324 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 659858
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1516336
	speed: 0.0803s/iter; left time: 3308.7027s
	iters: 200, epoch: 1 | loss: 0.1879068
	speed: 0.0615s/iter; left time: 2527.4933s
	iters: 300, epoch: 1 | loss: 0.0471768
	speed: 0.0643s/iter; left time: 2634.6604s
	iters: 400, epoch: 1 | loss: 0.0158860
	speed: 0.0592s/iter; left time: 2422.8790s
Epoch: 1 cost time: 27.347768306732178
Epoch: 1, Steps: 413 | Train Loss: 0.317 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (inf --> -0.969985).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0111569
	speed: 0.2121s/iter; left time: 8650.4130s
	iters: 200, epoch: 2 | loss: 0.0149143
	speed: 0.0564s/iter; left time: 2296.3682s
	iters: 300, epoch: 2 | loss: 0.0022346
	speed: 0.0658s/iter; left time: 2671.4864s
	iters: 400, epoch: 2 | loss: 0.1537412
	speed: 0.0634s/iter; left time: 2568.1504s
Epoch: 2 cost time: 25.931132078170776
Epoch: 2, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.969985 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0031122
	speed: 0.2068s/iter; left time: 8349.9262s
	iters: 200, epoch: 3 | loss: 0.0003269
	speed: 0.0577s/iter; left time: 2325.3553s
	iters: 300, epoch: 3 | loss: 0.0706329
	speed: 0.0580s/iter; left time: 2328.1559s
	iters: 400, epoch: 3 | loss: 0.0031006
	speed: 0.0531s/iter; left time: 2126.4105s
Epoch: 3 cost time: 23.810404062271118
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0046514
	speed: 0.1798s/iter; left time: 7185.9958s
	iters: 200, epoch: 4 | loss: 0.0031544
	speed: 0.0560s/iter; left time: 2231.5722s
	iters: 300, epoch: 4 | loss: 0.0000071
	speed: 0.0610s/iter; left time: 2424.0590s
	iters: 400, epoch: 4 | loss: 0.0005200
	speed: 0.0621s/iter; left time: 2462.7132s
Epoch: 4 cost time: 25.016956567764282
Epoch: 4, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000032
	speed: 0.1972s/iter; left time: 7800.0441s
	iters: 200, epoch: 5 | loss: 0.0000014
	speed: 0.0560s/iter; left time: 2210.4860s
	iters: 300, epoch: 5 | loss: 0.0022850
	speed: 0.0617s/iter; left time: 2426.4471s
	iters: 400, epoch: 5 | loss: 0.0078460
	speed: 0.0621s/iter; left time: 2438.3937s
Epoch: 5 cost time: 25.291189908981323
Epoch: 5, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0040180
	speed: 0.2096s/iter; left time: 8202.5488s
	iters: 200, epoch: 6 | loss: 0.0000053
	speed: 0.0557s/iter; left time: 2175.6826s
	iters: 300, epoch: 6 | loss: 0.1532708
	speed: 0.0572s/iter; left time: 2228.7903s
	iters: 400, epoch: 6 | loss: 0.0007243
	speed: 0.0602s/iter; left time: 2338.8794s
Epoch: 6 cost time: 25.106118202209473
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.0854974
	speed: 0.1899s/iter; left time: 7355.3956s
	iters: 200, epoch: 7 | loss: 0.0000068
	speed: 0.0628s/iter; left time: 2426.7615s
	iters: 300, epoch: 7 | loss: 0.1527704
	speed: 0.0607s/iter; left time: 2337.7431s
	iters: 400, epoch: 7 | loss: 0.0160148
	speed: 0.0604s/iter; left time: 2321.0432s
Epoch: 7 cost time: 25.468435049057007
Epoch: 7, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.190 Vali Acc: 0.973 Test Loss: 0.190 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000111
	speed: 0.1874s/iter; left time: 7179.0349s
	iters: 200, epoch: 8 | loss: 0.0003115
	speed: 0.0619s/iter; left time: 2364.2793s
	iters: 300, epoch: 8 | loss: 0.0076775
	speed: 0.0596s/iter; left time: 2270.2087s
	iters: 400, epoch: 8 | loss: 0.0000079
	speed: 0.0605s/iter; left time: 2298.1198s
Epoch: 8 cost time: 25.36882996559143
Epoch: 8, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2002s/iter; left time: 7587.6337s
	iters: 200, epoch: 9 | loss: 0.0002420
	speed: 0.0597s/iter; left time: 2258.2024s
	iters: 300, epoch: 9 | loss: 0.1919956
	speed: 0.0691s/iter; left time: 2605.9617s
	iters: 400, epoch: 9 | loss: 0.0001675
	speed: 0.0570s/iter; left time: 2144.0474s
Epoch: 9 cost time: 25.675234079360962
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.984 Test Loss: 0.122 Test Acc: 0.984
Validation loss decreased (-0.975897 --> -0.984082).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0920344
	speed: 0.1992s/iter; left time: 7467.5564s
	iters: 200, epoch: 10 | loss: 0.0000012
	speed: 0.0567s/iter; left time: 2118.4189s
	iters: 300, epoch: 10 | loss: 0.0002491
	speed: 0.0576s/iter; left time: 2149.4143s
	iters: 400, epoch: 10 | loss: 0.0010502
	speed: 0.0597s/iter; left time: 2219.1477s
Epoch: 10 cost time: 24.512463092803955
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1869s/iter; left time: 6927.4033s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 2109.1647s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 2042.6860s
	iters: 400, epoch: 11 | loss: 0.0000031
	speed: 0.0641s/iter; left time: 2356.4376s
Epoch: 11 cost time: 25.00575542449951
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.160 Vali Acc: 0.978 Test Loss: 0.160 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000080
	speed: 0.2118s/iter; left time: 7763.7522s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 2231.3614s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 2114.7824s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 2167.3397s
Epoch: 12 cost time: 25.35424828529358
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.245 Vali Acc: 0.967 Test Loss: 0.245 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000157
	speed: 0.1885s/iter; left time: 6830.4053s
	iters: 200, epoch: 13 | loss: 0.2150885
	speed: 0.0618s/iter; left time: 2233.2677s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 2124.3758s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 2089.7264s
Epoch: 13 cost time: 24.793686866760254
Epoch: 13, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.436 Vali Acc: 0.965 Test Loss: 0.436 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1917s/iter; left time: 6868.5429s
	iters: 200, epoch: 14 | loss: 0.0119999
	speed: 0.0616s/iter; left time: 2202.1049s
	iters: 300, epoch: 14 | loss: 0.2863244
	speed: 0.0614s/iter; left time: 2188.1743s
	iters: 400, epoch: 14 | loss: 0.0000010
	speed: 0.0583s/iter; left time: 2070.5729s
Epoch: 14 cost time: 25.18963050842285
Epoch: 14, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2006s/iter; left time: 7106.0548s
	iters: 200, epoch: 15 | loss: 0.0000009
	speed: 0.0602s/iter; left time: 2125.2323s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 2246.9607s
	iters: 400, epoch: 15 | loss: 0.0000015
	speed: 0.0619s/iter; left time: 2174.4935s
Epoch: 15 cost time: 25.925146102905273
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.161 Vali Acc: 0.981 Test Loss: 0.161 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2140s/iter; left time: 7490.0648s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0574s/iter; left time: 2002.7971s
	iters: 300, epoch: 16 | loss: 0.2111422
	speed: 0.0599s/iter; left time: 2083.3672s
	iters: 400, epoch: 16 | loss: 0.0000004
	speed: 0.0580s/iter; left time: 2013.3493s
Epoch: 16 cost time: 24.705424785614014
Epoch: 16, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.305 Vali Acc: 0.978 Test Loss: 0.305 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1892s/iter; left time: 6543.5685s
	iters: 200, epoch: 17 | loss: 0.0167748
	speed: 0.0588s/iter; left time: 2028.7376s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 1946.7242s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 1899.0342s
Epoch: 17 cost time: 24.113734245300293
Epoch: 17, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.242 Vali Acc: 0.974 Test Loss: 0.242 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1901s/iter; left time: 6496.0394s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0624s/iter; left time: 2125.0364s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0585s/iter; left time: 1987.6772s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 2066.3177s
Epoch: 18 cost time: 26.24745273590088
Epoch: 18, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.205 Vali Acc: 0.981 Test Loss: 0.205 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2144s/iter; left time: 7239.9156s
	iters: 200, epoch: 19 | loss: 0.0000043
	speed: 0.0675s/iter; left time: 2271.4423s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0607s/iter; left time: 2037.5817s
	iters: 400, epoch: 19 | loss: 0.0000106
	speed: 0.0633s/iter; left time: 2117.8377s
Epoch: 19 cost time: 26.444298267364502
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.492 Vali Acc: 0.965 Test Loss: 0.492 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 659858
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1626580
	speed: 0.0798s/iter; left time: 3289.6570s
	iters: 200, epoch: 1 | loss: 0.1110076
	speed: 0.0608s/iter; left time: 2498.6067s
	iters: 300, epoch: 1 | loss: 0.0334079
	speed: 0.0664s/iter; left time: 2722.6011s
	iters: 400, epoch: 1 | loss: 0.0234453
	speed: 0.0626s/iter; left time: 2560.8437s
Epoch: 1 cost time: 27.981558799743652
Epoch: 1, Steps: 413 | Train Loss: 0.319 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
Validation loss decreased (inf --> -0.974533).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0006212
	speed: 0.2108s/iter; left time: 8597.8804s
	iters: 200, epoch: 2 | loss: 0.0012106
	speed: 0.0599s/iter; left time: 2438.8978s
	iters: 300, epoch: 2 | loss: 0.0006183
	speed: 0.0589s/iter; left time: 2391.2485s
	iters: 400, epoch: 2 | loss: 0.3595918
	speed: 0.0637s/iter; left time: 2580.2810s
Epoch: 2 cost time: 26.227142810821533
Epoch: 2, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0026197
	speed: 0.2057s/iter; left time: 8306.7075s
	iters: 200, epoch: 3 | loss: 0.0064391
	speed: 0.0602s/iter; left time: 2426.5058s
	iters: 300, epoch: 3 | loss: 0.0015349
	speed: 0.0584s/iter; left time: 2347.0492s
	iters: 400, epoch: 3 | loss: 0.7748256
	speed: 0.0595s/iter; left time: 2384.8404s
Epoch: 3 cost time: 25.18363332748413
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0010661
	speed: 0.1949s/iter; left time: 7788.1728s
	iters: 200, epoch: 4 | loss: 0.0127404
	speed: 0.0600s/iter; left time: 2391.5294s
	iters: 300, epoch: 4 | loss: 0.0006805
	speed: 0.0580s/iter; left time: 2305.4932s
	iters: 400, epoch: 4 | loss: 0.0031913
	speed: 0.0585s/iter; left time: 2320.7747s
Epoch: 4 cost time: 24.54534101486206
Epoch: 4, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0016168
	speed: 0.1932s/iter; left time: 7639.7935s
	iters: 200, epoch: 5 | loss: 0.0000161
	speed: 0.0584s/iter; left time: 2302.9675s
	iters: 300, epoch: 5 | loss: 0.0032123
	speed: 0.0711s/iter; left time: 2797.1787s
	iters: 400, epoch: 5 | loss: 0.0000022
	speed: 0.0587s/iter; left time: 2304.8063s
Epoch: 5 cost time: 25.747173309326172
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
Validation loss decreased (-0.974533 --> -0.974987).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000107
	speed: 0.2126s/iter; left time: 8321.8495s
	iters: 200, epoch: 6 | loss: 0.0009447
	speed: 0.0604s/iter; left time: 2356.2324s
	iters: 300, epoch: 6 | loss: 0.0005588
	speed: 0.0623s/iter; left time: 2424.5909s
	iters: 400, epoch: 6 | loss: 0.0046188
	speed: 0.0668s/iter; left time: 2593.5725s
Epoch: 6 cost time: 26.83746361732483
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.974987 --> -0.980444).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0005860
	speed: 0.1930s/iter; left time: 7474.4624s
	iters: 200, epoch: 7 | loss: 0.1741310
	speed: 0.0646s/iter; left time: 2496.5013s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 2417.3235s
	iters: 400, epoch: 7 | loss: 0.2784962
	speed: 0.0604s/iter; left time: 2321.9951s
Epoch: 7 cost time: 26.358530521392822
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.172 Vali Acc: 0.976 Test Loss: 0.172 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000277
	speed: 0.1986s/iter; left time: 7608.1393s
	iters: 200, epoch: 8 | loss: 0.0001021
	speed: 0.0661s/iter; left time: 2525.4515s
	iters: 300, epoch: 8 | loss: 0.0071880
	speed: 0.0601s/iter; left time: 2292.0057s
	iters: 400, epoch: 8 | loss: 0.2928164
	speed: 0.0575s/iter; left time: 2187.2007s
Epoch: 8 cost time: 25.325053215026855
Epoch: 8, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5375720
	speed: 0.2055s/iter; left time: 7786.0379s
	iters: 200, epoch: 9 | loss: 0.0002167
	speed: 0.0578s/iter; left time: 2182.9050s
	iters: 300, epoch: 9 | loss: 0.0000699
	speed: 0.0625s/iter; left time: 2357.4941s
	iters: 400, epoch: 9 | loss: 0.0003591
	speed: 0.0634s/iter; left time: 2382.8990s
Epoch: 9 cost time: 25.242253303527832
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.318 Vali Acc: 0.959 Test Loss: 0.318 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0002342
	speed: 0.2133s/iter; left time: 7996.1012s
	iters: 200, epoch: 10 | loss: 0.0000104
	speed: 0.0586s/iter; left time: 2190.9266s
	iters: 300, epoch: 10 | loss: 0.5480347
	speed: 0.0587s/iter; left time: 2187.5633s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0640s/iter; left time: 2378.4820s
Epoch: 10 cost time: 25.570430755615234
Epoch: 10, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.108 Vali Acc: 0.987 Test Loss: 0.108 Test Acc: 0.987
Validation loss decreased (-0.980444 --> -0.986811).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000022
	speed: 0.1967s/iter; left time: 7291.3333s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0604s/iter; left time: 2231.6915s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 2186.4648s
	iters: 400, epoch: 11 | loss: 0.0000200
	speed: 0.0604s/iter; left time: 2219.3569s
Epoch: 11 cost time: 25.60489296913147
Epoch: 11, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.155 Vali Acc: 0.978 Test Loss: 0.155 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1961s/iter; left time: 7188.7638s
	iters: 200, epoch: 12 | loss: 0.0000130
	speed: 0.0690s/iter; left time: 2521.4383s
	iters: 300, epoch: 12 | loss: 0.0614175
	speed: 0.0653s/iter; left time: 2381.1417s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 2244.9229s
Epoch: 12 cost time: 26.791447162628174
Epoch: 12, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2111s/iter; left time: 7651.5603s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0627s/iter; left time: 2267.4203s
	iters: 300, epoch: 13 | loss: 0.0000079
	speed: 0.0605s/iter; left time: 2180.0454s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0636s/iter; left time: 2285.7264s
Epoch: 13 cost time: 25.974048376083374
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.177 Vali Acc: 0.980 Test Loss: 0.177 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1932s/iter; left time: 6924.0794s
	iters: 200, epoch: 14 | loss: 0.0010138
	speed: 0.0597s/iter; left time: 2134.8858s
	iters: 300, epoch: 14 | loss: 0.0010234
	speed: 0.0600s/iter; left time: 2139.1489s
	iters: 400, epoch: 14 | loss: 0.0000006
	speed: 0.0616s/iter; left time: 2187.8273s
Epoch: 14 cost time: 26.101983547210693
Epoch: 14, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1235418
	speed: 0.2003s/iter; left time: 7093.0913s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0631s/iter; left time: 2228.6089s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 2020.7439s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0585s/iter; left time: 2055.1301s
Epoch: 15 cost time: 25.362165927886963
Epoch: 15, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.211 Vali Acc: 0.980 Test Loss: 0.211 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000060
	speed: 0.2061s/iter; left time: 7216.4533s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 2032.0490s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 2420.1107s
	iters: 400, epoch: 16 | loss: 0.1438493
	speed: 0.0622s/iter; left time: 2157.5581s
Epoch: 16 cost time: 25.924243927001953
Epoch: 16, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.982 Test Loss: 0.188 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1974s/iter; left time: 6827.0945s
	iters: 200, epoch: 17 | loss: 0.0012764
	speed: 0.0604s/iter; left time: 2084.9892s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0605s/iter; left time: 2079.4867s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 2224.0740s
Epoch: 17 cost time: 25.889524936676025
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2015s/iter; left time: 6885.6253s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0615s/iter; left time: 2094.8406s
	iters: 300, epoch: 18 | loss: 0.0000020
	speed: 0.0619s/iter; left time: 2103.9970s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0613s/iter; left time: 2078.2581s
Epoch: 18 cost time: 26.323612213134766
Epoch: 18, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.299 Vali Acc: 0.977 Test Loss: 0.299 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000002
	speed: 0.2166s/iter; left time: 7314.5677s
	iters: 200, epoch: 19 | loss: 0.0003648
	speed: 0.0696s/iter; left time: 2342.6523s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 2123.0218s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 2058.5406s
Epoch: 19 cost time: 27.098669290542603
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.233 Vali Acc: 0.977 Test Loss: 0.233 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1882s/iter; left time: 6277.8679s
	iters: 200, epoch: 20 | loss: 0.2003755
	speed: 0.0506s/iter; left time: 1681.1917s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0651s/iter; left time: 2156.7781s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0599s/iter; left time: 1978.9516s
Epoch: 20 cost time: 23.62023949623108
Epoch: 20, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.231 Vali Acc: 0.978 Test Loss: 0.231 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 659858
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2260576
	speed: 0.0788s/iter; left time: 3244.7862s
	iters: 200, epoch: 1 | loss: 0.1426877
	speed: 0.0573s/iter; left time: 2357.0609s
	iters: 300, epoch: 1 | loss: 0.0323517
	speed: 0.0568s/iter; left time: 2330.3521s
	iters: 400, epoch: 1 | loss: 0.0085612
	speed: 0.0656s/iter; left time: 2683.8612s
Epoch: 1 cost time: 26.632035493850708
Epoch: 1, Steps: 413 | Train Loss: 0.347 Vali Loss: 0.066 Vali Acc: 0.976 Test Loss: 0.066 Test Acc: 0.976
Validation loss decreased (inf --> -0.975897).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0004769
	speed: 0.2121s/iter; left time: 8652.5494s
	iters: 200, epoch: 2 | loss: 0.0036222
	speed: 0.0587s/iter; left time: 2386.6840s
	iters: 300, epoch: 2 | loss: 0.0009923
	speed: 0.0564s/iter; left time: 2290.9613s
	iters: 400, epoch: 2 | loss: 0.2108275
	speed: 0.0590s/iter; left time: 2389.9050s
Epoch: 2 cost time: 25.315563917160034
Epoch: 2, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0916374
	speed: 0.1909s/iter; left time: 7707.0226s
	iters: 200, epoch: 3 | loss: 0.0042814
	speed: 0.0631s/iter; left time: 2539.5346s
	iters: 300, epoch: 3 | loss: 0.1744764
	speed: 0.0579s/iter; left time: 2325.8783s
	iters: 400, epoch: 3 | loss: 0.0009472
	speed: 0.0568s/iter; left time: 2276.7394s
Epoch: 3 cost time: 24.589741945266724
Epoch: 3, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.053 Vali Acc: 0.983 Test Loss: 0.053 Test Acc: 0.983
Validation loss decreased (-0.975897 --> -0.983174).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000730
	speed: 0.1937s/iter; left time: 7739.8981s
	iters: 200, epoch: 4 | loss: 0.0004188
	speed: 0.0626s/iter; left time: 2494.2442s
	iters: 300, epoch: 4 | loss: 0.1365368
	speed: 0.0623s/iter; left time: 2478.6331s
	iters: 400, epoch: 4 | loss: 0.0218351
	speed: 0.0597s/iter; left time: 2368.9251s
Epoch: 4 cost time: 25.60920214653015
Epoch: 4, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000451
	speed: 0.2107s/iter; left time: 8333.0934s
	iters: 200, epoch: 5 | loss: 0.0000628
	speed: 0.0596s/iter; left time: 2352.3760s
	iters: 300, epoch: 5 | loss: 0.0246982
	speed: 0.0657s/iter; left time: 2586.7855s
	iters: 400, epoch: 5 | loss: 0.0003280
	speed: 0.0605s/iter; left time: 2375.1627s
Epoch: 5 cost time: 25.746370553970337
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.2038s/iter; left time: 7975.6544s
	iters: 200, epoch: 6 | loss: 0.0000022
	speed: 0.0577s/iter; left time: 2252.7379s
	iters: 300, epoch: 6 | loss: 0.0000114
	speed: 0.0591s/iter; left time: 2301.2566s
	iters: 400, epoch: 6 | loss: 0.0306868
	speed: 0.0601s/iter; left time: 2335.4108s
Epoch: 6 cost time: 24.715884923934937
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.274 Vali Acc: 0.963 Test Loss: 0.274 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000021
	speed: 0.1956s/iter; left time: 7574.2986s
	iters: 200, epoch: 7 | loss: 0.0174208
	speed: 0.0571s/iter; left time: 2206.9593s
	iters: 300, epoch: 7 | loss: 0.0000686
	speed: 0.0575s/iter; left time: 2214.2927s
	iters: 400, epoch: 7 | loss: 0.1122294
	speed: 0.0625s/iter; left time: 2400.1063s
Epoch: 7 cost time: 25.10405921936035
Epoch: 7, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1869s/iter; left time: 7158.3984s
	iters: 200, epoch: 8 | loss: 0.6244748
	speed: 0.0596s/iter; left time: 2278.6793s
	iters: 300, epoch: 8 | loss: 0.0000013
	speed: 0.0572s/iter; left time: 2181.0034s
	iters: 400, epoch: 8 | loss: 0.0000348
	speed: 0.0586s/iter; left time: 2227.3484s
Epoch: 8 cost time: 24.919442415237427
Epoch: 8, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.088 Vali Acc: 0.982 Test Loss: 0.088 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2071s/iter; left time: 7848.3629s
	iters: 200, epoch: 9 | loss: 0.0000098
	speed: 0.0660s/iter; left time: 2494.8938s
	iters: 300, epoch: 9 | loss: 0.0015089
	speed: 0.0606s/iter; left time: 2284.9160s
	iters: 400, epoch: 9 | loss: 0.0001338
	speed: 0.0534s/iter; left time: 2008.2097s
Epoch: 9 cost time: 24.89818835258484
Epoch: 9, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.209 Vali Acc: 0.977 Test Loss: 0.209 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0003724
	speed: 0.1896s/iter; left time: 7107.3447s
	iters: 200, epoch: 10 | loss: 0.0000003
	speed: 0.0585s/iter; left time: 2187.6159s
	iters: 300, epoch: 10 | loss: 0.0022381
	speed: 0.0626s/iter; left time: 2334.3952s
	iters: 400, epoch: 10 | loss: 0.0000026
	speed: 0.0599s/iter; left time: 2225.9951s
Epoch: 10 cost time: 25.285158395767212
Epoch: 10, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.136 Vali Acc: 0.984 Test Loss: 0.136 Test Acc: 0.984
Validation loss decreased (-0.983174 --> -0.983628).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1869s/iter; left time: 6929.5482s
	iters: 200, epoch: 11 | loss: 0.0023522
	speed: 0.0572s/iter; left time: 2116.4007s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0652s/iter; left time: 2402.6110s
	iters: 400, epoch: 11 | loss: 0.0000254
	speed: 0.0587s/iter; left time: 2159.7746s
Epoch: 11 cost time: 24.972059965133667
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.145 Vali Acc: 0.983 Test Loss: 0.145 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.2549666
	speed: 0.2105s/iter; left time: 7718.1851s
	iters: 200, epoch: 12 | loss: 0.0000074
	speed: 0.0577s/iter; left time: 2108.3623s
	iters: 300, epoch: 12 | loss: 0.0000014
	speed: 0.0579s/iter; left time: 2111.4889s
	iters: 400, epoch: 12 | loss: 0.0000131
	speed: 0.0674s/iter; left time: 2452.2681s
Epoch: 12 cost time: 26.30099105834961
Epoch: 12, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.303 Vali Acc: 0.974 Test Loss: 0.303 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1050253
	speed: 0.1929s/iter; left time: 6993.1851s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 2154.4342s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 2015.5989s
	iters: 400, epoch: 13 | loss: 0.0005582
	speed: 0.0592s/iter; left time: 2127.1099s
Epoch: 13 cost time: 24.664705276489258
Epoch: 13, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.327 Vali Acc: 0.970 Test Loss: 0.327 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1872s/iter; left time: 6707.0350s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0605s/iter; left time: 2160.8398s
	iters: 300, epoch: 14 | loss: 0.0004236
	speed: 0.0551s/iter; left time: 1963.2960s
	iters: 400, epoch: 14 | loss: 0.0000099
	speed: 0.0597s/iter; left time: 2120.0945s
Epoch: 14 cost time: 24.76580238342285
Epoch: 14, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.224 Vali Acc: 0.983 Test Loss: 0.224 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1955s/iter; left time: 6924.0677s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 2292.1969s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0623s/iter; left time: 2195.3609s
	iters: 400, epoch: 15 | loss: 0.0037791
	speed: 0.0572s/iter; left time: 2007.4065s
Epoch: 15 cost time: 25.51738739013672
Epoch: 15, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.145 Vali Acc: 0.983 Test Loss: 0.145 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000036
	speed: 0.2110s/iter; left time: 7384.5574s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 1989.2057s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0635s/iter; left time: 2211.7128s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 2050.9365s
Epoch: 16 cost time: 25.11530566215515
Epoch: 16, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.071 Vali Acc: 0.990 Test Loss: 0.071 Test Acc: 0.990
Validation loss decreased (-0.983628 --> -0.989540).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000002
	speed: 0.1907s/iter; left time: 6597.7727s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0599s/iter; left time: 2065.4059s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 2173.0212s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 2063.1863s
Epoch: 17 cost time: 25.34648585319519
Epoch: 17, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.241 Vali Acc: 0.980 Test Loss: 0.241 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1880s/iter; left time: 6424.6399s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0564s/iter; left time: 1922.0596s
	iters: 300, epoch: 18 | loss: 0.0009734
	speed: 0.0550s/iter; left time: 1870.1811s
	iters: 400, epoch: 18 | loss: 0.0002763
	speed: 0.0576s/iter; left time: 1950.7101s
Epoch: 18 cost time: 24.19398522377014
Epoch: 18, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.269 Vali Acc: 0.980 Test Loss: 0.269 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1792s/iter; left time: 6051.0906s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0564s/iter; left time: 1897.2415s
	iters: 300, epoch: 19 | loss: 0.0000057
	speed: 0.0581s/iter; left time: 1951.8508s
	iters: 400, epoch: 19 | loss: 0.0000013
	speed: 0.0537s/iter; left time: 1797.7074s
Epoch: 19 cost time: 24.159188270568848
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.988 Test Loss: 0.122 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1867s/iter; left time: 6227.1516s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0605s/iter; left time: 2012.7422s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0557s/iter; left time: 1847.8787s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0564s/iter; left time: 1862.6313s
Epoch: 20 cost time: 24.228188037872314
Epoch: 20, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.284 Vali Acc: 0.978 Test Loss: 0.284 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1873s/iter; left time: 6171.1402s
	iters: 200, epoch: 21 | loss: 0.0000002
	speed: 0.0612s/iter; left time: 2009.8670s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 1816.3862s
	iters: 400, epoch: 21 | loss: 0.0384643
	speed: 0.0579s/iter; left time: 1890.1677s
Epoch: 21 cost time: 24.386085510253906
Epoch: 21, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.270 Vali Acc: 0.984 Test Loss: 0.270 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2041s/iter; left time: 6639.5118s
	iters: 200, epoch: 22 | loss: 0.9016780
	speed: 0.0661s/iter; left time: 2142.4212s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 1965.4801s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 1858.5166s
Epoch: 22 cost time: 25.28975820541382
Epoch: 22, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.152 Vali Acc: 0.988 Test Loss: 0.152 Test Acc: 0.988
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000002
	speed: 0.1871s/iter; left time: 6009.8896s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 1856.8660s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0623s/iter; left time: 1987.7384s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 1803.9017s
Epoch: 23 cost time: 24.493675708770752
Epoch: 23, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.985 Test Loss: 0.117 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1871s/iter; left time: 5931.9666s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 1869.6475s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 1883.5657s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 1679.6582s
Epoch: 24 cost time: 24.341063022613525
Epoch: 24, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.343 Vali Acc: 0.983 Test Loss: 0.343 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000003
	speed: 0.1867s/iter; left time: 5840.8760s
	iters: 200, epoch: 25 | loss: 0.0000001
	speed: 0.0540s/iter; left time: 1684.7370s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 1864.8462s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 1777.6436s
Epoch: 25 cost time: 23.89091944694519
Epoch: 25, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.235 Vali Acc: 0.984 Test Loss: 0.235 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1966s/iter; left time: 6069.4312s
	iters: 200, epoch: 26 | loss: 0.1829548
	speed: 0.0536s/iter; left time: 1648.6607s
	iters: 300, epoch: 26 | loss: 0.4367833
	speed: 0.0548s/iter; left time: 1680.9868s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 1818.8590s
Epoch: 26 cost time: 23.639214754104614
Epoch: 26, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.357 Vali Acc: 0.982 Test Loss: 0.357 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 659858
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1392633
	speed: 0.0797s/iter; left time: 3283.7233s
	iters: 200, epoch: 1 | loss: 0.1187405
	speed: 0.0563s/iter; left time: 2313.8495s
	iters: 300, epoch: 1 | loss: 0.0189608
	speed: 0.0561s/iter; left time: 2298.5421s
	iters: 400, epoch: 1 | loss: 0.0027668
	speed: 0.0573s/iter; left time: 2342.6597s
Epoch: 1 cost time: 25.758002519607544
Epoch: 1, Steps: 413 | Train Loss: 0.329 Vali Loss: 0.083 Vali Acc: 0.972 Test Loss: 0.083 Test Acc: 0.972
Validation loss decreased (inf --> -0.971805).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1010622
	speed: 0.2144s/iter; left time: 8746.1893s
	iters: 200, epoch: 2 | loss: 0.0120349
	speed: 0.0627s/iter; left time: 2552.0260s
	iters: 300, epoch: 2 | loss: 0.0127644
	speed: 0.0602s/iter; left time: 2442.1325s
	iters: 400, epoch: 2 | loss: 0.0001861
	speed: 0.0615s/iter; left time: 2488.2581s
Epoch: 2 cost time: 26.48682737350464
Epoch: 2, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.971805 --> -0.979535).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0014655
	speed: 0.2015s/iter; left time: 8135.1271s
	iters: 200, epoch: 3 | loss: 0.1117583
	speed: 0.0642s/iter; left time: 2586.4093s
	iters: 300, epoch: 3 | loss: 0.1231488
	speed: 0.0604s/iter; left time: 2425.2434s
	iters: 400, epoch: 3 | loss: 0.0009203
	speed: 0.0567s/iter; left time: 2270.9914s
Epoch: 3 cost time: 25.007578134536743
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.065 Vali Acc: 0.978 Test Loss: 0.065 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0003747
	speed: 0.1835s/iter; left time: 7332.8765s
	iters: 200, epoch: 4 | loss: 0.1550851
	speed: 0.0612s/iter; left time: 2439.3326s
	iters: 300, epoch: 4 | loss: 0.0874120
	speed: 0.0588s/iter; left time: 2339.7541s
	iters: 400, epoch: 4 | loss: 0.0006495
	speed: 0.0584s/iter; left time: 2314.6229s
Epoch: 4 cost time: 24.81368851661682
Epoch: 4, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0014921
	speed: 0.1840s/iter; left time: 7278.3081s
	iters: 200, epoch: 5 | loss: 0.0009239
	speed: 0.0623s/iter; left time: 2457.4671s
	iters: 300, epoch: 5 | loss: 0.1297889
	speed: 0.0661s/iter; left time: 2600.5095s
	iters: 400, epoch: 5 | loss: 0.0000055
	speed: 0.0569s/iter; left time: 2232.4403s
Epoch: 5 cost time: 25.586721420288086
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.980899).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0018000
	speed: 0.2118s/iter; left time: 8288.7300s
	iters: 200, epoch: 6 | loss: 0.0004136
	speed: 0.0578s/iter; left time: 2255.5159s
	iters: 300, epoch: 6 | loss: 0.4202036
	speed: 0.0638s/iter; left time: 2484.4549s
	iters: 400, epoch: 6 | loss: 0.0000124
	speed: 0.0572s/iter; left time: 2221.5099s
Epoch: 6 cost time: 25.174142122268677
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0010531
	speed: 0.1870s/iter; left time: 7239.6167s
	iters: 200, epoch: 7 | loss: 0.0068669
	speed: 0.0578s/iter; left time: 2232.6661s
	iters: 300, epoch: 7 | loss: 0.0052715
	speed: 0.0616s/iter; left time: 2371.7840s
	iters: 400, epoch: 7 | loss: 0.0002971
	speed: 0.0610s/iter; left time: 2345.5093s
Epoch: 7 cost time: 25.18928289413452
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0172870
	speed: 0.1996s/iter; left time: 7648.1588s
	iters: 200, epoch: 8 | loss: 0.0000050
	speed: 0.0608s/iter; left time: 2324.2279s
	iters: 300, epoch: 8 | loss: 0.0023657
	speed: 0.0627s/iter; left time: 2390.2066s
	iters: 400, epoch: 8 | loss: 0.0000060
	speed: 0.0558s/iter; left time: 2119.3326s
Epoch: 8 cost time: 25.41210126876831
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000005
	speed: 0.2019s/iter; left time: 7653.0630s
	iters: 200, epoch: 9 | loss: 0.0008115
	speed: 0.0597s/iter; left time: 2254.9157s
	iters: 300, epoch: 9 | loss: 0.0000059
	speed: 0.0661s/iter; left time: 2491.4468s
	iters: 400, epoch: 9 | loss: 0.0375827
	speed: 0.0598s/iter; left time: 2246.4934s
Epoch: 9 cost time: 26.115060567855835
Epoch: 9, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.167 Vali Acc: 0.971 Test Loss: 0.167 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0009597
	speed: 0.1892s/iter; left time: 7090.6058s
	iters: 200, epoch: 10 | loss: 0.0015091
	speed: 0.0584s/iter; left time: 2183.3583s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0604s/iter; left time: 2250.6690s
	iters: 400, epoch: 10 | loss: 0.0000006
	speed: 0.0600s/iter; left time: 2231.0056s
Epoch: 10 cost time: 25.05747961997986
Epoch: 10, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1869s/iter; left time: 6927.1430s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0573s/iter; left time: 2119.4983s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 2166.5275s
	iters: 400, epoch: 11 | loss: 0.0000013
	speed: 0.0630s/iter; left time: 2315.5643s
Epoch: 11 cost time: 25.093268871307373
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.982 Test Loss: 0.098 Test Acc: 0.982
Validation loss decreased (-0.980899 --> -0.981809).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2082s/iter; left time: 7630.3667s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0599s/iter; left time: 2188.8805s
	iters: 300, epoch: 12 | loss: 0.0000080
	speed: 0.0628s/iter; left time: 2289.4664s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0625s/iter; left time: 2272.3467s
Epoch: 12 cost time: 25.78174638748169
Epoch: 12, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.982 Test Loss: 0.131 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000639
	speed: 0.1982s/iter; left time: 7183.7282s
	iters: 200, epoch: 13 | loss: 0.0001394
	speed: 0.0580s/iter; left time: 2097.4866s
	iters: 300, epoch: 13 | loss: 0.0000355
	speed: 0.0591s/iter; left time: 2128.7308s
	iters: 400, epoch: 13 | loss: 0.0000021
	speed: 0.0645s/iter; left time: 2317.3695s
Epoch: 13 cost time: 25.605321884155273
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.982 Test Loss: 0.113 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 0.1978s/iter; left time: 7086.6208s
	iters: 200, epoch: 14 | loss: 0.0000151
	speed: 0.0596s/iter; left time: 2128.9130s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0617s/iter; left time: 2197.2976s
	iters: 400, epoch: 14 | loss: 0.0012979
	speed: 0.0599s/iter; left time: 2128.4813s
Epoch: 14 cost time: 25.573042631149292
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.976 Test Loss: 0.192 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000176
	speed: 0.2168s/iter; left time: 7678.5767s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 2060.6430s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 2224.7117s
	iters: 400, epoch: 15 | loss: 0.0000114
	speed: 0.0690s/iter; left time: 2424.1030s
Epoch: 15 cost time: 27.346111059188843
Epoch: 15, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.183 Vali Acc: 0.977 Test Loss: 0.183 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2194s/iter; left time: 7679.4281s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 1905.0815s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 1590.7497s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1473.2750s
Epoch: 16 cost time: 23.049888849258423
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000010
	speed: 0.1656s/iter; left time: 5728.7184s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 2039.5176s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 1876.6741s
	iters: 400, epoch: 17 | loss: 0.0002630
	speed: 0.0552s/iter; left time: 1891.4284s
Epoch: 17 cost time: 23.6957426071167
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.982 Test Loss: 0.155 Test Acc: 0.982
Validation loss decreased (-0.981809 --> -0.982263).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000310
	speed: 0.1864s/iter; left time: 6369.5047s
	iters: 200, epoch: 18 | loss: 0.2099675
	speed: 0.0597s/iter; left time: 2035.3966s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 1972.3277s
	iters: 400, epoch: 18 | loss: 0.3950981
	speed: 0.0565s/iter; left time: 1914.7713s
Epoch: 18 cost time: 24.215298414230347
Epoch: 18, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.197 Vali Acc: 0.977 Test Loss: 0.197 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0214210
	speed: 0.1872s/iter; left time: 6320.5491s
	iters: 200, epoch: 19 | loss: 0.0001179
	speed: 0.0553s/iter; left time: 1862.6126s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 1930.0886s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0502s/iter; left time: 1680.7649s
Epoch: 19 cost time: 23.21959376335144
Epoch: 19, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.210 Vali Acc: 0.978 Test Loss: 0.210 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2023s/iter; left time: 6746.2035s
	iters: 200, epoch: 20 | loss: 0.0000027
	speed: 0.0575s/iter; left time: 1912.9930s
	iters: 300, epoch: 20 | loss: 0.0000135
	speed: 0.0652s/iter; left time: 2160.1050s
	iters: 400, epoch: 20 | loss: 0.0000004
	speed: 0.0643s/iter; left time: 2125.9377s
Epoch: 20 cost time: 26.149943590164185
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.172 Vali Acc: 0.980 Test Loss: 0.172 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1959s/iter; left time: 6452.0504s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0629s/iter; left time: 2064.0821s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0599s/iter; left time: 1961.8676s
	iters: 400, epoch: 21 | loss: 0.0000012
	speed: 0.0651s/iter; left time: 2124.5549s
Epoch: 21 cost time: 26.60434603691101
Epoch: 21, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.136 Vali Acc: 0.985 Test Loss: 0.136 Test Acc: 0.985
Validation loss decreased (-0.982263 --> -0.984537).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1776s/iter; left time: 5777.8894s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 1985.2805s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 1808.3565s
	iters: 400, epoch: 22 | loss: 0.0002620
	speed: 0.0568s/iter; left time: 1831.3574s
Epoch: 22 cost time: 24.56323742866516
Epoch: 22, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.169 Vali Acc: 0.983 Test Loss: 0.169 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000010
	speed: 0.1984s/iter; left time: 6370.9561s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0646s/iter; left time: 2069.7587s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 2036.4240s
	iters: 400, epoch: 23 | loss: 0.0000004
	speed: 0.0584s/iter; left time: 1856.7299s
Epoch: 23 cost time: 25.658198356628418
Epoch: 23, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.193 Vali Acc: 0.981 Test Loss: 0.193 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1833s/iter; left time: 5810.0433s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 1832.1074s
	iters: 300, epoch: 24 | loss: 0.0001098
	speed: 0.0609s/iter; left time: 1918.5928s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0623s/iter; left time: 1956.3584s
Epoch: 24 cost time: 25.108561992645264
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.258 Vali Acc: 0.976 Test Loss: 0.258 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1958s/iter; left time: 6125.7668s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 1832.6499s
	iters: 300, epoch: 25 | loss: 0.0000010
	speed: 0.0581s/iter; left time: 1804.7578s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 1997.6504s
Epoch: 25 cost time: 25.798497915267944
Epoch: 25, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.345 Vali Acc: 0.968 Test Loss: 0.345 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000069
	speed: 0.2116s/iter; left time: 6533.7154s
	iters: 200, epoch: 26 | loss: 0.0000002
	speed: 0.0639s/iter; left time: 1965.9688s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0631s/iter; left time: 1934.8547s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0633s/iter; left time: 1935.4200s
Epoch: 26 cost time: 27.121354818344116
Epoch: 26, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.205 Vali Acc: 0.982 Test Loss: 0.205 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2019s/iter; left time: 6151.8759s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 1986.0464s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 1900.2308s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 1803.1962s
Epoch: 27 cost time: 26.16129207611084
Epoch: 27, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0103891
	speed: 0.1862s/iter; left time: 5596.7873s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 1827.7419s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 1952.2344s
	iters: 400, epoch: 28 | loss: 0.0007725
	speed: 0.0590s/iter; left time: 1755.5791s
Epoch: 28 cost time: 25.611952543258667
Epoch: 28, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.267 Vali Acc: 0.977 Test Loss: 0.267 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1875s/iter; left time: 5555.8416s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 1758.6635s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 1926.8581s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0668s/iter; left time: 1959.7614s
Epoch: 29 cost time: 26.1065194606781
Epoch: 29, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.299 Vali Acc: 0.976 Test Loss: 0.299 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000004
	speed: 0.2158s/iter; left time: 6305.7718s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 1749.9561s
	iters: 300, epoch: 30 | loss: 0.0000084
	speed: 0.0580s/iter; left time: 1684.4659s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 1765.2245s
Epoch: 30 cost time: 26.168888807296753
Epoch: 30, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.164 Vali Acc: 0.980 Test Loss: 0.164 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000018
	speed: 0.1906s/iter; left time: 5491.3165s
	iters: 200, epoch: 31 | loss: 0.2150557
	speed: 0.0645s/iter; left time: 1852.5384s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0590s/iter; left time: 1687.2729s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 1757.0931s
Epoch: 31 cost time: 25.812957048416138
Epoch: 31, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.980 Test Loss: 0.213 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 594322
model size : 7.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1562533
	speed: 0.0807s/iter; left time: 3324.6953s
	iters: 200, epoch: 1 | loss: 0.1257314
	speed: 0.0640s/iter; left time: 2629.4746s
	iters: 300, epoch: 1 | loss: 0.0201178
	speed: 0.0673s/iter; left time: 2760.1181s
	iters: 400, epoch: 1 | loss: 0.0014229
	speed: 0.0651s/iter; left time: 2663.2261s
Epoch: 1 cost time: 28.555890798568726
Epoch: 1, Steps: 413 | Train Loss: 0.321 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (inf --> -0.973169).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0579473
	speed: 0.2054s/iter; left time: 8377.3233s
	iters: 200, epoch: 2 | loss: 0.0481611
	speed: 0.0608s/iter; left time: 2475.1799s
	iters: 300, epoch: 2 | loss: 0.0070698
	speed: 0.0622s/iter; left time: 2525.5894s
	iters: 400, epoch: 2 | loss: 0.0254286
	speed: 0.0596s/iter; left time: 2414.1210s
Epoch: 2 cost time: 25.254964113235474
Epoch: 2, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.973169 --> -0.976807).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0011366
	speed: 0.1842s/iter; left time: 7436.6505s
	iters: 200, epoch: 3 | loss: 0.0357612
	speed: 0.0576s/iter; left time: 2318.3802s
	iters: 300, epoch: 3 | loss: 0.4442651
	speed: 0.0587s/iter; left time: 2357.8670s
	iters: 400, epoch: 3 | loss: 0.0867394
	speed: 0.0659s/iter; left time: 2641.8098s
Epoch: 3 cost time: 25.492775678634644
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000840
	speed: 0.1899s/iter; left time: 7588.9949s
	iters: 200, epoch: 4 | loss: 0.1224412
	speed: 0.0620s/iter; left time: 2469.6543s
	iters: 300, epoch: 4 | loss: 0.0260116
	speed: 0.0602s/iter; left time: 2392.0395s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 2350.0295s
Epoch: 4 cost time: 25.501192092895508
Epoch: 4, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0006661
	speed: 0.1789s/iter; left time: 7076.9372s
	iters: 200, epoch: 5 | loss: 0.0001783
	speed: 0.0663s/iter; left time: 2616.1671s
	iters: 300, epoch: 5 | loss: 0.0022847
	speed: 0.0556s/iter; left time: 2185.9962s
	iters: 400, epoch: 5 | loss: 0.0000006
	speed: 0.0573s/iter; left time: 2249.7774s
Epoch: 5 cost time: 24.441787242889404
Epoch: 5, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
Validation loss decreased (-0.976807 --> -0.981809).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000496
	speed: 0.1850s/iter; left time: 7238.4196s
	iters: 200, epoch: 6 | loss: 0.0024607
	speed: 0.0647s/iter; left time: 2526.9701s
	iters: 300, epoch: 6 | loss: 0.0030192
	speed: 0.0633s/iter; left time: 2465.1237s
	iters: 400, epoch: 6 | loss: 0.0000210
	speed: 0.0601s/iter; left time: 2335.7899s
Epoch: 6 cost time: 25.92053747177124
Epoch: 6, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000093
	speed: 0.1881s/iter; left time: 7283.6740s
	iters: 200, epoch: 7 | loss: 0.0000478
	speed: 0.0656s/iter; left time: 2535.3649s
	iters: 300, epoch: 7 | loss: 0.5944666
	speed: 0.0592s/iter; left time: 2280.0450s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 2367.9886s
Epoch: 7 cost time: 25.880274772644043
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.137 Vali Acc: 0.979 Test Loss: 0.137 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2035s/iter; left time: 7797.3167s
	iters: 200, epoch: 8 | loss: 0.0035796
	speed: 0.0669s/iter; left time: 2554.9875s
	iters: 300, epoch: 8 | loss: 0.1269931
	speed: 0.0634s/iter; left time: 2417.2500s
	iters: 400, epoch: 8 | loss: 0.0000310
	speed: 0.0580s/iter; left time: 2202.8805s
Epoch: 8 cost time: 25.984244108200073
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1851s/iter; left time: 7016.1205s
	iters: 200, epoch: 9 | loss: 0.0000016
	speed: 0.0606s/iter; left time: 2290.7791s
	iters: 300, epoch: 9 | loss: 0.0001284
	speed: 0.0630s/iter; left time: 2375.4969s
	iters: 400, epoch: 9 | loss: 0.0001431
	speed: 0.0576s/iter; left time: 2167.3186s
Epoch: 9 cost time: 25.1266188621521
Epoch: 9, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000584
	speed: 0.1873s/iter; left time: 7022.3838s
	iters: 200, epoch: 10 | loss: 0.0143105
	speed: 0.0584s/iter; left time: 2182.4903s
	iters: 300, epoch: 10 | loss: 0.0002569
	speed: 0.0653s/iter; left time: 2433.5868s
	iters: 400, epoch: 10 | loss: 0.0000010
	speed: 0.0601s/iter; left time: 2232.9028s
Epoch: 10 cost time: 25.088691473007202
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.2034s/iter; left time: 7539.1867s
	iters: 200, epoch: 11 | loss: 0.0000008
	speed: 0.0568s/iter; left time: 2101.1195s
	iters: 300, epoch: 11 | loss: 0.0000006
	speed: 0.0600s/iter; left time: 2213.4539s
	iters: 400, epoch: 11 | loss: 0.0000077
	speed: 0.0644s/iter; left time: 2366.5576s
Epoch: 11 cost time: 25.287410974502563
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.174 Vali Acc: 0.974 Test Loss: 0.174 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000129
	speed: 0.2002s/iter; left time: 7337.8046s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 2184.2902s
	iters: 300, epoch: 12 | loss: 0.0000004
	speed: 0.0623s/iter; left time: 2272.6937s
	iters: 400, epoch: 12 | loss: 0.0000017
	speed: 0.0648s/iter; left time: 2355.8699s
Epoch: 12 cost time: 25.575609922409058
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000058
	speed: 0.1885s/iter; left time: 6832.3148s
	iters: 200, epoch: 13 | loss: 0.0000009
	speed: 0.0599s/iter; left time: 2165.0182s
	iters: 300, epoch: 13 | loss: 0.0533596
	speed: 0.0614s/iter; left time: 2212.3766s
	iters: 400, epoch: 13 | loss: 0.0000005
	speed: 0.0653s/iter; left time: 2346.0578s
Epoch: 13 cost time: 26.328194856643677
Epoch: 13, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.1880s/iter; left time: 6736.6647s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0634s/iter; left time: 2263.8165s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0604s/iter; left time: 2151.9381s
	iters: 400, epoch: 14 | loss: 0.0019451
	speed: 0.0673s/iter; left time: 2390.7122s
Epoch: 14 cost time: 26.895379066467285
Epoch: 14, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.099 Vali Acc: 0.985 Test Loss: 0.099 Test Acc: 0.985
Validation loss decreased (-0.981809 --> -0.985447).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2103s/iter; left time: 7448.5692s
	iters: 200, epoch: 15 | loss: 0.0061928
	speed: 0.0514s/iter; left time: 1816.5758s
	iters: 300, epoch: 15 | loss: 0.0000221
	speed: 0.0484s/iter; left time: 1706.1027s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0494s/iter; left time: 1735.8830s
Epoch: 15 cost time: 22.202152252197266
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.989 Test Loss: 0.114 Test Acc: 0.989
Validation loss decreased (-0.985447 --> -0.988630).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000056
	speed: 0.1847s/iter; left time: 6465.4143s
	iters: 200, epoch: 16 | loss: 0.0000019
	speed: 0.0628s/iter; left time: 2191.1899s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0572s/iter; left time: 1989.3575s
	iters: 400, epoch: 16 | loss: 0.0827715
	speed: 0.0570s/iter; left time: 1977.6506s
Epoch: 16 cost time: 24.702043294906616
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.319 Vali Acc: 0.968 Test Loss: 0.319 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0001843
	speed: 0.1893s/iter; left time: 6547.7022s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0630s/iter; left time: 2172.1249s
	iters: 300, epoch: 17 | loss: 0.0617861
	speed: 0.0612s/iter; left time: 2105.5251s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 1984.7225s
Epoch: 17 cost time: 25.069093465805054
Epoch: 17, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.099 Vali Acc: 0.985 Test Loss: 0.099 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.2014s/iter; left time: 6882.7163s
	iters: 200, epoch: 18 | loss: 0.0023987
	speed: 0.0653s/iter; left time: 2227.0968s
	iters: 300, epoch: 18 | loss: 0.0000003
	speed: 0.0624s/iter; left time: 2120.8523s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 1913.3086s
Epoch: 18 cost time: 25.91786503791809
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.141 Vali Acc: 0.981 Test Loss: 0.141 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000092
	speed: 0.1838s/iter; left time: 6207.4814s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0629s/iter; left time: 2118.6883s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0621s/iter; left time: 2083.2539s
	iters: 400, epoch: 19 | loss: 0.0000166
	speed: 0.0611s/iter; left time: 2044.6593s
Epoch: 19 cost time: 25.522990942001343
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.214 Vali Acc: 0.979 Test Loss: 0.214 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000013
	speed: 0.1844s/iter; left time: 6149.2508s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 2073.6441s
	iters: 300, epoch: 20 | loss: 0.0000013
	speed: 0.0586s/iter; left time: 1943.5857s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 1884.0316s
Epoch: 20 cost time: 24.9140043258667
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.985 Test Loss: 0.094 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2028s/iter; left time: 6680.7065s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 1954.1866s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 2088.2373s
	iters: 400, epoch: 21 | loss: 0.0000046
	speed: 0.0577s/iter; left time: 1883.9445s
Epoch: 21 cost time: 24.972788095474243
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.985 Test Loss: 0.111 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000002
	speed: 0.2009s/iter; left time: 6534.1407s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0571s/iter; left time: 1850.9154s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 2063.3506s
	iters: 400, epoch: 22 | loss: 0.0060024
	speed: 0.0565s/iter; left time: 1822.3717s
Epoch: 22 cost time: 24.532532215118408
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.397 Vali Acc: 0.975 Test Loss: 0.397 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1837s/iter; left time: 5899.1156s
	iters: 200, epoch: 23 | loss: 0.0000011
	speed: 0.0568s/iter; left time: 1818.0438s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0604s/iter; left time: 1928.0629s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 1893.4278s
Epoch: 23 cost time: 24.66070580482483
Epoch: 23, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.215 Vali Acc: 0.983 Test Loss: 0.215 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000136
	speed: 0.1886s/iter; left time: 5980.3613s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0631s/iter; left time: 1994.4630s
	iters: 300, epoch: 24 | loss: 0.4074474
	speed: 0.0641s/iter; left time: 2018.2816s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 1933.0938s
Epoch: 24 cost time: 26.297072887420654
Epoch: 24, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.309 Vali Acc: 0.975 Test Loss: 0.309 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0028464
	speed: 0.2022s/iter; left time: 6326.8665s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 1845.8211s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.0594s/iter; left time: 1847.7370s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0563s/iter; left time: 1745.4423s
Epoch: 25 cost time: 24.87983274459839
Epoch: 25, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.985 Test Loss: 0.132 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 594322
model size : 7.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1961980
	speed: 0.0787s/iter; left time: 3242.0120s
	iters: 200, epoch: 1 | loss: 0.1308348
	speed: 0.0546s/iter; left time: 2242.7984s
	iters: 300, epoch: 1 | loss: 0.0195211
	speed: 0.0546s/iter; left time: 2238.7792s
	iters: 400, epoch: 1 | loss: 0.0015488
	speed: 0.0591s/iter; left time: 2416.7586s
Epoch: 1 cost time: 25.633402347564697
Epoch: 1, Steps: 413 | Train Loss: 0.322 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
Validation loss decreased (inf --> -0.976807).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0466124
	speed: 0.2079s/iter; left time: 8481.2245s
	iters: 200, epoch: 2 | loss: 0.0009675
	speed: 0.0568s/iter; left time: 2312.9720s
	iters: 300, epoch: 2 | loss: 0.0105680
	speed: 0.0569s/iter; left time: 2308.3824s
	iters: 400, epoch: 2 | loss: 0.0000706
	speed: 0.0565s/iter; left time: 2288.3728s
Epoch: 2 cost time: 24.313520193099976
Epoch: 2, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.136 Vali Acc: 0.961 Test Loss: 0.136 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0294606
	speed: 0.1880s/iter; left time: 7589.6091s
	iters: 200, epoch: 3 | loss: 0.0202311
	speed: 0.0604s/iter; left time: 2433.1610s
	iters: 300, epoch: 3 | loss: 0.2881845
	speed: 0.0555s/iter; left time: 2227.9443s
	iters: 400, epoch: 3 | loss: 0.0010032
	speed: 0.0548s/iter; left time: 2194.5377s
Epoch: 3 cost time: 23.70386576652527
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0026084
	speed: 0.1816s/iter; left time: 7257.7365s
	iters: 200, epoch: 4 | loss: 0.0019876
	speed: 0.0608s/iter; left time: 2422.0680s
	iters: 300, epoch: 4 | loss: 0.1168936
	speed: 0.0551s/iter; left time: 2192.7668s
	iters: 400, epoch: 4 | loss: 0.0000318
	speed: 0.0544s/iter; left time: 2159.3192s
Epoch: 4 cost time: 23.608506202697754
Epoch: 4, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.976807 --> -0.979080).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000981
	speed: 0.1851s/iter; left time: 7322.1286s
	iters: 200, epoch: 5 | loss: 0.0194165
	speed: 0.0605s/iter; left time: 2385.1255s
	iters: 300, epoch: 5 | loss: 0.2714950
	speed: 0.0618s/iter; left time: 2432.2891s
	iters: 400, epoch: 5 | loss: 0.0103151
	speed: 0.0558s/iter; left time: 2189.1552s
Epoch: 5 cost time: 24.886878967285156
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979080 --> -0.979535).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0017444
	speed: 0.1904s/iter; left time: 7452.0640s
	iters: 200, epoch: 6 | loss: 0.0026182
	speed: 0.0547s/iter; left time: 2136.8284s
	iters: 300, epoch: 6 | loss: 0.0002295
	speed: 0.0621s/iter; left time: 2419.7242s
	iters: 400, epoch: 6 | loss: 0.0000087
	speed: 0.0558s/iter; left time: 2166.8528s
Epoch: 6 cost time: 23.79079794883728
Epoch: 6, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1828s/iter; left time: 7077.3722s
	iters: 200, epoch: 7 | loss: 0.0000142
	speed: 0.0552s/iter; left time: 2133.6859s
	iters: 300, epoch: 7 | loss: 0.0000015
	speed: 0.0574s/iter; left time: 2212.2221s
	iters: 400, epoch: 7 | loss: 0.0000666
	speed: 0.0571s/iter; left time: 2192.2966s
Epoch: 7 cost time: 23.863191604614258
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0006035
	speed: 0.1773s/iter; left time: 6793.8892s
	iters: 200, epoch: 8 | loss: 0.0002096
	speed: 0.0557s/iter; left time: 2127.0706s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0563s/iter; left time: 2146.1894s
	iters: 400, epoch: 8 | loss: 0.0000283
	speed: 0.0635s/iter; left time: 2413.2581s
Epoch: 8 cost time: 24.42155694961548
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.110 Vali Acc: 0.982 Test Loss: 0.110 Test Acc: 0.982
Validation loss decreased (-0.979535 --> -0.982264).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000102
	speed: 0.2069s/iter; left time: 7841.1398s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0577s/iter; left time: 2181.8967s
	iters: 300, epoch: 9 | loss: 0.0000627
	speed: 0.0553s/iter; left time: 2086.2597s
	iters: 400, epoch: 9 | loss: 0.0000890
	speed: 0.0560s/iter; left time: 2106.6578s
Epoch: 9 cost time: 24.381417512893677
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.136 Vali Acc: 0.979 Test Loss: 0.136 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000045
	speed: 0.1791s/iter; left time: 6715.1008s
	iters: 200, epoch: 10 | loss: 0.0055040
	speed: 0.0553s/iter; left time: 2067.6402s
	iters: 300, epoch: 10 | loss: 0.0000012
	speed: 0.0498s/iter; left time: 1855.2736s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 1891.8458s
Epoch: 10 cost time: 22.021416664123535
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000003
	speed: 0.1791s/iter; left time: 6638.8537s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 2254.5835s
	iters: 300, epoch: 11 | loss: 0.0000079
	speed: 0.0556s/iter; left time: 2050.8185s
	iters: 400, epoch: 11 | loss: 0.0000009
	speed: 0.0603s/iter; left time: 2215.7670s
Epoch: 11 cost time: 24.62657856941223
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000067
	speed: 0.1925s/iter; left time: 7055.1604s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0586s/iter; left time: 2141.9465s
	iters: 300, epoch: 12 | loss: 0.0000018
	speed: 0.0639s/iter; left time: 2330.2267s
	iters: 400, epoch: 12 | loss: 0.0000133
	speed: 0.0588s/iter; left time: 2138.5061s
Epoch: 12 cost time: 24.738537788391113
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000035
	speed: 0.1806s/iter; left time: 6545.2448s
	iters: 200, epoch: 13 | loss: 0.6235259
	speed: 0.0562s/iter; left time: 2029.6125s
	iters: 300, epoch: 13 | loss: 0.0001500
	speed: 0.0592s/iter; left time: 2132.5206s
	iters: 400, epoch: 13 | loss: 0.9067577
	speed: 0.0544s/iter; left time: 1953.7059s
Epoch: 13 cost time: 23.471088409423828
Epoch: 13, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.099 Vali Acc: 0.984 Test Loss: 0.099 Test Acc: 0.984
Validation loss decreased (-0.982264 --> -0.983628).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1779s/iter; left time: 6372.9669s
	iters: 200, epoch: 14 | loss: 0.0000022
	speed: 0.0537s/iter; left time: 1919.8753s
	iters: 300, epoch: 14 | loss: 0.0000064
	speed: 0.0567s/iter; left time: 2019.1186s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 2021.1516s
Epoch: 14 cost time: 23.323004007339478
Epoch: 14, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
Validation loss decreased (-0.983628 --> -0.984083).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000042
	speed: 0.1974s/iter; left time: 6991.7190s
	iters: 200, epoch: 15 | loss: 0.0000151
	speed: 0.0571s/iter; left time: 2015.7784s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 1899.5402s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0596s/iter; left time: 2091.9075s
Epoch: 15 cost time: 24.08716344833374
Epoch: 15, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0005312
	speed: 0.1959s/iter; left time: 6858.5196s
	iters: 200, epoch: 16 | loss: 0.0000414
	speed: 0.0560s/iter; left time: 1954.9158s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 2018.6506s
	iters: 400, epoch: 16 | loss: 0.4080442
	speed: 0.0627s/iter; left time: 2175.8615s
Epoch: 16 cost time: 24.753439903259277
Epoch: 16, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.151 Vali Acc: 0.987 Test Loss: 0.151 Test Acc: 0.987
Validation loss decreased (-0.984083 --> -0.986811).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.1877s/iter; left time: 6494.5987s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 2038.5997s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 2006.0743s
	iters: 400, epoch: 17 | loss: 0.0003730
	speed: 0.0620s/iter; left time: 2125.6186s
Epoch: 17 cost time: 25.329351902008057
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.069 Vali Acc: 0.988 Test Loss: 0.069 Test Acc: 0.988
Validation loss decreased (-0.986811 --> -0.988176).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0005959
	speed: 0.1802s/iter; left time: 6159.3007s
	iters: 200, epoch: 18 | loss: 0.0000005
	speed: 0.0588s/iter; left time: 2004.3135s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 2028.7613s
	iters: 400, epoch: 18 | loss: 0.0000005
	speed: 0.0627s/iter; left time: 2125.6419s
Epoch: 18 cost time: 25.207428455352783
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.224 Vali Acc: 0.981 Test Loss: 0.224 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2033s/iter; left time: 6865.8149s
	iters: 200, epoch: 19 | loss: 0.0000002
	speed: 0.0609s/iter; left time: 2050.1399s
	iters: 300, epoch: 19 | loss: 0.0000003
	speed: 0.0494s/iter; left time: 1658.8769s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 2291.5486s
Epoch: 19 cost time: 25.625198364257812
Epoch: 19, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.3284129
	speed: 0.1829s/iter; left time: 6101.9827s
	iters: 200, epoch: 20 | loss: 0.0000007
	speed: 0.0436s/iter; left time: 1448.6934s
	iters: 300, epoch: 20 | loss: 0.0126576
	speed: 0.0435s/iter; left time: 1441.8992s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 1526.8414s
Epoch: 20 cost time: 19.164202451705933
Epoch: 20, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.989 Test Loss: 0.071 Test Acc: 0.989
Validation loss decreased (-0.988176 --> -0.988630).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000202
	speed: 0.1843s/iter; left time: 6072.2229s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 1909.0056s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 1858.3335s
	iters: 400, epoch: 21 | loss: 0.0000015
	speed: 0.0560s/iter; left time: 1827.1330s
Epoch: 21 cost time: 23.860196113586426
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.982 Test Loss: 0.201 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1815s/iter; left time: 5903.6828s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 1919.5528s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0603s/iter; left time: 1950.5545s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 1883.2242s
Epoch: 22 cost time: 24.859975576400757
Epoch: 22, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.179 Vali Acc: 0.984 Test Loss: 0.179 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2009s/iter; left time: 6452.2906s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 1974.5615s
	iters: 300, epoch: 23 | loss: 0.0000082
	speed: 0.0628s/iter; left time: 2004.7941s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 1884.1939s
Epoch: 23 cost time: 25.387203454971313
Epoch: 23, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.197 Vali Acc: 0.980 Test Loss: 0.197 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1795s/iter; left time: 5689.0247s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 1740.2354s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 1883.5112s
	iters: 400, epoch: 24 | loss: 0.0514481
	speed: 0.0572s/iter; left time: 1796.1576s
Epoch: 24 cost time: 23.991393566131592
Epoch: 24, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.195 Vali Acc: 0.980 Test Loss: 0.195 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0002753
	speed: 0.1728s/iter; left time: 5405.6956s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 1522.1258s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 1756.2132s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 1731.8877s
Epoch: 25 cost time: 22.540085315704346
Epoch: 25, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.170 Vali Acc: 0.983 Test Loss: 0.170 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1968s/iter; left time: 6077.6109s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 1655.7022s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0557s/iter; left time: 1708.8109s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 1754.6526s
Epoch: 26 cost time: 23.86339235305786
Epoch: 26, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0068774
	speed: 0.1930s/iter; left time: 5878.7167s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 1737.6231s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0558s/iter; left time: 1689.9746s
	iters: 400, epoch: 27 | loss: 0.0000002
	speed: 0.0593s/iter; left time: 1789.2602s
Epoch: 27 cost time: 24.193034172058105
Epoch: 27, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.249 Vali Acc: 0.981 Test Loss: 0.249 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0012657
	speed: 0.1826s/iter; left time: 5486.2742s
	iters: 200, epoch: 28 | loss: 0.0000020
	speed: 0.0583s/iter; left time: 1746.2745s
	iters: 300, epoch: 28 | loss: 0.0000001
	speed: 0.0586s/iter; left time: 1750.2946s
	iters: 400, epoch: 28 | loss: 0.0007387
	speed: 0.0595s/iter; left time: 1769.4232s
Epoch: 28 cost time: 24.67248010635376
Epoch: 28, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.344 Vali Acc: 0.976 Test Loss: 0.344 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1853s/iter; left time: 5491.5151s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 1751.4918s
	iters: 300, epoch: 29 | loss: 0.0000001
	speed: 0.0586s/iter; left time: 1726.0058s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0637s/iter; left time: 1870.1812s
Epoch: 29 cost time: 25.6106014251709
Epoch: 29, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.173 Vali Acc: 0.982 Test Loss: 0.173 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1978s/iter; left time: 5781.9332s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 1634.8458s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 1614.4343s
	iters: 400, epoch: 30 | loss: 0.0000002
	speed: 0.0573s/iter; left time: 1656.9922s
Epoch: 30 cost time: 23.830471515655518
Epoch: 30, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.233 Vali Acc: 0.982 Test Loss: 0.233 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 594322
model size : 7.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1932824
	speed: 0.0732s/iter; left time: 3014.8266s
	iters: 200, epoch: 1 | loss: 0.1226770
	speed: 0.0543s/iter; left time: 2230.0481s
	iters: 300, epoch: 1 | loss: 0.0377840
	speed: 0.0543s/iter; left time: 2228.0665s
	iters: 400, epoch: 1 | loss: 0.0024209
	speed: 0.0550s/iter; left time: 2249.8532s
Epoch: 1 cost time: 24.476886510849
Epoch: 1, Steps: 413 | Train Loss: 0.348 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
Validation loss decreased (inf --> -0.982719).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0360191
	speed: 0.1968s/iter; left time: 8028.2055s
	iters: 200, epoch: 2 | loss: 0.0129319
	speed: 0.0544s/iter; left time: 2211.5379s
	iters: 300, epoch: 2 | loss: 0.0598107
	speed: 0.0567s/iter; left time: 2299.4386s
	iters: 400, epoch: 2 | loss: 0.0001183
	speed: 0.0601s/iter; left time: 2433.1705s
Epoch: 2 cost time: 24.138635635375977
Epoch: 2, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.058 Vali Acc: 0.980 Test Loss: 0.058 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3598037
	speed: 0.1873s/iter; left time: 7563.6156s
	iters: 200, epoch: 3 | loss: 0.0178493
	speed: 0.0570s/iter; left time: 2294.6925s
	iters: 300, epoch: 3 | loss: 0.3691614
	speed: 0.0556s/iter; left time: 2231.8894s
	iters: 400, epoch: 3 | loss: 0.0228766
	speed: 0.0573s/iter; left time: 2294.3382s
Epoch: 3 cost time: 24.01109528541565
Epoch: 3, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.982719 --> -0.984538).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000549
	speed: 0.1798s/iter; left time: 7183.6665s
	iters: 200, epoch: 4 | loss: 0.0339872
	speed: 0.0572s/iter; left time: 2278.6382s
	iters: 300, epoch: 4 | loss: 0.6216568
	speed: 0.0556s/iter; left time: 2211.6637s
	iters: 400, epoch: 4 | loss: 0.0003954
	speed: 0.0579s/iter; left time: 2297.3202s
Epoch: 4 cost time: 24.146901845932007
Epoch: 4, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0005079
	speed: 0.1889s/iter; left time: 7471.9823s
	iters: 200, epoch: 5 | loss: 0.0053058
	speed: 0.0622s/iter; left time: 2452.7434s
	iters: 300, epoch: 5 | loss: 0.0024854
	speed: 0.0533s/iter; left time: 2098.6626s
	iters: 400, epoch: 5 | loss: 0.0008251
	speed: 0.0574s/iter; left time: 2252.4177s
Epoch: 5 cost time: 24.82770347595215
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000602
	speed: 0.1843s/iter; left time: 7212.3637s
	iters: 200, epoch: 6 | loss: 0.0006336
	speed: 0.0549s/iter; left time: 2141.5102s
	iters: 300, epoch: 6 | loss: 0.0009413
	speed: 0.0541s/iter; left time: 2108.1901s
	iters: 400, epoch: 6 | loss: 0.0000378
	speed: 0.0549s/iter; left time: 2132.6182s
Epoch: 6 cost time: 22.613654136657715
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000460
	speed: 0.1759s/iter; left time: 6809.7247s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0561s/iter; left time: 2164.9096s
	iters: 300, epoch: 7 | loss: 0.1174725
	speed: 0.0556s/iter; left time: 2143.2061s
	iters: 400, epoch: 7 | loss: 0.0002990
	speed: 0.0538s/iter; left time: 2067.2163s
Epoch: 7 cost time: 23.143287181854248
Epoch: 7, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0004277
	speed: 0.1734s/iter; left time: 6641.1142s
	iters: 200, epoch: 8 | loss: 0.0000022
	speed: 0.0588s/iter; left time: 2247.1828s
	iters: 300, epoch: 8 | loss: 0.0571667
	speed: 0.0561s/iter; left time: 2136.0778s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 2075.8502s
Epoch: 8 cost time: 23.456353187561035
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.165 Vali Acc: 0.976 Test Loss: 0.165 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0024877
	speed: 0.1974s/iter; left time: 7479.0799s
	iters: 200, epoch: 9 | loss: 0.0001135
	speed: 0.0605s/iter; left time: 2288.3515s
	iters: 300, epoch: 9 | loss: 0.0000018
	speed: 0.0556s/iter; left time: 2097.4056s
	iters: 400, epoch: 9 | loss: 0.0000008
	speed: 0.0559s/iter; left time: 2102.4124s
Epoch: 9 cost time: 24.232006072998047
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.139 Vali Acc: 0.984 Test Loss: 0.139 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000172
	speed: 0.1733s/iter; left time: 6494.9879s
	iters: 200, epoch: 10 | loss: 0.0000111
	speed: 0.0578s/iter; left time: 2162.1221s
	iters: 300, epoch: 10 | loss: 0.2495330
	speed: 0.0568s/iter; left time: 2119.5036s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 2112.0485s
Epoch: 10 cost time: 23.807111501693726
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.093 Vali Acc: 0.984 Test Loss: 0.093 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000004
	speed: 0.1737s/iter; left time: 6439.3839s
	iters: 200, epoch: 11 | loss: 0.0000009
	speed: 0.0568s/iter; left time: 2098.6974s
	iters: 300, epoch: 11 | loss: 0.0002138
	speed: 0.0529s/iter; left time: 1951.0165s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 1922.1582s
Epoch: 11 cost time: 22.91723370552063
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.301 Vali Acc: 0.971 Test Loss: 0.301 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000011
	speed: 0.1867s/iter; left time: 6842.4507s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0556s/iter; left time: 2033.7039s
	iters: 300, epoch: 12 | loss: 0.1436131
	speed: 0.0619s/iter; left time: 2256.7572s
	iters: 400, epoch: 12 | loss: 0.0007919
	speed: 0.0555s/iter; left time: 2017.0868s
Epoch: 12 cost time: 23.713515996932983
Epoch: 12, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0999799
	speed: 0.1752s/iter; left time: 6351.0365s
	iters: 200, epoch: 13 | loss: 0.0000002
	speed: 0.0536s/iter; left time: 1937.5173s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.0579s/iter; left time: 2086.6114s
	iters: 400, epoch: 13 | loss: 0.0001547
	speed: 0.0544s/iter; left time: 1955.6545s
Epoch: 13 cost time: 23.061887741088867
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.084 Vali Acc: 0.988 Test Loss: 0.084 Test Acc: 0.988
Validation loss decreased (-0.984538 --> -0.987721).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1748s/iter; left time: 6264.6544s
	iters: 200, epoch: 14 | loss: 0.0000003
	speed: 0.0519s/iter; left time: 1854.5080s
	iters: 300, epoch: 14 | loss: 0.0000002
	speed: 0.0546s/iter; left time: 1947.2029s
	iters: 400, epoch: 14 | loss: 0.0001617
	speed: 0.0538s/iter; left time: 1912.9830s
Epoch: 14 cost time: 22.495718717575073
Epoch: 14, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.274 Vali Acc: 0.977 Test Loss: 0.274 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.1999s/iter; left time: 7079.7359s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0547s/iter; left time: 1933.5170s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 2135.6282s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 2089.1697s
Epoch: 15 cost time: 24.306976556777954
Epoch: 15, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.288 Vali Acc: 0.975 Test Loss: 0.288 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1901s/iter; left time: 6654.4180s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 1951.0612s
	iters: 300, epoch: 16 | loss: 0.0215727
	speed: 0.0560s/iter; left time: 1948.6880s
	iters: 400, epoch: 16 | loss: 0.0000108
	speed: 0.0491s/iter; left time: 1704.2439s
Epoch: 16 cost time: 22.817604780197144
Epoch: 16, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.982 Test Loss: 0.208 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000054
	speed: 0.1608s/iter; left time: 5561.9086s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 1963.5188s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.0566s/iter; left time: 1947.0004s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0553s/iter; left time: 1895.8043s
Epoch: 17 cost time: 23.714290857315063
Epoch: 17, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.291 Vali Acc: 0.976 Test Loss: 0.291 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.1789s/iter; left time: 6115.2832s
	iters: 200, epoch: 18 | loss: 0.0000244
	speed: 0.0567s/iter; left time: 1932.2608s
	iters: 300, epoch: 18 | loss: 0.0000026
	speed: 0.0541s/iter; left time: 1839.9007s
	iters: 400, epoch: 18 | loss: 0.0000023
	speed: 0.0567s/iter; left time: 1919.3873s
Epoch: 18 cost time: 23.858935356140137
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.183 Vali Acc: 0.980 Test Loss: 0.183 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000009
	speed: 0.1935s/iter; left time: 6533.6924s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1753.3351s
	iters: 300, epoch: 19 | loss: 0.0000092
	speed: 0.0533s/iter; left time: 1787.7598s
	iters: 400, epoch: 19 | loss: 0.0000003
	speed: 0.0563s/iter; left time: 1885.2427s
Epoch: 19 cost time: 23.16263699531555
Epoch: 19, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.309 Vali Acc: 0.975 Test Loss: 0.309 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000114
	speed: 0.1816s/iter; left time: 6057.4123s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0543s/iter; left time: 1804.7716s
	iters: 300, epoch: 20 | loss: 0.0000001
	speed: 0.0533s/iter; left time: 1766.1313s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0557s/iter; left time: 1840.2058s
Epoch: 20 cost time: 23.053980588912964
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1998s/iter; left time: 6582.0589s
	iters: 200, epoch: 21 | loss: 0.0000009
	speed: 0.0732s/iter; left time: 2404.8441s
	iters: 300, epoch: 21 | loss: 1.3024342
	speed: 0.0737s/iter; left time: 2413.1145s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.0704s/iter; left time: 2297.9349s
Epoch: 21 cost time: 30.09393548965454
Epoch: 21, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.190 Vali Acc: 0.980 Test Loss: 0.190 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1969s/iter; left time: 6405.4661s
	iters: 200, epoch: 22 | loss: 0.0001862
	speed: 0.0616s/iter; left time: 1996.0637s
	iters: 300, epoch: 22 | loss: 0.0007504
	speed: 0.0536s/iter; left time: 1731.8728s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 1779.8395s
Epoch: 22 cost time: 24.283979892730713
Epoch: 22, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.367 Vali Acc: 0.977 Test Loss: 0.367 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0069425
	speed: 0.1730s/iter; left time: 5556.2570s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 1838.3032s
	iters: 300, epoch: 23 | loss: 0.0054932
	speed: 0.0535s/iter; left time: 1706.7940s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 1731.5596s
Epoch: 23 cost time: 22.96741485595703
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.218 Vali Acc: 0.985 Test Loss: 0.218 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 594322
model size : 7.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5780135
	speed: 0.0729s/iter; left time: 3003.7216s
	iters: 200, epoch: 1 | loss: 0.1265673
	speed: 0.0571s/iter; left time: 2346.0976s
	iters: 300, epoch: 1 | loss: 0.0106792
	speed: 0.0554s/iter; left time: 2272.9164s
	iters: 400, epoch: 1 | loss: 0.0384097
	speed: 0.0550s/iter; left time: 2247.9548s
Epoch: 1 cost time: 24.787837743759155
Epoch: 1, Steps: 413 | Train Loss: 0.398 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
Validation loss decreased (inf --> -0.975443).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0722509
	speed: 0.1803s/iter; left time: 7355.9242s
	iters: 200, epoch: 2 | loss: 0.0149298
	speed: 0.0521s/iter; left time: 2121.3239s
	iters: 300, epoch: 2 | loss: 0.0815467
	speed: 0.0566s/iter; left time: 2296.7225s
	iters: 400, epoch: 2 | loss: 0.0052888
	speed: 0.0539s/iter; left time: 2183.8302s
Epoch: 2 cost time: 22.5123610496521
Epoch: 2, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0073764
	speed: 0.1680s/iter; left time: 6784.8637s
	iters: 200, epoch: 3 | loss: 0.0002524
	speed: 0.0532s/iter; left time: 2142.4775s
	iters: 300, epoch: 3 | loss: 0.0013785
	speed: 0.0560s/iter; left time: 2248.6301s
	iters: 400, epoch: 3 | loss: 0.0224902
	speed: 0.0559s/iter; left time: 2238.4050s
Epoch: 3 cost time: 23.06607222557068
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0010882
	speed: 0.1743s/iter; left time: 6966.3420s
	iters: 200, epoch: 4 | loss: 0.0070102
	speed: 0.0549s/iter; left time: 2189.7230s
	iters: 300, epoch: 4 | loss: 0.0004074
	speed: 0.0575s/iter; left time: 2287.4226s
	iters: 400, epoch: 4 | loss: 0.0010365
	speed: 0.0591s/iter; left time: 2345.0954s
Epoch: 4 cost time: 23.763408422470093
Epoch: 4, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975443 --> -0.976352).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0025868
	speed: 0.1823s/iter; left time: 7209.1840s
	iters: 200, epoch: 5 | loss: 0.0020571
	speed: 0.0583s/iter; left time: 2299.1995s
	iters: 300, epoch: 5 | loss: 0.0018273
	speed: 0.0518s/iter; left time: 2037.4817s
	iters: 400, epoch: 5 | loss: 0.0011222
	speed: 0.0565s/iter; left time: 2217.0493s
Epoch: 5 cost time: 23.740696907043457
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0008316
	speed: 0.1729s/iter; left time: 6767.7358s
	iters: 200, epoch: 6 | loss: 0.0004857
	speed: 0.0593s/iter; left time: 2316.1254s
	iters: 300, epoch: 6 | loss: 0.0004272
	speed: 0.0535s/iter; left time: 2082.0138s
	iters: 400, epoch: 6 | loss: 0.0886414
	speed: 0.0530s/iter; left time: 2057.5221s
Epoch: 6 cost time: 23.184675693511963
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.977261).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0665297
	speed: 0.1665s/iter; left time: 6446.5621s
	iters: 200, epoch: 7 | loss: 0.0095607
	speed: 0.0543s/iter; left time: 2095.5407s
	iters: 300, epoch: 7 | loss: 0.0014216
	speed: 0.0506s/iter; left time: 1950.8919s
	iters: 400, epoch: 7 | loss: 0.0006767
	speed: 0.0534s/iter; left time: 2053.2220s
Epoch: 7 cost time: 22.02449655532837
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.977261 --> -0.979990).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000003
	speed: 0.1816s/iter; left time: 6958.8503s
	iters: 200, epoch: 8 | loss: 0.0000002
	speed: 0.0542s/iter; left time: 2070.2763s
	iters: 300, epoch: 8 | loss: 0.0008517
	speed: 0.0570s/iter; left time: 2172.1143s
	iters: 400, epoch: 8 | loss: 0.0000229
	speed: 0.0494s/iter; left time: 1876.8943s
Epoch: 8 cost time: 22.31345796585083
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.154 Vali Acc: 0.978 Test Loss: 0.154 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0051090
	speed: 0.1697s/iter; left time: 6432.6757s
	iters: 200, epoch: 9 | loss: 0.1130221
	speed: 0.0536s/iter; left time: 2026.0206s
	iters: 300, epoch: 9 | loss: 0.0031734
	speed: 0.0535s/iter; left time: 2017.1093s
	iters: 400, epoch: 9 | loss: 0.0004133
	speed: 0.0532s/iter; left time: 2000.9289s
Epoch: 9 cost time: 22.585967302322388
Epoch: 9, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.979990 --> -0.983173).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0011401
	speed: 0.1699s/iter; left time: 6366.8837s
	iters: 200, epoch: 10 | loss: 0.0002379
	speed: 0.0549s/iter; left time: 2053.6521s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 2204.9140s
	iters: 400, epoch: 10 | loss: 0.1046120
	speed: 0.0571s/iter; left time: 2125.0222s
Epoch: 10 cost time: 23.597288846969604
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.122 Vali Acc: 0.982 Test Loss: 0.122 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000130
	speed: 0.1979s/iter; left time: 7335.8843s
	iters: 200, epoch: 11 | loss: 0.0001965
	speed: 0.0538s/iter; left time: 1988.4847s
	iters: 300, epoch: 11 | loss: 0.0036038
	speed: 0.0541s/iter; left time: 1993.3464s
	iters: 400, epoch: 11 | loss: 0.0000058
	speed: 0.0520s/iter; left time: 1913.6199s
Epoch: 11 cost time: 22.619894981384277
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000047
	speed: 0.1890s/iter; left time: 6926.8009s
	iters: 200, epoch: 12 | loss: 0.0854209
	speed: 0.0551s/iter; left time: 2014.4048s
	iters: 300, epoch: 12 | loss: 0.0549882
	speed: 0.0581s/iter; left time: 2119.2680s
	iters: 400, epoch: 12 | loss: 0.8745719
	speed: 0.0565s/iter; left time: 2053.9478s
Epoch: 12 cost time: 23.758856058120728
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000051
	speed: 0.1790s/iter; left time: 6488.6654s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 2104.9772s
	iters: 300, epoch: 13 | loss: 0.0000036
	speed: 0.0579s/iter; left time: 2087.4238s
	iters: 400, epoch: 13 | loss: 0.0000024
	speed: 0.0570s/iter; left time: 2048.8826s
Epoch: 13 cost time: 24.095452785491943
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.141 Vali Acc: 0.979 Test Loss: 0.141 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000058
	speed: 0.1817s/iter; left time: 6511.4934s
	iters: 200, epoch: 14 | loss: 0.0116911
	speed: 0.0589s/iter; left time: 2106.0668s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 1990.9882s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0554s/iter; left time: 1969.4448s
Epoch: 14 cost time: 23.98132014274597
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000844
	speed: 0.2068s/iter; left time: 7323.8829s
	iters: 200, epoch: 15 | loss: 0.0001182
	speed: 0.0562s/iter; left time: 1983.5647s
	iters: 300, epoch: 15 | loss: 0.1839610
	speed: 0.0561s/iter; left time: 1975.3735s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 1889.9510s
Epoch: 15 cost time: 23.560328006744385
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000008
	speed: 0.1729s/iter; left time: 6050.8946s
	iters: 200, epoch: 16 | loss: 0.0000010
	speed: 0.0572s/iter; left time: 1996.4175s
	iters: 300, epoch: 16 | loss: 0.0000252
	speed: 0.0552s/iter; left time: 1920.6254s
	iters: 400, epoch: 16 | loss: 0.0000575
	speed: 0.0576s/iter; left time: 1998.5440s
Epoch: 16 cost time: 23.737119674682617
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.982 Test Loss: 0.107 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1790s/iter; left time: 6193.3982s
	iters: 200, epoch: 17 | loss: 0.0023489
	speed: 0.0589s/iter; left time: 2032.6248s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0567s/iter; left time: 1951.2746s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0586s/iter; left time: 2008.8158s
Epoch: 17 cost time: 24.262535572052002
Epoch: 17, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000024
	speed: 0.2022s/iter; left time: 6911.8767s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 1991.1628s
	iters: 300, epoch: 18 | loss: 0.0000011
	speed: 0.0557s/iter; left time: 1892.1946s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 2001.7955s
Epoch: 18 cost time: 24.735811471939087
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.163 Vali Acc: 0.978 Test Loss: 0.163 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1858s/iter; left time: 6272.7338s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 1948.7162s
	iters: 300, epoch: 19 | loss: 0.0009166
	speed: 0.0589s/iter; left time: 1975.8084s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0588s/iter; left time: 1969.5090s
Epoch: 19 cost time: 24.767592191696167
Epoch: 19, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.250 Vali Acc: 0.969 Test Loss: 0.250 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 1247506
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5780309
	speed: 0.0739s/iter; left time: 3046.6998s
	iters: 200, epoch: 1 | loss: 0.1266137
	speed: 0.0542s/iter; left time: 2225.9638s
	iters: 300, epoch: 1 | loss: 0.0094810
	speed: 0.0543s/iter; left time: 2225.9077s
	iters: 400, epoch: 1 | loss: 0.0310620
	speed: 0.0554s/iter; left time: 2264.0552s
Epoch: 1 cost time: 24.642165422439575
Epoch: 1, Steps: 413 | Train Loss: 0.394 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (inf --> -0.972714).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0184968
	speed: 0.1891s/iter; left time: 7712.1936s
	iters: 200, epoch: 2 | loss: 0.0236044
	speed: 0.0531s/iter; left time: 2158.5152s
	iters: 300, epoch: 2 | loss: 0.4737276
	speed: 0.0555s/iter; left time: 2252.1492s
	iters: 400, epoch: 2 | loss: 0.0781396
	speed: 0.0524s/iter; left time: 2120.0403s
Epoch: 2 cost time: 22.32055115699768
Epoch: 2, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.972714 --> -0.977716).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0008718
	speed: 0.1691s/iter; left time: 6827.0832s
	iters: 200, epoch: 3 | loss: 0.0000563
	speed: 0.0543s/iter; left time: 2187.7742s
	iters: 300, epoch: 3 | loss: 0.0001760
	speed: 0.0563s/iter; left time: 2263.6882s
	iters: 400, epoch: 3 | loss: 0.0230920
	speed: 0.0541s/iter; left time: 2169.4314s
Epoch: 3 cost time: 22.861850023269653
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.964 Test Loss: 0.102 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0062441
	speed: 0.1766s/iter; left time: 7056.2360s
	iters: 200, epoch: 4 | loss: 0.0201645
	speed: 0.0584s/iter; left time: 2326.6492s
	iters: 300, epoch: 4 | loss: 0.0001945
	speed: 0.0614s/iter; left time: 2441.7972s
	iters: 400, epoch: 4 | loss: 0.0562917
	speed: 0.0575s/iter; left time: 2281.0387s
Epoch: 4 cost time: 24.420791149139404
Epoch: 4, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.050 Vali Acc: 0.984 Test Loss: 0.050 Test Acc: 0.984
Validation loss decreased (-0.977716 --> -0.984083).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0053074
	speed: 0.1941s/iter; left time: 7676.0742s
	iters: 200, epoch: 5 | loss: 0.0000582
	speed: 0.0555s/iter; left time: 2187.5780s
	iters: 300, epoch: 5 | loss: 0.0002507
	speed: 0.0562s/iter; left time: 2211.7051s
	iters: 400, epoch: 5 | loss: 0.0242582
	speed: 0.0565s/iter; left time: 2216.7001s
Epoch: 5 cost time: 23.54861807823181
Epoch: 5, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0001222
	speed: 0.1704s/iter; left time: 6669.9918s
	iters: 200, epoch: 6 | loss: 0.0130889
	speed: 0.0545s/iter; left time: 2126.6245s
	iters: 300, epoch: 6 | loss: 0.0012240
	speed: 0.0572s/iter; left time: 2228.8020s
	iters: 400, epoch: 6 | loss: 0.0204338
	speed: 0.0539s/iter; left time: 2095.2017s
Epoch: 6 cost time: 22.996756315231323
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0135765
	speed: 0.1613s/iter; left time: 6246.3250s
	iters: 200, epoch: 7 | loss: 0.0004602
	speed: 0.0455s/iter; left time: 1758.3120s
	iters: 300, epoch: 7 | loss: 0.0005367
	speed: 0.0566s/iter; left time: 2179.2219s
	iters: 400, epoch: 7 | loss: 0.0000209
	speed: 0.0590s/iter; left time: 2266.5862s
Epoch: 7 cost time: 21.933833360671997
Epoch: 7, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0003470
	speed: 0.1918s/iter; left time: 7348.4071s
	iters: 200, epoch: 8 | loss: 0.1869085
	speed: 0.0561s/iter; left time: 2145.4297s
	iters: 300, epoch: 8 | loss: 0.0586619
	speed: 0.0557s/iter; left time: 2122.2667s
	iters: 400, epoch: 8 | loss: 0.0000293
	speed: 0.0532s/iter; left time: 2023.6986s
Epoch: 8 cost time: 23.226020574569702
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000008
	speed: 0.1882s/iter; left time: 7133.5700s
	iters: 200, epoch: 9 | loss: 0.0008651
	speed: 0.0422s/iter; left time: 1596.6740s
	iters: 300, epoch: 9 | loss: 0.0009183
	speed: 0.0458s/iter; left time: 1725.0017s
	iters: 400, epoch: 9 | loss: 0.0005185
	speed: 0.0460s/iter; left time: 1727.6437s
Epoch: 9 cost time: 19.392194986343384
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0002805
	speed: 0.1529s/iter; left time: 5731.2284s
	iters: 200, epoch: 10 | loss: 0.0003559
	speed: 0.0549s/iter; left time: 2054.0773s
	iters: 300, epoch: 10 | loss: 0.0007869
	speed: 0.0551s/iter; left time: 2055.7728s
	iters: 400, epoch: 10 | loss: 0.0001258
	speed: 0.0561s/iter; left time: 2087.5830s
Epoch: 10 cost time: 23.264673709869385
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.153 Vali Acc: 0.979 Test Loss: 0.153 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000886
	speed: 0.1705s/iter; left time: 6319.4237s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 2093.0840s
	iters: 300, epoch: 11 | loss: 0.0002813
	speed: 0.0541s/iter; left time: 1993.5881s
	iters: 400, epoch: 11 | loss: 0.0000014
	speed: 0.0573s/iter; left time: 2108.2376s
Epoch: 11 cost time: 23.629249572753906
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1769s/iter; left time: 6485.0495s
	iters: 200, epoch: 12 | loss: 0.0004331
	speed: 0.0555s/iter; left time: 2030.6561s
	iters: 300, epoch: 12 | loss: 0.0000002
	speed: 0.0518s/iter; left time: 1889.3776s
	iters: 400, epoch: 12 | loss: 0.2715051
	speed: 0.0524s/iter; left time: 1904.9503s
Epoch: 12 cost time: 22.795320749282837
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.224 Vali Acc: 0.969 Test Loss: 0.224 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.1948s/iter; left time: 7060.7589s
	iters: 200, epoch: 13 | loss: 0.0026558
	speed: 0.0523s/iter; left time: 1889.5286s
	iters: 300, epoch: 13 | loss: 0.0000013
	speed: 0.0512s/iter; left time: 1844.1704s
	iters: 400, epoch: 13 | loss: 0.0001740
	speed: 0.0528s/iter; left time: 1899.2398s
Epoch: 13 cost time: 22.242734909057617
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.982 Test Loss: 0.117 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0047635
	speed: 0.1731s/iter; left time: 6204.0744s
	iters: 200, epoch: 14 | loss: 0.0003031
	speed: 0.0573s/iter; left time: 2049.1031s
	iters: 300, epoch: 14 | loss: 0.0000022
	speed: 0.0540s/iter; left time: 1924.3096s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0532s/iter; left time: 1889.7504s
Epoch: 14 cost time: 22.90850019454956
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 1247506
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6009872
	speed: 0.0698s/iter; left time: 2877.7678s
	iters: 200, epoch: 1 | loss: 0.1247331
	speed: 0.0512s/iter; left time: 2105.3134s
	iters: 300, epoch: 1 | loss: 0.0102779
	speed: 0.0586s/iter; left time: 2401.0979s
	iters: 400, epoch: 1 | loss: 0.0315472
	speed: 0.0518s/iter; left time: 2117.4239s
Epoch: 1 cost time: 23.917797803878784
Epoch: 1, Steps: 413 | Train Loss: 0.395 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (inf --> -0.977716).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0092501
	speed: 0.1677s/iter; left time: 6839.9397s
	iters: 200, epoch: 2 | loss: 0.0056442
	speed: 0.0517s/iter; left time: 2102.2942s
	iters: 300, epoch: 2 | loss: 0.2848838
	speed: 0.0553s/iter; left time: 2245.6220s
	iters: 400, epoch: 2 | loss: 0.0244810
	speed: 0.0544s/iter; left time: 2200.8622s
Epoch: 2 cost time: 22.60110855102539
Epoch: 2, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0036538
	speed: 0.1653s/iter; left time: 6673.3823s
	iters: 200, epoch: 3 | loss: 0.0001122
	speed: 0.0547s/iter; left time: 2204.3025s
	iters: 300, epoch: 3 | loss: 0.0014532
	speed: 0.0558s/iter; left time: 2240.8255s
	iters: 400, epoch: 3 | loss: 0.0159679
	speed: 0.0518s/iter; left time: 2074.3354s
Epoch: 3 cost time: 22.60197138786316
Epoch: 3, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0680247
	speed: 0.1796s/iter; left time: 7175.8649s
	iters: 200, epoch: 4 | loss: 0.0124319
	speed: 0.0521s/iter; left time: 2077.8837s
	iters: 300, epoch: 4 | loss: 0.0003033
	speed: 0.0530s/iter; left time: 2106.3824s
	iters: 400, epoch: 4 | loss: 0.0013635
	speed: 0.0542s/iter; left time: 2147.8856s
Epoch: 4 cost time: 22.400175094604492
Epoch: 4, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0050382
	speed: 0.1929s/iter; left time: 7628.1841s
	iters: 200, epoch: 5 | loss: 0.0008865
	speed: 0.0491s/iter; left time: 1938.0494s
	iters: 300, epoch: 5 | loss: 0.0015549
	speed: 0.0495s/iter; left time: 1946.4405s
	iters: 400, epoch: 5 | loss: 0.3879705
	speed: 0.0538s/iter; left time: 2111.4039s
Epoch: 5 cost time: 21.93132495880127
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000048
	speed: 0.1655s/iter; left time: 6478.6903s
	iters: 200, epoch: 6 | loss: 0.0000848
	speed: 0.0510s/iter; left time: 1989.6730s
	iters: 300, epoch: 6 | loss: 0.0000044
	speed: 0.0513s/iter; left time: 1997.2381s
	iters: 400, epoch: 6 | loss: 0.0122120
	speed: 0.0535s/iter; left time: 2076.7970s
Epoch: 6 cost time: 22.11736750602722
Epoch: 6, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.2314671
	speed: 0.1639s/iter; left time: 6348.2922s
	iters: 200, epoch: 7 | loss: 0.1791956
	speed: 0.0564s/iter; left time: 2176.8399s
	iters: 300, epoch: 7 | loss: 0.0001318
	speed: 0.0545s/iter; left time: 2099.1783s
	iters: 400, epoch: 7 | loss: 0.0000111
	speed: 0.0545s/iter; left time: 2093.8356s
Epoch: 7 cost time: 22.523892164230347
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.979535).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000015
	speed: 0.1834s/iter; left time: 7025.2286s
	iters: 200, epoch: 8 | loss: 0.0006156
	speed: 0.0590s/iter; left time: 2255.8409s
	iters: 300, epoch: 8 | loss: 0.0004910
	speed: 0.0517s/iter; left time: 1971.6862s
	iters: 400, epoch: 8 | loss: 0.0364532
	speed: 0.0517s/iter; left time: 1964.2103s
Epoch: 8 cost time: 22.745426177978516
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000064
	speed: 0.1678s/iter; left time: 6360.8367s
	iters: 200, epoch: 9 | loss: 0.0000483
	speed: 0.0557s/iter; left time: 2107.0018s
	iters: 300, epoch: 9 | loss: 0.0002533
	speed: 0.0555s/iter; left time: 2091.1352s
	iters: 400, epoch: 9 | loss: 0.0026523
	speed: 0.0520s/iter; left time: 1956.0543s
Epoch: 9 cost time: 22.69545292854309
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.979535 --> -0.984993).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000400
	speed: 0.1662s/iter; left time: 6230.0131s
	iters: 200, epoch: 10 | loss: 0.0189436
	speed: 0.0537s/iter; left time: 2007.1978s
	iters: 300, epoch: 10 | loss: 0.0000468
	speed: 0.0507s/iter; left time: 1890.4890s
	iters: 400, epoch: 10 | loss: 0.0607999
	speed: 0.0507s/iter; left time: 1884.0062s
Epoch: 10 cost time: 21.679025888442993
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0004550
	speed: 0.1755s/iter; left time: 6506.6667s
	iters: 200, epoch: 11 | loss: 0.0023786
	speed: 0.0483s/iter; left time: 1784.6520s
	iters: 300, epoch: 11 | loss: 0.0002031
	speed: 0.0545s/iter; left time: 2010.1089s
	iters: 400, epoch: 11 | loss: 0.0012886
	speed: 0.0516s/iter; left time: 1897.7048s
Epoch: 11 cost time: 21.435799837112427
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0006649
	speed: 0.1708s/iter; left time: 6262.1333s
	iters: 200, epoch: 12 | loss: 0.0186257
	speed: 0.0509s/iter; left time: 1859.6456s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 1875.8960s
	iters: 400, epoch: 12 | loss: 0.0000435
	speed: 0.0489s/iter; left time: 1776.3646s
Epoch: 12 cost time: 21.348527669906616
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000007
	speed: 0.1526s/iter; left time: 5532.7230s
	iters: 200, epoch: 13 | loss: 0.0239798
	speed: 0.0546s/iter; left time: 1972.6387s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0520s/iter; left time: 1874.0913s
	iters: 400, epoch: 13 | loss: 0.0000220
	speed: 0.0557s/iter; left time: 2001.3686s
Epoch: 13 cost time: 22.569624662399292
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000011
	speed: 0.1885s/iter; left time: 6754.0881s
	iters: 200, epoch: 14 | loss: 0.0026382
	speed: 0.0571s/iter; left time: 2041.0069s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 1889.8328s
	iters: 400, epoch: 14 | loss: 0.0000684
	speed: 0.0555s/iter; left time: 1972.6193s
Epoch: 14 cost time: 23.512068033218384
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000015
	speed: 0.1831s/iter; left time: 6483.6815s
	iters: 200, epoch: 15 | loss: 0.0000111
	speed: 0.0546s/iter; left time: 1928.2636s
	iters: 300, epoch: 15 | loss: 0.0012184
	speed: 0.0522s/iter; left time: 1839.4276s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 1841.4619s
Epoch: 15 cost time: 22.24389386177063
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0002215
	speed: 0.1659s/iter; left time: 5807.0775s
	iters: 200, epoch: 16 | loss: 0.0000020
	speed: 0.0546s/iter; left time: 1907.0267s
	iters: 300, epoch: 16 | loss: 0.0000798
	speed: 0.0522s/iter; left time: 1818.2112s
	iters: 400, epoch: 16 | loss: 0.0000003
	speed: 0.0515s/iter; left time: 1787.9589s
Epoch: 16 cost time: 21.92156982421875
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0029029
	speed: 0.1651s/iter; left time: 5712.5422s
	iters: 200, epoch: 17 | loss: 0.0000004
	speed: 0.0525s/iter; left time: 1810.7927s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.0529s/iter; left time: 1818.0397s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0516s/iter; left time: 1769.4527s
Epoch: 17 cost time: 21.916512966156006
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.080 Vali Acc: 0.985 Test Loss: 0.080 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000034
	speed: 0.1891s/iter; left time: 6464.0439s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0514s/iter; left time: 1753.2133s
	iters: 300, epoch: 18 | loss: 0.0000013
	speed: 0.0509s/iter; left time: 1727.9756s
	iters: 400, epoch: 18 | loss: 0.0000010
	speed: 0.0521s/iter; left time: 1766.0080s
Epoch: 18 cost time: 21.8178870677948
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000003
	speed: 0.1699s/iter; left time: 5735.6723s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1722.0968s
	iters: 300, epoch: 19 | loss: 0.0000113
	speed: 0.0536s/iter; left time: 1798.9749s
	iters: 400, epoch: 19 | loss: 0.0000033
	speed: 0.0521s/iter; left time: 1743.3059s
Epoch: 19 cost time: 21.93787455558777
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 1247506
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7752963
	speed: 0.0484s/iter; left time: 1993.2981s
	iters: 200, epoch: 1 | loss: 0.1790721
	speed: 0.0304s/iter; left time: 1249.6390s
	iters: 300, epoch: 1 | loss: 0.0173730
	speed: 0.0336s/iter; left time: 1376.3510s
	iters: 400, epoch: 1 | loss: 0.0313210
	speed: 0.0338s/iter; left time: 1383.4645s
Epoch: 1 cost time: 15.13345718383789
Epoch: 1, Steps: 413 | Train Loss: 0.436 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (inf --> -0.982719).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0181199
	speed: 0.0936s/iter; left time: 3819.4698s
	iters: 200, epoch: 2 | loss: 0.0066936
	speed: 0.0343s/iter; left time: 1396.9585s
	iters: 300, epoch: 2 | loss: 0.0791960
	speed: 0.0314s/iter; left time: 1275.2141s
	iters: 400, epoch: 2 | loss: 0.0236129
	speed: 0.0333s/iter; left time: 1349.9208s
Epoch: 2 cost time: 14.286943674087524
Epoch: 2, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0035330
	speed: 0.0880s/iter; left time: 3551.8314s
	iters: 200, epoch: 3 | loss: 0.0005795
	speed: 0.0352s/iter; left time: 1416.1233s
	iters: 300, epoch: 3 | loss: 0.0015117
	speed: 0.0351s/iter; left time: 1410.8503s
	iters: 400, epoch: 3 | loss: 0.0037290
	speed: 0.0349s/iter; left time: 1399.3944s
Epoch: 3 cost time: 14.677985429763794
Epoch: 3, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1025776
	speed: 0.0913s/iter; left time: 3648.0749s
	iters: 200, epoch: 4 | loss: 0.0007977
	speed: 0.0343s/iter; left time: 1366.6403s
	iters: 300, epoch: 4 | loss: 0.1705565
	speed: 0.0346s/iter; left time: 1376.8869s
	iters: 400, epoch: 4 | loss: 0.0033935
	speed: 0.0328s/iter; left time: 1302.2455s
Epoch: 4 cost time: 14.496634006500244
Epoch: 4, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0011658
	speed: 0.0937s/iter; left time: 3703.9548s
	iters: 200, epoch: 5 | loss: 0.0003988
	speed: 0.0357s/iter; left time: 1407.0708s
	iters: 300, epoch: 5 | loss: 0.0002739
	speed: 0.0339s/iter; left time: 1335.5659s
	iters: 400, epoch: 5 | loss: 0.0112750
	speed: 0.0345s/iter; left time: 1355.0548s
Epoch: 5 cost time: 14.508344888687134
Epoch: 5, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0187568
	speed: 0.0934s/iter; left time: 3656.0626s
	iters: 200, epoch: 6 | loss: 0.0020184
	speed: 0.0327s/iter; left time: 1275.1045s
	iters: 300, epoch: 6 | loss: 0.0012613
	speed: 0.0336s/iter; left time: 1309.4184s
	iters: 400, epoch: 6 | loss: 0.3810274
	speed: 0.0356s/iter; left time: 1381.8298s
Epoch: 6 cost time: 14.529893636703491
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
Validation loss decreased (-0.982719 --> -0.984083).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0280330
	speed: 0.0921s/iter; left time: 3564.8857s
	iters: 200, epoch: 7 | loss: 0.0001728
	speed: 0.0328s/iter; left time: 1266.9897s
	iters: 300, epoch: 7 | loss: 0.1761124
	speed: 0.0337s/iter; left time: 1298.9660s
	iters: 400, epoch: 7 | loss: 0.0982160
	speed: 0.0328s/iter; left time: 1260.2837s
Epoch: 7 cost time: 14.113936185836792
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000394
	speed: 0.0910s/iter; left time: 3485.8104s
	iters: 200, epoch: 8 | loss: 0.0067202
	speed: 0.0336s/iter; left time: 1283.1641s
	iters: 300, epoch: 8 | loss: 0.1491314
	speed: 0.0340s/iter; left time: 1294.3665s
	iters: 400, epoch: 8 | loss: 0.0000535
	speed: 0.0324s/iter; left time: 1229.7690s
Epoch: 8 cost time: 14.053705930709839
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000025
	speed: 0.0925s/iter; left time: 3503.7730s
	iters: 200, epoch: 9 | loss: 0.7472237
	speed: 0.0334s/iter; left time: 1263.0511s
	iters: 300, epoch: 9 | loss: 0.1014068
	speed: 0.0363s/iter; left time: 1367.4499s
	iters: 400, epoch: 9 | loss: 0.0000087
	speed: 0.0326s/iter; left time: 1226.4380s
Epoch: 9 cost time: 14.56814956665039
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0078971
	speed: 0.0924s/iter; left time: 3465.0643s
	iters: 200, epoch: 10 | loss: 0.0024170
	speed: 0.0337s/iter; left time: 1258.2279s
	iters: 300, epoch: 10 | loss: 0.0877421
	speed: 0.0338s/iter; left time: 1260.1766s
	iters: 400, epoch: 10 | loss: 0.0104382
	speed: 0.0343s/iter; left time: 1274.4620s
Epoch: 10 cost time: 14.435719966888428
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0044935
	speed: 0.0934s/iter; left time: 3461.8132s
	iters: 200, epoch: 11 | loss: 0.0000041
	speed: 0.0348s/iter; left time: 1287.1016s
	iters: 300, epoch: 11 | loss: 0.0000426
	speed: 0.0349s/iter; left time: 1287.5772s
	iters: 400, epoch: 11 | loss: 0.0000291
	speed: 0.0327s/iter; left time: 1203.7695s
Epoch: 11 cost time: 14.485231637954712
Epoch: 11, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0023645
	speed: 0.0901s/iter; left time: 3303.2901s
	iters: 200, epoch: 12 | loss: 0.0001300
	speed: 0.0325s/iter; left time: 1187.2506s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 1258.8618s
	iters: 400, epoch: 12 | loss: 0.0000030
	speed: 0.0340s/iter; left time: 1236.2304s
Epoch: 12 cost time: 14.244323015213013
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.180 Vali Acc: 0.974 Test Loss: 0.180 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000134
	speed: 0.0912s/iter; left time: 3306.8175s
	iters: 200, epoch: 13 | loss: 0.0050453
	speed: 0.0336s/iter; left time: 1213.0973s
	iters: 300, epoch: 13 | loss: 0.0209337
	speed: 0.0345s/iter; left time: 1243.0286s
	iters: 400, epoch: 13 | loss: 0.0003292
	speed: 0.0358s/iter; left time: 1286.8588s
Epoch: 13 cost time: 14.44735336303711
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000657
	speed: 0.0888s/iter; left time: 3181.0730s
	iters: 200, epoch: 14 | loss: 0.0000014
	speed: 0.0332s/iter; left time: 1187.5740s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 1200.1339s
	iters: 400, epoch: 14 | loss: 0.0001610
	speed: 0.0338s/iter; left time: 1199.8528s
Epoch: 14 cost time: 14.343012809753418
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.257 Vali Acc: 0.964 Test Loss: 0.257 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0007472
	speed: 0.0924s/iter; left time: 3271.9298s
	iters: 200, epoch: 15 | loss: 0.0008690
	speed: 0.0340s/iter; left time: 1201.3013s
	iters: 300, epoch: 15 | loss: 0.0000161
	speed: 0.0347s/iter; left time: 1221.4040s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 1179.5162s
Epoch: 15 cost time: 14.518296003341675
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000013
	speed: 0.0921s/iter; left time: 3224.7959s
	iters: 200, epoch: 16 | loss: 0.0000320
	speed: 0.0341s/iter; left time: 1191.8044s
	iters: 300, epoch: 16 | loss: 0.0000003
	speed: 0.0342s/iter; left time: 1192.0883s
	iters: 400, epoch: 16 | loss: 0.0006880
	speed: 0.0321s/iter; left time: 1114.2028s
Epoch: 16 cost time: 14.263982772827148
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 1247506
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3917432
	speed: 0.0714s/iter; left time: 2942.8280s
	iters: 200, epoch: 1 | loss: 0.2320275
	speed: 0.0542s/iter; left time: 2228.8313s
	iters: 300, epoch: 1 | loss: 0.2310040
	speed: 0.0542s/iter; left time: 2224.1698s
	iters: 400, epoch: 1 | loss: 0.0578842
	speed: 0.0545s/iter; left time: 2230.8763s
Epoch: 1 cost time: 24.279781818389893
Epoch: 1, Steps: 413 | Train Loss: 0.408 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
Validation loss decreased (inf --> -0.974533).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0073340
	speed: 0.1798s/iter; left time: 7332.5196s
	iters: 200, epoch: 2 | loss: 0.0082032
	speed: 0.0554s/iter; left time: 2256.1289s
	iters: 300, epoch: 2 | loss: 0.0156609
	speed: 0.0536s/iter; left time: 2175.0962s
	iters: 400, epoch: 2 | loss: 0.0510350
	speed: 0.0521s/iter; left time: 2107.5847s
Epoch: 2 cost time: 22.369117259979248
Epoch: 2, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.061 Vali Acc: 0.977 Test Loss: 0.061 Test Acc: 0.977
Validation loss decreased (-0.974533 --> -0.977262).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0020843
	speed: 0.1682s/iter; left time: 6790.6764s
	iters: 200, epoch: 3 | loss: 0.0226128
	speed: 0.0526s/iter; left time: 2116.8639s
	iters: 300, epoch: 3 | loss: 0.1477758
	speed: 0.0526s/iter; left time: 2114.4913s
	iters: 400, epoch: 3 | loss: 0.0016580
	speed: 0.0516s/iter; left time: 2066.8465s
Epoch: 3 cost time: 21.77668857574463
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.977262 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0003492
	speed: 0.1759s/iter; left time: 7029.4054s
	iters: 200, epoch: 4 | loss: 0.0022172
	speed: 0.0524s/iter; left time: 2090.3070s
	iters: 300, epoch: 4 | loss: 0.0237333
	speed: 0.0556s/iter; left time: 2208.9718s
	iters: 400, epoch: 4 | loss: 0.0062334
	speed: 0.0508s/iter; left time: 2016.7271s
Epoch: 4 cost time: 22.381722688674927
Epoch: 4, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0002521
	speed: 0.1836s/iter; left time: 7261.0617s
	iters: 200, epoch: 5 | loss: 0.0011078
	speed: 0.0466s/iter; left time: 1836.9344s
	iters: 300, epoch: 5 | loss: 0.0000235
	speed: 0.0608s/iter; left time: 2394.0764s
	iters: 400, epoch: 5 | loss: 0.0002303
	speed: 0.0645s/iter; left time: 2531.3411s
Epoch: 5 cost time: 23.53481936454773
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0049421
	speed: 0.1425s/iter; left time: 5575.1987s
	iters: 200, epoch: 6 | loss: 0.0007658
	speed: 0.0372s/iter; left time: 1450.3772s
	iters: 300, epoch: 6 | loss: 0.0625896
	speed: 0.0484s/iter; left time: 1884.3472s
	iters: 400, epoch: 6 | loss: 0.0019218
	speed: 0.0544s/iter; left time: 2110.9722s
Epoch: 6 cost time: 18.994786500930786
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.977716 --> -0.981354).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000067
	speed: 0.1675s/iter; left time: 6484.6728s
	iters: 200, epoch: 7 | loss: 0.0262443
	speed: 0.0521s/iter; left time: 2013.7742s
	iters: 300, epoch: 7 | loss: 0.0000274
	speed: 0.0524s/iter; left time: 2017.7147s
	iters: 400, epoch: 7 | loss: 0.0007839
	speed: 0.0517s/iter; left time: 1984.8022s
Epoch: 7 cost time: 22.092716217041016
Epoch: 7, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000303
	speed: 0.1515s/iter; left time: 5805.5567s
	iters: 200, epoch: 8 | loss: 0.0784847
	speed: 0.0540s/iter; left time: 2063.7963s
	iters: 300, epoch: 8 | loss: 0.0000124
	speed: 0.0541s/iter; left time: 2060.6467s
	iters: 400, epoch: 8 | loss: 0.0011070
	speed: 0.0536s/iter; left time: 2036.1690s
Epoch: 8 cost time: 22.648931741714478
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1547437
	speed: 0.1924s/iter; left time: 7290.4671s
	iters: 200, epoch: 9 | loss: 0.0000398
	speed: 0.0555s/iter; left time: 2099.3797s
	iters: 300, epoch: 9 | loss: 0.0000002
	speed: 0.0522s/iter; left time: 1968.5220s
	iters: 400, epoch: 9 | loss: 0.0005670
	speed: 0.0527s/iter; left time: 1980.9357s
Epoch: 9 cost time: 22.54905414581299
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0070839
	speed: 0.1609s/iter; left time: 6029.4645s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0502s/iter; left time: 1878.2491s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0517s/iter; left time: 1927.5340s
	iters: 400, epoch: 10 | loss: 0.0000066
	speed: 0.0510s/iter; left time: 1895.9578s
Epoch: 10 cost time: 21.371843814849854
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000976
	speed: 0.1631s/iter; left time: 6045.0992s
	iters: 200, epoch: 11 | loss: 0.0000767
	speed: 0.0529s/iter; left time: 1956.8830s
	iters: 300, epoch: 11 | loss: 0.0000067
	speed: 0.0536s/iter; left time: 1976.8993s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0506s/iter; left time: 1859.6855s
Epoch: 11 cost time: 21.547576904296875
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.201 Vali Acc: 0.970 Test Loss: 0.201 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1821s/iter; left time: 6674.8780s
	iters: 200, epoch: 12 | loss: 0.0000337
	speed: 0.0518s/iter; left time: 1893.7647s
	iters: 300, epoch: 12 | loss: 0.0000783
	speed: 0.0563s/iter; left time: 2051.6085s
	iters: 400, epoch: 12 | loss: 0.0234444
	speed: 0.0541s/iter; left time: 1968.4695s
Epoch: 12 cost time: 22.57894206047058
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.979 Test Loss: 0.133 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1806s/iter; left time: 6545.2480s
	iters: 200, epoch: 13 | loss: 0.0000005
	speed: 0.0501s/iter; left time: 1811.5088s
	iters: 300, epoch: 13 | loss: 0.0000010
	speed: 0.0534s/iter; left time: 1925.9409s
	iters: 400, epoch: 13 | loss: 0.0000056
	speed: 0.0543s/iter; left time: 1950.3617s
Epoch: 13 cost time: 22.020410537719727
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000013
	speed: 0.1736s/iter; left time: 6219.2049s
	iters: 200, epoch: 14 | loss: 0.0000124
	speed: 0.0529s/iter; left time: 1890.4528s
	iters: 300, epoch: 14 | loss: 0.0004736
	speed: 0.0539s/iter; left time: 1921.7201s
	iters: 400, epoch: 14 | loss: 0.0007786
	speed: 0.0523s/iter; left time: 1857.0675s
Epoch: 14 cost time: 22.373419046401978
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0066720
	speed: 0.1678s/iter; left time: 5943.1654s
	iters: 200, epoch: 15 | loss: 0.0005598
	speed: 0.0500s/iter; left time: 1767.1232s
	iters: 300, epoch: 15 | loss: 0.0000999
	speed: 0.0519s/iter; left time: 1827.1220s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 1855.4199s
Epoch: 15 cost time: 22.098289012908936
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0009531
	speed: 0.1893s/iter; left time: 6627.5855s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 1762.0392s
	iters: 300, epoch: 16 | loss: 0.0001474
	speed: 0.0499s/iter; left time: 1738.4764s
	iters: 400, epoch: 16 | loss: 0.0000728
	speed: 0.0517s/iter; left time: 1795.9621s
Epoch: 16 cost time: 22.05690574645996
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.169 Vali Acc: 0.977 Test Loss: 0.169 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 723218
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4140359
	speed: 0.0700s/iter; left time: 2883.8124s
	iters: 200, epoch: 1 | loss: 0.2269811
	speed: 0.0528s/iter; left time: 2171.0712s
	iters: 300, epoch: 1 | loss: 0.2246125
	speed: 0.0497s/iter; left time: 2037.3953s
	iters: 400, epoch: 1 | loss: 0.0480341
	speed: 0.0524s/iter; left time: 2141.7965s
Epoch: 1 cost time: 23.389087915420532
Epoch: 1, Steps: 413 | Train Loss: 0.407 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
Validation loss decreased (inf --> -0.978626).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0075621
	speed: 0.1894s/iter; left time: 7725.4885s
	iters: 200, epoch: 2 | loss: 0.0059601
	speed: 0.0548s/iter; left time: 2228.3721s
	iters: 300, epoch: 2 | loss: 0.0177566
	speed: 0.0535s/iter; left time: 2172.4001s
	iters: 400, epoch: 2 | loss: 0.0695486
	speed: 0.0556s/iter; left time: 2251.4505s
Epoch: 2 cost time: 22.969492197036743
Epoch: 2, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0012798
	speed: 0.1737s/iter; left time: 7011.1489s
	iters: 200, epoch: 3 | loss: 0.0146438
	speed: 0.0528s/iter; left time: 2126.1738s
	iters: 300, epoch: 3 | loss: 0.0310637
	speed: 0.0500s/iter; left time: 2010.3556s
	iters: 400, epoch: 3 | loss: 0.0022852
	speed: 0.0510s/iter; left time: 2044.7994s
Epoch: 3 cost time: 21.520771026611328
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
Validation loss decreased (-0.978626 --> -0.979081).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0053151
	speed: 0.1610s/iter; left time: 6433.8592s
	iters: 200, epoch: 4 | loss: 0.0001124
	speed: 0.0510s/iter; left time: 2032.6126s
	iters: 300, epoch: 4 | loss: 0.0012285
	speed: 0.0513s/iter; left time: 2039.7061s
	iters: 400, epoch: 4 | loss: 0.0062455
	speed: 0.0501s/iter; left time: 1985.6323s
Epoch: 4 cost time: 21.391026258468628
Epoch: 4, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0014006
	speed: 0.1696s/iter; left time: 6707.2494s
	iters: 200, epoch: 5 | loss: 0.0066438
	speed: 0.0518s/iter; left time: 2044.6731s
	iters: 300, epoch: 5 | loss: 1.1338608
	speed: 0.0543s/iter; left time: 2136.3206s
	iters: 400, epoch: 5 | loss: 0.0000653
	speed: 0.0505s/iter; left time: 1981.5682s
Epoch: 5 cost time: 21.89322280883789
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0008418
	speed: 0.1873s/iter; left time: 7328.8510s
	iters: 200, epoch: 6 | loss: 0.0018399
	speed: 0.0517s/iter; left time: 2016.9007s
	iters: 300, epoch: 6 | loss: 0.0000066
	speed: 0.0519s/iter; left time: 2022.2762s
	iters: 400, epoch: 6 | loss: 0.0000825
	speed: 0.0523s/iter; left time: 2032.0908s
Epoch: 6 cost time: 22.079081535339355
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000154
	speed: 0.1763s/iter; left time: 6828.5654s
	iters: 200, epoch: 7 | loss: 0.0105884
	speed: 0.0513s/iter; left time: 1980.9902s
	iters: 300, epoch: 7 | loss: 0.0003730
	speed: 0.0523s/iter; left time: 2013.0785s
	iters: 400, epoch: 7 | loss: 0.0000051
	speed: 0.0547s/iter; left time: 2101.2312s
Epoch: 7 cost time: 22.157673597335815
Epoch: 7, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0019287
	speed: 0.1667s/iter; left time: 6386.0733s
	iters: 200, epoch: 8 | loss: 0.0000203
	speed: 0.0538s/iter; left time: 2054.9839s
	iters: 300, epoch: 8 | loss: 0.0000058
	speed: 0.0540s/iter; left time: 2058.5336s
	iters: 400, epoch: 8 | loss: 0.0000200
	speed: 0.0568s/iter; left time: 2159.1881s
Epoch: 8 cost time: 23.121988534927368
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.082 Vali Acc: 0.984 Test Loss: 0.082 Test Acc: 0.984
Validation loss decreased (-0.979081 --> -0.984083).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1295924
	speed: 0.1873s/iter; left time: 7096.8151s
	iters: 200, epoch: 9 | loss: 0.0000002
	speed: 0.0561s/iter; left time: 2121.7332s
	iters: 300, epoch: 9 | loss: 0.0006247
	speed: 0.0502s/iter; left time: 1892.7248s
	iters: 400, epoch: 9 | loss: 0.0004332
	speed: 0.0529s/iter; left time: 1988.0312s
Epoch: 9 cost time: 22.930086851119995
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0918913
	speed: 0.1630s/iter; left time: 6108.4239s
	iters: 200, epoch: 10 | loss: 0.0000028
	speed: 0.0534s/iter; left time: 1996.9611s
	iters: 300, epoch: 10 | loss: 0.0000129
	speed: 0.0502s/iter; left time: 1872.0731s
	iters: 400, epoch: 10 | loss: 0.0000004
	speed: 0.0516s/iter; left time: 1917.7776s
Epoch: 10 cost time: 21.929141521453857
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.168 Vali Acc: 0.977 Test Loss: 0.168 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000015
	speed: 0.1712s/iter; left time: 6345.8352s
	iters: 200, epoch: 11 | loss: 0.3095026
	speed: 0.0544s/iter; left time: 2011.7722s
	iters: 300, epoch: 11 | loss: 0.0000008
	speed: 0.0531s/iter; left time: 1959.1918s
	iters: 400, epoch: 11 | loss: 0.0000513
	speed: 0.0511s/iter; left time: 1877.4739s
Epoch: 11 cost time: 22.199538946151733
Epoch: 11, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.1903s/iter; left time: 6976.9985s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 2016.9075s
	iters: 300, epoch: 12 | loss: 0.0002138
	speed: 0.0552s/iter; left time: 2012.4619s
	iters: 400, epoch: 12 | loss: 0.0000471
	speed: 0.0503s/iter; left time: 1828.5120s
Epoch: 12 cost time: 22.537859439849854
Epoch: 12, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
Validation loss decreased (-0.984083 --> -0.984992).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.1559s/iter; left time: 5649.7807s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 1587.3345s
	iters: 300, epoch: 13 | loss: 0.0000011
	speed: 0.0511s/iter; left time: 1841.4835s
	iters: 400, epoch: 13 | loss: 0.0000003
	speed: 0.0521s/iter; left time: 1871.9450s
Epoch: 13 cost time: 20.260459899902344
Epoch: 13, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1647s/iter; left time: 5902.4085s
	iters: 200, epoch: 14 | loss: 0.0000163
	speed: 0.0514s/iter; left time: 1836.4977s
	iters: 300, epoch: 14 | loss: 0.0000002
	speed: 0.0520s/iter; left time: 1851.9259s
	iters: 400, epoch: 14 | loss: 0.0000083
	speed: 0.0532s/iter; left time: 1889.4364s
Epoch: 14 cost time: 22.077022552490234
Epoch: 14, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.977 Test Loss: 0.157 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.3318009
	speed: 0.1771s/iter; left time: 6274.4029s
	iters: 200, epoch: 15 | loss: 0.0000014
	speed: 0.0526s/iter; left time: 1858.9260s
	iters: 300, epoch: 15 | loss: 0.0000017
	speed: 0.0521s/iter; left time: 1835.6088s
	iters: 400, epoch: 15 | loss: 0.0000065
	speed: 0.0585s/iter; left time: 2054.0066s
Epoch: 15 cost time: 22.500787258148193
Epoch: 15, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.142 Vali Acc: 0.980 Test Loss: 0.142 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1783s/iter; left time: 6241.2639s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 1726.5125s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0497s/iter; left time: 1728.8622s
	iters: 400, epoch: 16 | loss: 0.0019306
	speed: 0.0519s/iter; left time: 1801.8223s
Epoch: 16 cost time: 21.462674856185913
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000017
	speed: 0.1716s/iter; left time: 5936.2429s
	iters: 200, epoch: 17 | loss: 0.0001232
	speed: 0.0501s/iter; left time: 1729.7728s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 1699.8040s
	iters: 400, epoch: 17 | loss: 0.0000289
	speed: 0.0504s/iter; left time: 1727.1544s
Epoch: 17 cost time: 21.400362014770508
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0015733
	speed: 0.1920s/iter; left time: 6562.4485s
	iters: 200, epoch: 18 | loss: 0.0506496
	speed: 0.0511s/iter; left time: 1742.9965s
	iters: 300, epoch: 18 | loss: 0.0005763
	speed: 0.0496s/iter; left time: 1685.0929s
	iters: 400, epoch: 18 | loss: 0.0000047
	speed: 0.0517s/iter; left time: 1752.6011s
Epoch: 18 cost time: 21.939473867416382
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.985 Test Loss: 0.117 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000020
	speed: 0.1808s/iter; left time: 6105.6825s
	iters: 200, epoch: 19 | loss: 0.2835099
	speed: 0.0509s/iter; left time: 1712.6285s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 1656.5863s
	iters: 400, epoch: 19 | loss: 0.0000002
	speed: 0.0499s/iter; left time: 1669.5581s
Epoch: 19 cost time: 21.182119131088257
Epoch: 19, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.054 Vali Acc: 0.990 Test Loss: 0.054 Test Acc: 0.990
Validation loss decreased (-0.984992 --> -0.989540).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000171
	speed: 0.1605s/iter; left time: 5352.1735s
	iters: 200, epoch: 20 | loss: 0.0042808
	speed: 0.0533s/iter; left time: 1773.3093s
	iters: 300, epoch: 20 | loss: 0.0000172
	speed: 0.0512s/iter; left time: 1696.3141s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 1744.4768s
Epoch: 20 cost time: 22.051842212677002
Epoch: 20, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1714s/iter; left time: 5647.6152s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 1900.0681s
	iters: 300, epoch: 21 | loss: 0.0000005
	speed: 0.0557s/iter; left time: 1824.7321s
	iters: 400, epoch: 21 | loss: 0.0002533
	speed: 0.0538s/iter; left time: 1757.0627s
Epoch: 21 cost time: 23.34615707397461
Epoch: 21, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.2091292
	speed: 0.1913s/iter; left time: 6222.7525s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0493s/iter; left time: 1598.4282s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 1513.6458s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1431.7453s
Epoch: 22 cost time: 20.36092519760132
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.985 Test Loss: 0.107 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1591s/iter; left time: 5110.2197s
	iters: 200, epoch: 23 | loss: 0.0000010
	speed: 0.0492s/iter; left time: 1574.3416s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 1645.8923s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 1551.8947s
Epoch: 23 cost time: 21.071775197982788
Epoch: 23, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.974 Test Loss: 0.220 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1675s/iter; left time: 5308.8016s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 1643.7486s
	iters: 300, epoch: 24 | loss: 0.0000004
	speed: 0.0544s/iter; left time: 1714.2911s
	iters: 400, epoch: 24 | loss: 0.0000057
	speed: 0.0518s/iter; left time: 1625.4817s
Epoch: 24 cost time: 21.82459783554077
Epoch: 24, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.977 Test Loss: 0.221 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0003580
	speed: 0.1782s/iter; left time: 5575.6652s
	iters: 200, epoch: 25 | loss: 0.0000479
	speed: 0.0511s/iter; left time: 1593.7231s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1620.7103s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 1609.7206s
Epoch: 25 cost time: 21.811142683029175
Epoch: 25, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.263 Vali Acc: 0.976 Test Loss: 0.263 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000004
	speed: 0.1701s/iter; left time: 5253.4922s
	iters: 200, epoch: 26 | loss: 0.0000003
	speed: 0.0514s/iter; left time: 1581.9175s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.0542s/iter; left time: 1662.7363s
	iters: 400, epoch: 26 | loss: 0.0634429
	speed: 0.0513s/iter; left time: 1567.7452s
Epoch: 26 cost time: 21.968314170837402
Epoch: 26, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.986 Test Loss: 0.116 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1673s/iter; left time: 5097.8622s
	iters: 200, epoch: 27 | loss: 0.0000005
	speed: 0.0517s/iter; left time: 1570.5036s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0540s/iter; left time: 1634.5582s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0529s/iter; left time: 1596.4579s
Epoch: 27 cost time: 22.150710105895996
Epoch: 27, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.160 Vali Acc: 0.984 Test Loss: 0.160 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1829s/iter; left time: 5497.5729s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1517.3940s
	iters: 300, epoch: 28 | loss: 0.0000641
	speed: 0.0551s/iter; left time: 1645.1676s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1509.0505s
Epoch: 28 cost time: 21.8880512714386
Epoch: 28, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.985 Test Loss: 0.111 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0214431
	speed: 0.1665s/iter; left time: 4935.6728s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 1462.2425s
	iters: 300, epoch: 29 | loss: 0.0001814
	speed: 0.0538s/iter; left time: 1583.4492s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1487.0301s
Epoch: 29 cost time: 21.51475977897644
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.144 Vali Acc: 0.983 Test Loss: 0.144 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 723218
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4157588
	speed: 0.0711s/iter; left time: 2930.2850s
	iters: 200, epoch: 1 | loss: 0.2054342
	speed: 0.0512s/iter; left time: 2105.3180s
	iters: 300, epoch: 1 | loss: 0.2865109
	speed: 0.0540s/iter; left time: 2214.2590s
	iters: 400, epoch: 1 | loss: 0.0237630
	speed: 0.0520s/iter; left time: 2127.7788s
Epoch: 1 cost time: 23.556583881378174
Epoch: 1, Steps: 413 | Train Loss: 0.411 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (inf --> -0.977262).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0066872
	speed: 0.1778s/iter; left time: 7250.5392s
	iters: 200, epoch: 2 | loss: 0.0076184
	speed: 0.0484s/iter; left time: 1967.4629s
	iters: 300, epoch: 2 | loss: 0.0174678
	speed: 0.0550s/iter; left time: 2231.2351s
	iters: 400, epoch: 2 | loss: 0.0326136
	speed: 0.0529s/iter; left time: 2142.8308s
Epoch: 2 cost time: 21.69276189804077
Epoch: 2, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.051 Vali Acc: 0.981 Test Loss: 0.051 Test Acc: 0.981
Validation loss decreased (-0.977262 --> -0.981355).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0031768
	speed: 0.1679s/iter; left time: 6780.8153s
	iters: 200, epoch: 3 | loss: 0.0004677
	speed: 0.0508s/iter; left time: 2044.7410s
	iters: 300, epoch: 3 | loss: 0.1911719
	speed: 0.0526s/iter; left time: 2113.8438s
	iters: 400, epoch: 3 | loss: 0.0034753
	speed: 0.0525s/iter; left time: 2105.0379s
Epoch: 3 cost time: 22.079164743423462
Epoch: 3, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.067 Vali Acc: 0.979 Test Loss: 0.067 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0002120
	speed: 0.1662s/iter; left time: 6639.8508s
	iters: 200, epoch: 4 | loss: 0.0004907
	speed: 0.0500s/iter; left time: 1991.1089s
	iters: 300, epoch: 4 | loss: 0.0240830
	speed: 0.0507s/iter; left time: 2016.6793s
	iters: 400, epoch: 4 | loss: 0.0099009
	speed: 0.0531s/iter; left time: 2106.9054s
Epoch: 4 cost time: 21.632994890213013
Epoch: 4, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0001225
	speed: 0.1826s/iter; left time: 7220.8486s
	iters: 200, epoch: 5 | loss: 0.0023641
	speed: 0.0512s/iter; left time: 2021.5493s
	iters: 300, epoch: 5 | loss: 0.0001359
	speed: 0.0516s/iter; left time: 2030.9716s
	iters: 400, epoch: 5 | loss: 0.0001918
	speed: 0.0548s/iter; left time: 2150.0654s
Epoch: 5 cost time: 22.40593123435974
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1190247
	speed: 0.1738s/iter; left time: 6800.7096s
	iters: 200, epoch: 6 | loss: 0.0000545
	speed: 0.0530s/iter; left time: 2068.0572s
	iters: 300, epoch: 6 | loss: 0.0000395
	speed: 0.0505s/iter; left time: 1967.4520s
	iters: 400, epoch: 6 | loss: 0.0000112
	speed: 0.0529s/iter; left time: 2053.8545s
Epoch: 6 cost time: 21.99791646003723
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
Validation loss decreased (-0.981355 --> -0.982264).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000677
	speed: 0.1672s/iter; left time: 6476.0943s
	iters: 200, epoch: 7 | loss: 0.0001876
	speed: 0.0527s/iter; left time: 2037.0506s
	iters: 300, epoch: 7 | loss: 0.0006169
	speed: 0.0520s/iter; left time: 2002.7136s
	iters: 400, epoch: 7 | loss: 0.0000169
	speed: 0.0532s/iter; left time: 2043.0799s
Epoch: 7 cost time: 22.11091661453247
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000008
	speed: 0.1899s/iter; left time: 7275.4761s
	iters: 200, epoch: 8 | loss: 0.0011362
	speed: 0.0566s/iter; left time: 2164.5848s
	iters: 300, epoch: 8 | loss: 0.0209893
	speed: 0.0539s/iter; left time: 2054.6593s
	iters: 400, epoch: 8 | loss: 0.0001314
	speed: 0.0526s/iter; left time: 1997.6178s
Epoch: 8 cost time: 22.750969886779785
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000251
	speed: 0.1715s/iter; left time: 6499.5261s
	iters: 200, epoch: 9 | loss: 0.0001521
	speed: 0.0537s/iter; left time: 2031.1314s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0512s/iter; left time: 1931.3325s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 1901.5636s
Epoch: 9 cost time: 21.73245143890381
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0027232
	speed: 0.1659s/iter; left time: 6220.1949s
	iters: 200, epoch: 10 | loss: 0.0006900
	speed: 0.0528s/iter; left time: 1973.3588s
	iters: 300, epoch: 10 | loss: 0.0003003
	speed: 0.0525s/iter; left time: 1956.6435s
	iters: 400, epoch: 10 | loss: 0.3204879
	speed: 0.0512s/iter; left time: 1904.8568s
Epoch: 10 cost time: 21.916645765304565
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.979 Test Loss: 0.117 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0048560
	speed: 0.1781s/iter; left time: 6601.9884s
	iters: 200, epoch: 11 | loss: 0.0000004
	speed: 0.0532s/iter; left time: 1968.0052s
	iters: 300, epoch: 11 | loss: 0.0000012
	speed: 0.0556s/iter; left time: 2049.1292s
	iters: 400, epoch: 11 | loss: 0.0100082
	speed: 0.0508s/iter; left time: 1868.7311s
Epoch: 11 cost time: 22.26764726638794
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.986 Test Loss: 0.089 Test Acc: 0.986
Validation loss decreased (-0.982264 --> -0.985902).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000015
	speed: 0.1934s/iter; left time: 7090.3641s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 1850.8646s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0528s/iter; left time: 1925.3849s
	iters: 400, epoch: 12 | loss: 0.0000106
	speed: 0.0510s/iter; left time: 1855.4498s
Epoch: 12 cost time: 21.844053506851196
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.183 Vali Acc: 0.976 Test Loss: 0.183 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0012225
	speed: 0.1642s/iter; left time: 5950.8372s
	iters: 200, epoch: 13 | loss: 0.0000871
	speed: 0.0502s/iter; left time: 1815.5734s
	iters: 300, epoch: 13 | loss: 0.0000003
	speed: 0.0533s/iter; left time: 1920.5276s
	iters: 400, epoch: 13 | loss: 0.0000116
	speed: 0.0532s/iter; left time: 1912.2663s
Epoch: 13 cost time: 21.884313344955444
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000171
	speed: 0.1654s/iter; left time: 5927.5594s
	iters: 200, epoch: 14 | loss: 0.0000999
	speed: 0.0537s/iter; left time: 1917.7493s
	iters: 300, epoch: 14 | loss: 0.0000049
	speed: 0.0533s/iter; left time: 1900.8936s
	iters: 400, epoch: 14 | loss: 0.0000044
	speed: 0.0598s/iter; left time: 2123.3582s
Epoch: 14 cost time: 23.08158564567566
Epoch: 14, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.142 Vali Acc: 0.981 Test Loss: 0.142 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000221
	speed: 0.1871s/iter; left time: 6625.1355s
	iters: 200, epoch: 15 | loss: 0.0750991
	speed: 0.0529s/iter; left time: 1867.7985s
	iters: 300, epoch: 15 | loss: 0.0001662
	speed: 0.0492s/iter; left time: 1733.9265s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0508s/iter; left time: 1785.2726s
Epoch: 15 cost time: 22.202120304107666
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000025
	speed: 0.1731s/iter; left time: 6058.6822s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1839.4172s
	iters: 300, epoch: 16 | loss: 0.0000875
	speed: 0.0502s/iter; left time: 1747.9130s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 1750.3839s
Epoch: 16 cost time: 21.718405961990356
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1729s/iter; left time: 5981.5400s
	iters: 200, epoch: 17 | loss: 0.0025818
	speed: 0.0538s/iter; left time: 1854.8376s
	iters: 300, epoch: 17 | loss: 0.0000254
	speed: 0.0530s/iter; left time: 1823.6577s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0540s/iter; left time: 1850.3337s
Epoch: 17 cost time: 22.261157035827637
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.137 Vali Acc: 0.979 Test Loss: 0.137 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000014
	speed: 0.1764s/iter; left time: 6030.0238s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 1777.9465s
	iters: 300, epoch: 18 | loss: 0.0005747
	speed: 0.0535s/iter; left time: 1818.6090s
	iters: 400, epoch: 18 | loss: 0.0000061
	speed: 0.0498s/iter; left time: 1688.5961s
Epoch: 18 cost time: 21.63734221458435
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.1797526
	speed: 0.1610s/iter; left time: 5435.5961s
	iters: 200, epoch: 19 | loss: 0.0000022
	speed: 0.0510s/iter; left time: 1717.1818s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 1832.3427s
	iters: 400, epoch: 19 | loss: 0.0000005
	speed: 0.0528s/iter; left time: 1766.9823s
Epoch: 19 cost time: 21.904703617095947
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.155 Vali Acc: 0.981 Test Loss: 0.155 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000005
	speed: 0.1636s/iter; left time: 5457.5544s
	iters: 200, epoch: 20 | loss: 0.0036254
	speed: 0.0505s/iter; left time: 1678.9551s
	iters: 300, epoch: 20 | loss: 0.0000008
	speed: 0.0559s/iter; left time: 1851.9385s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 1755.7319s
Epoch: 20 cost time: 22.194006204605103
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000011
	speed: 0.1842s/iter; left time: 6067.0186s
	iters: 200, epoch: 21 | loss: 0.0111517
	speed: 0.0496s/iter; left time: 1627.3131s
	iters: 300, epoch: 21 | loss: 0.0037304
	speed: 0.0530s/iter; left time: 1735.1009s
	iters: 400, epoch: 21 | loss: 0.0000041
	speed: 0.0557s/iter; left time: 1818.7211s
Epoch: 21 cost time: 22.171579360961914
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 723218
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4569821
	speed: 0.0663s/iter; left time: 2730.6684s
	iters: 200, epoch: 1 | loss: 0.2159671
	speed: 0.0434s/iter; left time: 1785.6436s
	iters: 300, epoch: 1 | loss: 0.1889949
	speed: 0.0456s/iter; left time: 1867.9970s
	iters: 400, epoch: 1 | loss: 0.0050965
	speed: 0.0462s/iter; left time: 1891.4789s
Epoch: 1 cost time: 20.900694131851196
Epoch: 1, Steps: 413 | Train Loss: 0.453 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
Validation loss decreased (inf --> -0.978626).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0183507
	speed: 0.1579s/iter; left time: 6441.6729s
	iters: 200, epoch: 2 | loss: 0.0146760
	speed: 0.0486s/iter; left time: 1977.6283s
	iters: 300, epoch: 2 | loss: 0.0090259
	speed: 0.0479s/iter; left time: 1943.2437s
	iters: 400, epoch: 2 | loss: 0.1801960
	speed: 0.0497s/iter; left time: 2010.4222s
Epoch: 2 cost time: 20.223669290542603
Epoch: 2, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.047 Vali Acc: 0.984 Test Loss: 0.047 Test Acc: 0.984
Validation loss decreased (-0.978626 --> -0.983628).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0012536
	speed: 0.1753s/iter; left time: 7078.7838s
	iters: 200, epoch: 3 | loss: 0.0010912
	speed: 0.0470s/iter; left time: 1894.8338s
	iters: 300, epoch: 3 | loss: 0.3126806
	speed: 0.0488s/iter; left time: 1959.3274s
	iters: 400, epoch: 3 | loss: 0.0193848
	speed: 0.0490s/iter; left time: 1965.4537s
Epoch: 3 cost time: 20.40218949317932
Epoch: 3, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.054 Vali Acc: 0.984 Test Loss: 0.054 Test Acc: 0.984
Validation loss decreased (-0.983628 --> -0.984083).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0123615
	speed: 0.1637s/iter; left time: 6542.1971s
	iters: 200, epoch: 4 | loss: 0.0486961
	speed: 0.0463s/iter; left time: 1844.8569s
	iters: 300, epoch: 4 | loss: 0.0084260
	speed: 0.0496s/iter; left time: 1973.5240s
	iters: 400, epoch: 4 | loss: 0.0189777
	speed: 0.0477s/iter; left time: 1890.8842s
Epoch: 4 cost time: 19.999723434448242
Epoch: 4, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0010611
	speed: 0.1619s/iter; left time: 6401.4329s
	iters: 200, epoch: 5 | loss: 0.0571388
	speed: 0.0475s/iter; left time: 1872.6873s
	iters: 300, epoch: 5 | loss: 0.0001538
	speed: 0.0483s/iter; left time: 1900.2798s
	iters: 400, epoch: 5 | loss: 0.0020647
	speed: 0.0491s/iter; left time: 1927.2114s
Epoch: 5 cost time: 20.1126708984375
Epoch: 5, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0356681
	speed: 0.1673s/iter; left time: 6546.7849s
	iters: 200, epoch: 6 | loss: 0.0032665
	speed: 0.0506s/iter; left time: 1975.9980s
	iters: 300, epoch: 6 | loss: 0.0000476
	speed: 0.0475s/iter; left time: 1847.8758s
	iters: 400, epoch: 6 | loss: 0.0000001
	speed: 0.0473s/iter; left time: 1838.0492s
Epoch: 6 cost time: 21.056288480758667
Epoch: 6, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0010285
	speed: 0.1738s/iter; left time: 6728.1586s
	iters: 200, epoch: 7 | loss: 0.0007003
	speed: 0.0510s/iter; left time: 1969.4758s
	iters: 300, epoch: 7 | loss: 0.0759276
	speed: 0.0459s/iter; left time: 1767.6946s
	iters: 400, epoch: 7 | loss: 0.0000660
	speed: 0.0463s/iter; left time: 1779.0316s
Epoch: 7 cost time: 20.095210790634155
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0004204
	speed: 0.1522s/iter; left time: 5829.6148s
	iters: 200, epoch: 8 | loss: 0.0135732
	speed: 0.0487s/iter; left time: 1859.4115s
	iters: 300, epoch: 8 | loss: 0.0000564
	speed: 0.0495s/iter; left time: 1885.4060s
	iters: 400, epoch: 8 | loss: 0.0579469
	speed: 0.0462s/iter; left time: 1756.1146s
Epoch: 8 cost time: 20.036177396774292
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0013421
	speed: 0.1657s/iter; left time: 6279.5267s
	iters: 200, epoch: 9 | loss: 0.0003754
	speed: 0.0443s/iter; left time: 1675.9995s
	iters: 300, epoch: 9 | loss: 0.0000077
	speed: 0.0497s/iter; left time: 1875.1508s
	iters: 400, epoch: 9 | loss: 0.0000804
	speed: 0.0501s/iter; left time: 1883.4889s
Epoch: 9 cost time: 20.341461896896362
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0663556
	speed: 0.1739s/iter; left time: 6520.3345s
	iters: 200, epoch: 10 | loss: 0.0000560
	speed: 0.0486s/iter; left time: 1817.2232s
	iters: 300, epoch: 10 | loss: 0.0004552
	speed: 0.0491s/iter; left time: 1830.6666s
	iters: 400, epoch: 10 | loss: 0.0004572
	speed: 0.0514s/iter; left time: 1911.4794s
Epoch: 10 cost time: 20.908112049102783
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000132
	speed: 0.1638s/iter; left time: 6073.9517s
	iters: 200, epoch: 11 | loss: 0.0011754
	speed: 0.0565s/iter; left time: 2088.5146s
	iters: 300, epoch: 11 | loss: 0.0000749
	speed: 0.0413s/iter; left time: 1522.6486s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0431s/iter; left time: 1584.5432s
Epoch: 11 cost time: 20.235263109207153
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.148 Vali Acc: 0.981 Test Loss: 0.148 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0035415
	speed: 0.1434s/iter; left time: 5256.3401s
	iters: 200, epoch: 12 | loss: 0.0000026
	speed: 0.0474s/iter; left time: 1732.7740s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0466s/iter; left time: 1699.3980s
	iters: 400, epoch: 12 | loss: 0.0063322
	speed: 0.0489s/iter; left time: 1779.3417s
Epoch: 12 cost time: 19.578168392181396
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.1592s/iter; left time: 5768.6885s
	iters: 200, epoch: 13 | loss: 0.0001554
	speed: 0.0464s/iter; left time: 1675.6124s
	iters: 300, epoch: 13 | loss: 0.0720958
	speed: 0.0468s/iter; left time: 1686.7466s
	iters: 400, epoch: 13 | loss: 0.0000264
	speed: 0.0465s/iter; left time: 1672.6272s
Epoch: 13 cost time: 19.620903253555298
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.175 Vali Acc: 0.973 Test Loss: 0.175 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 723218
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2705985
	speed: 0.0703s/iter; left time: 2896.4841s
	iters: 200, epoch: 1 | loss: 0.1126423
	speed: 0.0497s/iter; left time: 2042.2266s
	iters: 300, epoch: 1 | loss: 0.1068211
	speed: 0.0507s/iter; left time: 2079.2341s
	iters: 400, epoch: 1 | loss: 0.1218769
	speed: 0.0533s/iter; left time: 2180.3622s
Epoch: 1 cost time: 23.201035976409912
Epoch: 1, Steps: 413 | Train Loss: 0.393 Vali Loss: 0.084 Vali Acc: 0.971 Test Loss: 0.084 Test Acc: 0.971
Validation loss decreased (inf --> -0.971350).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1390858
	speed: 0.1908s/iter; left time: 7780.4523s
	iters: 200, epoch: 2 | loss: 0.0481824
	speed: 0.0519s/iter; left time: 2113.5047s
	iters: 300, epoch: 2 | loss: 0.0262359
	speed: 0.0506s/iter; left time: 2054.3147s
	iters: 400, epoch: 2 | loss: 0.0181736
	speed: 0.0521s/iter; left time: 2107.4521s
Epoch: 2 cost time: 21.674469709396362
Epoch: 2, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.051 Vali Acc: 0.982 Test Loss: 0.051 Test Acc: 0.982
Validation loss decreased (-0.971350 --> -0.982264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0192229
	speed: 0.1595s/iter; left time: 6440.2893s
	iters: 200, epoch: 3 | loss: 0.1699644
	speed: 0.0534s/iter; left time: 2149.9811s
	iters: 300, epoch: 3 | loss: 0.0067958
	speed: 0.0508s/iter; left time: 2042.4333s
	iters: 400, epoch: 3 | loss: 0.0014790
	speed: 0.0529s/iter; left time: 2120.3448s
Epoch: 3 cost time: 21.954864978790283
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0333874
	speed: 0.1604s/iter; left time: 6410.3904s
	iters: 200, epoch: 4 | loss: 0.0001409
	speed: 0.0590s/iter; left time: 2353.1372s
	iters: 300, epoch: 4 | loss: 0.1779508
	speed: 0.0526s/iter; left time: 2090.8882s
	iters: 400, epoch: 4 | loss: 0.0061803
	speed: 0.0541s/iter; left time: 2146.4858s
Epoch: 4 cost time: 22.798294067382812
Epoch: 4, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.066 Vali Acc: 0.979 Test Loss: 0.066 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0018833
	speed: 0.1813s/iter; left time: 7168.8440s
	iters: 200, epoch: 5 | loss: 0.0098056
	speed: 0.0528s/iter; left time: 2083.6471s
	iters: 300, epoch: 5 | loss: 0.0004029
	speed: 0.0501s/iter; left time: 1972.4964s
	iters: 400, epoch: 5 | loss: 0.0085805
	speed: 0.0438s/iter; left time: 1719.0811s
Epoch: 5 cost time: 20.94116759300232
Epoch: 5, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0115899
	speed: 0.1612s/iter; left time: 6309.4649s
	iters: 200, epoch: 6 | loss: 0.0390357
	speed: 0.0492s/iter; left time: 1922.3382s
	iters: 300, epoch: 6 | loss: 0.0000393
	speed: 0.0514s/iter; left time: 1999.5088s
	iters: 400, epoch: 6 | loss: 0.3544747
	speed: 0.0506s/iter; left time: 1965.3063s
Epoch: 6 cost time: 21.177741765975952
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0007060
	speed: 0.1594s/iter; left time: 6171.3048s
	iters: 200, epoch: 7 | loss: 0.0009136
	speed: 0.0485s/iter; left time: 1872.2883s
	iters: 300, epoch: 7 | loss: 0.0011313
	speed: 0.0501s/iter; left time: 1930.9788s
	iters: 400, epoch: 7 | loss: 0.0003709
	speed: 0.0538s/iter; left time: 2068.3636s
Epoch: 7 cost time: 21.394298553466797
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0002906
	speed: 0.1850s/iter; left time: 7086.0611s
	iters: 200, epoch: 8 | loss: 0.0000018
	speed: 0.0521s/iter; left time: 1991.7481s
	iters: 300, epoch: 8 | loss: 0.0000301
	speed: 0.0507s/iter; left time: 1932.7151s
	iters: 400, epoch: 8 | loss: 0.0016034
	speed: 0.0552s/iter; left time: 2096.3485s
Epoch: 8 cost time: 22.227710247039795
Epoch: 8, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000027
	speed: 0.1710s/iter; left time: 6478.6329s
	iters: 200, epoch: 9 | loss: 0.0000751
	speed: 0.0520s/iter; left time: 1964.7553s
	iters: 300, epoch: 9 | loss: 0.0383300
	speed: 0.0490s/iter; left time: 1848.5574s
	iters: 400, epoch: 9 | loss: 0.0000037
	speed: 0.0522s/iter; left time: 1961.8276s
Epoch: 9 cost time: 21.701812744140625
Epoch: 9, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000096
	speed: 0.1603s/iter; left time: 6009.3160s
	iters: 200, epoch: 10 | loss: 0.0001030
	speed: 0.0517s/iter; left time: 1931.8829s
	iters: 300, epoch: 10 | loss: 0.0000033
	speed: 0.0499s/iter; left time: 1859.5336s
	iters: 400, epoch: 10 | loss: 0.0000039
	speed: 0.0520s/iter; left time: 1933.9100s
Epoch: 10 cost time: 21.722941160202026
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0004364
	speed: 0.1734s/iter; left time: 6428.4114s
	iters: 200, epoch: 11 | loss: 0.0000136
	speed: 0.0527s/iter; left time: 1948.9316s
	iters: 300, epoch: 11 | loss: 0.0090172
	speed: 0.0533s/iter; left time: 1964.4960s
	iters: 400, epoch: 11 | loss: 0.8534575
	speed: 0.0512s/iter; left time: 1882.2491s
Epoch: 11 cost time: 22.078689336776733
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.976 Test Loss: 0.151 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1881s/iter; left time: 6896.0216s
	iters: 200, epoch: 12 | loss: 0.0002513
	speed: 0.0513s/iter; left time: 1874.1864s
	iters: 300, epoch: 12 | loss: 0.0000004
	speed: 0.0506s/iter; left time: 1846.1221s
	iters: 400, epoch: 12 | loss: 0.0348920
	speed: 0.0491s/iter; left time: 1784.8617s
Epoch: 12 cost time: 21.585705995559692
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 461074
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2616558
	speed: 0.0669s/iter; left time: 2755.4348s
	iters: 200, epoch: 1 | loss: 0.1208885
	speed: 0.0531s/iter; left time: 2183.4949s
	iters: 300, epoch: 1 | loss: 0.1215360
	speed: 0.0486s/iter; left time: 1991.2711s
	iters: 400, epoch: 1 | loss: 0.1214470
	speed: 0.0494s/iter; left time: 2020.6224s
Epoch: 1 cost time: 22.5437114238739
Epoch: 1, Steps: 413 | Train Loss: 0.392 Vali Loss: 0.089 Vali Acc: 0.971 Test Loss: 0.089 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0512196
	speed: 0.1844s/iter; left time: 7520.7227s
	iters: 200, epoch: 2 | loss: 0.0763206
	speed: 0.0560s/iter; left time: 2278.9029s
	iters: 300, epoch: 2 | loss: 0.0236443
	speed: 0.0562s/iter; left time: 2282.0393s
	iters: 400, epoch: 2 | loss: 0.0221090
	speed: 0.0543s/iter; left time: 2196.8801s
Epoch: 2 cost time: 23.017072677612305
Epoch: 2, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.046 Vali Acc: 0.983 Test Loss: 0.046 Test Acc: 0.983
Validation loss decreased (-0.970895 --> -0.983174).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0034597
	speed: 0.1759s/iter; left time: 7103.1340s
	iters: 200, epoch: 3 | loss: 0.0276547
	speed: 0.0516s/iter; left time: 2078.9750s
	iters: 300, epoch: 3 | loss: 0.0595804
	speed: 0.0547s/iter; left time: 2197.3208s
	iters: 400, epoch: 3 | loss: 0.0008260
	speed: 0.0512s/iter; left time: 2051.9193s
Epoch: 3 cost time: 22.12361478805542
Epoch: 3, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0039806
	speed: 0.1647s/iter; left time: 6582.2723s
	iters: 200, epoch: 4 | loss: 0.0005321
	speed: 0.0486s/iter; left time: 1935.7863s
	iters: 300, epoch: 4 | loss: 0.1788280
	speed: 0.0517s/iter; left time: 2057.4478s
	iters: 400, epoch: 4 | loss: 0.0188541
	speed: 0.0504s/iter; left time: 2000.4574s
Epoch: 4 cost time: 21.482303857803345
Epoch: 4, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0021273
	speed: 0.1777s/iter; left time: 7026.0152s
	iters: 200, epoch: 5 | loss: 0.1156381
	speed: 0.0530s/iter; left time: 2092.4043s
	iters: 300, epoch: 5 | loss: 0.0005520
	speed: 0.0522s/iter; left time: 2054.5406s
	iters: 400, epoch: 5 | loss: 0.0048344
	speed: 0.0551s/iter; left time: 2162.2001s
Epoch: 5 cost time: 22.483391284942627
Epoch: 5, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0001327
	speed: 0.1925s/iter; left time: 7534.7944s
	iters: 200, epoch: 6 | loss: 0.0201007
	speed: 0.0515s/iter; left time: 2011.3521s
	iters: 300, epoch: 6 | loss: 0.0003675
	speed: 0.0523s/iter; left time: 2035.2365s
	iters: 400, epoch: 6 | loss: 0.0067301
	speed: 0.0532s/iter; left time: 2066.3684s
Epoch: 6 cost time: 22.08187198638916
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1419696
	speed: 0.1631s/iter; left time: 6317.5115s
	iters: 200, epoch: 7 | loss: 0.0001120
	speed: 0.0511s/iter; left time: 1972.4183s
	iters: 300, epoch: 7 | loss: 0.0007352
	speed: 0.0498s/iter; left time: 1918.5191s
	iters: 400, epoch: 7 | loss: 0.0021057
	speed: 0.0507s/iter; left time: 1947.5667s
Epoch: 7 cost time: 21.331049919128418
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0063256
	speed: 0.1694s/iter; left time: 6489.9731s
	iters: 200, epoch: 8 | loss: 0.0089975
	speed: 0.0555s/iter; left time: 2120.2486s
	iters: 300, epoch: 8 | loss: 0.5281416
	speed: 0.0526s/iter; left time: 2002.8458s
	iters: 400, epoch: 8 | loss: 0.0052242
	speed: 0.0514s/iter; left time: 1952.2064s
Epoch: 8 cost time: 22.710447549819946
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0007088
	speed: 0.1912s/iter; left time: 7247.0744s
	iters: 200, epoch: 9 | loss: 0.0000175
	speed: 0.0514s/iter; left time: 1941.1832s
	iters: 300, epoch: 9 | loss: 0.0004370
	speed: 0.0514s/iter; left time: 1936.1748s
	iters: 400, epoch: 9 | loss: 0.0000198
	speed: 0.0510s/iter; left time: 1918.1336s
Epoch: 9 cost time: 21.98875117301941
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000371
	speed: 0.1661s/iter; left time: 6226.8128s
	iters: 200, epoch: 10 | loss: 0.0000165
	speed: 0.0500s/iter; left time: 1870.0776s
	iters: 300, epoch: 10 | loss: 0.0000002
	speed: 0.0501s/iter; left time: 1867.6714s
	iters: 400, epoch: 10 | loss: 0.0004070
	speed: 0.0491s/iter; left time: 1826.4702s
Epoch: 10 cost time: 21.18970775604248
Epoch: 10, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0176216
	speed: 0.1603s/iter; left time: 5942.6038s
	iters: 200, epoch: 11 | loss: 0.0000646
	speed: 0.0513s/iter; left time: 1895.3845s
	iters: 300, epoch: 11 | loss: 0.0000199
	speed: 0.0548s/iter; left time: 2020.4900s
	iters: 400, epoch: 11 | loss: 0.0036373
	speed: 0.0517s/iter; left time: 1899.5837s
Epoch: 11 cost time: 21.925753355026245
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1782s/iter; left time: 6532.3318s
	iters: 200, epoch: 12 | loss: 0.0000132
	speed: 0.0485s/iter; left time: 1774.4115s
	iters: 300, epoch: 12 | loss: 0.0000114
	speed: 0.0514s/iter; left time: 1872.2544s
	iters: 400, epoch: 12 | loss: 0.1156424
	speed: 0.0494s/iter; left time: 1796.3911s
Epoch: 12 cost time: 20.89745831489563
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 461074
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2902953
	speed: 0.0664s/iter; left time: 2734.8490s
	iters: 200, epoch: 1 | loss: 0.1074343
	speed: 0.0484s/iter; left time: 1989.2232s
	iters: 300, epoch: 1 | loss: 0.1476852
	speed: 0.0503s/iter; left time: 2061.7912s
	iters: 400, epoch: 1 | loss: 0.1232302
	speed: 0.0514s/iter; left time: 2100.6776s
Epoch: 1 cost time: 22.431593894958496
Epoch: 1, Steps: 413 | Train Loss: 0.401 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
Validation loss decreased (inf --> -0.974533).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0540984
	speed: 0.1698s/iter; left time: 6926.1247s
	iters: 200, epoch: 2 | loss: 0.0827758
	speed: 0.0513s/iter; left time: 2086.7578s
	iters: 300, epoch: 2 | loss: 0.0150412
	speed: 0.0497s/iter; left time: 2017.4316s
	iters: 400, epoch: 2 | loss: 0.0220185
	speed: 0.0505s/iter; left time: 2043.6403s
Epoch: 2 cost time: 21.427215099334717
Epoch: 2, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.039 Vali Acc: 0.989 Test Loss: 0.039 Test Acc: 0.989
Validation loss decreased (-0.974533 --> -0.988631).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0123402
	speed: 0.1719s/iter; left time: 6939.6846s
	iters: 200, epoch: 3 | loss: 0.1046017
	speed: 0.0481s/iter; left time: 1936.4965s
	iters: 300, epoch: 3 | loss: 0.0245676
	speed: 0.0452s/iter; left time: 1815.0773s
	iters: 400, epoch: 3 | loss: 0.0090727
	speed: 0.0492s/iter; left time: 1972.2774s
Epoch: 3 cost time: 20.425326347351074
Epoch: 3, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0004012
	speed: 0.1642s/iter; left time: 6560.5142s
	iters: 200, epoch: 4 | loss: 0.0023066
	speed: 0.0487s/iter; left time: 1941.9801s
	iters: 300, epoch: 4 | loss: 0.0299078
	speed: 0.0452s/iter; left time: 1798.8162s
	iters: 400, epoch: 4 | loss: 0.0319135
	speed: 0.0472s/iter; left time: 1873.4924s
Epoch: 4 cost time: 20.35178232192993
Epoch: 4, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0006072
	speed: 0.1558s/iter; left time: 6161.1520s
	iters: 200, epoch: 5 | loss: 0.0620524
	speed: 0.0496s/iter; left time: 1955.7376s
	iters: 300, epoch: 5 | loss: 0.0009000
	speed: 0.0484s/iter; left time: 1905.5110s
	iters: 400, epoch: 5 | loss: 0.0015929
	speed: 0.0474s/iter; left time: 1861.0316s
Epoch: 5 cost time: 20.491243600845337
Epoch: 5, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000926
	speed: 0.1752s/iter; left time: 6857.9098s
	iters: 200, epoch: 6 | loss: 0.1389067
	speed: 0.0538s/iter; left time: 2099.6786s
	iters: 300, epoch: 6 | loss: 0.0001992
	speed: 0.0533s/iter; left time: 2073.5298s
	iters: 400, epoch: 6 | loss: 0.0143892
	speed: 0.0509s/iter; left time: 1975.6006s
Epoch: 6 cost time: 21.605209350585938
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000783
	speed: 0.1610s/iter; left time: 6233.0747s
	iters: 200, epoch: 7 | loss: 0.0008126
	speed: 0.0504s/iter; left time: 1944.8499s
	iters: 300, epoch: 7 | loss: 0.0229723
	speed: 0.0506s/iter; left time: 1948.5481s
	iters: 400, epoch: 7 | loss: 0.1756235
	speed: 0.0500s/iter; left time: 1922.7259s
Epoch: 7 cost time: 21.10484528541565
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0313355
	speed: 0.1635s/iter; left time: 6264.4589s
	iters: 200, epoch: 8 | loss: 0.0001368
	speed: 0.0487s/iter; left time: 1861.6162s
	iters: 300, epoch: 8 | loss: 0.0000452
	speed: 0.0483s/iter; left time: 1840.7078s
	iters: 400, epoch: 8 | loss: 0.0001806
	speed: 0.0458s/iter; left time: 1740.3742s
Epoch: 8 cost time: 20.20746684074402
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000937
	speed: 0.1672s/iter; left time: 6337.1573s
	iters: 200, epoch: 9 | loss: 0.0008100
	speed: 0.0483s/iter; left time: 1825.1796s
	iters: 300, epoch: 9 | loss: 0.0000432
	speed: 0.0501s/iter; left time: 1890.2839s
	iters: 400, epoch: 9 | loss: 0.2402508
	speed: 0.0564s/iter; left time: 2119.4550s
Epoch: 9 cost time: 22.02849054336548
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000060
	speed: 0.1764s/iter; left time: 6613.1190s
	iters: 200, epoch: 10 | loss: 0.0038089
	speed: 0.0482s/iter; left time: 1801.8975s
	iters: 300, epoch: 10 | loss: 0.0000176
	speed: 0.0482s/iter; left time: 1796.4008s
	iters: 400, epoch: 10 | loss: 0.0001249
	speed: 0.0507s/iter; left time: 1885.0940s
Epoch: 10 cost time: 20.941190719604492
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.156 Vali Acc: 0.971 Test Loss: 0.156 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0003806
	speed: 0.1661s/iter; left time: 6157.6213s
	iters: 200, epoch: 11 | loss: 0.0000677
	speed: 0.0510s/iter; left time: 1884.2384s
	iters: 300, epoch: 11 | loss: 0.0001765
	speed: 0.0491s/iter; left time: 1811.1787s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.0490s/iter; left time: 1800.2756s
Epoch: 11 cost time: 20.98898959159851
Epoch: 11, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1604s/iter; left time: 5879.2096s
	iters: 200, epoch: 12 | loss: 0.0001050
	speed: 0.0531s/iter; left time: 1941.2264s
	iters: 300, epoch: 12 | loss: 0.0000009
	speed: 0.0518s/iter; left time: 1889.7660s
	iters: 400, epoch: 12 | loss: 0.0000047
	speed: 0.0473s/iter; left time: 1718.8007s
Epoch: 12 cost time: 21.413079261779785
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 461074
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3996410
	speed: 0.0679s/iter; left time: 2797.1997s
	iters: 200, epoch: 1 | loss: 0.1267007
	speed: 0.0474s/iter; left time: 1946.9941s
	iters: 300, epoch: 1 | loss: 0.1639413
	speed: 0.0488s/iter; left time: 2000.7511s
	iters: 400, epoch: 1 | loss: 0.0964003
	speed: 0.0488s/iter; left time: 1994.3068s
Epoch: 1 cost time: 22.03193497657776
Epoch: 1, Steps: 413 | Train Loss: 0.450 Vali Loss: 0.055 Vali Acc: 0.988 Test Loss: 0.055 Test Acc: 0.988
Validation loss decreased (inf --> -0.987721).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0067953
	speed: 0.1630s/iter; left time: 6648.3029s
	iters: 200, epoch: 2 | loss: 0.0654444
	speed: 0.0468s/iter; left time: 1905.2827s
	iters: 300, epoch: 2 | loss: 0.0143074
	speed: 0.0470s/iter; left time: 1909.0726s
	iters: 400, epoch: 2 | loss: 0.0226696
	speed: 0.0484s/iter; left time: 1958.2605s
Epoch: 2 cost time: 20.017796993255615
Epoch: 2, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.034 Vali Acc: 0.989 Test Loss: 0.034 Test Acc: 0.989
Validation loss decreased (-0.987721 --> -0.989086).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0086537
	speed: 0.1739s/iter; left time: 7023.2089s
	iters: 200, epoch: 3 | loss: 0.1163033
	speed: 0.0503s/iter; left time: 2026.3078s
	iters: 300, epoch: 3 | loss: 0.0006093
	speed: 0.0471s/iter; left time: 1894.1714s
	iters: 400, epoch: 3 | loss: 0.0016033
	speed: 0.0509s/iter; left time: 2040.9879s
Epoch: 3 cost time: 20.996365547180176
Epoch: 3, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.033 Vali Acc: 0.989 Test Loss: 0.033 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0001994
	speed: 0.1757s/iter; left time: 7023.2581s
	iters: 200, epoch: 4 | loss: 0.0016661
	speed: 0.0471s/iter; left time: 1878.3142s
	iters: 300, epoch: 4 | loss: 0.0029239
	speed: 0.0493s/iter; left time: 1960.2766s
	iters: 400, epoch: 4 | loss: 0.0066222
	speed: 0.0511s/iter; left time: 2028.6886s
Epoch: 4 cost time: 20.255141496658325
Epoch: 4, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0008348
	speed: 0.1677s/iter; left time: 6630.9383s
	iters: 200, epoch: 5 | loss: 0.0068062
	speed: 0.0505s/iter; left time: 1994.0035s
	iters: 300, epoch: 5 | loss: 0.0023736
	speed: 0.0481s/iter; left time: 1891.7028s
	iters: 400, epoch: 5 | loss: 0.5456994
	speed: 0.0475s/iter; left time: 1864.3808s
Epoch: 5 cost time: 20.567568063735962
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0036900
	speed: 0.1628s/iter; left time: 6372.8481s
	iters: 200, epoch: 6 | loss: 0.0000470
	speed: 0.0534s/iter; left time: 2082.7246s
	iters: 300, epoch: 6 | loss: 0.0000385
	speed: 0.0505s/iter; left time: 1965.5371s
	iters: 400, epoch: 6 | loss: 0.0138827
	speed: 0.0498s/iter; left time: 1934.1955s
Epoch: 6 cost time: 21.47036337852478
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0004196
	speed: 0.1738s/iter; left time: 6729.2642s
	iters: 200, epoch: 7 | loss: 0.0205443
	speed: 0.0490s/iter; left time: 1892.0464s
	iters: 300, epoch: 7 | loss: 0.0017269
	speed: 0.0468s/iter; left time: 1804.2057s
	iters: 400, epoch: 7 | loss: 0.0002774
	speed: 0.0499s/iter; left time: 1916.8916s
Epoch: 7 cost time: 20.406067371368408
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000162
	speed: 0.1611s/iter; left time: 6169.8885s
	iters: 200, epoch: 8 | loss: 0.0001650
	speed: 0.0492s/iter; left time: 1878.2141s
	iters: 300, epoch: 8 | loss: 0.0000054
	speed: 0.0479s/iter; left time: 1823.7515s
	iters: 400, epoch: 8 | loss: 0.0003518
	speed: 0.0467s/iter; left time: 1773.7929s
Epoch: 8 cost time: 20.328957080841064
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000217
	speed: 0.1634s/iter; left time: 6190.6540s
	iters: 200, epoch: 9 | loss: 0.2380359
	speed: 0.0480s/iter; left time: 1813.6473s
	iters: 300, epoch: 9 | loss: 0.1426806
	speed: 0.0467s/iter; left time: 1759.5335s
	iters: 400, epoch: 9 | loss: 0.0043064
	speed: 0.0499s/iter; left time: 1877.0293s
Epoch: 9 cost time: 20.323278188705444
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0002528
	speed: 0.1747s/iter; left time: 6546.9357s
	iters: 200, epoch: 10 | loss: 0.0002486
	speed: 0.0502s/iter; left time: 1875.7702s
	iters: 300, epoch: 10 | loss: 0.0000021
	speed: 0.0521s/iter; left time: 1940.9471s
	iters: 400, epoch: 10 | loss: 0.0000724
	speed: 0.0520s/iter; left time: 1934.3448s
Epoch: 10 cost time: 21.20102858543396
Epoch: 10, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1612s/iter; left time: 5976.2243s
	iters: 200, epoch: 11 | loss: 0.0000076
	speed: 0.0471s/iter; left time: 1739.9627s
	iters: 300, epoch: 11 | loss: 0.0000312
	speed: 0.0467s/iter; left time: 1721.0661s
	iters: 400, epoch: 11 | loss: 0.0000257
	speed: 0.0489s/iter; left time: 1799.2650s
Epoch: 11 cost time: 19.89717435836792
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0033314
	speed: 0.1696s/iter; left time: 6215.4925s
	iters: 200, epoch: 12 | loss: 0.0067643
	speed: 0.0464s/iter; left time: 1697.9868s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 1781.5091s
	iters: 400, epoch: 12 | loss: 0.0000015
	speed: 0.0492s/iter; left time: 1787.7551s
Epoch: 12 cost time: 20.26574420928955
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 461074
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2207566
	speed: 0.0719s/iter; left time: 2962.4555s
	iters: 200, epoch: 1 | loss: 0.0645963
	speed: 0.0566s/iter; left time: 2327.3583s
	iters: 300, epoch: 1 | loss: 0.0388796
	speed: 0.0515s/iter; left time: 2113.3838s
	iters: 400, epoch: 1 | loss: 0.2583435
	speed: 0.0485s/iter; left time: 1983.7264s
Epoch: 1 cost time: 23.575368404388428
Epoch: 1, Steps: 413 | Train Loss: 0.403 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (inf --> -0.978626).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0080004
	speed: 0.1620s/iter; left time: 6609.4548s
	iters: 200, epoch: 2 | loss: 0.0119597
	speed: 0.0534s/iter; left time: 2172.9080s
	iters: 300, epoch: 2 | loss: 0.0340779
	speed: 0.0547s/iter; left time: 2221.5162s
	iters: 400, epoch: 2 | loss: 0.0089323
	speed: 0.0517s/iter; left time: 2093.1192s
Epoch: 2 cost time: 22.13478922843933
Epoch: 2, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.050 Vali Acc: 0.985 Test Loss: 0.050 Test Acc: 0.985
Validation loss decreased (-0.978626 --> -0.984538).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0073722
	speed: 0.1682s/iter; left time: 6789.5423s
	iters: 200, epoch: 3 | loss: 0.0002297
	speed: 0.0520s/iter; left time: 2096.2575s
	iters: 300, epoch: 3 | loss: 0.0027297
	speed: 0.0539s/iter; left time: 2164.2056s
	iters: 400, epoch: 3 | loss: 0.0411502
	speed: 0.0502s/iter; left time: 2013.2602s
Epoch: 3 cost time: 21.905935764312744
Epoch: 3, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0106895
	speed: 0.1840s/iter; left time: 7353.2732s
	iters: 200, epoch: 4 | loss: 0.1130492
	speed: 0.0498s/iter; left time: 1983.1664s
	iters: 300, epoch: 4 | loss: 0.2518422
	speed: 0.0553s/iter; left time: 2200.2244s
	iters: 400, epoch: 4 | loss: 0.0005113
	speed: 0.0523s/iter; left time: 2074.1980s
Epoch: 4 cost time: 22.217411041259766
Epoch: 4, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.0193430
	speed: 0.1755s/iter; left time: 6940.7521s
	iters: 200, epoch: 5 | loss: 0.0147097
	speed: 0.0498s/iter; left time: 1963.8051s
	iters: 300, epoch: 5 | loss: 0.0004440
	speed: 0.0524s/iter; left time: 2063.3020s
	iters: 400, epoch: 5 | loss: 0.0116363
	speed: 0.0457s/iter; left time: 1792.6559s
Epoch: 5 cost time: 20.966315031051636
Epoch: 5, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000889
	speed: 0.1512s/iter; left time: 5915.4172s
	iters: 200, epoch: 6 | loss: 0.0015958
	speed: 0.0489s/iter; left time: 1909.6109s
	iters: 300, epoch: 6 | loss: 0.0006095
	speed: 0.0490s/iter; left time: 1908.6848s
	iters: 400, epoch: 6 | loss: 0.0004844
	speed: 0.0503s/iter; left time: 1952.9965s
Epoch: 6 cost time: 21.02711033821106
Epoch: 6, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0008118
	speed: 0.1741s/iter; left time: 6741.5337s
	iters: 200, epoch: 7 | loss: 0.0000504
	speed: 0.0583s/iter; left time: 2252.8171s
	iters: 300, epoch: 7 | loss: 0.0007780
	speed: 0.0497s/iter; left time: 1915.4607s
	iters: 400, epoch: 7 | loss: 0.6480674
	speed: 0.0479s/iter; left time: 1841.2232s
Epoch: 7 cost time: 21.904428482055664
Epoch: 7, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0413536
	speed: 0.1761s/iter; left time: 6745.3709s
	iters: 200, epoch: 8 | loss: 0.0017281
	speed: 0.0510s/iter; left time: 1949.4808s
	iters: 300, epoch: 8 | loss: 0.0001461
	speed: 0.0505s/iter; left time: 1926.2840s
	iters: 400, epoch: 8 | loss: 0.1107537
	speed: 0.0506s/iter; left time: 1921.6004s
Epoch: 8 cost time: 21.309001684188843
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0449424
	speed: 0.1629s/iter; left time: 6171.5864s
	iters: 200, epoch: 9 | loss: 0.0002067
	speed: 0.0523s/iter; left time: 1976.1671s
	iters: 300, epoch: 9 | loss: 0.0000716
	speed: 0.0528s/iter; left time: 1989.0873s
	iters: 400, epoch: 9 | loss: 0.0001696
	speed: 0.0493s/iter; left time: 1853.4517s
Epoch: 9 cost time: 21.641719102859497
Epoch: 9, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0001152
	speed: 0.1687s/iter; left time: 6322.0881s
	iters: 200, epoch: 10 | loss: 0.0001608
	speed: 0.0522s/iter; left time: 1952.4985s
	iters: 300, epoch: 10 | loss: 0.0003843
	speed: 0.0536s/iter; left time: 1999.0188s
	iters: 400, epoch: 10 | loss: 0.0002055
	speed: 0.0502s/iter; left time: 1866.2122s
Epoch: 10 cost time: 21.50938105583191
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000391
	speed: 0.1749s/iter; left time: 6482.3295s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0516s/iter; left time: 1908.2636s
	iters: 300, epoch: 11 | loss: 0.0000022
	speed: 0.0520s/iter; left time: 1916.3620s
	iters: 400, epoch: 11 | loss: 0.0459639
	speed: 0.0483s/iter; left time: 1775.8105s
Epoch: 11 cost time: 21.370849132537842
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.984 Test Loss: 0.104 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.1656s/iter; left time: 6069.7216s
	iters: 200, epoch: 12 | loss: 0.0002172
	speed: 0.0510s/iter; left time: 1864.4750s
	iters: 300, epoch: 12 | loss: 0.0000007
	speed: 0.0521s/iter; left time: 1900.7219s
	iters: 400, epoch: 12 | loss: 0.0629686
	speed: 0.0524s/iter; left time: 1905.6261s
Epoch: 12 cost time: 21.81257939338684
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 330002
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2322998
	speed: 0.0731s/iter; left time: 3009.8573s
	iters: 200, epoch: 1 | loss: 0.0683833
	speed: 0.0507s/iter; left time: 2082.5561s
	iters: 300, epoch: 1 | loss: 0.0372777
	speed: 0.0502s/iter; left time: 2059.8720s
	iters: 400, epoch: 1 | loss: 0.2465095
	speed: 0.0521s/iter; left time: 2131.2524s
Epoch: 1 cost time: 23.443074941635132
Epoch: 1, Steps: 413 | Train Loss: 0.400 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (inf --> -0.977262).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0109737
	speed: 0.1743s/iter; left time: 7109.4146s
	iters: 200, epoch: 2 | loss: 0.0059575
	speed: 0.0493s/iter; left time: 2005.9305s
	iters: 300, epoch: 2 | loss: 0.0229949
	speed: 0.0505s/iter; left time: 2047.7476s
	iters: 400, epoch: 2 | loss: 0.0077863
	speed: 0.0521s/iter; left time: 2107.6713s
Epoch: 2 cost time: 21.276453733444214
Epoch: 2, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.048 Vali Acc: 0.984 Test Loss: 0.048 Test Acc: 0.984
Validation loss decreased (-0.977262 --> -0.984083).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0041791
	speed: 0.1701s/iter; left time: 6866.1922s
	iters: 200, epoch: 3 | loss: 0.0001454
	speed: 0.0515s/iter; left time: 2073.0021s
	iters: 300, epoch: 3 | loss: 0.0018010
	speed: 0.0499s/iter; left time: 2003.6705s
	iters: 400, epoch: 3 | loss: 0.0004144
	speed: 0.0506s/iter; left time: 2027.3227s
Epoch: 3 cost time: 21.29741334915161
Epoch: 3, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0299280
	speed: 0.1638s/iter; left time: 6545.6741s
	iters: 200, epoch: 4 | loss: 0.0315566
	speed: 0.0531s/iter; left time: 2117.1142s
	iters: 300, epoch: 4 | loss: 0.0008664
	speed: 0.0500s/iter; left time: 1986.5495s
	iters: 400, epoch: 4 | loss: 0.0173557
	speed: 0.0498s/iter; left time: 1975.9351s
Epoch: 4 cost time: 21.035139322280884
Epoch: 4, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1173522
	speed: 0.1739s/iter; left time: 6875.8081s
	iters: 200, epoch: 5 | loss: 0.2167785
	speed: 0.0508s/iter; left time: 2003.2962s
	iters: 300, epoch: 5 | loss: 0.0005303
	speed: 0.0505s/iter; left time: 1986.2271s
	iters: 400, epoch: 5 | loss: 0.0005534
	speed: 0.0480s/iter; left time: 1883.3791s
Epoch: 5 cost time: 21.043088674545288
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0023767
	speed: 0.1619s/iter; left time: 6335.8679s
	iters: 200, epoch: 6 | loss: 0.0752702
	speed: 0.0491s/iter; left time: 1915.6219s
	iters: 300, epoch: 6 | loss: 0.0007060
	speed: 0.0512s/iter; left time: 1994.4195s
	iters: 400, epoch: 6 | loss: 0.0000850
	speed: 0.0488s/iter; left time: 1895.4435s
Epoch: 6 cost time: 20.97313666343689
Epoch: 6, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0123904
	speed: 0.1636s/iter; left time: 6336.4563s
	iters: 200, epoch: 7 | loss: 0.0000048
	speed: 0.0505s/iter; left time: 1948.8727s
	iters: 300, epoch: 7 | loss: 0.0001971
	speed: 0.0505s/iter; left time: 1946.2156s
	iters: 400, epoch: 7 | loss: 0.0010891
	speed: 0.0555s/iter; left time: 2134.2404s
Epoch: 7 cost time: 21.996742010116577
Epoch: 7, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0001653
	speed: 0.1752s/iter; left time: 6711.3120s
	iters: 200, epoch: 8 | loss: 0.1431637
	speed: 0.0492s/iter; left time: 1879.8114s
	iters: 300, epoch: 8 | loss: 0.0002972
	speed: 0.0485s/iter; left time: 1847.0532s
	iters: 400, epoch: 8 | loss: 0.0064947
	speed: 0.0552s/iter; left time: 2099.4119s
Epoch: 8 cost time: 21.5082790851593
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0031315
	speed: 0.1598s/iter; left time: 6055.2767s
	iters: 200, epoch: 9 | loss: 0.0001176
	speed: 0.0518s/iter; left time: 1958.4692s
	iters: 300, epoch: 9 | loss: 0.0000645
	speed: 0.0489s/iter; left time: 1842.6207s
	iters: 400, epoch: 9 | loss: 0.0000655
	speed: 0.0512s/iter; left time: 1924.6886s
Epoch: 9 cost time: 21.48171353340149
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.1716s/iter; left time: 6432.6018s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.0508s/iter; left time: 1898.9619s
	iters: 300, epoch: 10 | loss: 0.1024896
	speed: 0.0501s/iter; left time: 1867.9544s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0480s/iter; left time: 1783.9050s
Epoch: 10 cost time: 21.007242441177368
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.979 Test Loss: 0.116 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1306435
	speed: 0.1732s/iter; left time: 6421.7634s
	iters: 200, epoch: 11 | loss: 0.0001990
	speed: 0.0524s/iter; left time: 1937.5010s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 1748.8460s
	iters: 400, epoch: 11 | loss: 0.0000285
	speed: 0.0500s/iter; left time: 1839.6957s
Epoch: 11 cost time: 21.086669921875
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000202
	speed: 0.1787s/iter; left time: 6550.4743s
	iters: 200, epoch: 12 | loss: 0.1217212
	speed: 0.0482s/iter; left time: 1763.8047s
	iters: 300, epoch: 12 | loss: 0.0000003
	speed: 0.0450s/iter; left time: 1640.5782s
	iters: 400, epoch: 12 | loss: 0.0000830
	speed: 0.0455s/iter; left time: 1655.5031s
Epoch: 12 cost time: 19.609700679779053
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 330002
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2604133
	speed: 0.0672s/iter; left time: 2767.1298s
	iters: 200, epoch: 1 | loss: 0.0854662
	speed: 0.0497s/iter; left time: 2041.3118s
	iters: 300, epoch: 1 | loss: 0.0314179
	speed: 0.0500s/iter; left time: 2048.8509s
	iters: 400, epoch: 1 | loss: 0.2141940
	speed: 0.0526s/iter; left time: 2152.9830s
Epoch: 1 cost time: 22.703861236572266
Epoch: 1, Steps: 413 | Train Loss: 0.409 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
Validation loss decreased (inf --> -0.978626).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0106264
	speed: 0.1749s/iter; left time: 7135.7969s
	iters: 200, epoch: 2 | loss: 0.0023234
	speed: 0.0491s/iter; left time: 1998.9275s
	iters: 300, epoch: 2 | loss: 0.0761630
	speed: 0.0573s/iter; left time: 2324.3995s
	iters: 400, epoch: 2 | loss: 0.0081385
	speed: 0.0525s/iter; left time: 2127.4828s
Epoch: 2 cost time: 21.701818704605103
Epoch: 2, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.051 Vali Acc: 0.979 Test Loss: 0.051 Test Acc: 0.979
Validation loss decreased (-0.978626 --> -0.978626).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0071574
	speed: 0.1638s/iter; left time: 6612.9055s
	iters: 200, epoch: 3 | loss: 0.0014766
	speed: 0.0506s/iter; left time: 2039.6727s
	iters: 300, epoch: 3 | loss: 0.0001681
	speed: 0.0501s/iter; left time: 2014.1388s
	iters: 400, epoch: 3 | loss: 0.0710214
	speed: 0.0491s/iter; left time: 1968.3696s
Epoch: 3 cost time: 21.125246047973633
Epoch: 3, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.065 Vali Acc: 0.979 Test Loss: 0.065 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0063913
	speed: 0.1668s/iter; left time: 6666.1720s
	iters: 200, epoch: 4 | loss: 0.0032502
	speed: 0.0474s/iter; left time: 1889.3274s
	iters: 300, epoch: 4 | loss: 0.0009592
	speed: 0.0476s/iter; left time: 1891.9221s
	iters: 400, epoch: 4 | loss: 0.0033218
	speed: 0.0518s/iter; left time: 2053.8408s
Epoch: 4 cost time: 20.663873195648193
Epoch: 4, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1978689
	speed: 0.1806s/iter; left time: 7144.3929s
	iters: 200, epoch: 5 | loss: 0.0007380
	speed: 0.0494s/iter; left time: 1947.8304s
	iters: 300, epoch: 5 | loss: 0.0002199
	speed: 0.0494s/iter; left time: 1943.5783s
	iters: 400, epoch: 5 | loss: 0.0087456
	speed: 0.0522s/iter; left time: 2047.7244s
Epoch: 5 cost time: 21.611623764038086
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0021612
	speed: 0.1760s/iter; left time: 6887.4942s
	iters: 200, epoch: 6 | loss: 0.0857012
	speed: 0.0474s/iter; left time: 1848.6138s
	iters: 300, epoch: 6 | loss: 0.2955292
	speed: 0.0478s/iter; left time: 1861.0455s
	iters: 400, epoch: 6 | loss: 0.0003678
	speed: 0.0483s/iter; left time: 1877.4864s
Epoch: 6 cost time: 20.418238878250122
Epoch: 6, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0082008
	speed: 0.1639s/iter; left time: 6347.9086s
	iters: 200, epoch: 7 | loss: 0.0000225
	speed: 0.0498s/iter; left time: 1924.3838s
	iters: 300, epoch: 7 | loss: 0.0003508
	speed: 0.0475s/iter; left time: 1830.4712s
	iters: 400, epoch: 7 | loss: 0.0000930
	speed: 0.0473s/iter; left time: 1817.0504s
Epoch: 7 cost time: 20.111088514328003
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.042 Vali Acc: 0.987 Test Loss: 0.042 Test Acc: 0.987
Validation loss decreased (-0.978626 --> -0.986812).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0760699
	speed: 0.1459s/iter; left time: 5590.2610s
	iters: 200, epoch: 8 | loss: 0.0013809
	speed: 0.0485s/iter; left time: 1854.4623s
	iters: 300, epoch: 8 | loss: 0.0906747
	speed: 0.0455s/iter; left time: 1735.3933s
	iters: 400, epoch: 8 | loss: 0.0356320
	speed: 0.0479s/iter; left time: 1821.9032s
Epoch: 8 cost time: 19.410156965255737
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.045 Vali Acc: 0.990 Test Loss: 0.045 Test Acc: 0.990
Validation loss decreased (-0.986812 --> -0.989540).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0040814
	speed: 0.1780s/iter; left time: 6744.2655s
	iters: 200, epoch: 9 | loss: 0.0000136
	speed: 0.0525s/iter; left time: 1984.4453s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0497s/iter; left time: 1874.2165s
	iters: 400, epoch: 9 | loss: 0.0000062
	speed: 0.0516s/iter; left time: 1941.4431s
Epoch: 9 cost time: 22.052613973617554
Epoch: 9, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000143
	speed: 0.1653s/iter; left time: 6194.5505s
	iters: 200, epoch: 10 | loss: 0.0007084
	speed: 0.0374s/iter; left time: 1400.0120s
	iters: 300, epoch: 10 | loss: 0.0001246
	speed: 0.0398s/iter; left time: 1483.1378s
	iters: 400, epoch: 10 | loss: 0.0000085
	speed: 0.0460s/iter; left time: 1709.3328s
Epoch: 10 cost time: 17.689281702041626
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0031602
	speed: 0.1661s/iter; left time: 6157.0793s
	iters: 200, epoch: 11 | loss: 0.0000717
	speed: 0.0475s/iter; left time: 1755.7518s
	iters: 300, epoch: 11 | loss: 0.0000002
	speed: 0.0507s/iter; left time: 1868.2959s
	iters: 400, epoch: 11 | loss: 0.2440547
	speed: 0.0491s/iter; left time: 1804.8556s
Epoch: 11 cost time: 20.582027673721313
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000024
	speed: 0.1534s/iter; left time: 5622.3447s
	iters: 200, epoch: 12 | loss: 0.0006967
	speed: 0.0470s/iter; left time: 1717.2278s
	iters: 300, epoch: 12 | loss: 0.0318506
	speed: 0.0503s/iter; left time: 1834.5048s
	iters: 400, epoch: 12 | loss: 0.0000002
	speed: 0.0486s/iter; left time: 1766.4956s
Epoch: 12 cost time: 20.307442903518677
Epoch: 12, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1809s/iter; left time: 6558.0991s
	iters: 200, epoch: 13 | loss: 0.0009002
	speed: 0.0483s/iter; left time: 1745.5419s
	iters: 300, epoch: 13 | loss: 0.0000669
	speed: 0.0494s/iter; left time: 1779.5735s
	iters: 400, epoch: 13 | loss: 0.0000046
	speed: 0.0491s/iter; left time: 1764.2754s
Epoch: 13 cost time: 20.83183789253235
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1699s/iter; left time: 6086.8932s
	iters: 200, epoch: 14 | loss: 0.0000010
	speed: 0.0500s/iter; left time: 1788.1804s
	iters: 300, epoch: 14 | loss: 0.0009314
	speed: 0.0455s/iter; left time: 1619.5425s
	iters: 400, epoch: 14 | loss: 0.0000029
	speed: 0.0518s/iter; left time: 1838.9477s
Epoch: 14 cost time: 20.681199550628662
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000006
	speed: 0.1738s/iter; left time: 6154.8474s
	iters: 200, epoch: 15 | loss: 0.0003147
	speed: 0.0488s/iter; left time: 1723.7911s
	iters: 300, epoch: 15 | loss: 0.0000004
	speed: 0.0480s/iter; left time: 1689.2544s
	iters: 400, epoch: 15 | loss: 0.0000207
	speed: 0.0524s/iter; left time: 1841.8801s
Epoch: 15 cost time: 21.32794499397278
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000412
	speed: 0.1677s/iter; left time: 5871.0688s
	iters: 200, epoch: 16 | loss: 0.0000020
	speed: 0.0514s/iter; left time: 1794.4828s
	iters: 300, epoch: 16 | loss: 0.0000639
	speed: 0.0490s/iter; left time: 1707.0347s
	iters: 400, epoch: 16 | loss: 0.0005962
	speed: 0.0493s/iter; left time: 1712.4527s
Epoch: 16 cost time: 21.480123043060303
Epoch: 16, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000003
	speed: 0.1729s/iter; left time: 5979.9696s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1642.6004s
	iters: 300, epoch: 17 | loss: 0.0000086
	speed: 0.0473s/iter; left time: 1627.0743s
	iters: 400, epoch: 17 | loss: 0.0215925
	speed: 0.0463s/iter; left time: 1587.8091s
Epoch: 17 cost time: 20.057231903076172
Epoch: 17, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000015
	speed: 0.1472s/iter; left time: 5032.4841s
	iters: 200, epoch: 18 | loss: 0.0000005
	speed: 0.0497s/iter; left time: 1695.4354s
	iters: 300, epoch: 18 | loss: 0.0000028
	speed: 0.0477s/iter; left time: 1621.0679s
	iters: 400, epoch: 18 | loss: 0.0000654
	speed: 0.0466s/iter; left time: 1578.7079s
Epoch: 18 cost time: 20.038661003112793
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.985 Test Loss: 0.098 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 330002
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4165019
	speed: 0.0509s/iter; left time: 2098.3438s
	iters: 200, epoch: 1 | loss: 0.1115474
	speed: 0.0358s/iter; left time: 1470.7204s
	iters: 300, epoch: 1 | loss: 0.0568449
	speed: 0.0347s/iter; left time: 1424.3465s
	iters: 400, epoch: 1 | loss: 0.1874982
	speed: 0.0348s/iter; left time: 1424.5413s
Epoch: 1 cost time: 16.107617139816284
Epoch: 1, Steps: 413 | Train Loss: 0.466 Vali Loss: 0.066 Vali Acc: 0.978 Test Loss: 0.066 Test Acc: 0.978
Validation loss decreased (inf --> -0.978171).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0273710
	speed: 0.0899s/iter; left time: 3665.0540s
	iters: 200, epoch: 2 | loss: 0.0011275
	speed: 0.0324s/iter; left time: 1318.4154s
	iters: 300, epoch: 2 | loss: 0.0368758
	speed: 0.0348s/iter; left time: 1411.0406s
	iters: 400, epoch: 2 | loss: 0.0055089
	speed: 0.0356s/iter; left time: 1441.7426s
Epoch: 2 cost time: 14.280866384506226
Epoch: 2, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.051 Vali Acc: 0.980 Test Loss: 0.051 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.979990).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0025037
	speed: 0.0995s/iter; left time: 4015.6247s
	iters: 200, epoch: 3 | loss: 0.0080979
	speed: 0.0370s/iter; left time: 1488.3903s
	iters: 300, epoch: 3 | loss: 0.0005684
	speed: 0.0323s/iter; left time: 1297.5028s
	iters: 400, epoch: 3 | loss: 0.0010194
	speed: 0.0322s/iter; left time: 1290.4553s
Epoch: 3 cost time: 14.80124545097351
Epoch: 3, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.035 Vali Acc: 0.989 Test Loss: 0.035 Test Acc: 0.989
Validation loss decreased (-0.979990 --> -0.988631).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0076121
	speed: 0.0926s/iter; left time: 3699.3122s
	iters: 200, epoch: 4 | loss: 0.0414125
	speed: 0.0352s/iter; left time: 1404.3345s
	iters: 300, epoch: 4 | loss: 0.0009113
	speed: 0.0328s/iter; left time: 1303.9505s
	iters: 400, epoch: 4 | loss: 0.1478029
	speed: 0.0349s/iter; left time: 1382.5175s
Epoch: 4 cost time: 14.522621870040894
Epoch: 4, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0001520
	speed: 0.0926s/iter; left time: 3662.4695s
	iters: 200, epoch: 5 | loss: 0.1788391
	speed: 0.0336s/iter; left time: 1325.0082s
	iters: 300, epoch: 5 | loss: 0.0010284
	speed: 0.0358s/iter; left time: 1409.6770s
	iters: 400, epoch: 5 | loss: 0.0003849
	speed: 0.0332s/iter; left time: 1302.5046s
Epoch: 5 cost time: 14.387297630310059
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0003716
	speed: 0.0918s/iter; left time: 3591.8977s
	iters: 200, epoch: 6 | loss: 0.0781624
	speed: 0.0329s/iter; left time: 1282.7443s
	iters: 300, epoch: 6 | loss: 0.0024614
	speed: 0.0356s/iter; left time: 1386.5965s
	iters: 400, epoch: 6 | loss: 0.0006549
	speed: 0.0352s/iter; left time: 1365.3791s
Epoch: 6 cost time: 14.47806191444397
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0005092
	speed: 0.0919s/iter; left time: 3556.8299s
	iters: 200, epoch: 7 | loss: 0.0000406
	speed: 0.0348s/iter; left time: 1343.6673s
	iters: 300, epoch: 7 | loss: 0.0091215
	speed: 0.0360s/iter; left time: 1388.7500s
	iters: 400, epoch: 7 | loss: 0.0003930
	speed: 0.0352s/iter; left time: 1352.4606s
Epoch: 7 cost time: 14.898858785629272
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2798000
	speed: 0.0868s/iter; left time: 3326.8758s
	iters: 200, epoch: 8 | loss: 0.0016957
	speed: 0.0366s/iter; left time: 1398.6742s
	iters: 300, epoch: 8 | loss: 0.0000131
	speed: 0.0351s/iter; left time: 1336.3258s
	iters: 400, epoch: 8 | loss: 0.0000480
	speed: 0.0356s/iter; left time: 1353.5795s
Epoch: 8 cost time: 15.138983726501465
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0006290
	speed: 0.0902s/iter; left time: 3420.0623s
	iters: 200, epoch: 9 | loss: 0.0000342
	speed: 0.0354s/iter; left time: 1339.8745s
	iters: 300, epoch: 9 | loss: 0.0000174
	speed: 0.0329s/iter; left time: 1240.4570s
	iters: 400, epoch: 9 | loss: 0.0000003
	speed: 0.0321s/iter; left time: 1207.3083s
Epoch: 9 cost time: 14.685446500778198
Epoch: 9, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000045
	speed: 0.0900s/iter; left time: 3374.5812s
	iters: 200, epoch: 10 | loss: 0.0101892
	speed: 0.0344s/iter; left time: 1287.5157s
	iters: 300, epoch: 10 | loss: 0.0000736
	speed: 0.0340s/iter; left time: 1266.5684s
	iters: 400, epoch: 10 | loss: 0.0000017
	speed: 0.0338s/iter; left time: 1257.1682s
Epoch: 10 cost time: 14.901779890060425
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0012609
	speed: 0.0907s/iter; left time: 3361.4110s
	iters: 200, epoch: 11 | loss: 0.0000018
	speed: 0.0358s/iter; left time: 1324.2715s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0354s/iter; left time: 1306.9796s
	iters: 400, epoch: 11 | loss: 0.0006021
	speed: 0.0329s/iter; left time: 1208.0352s
Epoch: 11 cost time: 14.872049808502197
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.984 Test Loss: 0.096 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000090
	speed: 0.0877s/iter; left time: 3215.9757s
	iters: 200, epoch: 12 | loss: 0.0000025
	speed: 0.0352s/iter; left time: 1286.5795s
	iters: 300, epoch: 12 | loss: 0.0016903
	speed: 0.0336s/iter; left time: 1226.0461s
	iters: 400, epoch: 12 | loss: 0.0001050
	speed: 0.0345s/iter; left time: 1252.8595s
Epoch: 12 cost time: 14.615507125854492
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0002217
	speed: 0.0902s/iter; left time: 3268.9778s
	iters: 200, epoch: 13 | loss: 0.0000968
	speed: 0.0312s/iter; left time: 1128.8893s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0345s/iter; left time: 1244.3242s
	iters: 400, epoch: 13 | loss: 0.0000007
	speed: 0.0346s/iter; left time: 1244.8814s
Epoch: 13 cost time: 14.423356056213379
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 330002
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3724789
	speed: 0.0712s/iter; left time: 2934.3608s
	iters: 200, epoch: 1 | loss: 0.2016403
	speed: 0.0522s/iter; left time: 2144.5845s
	iters: 300, epoch: 1 | loss: 0.3543649
	speed: 0.0529s/iter; left time: 2168.5344s
	iters: 400, epoch: 1 | loss: 0.0970374
	speed: 0.0529s/iter; left time: 2161.7862s
Epoch: 1 cost time: 23.76780080795288
Epoch: 1, Steps: 413 | Train Loss: 0.417 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (inf --> -0.980445).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0331356
	speed: 0.1834s/iter; left time: 7480.8016s
	iters: 200, epoch: 2 | loss: 0.0032025
	speed: 0.0553s/iter; left time: 2248.7399s
	iters: 300, epoch: 2 | loss: 0.0050063
	speed: 0.0519s/iter; left time: 2105.8212s
	iters: 400, epoch: 2 | loss: 0.0389546
	speed: 0.0496s/iter; left time: 2008.2428s
Epoch: 2 cost time: 22.19093894958496
Epoch: 2, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.069 Vali Acc: 0.974 Test Loss: 0.069 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0648670
	speed: 0.1653s/iter; left time: 6674.5843s
	iters: 200, epoch: 3 | loss: 0.0334499
	speed: 0.0541s/iter; left time: 2178.7920s
	iters: 300, epoch: 3 | loss: 0.0015857
	speed: 0.0524s/iter; left time: 2105.2998s
	iters: 400, epoch: 3 | loss: 0.0007500
	speed: 0.0519s/iter; left time: 2079.8127s
Epoch: 3 cost time: 22.027414798736572
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0010926
	speed: 0.1619s/iter; left time: 6471.0857s
	iters: 200, epoch: 4 | loss: 0.0004860
	speed: 0.0539s/iter; left time: 2146.7150s
	iters: 300, epoch: 4 | loss: 0.0240310
	speed: 0.0533s/iter; left time: 2121.1324s
	iters: 400, epoch: 4 | loss: 0.0961028
	speed: 0.0518s/iter; left time: 2052.8021s
Epoch: 4 cost time: 22.216692447662354
Epoch: 4, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0208247
	speed: 0.1820s/iter; left time: 7197.0325s
	iters: 200, epoch: 5 | loss: 0.1205096
	speed: 0.0543s/iter; left time: 2142.7811s
	iters: 300, epoch: 5 | loss: 0.0043072
	speed: 0.0540s/iter; left time: 2124.5668s
	iters: 400, epoch: 5 | loss: 0.0033483
	speed: 0.0516s/iter; left time: 2024.6530s
Epoch: 5 cost time: 22.1889328956604
Epoch: 5, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0027265
	speed: 0.1693s/iter; left time: 6624.7998s
	iters: 200, epoch: 6 | loss: 0.1862234
	speed: 0.0511s/iter; left time: 1995.2344s
	iters: 300, epoch: 6 | loss: 0.0000199
	speed: 0.0510s/iter; left time: 1987.1330s
	iters: 400, epoch: 6 | loss: 0.0011494
	speed: 0.0498s/iter; left time: 1935.3541s
Epoch: 6 cost time: 21.267003059387207
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.980445 --> -0.983174).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0663048
	speed: 0.1638s/iter; left time: 6341.1954s
	iters: 200, epoch: 7 | loss: 0.0000462
	speed: 0.0514s/iter; left time: 1986.6878s
	iters: 300, epoch: 7 | loss: 0.0043027
	speed: 0.0525s/iter; left time: 2022.3615s
	iters: 400, epoch: 7 | loss: 0.0811373
	speed: 0.0501s/iter; left time: 1925.9466s
Epoch: 7 cost time: 21.612300634384155
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2365287
	speed: 0.1713s/iter; left time: 6564.0618s
	iters: 200, epoch: 8 | loss: 0.0075375
	speed: 0.0534s/iter; left time: 2041.9674s
	iters: 300, epoch: 8 | loss: 0.0585871
	speed: 0.0532s/iter; left time: 2028.8153s
	iters: 400, epoch: 8 | loss: 0.0012048
	speed: 0.0516s/iter; left time: 1959.9459s
Epoch: 8 cost time: 22.127434492111206
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0003610
	speed: 0.1884s/iter; left time: 7138.7230s
	iters: 200, epoch: 9 | loss: 0.0000993
	speed: 0.0533s/iter; left time: 2014.7675s
	iters: 300, epoch: 9 | loss: 0.0000204
	speed: 0.0541s/iter; left time: 2040.0725s
	iters: 400, epoch: 9 | loss: 0.1453709
	speed: 0.0531s/iter; left time: 1995.2800s
Epoch: 9 cost time: 22.480618238449097
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.193 Vali Acc: 0.969 Test Loss: 0.193 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0001105
	speed: 0.1609s/iter; left time: 6032.2567s
	iters: 200, epoch: 10 | loss: 0.0120058
	speed: 0.0524s/iter; left time: 1957.6874s
	iters: 300, epoch: 10 | loss: 0.0002394
	speed: 0.0542s/iter; left time: 2018.9940s
	iters: 400, epoch: 10 | loss: 0.0000006
	speed: 0.0527s/iter; left time: 1961.4156s
Epoch: 10 cost time: 22.154731512069702
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
Validation loss decreased (-0.983174 --> -0.983628).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000017
	speed: 0.1622s/iter; left time: 6013.8233s
	iters: 200, epoch: 11 | loss: 0.0000146
	speed: 0.0509s/iter; left time: 1883.0201s
	iters: 300, epoch: 11 | loss: 0.0004862
	speed: 0.0556s/iter; left time: 2050.1372s
	iters: 400, epoch: 11 | loss: 0.0000282
	speed: 0.0513s/iter; left time: 1887.3885s
Epoch: 11 cost time: 21.896413564682007
Epoch: 11, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0008192
	speed: 0.1749s/iter; left time: 6410.2965s
	iters: 200, epoch: 12 | loss: 0.0000484
	speed: 0.0526s/iter; left time: 1921.2897s
	iters: 300, epoch: 12 | loss: 0.0043962
	speed: 0.0499s/iter; left time: 1818.4803s
	iters: 400, epoch: 12 | loss: 0.1161458
	speed: 0.0512s/iter; left time: 1862.9835s
Epoch: 12 cost time: 21.62121057510376
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.056 Vali Acc: 0.986 Test Loss: 0.056 Test Acc: 0.986
Validation loss decreased (-0.983628 --> -0.985902).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.1606s/iter; left time: 5819.9655s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0499s/iter; left time: 1803.8163s
	iters: 300, epoch: 13 | loss: 0.0000078
	speed: 0.0528s/iter; left time: 1902.6396s
	iters: 400, epoch: 13 | loss: 0.0002584
	speed: 0.0525s/iter; left time: 1887.1083s
Epoch: 13 cost time: 21.625380992889404
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000026
	speed: 0.1680s/iter; left time: 6020.0408s
	iters: 200, epoch: 14 | loss: 0.0001354
	speed: 0.0507s/iter; left time: 1813.0277s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0535s/iter; left time: 1906.6347s
	iters: 400, epoch: 14 | loss: 0.0000014
	speed: 0.0506s/iter; left time: 1799.3933s
Epoch: 14 cost time: 21.81166100502014
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000009
	speed: 0.1744s/iter; left time: 6178.6439s
	iters: 200, epoch: 15 | loss: 0.5036182
	speed: 0.0538s/iter; left time: 1898.5333s
	iters: 300, epoch: 15 | loss: 0.0004304
	speed: 0.0539s/iter; left time: 1899.9455s
	iters: 400, epoch: 15 | loss: 0.0000026
	speed: 0.0554s/iter; left time: 1943.9803s
Epoch: 15 cost time: 23.040385246276855
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000014
	speed: 0.1718s/iter; left time: 6012.9488s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0524s/iter; left time: 1827.6835s
	iters: 300, epoch: 16 | loss: 0.0000011
	speed: 0.0515s/iter; left time: 1793.2757s
	iters: 400, epoch: 16 | loss: 0.0000070
	speed: 0.0530s/iter; left time: 1837.7093s
Epoch: 16 cost time: 22.284892082214355
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1611s/iter; left time: 5571.8743s
	iters: 200, epoch: 17 | loss: 0.0055856
	speed: 0.0502s/iter; left time: 1731.4474s
	iters: 300, epoch: 17 | loss: 0.0004997
	speed: 0.0490s/iter; left time: 1685.7661s
	iters: 400, epoch: 17 | loss: 0.0000741
	speed: 0.0513s/iter; left time: 1759.4618s
Epoch: 17 cost time: 21.32802939414978
Epoch: 17, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1846s/iter; left time: 6308.9252s
	iters: 200, epoch: 18 | loss: 0.0121846
	speed: 0.0505s/iter; left time: 1719.5548s
	iters: 300, epoch: 18 | loss: 0.0000037
	speed: 0.0521s/iter; left time: 1770.7926s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 1763.1904s
Epoch: 18 cost time: 21.883603811264038
Epoch: 18, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.189 Vali Acc: 0.979 Test Loss: 0.189 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0019504
	speed: 0.1692s/iter; left time: 5713.1209s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 1699.2924s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 1664.0743s
	iters: 400, epoch: 19 | loss: 0.0000851
	speed: 0.0502s/iter; left time: 1678.5811s
Epoch: 19 cost time: 21.169755935668945
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.164 Vali Acc: 0.980 Test Loss: 0.164 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1649s/iter; left time: 5500.5183s
	iters: 200, epoch: 20 | loss: 0.0000132
	speed: 0.0520s/iter; left time: 1729.4276s
	iters: 300, epoch: 20 | loss: 0.0000007
	speed: 0.0495s/iter; left time: 1639.6473s
	iters: 400, epoch: 20 | loss: 0.0000572
	speed: 0.0508s/iter; left time: 1678.6896s
Epoch: 20 cost time: 21.44405174255371
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.159 Vali Acc: 0.983 Test Loss: 0.159 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0004072
	speed: 0.1795s/iter; left time: 5911.4505s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 1891.5498s
	iters: 300, epoch: 21 | loss: 0.0000111
	speed: 0.0524s/iter; left time: 1715.3699s
	iters: 400, epoch: 21 | loss: 0.0000424
	speed: 0.0544s/iter; left time: 1776.4812s
Epoch: 21 cost time: 22.97395133972168
Epoch: 21, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.131 Vali Acc: 0.985 Test Loss: 0.131 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1826s/iter; left time: 5939.8172s
	iters: 200, epoch: 22 | loss: 0.0000044
	speed: 0.0548s/iter; left time: 1776.2779s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 1722.1250s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1698.1148s
Epoch: 22 cost time: 22.350504398345947
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.982 Test Loss: 0.120 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 264466
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3677681
	speed: 0.0663s/iter; left time: 2731.8426s
	iters: 200, epoch: 1 | loss: 0.2473982
	speed: 0.0504s/iter; left time: 2073.2786s
	iters: 300, epoch: 1 | loss: 0.3390808
	speed: 0.0480s/iter; left time: 1966.7196s
	iters: 400, epoch: 1 | loss: 0.1173587
	speed: 0.0481s/iter; left time: 1969.3260s
Epoch: 1 cost time: 22.044661283493042
Epoch: 1, Steps: 413 | Train Loss: 0.416 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (inf --> -0.980445).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0321568
	speed: 0.1677s/iter; left time: 6838.4579s
	iters: 200, epoch: 2 | loss: 0.0039555
	speed: 0.0490s/iter; left time: 1992.4147s
	iters: 300, epoch: 2 | loss: 0.0040772
	speed: 0.0489s/iter; left time: 1983.7128s
	iters: 400, epoch: 2 | loss: 0.0195066
	speed: 0.0501s/iter; left time: 2028.2512s
Epoch: 2 cost time: 20.454471349716187
Epoch: 2, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.077 Vali Acc: 0.971 Test Loss: 0.077 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0808380
	speed: 0.1627s/iter; left time: 6567.7534s
	iters: 200, epoch: 3 | loss: 0.0173948
	speed: 0.0489s/iter; left time: 1968.4453s
	iters: 300, epoch: 3 | loss: 0.0041270
	speed: 0.0486s/iter; left time: 1953.7943s
	iters: 400, epoch: 3 | loss: 0.0408846
	speed: 0.0510s/iter; left time: 2045.4660s
Epoch: 3 cost time: 20.711716890335083
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.966 Test Loss: 0.111 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0011679
	speed: 0.1566s/iter; left time: 6257.5993s
	iters: 200, epoch: 4 | loss: 0.0003722
	speed: 0.0504s/iter; left time: 2010.0628s
	iters: 300, epoch: 4 | loss: 0.0032003
	speed: 0.0503s/iter; left time: 2001.1636s
	iters: 400, epoch: 4 | loss: 0.1054823
	speed: 0.0504s/iter; left time: 1998.3301s
Epoch: 4 cost time: 21.39792561531067
Epoch: 4, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0239851
	speed: 0.1672s/iter; left time: 6613.3279s
	iters: 200, epoch: 5 | loss: 0.2321756
	speed: 0.0548s/iter; left time: 2159.9783s
	iters: 300, epoch: 5 | loss: 0.0015506
	speed: 0.0493s/iter; left time: 1939.7313s
	iters: 400, epoch: 5 | loss: 0.0169023
	speed: 0.0510s/iter; left time: 2003.3528s
Epoch: 5 cost time: 21.855039596557617
Epoch: 5, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0053365
	speed: 0.1726s/iter; left time: 6754.1230s
	iters: 200, epoch: 6 | loss: 0.0623737
	speed: 0.0503s/iter; left time: 1963.2771s
	iters: 300, epoch: 6 | loss: 0.0002078
	speed: 0.0500s/iter; left time: 1945.6354s
	iters: 400, epoch: 6 | loss: 0.0000383
	speed: 0.0490s/iter; left time: 1904.6263s
Epoch: 6 cost time: 20.901542901992798
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0004134
	speed: 0.1567s/iter; left time: 6068.7679s
	iters: 200, epoch: 7 | loss: 0.0001454
	speed: 0.0483s/iter; left time: 1863.5989s
	iters: 300, epoch: 7 | loss: 0.0001057
	speed: 0.0518s/iter; left time: 1995.7850s
	iters: 400, epoch: 7 | loss: 0.0003643
	speed: 0.0504s/iter; left time: 1936.2222s
Epoch: 7 cost time: 20.722362756729126
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0299242
	speed: 0.1632s/iter; left time: 6251.3598s
	iters: 200, epoch: 8 | loss: 0.0000190
	speed: 0.0517s/iter; left time: 1976.4730s
	iters: 300, epoch: 8 | loss: 0.0108583
	speed: 0.0490s/iter; left time: 1869.0837s
	iters: 400, epoch: 8 | loss: 0.0000424
	speed: 0.0507s/iter; left time: 1927.3065s
Epoch: 8 cost time: 21.143526315689087
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0001879
	speed: 0.1735s/iter; left time: 6573.6815s
	iters: 200, epoch: 9 | loss: 0.0000014
	speed: 0.0501s/iter; left time: 1892.4947s
	iters: 300, epoch: 9 | loss: 0.0105063
	speed: 0.0463s/iter; left time: 1746.4000s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1798.1739s
Epoch: 9 cost time: 20.59516930580139
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0001269
	speed: 0.1521s/iter; left time: 5702.2817s
	iters: 200, epoch: 10 | loss: 0.0003650
	speed: 0.0514s/iter; left time: 1920.7272s
	iters: 300, epoch: 10 | loss: 0.0000287
	speed: 0.0478s/iter; left time: 1782.0086s
	iters: 400, epoch: 10 | loss: 0.0316435
	speed: 0.0482s/iter; left time: 1792.3268s
Epoch: 10 cost time: 20.50003409385681
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0000863
	speed: 0.1530s/iter; left time: 5673.5412s
	iters: 200, epoch: 11 | loss: 0.0000004
	speed: 0.0504s/iter; left time: 1864.6584s
	iters: 300, epoch: 11 | loss: 0.0000301
	speed: 0.0493s/iter; left time: 1816.8155s
	iters: 400, epoch: 11 | loss: 0.0000005
	speed: 0.0515s/iter; left time: 1895.4109s
Epoch: 11 cost time: 21.060296535491943
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
Validation loss decreased (-0.980445 --> -0.981809).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0152191
	speed: 0.1743s/iter; left time: 6390.5782s
	iters: 200, epoch: 12 | loss: 0.0000003
	speed: 0.0502s/iter; left time: 1836.3891s
	iters: 300, epoch: 12 | loss: 0.0272139
	speed: 0.0538s/iter; left time: 1961.3255s
	iters: 400, epoch: 12 | loss: 0.0000686
	speed: 0.0513s/iter; left time: 1866.5974s
Epoch: 12 cost time: 21.534576177597046
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
Validation loss decreased (-0.981809 --> -0.983628).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1687s/iter; left time: 6114.6002s
	iters: 200, epoch: 13 | loss: 0.0000774
	speed: 0.0505s/iter; left time: 1824.6366s
	iters: 300, epoch: 13 | loss: 0.0000832
	speed: 0.0490s/iter; left time: 1767.3997s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 1913.9794s
Epoch: 13 cost time: 21.589956760406494
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0002201
	speed: 0.1764s/iter; left time: 6321.5722s
	iters: 200, epoch: 14 | loss: 0.0000659
	speed: 0.0510s/iter; left time: 1821.7287s
	iters: 300, epoch: 14 | loss: 0.0000039
	speed: 0.0497s/iter; left time: 1770.3671s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1820.0166s
Epoch: 14 cost time: 21.56556510925293
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0041898
	speed: 0.1791s/iter; left time: 6344.3493s
	iters: 200, epoch: 15 | loss: 0.0009163
	speed: 0.0557s/iter; left time: 1966.3669s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1762.6456s
	iters: 400, epoch: 15 | loss: 0.1339847
	speed: 0.0523s/iter; left time: 1838.2911s
Epoch: 15 cost time: 22.262351751327515
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.069 Vali Acc: 0.989 Test Loss: 0.069 Test Acc: 0.989
Validation loss decreased (-0.983628 --> -0.989085).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0001304
	speed: 0.1823s/iter; left time: 6381.1260s
	iters: 200, epoch: 16 | loss: 0.0129299
	speed: 0.0540s/iter; left time: 1885.2787s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 1815.7588s
	iters: 400, epoch: 16 | loss: 0.0000051
	speed: 0.0510s/iter; left time: 1771.0695s
Epoch: 16 cost time: 21.732041120529175
Epoch: 16, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.984 Test Loss: 0.089 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000031
	speed: 0.1591s/iter; left time: 5502.5980s
	iters: 200, epoch: 17 | loss: 0.2862763
	speed: 0.0517s/iter; left time: 1783.8728s
	iters: 300, epoch: 17 | loss: 0.0008291
	speed: 0.0512s/iter; left time: 1761.1000s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1774.5508s
Epoch: 17 cost time: 21.5942485332489
Epoch: 17, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000318
	speed: 0.1590s/iter; left time: 5434.0081s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0504s/iter; left time: 1717.8170s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1721.8048s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 1582.3717s
Epoch: 18 cost time: 20.75801157951355
Epoch: 18, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.984 Test Loss: 0.118 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1714s/iter; left time: 5787.4594s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1600.9270s
	iters: 300, epoch: 19 | loss: 0.0000006
	speed: 0.0489s/iter; left time: 1641.1726s
	iters: 400, epoch: 19 | loss: 0.0000026
	speed: 0.0480s/iter; left time: 1605.3315s
Epoch: 19 cost time: 20.433740854263306
Epoch: 19, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.143 Vali Acc: 0.982 Test Loss: 0.143 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1648s/iter; left time: 5496.1514s
	iters: 200, epoch: 20 | loss: 0.1475849
	speed: 0.0488s/iter; left time: 1623.4142s
	iters: 300, epoch: 20 | loss: 0.0000003
	speed: 0.0461s/iter; left time: 1529.2517s
	iters: 400, epoch: 20 | loss: 0.0062355
	speed: 0.0473s/iter; left time: 1564.8849s
Epoch: 20 cost time: 20.043977975845337
Epoch: 20, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.985 Test Loss: 0.106 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.1011422
	speed: 0.1477s/iter; left time: 4864.2987s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 1605.6098s
	iters: 300, epoch: 21 | loss: 0.0000019
	speed: 0.0506s/iter; left time: 1656.1712s
	iters: 400, epoch: 21 | loss: 0.0000187
	speed: 0.0515s/iter; left time: 1681.4838s
Epoch: 21 cost time: 20.679354667663574
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.982 Test Loss: 0.157 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000022
	speed: 0.1796s/iter; left time: 5843.1822s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 1803.8058s
	iters: 300, epoch: 22 | loss: 0.0000238
	speed: 0.0589s/iter; left time: 1905.5770s
	iters: 400, epoch: 22 | loss: 0.0000392
	speed: 0.0542s/iter; left time: 1748.1860s
Epoch: 22 cost time: 23.184770822525024
Epoch: 22, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.172 Vali Acc: 0.979 Test Loss: 0.172 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1691s/iter; left time: 5430.4527s
	iters: 200, epoch: 23 | loss: 0.0000427
	speed: 0.0519s/iter; left time: 1662.8680s
	iters: 300, epoch: 23 | loss: 0.0000042
	speed: 0.0529s/iter; left time: 1688.4767s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1628.0302s
Epoch: 23 cost time: 21.967012882232666
Epoch: 23, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.220 Vali Acc: 0.977 Test Loss: 0.220 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.5059787
	speed: 0.1612s/iter; left time: 5108.7793s
	iters: 200, epoch: 24 | loss: 0.0000016
	speed: 0.0497s/iter; left time: 1572.1831s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 1540.4092s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 1508.5919s
Epoch: 24 cost time: 20.857455253601074
Epoch: 24, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000023
	speed: 0.1819s/iter; left time: 5690.1420s
	iters: 200, epoch: 25 | loss: 0.0001125
	speed: 0.0516s/iter; left time: 1610.3197s
	iters: 300, epoch: 25 | loss: 0.0092148
	speed: 0.0504s/iter; left time: 1565.7059s
	iters: 400, epoch: 25 | loss: 0.0008144
	speed: 0.0517s/iter; left time: 1602.1659s
Epoch: 25 cost time: 21.539520025253296
Epoch: 25, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.219 Vali Acc: 0.978 Test Loss: 0.219 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 264466
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3869539
	speed: 0.0627s/iter; left time: 2582.5146s
	iters: 200, epoch: 1 | loss: 0.2950825
	speed: 0.0435s/iter; left time: 1786.2020s
	iters: 300, epoch: 1 | loss: 0.3204008
	speed: 0.0422s/iter; left time: 1728.6962s
	iters: 400, epoch: 1 | loss: 0.0996018
	speed: 0.0441s/iter; left time: 1803.7322s
Epoch: 1 cost time: 19.841773986816406
Epoch: 1, Steps: 413 | Train Loss: 0.424 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (inf --> -0.979535).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0492547
	speed: 0.1631s/iter; left time: 6651.8648s
	iters: 200, epoch: 2 | loss: 0.0032291
	speed: 0.0498s/iter; left time: 2026.4862s
	iters: 300, epoch: 2 | loss: 0.0221538
	speed: 0.0538s/iter; left time: 2181.6932s
	iters: 400, epoch: 2 | loss: 0.0978431
	speed: 0.0497s/iter; left time: 2012.2295s
Epoch: 2 cost time: 21.207711458206177
Epoch: 2, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.052 Vali Acc: 0.981 Test Loss: 0.052 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.980900).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0602316
	speed: 0.1617s/iter; left time: 6529.4386s
	iters: 200, epoch: 3 | loss: 0.0130093
	speed: 0.0501s/iter; left time: 2018.7328s
	iters: 300, epoch: 3 | loss: 0.0003520
	speed: 0.0534s/iter; left time: 2145.9993s
	iters: 400, epoch: 3 | loss: 0.0054779
	speed: 0.0499s/iter; left time: 2001.5696s
Epoch: 3 cost time: 21.43599843978882
Epoch: 3, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0029471
	speed: 0.1793s/iter; left time: 7164.6021s
	iters: 200, epoch: 4 | loss: 0.0007028
	speed: 0.0538s/iter; left time: 2143.7187s
	iters: 300, epoch: 4 | loss: 0.0041337
	speed: 0.0536s/iter; left time: 2131.9897s
	iters: 400, epoch: 4 | loss: 0.0034688
	speed: 0.0496s/iter; left time: 1966.3716s
Epoch: 4 cost time: 22.007574796676636
Epoch: 4, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0104629
	speed: 0.1723s/iter; left time: 6815.6100s
	iters: 200, epoch: 5 | loss: 0.1121350
	speed: 0.0483s/iter; left time: 1905.1924s
	iters: 300, epoch: 5 | loss: 0.0001082
	speed: 0.0503s/iter; left time: 1978.2157s
	iters: 400, epoch: 5 | loss: 0.0059356
	speed: 0.0490s/iter; left time: 1921.3012s
Epoch: 5 cost time: 20.576086282730103
Epoch: 5, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0002435
	speed: 0.1526s/iter; left time: 5970.3459s
	iters: 200, epoch: 6 | loss: 0.0017967
	speed: 0.0488s/iter; left time: 1904.7062s
	iters: 300, epoch: 6 | loss: 0.0000038
	speed: 0.0508s/iter; left time: 1977.6620s
	iters: 400, epoch: 6 | loss: 0.0012941
	speed: 0.0485s/iter; left time: 1885.3385s
Epoch: 6 cost time: 20.502490997314453
Epoch: 6, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000768
	speed: 0.1613s/iter; left time: 6245.6489s
	iters: 200, epoch: 7 | loss: 0.0001704
	speed: 0.0494s/iter; left time: 1909.4628s
	iters: 300, epoch: 7 | loss: 0.0006209
	speed: 0.0511s/iter; left time: 1967.7933s
	iters: 400, epoch: 7 | loss: 0.0002973
	speed: 0.0502s/iter; left time: 1927.6340s
Epoch: 7 cost time: 21.088637113571167
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.2144630
	speed: 0.1749s/iter; left time: 6699.0089s
	iters: 200, epoch: 8 | loss: 0.0001212
	speed: 0.0501s/iter; left time: 1915.6941s
	iters: 300, epoch: 8 | loss: 0.0000011
	speed: 0.0527s/iter; left time: 2009.9942s
	iters: 400, epoch: 8 | loss: 0.0000007
	speed: 0.0504s/iter; left time: 1914.0468s
Epoch: 8 cost time: 21.542115926742554
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000077
	speed: 0.1624s/iter; left time: 6155.1861s
	iters: 200, epoch: 9 | loss: 0.0000039
	speed: 0.0505s/iter; left time: 1909.3186s
	iters: 300, epoch: 9 | loss: 0.0002884
	speed: 0.0528s/iter; left time: 1989.6670s
	iters: 400, epoch: 9 | loss: 0.0059666
	speed: 0.0497s/iter; left time: 1868.9612s
Epoch: 9 cost time: 21.431519508361816
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.1639s/iter; left time: 6143.5104s
	iters: 200, epoch: 10 | loss: 0.0000007
	speed: 0.0500s/iter; left time: 1870.1537s
	iters: 300, epoch: 10 | loss: 0.0000330
	speed: 0.0542s/iter; left time: 2021.6477s
	iters: 400, epoch: 10 | loss: 0.0020972
	speed: 0.0541s/iter; left time: 2010.9615s
Epoch: 10 cost time: 22.048709630966187
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
Validation loss decreased (-0.980900 --> -0.983628).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.1768s/iter; left time: 6552.8573s
	iters: 200, epoch: 11 | loss: 0.0000177
	speed: 0.0462s/iter; left time: 1708.7083s
	iters: 300, epoch: 11 | loss: 0.0000031
	speed: 0.0492s/iter; left time: 1814.7588s
	iters: 400, epoch: 11 | loss: 0.0000128
	speed: 0.0507s/iter; left time: 1862.8330s
Epoch: 11 cost time: 20.29094386100769
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0100738
	speed: 0.1582s/iter; left time: 5797.8751s
	iters: 200, epoch: 12 | loss: 0.0009511
	speed: 0.0490s/iter; left time: 1790.5476s
	iters: 300, epoch: 12 | loss: 0.0341448
	speed: 0.0485s/iter; left time: 1767.1378s
	iters: 400, epoch: 12 | loss: 0.0866805
	speed: 0.0511s/iter; left time: 1859.6407s
Epoch: 12 cost time: 21.00222420692444
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.1626s/iter; left time: 5893.7299s
	iters: 200, epoch: 13 | loss: 0.0000030
	speed: 0.0487s/iter; left time: 1760.9423s
	iters: 300, epoch: 13 | loss: 0.0000014
	speed: 0.0503s/iter; left time: 1812.4074s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 1882.4424s
Epoch: 13 cost time: 21.182297706604004
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.135 Vali Acc: 0.981 Test Loss: 0.135 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000061
	speed: 0.1765s/iter; left time: 6324.5794s
	iters: 200, epoch: 14 | loss: 0.0000027
	speed: 0.0538s/iter; left time: 1922.3304s
	iters: 300, epoch: 14 | loss: 0.0035859
	speed: 0.0523s/iter; left time: 1861.8716s
	iters: 400, epoch: 14 | loss: 0.0716021
	speed: 0.0537s/iter; left time: 1907.1385s
Epoch: 14 cost time: 22.40326714515686
Epoch: 14, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.984 Test Loss: 0.098 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000029
	speed: 0.1642s/iter; left time: 5817.3138s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0509s/iter; left time: 1799.1315s
	iters: 300, epoch: 15 | loss: 0.0004376
	speed: 0.0502s/iter; left time: 1769.5292s
	iters: 400, epoch: 15 | loss: 0.0335398
	speed: 0.0512s/iter; left time: 1797.8957s
Epoch: 15 cost time: 21.376722812652588
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.155 Vali Acc: 0.980 Test Loss: 0.155 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1604s/iter; left time: 5613.6366s
	iters: 200, epoch: 16 | loss: 0.0000019
	speed: 0.0508s/iter; left time: 1773.2459s
	iters: 300, epoch: 16 | loss: 0.0000003
	speed: 0.0502s/iter; left time: 1746.1654s
	iters: 400, epoch: 16 | loss: 0.0001389
	speed: 0.0483s/iter; left time: 1676.3537s
Epoch: 16 cost time: 21.003937244415283
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.133 Vali Acc: 0.982 Test Loss: 0.133 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000005
	speed: 0.1860s/iter; left time: 6433.5583s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0519s/iter; left time: 1791.2192s
	iters: 300, epoch: 17 | loss: 0.0249504
	speed: 0.0547s/iter; left time: 1880.2648s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 1802.8191s
Epoch: 17 cost time: 22.199281692504883
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.233 Vali Acc: 0.976 Test Loss: 0.233 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000014
	speed: 0.1776s/iter; left time: 6070.7262s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0505s/iter; left time: 1720.6285s
	iters: 300, epoch: 18 | loss: 0.0005846
	speed: 0.0506s/iter; left time: 1717.9687s
	iters: 400, epoch: 18 | loss: 0.0000291
	speed: 0.0481s/iter; left time: 1628.4631s
Epoch: 18 cost time: 21.148807525634766
Epoch: 18, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.984 Test Loss: 0.129 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1587s/iter; left time: 5357.3751s
	iters: 200, epoch: 19 | loss: 0.0000030
	speed: 0.0491s/iter; left time: 1654.4998s
	iters: 300, epoch: 19 | loss: 0.0000057
	speed: 0.0504s/iter; left time: 1691.7303s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 1666.0668s
Epoch: 19 cost time: 20.903604984283447
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.982 Test Loss: 0.115 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1660s/iter; left time: 5537.4526s
	iters: 200, epoch: 20 | loss: 0.0000357
	speed: 0.0528s/iter; left time: 1757.4305s
	iters: 300, epoch: 20 | loss: 0.0417660
	speed: 0.0535s/iter; left time: 1773.4065s
	iters: 400, epoch: 20 | loss: 0.0000263
	speed: 0.0533s/iter; left time: 1761.3433s
Epoch: 20 cost time: 22.26978898048401
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.220 Vali Acc: 0.972 Test Loss: 0.220 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 264466
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5706673
	speed: 0.0634s/iter; left time: 2610.9161s
	iters: 200, epoch: 1 | loss: 0.3058681
	speed: 0.0430s/iter; left time: 1768.0486s
	iters: 300, epoch: 1 | loss: 0.2530442
	speed: 0.0439s/iter; left time: 1798.6516s
	iters: 400, epoch: 1 | loss: 0.0722992
	speed: 0.0438s/iter; left time: 1790.4395s
Epoch: 1 cost time: 20.02762198448181
Epoch: 1, Steps: 413 | Train Loss: 0.481 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
Validation loss decreased (inf --> -0.983628).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0359995
	speed: 0.1519s/iter; left time: 6197.6355s
	iters: 200, epoch: 2 | loss: 0.0049306
	speed: 0.0440s/iter; left time: 1791.8411s
	iters: 300, epoch: 2 | loss: 0.0261512
	speed: 0.0435s/iter; left time: 1765.0876s
	iters: 400, epoch: 2 | loss: 0.0474993
	speed: 0.0469s/iter; left time: 1900.2355s
Epoch: 2 cost time: 18.71239137649536
Epoch: 2, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.059 Vali Acc: 0.982 Test Loss: 0.059 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0894546
	speed: 0.1664s/iter; left time: 6718.4874s
	iters: 200, epoch: 3 | loss: 0.0108559
	speed: 0.0481s/iter; left time: 1937.3268s
	iters: 300, epoch: 3 | loss: 0.0015775
	speed: 0.0451s/iter; left time: 1809.8948s
	iters: 400, epoch: 3 | loss: 0.0030969
	speed: 0.0459s/iter; left time: 1839.7357s
Epoch: 3 cost time: 19.515140056610107
Epoch: 3, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.081 Vali Acc: 0.972 Test Loss: 0.081 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0928753
	speed: 0.1687s/iter; left time: 6743.2885s
	iters: 200, epoch: 4 | loss: 0.0063062
	speed: 0.0439s/iter; left time: 1749.7697s
	iters: 300, epoch: 4 | loss: 0.0036085
	speed: 0.0443s/iter; left time: 1760.2630s
	iters: 400, epoch: 4 | loss: 0.0007177
	speed: 0.0454s/iter; left time: 1801.6476s
Epoch: 4 cost time: 18.6970956325531
Epoch: 4, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0293540
	speed: 0.1552s/iter; left time: 6137.0281s
	iters: 200, epoch: 5 | loss: 0.0130149
	speed: 0.0463s/iter; left time: 1824.7202s
	iters: 300, epoch: 5 | loss: 0.0003253
	speed: 0.0470s/iter; left time: 1848.3890s
	iters: 400, epoch: 5 | loss: 0.0483025
	speed: 0.0441s/iter; left time: 1731.5197s
Epoch: 5 cost time: 19.467713832855225
Epoch: 5, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0002114
	speed: 0.1460s/iter; left time: 5714.2504s
	iters: 200, epoch: 6 | loss: 0.8159651
	speed: 0.0465s/iter; left time: 1813.2344s
	iters: 300, epoch: 6 | loss: 0.0000249
	speed: 0.0461s/iter; left time: 1796.5474s
	iters: 400, epoch: 6 | loss: 0.0011110
	speed: 0.0471s/iter; left time: 1828.2334s
Epoch: 6 cost time: 19.32902216911316
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0001364
	speed: 0.1521s/iter; left time: 5891.2335s
	iters: 200, epoch: 7 | loss: 0.0000171
	speed: 0.0477s/iter; left time: 1842.6721s
	iters: 300, epoch: 7 | loss: 0.0661573
	speed: 0.0480s/iter; left time: 1847.7807s
	iters: 400, epoch: 7 | loss: 0.1489546
	speed: 0.0434s/iter; left time: 1667.3840s
Epoch: 7 cost time: 19.15726637840271
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.229 Vali Acc: 0.954 Test Loss: 0.229 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000846
	speed: 0.1505s/iter; left time: 5767.4168s
	iters: 200, epoch: 8 | loss: 0.0000885
	speed: 0.0424s/iter; left time: 1621.8918s
	iters: 300, epoch: 8 | loss: 0.0002674
	speed: 0.0432s/iter; left time: 1646.3485s
	iters: 400, epoch: 8 | loss: 0.0012139
	speed: 0.0439s/iter; left time: 1669.8047s
Epoch: 8 cost time: 18.426196336746216
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0005779
	speed: 0.1492s/iter; left time: 5653.5301s
	iters: 200, epoch: 9 | loss: 0.0001370
	speed: 0.0458s/iter; left time: 1730.6972s
	iters: 300, epoch: 9 | loss: 0.0000090
	speed: 0.0415s/iter; left time: 1566.2969s
	iters: 400, epoch: 9 | loss: 0.0000160
	speed: 0.0441s/iter; left time: 1658.9229s
Epoch: 9 cost time: 18.524879932403564
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000071
	speed: 0.1706s/iter; left time: 6396.0504s
	iters: 200, epoch: 10 | loss: 0.0000346
	speed: 0.0483s/iter; left time: 1806.3337s
	iters: 300, epoch: 10 | loss: 0.0000518
	speed: 0.0473s/iter; left time: 1762.9519s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0492s/iter; left time: 1829.2799s
Epoch: 10 cost time: 20.359605073928833
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0065381
	speed: 0.1711s/iter; left time: 6341.7426s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.0449s/iter; left time: 1661.6259s
	iters: 300, epoch: 11 | loss: 0.0000550
	speed: 0.0440s/iter; left time: 1622.3657s
	iters: 400, epoch: 11 | loss: 0.0000059
	speed: 0.0429s/iter; left time: 1578.8379s
Epoch: 11 cost time: 19.049110412597656
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.984 Test Loss: 0.093 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 264466
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3867079
	speed: 0.0685s/iter; left time: 2823.2915s
	iters: 200, epoch: 1 | loss: 0.0500314
	speed: 0.0509s/iter; left time: 2092.3247s
	iters: 300, epoch: 1 | loss: 0.1400350
	speed: 0.0504s/iter; left time: 2067.9819s
	iters: 400, epoch: 1 | loss: 0.0067116
	speed: 0.0521s/iter; left time: 2130.7143s
Epoch: 1 cost time: 22.96088743209839
Epoch: 1, Steps: 413 | Train Loss: 0.406 Vali Loss: 0.075 Vali Acc: 0.972 Test Loss: 0.075 Test Acc: 0.972
Validation loss decreased (inf --> -0.971805).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0167030
	speed: 0.1703s/iter; left time: 6946.5303s
	iters: 200, epoch: 2 | loss: 0.0101121
	speed: 0.0513s/iter; left time: 2087.6217s
	iters: 300, epoch: 2 | loss: 0.2299644
	speed: 0.0526s/iter; left time: 2135.3390s
	iters: 400, epoch: 2 | loss: 0.0026403
	speed: 0.0510s/iter; left time: 2065.3697s
Epoch: 2 cost time: 21.59596610069275
Epoch: 2, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.056 Vali Acc: 0.978 Test Loss: 0.056 Test Acc: 0.978
Validation loss decreased (-0.971805 --> -0.978171).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0038281
	speed: 0.1658s/iter; left time: 6692.2735s
	iters: 200, epoch: 3 | loss: 0.0030901
	speed: 0.0483s/iter; left time: 1946.9209s
	iters: 300, epoch: 3 | loss: 0.0017497
	speed: 0.0491s/iter; left time: 1971.1263s
	iters: 400, epoch: 3 | loss: 0.0371763
	speed: 0.0488s/iter; left time: 1956.1441s
Epoch: 3 cost time: 20.4155912399292
Epoch: 3, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0037382
	speed: 0.1564s/iter; left time: 6249.3811s
	iters: 200, epoch: 4 | loss: 0.0080104
	speed: 0.0483s/iter; left time: 1924.0886s
	iters: 300, epoch: 4 | loss: 0.0005210
	speed: 0.0488s/iter; left time: 1941.9661s
	iters: 400, epoch: 4 | loss: 0.0004423
	speed: 0.0488s/iter; left time: 1935.3897s
Epoch: 4 cost time: 20.577827215194702
Epoch: 4, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.980445).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0025038
	speed: 0.1679s/iter; left time: 6641.1213s
	iters: 200, epoch: 5 | loss: 0.1191896
	speed: 0.0513s/iter; left time: 2024.9900s
	iters: 300, epoch: 5 | loss: 0.0126398
	speed: 0.0478s/iter; left time: 1880.2442s
	iters: 400, epoch: 5 | loss: 0.0486134
	speed: 0.0498s/iter; left time: 1955.0179s
Epoch: 5 cost time: 21.075612783432007
Epoch: 5, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000647
	speed: 0.1770s/iter; left time: 6926.5415s
	iters: 200, epoch: 6 | loss: 0.0000706
	speed: 0.0506s/iter; left time: 1974.9938s
	iters: 300, epoch: 6 | loss: 0.0580784
	speed: 0.0507s/iter; left time: 1974.2827s
	iters: 400, epoch: 6 | loss: 0.0000779
	speed: 0.0499s/iter; left time: 1936.3846s
Epoch: 6 cost time: 21.37411594390869
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0950539
	speed: 0.1577s/iter; left time: 6107.3431s
	iters: 200, epoch: 7 | loss: 0.0076736
	speed: 0.0504s/iter; left time: 1944.9067s
	iters: 300, epoch: 7 | loss: 0.0000096
	speed: 0.0508s/iter; left time: 1956.8774s
	iters: 400, epoch: 7 | loss: 0.0011910
	speed: 0.0509s/iter; left time: 1954.1121s
Epoch: 7 cost time: 21.23093819618225
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0009394
	speed: 0.1604s/iter; left time: 6144.1596s
	iters: 200, epoch: 8 | loss: 0.0003546
	speed: 0.0500s/iter; left time: 1910.5551s
	iters: 300, epoch: 8 | loss: 0.0000516
	speed: 0.0532s/iter; left time: 2027.1466s
	iters: 400, epoch: 8 | loss: 0.0000066
	speed: 0.0507s/iter; left time: 1927.5581s
Epoch: 8 cost time: 21.453796863555908
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000066
	speed: 0.1721s/iter; left time: 6523.1693s
	iters: 200, epoch: 9 | loss: 0.0000721
	speed: 0.0450s/iter; left time: 1701.4883s
	iters: 300, epoch: 9 | loss: 0.0000006
	speed: 0.0478s/iter; left time: 1801.5328s
	iters: 400, epoch: 9 | loss: 0.0000340
	speed: 0.0490s/iter; left time: 1842.7631s
Epoch: 9 cost time: 20.08625292778015
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.981354).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0005968
	speed: 0.1576s/iter; left time: 5905.7227s
	iters: 200, epoch: 10 | loss: 0.0000032
	speed: 0.0492s/iter; left time: 1840.4740s
	iters: 300, epoch: 10 | loss: 0.0000009
	speed: 0.0472s/iter; left time: 1761.1380s
	iters: 400, epoch: 10 | loss: 0.0000013
	speed: 0.0507s/iter; left time: 1885.1996s
Epoch: 10 cost time: 20.561565160751343
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000077
	speed: 0.1607s/iter; left time: 5955.9588s
	iters: 200, epoch: 11 | loss: 0.0124961
	speed: 0.0482s/iter; left time: 1783.5512s
	iters: 300, epoch: 11 | loss: 0.0001247
	speed: 0.0476s/iter; left time: 1756.5633s
	iters: 400, epoch: 11 | loss: 0.0001194
	speed: 0.0499s/iter; left time: 1833.0601s
Epoch: 11 cost time: 20.564586400985718
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.982 Test Loss: 0.096 Test Acc: 0.982
Validation loss decreased (-0.981354 --> -0.982264).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0816541
	speed: 0.1737s/iter; left time: 6367.6085s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 1891.8906s
	iters: 300, epoch: 12 | loss: 0.0000115
	speed: 0.0507s/iter; left time: 1847.5519s
	iters: 400, epoch: 12 | loss: 0.0000020
	speed: 0.0535s/iter; left time: 1944.7063s
Epoch: 12 cost time: 21.657679557800293
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000008
	speed: 0.1622s/iter; left time: 5879.4463s
	iters: 200, epoch: 13 | loss: 0.0000005
	speed: 0.0518s/iter; left time: 1872.1098s
	iters: 300, epoch: 13 | loss: 0.0000382
	speed: 0.0512s/iter; left time: 1846.3344s
	iters: 400, epoch: 13 | loss: 0.0000006
	speed: 0.0519s/iter; left time: 1866.8955s
Epoch: 13 cost time: 21.618895292282104
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.235 Vali Acc: 0.970 Test Loss: 0.235 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1667s/iter; left time: 5974.3020s
	iters: 200, epoch: 14 | loss: 0.0000777
	speed: 0.0501s/iter; left time: 1790.3380s
	iters: 300, epoch: 14 | loss: 0.0002367
	speed: 0.0511s/iter; left time: 1821.4654s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0514s/iter; left time: 1826.1418s
Epoch: 14 cost time: 21.354978322982788
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0007583
	speed: 0.1817s/iter; left time: 6436.8057s
	iters: 200, epoch: 15 | loss: 0.0001316
	speed: 0.0518s/iter; left time: 1829.1242s
	iters: 300, epoch: 15 | loss: 0.0000795
	speed: 0.0496s/iter; left time: 1746.7784s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1797.4840s
Epoch: 15 cost time: 21.494481086730957
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.182 Vali Acc: 0.976 Test Loss: 0.182 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000610
	speed: 0.1838s/iter; left time: 6433.8438s
	iters: 200, epoch: 16 | loss: 0.0000026
	speed: 0.0500s/iter; left time: 1744.1713s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0504s/iter; left time: 1754.9719s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 1689.3984s
Epoch: 16 cost time: 20.882735013961792
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.146 Vali Acc: 0.980 Test Loss: 0.146 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000002
	speed: 0.1570s/iter; left time: 5431.2230s
	iters: 200, epoch: 17 | loss: 0.0000833
	speed: 0.0495s/iter; left time: 1706.6093s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1642.6152s
	iters: 400, epoch: 17 | loss: 0.0000421
	speed: 0.0490s/iter; left time: 1679.1400s
Epoch: 17 cost time: 20.680395126342773
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.168 Vali Acc: 0.980 Test Loss: 0.168 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000008
	speed: 0.1668s/iter; left time: 5699.8431s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 1862.0097s
	iters: 300, epoch: 18 | loss: 0.0180085
	speed: 0.0530s/iter; left time: 1800.7547s
	iters: 400, epoch: 18 | loss: 0.0003265
	speed: 0.0494s/iter; left time: 1674.2119s
Epoch: 18 cost time: 22.13493800163269
Epoch: 18, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.986 Test Loss: 0.083 Test Acc: 0.986
Validation loss decreased (-0.982264 --> -0.985902).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000007
	speed: 0.1755s/iter; left time: 5925.9484s
	iters: 200, epoch: 19 | loss: 0.0000010
	speed: 0.0506s/iter; left time: 1702.6159s
	iters: 300, epoch: 19 | loss: 0.0000094
	speed: 0.0516s/iter; left time: 1730.7164s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 1671.5541s
Epoch: 19 cost time: 21.30964207649231
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000396
	speed: 0.1552s/iter; left time: 5177.2985s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1628.9551s
	iters: 300, epoch: 20 | loss: 0.0000327
	speed: 0.0495s/iter; left time: 1639.4715s
	iters: 400, epoch: 20 | loss: 0.0000013
	speed: 0.0494s/iter; left time: 1631.8845s
Epoch: 20 cost time: 20.59329080581665
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.158 Vali Acc: 0.984 Test Loss: 0.158 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1620s/iter; left time: 5336.6947s
	iters: 200, epoch: 21 | loss: 0.0000062
	speed: 0.0513s/iter; left time: 1684.1552s
	iters: 300, epoch: 21 | loss: 0.0000021
	speed: 0.0528s/iter; left time: 1728.4958s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 1708.9488s
Epoch: 21 cost time: 21.4952290058136
Epoch: 21, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.159 Vali Acc: 0.978 Test Loss: 0.159 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.2726872
	speed: 0.1776s/iter; left time: 5777.2512s
	iters: 200, epoch: 22 | loss: 0.0001116
	speed: 0.0506s/iter; left time: 1641.9839s
	iters: 300, epoch: 22 | loss: 0.0184075
	speed: 0.0508s/iter; left time: 1643.1380s
	iters: 400, epoch: 22 | loss: 0.0057315
	speed: 0.0484s/iter; left time: 1560.5021s
Epoch: 22 cost time: 21.24097442626953
Epoch: 22, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.982 Test Loss: 0.143 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1640s/iter; left time: 5268.0755s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0483s/iter; left time: 1545.8396s
	iters: 300, epoch: 23 | loss: 0.0000268
	speed: 0.0490s/iter; left time: 1564.1195s
	iters: 400, epoch: 23 | loss: 0.3442955
	speed: 0.0483s/iter; left time: 1535.4470s
Epoch: 23 cost time: 20.597760915756226
Epoch: 23, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.163 Vali Acc: 0.981 Test Loss: 0.163 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0002253
	speed: 0.1564s/iter; left time: 4959.0466s
	iters: 200, epoch: 24 | loss: 0.0000002
	speed: 0.0512s/iter; left time: 1617.8395s
	iters: 300, epoch: 24 | loss: 0.0000034
	speed: 0.0502s/iter; left time: 1582.1680s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 1709.5887s
Epoch: 24 cost time: 21.683077573776245
Epoch: 24, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000002
	speed: 0.1747s/iter; left time: 5466.0042s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 1641.7095s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.0504s/iter; left time: 1568.3304s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0529s/iter; left time: 1640.3318s
Epoch: 25 cost time: 21.719478368759155
Epoch: 25, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.980 Test Loss: 0.191 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1531s/iter; left time: 4726.2841s
	iters: 200, epoch: 26 | loss: 0.0000001
	speed: 0.0478s/iter; left time: 1470.3770s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1447.1649s
	iters: 400, epoch: 26 | loss: 0.0031384
	speed: 0.0479s/iter; left time: 1464.8366s
Epoch: 26 cost time: 20.067221879959106
Epoch: 26, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.139 Vali Acc: 0.985 Test Loss: 0.139 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1394s/iter; left time: 4246.5087s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1517.8131s
	iters: 300, epoch: 27 | loss: 0.0067344
	speed: 0.0482s/iter; left time: 1459.9702s
	iters: 400, epoch: 27 | loss: 0.0000001
	speed: 0.0501s/iter; left time: 1510.8319s
Epoch: 27 cost time: 20.095296621322632
Epoch: 27, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.983 Test Loss: 0.136 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000004
	speed: 0.1744s/iter; left time: 5241.0670s
	iters: 200, epoch: 28 | loss: 0.0000017
	speed: 0.0520s/iter; left time: 1558.1710s
	iters: 300, epoch: 28 | loss: 0.0000478
	speed: 0.0508s/iter; left time: 1517.0719s
	iters: 400, epoch: 28 | loss: 0.0000052
	speed: 0.0496s/iter; left time: 1476.0811s
Epoch: 28 cost time: 21.306196689605713
Epoch: 28, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.976 Test Loss: 0.219 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 231698
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3703781
	speed: 0.0687s/iter; left time: 2831.4743s
	iters: 200, epoch: 1 | loss: 0.0505934
	speed: 0.0407s/iter; left time: 1673.5068s
	iters: 300, epoch: 1 | loss: 0.1564434
	speed: 0.0390s/iter; left time: 1600.3758s
	iters: 400, epoch: 1 | loss: 0.0088625
	speed: 0.0387s/iter; left time: 1584.8658s
Epoch: 1 cost time: 19.41602349281311
Epoch: 1, Steps: 413 | Train Loss: 0.406 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
Validation loss decreased (inf --> -0.969986).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0200188
	speed: 0.1508s/iter; left time: 6152.1517s
	iters: 200, epoch: 2 | loss: 0.0068798
	speed: 0.0501s/iter; left time: 2037.0195s
	iters: 300, epoch: 2 | loss: 0.1724836
	speed: 0.0505s/iter; left time: 2049.9151s
	iters: 400, epoch: 2 | loss: 0.0011350
	speed: 0.0487s/iter; left time: 1972.7653s
Epoch: 2 cost time: 20.770880460739136
Epoch: 2, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.057 Vali Acc: 0.981 Test Loss: 0.057 Test Acc: 0.981
Validation loss decreased (-0.969986 --> -0.981355).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0021936
	speed: 0.1533s/iter; left time: 6190.3144s
	iters: 200, epoch: 3 | loss: 0.0088992
	speed: 0.0496s/iter; left time: 1998.6327s
	iters: 300, epoch: 3 | loss: 0.0053789
	speed: 0.0500s/iter; left time: 2007.0060s
	iters: 400, epoch: 3 | loss: 0.0483291
	speed: 0.0500s/iter; left time: 2002.2856s
Epoch: 3 cost time: 20.977247953414917
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0048621
	speed: 0.1638s/iter; left time: 6545.0951s
	iters: 200, epoch: 4 | loss: 0.0035655
	speed: 0.0506s/iter; left time: 2016.0733s
	iters: 300, epoch: 4 | loss: 0.0000428
	speed: 0.0506s/iter; left time: 2010.2870s
	iters: 400, epoch: 4 | loss: 0.0062559
	speed: 0.0488s/iter; left time: 1935.8728s
Epoch: 4 cost time: 20.944443702697754
Epoch: 4, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0021738
	speed: 0.1684s/iter; left time: 6660.8503s
	iters: 200, epoch: 5 | loss: 0.2203325
	speed: 0.0496s/iter; left time: 1955.8214s
	iters: 300, epoch: 5 | loss: 0.0048773
	speed: 0.0469s/iter; left time: 1844.9634s
	iters: 400, epoch: 5 | loss: 0.0484021
	speed: 0.0461s/iter; left time: 1810.3431s
Epoch: 5 cost time: 20.384626626968384
Epoch: 5, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000359
	speed: 0.1576s/iter; left time: 6165.9398s
	iters: 200, epoch: 6 | loss: 0.0014697
	speed: 0.0476s/iter; left time: 1856.1874s
	iters: 300, epoch: 6 | loss: 0.0284730
	speed: 0.0479s/iter; left time: 1863.7250s
	iters: 400, epoch: 6 | loss: 0.0000064
	speed: 0.0487s/iter; left time: 1892.4543s
Epoch: 6 cost time: 20.123592138290405
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.172 Vali Acc: 0.968 Test Loss: 0.172 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0148962
	speed: 0.1476s/iter; left time: 5715.6932s
	iters: 200, epoch: 7 | loss: 0.0000939
	speed: 0.0449s/iter; left time: 1735.6591s
	iters: 300, epoch: 7 | loss: 0.0000797
	speed: 0.0529s/iter; left time: 2039.2537s
	iters: 400, epoch: 7 | loss: 0.0021407
	speed: 0.0532s/iter; left time: 2042.2778s
Epoch: 7 cost time: 20.646584510803223
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000013
	speed: 0.1791s/iter; left time: 6861.6299s
	iters: 200, epoch: 8 | loss: 0.0001344
	speed: 0.0526s/iter; left time: 2008.2122s
	iters: 300, epoch: 8 | loss: 0.0117657
	speed: 0.0515s/iter; left time: 1962.5328s
	iters: 400, epoch: 8 | loss: 0.0001729
	speed: 0.0518s/iter; left time: 1970.0143s
Epoch: 8 cost time: 21.857802152633667
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0238915
	speed: 0.1540s/iter; left time: 5835.2753s
	iters: 200, epoch: 9 | loss: 0.0000029
	speed: 0.0430s/iter; left time: 1626.4802s
	iters: 300, epoch: 9 | loss: 0.0000067
	speed: 0.0443s/iter; left time: 1671.0280s
	iters: 400, epoch: 9 | loss: 0.0003110
	speed: 0.0508s/iter; left time: 1911.3342s
Epoch: 9 cost time: 19.35601282119751
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0001014
	speed: 0.1560s/iter; left time: 5845.9664s
	iters: 200, epoch: 10 | loss: 0.0000009
	speed: 0.0492s/iter; left time: 1837.7031s
	iters: 300, epoch: 10 | loss: 0.0000012
	speed: 0.0500s/iter; left time: 1865.7617s
	iters: 400, epoch: 10 | loss: 0.0000009
	speed: 0.0496s/iter; left time: 1842.4962s
Epoch: 10 cost time: 20.907415628433228
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000324
	speed: 0.1762s/iter; left time: 6531.1301s
	iters: 200, epoch: 11 | loss: 0.0004372
	speed: 0.0498s/iter; left time: 1840.4899s
	iters: 300, epoch: 11 | loss: 0.0000003
	speed: 0.0513s/iter; left time: 1890.0371s
	iters: 400, epoch: 11 | loss: 0.1916936
	speed: 0.0532s/iter; left time: 1957.8534s
Epoch: 11 cost time: 21.84608793258667
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0726715
	speed: 0.1725s/iter; left time: 6324.3545s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.0479s/iter; left time: 1750.1743s
	iters: 300, epoch: 12 | loss: 0.0000130
	speed: 0.0472s/iter; left time: 1720.7474s
	iters: 400, epoch: 12 | loss: 0.0007080
	speed: 0.0472s/iter; left time: 1717.7682s
Epoch: 12 cost time: 20.22778630256653
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 231698
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3629825
	speed: 0.0676s/iter; left time: 2784.7943s
	iters: 200, epoch: 1 | loss: 0.0650029
	speed: 0.0477s/iter; left time: 1960.2077s
	iters: 300, epoch: 1 | loss: 0.1589580
	speed: 0.0459s/iter; left time: 1882.2672s
	iters: 400, epoch: 1 | loss: 0.0213993
	speed: 0.0470s/iter; left time: 1922.0685s
Epoch: 1 cost time: 21.568501472473145
Epoch: 1, Steps: 413 | Train Loss: 0.414 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
Validation loss decreased (inf --> -0.975443).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0152336
	speed: 0.1714s/iter; left time: 6990.7060s
	iters: 200, epoch: 2 | loss: 0.0077232
	speed: 0.0503s/iter; left time: 2045.3936s
	iters: 300, epoch: 2 | loss: 0.1948042
	speed: 0.0486s/iter; left time: 1974.1902s
	iters: 400, epoch: 2 | loss: 0.0073951
	speed: 0.0481s/iter; left time: 1945.6187s
Epoch: 2 cost time: 20.499541997909546
Epoch: 2, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.047 Vali Acc: 0.983 Test Loss: 0.047 Test Acc: 0.983
Validation loss decreased (-0.975443 --> -0.982719).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0060754
	speed: 0.1560s/iter; left time: 6297.5139s
	iters: 200, epoch: 3 | loss: 0.0028764
	speed: 0.0470s/iter; left time: 1891.6770s
	iters: 300, epoch: 3 | loss: 0.0016639
	speed: 0.0463s/iter; left time: 1861.8890s
	iters: 400, epoch: 3 | loss: 0.1482171
	speed: 0.0426s/iter; left time: 1707.1230s
Epoch: 3 cost time: 19.20413064956665
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0078645
	speed: 0.1429s/iter; left time: 5711.3600s
	iters: 200, epoch: 4 | loss: 0.0014160
	speed: 0.0488s/iter; left time: 1946.5266s
	iters: 300, epoch: 4 | loss: 0.0004879
	speed: 0.0502s/iter; left time: 1996.8986s
	iters: 400, epoch: 4 | loss: 0.0063887
	speed: 0.0511s/iter; left time: 2028.0446s
Epoch: 4 cost time: 20.83141851425171
Epoch: 4, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0055203
	speed: 0.1664s/iter; left time: 6582.5113s
	iters: 200, epoch: 5 | loss: 0.0788736
	speed: 0.0491s/iter; left time: 1938.8268s
	iters: 300, epoch: 5 | loss: 0.0029848
	speed: 0.0491s/iter; left time: 1933.0043s
	iters: 400, epoch: 5 | loss: 0.0000604
	speed: 0.0474s/iter; left time: 1860.5501s
Epoch: 5 cost time: 20.818952322006226
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000143
	speed: 0.1717s/iter; left time: 6718.1627s
	iters: 200, epoch: 6 | loss: 0.0000581
	speed: 0.0475s/iter; left time: 1853.6840s
	iters: 300, epoch: 6 | loss: 0.0001467
	speed: 0.0473s/iter; left time: 1841.1179s
	iters: 400, epoch: 6 | loss: 0.0000023
	speed: 0.0493s/iter; left time: 1913.9708s
Epoch: 6 cost time: 20.51999568939209
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000941
	speed: 0.1697s/iter; left time: 6569.6759s
	iters: 200, epoch: 7 | loss: 0.0000042
	speed: 0.0501s/iter; left time: 1933.9145s
	iters: 300, epoch: 7 | loss: 0.0000954
	speed: 0.0487s/iter; left time: 1874.7482s
	iters: 400, epoch: 7 | loss: 0.0000763
	speed: 0.0501s/iter; left time: 1925.3137s
Epoch: 7 cost time: 21.032336711883545
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0169594
	speed: 0.1658s/iter; left time: 6352.9551s
	iters: 200, epoch: 8 | loss: 0.0000182
	speed: 0.0525s/iter; left time: 2005.9114s
	iters: 300, epoch: 8 | loss: 0.0000513
	speed: 0.0509s/iter; left time: 1939.6469s
	iters: 400, epoch: 8 | loss: 0.0000575
	speed: 0.0515s/iter; left time: 1959.0843s
Epoch: 8 cost time: 21.67564368247986
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1734680
	speed: 0.1856s/iter; left time: 7034.9343s
	iters: 200, epoch: 9 | loss: 0.0000331
	speed: 0.0534s/iter; left time: 2019.2568s
	iters: 300, epoch: 9 | loss: 0.0001107
	speed: 0.0485s/iter; left time: 1828.8320s
	iters: 400, epoch: 9 | loss: 0.0087675
	speed: 0.0495s/iter; left time: 1860.2608s
Epoch: 9 cost time: 21.736597299575806
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000181
	speed: 0.1581s/iter; left time: 5925.1210s
	iters: 200, epoch: 10 | loss: 0.0000014
	speed: 0.0518s/iter; left time: 1935.1735s
	iters: 300, epoch: 10 | loss: 0.0000002
	speed: 0.0498s/iter; left time: 1855.9601s
	iters: 400, epoch: 10 | loss: 0.0003199
	speed: 0.0507s/iter; left time: 1884.9393s
Epoch: 10 cost time: 21.39684557914734
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000175
	speed: 0.1637s/iter; left time: 6068.8383s
	iters: 200, epoch: 11 | loss: 0.0000018
	speed: 0.0495s/iter; left time: 1831.6346s
	iters: 300, epoch: 11 | loss: 0.0040790
	speed: 0.0495s/iter; left time: 1823.6273s
	iters: 400, epoch: 11 | loss: 0.0065846
	speed: 0.0510s/iter; left time: 1874.0248s
Epoch: 11 cost time: 21.036264896392822
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.982719 --> -0.983173).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000302
	speed: 0.1754s/iter; left time: 6429.0546s
	iters: 200, epoch: 12 | loss: 0.0017405
	speed: 0.0524s/iter; left time: 1914.5969s
	iters: 300, epoch: 12 | loss: 0.0000007
	speed: 0.0507s/iter; left time: 1848.9811s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 1838.3930s
Epoch: 12 cost time: 21.723638772964478
Epoch: 12, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.984 Test Loss: 0.091 Test Acc: 0.984
Validation loss decreased (-0.983173 --> -0.983628).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000016
	speed: 0.1712s/iter; left time: 6205.5568s
	iters: 200, epoch: 13 | loss: 0.0000044
	speed: 0.0482s/iter; left time: 1742.6135s
	iters: 300, epoch: 13 | loss: 0.0000091
	speed: 0.0468s/iter; left time: 1688.2663s
	iters: 400, epoch: 13 | loss: 0.0125701
	speed: 0.0453s/iter; left time: 1629.3228s
Epoch: 13 cost time: 20.02227282524109
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.978 Test Loss: 0.137 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 0.1565s/iter; left time: 5609.2272s
	iters: 200, epoch: 14 | loss: 0.0008262
	speed: 0.0493s/iter; left time: 1761.4166s
	iters: 300, epoch: 14 | loss: 0.0000020
	speed: 0.0494s/iter; left time: 1758.4965s
	iters: 400, epoch: 14 | loss: 0.0000540
	speed: 0.0473s/iter; left time: 1679.0918s
Epoch: 14 cost time: 20.810206174850464
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.972 Test Loss: 0.214 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000122
	speed: 0.1790s/iter; left time: 6338.2706s
	iters: 200, epoch: 15 | loss: 0.0000009
	speed: 0.0498s/iter; left time: 1760.3416s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 1824.1545s
	iters: 400, epoch: 15 | loss: 0.0000070
	speed: 0.0533s/iter; left time: 1873.2784s
Epoch: 15 cost time: 21.687310457229614
Epoch: 15, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1663s/iter; left time: 5823.0216s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1709.9267s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0501s/iter; left time: 1743.9525s
	iters: 400, epoch: 16 | loss: 0.0000034
	speed: 0.0506s/iter; left time: 1757.5292s
Epoch: 16 cost time: 21.109795570373535
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.985 Test Loss: 0.093 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.984537).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1605s/iter; left time: 5552.9107s
	iters: 200, epoch: 17 | loss: 0.0004546
	speed: 0.0467s/iter; left time: 1611.9398s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1595.2753s
	iters: 400, epoch: 17 | loss: 0.0009523
	speed: 0.0459s/iter; left time: 1575.1564s
Epoch: 17 cost time: 20.03449821472168
Epoch: 17, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
Validation loss decreased (-0.984537 --> -0.986811).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000020
	speed: 0.1584s/iter; left time: 5413.8217s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 1716.6544s
	iters: 300, epoch: 18 | loss: 0.0000089
	speed: 0.0487s/iter; left time: 1655.7681s
	iters: 400, epoch: 18 | loss: 0.0000015
	speed: 0.0490s/iter; left time: 1661.2814s
Epoch: 18 cost time: 20.655431985855103
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000028
	speed: 0.1784s/iter; left time: 6025.0524s
	iters: 200, epoch: 19 | loss: 0.0000413
	speed: 0.0464s/iter; left time: 1561.8096s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 1529.0316s
	iters: 400, epoch: 19 | loss: 0.0005286
	speed: 0.0460s/iter; left time: 1540.4037s
Epoch: 19 cost time: 19.77922534942627
Epoch: 19, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.150 Vali Acc: 0.979 Test Loss: 0.150 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0001476
	speed: 0.1570s/iter; left time: 5237.5521s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1600.7736s
	iters: 300, epoch: 20 | loss: 0.0000055
	speed: 0.0469s/iter; left time: 1554.0995s
	iters: 400, epoch: 20 | loss: 0.0000216
	speed: 0.0455s/iter; left time: 1503.5053s
Epoch: 20 cost time: 19.772032260894775
Epoch: 20, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.983 Test Loss: 0.137 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1577s/iter; left time: 5195.1922s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 1703.5299s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 1722.3862s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.0516s/iter; left time: 1682.9793s
Epoch: 21 cost time: 21.729798793792725
Epoch: 21, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.139 Vali Acc: 0.979 Test Loss: 0.139 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000106
	speed: 0.1737s/iter; left time: 5649.4330s
	iters: 200, epoch: 22 | loss: 0.0105425
	speed: 0.0520s/iter; left time: 1687.5024s
	iters: 300, epoch: 22 | loss: 0.0009381
	speed: 0.0494s/iter; left time: 1597.7760s
	iters: 400, epoch: 22 | loss: 0.0000003
	speed: 0.0497s/iter; left time: 1601.0434s
Epoch: 22 cost time: 21.277576684951782
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1602s/iter; left time: 5143.7580s
	iters: 200, epoch: 23 | loss: 0.2668392
	speed: 0.0486s/iter; left time: 1555.1402s
	iters: 300, epoch: 23 | loss: 0.0020824
	speed: 0.0479s/iter; left time: 1528.3532s
	iters: 400, epoch: 23 | loss: 0.0000011
	speed: 0.0497s/iter; left time: 1582.2115s
Epoch: 23 cost time: 20.74109387397766
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0002064
	speed: 0.1626s/iter; left time: 5155.7927s
	iters: 200, epoch: 24 | loss: 0.0000117
	speed: 0.0494s/iter; left time: 1562.1176s
	iters: 300, epoch: 24 | loss: 0.0032752
	speed: 0.0506s/iter; left time: 1592.6287s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 1582.0847s
Epoch: 24 cost time: 20.95690083503723
Epoch: 24, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.149 Vali Acc: 0.984 Test Loss: 0.149 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.1846s/iter; left time: 5777.4001s
	iters: 200, epoch: 25 | loss: 0.0000786
	speed: 0.0509s/iter; left time: 1587.7516s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 1536.0131s
	iters: 400, epoch: 25 | loss: 0.0000266
	speed: 0.0519s/iter; left time: 1607.3779s
Epoch: 25 cost time: 21.558509349822998
Epoch: 25, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.270 Vali Acc: 0.973 Test Loss: 0.270 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1677s/iter; left time: 5178.6693s
	iters: 200, epoch: 26 | loss: 0.0052468
	speed: 0.0485s/iter; left time: 1493.0216s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 1505.2815s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1446.9116s
Epoch: 26 cost time: 20.518435955047607
Epoch: 26, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.169 Vali Acc: 0.980 Test Loss: 0.169 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000009
	speed: 0.1589s/iter; left time: 4840.8069s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1580.7234s
	iters: 300, epoch: 27 | loss: 0.0000012
	speed: 0.0485s/iter; left time: 1466.9360s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 1470.6710s
Epoch: 27 cost time: 20.933717489242554
Epoch: 27, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.124 Vali Acc: 0.981 Test Loss: 0.124 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 231698
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4183537
	speed: 0.0663s/iter; left time: 2730.3183s
	iters: 200, epoch: 1 | loss: 0.0495963
	speed: 0.0492s/iter; left time: 2024.1102s
	iters: 300, epoch: 1 | loss: 0.2295406
	speed: 0.0459s/iter; left time: 1880.8257s
	iters: 400, epoch: 1 | loss: 0.0153634
	speed: 0.0437s/iter; left time: 1788.6162s
Epoch: 1 cost time: 21.2295560836792
Epoch: 1, Steps: 413 | Train Loss: 0.465 Vali Loss: 0.081 Vali Acc: 0.972 Test Loss: 0.081 Test Acc: 0.972
Validation loss decreased (inf --> -0.971805).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0159147
	speed: 0.1494s/iter; left time: 6095.5801s
	iters: 200, epoch: 2 | loss: 0.0094996
	speed: 0.0447s/iter; left time: 1819.6844s
	iters: 300, epoch: 2 | loss: 0.1120515
	speed: 0.0434s/iter; left time: 1760.7355s
	iters: 400, epoch: 2 | loss: 0.0047980
	speed: 0.0434s/iter; left time: 1758.1163s
Epoch: 2 cost time: 18.686171531677246
Epoch: 2, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.048 Vali Acc: 0.983 Test Loss: 0.048 Test Acc: 0.983
Validation loss decreased (-0.971805 --> -0.982719).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0019626
	speed: 0.1555s/iter; left time: 6276.5940s
	iters: 200, epoch: 3 | loss: 0.0087891
	speed: 0.0448s/iter; left time: 1802.9283s
	iters: 300, epoch: 3 | loss: 0.0037349
	speed: 0.0435s/iter; left time: 1748.8019s
	iters: 400, epoch: 3 | loss: 0.0018712
	speed: 0.0504s/iter; left time: 2019.3265s
Epoch: 3 cost time: 19.573184967041016
Epoch: 3, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0028589
	speed: 0.1729s/iter; left time: 6908.0965s
	iters: 200, epoch: 4 | loss: 0.0076937
	speed: 0.0517s/iter; left time: 2058.9326s
	iters: 300, epoch: 4 | loss: 0.0043452
	speed: 0.0485s/iter; left time: 1929.7921s
	iters: 400, epoch: 4 | loss: 0.3063830
	speed: 0.0476s/iter; left time: 1889.4807s
Epoch: 4 cost time: 20.23650574684143
Epoch: 4, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1459822
	speed: 0.1634s/iter; left time: 6463.5663s
	iters: 200, epoch: 5 | loss: 0.0166543
	speed: 0.0454s/iter; left time: 1789.4329s
	iters: 300, epoch: 5 | loss: 0.1176556
	speed: 0.0442s/iter; left time: 1740.3957s
	iters: 400, epoch: 5 | loss: 0.0000258
	speed: 0.0453s/iter; left time: 1776.4502s
Epoch: 5 cost time: 18.87525486946106
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0010008
	speed: 0.1546s/iter; left time: 6049.1412s
	iters: 200, epoch: 6 | loss: 0.0121223
	speed: 0.0470s/iter; left time: 1834.6291s
	iters: 300, epoch: 6 | loss: 0.0021770
	speed: 0.0464s/iter; left time: 1805.4371s
	iters: 400, epoch: 6 | loss: 0.0000031
	speed: 0.0453s/iter; left time: 1759.9002s
Epoch: 6 cost time: 19.588744163513184
Epoch: 6, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0003043
	speed: 0.1518s/iter; left time: 5879.4275s
	iters: 200, epoch: 7 | loss: 0.0003534
	speed: 0.0477s/iter; left time: 1840.4722s
	iters: 300, epoch: 7 | loss: 0.0000543
	speed: 0.0478s/iter; left time: 1842.4586s
	iters: 400, epoch: 7 | loss: 0.0001088
	speed: 0.0445s/iter; left time: 1708.1970s
Epoch: 7 cost time: 19.72989296913147
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000369
	speed: 0.1603s/iter; left time: 6140.8121s
	iters: 200, epoch: 8 | loss: 0.0000253
	speed: 0.0478s/iter; left time: 1826.8254s
	iters: 300, epoch: 8 | loss: 0.0000372
	speed: 0.0428s/iter; left time: 1632.7187s
	iters: 400, epoch: 8 | loss: 0.0013079
	speed: 0.0449s/iter; left time: 1708.3555s
Epoch: 8 cost time: 19.194453239440918
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0070444
	speed: 0.1539s/iter; left time: 5831.5044s
	iters: 200, epoch: 9 | loss: 0.0001289
	speed: 0.0431s/iter; left time: 1629.1209s
	iters: 300, epoch: 9 | loss: 0.0001348
	speed: 0.0428s/iter; left time: 1613.2712s
	iters: 400, epoch: 9 | loss: 0.0000055
	speed: 0.0458s/iter; left time: 1722.2622s
Epoch: 9 cost time: 18.494527578353882
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000064
	speed: 0.1530s/iter; left time: 5733.2193s
	iters: 200, epoch: 10 | loss: 0.0063673
	speed: 0.0453s/iter; left time: 1691.9204s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 1883.2832s
	iters: 400, epoch: 10 | loss: 0.0021774
	speed: 0.0481s/iter; left time: 1788.9345s
Epoch: 10 cost time: 20.073363065719604
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0010886
	speed: 0.1778s/iter; left time: 6589.4356s
	iters: 200, epoch: 11 | loss: 0.0002512
	speed: 0.0468s/iter; left time: 1730.0319s
	iters: 300, epoch: 11 | loss: 0.0059226
	speed: 0.0504s/iter; left time: 1858.2242s
	iters: 400, epoch: 11 | loss: 0.0082959
	speed: 0.0487s/iter; left time: 1792.0926s
Epoch: 11 cost time: 20.37227177619934
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0014104
	speed: 0.1504s/iter; left time: 5513.5756s
	iters: 200, epoch: 12 | loss: 0.0123052
	speed: 0.0453s/iter; left time: 1654.9311s
	iters: 300, epoch: 12 | loss: 0.0013065
	speed: 0.0449s/iter; left time: 1636.4704s
	iters: 400, epoch: 12 | loss: 0.0000005
	speed: 0.0469s/iter; left time: 1704.3055s
Epoch: 12 cost time: 19.248222827911377
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 231698
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5213776
	speed: 0.0660s/iter; left time: 2717.3528s
	iters: 200, epoch: 1 | loss: 0.2830642
	speed: 0.0442s/iter; left time: 1816.3271s
	iters: 300, epoch: 1 | loss: 0.0580158
	speed: 0.0490s/iter; left time: 2008.1075s
	iters: 400, epoch: 1 | loss: 0.1302272
	speed: 0.0503s/iter; left time: 2056.3062s
Epoch: 1 cost time: 21.672871112823486
Epoch: 1, Steps: 413 | Train Loss: 0.527 Vali Loss: 0.109 Vali Acc: 0.966 Test Loss: 0.109 Test Acc: 0.966
Validation loss decreased (inf --> -0.966347).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2696231
	speed: 0.1674s/iter; left time: 6827.3975s
	iters: 200, epoch: 2 | loss: 0.0056706
	speed: 0.0478s/iter; left time: 1945.1155s
	iters: 300, epoch: 2 | loss: 0.0714954
	speed: 0.0488s/iter; left time: 1979.4380s
	iters: 400, epoch: 2 | loss: 0.0327735
	speed: 0.0517s/iter; left time: 2094.7456s
Epoch: 2 cost time: 20.621618032455444
Epoch: 2, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.055 Vali Acc: 0.978 Test Loss: 0.055 Test Acc: 0.978
Validation loss decreased (-0.966347 --> -0.978171).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0939661
	speed: 0.1658s/iter; left time: 6694.8925s
	iters: 200, epoch: 3 | loss: 0.0138774
	speed: 0.0499s/iter; left time: 2011.1743s
	iters: 300, epoch: 3 | loss: 0.1158481
	speed: 0.0423s/iter; left time: 1697.9824s
	iters: 400, epoch: 3 | loss: 0.3673767
	speed: 0.0371s/iter; left time: 1488.7644s
Epoch: 3 cost time: 19.039769172668457
Epoch: 3, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.090 Vali Acc: 0.969 Test Loss: 0.090 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0025490
	speed: 0.1532s/iter; left time: 6122.9232s
	iters: 200, epoch: 4 | loss: 0.0093822
	speed: 0.0470s/iter; left time: 1873.0252s
	iters: 300, epoch: 4 | loss: 0.0182412
	speed: 0.0454s/iter; left time: 1805.9230s
	iters: 400, epoch: 4 | loss: 0.0036736
	speed: 0.0482s/iter; left time: 1912.1057s
Epoch: 4 cost time: 19.589828491210938
Epoch: 4, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0045544
	speed: 0.1578s/iter; left time: 6240.2780s
	iters: 200, epoch: 5 | loss: 0.1848935
	speed: 0.0472s/iter; left time: 1862.2604s
	iters: 300, epoch: 5 | loss: 0.0014572
	speed: 0.0458s/iter; left time: 1803.0604s
	iters: 400, epoch: 5 | loss: 0.0018066
	speed: 0.0469s/iter; left time: 1840.1759s
Epoch: 5 cost time: 19.51220202445984
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0003623
	speed: 0.1559s/iter; left time: 6101.4547s
	iters: 200, epoch: 6 | loss: 0.0062166
	speed: 0.0513s/iter; left time: 2002.3239s
	iters: 300, epoch: 6 | loss: 0.0021450
	speed: 0.0489s/iter; left time: 1902.7335s
	iters: 400, epoch: 6 | loss: 0.0423574
	speed: 0.0471s/iter; left time: 1829.4929s
Epoch: 6 cost time: 20.500561952590942
Epoch: 6, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1463900
	speed: 0.1654s/iter; left time: 6403.8586s
	iters: 200, epoch: 7 | loss: 0.0101267
	speed: 0.0461s/iter; left time: 1779.8973s
	iters: 300, epoch: 7 | loss: 0.0067176
	speed: 0.0474s/iter; left time: 1826.2690s
	iters: 400, epoch: 7 | loss: 0.0000314
	speed: 0.0477s/iter; left time: 1833.1785s
Epoch: 7 cost time: 19.913462162017822
Epoch: 7, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0001003
	speed: 0.1426s/iter; left time: 5464.8918s
	iters: 200, epoch: 8 | loss: 0.0002946
	speed: 0.0420s/iter; left time: 1605.0818s
	iters: 300, epoch: 8 | loss: 0.0002125
	speed: 0.0430s/iter; left time: 1637.5558s
	iters: 400, epoch: 8 | loss: 0.0000541
	speed: 0.0467s/iter; left time: 1773.4363s
Epoch: 8 cost time: 18.476627826690674
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0746666
	speed: 0.1611s/iter; left time: 6105.5674s
	iters: 200, epoch: 9 | loss: 0.1763252
	speed: 0.0501s/iter; left time: 1895.2348s
	iters: 300, epoch: 9 | loss: 0.0000287
	speed: 0.0531s/iter; left time: 2001.8372s
	iters: 400, epoch: 9 | loss: 0.0000055
	speed: 0.0495s/iter; left time: 1860.3739s
Epoch: 9 cost time: 20.992090463638306
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
Validation loss decreased (-0.978171 --> -0.979080).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000514
	speed: 0.1773s/iter; left time: 6645.7952s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.0480s/iter; left time: 1796.1892s
	iters: 300, epoch: 10 | loss: 0.0666801
	speed: 0.0473s/iter; left time: 1762.4187s
	iters: 400, epoch: 10 | loss: 0.0001342
	speed: 0.0496s/iter; left time: 1845.9675s
Epoch: 10 cost time: 20.62425971031189
Epoch: 10, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.979080 --> -0.983173).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0001579
	speed: 0.1558s/iter; left time: 5776.5408s
	iters: 200, epoch: 11 | loss: 0.0122251
	speed: 0.0465s/iter; left time: 1720.0894s
	iters: 300, epoch: 11 | loss: 0.0307513
	speed: 0.0469s/iter; left time: 1729.6953s
	iters: 400, epoch: 11 | loss: 0.0000171
	speed: 0.0443s/iter; left time: 1629.9512s
Epoch: 11 cost time: 19.330855131149292
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
Validation loss decreased (-0.983173 --> -0.984083).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000139
	speed: 0.1491s/iter; left time: 5464.1677s
	iters: 200, epoch: 12 | loss: 0.0000883
	speed: 0.0487s/iter; left time: 1781.8135s
	iters: 300, epoch: 12 | loss: 0.0000131
	speed: 0.0477s/iter; left time: 1737.4596s
	iters: 400, epoch: 12 | loss: 0.0000055
	speed: 0.0470s/iter; left time: 1707.1330s
Epoch: 12 cost time: 19.971121549606323
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000699
	speed: 0.1666s/iter; left time: 6036.8236s
	iters: 200, epoch: 13 | loss: 0.0000031
	speed: 0.0495s/iter; left time: 1788.6928s
	iters: 300, epoch: 13 | loss: 0.0004513
	speed: 0.0464s/iter; left time: 1673.5156s
	iters: 400, epoch: 13 | loss: 0.0012505
	speed: 0.0494s/iter; left time: 1777.0625s
Epoch: 13 cost time: 20.5341477394104
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000014
	speed: 0.1640s/iter; left time: 5874.7650s
	iters: 200, epoch: 14 | loss: 0.0251024
	speed: 0.0442s/iter; left time: 1580.1671s
	iters: 300, epoch: 14 | loss: 0.0000198
	speed: 0.0460s/iter; left time: 1638.1974s
	iters: 400, epoch: 14 | loss: 0.0000082
	speed: 0.0463s/iter; left time: 1645.6766s
Epoch: 14 cost time: 19.29509139060974
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.178 Vali Acc: 0.969 Test Loss: 0.178 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0009306
	speed: 0.1606s/iter; left time: 5688.7320s
	iters: 200, epoch: 15 | loss: 0.0000112
	speed: 0.0460s/iter; left time: 1623.6068s
	iters: 300, epoch: 15 | loss: 0.0000596
	speed: 0.0469s/iter; left time: 1650.2908s
	iters: 400, epoch: 15 | loss: 0.0000111
	speed: 0.0457s/iter; left time: 1606.3667s
Epoch: 15 cost time: 19.54339599609375
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000013
	speed: 0.1542s/iter; left time: 5398.9941s
	iters: 200, epoch: 16 | loss: 0.0004326
	speed: 0.0504s/iter; left time: 1757.6093s
	iters: 300, epoch: 16 | loss: 0.0005514
	speed: 0.0482s/iter; left time: 1679.0168s
	iters: 400, epoch: 16 | loss: 0.0000057
	speed: 0.0487s/iter; left time: 1689.8057s
Epoch: 16 cost time: 20.588297128677368
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.1763s/iter; left time: 6097.2558s
	iters: 200, epoch: 17 | loss: 0.0014103
	speed: 0.0476s/iter; left time: 1642.5235s
	iters: 300, epoch: 17 | loss: 0.0000797
	speed: 0.0506s/iter; left time: 1739.4779s
	iters: 400, epoch: 17 | loss: 0.0053027
	speed: 0.0432s/iter; left time: 1481.5478s
Epoch: 17 cost time: 19.95557141304016
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.1516s/iter; left time: 5183.3386s
	iters: 200, epoch: 18 | loss: 0.0013903
	speed: 0.0465s/iter; left time: 1585.4076s
	iters: 300, epoch: 18 | loss: 0.0000003
	speed: 0.0459s/iter; left time: 1559.4486s
	iters: 400, epoch: 18 | loss: 0.0000009
	speed: 0.0476s/iter; left time: 1611.3577s
Epoch: 18 cost time: 19.63263964653015
Epoch: 18, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000024
	speed: 0.1532s/iter; left time: 5173.1048s
	iters: 200, epoch: 19 | loss: 0.0000003
	speed: 0.0468s/iter; left time: 1574.8841s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1524.0288s
	iters: 400, epoch: 19 | loss: 0.0023339
	speed: 0.0423s/iter; left time: 1415.3790s
Epoch: 19 cost time: 19.038732290267944
Epoch: 19, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1626s/iter; left time: 5422.6480s
	iters: 200, epoch: 20 | loss: 0.0000040
	speed: 0.0475s/iter; left time: 1579.8947s
	iters: 300, epoch: 20 | loss: 0.0010658
	speed: 0.0516s/iter; left time: 1710.2874s
	iters: 400, epoch: 20 | loss: 0.0000189
	speed: 0.0491s/iter; left time: 1621.7444s
Epoch: 20 cost time: 20.761209964752197
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000004
	speed: 0.1779s/iter; left time: 5860.8455s
	iters: 200, epoch: 21 | loss: 0.0001105
	speed: 0.0473s/iter; left time: 1553.6624s
	iters: 300, epoch: 21 | loss: 0.0000351
	speed: 0.0473s/iter; left time: 1550.2311s
	iters: 400, epoch: 21 | loss: 0.0001721
	speed: 0.0495s/iter; left time: 1614.7679s
Epoch: 21 cost time: 20.194952487945557
Epoch: 21, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.974 Test Loss: 0.151 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 607442
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5184413
	speed: 0.0651s/iter; left time: 2681.7722s
	iters: 200, epoch: 1 | loss: 0.2667892
	speed: 0.0462s/iter; left time: 1898.7641s
	iters: 300, epoch: 1 | loss: 0.0683858
	speed: 0.0498s/iter; left time: 2042.7654s
	iters: 400, epoch: 1 | loss: 0.0777796
	speed: 0.0484s/iter; left time: 1981.4600s
Epoch: 1 cost time: 21.649489164352417
Epoch: 1, Steps: 413 | Train Loss: 0.526 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (inf --> -0.971350).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2903361
	speed: 0.1708s/iter; left time: 6966.8668s
	iters: 200, epoch: 2 | loss: 0.0063430
	speed: 0.0479s/iter; left time: 1947.4078s
	iters: 300, epoch: 2 | loss: 0.0334612
	speed: 0.0476s/iter; left time: 1932.3084s
	iters: 400, epoch: 2 | loss: 0.0388913
	speed: 0.0478s/iter; left time: 1937.2586s
Epoch: 2 cost time: 20.083886861801147
Epoch: 2, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.057 Vali Acc: 0.980 Test Loss: 0.057 Test Acc: 0.980
Validation loss decreased (-0.971350 --> -0.979536).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0983271
	speed: 0.1545s/iter; left time: 6236.7126s
	iters: 200, epoch: 3 | loss: 0.0059613
	speed: 0.0469s/iter; left time: 1888.7067s
	iters: 300, epoch: 3 | loss: 0.1061464
	speed: 0.0469s/iter; left time: 1882.4472s
	iters: 400, epoch: 3 | loss: 0.2096692
	speed: 0.0479s/iter; left time: 1920.8315s
Epoch: 3 cost time: 20.0372793674469
Epoch: 3, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0063659
	speed: 0.1528s/iter; left time: 6106.1047s
	iters: 200, epoch: 4 | loss: 0.0435823
	speed: 0.0470s/iter; left time: 1872.6106s
	iters: 300, epoch: 4 | loss: 0.0515469
	speed: 0.0476s/iter; left time: 1891.0567s
	iters: 400, epoch: 4 | loss: 0.0109175
	speed: 0.0479s/iter; left time: 1901.7771s
Epoch: 4 cost time: 19.97369694709778
Epoch: 4, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0011770
	speed: 0.1649s/iter; left time: 6521.8735s
	iters: 200, epoch: 5 | loss: 0.1786998
	speed: 0.0516s/iter; left time: 2037.0102s
	iters: 300, epoch: 5 | loss: 0.0125653
	speed: 0.0532s/iter; left time: 2091.9672s
	iters: 400, epoch: 5 | loss: 0.0035255
	speed: 0.0484s/iter; left time: 1898.4816s
Epoch: 5 cost time: 21.561585426330566
Epoch: 5, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0011576
	speed: 0.1712s/iter; left time: 6699.1647s
	iters: 200, epoch: 6 | loss: 0.0367580
	speed: 0.0459s/iter; left time: 1790.0451s
	iters: 300, epoch: 6 | loss: 0.0000357
	speed: 0.0464s/iter; left time: 1806.6566s
	iters: 400, epoch: 6 | loss: 0.0373399
	speed: 0.0445s/iter; left time: 1730.0362s
Epoch: 6 cost time: 19.74380922317505
Epoch: 6, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0117651
	speed: 0.1606s/iter; left time: 6218.4355s
	iters: 200, epoch: 7 | loss: 0.0065608
	speed: 0.0446s/iter; left time: 1723.3775s
	iters: 300, epoch: 7 | loss: 0.0048089
	speed: 0.0450s/iter; left time: 1734.5745s
	iters: 400, epoch: 7 | loss: 0.0000069
	speed: 0.0462s/iter; left time: 1773.3798s
Epoch: 7 cost time: 19.1747624874115
Epoch: 7, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000571
	speed: 0.1478s/iter; left time: 5663.4426s
	iters: 200, epoch: 8 | loss: 0.0000674
	speed: 0.0447s/iter; left time: 1709.2628s
	iters: 300, epoch: 8 | loss: 0.0003434
	speed: 0.0473s/iter; left time: 1801.5020s
	iters: 400, epoch: 8 | loss: 0.9090424
	speed: 0.0466s/iter; left time: 1769.3893s
Epoch: 8 cost time: 19.283790588378906
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.171 Vali Acc: 0.966 Test Loss: 0.171 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0001594
	speed: 0.1704s/iter; left time: 6459.5341s
	iters: 200, epoch: 9 | loss: 0.4391152
	speed: 0.0482s/iter; left time: 1822.0203s
	iters: 300, epoch: 9 | loss: 0.0011468
	speed: 0.0477s/iter; left time: 1797.4504s
	iters: 400, epoch: 9 | loss: 0.0000902
	speed: 0.0504s/iter; left time: 1894.1008s
Epoch: 9 cost time: 20.457854986190796
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0018161
	speed: 0.1539s/iter; left time: 5767.2242s
	iters: 200, epoch: 10 | loss: 0.0001282
	speed: 0.0455s/iter; left time: 1699.7410s
	iters: 300, epoch: 10 | loss: 0.0000283
	speed: 0.0456s/iter; left time: 1700.2415s
	iters: 400, epoch: 10 | loss: 0.0007088
	speed: 0.0461s/iter; left time: 1715.1718s
Epoch: 10 cost time: 19.626717805862427
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000568
	speed: 0.1511s/iter; left time: 5601.6933s
	iters: 200, epoch: 11 | loss: 0.0011079
	speed: 0.0489s/iter; left time: 1809.0488s
	iters: 300, epoch: 11 | loss: 0.1026789
	speed: 0.0451s/iter; left time: 1664.4976s
	iters: 400, epoch: 11 | loss: 0.0000823
	speed: 0.0450s/iter; left time: 1653.2813s
Epoch: 11 cost time: 19.684250593185425
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.179 Vali Acc: 0.969 Test Loss: 0.179 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000067
	speed: 0.1611s/iter; left time: 5904.5754s
	iters: 200, epoch: 12 | loss: 0.0000675
	speed: 0.0487s/iter; left time: 1780.5486s
	iters: 300, epoch: 12 | loss: 0.0000451
	speed: 0.0476s/iter; left time: 1736.1465s
	iters: 400, epoch: 12 | loss: 0.0005940
	speed: 0.0504s/iter; left time: 1831.6728s
Epoch: 12 cost time: 20.59033465385437
Epoch: 12, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.979536 --> -0.982719).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0015439
	speed: 0.1765s/iter; left time: 6398.3247s
	iters: 200, epoch: 13 | loss: 0.0000085
	speed: 0.0489s/iter; left time: 1769.0701s
	iters: 300, epoch: 13 | loss: 0.0005212
	speed: 0.0454s/iter; left time: 1636.4020s
	iters: 400, epoch: 13 | loss: 0.0283771
	speed: 0.0459s/iter; left time: 1649.7299s
Epoch: 13 cost time: 20.15775203704834
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000202
	speed: 0.1523s/iter; left time: 5458.6641s
	iters: 200, epoch: 14 | loss: 0.0179972
	speed: 0.0461s/iter; left time: 1645.9881s
	iters: 300, epoch: 14 | loss: 0.0000045
	speed: 0.0470s/iter; left time: 1673.0676s
	iters: 400, epoch: 14 | loss: 0.1386669
	speed: 0.0445s/iter; left time: 1581.7151s
Epoch: 14 cost time: 19.247711420059204
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.184 Vali Acc: 0.971 Test Loss: 0.184 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000038
	speed: 0.1524s/iter; left time: 5399.3603s
	iters: 200, epoch: 15 | loss: 0.0000881
	speed: 0.0447s/iter; left time: 1578.0979s
	iters: 300, epoch: 15 | loss: 0.0002812
	speed: 0.0473s/iter; left time: 1666.2961s
	iters: 400, epoch: 15 | loss: 0.0013889
	speed: 0.0495s/iter; left time: 1738.3031s
Epoch: 15 cost time: 19.891228199005127
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000096
	speed: 0.1726s/iter; left time: 6043.4478s
	iters: 200, epoch: 16 | loss: 0.0182376
	speed: 0.0482s/iter; left time: 1681.9837s
	iters: 300, epoch: 16 | loss: 0.0004412
	speed: 0.0498s/iter; left time: 1732.7272s
	iters: 400, epoch: 16 | loss: 0.0000004
	speed: 0.0495s/iter; left time: 1716.9248s
Epoch: 16 cost time: 20.705971479415894
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000066
	speed: 0.1527s/iter; left time: 5281.4145s
	iters: 200, epoch: 17 | loss: 0.0001230
	speed: 0.0471s/iter; left time: 1624.6970s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0455s/iter; left time: 1566.1292s
	iters: 400, epoch: 17 | loss: 0.0000178
	speed: 0.0467s/iter; left time: 1600.3722s
Epoch: 17 cost time: 19.813041925430298
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000009
	speed: 0.1580s/iter; left time: 5400.1414s
	iters: 200, epoch: 18 | loss: 0.0000170
	speed: 0.0461s/iter; left time: 1571.1009s
	iters: 300, epoch: 18 | loss: 0.0000189
	speed: 0.0465s/iter; left time: 1580.7659s
	iters: 400, epoch: 18 | loss: 0.0000002
	speed: 0.0446s/iter; left time: 1511.4667s
Epoch: 18 cost time: 19.25266933441162
Epoch: 18, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.1721s/iter; left time: 5812.2722s
	iters: 200, epoch: 19 | loss: 0.0002260
	speed: 0.0481s/iter; left time: 1619.6976s
	iters: 300, epoch: 19 | loss: 0.0000022
	speed: 0.0477s/iter; left time: 1600.7994s
	iters: 400, epoch: 19 | loss: 0.0841348
	speed: 0.0454s/iter; left time: 1520.4254s
Epoch: 19 cost time: 20.38298273086548
Epoch: 19, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000003
	speed: 0.1726s/iter; left time: 5756.9459s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0449s/iter; left time: 1491.7332s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 1514.7038s
	iters: 400, epoch: 20 | loss: 0.0000014
	speed: 0.0449s/iter; left time: 1483.7035s
Epoch: 20 cost time: 19.395265340805054
Epoch: 20, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000030
	speed: 0.1495s/iter; left time: 4925.6034s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0465s/iter; left time: 1525.5410s
	iters: 300, epoch: 21 | loss: 0.0000231
	speed: 0.0450s/iter; left time: 1473.2167s
	iters: 400, epoch: 21 | loss: 0.0000046
	speed: 0.0449s/iter; left time: 1465.5218s
Epoch: 21 cost time: 19.271836042404175
Epoch: 21, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000023
	speed: 0.1509s/iter; left time: 4908.0820s
	iters: 200, epoch: 22 | loss: 0.0124506
	speed: 0.0431s/iter; left time: 1396.8306s
	iters: 300, epoch: 22 | loss: 0.0000518
	speed: 0.0463s/iter; left time: 1495.8369s
	iters: 400, epoch: 22 | loss: 0.0000002
	speed: 0.0498s/iter; left time: 1606.0903s
Epoch: 22 cost time: 19.487555027008057
Epoch: 22, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 607442
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5354276
	speed: 0.0638s/iter; left time: 2627.2152s
	iters: 200, epoch: 1 | loss: 0.3081175
	speed: 0.0448s/iter; left time: 1840.5578s
	iters: 300, epoch: 1 | loss: 0.0743351
	speed: 0.0430s/iter; left time: 1764.1856s
	iters: 400, epoch: 1 | loss: 0.0709333
	speed: 0.0428s/iter; left time: 1749.9716s
Epoch: 1 cost time: 20.10396456718445
Epoch: 1, Steps: 413 | Train Loss: 0.536 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (inf --> -0.968166).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1640499
	speed: 0.1518s/iter; left time: 6193.0500s
	iters: 200, epoch: 2 | loss: 0.0041186
	speed: 0.0461s/iter; left time: 1874.2173s
	iters: 300, epoch: 2 | loss: 0.0236868
	speed: 0.0441s/iter; left time: 1788.3977s
	iters: 400, epoch: 2 | loss: 0.0196674
	speed: 0.0426s/iter; left time: 1726.2589s
Epoch: 2 cost time: 18.77134871482849
Epoch: 2, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.968166 --> -0.979536).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0370295
	speed: 0.1497s/iter; left time: 6045.2049s
	iters: 200, epoch: 3 | loss: 0.0077579
	speed: 0.0475s/iter; left time: 1914.6077s
	iters: 300, epoch: 3 | loss: 0.0114828
	speed: 0.0490s/iter; left time: 1967.3612s
	iters: 400, epoch: 3 | loss: 0.3428151
	speed: 0.0438s/iter; left time: 1756.6925s
Epoch: 3 cost time: 19.369580030441284
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.054 Vali Acc: 0.980 Test Loss: 0.054 Test Acc: 0.980
Validation loss decreased (-0.979536 --> -0.980445).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0053049
	speed: 0.1644s/iter; left time: 6569.7978s
	iters: 200, epoch: 4 | loss: 0.0034728
	speed: 0.0442s/iter; left time: 1760.5025s
	iters: 300, epoch: 4 | loss: 0.0153024
	speed: 0.0457s/iter; left time: 1818.0204s
	iters: 400, epoch: 4 | loss: 0.0655266
	speed: 0.0470s/iter; left time: 1863.1189s
Epoch: 4 cost time: 19.428179502487183
Epoch: 4, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.076 Vali Acc: 0.974 Test Loss: 0.076 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0666933
	speed: 0.1438s/iter; left time: 5687.7084s
	iters: 200, epoch: 5 | loss: 0.0420470
	speed: 0.0441s/iter; left time: 1738.7245s
	iters: 300, epoch: 5 | loss: 0.0007204
	speed: 0.0420s/iter; left time: 1653.5156s
	iters: 400, epoch: 5 | loss: 0.0007240
	speed: 0.0424s/iter; left time: 1664.9950s
Epoch: 5 cost time: 18.209295749664307
Epoch: 5, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.037 Vali Acc: 0.985 Test Loss: 0.037 Test Acc: 0.985
Validation loss decreased (-0.980445 --> -0.984538).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0007390
	speed: 0.1451s/iter; left time: 5678.5653s
	iters: 200, epoch: 6 | loss: 0.0583335
	speed: 0.0450s/iter; left time: 1755.9839s
	iters: 300, epoch: 6 | loss: 0.0000702
	speed: 0.0439s/iter; left time: 1709.7671s
	iters: 400, epoch: 6 | loss: 0.0175737
	speed: 0.0446s/iter; left time: 1732.2163s
Epoch: 6 cost time: 18.648762464523315
Epoch: 6, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.062 Vali Acc: 0.977 Test Loss: 0.062 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0019097
	speed: 0.1600s/iter; left time: 6197.1821s
	iters: 200, epoch: 7 | loss: 0.0091228
	speed: 0.0470s/iter; left time: 1816.1704s
	iters: 300, epoch: 7 | loss: 0.0045613
	speed: 0.0477s/iter; left time: 1839.2053s
	iters: 400, epoch: 7 | loss: 0.0001107
	speed: 0.0487s/iter; left time: 1871.5653s
Epoch: 7 cost time: 20.06639075279236
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0002260
	speed: 0.1663s/iter; left time: 6371.7821s
	iters: 200, epoch: 8 | loss: 0.0685712
	speed: 0.0463s/iter; left time: 1769.3717s
	iters: 300, epoch: 8 | loss: 0.0010071
	speed: 0.0438s/iter; left time: 1668.5992s
	iters: 400, epoch: 8 | loss: 0.0002136
	speed: 0.0433s/iter; left time: 1644.0919s
Epoch: 8 cost time: 19.037824392318726
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000409
	speed: 0.1520s/iter; left time: 5762.1676s
	iters: 200, epoch: 9 | loss: 0.0001440
	speed: 0.0425s/iter; left time: 1608.0120s
	iters: 300, epoch: 9 | loss: 0.0000347
	speed: 0.0425s/iter; left time: 1600.9071s
	iters: 400, epoch: 9 | loss: 0.0001832
	speed: 0.0452s/iter; left time: 1698.3127s
Epoch: 9 cost time: 18.35985279083252
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0027701
	speed: 0.1495s/iter; left time: 5602.6519s
	iters: 200, epoch: 10 | loss: 0.0000394
	speed: 0.0447s/iter; left time: 1669.3753s
	iters: 300, epoch: 10 | loss: 0.0000598
	speed: 0.0472s/iter; left time: 1760.0294s
	iters: 400, epoch: 10 | loss: 0.0012628
	speed: 0.0459s/iter; left time: 1707.9478s
Epoch: 10 cost time: 18.946086168289185
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0021860
	speed: 0.1588s/iter; left time: 5886.7348s
	iters: 200, epoch: 11 | loss: 0.0001062
	speed: 0.0475s/iter; left time: 1757.6395s
	iters: 300, epoch: 11 | loss: 0.0000398
	speed: 0.0463s/iter; left time: 1707.9083s
	iters: 400, epoch: 11 | loss: 0.0003156
	speed: 0.0470s/iter; left time: 1727.6022s
Epoch: 11 cost time: 19.966832160949707
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.062 Vali Acc: 0.986 Test Loss: 0.062 Test Acc: 0.986
Validation loss decreased (-0.984538 --> -0.985902).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000332
	speed: 0.1607s/iter; left time: 5891.4424s
	iters: 200, epoch: 12 | loss: 0.0000166
	speed: 0.0448s/iter; left time: 1636.8883s
	iters: 300, epoch: 12 | loss: 0.0000538
	speed: 0.0436s/iter; left time: 1589.2286s
	iters: 400, epoch: 12 | loss: 0.0000815
	speed: 0.0437s/iter; left time: 1587.8356s
Epoch: 12 cost time: 18.506078004837036
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.982 Test Loss: 0.099 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0002911
	speed: 0.1426s/iter; left time: 5169.2683s
	iters: 200, epoch: 13 | loss: 0.0002135
	speed: 0.0462s/iter; left time: 1669.7931s
	iters: 300, epoch: 13 | loss: 0.0002224
	speed: 0.0432s/iter; left time: 1556.3387s
	iters: 400, epoch: 13 | loss: 0.0000109
	speed: 0.0428s/iter; left time: 1539.8245s
Epoch: 13 cost time: 18.4749698638916
Epoch: 13, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0082702
	speed: 0.1588s/iter; left time: 5689.4926s
	iters: 200, epoch: 14 | loss: 0.0000047
	speed: 0.0470s/iter; left time: 1679.7645s
	iters: 300, epoch: 14 | loss: 0.0000481
	speed: 0.0457s/iter; left time: 1629.6051s
	iters: 400, epoch: 14 | loss: 0.0000011
	speed: 0.0458s/iter; left time: 1627.8185s
Epoch: 14 cost time: 19.793373346328735
Epoch: 14, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0004856
	speed: 0.1764s/iter; left time: 6248.6477s
	iters: 200, epoch: 15 | loss: 0.0000149
	speed: 0.0430s/iter; left time: 1518.7640s
	iters: 300, epoch: 15 | loss: 0.0000078
	speed: 0.0453s/iter; left time: 1595.2240s
	iters: 400, epoch: 15 | loss: 0.0583847
	speed: 0.0444s/iter; left time: 1559.6373s
Epoch: 15 cost time: 19.006206035614014
Epoch: 15, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000943
	speed: 0.1515s/iter; left time: 5304.4522s
	iters: 200, epoch: 16 | loss: 0.0000026
	speed: 0.0459s/iter; left time: 1603.0421s
	iters: 300, epoch: 16 | loss: 0.0000010
	speed: 0.0449s/iter; left time: 1562.9279s
	iters: 400, epoch: 16 | loss: 0.0000003
	speed: 0.0445s/iter; left time: 1545.1586s
Epoch: 16 cost time: 18.807090282440186
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0002243
	speed: 0.1477s/iter; left time: 5109.8229s
	iters: 200, epoch: 17 | loss: 0.0001698
	speed: 0.0464s/iter; left time: 1599.0538s
	iters: 300, epoch: 17 | loss: 0.0006343
	speed: 0.0468s/iter; left time: 1611.2562s
	iters: 400, epoch: 17 | loss: 0.0000685
	speed: 0.0464s/iter; left time: 1591.2332s
Epoch: 17 cost time: 19.51202630996704
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000144
	speed: 0.1657s/iter; left time: 5663.2550s
	iters: 200, epoch: 18 | loss: 0.0000179
	speed: 0.0466s/iter; left time: 1587.3438s
	iters: 300, epoch: 18 | loss: 0.0003087
	speed: 0.0501s/iter; left time: 1700.8790s
	iters: 400, epoch: 18 | loss: 0.0001843
	speed: 0.0429s/iter; left time: 1455.0333s
Epoch: 18 cost time: 19.51284646987915
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0003805
	speed: 0.1329s/iter; left time: 4489.0829s
	iters: 200, epoch: 19 | loss: 0.0005405
	speed: 0.0449s/iter; left time: 1511.7223s
	iters: 300, epoch: 19 | loss: 0.0004652
	speed: 0.0437s/iter; left time: 1467.5854s
	iters: 400, epoch: 19 | loss: 0.0739402
	speed: 0.0435s/iter; left time: 1457.0836s
Epoch: 19 cost time: 18.544382333755493
Epoch: 19, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.1524s/iter; left time: 5083.4038s
	iters: 200, epoch: 20 | loss: 0.0017766
	speed: 0.0437s/iter; left time: 1451.6724s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1520.0153s
	iters: 400, epoch: 20 | loss: 0.0000012
	speed: 0.0437s/iter; left time: 1445.1466s
Epoch: 20 cost time: 18.67992067337036
Epoch: 20, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000039
	speed: 0.1728s/iter; left time: 5692.1200s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.0473s/iter; left time: 1553.7955s
	iters: 300, epoch: 21 | loss: 0.0000015
	speed: 0.0464s/iter; left time: 1520.5270s
	iters: 400, epoch: 21 | loss: 0.0000067
	speed: 0.0467s/iter; left time: 1523.6816s
Epoch: 21 cost time: 19.902748346328735
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 607442
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7730986
	speed: 0.0631s/iter; left time: 2601.6273s
	iters: 200, epoch: 1 | loss: 0.3676706
	speed: 0.0416s/iter; left time: 1709.3096s
	iters: 300, epoch: 1 | loss: 0.0991867
	speed: 0.0429s/iter; left time: 1757.1251s
	iters: 400, epoch: 1 | loss: 0.0822050
	speed: 0.0459s/iter; left time: 1878.6892s
Epoch: 1 cost time: 20.0474910736084
Epoch: 1, Steps: 413 | Train Loss: 0.603 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0931072
	speed: 0.1494s/iter; left time: 6092.2816s
	iters: 200, epoch: 2 | loss: 0.0048858
	speed: 0.0435s/iter; left time: 1768.4683s
	iters: 300, epoch: 2 | loss: 0.0391923
	speed: 0.0454s/iter; left time: 1842.4833s
	iters: 400, epoch: 2 | loss: 0.0488737
	speed: 0.0460s/iter; left time: 1861.6923s
Epoch: 2 cost time: 18.9018816947937
Epoch: 2, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.079 Vali Acc: 0.972 Test Loss: 0.079 Test Acc: 0.972
Validation loss decreased (-0.966802 --> -0.971805).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0469450
	speed: 0.1804s/iter; left time: 7284.6866s
	iters: 200, epoch: 3 | loss: 0.0043271
	speed: 0.0467s/iter; left time: 1882.5152s
	iters: 300, epoch: 3 | loss: 0.0950826
	speed: 0.0492s/iter; left time: 1975.2573s
	iters: 400, epoch: 3 | loss: 0.3063672
	speed: 0.0468s/iter; left time: 1874.5770s
Epoch: 3 cost time: 20.394734621047974
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.971805 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0018053
	speed: 0.1712s/iter; left time: 6839.7811s
	iters: 200, epoch: 4 | loss: 0.0031794
	speed: 0.0533s/iter; left time: 2125.9461s
	iters: 300, epoch: 4 | loss: 0.0191234
	speed: 0.0515s/iter; left time: 2046.7745s
	iters: 400, epoch: 4 | loss: 0.1002660
	speed: 0.0411s/iter; left time: 1630.2852s
Epoch: 4 cost time: 19.8480122089386
Epoch: 4, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.088 Vali Acc: 0.971 Test Loss: 0.088 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0021910
	speed: 0.1189s/iter; left time: 4701.5949s
	iters: 200, epoch: 5 | loss: 0.1185524
	speed: 0.0388s/iter; left time: 1529.5618s
	iters: 300, epoch: 5 | loss: 0.0005706
	speed: 0.0381s/iter; left time: 1498.3084s
	iters: 400, epoch: 5 | loss: 0.0024973
	speed: 0.0431s/iter; left time: 1690.5756s
Epoch: 5 cost time: 17.123141288757324
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.974533).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0002937
	speed: 0.1477s/iter; left time: 5779.0130s
	iters: 200, epoch: 6 | loss: 0.0035309
	speed: 0.0442s/iter; left time: 1724.3216s
	iters: 300, epoch: 6 | loss: 0.0012672
	speed: 0.0437s/iter; left time: 1699.7736s
	iters: 400, epoch: 6 | loss: 0.0023164
	speed: 0.0451s/iter; left time: 1753.0216s
Epoch: 6 cost time: 18.775620460510254
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0004494
	speed: 0.1448s/iter; left time: 5605.1895s
	iters: 200, epoch: 7 | loss: 0.0034272
	speed: 0.0459s/iter; left time: 1774.4168s
	iters: 300, epoch: 7 | loss: 0.0001474
	speed: 0.0484s/iter; left time: 1863.5185s
	iters: 400, epoch: 7 | loss: 0.0000693
	speed: 0.0476s/iter; left time: 1829.2224s
Epoch: 7 cost time: 19.4018611907959
Epoch: 7, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
Validation loss decreased (-0.974533 --> -0.975443).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0008433
	speed: 0.1761s/iter; left time: 6747.1658s
	iters: 200, epoch: 8 | loss: 0.0828901
	speed: 0.0496s/iter; left time: 1895.1267s
	iters: 300, epoch: 8 | loss: 0.0095733
	speed: 0.0502s/iter; left time: 1912.4871s
	iters: 400, epoch: 8 | loss: 0.0254266
	speed: 0.0477s/iter; left time: 1813.3934s
Epoch: 8 cost time: 20.6318941116333
Epoch: 8, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.975443 --> -0.978626).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0002489
	speed: 0.1662s/iter; left time: 6297.6424s
	iters: 200, epoch: 9 | loss: 0.0000254
	speed: 0.0446s/iter; left time: 1685.0508s
	iters: 300, epoch: 9 | loss: 0.0026640
	speed: 0.0461s/iter; left time: 1737.0723s
	iters: 400, epoch: 9 | loss: 0.0055840
	speed: 0.0457s/iter; left time: 1716.7811s
Epoch: 9 cost time: 19.08731484413147
Epoch: 9, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0007291
	speed: 0.1455s/iter; left time: 5452.5838s
	iters: 200, epoch: 10 | loss: 0.0006346
	speed: 0.0451s/iter; left time: 1686.4512s
	iters: 300, epoch: 10 | loss: 0.1208220
	speed: 0.0449s/iter; left time: 1672.2817s
	iters: 400, epoch: 10 | loss: 0.0007225
	speed: 0.0440s/iter; left time: 1635.0444s
Epoch: 10 cost time: 18.701990842819214
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0164475
	speed: 0.1567s/iter; left time: 5810.8105s
	iters: 200, epoch: 11 | loss: 0.0000059
	speed: 0.0473s/iter; left time: 1749.4738s
	iters: 300, epoch: 11 | loss: 0.0011060
	speed: 0.0444s/iter; left time: 1637.8994s
	iters: 400, epoch: 11 | loss: 0.0004006
	speed: 0.0450s/iter; left time: 1656.3633s
Epoch: 11 cost time: 19.30773949623108
Epoch: 11, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000148
	speed: 0.1591s/iter; left time: 5831.1169s
	iters: 200, epoch: 12 | loss: 0.0256686
	speed: 0.0436s/iter; left time: 1592.7793s
	iters: 300, epoch: 12 | loss: 0.0004315
	speed: 0.0439s/iter; left time: 1602.1731s
	iters: 400, epoch: 12 | loss: 0.0002037
	speed: 0.0437s/iter; left time: 1588.3871s
Epoch: 12 cost time: 18.795637369155884
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0016142
	speed: 0.1554s/iter; left time: 5630.8157s
	iters: 200, epoch: 13 | loss: 0.0000111
	speed: 0.0432s/iter; left time: 1563.1702s
	iters: 300, epoch: 13 | loss: 0.0005453
	speed: 0.0422s/iter; left time: 1519.8417s
	iters: 400, epoch: 13 | loss: 0.0337107
	speed: 0.0445s/iter; left time: 1600.7761s
Epoch: 13 cost time: 18.3403480052948
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0003389
	speed: 0.1499s/iter; left time: 5371.0838s
	iters: 200, epoch: 14 | loss: 0.1356699
	speed: 0.0443s/iter; left time: 1582.5373s
	iters: 300, epoch: 14 | loss: 0.0000518
	speed: 0.0468s/iter; left time: 1668.6389s
	iters: 400, epoch: 14 | loss: 0.0002649
	speed: 0.0443s/iter; left time: 1575.2579s
Epoch: 14 cost time: 18.723654985427856
Epoch: 14, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
Validation loss decreased (-0.978626 --> -0.981809).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0002043
	speed: 0.1560s/iter; left time: 5524.9271s
	iters: 200, epoch: 15 | loss: 0.0000079
	speed: 0.0444s/iter; left time: 1569.4019s
	iters: 300, epoch: 15 | loss: 0.0000129
	speed: 0.0447s/iter; left time: 1575.5744s
	iters: 400, epoch: 15 | loss: 0.3346131
	speed: 0.0458s/iter; left time: 1608.1933s
Epoch: 15 cost time: 19.06452250480652
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000878
	speed: 0.1494s/iter; left time: 5230.8773s
	iters: 200, epoch: 16 | loss: 0.0003058
	speed: 0.0411s/iter; left time: 1434.3742s
	iters: 300, epoch: 16 | loss: 0.0063099
	speed: 0.0427s/iter; left time: 1486.5248s
	iters: 400, epoch: 16 | loss: 0.0000020
	speed: 0.0421s/iter; left time: 1461.3836s
Epoch: 16 cost time: 17.707279205322266
Epoch: 16, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
Validation loss decreased (-0.981809 --> -0.985447).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000335
	speed: 0.1431s/iter; left time: 4948.6775s
	iters: 200, epoch: 17 | loss: 0.0000660
	speed: 0.0439s/iter; left time: 1515.8273s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0427s/iter; left time: 1468.6944s
	iters: 400, epoch: 17 | loss: 0.0001161
	speed: 0.0452s/iter; left time: 1550.7252s
Epoch: 17 cost time: 18.701484441757202
Epoch: 17, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000177
	speed: 0.1566s/iter; left time: 5351.7260s
	iters: 200, epoch: 18 | loss: 0.0000011
	speed: 0.0467s/iter; left time: 1591.2689s
	iters: 300, epoch: 18 | loss: 0.0000061
	speed: 0.0473s/iter; left time: 1606.7935s
	iters: 400, epoch: 18 | loss: 0.0000051
	speed: 0.0475s/iter; left time: 1607.6358s
Epoch: 18 cost time: 19.98200750350952
Epoch: 18, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.960 Test Loss: 0.254 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000003
	speed: 0.1637s/iter; left time: 5527.2226s
	iters: 200, epoch: 19 | loss: 0.0023750
	speed: 0.0454s/iter; left time: 1529.5728s
	iters: 300, epoch: 19 | loss: 0.0000004
	speed: 0.0465s/iter; left time: 1560.2645s
	iters: 400, epoch: 19 | loss: 0.0002327
	speed: 0.0409s/iter; left time: 1368.3140s
Epoch: 19 cost time: 18.79553747177124
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000737
	speed: 0.1438s/iter; left time: 4797.9280s
	iters: 200, epoch: 20 | loss: 0.0003134
	speed: 0.0416s/iter; left time: 1384.3255s
	iters: 300, epoch: 20 | loss: 0.0000006
	speed: 0.0436s/iter; left time: 1443.8818s
	iters: 400, epoch: 20 | loss: 0.0002876
	speed: 0.0434s/iter; left time: 1432.9894s
Epoch: 20 cost time: 18.08631706237793
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.985 Test Loss: 0.092 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000006
	speed: 0.1433s/iter; left time: 4719.9857s
	iters: 200, epoch: 21 | loss: 0.0000032
	speed: 0.0403s/iter; left time: 1323.8558s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.0423s/iter; left time: 1383.7434s
	iters: 400, epoch: 21 | loss: 0.0005899
	speed: 0.0410s/iter; left time: 1337.5965s
Epoch: 21 cost time: 17.370012760162354
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.986 Test Loss: 0.086 Test Acc: 0.986
Validation loss decreased (-0.985447 --> -0.986357).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0005797
	speed: 0.1575s/iter; left time: 5122.7077s
	iters: 200, epoch: 22 | loss: 0.0009351
	speed: 0.0482s/iter; left time: 1561.9789s
	iters: 300, epoch: 22 | loss: 0.0000099
	speed: 0.0476s/iter; left time: 1538.4634s
	iters: 400, epoch: 22 | loss: 0.0000972
	speed: 0.0470s/iter; left time: 1515.3072s
Epoch: 22 cost time: 20.297879695892334
Epoch: 22, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0001875
	speed: 0.1749s/iter; left time: 5615.3693s
	iters: 200, epoch: 23 | loss: 0.0305808
	speed: 0.0437s/iter; left time: 1399.7243s
	iters: 300, epoch: 23 | loss: 0.0002949
	speed: 0.0458s/iter; left time: 1463.1717s
	iters: 400, epoch: 23 | loss: 0.0001350
	speed: 0.0443s/iter; left time: 1407.9282s
Epoch: 23 cost time: 18.888208627700806
Epoch: 23, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0019898
	speed: 0.1468s/iter; left time: 4655.2828s
	iters: 200, epoch: 24 | loss: 0.0009677
	speed: 0.0433s/iter; left time: 1366.8552s
	iters: 300, epoch: 24 | loss: 0.0012166
	speed: 0.0446s/iter; left time: 1404.0775s
	iters: 400, epoch: 24 | loss: 0.0000092
	speed: 0.0439s/iter; left time: 1380.0415s
Epoch: 24 cost time: 18.54975938796997
Epoch: 24, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000007
	speed: 0.1410s/iter; left time: 4412.5101s
	iters: 200, epoch: 25 | loss: 0.0000059
	speed: 0.0414s/iter; left time: 1291.3142s
	iters: 300, epoch: 25 | loss: 0.0000093
	speed: 0.0468s/iter; left time: 1453.5954s
	iters: 400, epoch: 25 | loss: 0.0000007
	speed: 0.0444s/iter; left time: 1376.5415s
Epoch: 25 cost time: 18.562166213989258
Epoch: 25, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000244
	speed: 0.1617s/iter; left time: 4993.4379s
	iters: 200, epoch: 26 | loss: 0.0000260
	speed: 0.0466s/iter; left time: 1435.2345s
	iters: 300, epoch: 26 | loss: 0.0000035
	speed: 0.0479s/iter; left time: 1469.0405s
	iters: 400, epoch: 26 | loss: 0.0000014
	speed: 0.0479s/iter; left time: 1466.0655s
Epoch: 26 cost time: 19.794782161712646
Epoch: 26, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.141 Vali Acc: 0.981 Test Loss: 0.141 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000205
	speed: 0.1563s/iter; left time: 4761.9100s
	iters: 200, epoch: 27 | loss: 0.0017384
	speed: 0.0464s/iter; left time: 1408.1789s
	iters: 300, epoch: 27 | loss: 0.0000294
	speed: 0.0419s/iter; left time: 1268.5260s
	iters: 400, epoch: 27 | loss: 0.0000004
	speed: 0.0423s/iter; left time: 1276.9844s
Epoch: 27 cost time: 18.487739086151123
Epoch: 27, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000030
	speed: 0.1507s/iter; left time: 4529.5306s
	iters: 200, epoch: 28 | loss: 0.0000459
	speed: 0.0441s/iter; left time: 1320.8394s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 1338.9078s
	iters: 400, epoch: 28 | loss: 0.0000129
	speed: 0.0438s/iter; left time: 1302.3127s
Epoch: 28 cost time: 18.64904260635376
Epoch: 28, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000006
	speed: 0.1614s/iter; left time: 4784.0817s
	iters: 200, epoch: 29 | loss: 0.0000139
	speed: 0.0456s/iter; left time: 1345.6773s
	iters: 300, epoch: 29 | loss: 0.0002307
	speed: 0.0475s/iter; left time: 1396.8187s
	iters: 400, epoch: 29 | loss: 0.0000067
	speed: 0.0440s/iter; left time: 1291.1650s
Epoch: 29 cost time: 19.32215976715088
Epoch: 29, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.982 Test Loss: 0.115 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1611s/iter; left time: 4709.0424s
	iters: 200, epoch: 30 | loss: 0.0006103
	speed: 0.0465s/iter; left time: 1355.2993s
	iters: 300, epoch: 30 | loss: 0.0000002
	speed: 0.0426s/iter; left time: 1237.2999s
	iters: 400, epoch: 30 | loss: 0.0000091
	speed: 0.0447s/iter; left time: 1294.1715s
Epoch: 30 cost time: 19.170326471328735
Epoch: 30, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.135 Vali Acc: 0.979 Test Loss: 0.135 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000001
	speed: 0.1476s/iter; left time: 4253.7510s
	iters: 200, epoch: 31 | loss: 0.0016692
	speed: 0.0437s/iter; left time: 1255.6580s
	iters: 300, epoch: 31 | loss: 0.0501175
	speed: 0.0454s/iter; left time: 1297.7577s
	iters: 400, epoch: 31 | loss: 0.0000168
	speed: 0.0448s/iter; left time: 1278.1715s
Epoch: 31 cost time: 18.946523427963257
Epoch: 31, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.136 Vali Acc: 0.983 Test Loss: 0.136 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 607442
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6715916
	speed: 0.0667s/iter; left time: 2746.4874s
	iters: 200, epoch: 1 | loss: 0.1086897
	speed: 0.0487s/iter; left time: 2000.6512s
	iters: 300, epoch: 1 | loss: 0.1453905
	speed: 0.0505s/iter; left time: 2072.4352s
	iters: 400, epoch: 1 | loss: 0.0653751
	speed: 0.0476s/iter; left time: 1947.5179s
Epoch: 1 cost time: 21.908759117126465
Epoch: 1, Steps: 413 | Train Loss: 0.553 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (inf --> -0.968166).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6911854
	speed: 0.1777s/iter; left time: 7247.9627s
	iters: 200, epoch: 2 | loss: 0.0614776
	speed: 0.0458s/iter; left time: 1863.6130s
	iters: 300, epoch: 2 | loss: 0.0153086
	speed: 0.0429s/iter; left time: 1741.3970s
	iters: 400, epoch: 2 | loss: 0.0155697
	speed: 0.0451s/iter; left time: 1824.2470s
Epoch: 2 cost time: 19.179201364517212
Epoch: 2, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
Validation loss decreased (-0.968166 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0098508
	speed: 0.1456s/iter; left time: 5877.0023s
	iters: 200, epoch: 3 | loss: 0.0103971
	speed: 0.0442s/iter; left time: 1778.6779s
	iters: 300, epoch: 3 | loss: 0.0389725
	speed: 0.0440s/iter; left time: 1766.0038s
	iters: 400, epoch: 3 | loss: 0.0038548
	speed: 0.0434s/iter; left time: 1738.0948s
Epoch: 3 cost time: 18.364354848861694
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (-0.974078 --> -0.976352).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0083486
	speed: 0.1494s/iter; left time: 5971.8144s
	iters: 200, epoch: 4 | loss: 0.0021704
	speed: 0.0438s/iter; left time: 1746.5895s
	iters: 300, epoch: 4 | loss: 0.0124432
	speed: 0.0468s/iter; left time: 1860.5163s
	iters: 400, epoch: 4 | loss: 0.0024865
	speed: 0.0465s/iter; left time: 1844.9107s
Epoch: 4 cost time: 19.330836296081543
Epoch: 4, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2788729
	speed: 0.1672s/iter; left time: 6611.4325s
	iters: 200, epoch: 5 | loss: 0.0040444
	speed: 0.0483s/iter; left time: 1906.6979s
	iters: 300, epoch: 5 | loss: 0.0002043
	speed: 0.0518s/iter; left time: 2039.9034s
	iters: 400, epoch: 5 | loss: 0.0470939
	speed: 0.0466s/iter; left time: 1827.1042s
Epoch: 5 cost time: 20.158841848373413
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.976352 --> -0.979990).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0047020
	speed: 0.1557s/iter; left time: 6092.7662s
	iters: 200, epoch: 6 | loss: 0.0041899
	speed: 0.0451s/iter; left time: 1761.3150s
	iters: 300, epoch: 6 | loss: 0.0003140
	speed: 0.0461s/iter; left time: 1794.3406s
	iters: 400, epoch: 6 | loss: 0.0000281
	speed: 0.0477s/iter; left time: 1852.0168s
Epoch: 6 cost time: 19.341195344924927
Epoch: 6, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0001902
	speed: 0.1528s/iter; left time: 5917.3333s
	iters: 200, epoch: 7 | loss: 0.0060410
	speed: 0.0454s/iter; left time: 1752.8624s
	iters: 300, epoch: 7 | loss: 0.0055355
	speed: 0.0435s/iter; left time: 1674.7932s
	iters: 400, epoch: 7 | loss: 0.0174452
	speed: 0.0441s/iter; left time: 1695.4409s
Epoch: 7 cost time: 18.90216875076294
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0108822
	speed: 0.1586s/iter; left time: 6075.4360s
	iters: 200, epoch: 8 | loss: 0.0013566
	speed: 0.0489s/iter; left time: 1866.8324s
	iters: 300, epoch: 8 | loss: 0.0002459
	speed: 0.0463s/iter; left time: 1764.3633s
	iters: 400, epoch: 8 | loss: 0.0001230
	speed: 0.0462s/iter; left time: 1755.0574s
Epoch: 8 cost time: 20.154523372650146
Epoch: 8, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0001175
	speed: 0.1790s/iter; left time: 6785.4040s
	iters: 200, epoch: 9 | loss: 0.0000072
	speed: 0.0445s/iter; left time: 1680.1774s
	iters: 300, epoch: 9 | loss: 0.0001840
	speed: 0.0506s/iter; left time: 1905.7374s
	iters: 400, epoch: 9 | loss: 0.0077026
	speed: 0.0474s/iter; left time: 1781.0973s
Epoch: 9 cost time: 20.276031494140625
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000114
	speed: 0.1589s/iter; left time: 5954.5866s
	iters: 200, epoch: 10 | loss: 0.0000327
	speed: 0.0468s/iter; left time: 1750.7172s
	iters: 300, epoch: 10 | loss: 0.0000030
	speed: 0.0454s/iter; left time: 1694.0789s
	iters: 400, epoch: 10 | loss: 0.0354585
	speed: 0.0474s/iter; left time: 1761.3327s
Epoch: 10 cost time: 19.91985583305359
Epoch: 10, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000007
	speed: 0.1608s/iter; left time: 5962.4725s
	iters: 200, epoch: 11 | loss: 0.0018622
	speed: 0.0465s/iter; left time: 1718.2333s
	iters: 300, epoch: 11 | loss: 0.0002019
	speed: 0.0509s/iter; left time: 1878.4003s
	iters: 400, epoch: 11 | loss: 0.0001751
	speed: 0.0496s/iter; left time: 1824.0469s
Epoch: 11 cost time: 20.298147201538086
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000045
	speed: 0.1666s/iter; left time: 6107.4209s
	iters: 200, epoch: 12 | loss: 0.0014688
	speed: 0.0500s/iter; left time: 1827.3365s
	iters: 300, epoch: 12 | loss: 0.0003881
	speed: 0.0474s/iter; left time: 1729.7985s
	iters: 400, epoch: 12 | loss: 0.0000803
	speed: 0.0479s/iter; left time: 1741.5395s
Epoch: 12 cost time: 20.650502920150757
Epoch: 12, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000025
	speed: 0.1579s/iter; left time: 5721.3863s
	iters: 200, epoch: 13 | loss: 0.0000016
	speed: 0.0471s/iter; left time: 1703.0602s
	iters: 300, epoch: 13 | loss: 0.0000014
	speed: 0.0465s/iter; left time: 1675.5975s
	iters: 400, epoch: 13 | loss: 0.0004663
	speed: 0.0448s/iter; left time: 1608.9584s
Epoch: 13 cost time: 19.610329389572144
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0099909
	speed: 0.1585s/iter; left time: 5680.8103s
	iters: 200, epoch: 14 | loss: 0.0000028
	speed: 0.0508s/iter; left time: 1816.3253s
	iters: 300, epoch: 14 | loss: 0.0000088
	speed: 0.0529s/iter; left time: 1883.4359s
	iters: 400, epoch: 14 | loss: 0.0000580
	speed: 0.0499s/iter; left time: 1772.2714s
Epoch: 14 cost time: 21.312273025512695
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0230987
	speed: 0.1862s/iter; left time: 6595.3485s
	iters: 200, epoch: 15 | loss: 0.0000124
	speed: 0.0491s/iter; left time: 1735.3940s
	iters: 300, epoch: 15 | loss: 0.0003614
	speed: 0.0552s/iter; left time: 1945.0575s
	iters: 400, epoch: 15 | loss: 0.0000166
	speed: 0.0517s/iter; left time: 1816.1852s
Epoch: 15 cost time: 21.80344247817993
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 345298
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6847371
	speed: 0.0609s/iter; left time: 2510.0741s
	iters: 200, epoch: 1 | loss: 0.1109828
	speed: 0.0426s/iter; left time: 1749.7511s
	iters: 300, epoch: 1 | loss: 0.1725048
	speed: 0.0430s/iter; left time: 1763.1918s
	iters: 400, epoch: 1 | loss: 0.0679120
	speed: 0.0451s/iter; left time: 1843.1121s
Epoch: 1 cost time: 19.82579779624939
Epoch: 1, Steps: 413 | Train Loss: 0.551 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (inf --> -0.971350).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6697652
	speed: 0.1464s/iter; left time: 5970.0443s
	iters: 200, epoch: 2 | loss: 0.1082416
	speed: 0.0465s/iter; left time: 1891.0105s
	iters: 300, epoch: 2 | loss: 0.0175613
	speed: 0.0458s/iter; left time: 1859.1370s
	iters: 400, epoch: 2 | loss: 0.0205407
	speed: 0.0446s/iter; left time: 1806.7463s
Epoch: 2 cost time: 19.135174036026
Epoch: 2, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.075 Vali Acc: 0.975 Test Loss: 0.075 Test Acc: 0.975
Validation loss decreased (-0.971350 --> -0.974533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0241960
	speed: 0.1593s/iter; left time: 6433.7199s
	iters: 200, epoch: 3 | loss: 0.0103534
	speed: 0.0463s/iter; left time: 1863.7201s
	iters: 300, epoch: 3 | loss: 0.0467195
	speed: 0.0470s/iter; left time: 1889.3025s
	iters: 400, epoch: 3 | loss: 0.0065876
	speed: 0.0448s/iter; left time: 1796.1730s
Epoch: 3 cost time: 19.32670569419861
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0414503
	speed: 0.1477s/iter; left time: 5903.4585s
	iters: 200, epoch: 4 | loss: 0.0011367
	speed: 0.0445s/iter; left time: 1774.2377s
	iters: 300, epoch: 4 | loss: 0.0051656
	speed: 0.0425s/iter; left time: 1690.0265s
	iters: 400, epoch: 4 | loss: 0.0011311
	speed: 0.0428s/iter; left time: 1697.7088s
Epoch: 4 cost time: 18.491331815719604
Epoch: 4, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0018311
	speed: 0.1494s/iter; left time: 5909.3658s
	iters: 200, epoch: 5 | loss: 0.0967888
	speed: 0.0432s/iter; left time: 1706.0484s
	iters: 300, epoch: 5 | loss: 0.0041138
	speed: 0.0454s/iter; left time: 1787.7444s
	iters: 400, epoch: 5 | loss: 0.0020107
	speed: 0.0453s/iter; left time: 1778.8848s
Epoch: 5 cost time: 18.7090106010437
Epoch: 5, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.083 Vali Acc: 0.972 Test Loss: 0.083 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0025798
	speed: 0.1636s/iter; left time: 6403.0631s
	iters: 200, epoch: 6 | loss: 0.0017225
	speed: 0.0448s/iter; left time: 1749.0236s
	iters: 300, epoch: 6 | loss: 0.0004336
	speed: 0.0461s/iter; left time: 1794.9581s
	iters: 400, epoch: 6 | loss: 0.0001737
	speed: 0.0442s/iter; left time: 1714.7406s
Epoch: 6 cost time: 19.27636981010437
Epoch: 6, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0381770
	speed: 0.1630s/iter; left time: 6313.0819s
	iters: 200, epoch: 7 | loss: 0.0116420
	speed: 0.0434s/iter; left time: 1675.0217s
	iters: 300, epoch: 7 | loss: 0.0056509
	speed: 0.0444s/iter; left time: 1712.0650s
	iters: 400, epoch: 7 | loss: 0.0009917
	speed: 0.0448s/iter; left time: 1721.2312s
Epoch: 7 cost time: 18.466435432434082
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.974533 --> -0.975897).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0013949
	speed: 0.1426s/iter; left time: 5464.6206s
	iters: 200, epoch: 8 | loss: 0.0006766
	speed: 0.0454s/iter; left time: 1735.7530s
	iters: 300, epoch: 8 | loss: 0.0000101
	speed: 0.0461s/iter; left time: 1757.3274s
	iters: 400, epoch: 8 | loss: 0.0000994
	speed: 0.0443s/iter; left time: 1683.8352s
Epoch: 8 cost time: 18.928391456604004
Epoch: 8, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.057 Vali Acc: 0.984 Test Loss: 0.057 Test Acc: 0.984
Validation loss decreased (-0.975897 --> -0.983628).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000810
	speed: 0.1574s/iter; left time: 5965.4454s
	iters: 200, epoch: 9 | loss: 0.0079052
	speed: 0.0469s/iter; left time: 1771.5881s
	iters: 300, epoch: 9 | loss: 0.0070056
	speed: 0.0472s/iter; left time: 1780.8799s
	iters: 400, epoch: 9 | loss: 0.0000234
	speed: 0.0483s/iter; left time: 1814.5188s
Epoch: 9 cost time: 20.105494260787964
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000051
	speed: 0.1679s/iter; left time: 6292.7308s
	iters: 200, epoch: 10 | loss: 0.0003398
	speed: 0.0463s/iter; left time: 1730.7330s
	iters: 300, epoch: 10 | loss: 0.0000510
	speed: 0.0461s/iter; left time: 1717.7333s
	iters: 400, epoch: 10 | loss: 0.0031130
	speed: 0.0425s/iter; left time: 1579.9342s
Epoch: 10 cost time: 19.255256175994873
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000008
	speed: 0.1486s/iter; left time: 5510.5555s
	iters: 200, epoch: 11 | loss: 0.0000168
	speed: 0.0425s/iter; left time: 1571.4833s
	iters: 300, epoch: 11 | loss: 0.0079673
	speed: 0.0424s/iter; left time: 1562.0038s
	iters: 400, epoch: 11 | loss: 0.0001931
	speed: 0.0426s/iter; left time: 1566.2918s
Epoch: 11 cost time: 18.283029556274414
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0140749
	speed: 0.1486s/iter; left time: 5448.2372s
	iters: 200, epoch: 12 | loss: 0.0001517
	speed: 0.0436s/iter; left time: 1595.2214s
	iters: 300, epoch: 12 | loss: 0.3143277
	speed: 0.0446s/iter; left time: 1626.8069s
	iters: 400, epoch: 12 | loss: 0.0000059
	speed: 0.0469s/iter; left time: 1704.4732s
Epoch: 12 cost time: 18.61964774131775
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000006
	speed: 0.1750s/iter; left time: 6344.2536s
	iters: 200, epoch: 13 | loss: 0.0000408
	speed: 0.0480s/iter; left time: 1734.1302s
	iters: 300, epoch: 13 | loss: 0.0000116
	speed: 0.0496s/iter; left time: 1788.8264s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.0471s/iter; left time: 1691.4745s
Epoch: 13 cost time: 20.666934728622437
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000007
	speed: 0.1724s/iter; left time: 6175.6589s
	iters: 200, epoch: 14 | loss: 0.0000006
	speed: 0.0448s/iter; left time: 1601.0942s
	iters: 300, epoch: 14 | loss: 0.0000037
	speed: 0.0463s/iter; left time: 1649.1531s
	iters: 400, epoch: 14 | loss: 0.0000005
	speed: 0.0432s/iter; left time: 1535.3798s
Epoch: 14 cost time: 19.0472514629364
Epoch: 14, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1585910
	speed: 0.1420s/iter; left time: 5030.1379s
	iters: 200, epoch: 15 | loss: 0.0000043
	speed: 0.0427s/iter; left time: 1509.7750s
	iters: 300, epoch: 15 | loss: 0.0000080
	speed: 0.0424s/iter; left time: 1493.6410s
	iters: 400, epoch: 15 | loss: 0.0009107
	speed: 0.0455s/iter; left time: 1597.3980s
Epoch: 15 cost time: 18.340234994888306
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0001010
	speed: 0.1422s/iter; left time: 4978.1948s
	iters: 200, epoch: 16 | loss: 0.0000039
	speed: 0.0446s/iter; left time: 1556.8646s
	iters: 300, epoch: 16 | loss: 0.0000924
	speed: 0.0435s/iter; left time: 1515.0812s
	iters: 400, epoch: 16 | loss: 0.0000025
	speed: 0.0462s/iter; left time: 1603.6678s
Epoch: 16 cost time: 18.90090250968933
Epoch: 16, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1732s/iter; left time: 5990.7238s
	iters: 200, epoch: 17 | loss: 0.0145399
	speed: 0.0475s/iter; left time: 1639.1274s
	iters: 300, epoch: 17 | loss: 0.0000149
	speed: 0.0475s/iter; left time: 1635.2937s
	iters: 400, epoch: 17 | loss: 0.0000053
	speed: 0.0505s/iter; left time: 1731.7986s
Epoch: 17 cost time: 20.31440496444702
Epoch: 17, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000702
	speed: 0.1531s/iter; left time: 5231.5556s
	iters: 200, epoch: 18 | loss: 0.0000128
	speed: 0.0440s/iter; left time: 1499.0639s
	iters: 300, epoch: 18 | loss: 0.0000011
	speed: 0.0432s/iter; left time: 1469.1819s
	iters: 400, epoch: 18 | loss: 0.0002221
	speed: 0.0441s/iter; left time: 1494.8733s
Epoch: 18 cost time: 18.47940158843994
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 345298
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7084876
	speed: 0.0619s/iter; left time: 2550.4084s
	iters: 200, epoch: 1 | loss: 0.1196307
	speed: 0.0440s/iter; left time: 1810.2540s
	iters: 300, epoch: 1 | loss: 0.1447465
	speed: 0.0422s/iter; left time: 1728.2826s
	iters: 400, epoch: 1 | loss: 0.0440571
	speed: 0.0421s/iter; left time: 1720.7010s
Epoch: 1 cost time: 19.643016576766968
Epoch: 1, Steps: 413 | Train Loss: 0.560 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6939841
	speed: 0.1542s/iter; left time: 6290.3249s
	iters: 200, epoch: 2 | loss: 0.0862280
	speed: 0.0444s/iter; left time: 1806.5295s
	iters: 300, epoch: 2 | loss: 0.0205431
	speed: 0.0464s/iter; left time: 1885.1797s
	iters: 400, epoch: 2 | loss: 0.0348842
	speed: 0.0441s/iter; left time: 1785.5557s
Epoch: 2 cost time: 19.09981060028076
Epoch: 2, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0166039
	speed: 0.1506s/iter; left time: 6081.0718s
	iters: 200, epoch: 3 | loss: 0.0083639
	speed: 0.0430s/iter; left time: 1732.9676s
	iters: 300, epoch: 3 | loss: 0.0270629
	speed: 0.0421s/iter; left time: 1692.7918s
	iters: 400, epoch: 3 | loss: 0.0062260
	speed: 0.0439s/iter; left time: 1760.1279s
Epoch: 3 cost time: 18.162210702896118
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.970895 --> -0.979990).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0043443
	speed: 0.1518s/iter; left time: 6067.2338s
	iters: 200, epoch: 4 | loss: 0.0026923
	speed: 0.0438s/iter; left time: 1745.5637s
	iters: 300, epoch: 4 | loss: 0.0071113
	speed: 0.0434s/iter; left time: 1727.4874s
	iters: 400, epoch: 4 | loss: 0.0046659
	speed: 0.0433s/iter; left time: 1717.8373s
Epoch: 4 cost time: 18.229758501052856
Epoch: 4, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.972 Test Loss: 0.087 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0040771
	speed: 0.1496s/iter; left time: 5917.4034s
	iters: 200, epoch: 5 | loss: 0.0066904
	speed: 0.0431s/iter; left time: 1700.5705s
	iters: 300, epoch: 5 | loss: 0.0018210
	speed: 0.0449s/iter; left time: 1768.6751s
	iters: 400, epoch: 5 | loss: 0.0469705
	speed: 0.0486s/iter; left time: 1905.9896s
Epoch: 5 cost time: 18.649749994277954
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.041 Vali Acc: 0.987 Test Loss: 0.041 Test Acc: 0.987
Validation loss decreased (-0.979990 --> -0.987267).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0014828
	speed: 0.1755s/iter; left time: 6867.3430s
	iters: 200, epoch: 6 | loss: 0.0111748
	speed: 0.0454s/iter; left time: 1772.0804s
	iters: 300, epoch: 6 | loss: 0.0000800
	speed: 0.0489s/iter; left time: 1905.7715s
	iters: 400, epoch: 6 | loss: 0.0001518
	speed: 0.0494s/iter; left time: 1916.8068s
Epoch: 6 cost time: 20.55069351196289
Epoch: 6, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000264
	speed: 0.1636s/iter; left time: 6333.2781s
	iters: 200, epoch: 7 | loss: 0.0002873
	speed: 0.0426s/iter; left time: 1646.5921s
	iters: 300, epoch: 7 | loss: 0.0008937
	speed: 0.0442s/iter; left time: 1704.0011s
	iters: 400, epoch: 7 | loss: 0.0018900
	speed: 0.0452s/iter; left time: 1738.2882s
Epoch: 7 cost time: 18.667115449905396
Epoch: 7, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0058955
	speed: 0.1458s/iter; left time: 5584.2861s
	iters: 200, epoch: 8 | loss: 0.1021769
	speed: 0.0449s/iter; left time: 1714.1135s
	iters: 300, epoch: 8 | loss: 0.0001891
	speed: 0.0474s/iter; left time: 1807.8551s
	iters: 400, epoch: 8 | loss: 0.0003658
	speed: 0.0448s/iter; left time: 1703.8488s
Epoch: 8 cost time: 19.19198513031006
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0001206
	speed: 0.1597s/iter; left time: 6050.3237s
	iters: 200, epoch: 9 | loss: 0.0012312
	speed: 0.0490s/iter; left time: 1852.8704s
	iters: 300, epoch: 9 | loss: 0.0004001
	speed: 0.0509s/iter; left time: 1917.4540s
	iters: 400, epoch: 9 | loss: 0.0001521
	speed: 0.0509s/iter; left time: 1914.1266s
Epoch: 9 cost time: 21.070950984954834
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000013
	speed: 0.1697s/iter; left time: 6362.6532s
	iters: 200, epoch: 10 | loss: 0.0043516
	speed: 0.0505s/iter; left time: 1888.4624s
	iters: 300, epoch: 10 | loss: 0.0000031
	speed: 0.0473s/iter; left time: 1762.0316s
	iters: 400, epoch: 10 | loss: 0.0013748
	speed: 0.0435s/iter; left time: 1617.5977s
Epoch: 10 cost time: 20.14785861968994
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000092
	speed: 0.1531s/iter; left time: 5674.2759s
	iters: 200, epoch: 11 | loss: 0.0000439
	speed: 0.0422s/iter; left time: 1560.0004s
	iters: 300, epoch: 11 | loss: 0.0024769
	speed: 0.0413s/iter; left time: 1521.5494s
	iters: 400, epoch: 11 | loss: 0.0000853
	speed: 0.0444s/iter; left time: 1632.4790s
Epoch: 11 cost time: 18.179386138916016
Epoch: 11, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000047
	speed: 0.1547s/iter; left time: 5670.6672s
	iters: 200, epoch: 12 | loss: 0.0005512
	speed: 0.0457s/iter; left time: 1671.8890s
	iters: 300, epoch: 12 | loss: 0.0000560
	speed: 0.0427s/iter; left time: 1557.4422s
	iters: 400, epoch: 12 | loss: 0.0000628
	speed: 0.0463s/iter; left time: 1684.8818s
Epoch: 12 cost time: 19.217609405517578
Epoch: 12, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.1718s/iter; left time: 6226.0149s
	iters: 200, epoch: 13 | loss: 0.0085612
	speed: 0.0458s/iter; left time: 1655.6508s
	iters: 300, epoch: 13 | loss: 0.0086020
	speed: 0.0479s/iter; left time: 1724.8253s
	iters: 400, epoch: 13 | loss: 0.0000131
	speed: 0.0498s/iter; left time: 1791.5010s
Epoch: 13 cost time: 20.235028743743896
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0007906
	speed: 0.1584s/iter; left time: 5676.3611s
	iters: 200, epoch: 14 | loss: 0.0000682
	speed: 0.0486s/iter; left time: 1736.0598s
	iters: 300, epoch: 14 | loss: 0.0000072
	speed: 0.0454s/iter; left time: 1616.1435s
	iters: 400, epoch: 14 | loss: 0.0054753
	speed: 0.0470s/iter; left time: 1670.6283s
Epoch: 14 cost time: 19.776919841766357
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000375
	speed: 0.1626s/iter; left time: 5759.8008s
	iters: 200, epoch: 15 | loss: 0.0726274
	speed: 0.0456s/iter; left time: 1611.8936s
	iters: 300, epoch: 15 | loss: 0.0002144
	speed: 0.0440s/iter; left time: 1551.3954s
	iters: 400, epoch: 15 | loss: 0.0003457
	speed: 0.0470s/iter; left time: 1652.2247s
Epoch: 15 cost time: 19.23745894432068
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 345298
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8986125
	speed: 0.0642s/iter; left time: 2646.0935s
	iters: 200, epoch: 1 | loss: 0.1645512
	speed: 0.0463s/iter; left time: 1900.9365s
	iters: 300, epoch: 1 | loss: 0.1419526
	speed: 0.0467s/iter; left time: 1913.4560s
	iters: 400, epoch: 1 | loss: 0.0327904
	speed: 0.0466s/iter; left time: 1906.5374s
Epoch: 1 cost time: 21.041929960250854
Epoch: 1, Steps: 413 | Train Loss: 0.623 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (inf --> -0.970440).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6256289
	speed: 0.1571s/iter; left time: 6409.8308s
	iters: 200, epoch: 2 | loss: 0.1428584
	speed: 0.0455s/iter; left time: 1851.8151s
	iters: 300, epoch: 2 | loss: 0.0084690
	speed: 0.0445s/iter; left time: 1807.0402s
	iters: 400, epoch: 2 | loss: 0.0293347
	speed: 0.0446s/iter; left time: 1806.7897s
Epoch: 2 cost time: 19.128058433532715
Epoch: 2, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.066 Vali Acc: 0.979 Test Loss: 0.066 Test Acc: 0.979
Validation loss decreased (-0.970440 --> -0.979081).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0057148
	speed: 0.1526s/iter; left time: 6159.7122s
	iters: 200, epoch: 3 | loss: 0.0085800
	speed: 0.0412s/iter; left time: 1659.4541s
	iters: 300, epoch: 3 | loss: 0.0315388
	speed: 0.0428s/iter; left time: 1719.3713s
	iters: 400, epoch: 3 | loss: 0.0042581
	speed: 0.0484s/iter; left time: 1938.2591s
Epoch: 3 cost time: 18.45963954925537
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.079 Vali Acc: 0.972 Test Loss: 0.079 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0035729
	speed: 0.1629s/iter; left time: 6511.7199s
	iters: 200, epoch: 4 | loss: 0.0024666
	speed: 0.0471s/iter; left time: 1877.7831s
	iters: 300, epoch: 4 | loss: 0.0062395
	speed: 0.0466s/iter; left time: 1852.9177s
	iters: 400, epoch: 4 | loss: 0.0006346
	speed: 0.0459s/iter; left time: 1819.5215s
Epoch: 4 cost time: 19.72954487800598
Epoch: 4, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0436277
	speed: 0.1698s/iter; left time: 6716.9951s
	iters: 200, epoch: 5 | loss: 0.0451808
	speed: 0.0449s/iter; left time: 1772.6718s
	iters: 300, epoch: 5 | loss: 0.0039574
	speed: 0.0444s/iter; left time: 1747.2658s
	iters: 400, epoch: 5 | loss: 0.0025341
	speed: 0.0464s/iter; left time: 1822.4990s
Epoch: 5 cost time: 18.826237440109253
Epoch: 5, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.099 Vali Acc: 0.967 Test Loss: 0.099 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0013777
	speed: 0.1516s/iter; left time: 5932.8148s
	iters: 200, epoch: 6 | loss: 0.0013122
	speed: 0.0447s/iter; left time: 1746.3014s
	iters: 300, epoch: 6 | loss: 0.0014560
	speed: 0.0450s/iter; left time: 1752.3373s
	iters: 400, epoch: 6 | loss: 0.0000529
	speed: 0.0431s/iter; left time: 1672.6774s
Epoch: 6 cost time: 18.6251437664032
Epoch: 6, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.049 Vali Acc: 0.983 Test Loss: 0.049 Test Acc: 0.983
Validation loss decreased (-0.979081 --> -0.982719).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0002587
	speed: 0.1464s/iter; left time: 5669.1717s
	iters: 200, epoch: 7 | loss: 0.0037526
	speed: 0.0481s/iter; left time: 1856.9942s
	iters: 300, epoch: 7 | loss: 0.0029196
	speed: 0.0477s/iter; left time: 1838.2096s
	iters: 400, epoch: 7 | loss: 0.0239256
	speed: 0.0459s/iter; left time: 1763.3993s
Epoch: 7 cost time: 19.92948341369629
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0046621
	speed: 0.1665s/iter; left time: 6379.0295s
	iters: 200, epoch: 8 | loss: 0.0109319
	speed: 0.0503s/iter; left time: 1920.7985s
	iters: 300, epoch: 8 | loss: 0.0001179
	speed: 0.0475s/iter; left time: 1810.4137s
	iters: 400, epoch: 8 | loss: 0.0002396
	speed: 0.0450s/iter; left time: 1708.6953s
Epoch: 8 cost time: 20.037646293640137
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001804
	speed: 0.1482s/iter; left time: 5616.8271s
	iters: 200, epoch: 9 | loss: 0.0003532
	speed: 0.0437s/iter; left time: 1652.5738s
	iters: 300, epoch: 9 | loss: 0.0005016
	speed: 0.0425s/iter; left time: 1602.3584s
	iters: 400, epoch: 9 | loss: 0.0016776
	speed: 0.0434s/iter; left time: 1633.5555s
Epoch: 9 cost time: 18.247015476226807
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0001230
	speed: 0.1489s/iter; left time: 5583.1694s
	iters: 200, epoch: 10 | loss: 0.0218960
	speed: 0.0452s/iter; left time: 1690.3593s
	iters: 300, epoch: 10 | loss: 0.0018371
	speed: 0.0480s/iter; left time: 1789.9261s
	iters: 400, epoch: 10 | loss: 0.0000656
	speed: 0.0468s/iter; left time: 1739.6196s
Epoch: 10 cost time: 19.25916314125061
Epoch: 10, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000057
	speed: 0.1699s/iter; left time: 6296.5514s
	iters: 200, epoch: 11 | loss: 0.0009989
	speed: 0.0487s/iter; left time: 1801.8924s
	iters: 300, epoch: 11 | loss: 0.0001015
	speed: 0.0489s/iter; left time: 1801.9810s
	iters: 400, epoch: 11 | loss: 0.0000399
	speed: 0.0474s/iter; left time: 1743.6793s
Epoch: 11 cost time: 20.861186027526855
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0023579
	speed: 0.1613s/iter; left time: 5914.0276s
	iters: 200, epoch: 12 | loss: 0.0001538
	speed: 0.0451s/iter; left time: 1650.5276s
	iters: 300, epoch: 12 | loss: 0.0005296
	speed: 0.0485s/iter; left time: 1767.9416s
	iters: 400, epoch: 12 | loss: 0.0000226
	speed: 0.0440s/iter; left time: 1599.5553s
Epoch: 12 cost time: 19.20302987098694
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000052
	speed: 0.1457s/iter; left time: 5280.4607s
	iters: 200, epoch: 13 | loss: 0.0011733
	speed: 0.0441s/iter; left time: 1594.0792s
	iters: 300, epoch: 13 | loss: 0.0035865
	speed: 0.0447s/iter; left time: 1611.7580s
	iters: 400, epoch: 13 | loss: 0.0093140
	speed: 0.0447s/iter; left time: 1606.4461s
Epoch: 13 cost time: 18.730931043624878
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.982 Test Loss: 0.122 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000668
	speed: 0.1602s/iter; left time: 5740.1377s
	iters: 200, epoch: 14 | loss: 0.0008707
	speed: 0.0490s/iter; left time: 1750.3071s
	iters: 300, epoch: 14 | loss: 0.0000384
	speed: 0.0471s/iter; left time: 1679.5271s
	iters: 400, epoch: 14 | loss: 0.0002823
	speed: 0.0523s/iter; left time: 1859.4087s
Epoch: 14 cost time: 20.612600326538086
Epoch: 14, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0017453
	speed: 0.1766s/iter; left time: 6254.7681s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0485s/iter; left time: 1713.8074s
	iters: 300, epoch: 15 | loss: 0.0000971
	speed: 0.0443s/iter; left time: 1561.4129s
	iters: 400, epoch: 15 | loss: 0.0000015
	speed: 0.0453s/iter; left time: 1591.2656s
Epoch: 15 cost time: 19.834670305252075
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0002170
	speed: 0.1480s/iter; left time: 5180.5715s
	iters: 200, epoch: 16 | loss: 0.0005116
	speed: 0.0425s/iter; left time: 1482.3964s
	iters: 300, epoch: 16 | loss: 0.0000539
	speed: 0.0429s/iter; left time: 1492.9285s
	iters: 400, epoch: 16 | loss: 0.0000014
	speed: 0.0439s/iter; left time: 1523.7328s
Epoch: 16 cost time: 18.130842208862305
Epoch: 16, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 345298
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8817506
	speed: 0.0680s/iter; left time: 2802.2819s
	iters: 200, epoch: 1 | loss: 0.4138572
	speed: 0.0483s/iter; left time: 1986.6710s
	iters: 300, epoch: 1 | loss: 0.4266517
	speed: 0.0510s/iter; left time: 2092.0333s
	iters: 400, epoch: 1 | loss: 0.1250615
	speed: 0.0504s/iter; left time: 2059.8586s
Epoch: 1 cost time: 22.492681980133057
Epoch: 1, Steps: 413 | Train Loss: 0.560 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (inf --> -0.968166).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0455419
	speed: 0.1738s/iter; left time: 7089.6864s
	iters: 200, epoch: 2 | loss: 0.0186034
	speed: 0.0478s/iter; left time: 1943.3103s
	iters: 300, epoch: 2 | loss: 0.0637978
	speed: 0.0458s/iter; left time: 1858.8293s
	iters: 400, epoch: 2 | loss: 0.1060709
	speed: 0.0460s/iter; left time: 1862.7917s
Epoch: 2 cost time: 19.851269960403442
Epoch: 2, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
Validation loss decreased (-0.968166 --> -0.974533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0122168
	speed: 0.1542s/iter; left time: 6226.0683s
	iters: 200, epoch: 3 | loss: 0.0248572
	speed: 0.0473s/iter; left time: 1906.9154s
	iters: 300, epoch: 3 | loss: 0.1875399
	speed: 0.0464s/iter; left time: 1862.8822s
	iters: 400, epoch: 3 | loss: 0.0131425
	speed: 0.0466s/iter; left time: 1869.1779s
Epoch: 3 cost time: 19.863390684127808
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0167587
	speed: 0.1567s/iter; left time: 6260.3889s
	iters: 200, epoch: 4 | loss: 0.0017973
	speed: 0.0513s/iter; left time: 2043.1894s
	iters: 300, epoch: 4 | loss: 0.0001941
	speed: 0.0524s/iter; left time: 2083.6499s
	iters: 400, epoch: 4 | loss: 0.0030908
	speed: 0.0490s/iter; left time: 1943.3939s
Epoch: 4 cost time: 21.401894330978394
Epoch: 4, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0015069
	speed: 0.1824s/iter; left time: 7212.1061s
	iters: 200, epoch: 5 | loss: 0.0006024
	speed: 0.0471s/iter; left time: 1859.5980s
	iters: 300, epoch: 5 | loss: 0.0028724
	speed: 0.0472s/iter; left time: 1856.5911s
	iters: 400, epoch: 5 | loss: 0.0041056
	speed: 0.0467s/iter; left time: 1834.8674s
Epoch: 5 cost time: 20.2150776386261
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.974533 --> -0.977716).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0053523
	speed: 0.1449s/iter; left time: 5669.9057s
	iters: 200, epoch: 6 | loss: 0.0000776
	speed: 0.0455s/iter; left time: 1777.4307s
	iters: 300, epoch: 6 | loss: 0.0002181
	speed: 0.0455s/iter; left time: 1771.7574s
	iters: 400, epoch: 6 | loss: 0.0019249
	speed: 0.0448s/iter; left time: 1740.8586s
Epoch: 6 cost time: 19.031365156173706
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0004611
	speed: 0.1535s/iter; left time: 5943.5561s
	iters: 200, epoch: 7 | loss: 0.0098444
	speed: 0.0449s/iter; left time: 1733.4536s
	iters: 300, epoch: 7 | loss: 0.0055774
	speed: 0.0502s/iter; left time: 1934.1764s
	iters: 400, epoch: 7 | loss: 0.0000634
	speed: 0.0499s/iter; left time: 1915.8322s
Epoch: 7 cost time: 20.185187101364136
Epoch: 7, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.977716 --> -0.978171).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0004232
	speed: 0.1825s/iter; left time: 6990.8848s
	iters: 200, epoch: 8 | loss: 0.0001693
	speed: 0.0513s/iter; left time: 1960.2723s
	iters: 300, epoch: 8 | loss: 0.0392593
	speed: 0.0540s/iter; left time: 2059.7439s
	iters: 400, epoch: 8 | loss: 0.0098372
	speed: 0.0496s/iter; left time: 1885.8042s
Epoch: 8 cost time: 21.729668617248535
Epoch: 8, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
Validation loss decreased (-0.978171 --> -0.981809).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0074927
	speed: 0.1358s/iter; left time: 5146.4568s
	iters: 200, epoch: 9 | loss: 0.0117021
	speed: 0.0477s/iter; left time: 1802.2399s
	iters: 300, epoch: 9 | loss: 0.0001578
	speed: 0.0460s/iter; left time: 1732.3004s
	iters: 400, epoch: 9 | loss: 0.0067256
	speed: 0.0467s/iter; left time: 1757.5034s
Epoch: 9 cost time: 19.361326217651367
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0002071
	speed: 0.1506s/iter; left time: 5646.4083s
	iters: 200, epoch: 10 | loss: 0.0042173
	speed: 0.0455s/iter; left time: 1701.9184s
	iters: 300, epoch: 10 | loss: 0.1186933
	speed: 0.0473s/iter; left time: 1763.4259s
	iters: 400, epoch: 10 | loss: 0.0352601
	speed: 0.0481s/iter; left time: 1788.1205s
Epoch: 10 cost time: 19.87136673927307
Epoch: 10, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0039087
	speed: 0.1876s/iter; left time: 6955.8058s
	iters: 200, epoch: 11 | loss: 0.0023355
	speed: 0.0502s/iter; left time: 1855.6119s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0536s/iter; left time: 1975.3461s
	iters: 400, epoch: 11 | loss: 0.0050558
	speed: 0.0496s/iter; left time: 1822.3507s
Epoch: 11 cost time: 21.562742710113525
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0002239
	speed: 0.1731s/iter; left time: 6346.4808s
	iters: 200, epoch: 12 | loss: 0.1998633
	speed: 0.0441s/iter; left time: 1610.4182s
	iters: 300, epoch: 12 | loss: 0.2085893
	speed: 0.0454s/iter; left time: 1654.4381s
	iters: 400, epoch: 12 | loss: 0.0004767
	speed: 0.0451s/iter; left time: 1639.5257s
Epoch: 12 cost time: 19.079431533813477
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0183809
	speed: 0.1505s/iter; left time: 5453.4707s
	iters: 200, epoch: 13 | loss: 0.0000216
	speed: 0.0432s/iter; left time: 1562.5436s
	iters: 300, epoch: 13 | loss: 0.0000026
	speed: 0.0459s/iter; left time: 1654.0525s
	iters: 400, epoch: 13 | loss: 0.0000129
	speed: 0.0446s/iter; left time: 1603.9181s
Epoch: 13 cost time: 18.862096071243286
Epoch: 13, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000412
	speed: 0.1665s/iter; left time: 5965.4832s
	iters: 200, epoch: 14 | loss: 0.0006702
	speed: 0.0530s/iter; left time: 1894.2598s
	iters: 300, epoch: 14 | loss: 0.0000010
	speed: 0.0508s/iter; left time: 1810.3815s
	iters: 400, epoch: 14 | loss: 0.0005972
	speed: 0.0505s/iter; left time: 1795.9061s
Epoch: 14 cost time: 21.838143587112427
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1810s/iter; left time: 6409.0863s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0457s/iter; left time: 1615.3770s
	iters: 300, epoch: 15 | loss: 0.0021375
	speed: 0.0480s/iter; left time: 1689.9831s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1673.2060s
Epoch: 15 cost time: 20.06017279624939
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0177008
	speed: 0.1460s/iter; left time: 5110.7045s
	iters: 200, epoch: 16 | loss: 0.0035606
	speed: 0.0455s/iter; left time: 1586.7410s
	iters: 300, epoch: 16 | loss: 0.0000019
	speed: 0.0458s/iter; left time: 1594.9079s
	iters: 400, epoch: 16 | loss: 0.0000039
	speed: 0.0463s/iter; left time: 1605.2305s
Epoch: 16 cost time: 19.490713119506836
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
Validation loss decreased (-0.981809 --> -0.984992).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000003
	speed: 0.1662s/iter; left time: 5749.7691s
	iters: 200, epoch: 17 | loss: 0.0961557
	speed: 0.0508s/iter; left time: 1750.7750s
	iters: 300, epoch: 17 | loss: 0.0000004
	speed: 0.0532s/iter; left time: 1829.3824s
	iters: 400, epoch: 17 | loss: 0.0000262
	speed: 0.0500s/iter; left time: 1715.5133s
Epoch: 17 cost time: 21.139848470687866
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.256 Vali Acc: 0.962 Test Loss: 0.256 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0986415
	speed: 0.1882s/iter; left time: 6434.0762s
	iters: 200, epoch: 18 | loss: 0.0000373
	speed: 0.0474s/iter; left time: 1616.4101s
	iters: 300, epoch: 18 | loss: 0.0001053
	speed: 0.0464s/iter; left time: 1577.8143s
	iters: 400, epoch: 18 | loss: 0.0008011
	speed: 0.0441s/iter; left time: 1492.6167s
Epoch: 18 cost time: 19.990516185760498
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0107872
	speed: 0.1497s/iter; left time: 5053.9893s
	iters: 200, epoch: 19 | loss: 0.0000008
	speed: 0.0447s/iter; left time: 1503.3799s
	iters: 300, epoch: 19 | loss: 0.0129108
	speed: 0.0450s/iter; left time: 1511.6012s
	iters: 400, epoch: 19 | loss: 0.0264138
	speed: 0.0432s/iter; left time: 1447.0942s
Epoch: 19 cost time: 18.722577810287476
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.982 Test Loss: 0.125 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000006
	speed: 0.1610s/iter; left time: 5368.3874s
	iters: 200, epoch: 20 | loss: 0.0000007
	speed: 0.0448s/iter; left time: 1488.5949s
	iters: 300, epoch: 20 | loss: 0.0000311
	speed: 0.0460s/iter; left time: 1526.1376s
	iters: 400, epoch: 20 | loss: 0.0000071
	speed: 0.0488s/iter; left time: 1614.6498s
Epoch: 20 cost time: 20.043879747390747
Epoch: 20, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.132 Vali Acc: 0.982 Test Loss: 0.132 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1736s/iter; left time: 5720.1815s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1563.6317s
	iters: 300, epoch: 21 | loss: 0.0000392
	speed: 0.0471s/iter; left time: 1541.4132s
	iters: 400, epoch: 21 | loss: 0.0000003
	speed: 0.0470s/iter; left time: 1534.8572s
Epoch: 21 cost time: 19.720832586288452
Epoch: 21, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000056
	speed: 0.1567s/iter; left time: 5095.7318s
	iters: 200, epoch: 22 | loss: 0.0000060
	speed: 0.0438s/iter; left time: 1421.0331s
	iters: 300, epoch: 22 | loss: 0.0005623
	speed: 0.0442s/iter; left time: 1428.6618s
	iters: 400, epoch: 22 | loss: 0.0000002
	speed: 0.0467s/iter; left time: 1504.1234s
Epoch: 22 cost time: 19.13599920272827
Epoch: 22, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1567s/iter; left time: 5032.9690s
	iters: 200, epoch: 23 | loss: 0.0001770
	speed: 0.0450s/iter; left time: 1440.3978s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0483s/iter; left time: 1543.0669s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.0454s/iter; left time: 1445.7392s
Epoch: 23 cost time: 19.5326247215271
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000042
	speed: 0.1728s/iter; left time: 5479.1981s
	iters: 200, epoch: 24 | loss: 0.0000250
	speed: 0.0492s/iter; left time: 1554.0473s
	iters: 300, epoch: 24 | loss: 0.0000002
	speed: 0.0488s/iter; left time: 1537.5293s
	iters: 400, epoch: 24 | loss: 0.0000021
	speed: 0.0439s/iter; left time: 1377.6875s
Epoch: 24 cost time: 20.49485206604004
Epoch: 24, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.982 Test Loss: 0.111 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000747
	speed: 0.1678s/iter; left time: 5249.1663s
	iters: 200, epoch: 25 | loss: 0.0000003
	speed: 0.0433s/iter; left time: 1349.9973s
	iters: 300, epoch: 25 | loss: 0.0000050
	speed: 0.0457s/iter; left time: 1419.7293s
	iters: 400, epoch: 25 | loss: 0.3583495
	speed: 0.0448s/iter; left time: 1388.8776s
Epoch: 25 cost time: 19.06945037841797
Epoch: 25, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.281 Vali Acc: 0.970 Test Loss: 0.281 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000002
	speed: 0.1526s/iter; left time: 4712.6172s
	iters: 200, epoch: 26 | loss: 0.0000678
	speed: 0.0482s/iter; left time: 1484.6126s
	iters: 300, epoch: 26 | loss: 0.0000651
	speed: 0.0445s/iter; left time: 1364.7594s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.0450s/iter; left time: 1377.0031s
Epoch: 26 cost time: 19.519338846206665
Epoch: 26, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 214226
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8878510
	speed: 0.0652s/iter; left time: 2684.4239s
	iters: 200, epoch: 1 | loss: 0.4142841
	speed: 0.0401s/iter; left time: 1650.0459s
	iters: 300, epoch: 1 | loss: 0.3873804
	speed: 0.0456s/iter; left time: 1869.1024s
	iters: 400, epoch: 1 | loss: 0.1144205
	speed: 0.0475s/iter; left time: 1942.2524s
Epoch: 1 cost time: 20.53511142730713
Epoch: 1, Steps: 413 | Train Loss: 0.558 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
Validation loss decreased (inf --> -0.969076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0452941
	speed: 0.1636s/iter; left time: 6672.8052s
	iters: 200, epoch: 2 | loss: 0.0164704
	speed: 0.0529s/iter; left time: 2152.7339s
	iters: 300, epoch: 2 | loss: 0.0351081
	speed: 0.0454s/iter; left time: 1842.8657s
	iters: 400, epoch: 2 | loss: 0.0876024
	speed: 0.0351s/iter; left time: 1419.7308s
Epoch: 2 cost time: 19.56531572341919
Epoch: 2, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
Validation loss decreased (-0.969076 --> -0.976352).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0116731
	speed: 0.1424s/iter; left time: 5749.4817s
	iters: 200, epoch: 3 | loss: 0.0145744
	speed: 0.0422s/iter; left time: 1698.1119s
	iters: 300, epoch: 3 | loss: 0.3659077
	speed: 0.0454s/iter; left time: 1825.1284s
	iters: 400, epoch: 3 | loss: 0.0341889
	speed: 0.0435s/iter; left time: 1743.5437s
Epoch: 3 cost time: 18.84189200401306
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.085 Vali Acc: 0.971 Test Loss: 0.085 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0145377
	speed: 0.1562s/iter; left time: 6243.7090s
	iters: 200, epoch: 4 | loss: 0.0042658
	speed: 0.0438s/iter; left time: 1745.0117s
	iters: 300, epoch: 4 | loss: 0.0026333
	speed: 0.0432s/iter; left time: 1715.8460s
	iters: 400, epoch: 4 | loss: 0.0021522
	speed: 0.0412s/iter; left time: 1635.5383s
Epoch: 4 cost time: 18.4569034576416
Epoch: 4, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.972 Test Loss: 0.087 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0010701
	speed: 0.1444s/iter; left time: 5712.1519s
	iters: 200, epoch: 5 | loss: 0.0004994
	speed: 0.0456s/iter; left time: 1800.4357s
	iters: 300, epoch: 5 | loss: 0.0089885
	speed: 0.0445s/iter; left time: 1749.2522s
	iters: 400, epoch: 5 | loss: 0.0099276
	speed: 0.0467s/iter; left time: 1832.0510s
Epoch: 5 cost time: 18.868839502334595
Epoch: 5, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.972 Test Loss: 0.084 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0020520
	speed: 0.1565s/iter; left time: 6124.9651s
	iters: 200, epoch: 6 | loss: 0.0000339
	speed: 0.0479s/iter; left time: 1869.5019s
	iters: 300, epoch: 6 | loss: 0.0021387
	speed: 0.0445s/iter; left time: 1734.1369s
	iters: 400, epoch: 6 | loss: 0.0008529
	speed: 0.0468s/iter; left time: 1816.8746s
Epoch: 6 cost time: 19.37753200531006
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0006375
	speed: 0.1559s/iter; left time: 6036.2735s
	iters: 200, epoch: 7 | loss: 0.0104956
	speed: 0.0445s/iter; left time: 1719.1990s
	iters: 300, epoch: 7 | loss: 0.0000543
	speed: 0.0443s/iter; left time: 1706.8104s
	iters: 400, epoch: 7 | loss: 0.0031717
	speed: 0.0455s/iter; left time: 1749.7084s
Epoch: 7 cost time: 18.949676036834717
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.976352 --> -0.979990).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0004023
	speed: 0.1452s/iter; left time: 5561.3329s
	iters: 200, epoch: 8 | loss: 0.0010323
	speed: 0.0453s/iter; left time: 1730.6156s
	iters: 300, epoch: 8 | loss: 0.0002405
	speed: 0.0445s/iter; left time: 1694.7575s
	iters: 400, epoch: 8 | loss: 0.0379347
	speed: 0.0437s/iter; left time: 1659.9301s
Epoch: 8 cost time: 18.693968772888184
Epoch: 8, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0048845
	speed: 0.1629s/iter; left time: 6172.0238s
	iters: 200, epoch: 9 | loss: 0.0007879
	speed: 0.0446s/iter; left time: 1687.0600s
	iters: 300, epoch: 9 | loss: 0.0007607
	speed: 0.0440s/iter; left time: 1657.3158s
	iters: 400, epoch: 9 | loss: 0.0293136
	speed: 0.0467s/iter; left time: 1757.0078s
Epoch: 9 cost time: 19.12824058532715
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000054
	speed: 0.1733s/iter; left time: 6495.9531s
	iters: 200, epoch: 10 | loss: 0.0008380
	speed: 0.0446s/iter; left time: 1667.3424s
	iters: 300, epoch: 10 | loss: 0.0001913
	speed: 0.0458s/iter; left time: 1706.9032s
	iters: 400, epoch: 10 | loss: 0.0125572
	speed: 0.0456s/iter; left time: 1696.3379s
Epoch: 10 cost time: 19.594640970230103
Epoch: 10, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0001400
	speed: 0.1596s/iter; left time: 5918.0090s
	iters: 200, epoch: 11 | loss: 0.0020684
	speed: 0.0437s/iter; left time: 1614.0070s
	iters: 300, epoch: 11 | loss: 0.0003496
	speed: 0.0438s/iter; left time: 1613.2734s
	iters: 400, epoch: 11 | loss: 0.0001163
	speed: 0.0433s/iter; left time: 1592.3886s
Epoch: 11 cost time: 18.6837317943573
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0007071
	speed: 0.1526s/iter; left time: 5594.1207s
	iters: 200, epoch: 12 | loss: 0.0001297
	speed: 0.0478s/iter; left time: 1747.1658s
	iters: 300, epoch: 12 | loss: 0.0088249
	speed: 0.0460s/iter; left time: 1675.7295s
	iters: 400, epoch: 12 | loss: 0.0003848
	speed: 0.0464s/iter; left time: 1687.1200s
Epoch: 12 cost time: 19.57754945755005
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.982 Test Loss: 0.102 Test Acc: 0.982
Validation loss decreased (-0.979990 --> -0.982264).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0002404
	speed: 0.1551s/iter; left time: 5620.3069s
	iters: 200, epoch: 13 | loss: 0.0000016
	speed: 0.0481s/iter; left time: 1738.9262s
	iters: 300, epoch: 13 | loss: 0.0000273
	speed: 0.0459s/iter; left time: 1654.4136s
	iters: 400, epoch: 13 | loss: 0.0000976
	speed: 0.0450s/iter; left time: 1617.4575s
Epoch: 13 cost time: 19.312524795532227
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000021
	speed: 0.1472s/iter; left time: 5274.1489s
	iters: 200, epoch: 14 | loss: 0.0000268
	speed: 0.0452s/iter; left time: 1616.5005s
	iters: 300, epoch: 14 | loss: 0.0000050
	speed: 0.0444s/iter; left time: 1581.1895s
	iters: 400, epoch: 14 | loss: 0.0000041
	speed: 0.0443s/iter; left time: 1572.4952s
Epoch: 14 cost time: 18.891715049743652
Epoch: 14, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.139 Vali Acc: 0.974 Test Loss: 0.139 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000770
	speed: 0.1515s/iter; left time: 5367.5927s
	iters: 200, epoch: 15 | loss: 0.0005518
	speed: 0.0467s/iter; left time: 1649.2176s
	iters: 300, epoch: 15 | loss: 0.0000112
	speed: 0.0452s/iter; left time: 1592.2784s
	iters: 400, epoch: 15 | loss: 0.0001621
	speed: 0.0448s/iter; left time: 1572.2456s
Epoch: 15 cost time: 19.577882528305054
Epoch: 15, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
Validation loss decreased (-0.982264 --> -0.982264).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000222
	speed: 0.1595s/iter; left time: 5582.7663s
	iters: 200, epoch: 16 | loss: 0.0000311
	speed: 0.0453s/iter; left time: 1579.8209s
	iters: 300, epoch: 16 | loss: 0.0011107
	speed: 0.0482s/iter; left time: 1677.7778s
	iters: 400, epoch: 16 | loss: 0.0002702
	speed: 0.0474s/iter; left time: 1644.0809s
Epoch: 16 cost time: 19.988708019256592
Epoch: 16, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000053
	speed: 0.1757s/iter; left time: 6077.0519s
	iters: 200, epoch: 17 | loss: 0.0001623
	speed: 0.0454s/iter; left time: 1566.1979s
	iters: 300, epoch: 17 | loss: 0.0000018
	speed: 0.0487s/iter; left time: 1676.0800s
	iters: 400, epoch: 17 | loss: 0.0002088
	speed: 0.0441s/iter; left time: 1510.8036s
Epoch: 17 cost time: 19.5185706615448
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.968 Test Loss: 0.223 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0001068
	speed: 0.1600s/iter; left time: 5468.2056s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0448s/iter; left time: 1527.0826s
	iters: 300, epoch: 18 | loss: 0.0033334
	speed: 0.0451s/iter; left time: 1531.8305s
	iters: 400, epoch: 18 | loss: 0.0008193
	speed: 0.0449s/iter; left time: 1520.7528s
Epoch: 18 cost time: 19.39100670814514
Epoch: 18, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0001695
	speed: 0.1702s/iter; left time: 5746.4206s
	iters: 200, epoch: 19 | loss: 0.0000105
	speed: 0.0524s/iter; left time: 1763.9850s
	iters: 300, epoch: 19 | loss: 0.0143074
	speed: 0.0493s/iter; left time: 1654.8610s
	iters: 400, epoch: 19 | loss: 0.0000270
	speed: 0.0488s/iter; left time: 1634.4941s
Epoch: 19 cost time: 21.405831575393677
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
Validation loss decreased (-0.982264 --> -0.987266).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000044
	speed: 0.1715s/iter; left time: 5720.6460s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 1512.0552s
	iters: 300, epoch: 20 | loss: 0.0002199
	speed: 0.0458s/iter; left time: 1520.0170s
	iters: 400, epoch: 20 | loss: 0.0000093
	speed: 0.0474s/iter; left time: 1567.8779s
Epoch: 20 cost time: 19.815187692642212
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0001949
	speed: 0.1531s/iter; left time: 5044.6675s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.0458s/iter; left time: 1504.3459s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.0466s/iter; left time: 1524.1187s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1530.2702s
Epoch: 21 cost time: 19.75862956047058
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000002
	speed: 0.1544s/iter; left time: 5020.8810s
	iters: 200, epoch: 22 | loss: 0.0000256
	speed: 0.0463s/iter; left time: 1501.1762s
	iters: 300, epoch: 22 | loss: 0.0001514
	speed: 0.0504s/iter; left time: 1627.7239s
	iters: 400, epoch: 22 | loss: 0.0000002
	speed: 0.0492s/iter; left time: 1587.0692s
Epoch: 22 cost time: 20.219589233398438
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1667s/iter; left time: 5355.0164s
	iters: 200, epoch: 23 | loss: 0.0000042
	speed: 0.0471s/iter; left time: 1507.6526s
	iters: 300, epoch: 23 | loss: 0.0001452
	speed: 0.0474s/iter; left time: 1513.4724s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1492.6829s
Epoch: 23 cost time: 20.18973684310913
Epoch: 23, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1545s/iter; left time: 4898.6861s
	iters: 200, epoch: 24 | loss: 0.0000042
	speed: 0.0453s/iter; left time: 1430.5009s
	iters: 300, epoch: 24 | loss: 0.0000003
	speed: 0.0475s/iter; left time: 1495.6652s
	iters: 400, epoch: 24 | loss: 0.0002912
	speed: 0.0470s/iter; left time: 1475.6928s
Epoch: 24 cost time: 19.50512433052063
Epoch: 24, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.984 Test Loss: 0.084 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0008264
	speed: 0.1581s/iter; left time: 4946.5463s
	iters: 200, epoch: 25 | loss: 0.0000006
	speed: 0.0449s/iter; left time: 1399.3418s
	iters: 300, epoch: 25 | loss: 0.0001488
	speed: 0.0460s/iter; left time: 1428.8950s
	iters: 400, epoch: 25 | loss: 0.0000001
	speed: 0.0471s/iter; left time: 1458.7658s
Epoch: 25 cost time: 19.86949896812439
Epoch: 25, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1772s/iter; left time: 5471.5187s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0483s/iter; left time: 1486.3924s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 1542.2064s
	iters: 400, epoch: 26 | loss: 0.0000002
	speed: 0.0505s/iter; left time: 1544.1195s
Epoch: 26 cost time: 20.91445541381836
Epoch: 26, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.986 Test Loss: 0.082 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000032
	speed: 0.1642s/iter; left time: 5000.7286s
	iters: 200, epoch: 27 | loss: 0.0001012
	speed: 0.0464s/iter; left time: 1408.1599s
	iters: 300, epoch: 27 | loss: 0.0001366
	speed: 0.0464s/iter; left time: 1405.5052s
	iters: 400, epoch: 27 | loss: 0.0326775
	speed: 0.0438s/iter; left time: 1320.8099s
Epoch: 27 cost time: 19.376670837402344
Epoch: 27, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000001
	speed: 0.1418s/iter; left time: 4262.1455s
	iters: 200, epoch: 28 | loss: 0.0000009
	speed: 0.0436s/iter; left time: 1304.3876s
	iters: 300, epoch: 28 | loss: 0.0000119
	speed: 0.0458s/iter; left time: 1367.9447s
	iters: 400, epoch: 28 | loss: 0.1109662
	speed: 0.0453s/iter; left time: 1346.2316s
Epoch: 28 cost time: 18.966165781021118
Epoch: 28, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.143 Vali Acc: 0.978 Test Loss: 0.143 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.1658s/iter; left time: 4914.1197s
	iters: 200, epoch: 29 | loss: 0.0000011
	speed: 0.0472s/iter; left time: 1393.2325s
	iters: 300, epoch: 29 | loss: 0.0000001
	speed: 0.0469s/iter; left time: 1380.2761s
	iters: 400, epoch: 29 | loss: 0.0000046
	speed: 0.0450s/iter; left time: 1321.1854s
Epoch: 29 cost time: 20.10329556465149
Epoch: 29, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.978 Test Loss: 0.179 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 214226
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9130009
	speed: 0.0621s/iter; left time: 2558.1633s
	iters: 200, epoch: 1 | loss: 0.3749687
	speed: 0.0438s/iter; left time: 1799.0087s
	iters: 300, epoch: 1 | loss: 0.3405243
	speed: 0.0459s/iter; left time: 1882.5547s
	iters: 400, epoch: 1 | loss: 0.1329180
	speed: 0.0441s/iter; left time: 1803.2388s
Epoch: 1 cost time: 20.28609347343445
Epoch: 1, Steps: 413 | Train Loss: 0.569 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
Validation loss decreased (inf --> -0.968621).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0378927
	speed: 0.1457s/iter; left time: 5943.3105s
	iters: 200, epoch: 2 | loss: 0.0255502
	speed: 0.0450s/iter; left time: 1830.1693s
	iters: 300, epoch: 2 | loss: 0.0297084
	speed: 0.0445s/iter; left time: 1806.9372s
	iters: 400, epoch: 2 | loss: 0.0724728
	speed: 0.0442s/iter; left time: 1788.5489s
Epoch: 2 cost time: 18.72382426261902
Epoch: 2, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.968621 --> -0.976807).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0077478
	speed: 0.1698s/iter; left time: 6856.6975s
	iters: 200, epoch: 3 | loss: 0.0146536
	speed: 0.0473s/iter; left time: 1903.6640s
	iters: 300, epoch: 3 | loss: 0.2907561
	speed: 0.0466s/iter; left time: 1873.8101s
	iters: 400, epoch: 3 | loss: 0.0143313
	speed: 0.0512s/iter; left time: 2050.0114s
Epoch: 3 cost time: 20.357320070266724
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976807 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0045398
	speed: 0.1661s/iter; left time: 6636.9107s
	iters: 200, epoch: 4 | loss: 0.0059554
	speed: 0.0441s/iter; left time: 1757.7738s
	iters: 300, epoch: 4 | loss: 0.0046587
	speed: 0.0451s/iter; left time: 1791.4395s
	iters: 400, epoch: 4 | loss: 0.0018013
	speed: 0.0429s/iter; left time: 1703.4120s
Epoch: 4 cost time: 18.737655639648438
Epoch: 4, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.052 Vali Acc: 0.984 Test Loss: 0.052 Test Acc: 0.984
Validation loss decreased (-0.976807 --> -0.983628).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0078801
	speed: 0.1545s/iter; left time: 6111.2200s
	iters: 200, epoch: 5 | loss: 0.0013199
	speed: 0.0423s/iter; left time: 1669.2613s
	iters: 300, epoch: 5 | loss: 0.0039652
	speed: 0.0444s/iter; left time: 1745.5264s
	iters: 400, epoch: 5 | loss: 0.0069028
	speed: 0.0433s/iter; left time: 1699.0685s
Epoch: 5 cost time: 18.60237717628479
Epoch: 5, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0110754
	speed: 0.1496s/iter; left time: 5853.6222s
	iters: 200, epoch: 6 | loss: 0.0011652
	speed: 0.0455s/iter; left time: 1777.5063s
	iters: 300, epoch: 6 | loss: 0.0018833
	speed: 0.0479s/iter; left time: 1865.0169s
	iters: 400, epoch: 6 | loss: 0.0271563
	speed: 0.0471s/iter; left time: 1827.2364s
Epoch: 6 cost time: 19.46750807762146
Epoch: 6, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0047661
	speed: 0.1596s/iter; left time: 6178.4455s
	iters: 200, epoch: 7 | loss: 0.0762891
	speed: 0.0473s/iter; left time: 1826.1336s
	iters: 300, epoch: 7 | loss: 0.0000417
	speed: 0.0465s/iter; left time: 1789.5737s
	iters: 400, epoch: 7 | loss: 0.0005867
	speed: 0.0418s/iter; left time: 1605.0116s
Epoch: 7 cost time: 19.240602493286133
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0036798
	speed: 0.1501s/iter; left time: 5749.8749s
	iters: 200, epoch: 8 | loss: 0.0001743
	speed: 0.0436s/iter; left time: 1667.2786s
	iters: 300, epoch: 8 | loss: 0.0002343
	speed: 0.0462s/iter; left time: 1761.7079s
	iters: 400, epoch: 8 | loss: 0.0006870
	speed: 0.0450s/iter; left time: 1709.8947s
Epoch: 8 cost time: 18.67257857322693
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0057020
	speed: 0.1425s/iter; left time: 5399.3159s
	iters: 200, epoch: 9 | loss: 0.0000013
	speed: 0.0443s/iter; left time: 1673.6135s
	iters: 300, epoch: 9 | loss: 0.0000034
	speed: 0.0453s/iter; left time: 1709.4775s
	iters: 400, epoch: 9 | loss: 0.0008043
	speed: 0.0484s/iter; left time: 1818.9852s
Epoch: 9 cost time: 19.109570026397705
Epoch: 9, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000121
	speed: 0.1624s/iter; left time: 6087.9822s
	iters: 200, epoch: 10 | loss: 0.0411363
	speed: 0.0425s/iter; left time: 1589.5605s
	iters: 300, epoch: 10 | loss: 0.0004003
	speed: 0.0464s/iter; left time: 1728.3195s
	iters: 400, epoch: 10 | loss: 0.0203732
	speed: 0.0469s/iter; left time: 1743.6505s
Epoch: 10 cost time: 19.37863779067993
Epoch: 10, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0004884
	speed: 0.1595s/iter; left time: 5914.0164s
	iters: 200, epoch: 11 | loss: 0.0000707
	speed: 0.0426s/iter; left time: 1574.6463s
	iters: 300, epoch: 11 | loss: 0.0000046
	speed: 0.0459s/iter; left time: 1690.6948s
	iters: 400, epoch: 11 | loss: 0.0002964
	speed: 0.0438s/iter; left time: 1611.1755s
Epoch: 11 cost time: 18.39778208732605
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0009549
	speed: 0.1491s/iter; left time: 5466.9427s
	iters: 200, epoch: 12 | loss: 0.0102930
	speed: 0.0448s/iter; left time: 1637.6767s
	iters: 300, epoch: 12 | loss: 0.0001644
	speed: 0.0428s/iter; left time: 1559.7533s
	iters: 400, epoch: 12 | loss: 0.0008293
	speed: 0.0430s/iter; left time: 1563.2487s
Epoch: 12 cost time: 18.400927543640137
Epoch: 12, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000732
	speed: 0.1589s/iter; left time: 5757.9249s
	iters: 200, epoch: 13 | loss: 0.0000459
	speed: 0.0459s/iter; left time: 1659.4572s
	iters: 300, epoch: 13 | loss: 0.0000273
	speed: 0.0453s/iter; left time: 1634.1328s
	iters: 400, epoch: 13 | loss: 0.0068375
	speed: 0.0473s/iter; left time: 1700.1442s
Epoch: 13 cost time: 19.634543418884277
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0004499
	speed: 0.1643s/iter; left time: 5888.9517s
	iters: 200, epoch: 14 | loss: 0.0012196
	speed: 0.0475s/iter; left time: 1697.6125s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1524.0776s
	iters: 400, epoch: 14 | loss: 0.0010169
	speed: 0.0417s/iter; left time: 1481.4238s
Epoch: 14 cost time: 18.92662286758423
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 214226
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0849922
	speed: 0.0612s/iter; left time: 2519.6697s
	iters: 200, epoch: 1 | loss: 0.3774741
	speed: 0.0446s/iter; left time: 1834.0251s
	iters: 300, epoch: 1 | loss: 0.2203257
	speed: 0.0439s/iter; left time: 1799.3709s
	iters: 400, epoch: 1 | loss: 0.1163706
	speed: 0.0440s/iter; left time: 1798.9312s
Epoch: 1 cost time: 20.122737884521484
Epoch: 1, Steps: 413 | Train Loss: 0.641 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (inf --> -0.967711).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0174362
	speed: 0.1579s/iter; left time: 6438.3959s
	iters: 200, epoch: 2 | loss: 0.0112371
	speed: 0.0454s/iter; left time: 1848.3669s
	iters: 300, epoch: 2 | loss: 0.0288135
	speed: 0.0461s/iter; left time: 1870.5016s
	iters: 400, epoch: 2 | loss: 0.0530576
	speed: 0.0470s/iter; left time: 1903.5079s
Epoch: 2 cost time: 19.860121250152588
Epoch: 2, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.067 Vali Acc: 0.976 Test Loss: 0.067 Test Acc: 0.976
Validation loss decreased (-0.967711 --> -0.976352).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0218234
	speed: 0.1691s/iter; left time: 6827.8231s
	iters: 200, epoch: 3 | loss: 0.0075346
	speed: 0.0459s/iter; left time: 1847.6288s
	iters: 300, epoch: 3 | loss: 0.4350598
	speed: 0.0432s/iter; left time: 1737.3047s
	iters: 400, epoch: 3 | loss: 0.0160178
	speed: 0.0443s/iter; left time: 1774.4528s
Epoch: 3 cost time: 19.22149133682251
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.065 Vali Acc: 0.978 Test Loss: 0.065 Test Acc: 0.978
Validation loss decreased (-0.976352 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0207856
	speed: 0.1553s/iter; left time: 6205.7403s
	iters: 200, epoch: 4 | loss: 0.0005519
	speed: 0.0444s/iter; left time: 1769.8827s
	iters: 300, epoch: 4 | loss: 0.0121720
	speed: 0.0428s/iter; left time: 1703.0925s
	iters: 400, epoch: 4 | loss: 0.0006242
	speed: 0.0448s/iter; left time: 1775.2891s
Epoch: 4 cost time: 18.506894826889038
Epoch: 4, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0012719
	speed: 0.1494s/iter; left time: 5909.5232s
	iters: 200, epoch: 5 | loss: 0.0004084
	speed: 0.0488s/iter; left time: 1923.3146s
	iters: 300, epoch: 5 | loss: 0.0132426
	speed: 0.0487s/iter; left time: 1917.6199s
	iters: 400, epoch: 5 | loss: 0.0018171
	speed: 0.0489s/iter; left time: 1921.0546s
Epoch: 5 cost time: 20.0644748210907
Epoch: 5, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.057 Vali Acc: 0.980 Test Loss: 0.057 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.980445).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0381344
	speed: 0.1684s/iter; left time: 6590.0091s
	iters: 200, epoch: 6 | loss: 0.0006024
	speed: 0.0441s/iter; left time: 1722.2951s
	iters: 300, epoch: 6 | loss: 0.0121102
	speed: 0.0460s/iter; left time: 1791.9403s
	iters: 400, epoch: 6 | loss: 0.0008455
	speed: 0.0434s/iter; left time: 1685.4501s
Epoch: 6 cost time: 19.181296825408936
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0039881
	speed: 0.1417s/iter; left time: 5487.5659s
	iters: 200, epoch: 7 | loss: 0.0021551
	speed: 0.0429s/iter; left time: 1656.0232s
	iters: 300, epoch: 7 | loss: 0.0002634
	speed: 0.0463s/iter; left time: 1783.8623s
	iters: 400, epoch: 7 | loss: 0.2325379
	speed: 0.0431s/iter; left time: 1656.4105s
Epoch: 7 cost time: 18.51581597328186
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0003705
	speed: 0.1415s/iter; left time: 5420.7702s
	iters: 200, epoch: 8 | loss: 0.0003010
	speed: 0.0445s/iter; left time: 1698.7772s
	iters: 300, epoch: 8 | loss: 0.0007456
	speed: 0.0442s/iter; left time: 1684.7361s
	iters: 400, epoch: 8 | loss: 0.0120994
	speed: 0.0447s/iter; left time: 1699.9438s
Epoch: 8 cost time: 18.54674458503723
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0034741
	speed: 0.1632s/iter; left time: 6185.4578s
	iters: 200, epoch: 9 | loss: 0.0000577
	speed: 0.0418s/iter; left time: 1579.6318s
	iters: 300, epoch: 9 | loss: 0.0105470
	speed: 0.0455s/iter; left time: 1715.7342s
	iters: 400, epoch: 9 | loss: 0.0010637
	speed: 0.0469s/iter; left time: 1762.5393s
Epoch: 9 cost time: 18.79164409637451
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0003313
	speed: 0.1591s/iter; left time: 5965.5544s
	iters: 200, epoch: 10 | loss: 0.0133076
	speed: 0.0422s/iter; left time: 1578.0837s
	iters: 300, epoch: 10 | loss: 0.0005232
	speed: 0.0442s/iter; left time: 1647.3972s
	iters: 400, epoch: 10 | loss: 0.0837693
	speed: 0.0434s/iter; left time: 1612.3892s
Epoch: 10 cost time: 18.346088647842407
Epoch: 10, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0031767
	speed: 0.1521s/iter; left time: 5637.4223s
	iters: 200, epoch: 11 | loss: 0.0000627
	speed: 0.0415s/iter; left time: 1532.9237s
	iters: 300, epoch: 11 | loss: 0.0004509
	speed: 0.0445s/iter; left time: 1641.2267s
	iters: 400, epoch: 11 | loss: 0.0008664
	speed: 0.0452s/iter; left time: 1662.5294s
Epoch: 11 cost time: 18.32538938522339
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.980899).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0024127
	speed: 0.1510s/iter; left time: 5533.7109s
	iters: 200, epoch: 12 | loss: 0.1675385
	speed: 0.0494s/iter; left time: 1805.0760s
	iters: 300, epoch: 12 | loss: 0.0000615
	speed: 0.0483s/iter; left time: 1759.5746s
	iters: 400, epoch: 12 | loss: 0.0001348
	speed: 0.0473s/iter; left time: 1718.6907s
Epoch: 12 cost time: 20.535961866378784
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0015536
	speed: 0.1688s/iter; left time: 6117.4209s
	iters: 200, epoch: 13 | loss: 0.0000110
	speed: 0.0496s/iter; left time: 1792.9297s
	iters: 300, epoch: 13 | loss: 0.0091683
	speed: 0.0470s/iter; left time: 1692.7915s
	iters: 400, epoch: 13 | loss: 0.0000198
	speed: 0.0443s/iter; left time: 1591.6754s
Epoch: 13 cost time: 19.737020015716553
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
Validation loss decreased (-0.980899 --> -0.982264).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1074393
	speed: 0.1411s/iter; left time: 5055.4980s
	iters: 200, epoch: 14 | loss: 0.0039653
	speed: 0.0443s/iter; left time: 1581.5085s
	iters: 300, epoch: 14 | loss: 0.0000079
	speed: 0.0435s/iter; left time: 1549.6336s
	iters: 400, epoch: 14 | loss: 0.0000549
	speed: 0.0417s/iter; left time: 1483.3004s
Epoch: 14 cost time: 18.224364280700684
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000980
	speed: 0.1365s/iter; left time: 4833.2643s
	iters: 200, epoch: 15 | loss: 0.0004371
	speed: 0.0424s/iter; left time: 1499.0860s
	iters: 300, epoch: 15 | loss: 0.0033099
	speed: 0.0456s/iter; left time: 1607.7290s
	iters: 400, epoch: 15 | loss: 0.0000036
	speed: 0.0479s/iter; left time: 1682.7303s
Epoch: 15 cost time: 18.651998281478882
Epoch: 15, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0099699
	speed: 0.1622s/iter; left time: 5677.3788s
	iters: 200, epoch: 16 | loss: 0.0000095
	speed: 0.0489s/iter; left time: 1707.1588s
	iters: 300, epoch: 16 | loss: 0.0001935
	speed: 0.0491s/iter; left time: 1708.8850s
	iters: 400, epoch: 16 | loss: 0.0004509
	speed: 0.0488s/iter; left time: 1694.2804s
Epoch: 16 cost time: 20.267079830169678
Epoch: 16, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000006
	speed: 0.1451s/iter; left time: 5018.0368s
	iters: 200, epoch: 17 | loss: 0.0000041
	speed: 0.0445s/iter; left time: 1534.4013s
	iters: 300, epoch: 17 | loss: 0.0000005
	speed: 0.0441s/iter; left time: 1517.2404s
	iters: 400, epoch: 17 | loss: 0.0000206
	speed: 0.0442s/iter; left time: 1517.2814s
Epoch: 17 cost time: 18.447932720184326
Epoch: 17, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.982264 --> -0.984083).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000062
	speed: 0.1445s/iter; left time: 4940.0015s
	iters: 200, epoch: 18 | loss: 0.0000562
	speed: 0.0423s/iter; left time: 1440.1560s
	iters: 300, epoch: 18 | loss: 0.0000577
	speed: 0.0459s/iter; left time: 1559.4635s
	iters: 400, epoch: 18 | loss: 0.1233057
	speed: 0.0466s/iter; left time: 1579.8502s
Epoch: 18 cost time: 18.94462013244629
Epoch: 18, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.982 Test Loss: 0.120 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0196836
	speed: 0.1661s/iter; left time: 5608.0782s
	iters: 200, epoch: 19 | loss: 0.0000003
	speed: 0.0485s/iter; left time: 1633.7084s
	iters: 300, epoch: 19 | loss: 0.1104145
	speed: 0.0471s/iter; left time: 1579.7341s
	iters: 400, epoch: 19 | loss: 0.0000136
	speed: 0.0463s/iter; left time: 1550.3840s
Epoch: 19 cost time: 20.127111673355103
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1510214
	speed: 0.1715s/iter; left time: 5720.5408s
	iters: 200, epoch: 20 | loss: 0.0000026
	speed: 0.0434s/iter; left time: 1443.0151s
	iters: 300, epoch: 20 | loss: 0.0560428
	speed: 0.0477s/iter; left time: 1581.5578s
	iters: 400, epoch: 20 | loss: 0.0000004
	speed: 0.0476s/iter; left time: 1571.8124s
Epoch: 20 cost time: 19.732593536376953
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.1376s/iter; left time: 4533.7130s
	iters: 200, epoch: 21 | loss: 0.0000010
	speed: 0.0446s/iter; left time: 1463.9316s
	iters: 300, epoch: 21 | loss: 0.0001021
	speed: 0.0468s/iter; left time: 1532.4603s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1419.6329s
Epoch: 21 cost time: 18.09653663635254
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000168
	speed: 0.1453s/iter; left time: 4727.7575s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 1359.7203s
	iters: 300, epoch: 22 | loss: 0.0000016
	speed: 0.0439s/iter; left time: 1419.4783s
	iters: 400, epoch: 22 | loss: 0.0000156
	speed: 0.0424s/iter; left time: 1365.5455s
Epoch: 22 cost time: 18.233112812042236
Epoch: 22, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.977 Test Loss: 0.182 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0002362
	speed: 0.1452s/iter; left time: 4661.6197s
	iters: 200, epoch: 23 | loss: 0.0000888
	speed: 0.0459s/iter; left time: 1468.6103s
	iters: 300, epoch: 23 | loss: 0.0000288
	speed: 0.0468s/iter; left time: 1494.2527s
	iters: 400, epoch: 23 | loss: 0.0004528
	speed: 0.0479s/iter; left time: 1525.1272s
Epoch: 23 cost time: 19.369423627853394
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.075 Vali Acc: 0.986 Test Loss: 0.075 Test Acc: 0.986
Validation loss decreased (-0.984083 --> -0.986357).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0019771
	speed: 0.1587s/iter; left time: 5031.4690s
	iters: 200, epoch: 24 | loss: 0.0001109
	speed: 0.0478s/iter; left time: 1509.7011s
	iters: 300, epoch: 24 | loss: 0.0000002
	speed: 0.0461s/iter; left time: 1453.1460s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1436.9907s
Epoch: 24 cost time: 19.516569137573242
Epoch: 24, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.067 Vali Acc: 0.989 Test Loss: 0.067 Test Acc: 0.989
Validation loss decreased (-0.986357 --> -0.988631).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.1522s/iter; left time: 4762.9551s
	iters: 200, epoch: 25 | loss: 0.0000008
	speed: 0.0426s/iter; left time: 1328.6512s
	iters: 300, epoch: 25 | loss: 0.0000014
	speed: 0.0455s/iter; left time: 1413.8461s
	iters: 400, epoch: 25 | loss: 0.0056285
	speed: 0.0445s/iter; left time: 1379.6993s
Epoch: 25 cost time: 18.536430835723877
Epoch: 25, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.1447s/iter; left time: 4469.2184s
	iters: 200, epoch: 26 | loss: 0.0215195
	speed: 0.0472s/iter; left time: 1451.8186s
	iters: 300, epoch: 26 | loss: 0.0000002
	speed: 0.0431s/iter; left time: 1323.1924s
	iters: 400, epoch: 26 | loss: 0.0021977
	speed: 0.0452s/iter; left time: 1382.2334s
Epoch: 26 cost time: 19.02544069290161
Epoch: 26, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1732s/iter; left time: 5274.8261s
	iters: 200, epoch: 27 | loss: 0.0000142
	speed: 0.0498s/iter; left time: 1511.9731s
	iters: 300, epoch: 27 | loss: 0.0001323
	speed: 0.0493s/iter; left time: 1493.1125s
	iters: 400, epoch: 27 | loss: 0.0000001
	speed: 0.0486s/iter; left time: 1465.0795s
Epoch: 27 cost time: 20.446760654449463
Epoch: 27, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000004
	speed: 0.1687s/iter; left time: 5069.8544s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1359.1763s
	iters: 300, epoch: 28 | loss: 0.0000147
	speed: 0.0442s/iter; left time: 1319.3284s
	iters: 400, epoch: 28 | loss: 0.0000403
	speed: 0.0453s/iter; left time: 1346.8462s
Epoch: 28 cost time: 19.151817798614502
Epoch: 28, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.985 Test Loss: 0.103 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.1536s/iter; left time: 4552.1057s
	iters: 200, epoch: 29 | loss: 0.0001319
	speed: 0.0450s/iter; left time: 1329.4018s
	iters: 300, epoch: 29 | loss: 0.0000089
	speed: 0.0446s/iter; left time: 1311.4382s
	iters: 400, epoch: 29 | loss: 0.0018305
	speed: 0.0431s/iter; left time: 1265.1421s
Epoch: 29 cost time: 18.69228720664978
Epoch: 29, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.984 Test Loss: 0.098 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0032059
	speed: 0.1459s/iter; left time: 4263.1120s
	iters: 200, epoch: 30 | loss: 0.0102238
	speed: 0.0485s/iter; left time: 1413.5599s
	iters: 300, epoch: 30 | loss: 0.0000005
	speed: 0.0458s/iter; left time: 1328.4078s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 1395.2819s
Epoch: 30 cost time: 19.849696397781372
Epoch: 30, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.986 Test Loss: 0.092 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000013
	speed: 0.1686s/iter; left time: 4856.1967s
	iters: 200, epoch: 31 | loss: 0.0000015
	speed: 0.0479s/iter; left time: 1374.3885s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 1317.6163s
	iters: 400, epoch: 31 | loss: 0.0000151
	speed: 0.0451s/iter; left time: 1285.7168s
Epoch: 31 cost time: 19.655750036239624
Epoch: 31, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.136 Vali Acc: 0.982 Test Loss: 0.136 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000024
	speed: 0.1406s/iter; left time: 3991.3872s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1203.6334s
	iters: 300, epoch: 32 | loss: 0.0000003
	speed: 0.0427s/iter; left time: 1205.3924s
	iters: 400, epoch: 32 | loss: 0.0004270
	speed: 0.0423s/iter; left time: 1188.6804s
Epoch: 32 cost time: 17.91176414489746
Epoch: 32, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000006
	speed: 0.1474s/iter; left time: 4126.1590s
	iters: 200, epoch: 33 | loss: 0.0000023
	speed: 0.0423s/iter; left time: 1178.6049s
	iters: 300, epoch: 33 | loss: 0.0001602
	speed: 0.0446s/iter; left time: 1238.4609s
	iters: 400, epoch: 33 | loss: 0.0000003
	speed: 0.0490s/iter; left time: 1356.8106s
Epoch: 33 cost time: 18.98251223564148
Epoch: 33, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.985 Test Loss: 0.125 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0040595
	speed: 0.1678s/iter; left time: 4625.4422s
	iters: 200, epoch: 34 | loss: 0.0000006
	speed: 0.0500s/iter; left time: 1372.8341s
	iters: 300, epoch: 34 | loss: 0.0000002
	speed: 0.0493s/iter; left time: 1350.6921s
	iters: 400, epoch: 34 | loss: 0.0000096
	speed: 0.0491s/iter; left time: 1340.1361s
Epoch: 34 cost time: 20.28487730026245
Epoch: 34, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.978 Test Loss: 0.175 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 214226
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8491333
	speed: 0.0653s/iter; left time: 2692.0796s
	iters: 200, epoch: 1 | loss: 0.2565761
	speed: 0.0460s/iter; left time: 1888.8979s
	iters: 300, epoch: 1 | loss: 0.1196741
	speed: 0.0468s/iter; left time: 1919.5598s
	iters: 400, epoch: 1 | loss: 0.0401801
	speed: 0.0483s/iter; left time: 1975.4037s
Epoch: 1 cost time: 21.30110216140747
Epoch: 1, Steps: 413 | Train Loss: 0.556 Vali Loss: 0.125 Vali Acc: 0.961 Test Loss: 0.125 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0927499
	speed: 0.1550s/iter; left time: 6321.8777s
	iters: 200, epoch: 2 | loss: 0.0079094
	speed: 0.0485s/iter; left time: 1972.2933s
	iters: 300, epoch: 2 | loss: 0.0728515
	speed: 0.0497s/iter; left time: 2017.0592s
	iters: 400, epoch: 2 | loss: 0.0149183
	speed: 0.0486s/iter; left time: 1969.7210s
Epoch: 2 cost time: 20.21290898323059
Epoch: 2, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
Validation loss decreased (-0.960890 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0092025
	speed: 0.1652s/iter; left time: 6669.0559s
	iters: 200, epoch: 3 | loss: 0.0025787
	speed: 0.0480s/iter; left time: 1931.3819s
	iters: 300, epoch: 3 | loss: 0.0301188
	speed: 0.0456s/iter; left time: 1832.7042s
	iters: 400, epoch: 3 | loss: 0.0497737
	speed: 0.0427s/iter; left time: 1713.1778s
Epoch: 3 cost time: 19.414169311523438
Epoch: 3, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
Validation loss decreased (-0.969076 --> -0.969531).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0417470
	speed: 0.1500s/iter; left time: 5993.5060s
	iters: 200, epoch: 4 | loss: 0.0021057
	speed: 0.0455s/iter; left time: 1811.9402s
	iters: 300, epoch: 4 | loss: 0.0629207
	speed: 0.0457s/iter; left time: 1817.2806s
	iters: 400, epoch: 4 | loss: 0.0017038
	speed: 0.0443s/iter; left time: 1758.8370s
Epoch: 4 cost time: 18.82682204246521
Epoch: 4, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
Validation loss decreased (-0.969531 --> -0.978171).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0013006
	speed: 0.1443s/iter; left time: 5705.4113s
	iters: 200, epoch: 5 | loss: 0.1513364
	speed: 0.0421s/iter; left time: 1660.2356s
	iters: 300, epoch: 5 | loss: 0.2633028
	speed: 0.0429s/iter; left time: 1686.4128s
	iters: 400, epoch: 5 | loss: 0.0156571
	speed: 0.0463s/iter; left time: 1815.5869s
Epoch: 5 cost time: 18.398564338684082
Epoch: 5, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
Validation loss decreased (-0.978171 --> -0.981355).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0005109
	speed: 0.1616s/iter; left time: 6325.0996s
	iters: 200, epoch: 6 | loss: 0.0316731
	speed: 0.0469s/iter; left time: 1831.0306s
	iters: 300, epoch: 6 | loss: 0.0023288
	speed: 0.0458s/iter; left time: 1782.3995s
	iters: 400, epoch: 6 | loss: 0.0068232
	speed: 0.0447s/iter; left time: 1737.2424s
Epoch: 6 cost time: 19.139248371124268
Epoch: 6, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1024267
	speed: 0.1457s/iter; left time: 5643.2089s
	iters: 200, epoch: 7 | loss: 0.0004147
	speed: 0.0466s/iter; left time: 1800.2474s
	iters: 300, epoch: 7 | loss: 0.0007996
	speed: 0.0456s/iter; left time: 1755.6177s
	iters: 400, epoch: 7 | loss: 0.0009858
	speed: 0.0451s/iter; left time: 1732.3088s
Epoch: 7 cost time: 19.537978172302246
Epoch: 7, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0259476
	speed: 0.1532s/iter; left time: 5871.0051s
	iters: 200, epoch: 8 | loss: 0.0017652
	speed: 0.0449s/iter; left time: 1715.2056s
	iters: 300, epoch: 8 | loss: 0.0052827
	speed: 0.0438s/iter; left time: 1670.2891s
	iters: 400, epoch: 8 | loss: 0.1142701
	speed: 0.0467s/iter; left time: 1774.2179s
Epoch: 8 cost time: 19.08254885673523
Epoch: 8, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0007391
	speed: 0.1669s/iter; left time: 6326.7608s
	iters: 200, epoch: 9 | loss: 0.0044472
	speed: 0.0491s/iter; left time: 1855.7874s
	iters: 300, epoch: 9 | loss: 0.0000216
	speed: 0.0475s/iter; left time: 1789.6047s
	iters: 400, epoch: 9 | loss: 0.0000036
	speed: 0.0472s/iter; left time: 1776.4273s
Epoch: 9 cost time: 20.121660232543945
Epoch: 9, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0126374
	speed: 0.1779s/iter; left time: 6670.2116s
	iters: 200, epoch: 10 | loss: 0.0020260
	speed: 0.0445s/iter; left time: 1665.0230s
	iters: 300, epoch: 10 | loss: 0.0014820
	speed: 0.0453s/iter; left time: 1688.2077s
	iters: 400, epoch: 10 | loss: 0.0070624
	speed: 0.0448s/iter; left time: 1665.2617s
Epoch: 10 cost time: 19.279906511306763
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000071
	speed: 0.1489s/iter; left time: 5519.4115s
	iters: 200, epoch: 11 | loss: 0.0000252
	speed: 0.0459s/iter; left time: 1696.9546s
	iters: 300, epoch: 11 | loss: 0.0024177
	speed: 0.0442s/iter; left time: 1629.1096s
	iters: 400, epoch: 11 | loss: 0.0005953
	speed: 0.0445s/iter; left time: 1636.2060s
Epoch: 11 cost time: 18.933398246765137
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0001711
	speed: 0.1522s/iter; left time: 5579.1314s
	iters: 200, epoch: 12 | loss: 0.0066109
	speed: 0.0473s/iter; left time: 1728.9526s
	iters: 300, epoch: 12 | loss: 0.0009372
	speed: 0.0487s/iter; left time: 1775.3153s
	iters: 400, epoch: 12 | loss: 0.0000032
	speed: 0.0494s/iter; left time: 1794.9271s
Epoch: 12 cost time: 20.075221300125122
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000004
	speed: 0.1624s/iter; left time: 5887.6962s
	iters: 200, epoch: 13 | loss: 0.0001387
	speed: 0.0482s/iter; left time: 1740.4672s
	iters: 300, epoch: 13 | loss: 0.0033276
	speed: 0.0443s/iter; left time: 1595.5849s
	iters: 400, epoch: 13 | loss: 0.0044998
	speed: 0.0437s/iter; left time: 1570.7785s
Epoch: 13 cost time: 19.431297779083252
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1489s/iter; left time: 5336.9146s
	iters: 200, epoch: 14 | loss: 0.3368733
	speed: 0.0458s/iter; left time: 1637.1280s
	iters: 300, epoch: 14 | loss: 0.0372784
	speed: 0.0451s/iter; left time: 1608.6873s
	iters: 400, epoch: 14 | loss: 0.0000320
	speed: 0.0429s/iter; left time: 1524.6363s
Epoch: 14 cost time: 18.88880467414856
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0008490
	speed: 0.1517s/iter; left time: 5373.4643s
	iters: 200, epoch: 15 | loss: 0.0000100
	speed: 0.0440s/iter; left time: 1554.6768s
	iters: 300, epoch: 15 | loss: 0.0000012
	speed: 0.0451s/iter; left time: 1588.7052s
	iters: 400, epoch: 15 | loss: 0.0001331
	speed: 0.0511s/iter; left time: 1794.5565s
Epoch: 15 cost time: 19.47533631324768
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 148690
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8093634
	speed: 0.0704s/iter; left time: 2901.6779s
	iters: 200, epoch: 1 | loss: 0.2638166
	speed: 0.0476s/iter; left time: 1954.3841s
	iters: 300, epoch: 1 | loss: 0.1388524
	speed: 0.0434s/iter; left time: 1780.7600s
	iters: 400, epoch: 1 | loss: 0.0303078
	speed: 0.0443s/iter; left time: 1813.2114s
Epoch: 1 cost time: 21.213459730148315
Epoch: 1, Steps: 413 | Train Loss: 0.558 Vali Loss: 0.121 Vali Acc: 0.963 Test Loss: 0.121 Test Acc: 0.963
Validation loss decreased (inf --> -0.963164).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0780493
	speed: 0.1561s/iter; left time: 6368.2305s
	iters: 200, epoch: 2 | loss: 0.0071798
	speed: 0.0437s/iter; left time: 1778.8484s
	iters: 300, epoch: 2 | loss: 0.0632698
	speed: 0.0452s/iter; left time: 1835.4164s
	iters: 400, epoch: 2 | loss: 0.0158567
	speed: 0.0453s/iter; left time: 1835.8982s
Epoch: 2 cost time: 18.855225086212158
Epoch: 2, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
Validation loss decreased (-0.963164 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0089637
	speed: 0.1435s/iter; left time: 5792.2795s
	iters: 200, epoch: 3 | loss: 0.0009941
	speed: 0.0466s/iter; left time: 1875.0837s
	iters: 300, epoch: 3 | loss: 0.0118072
	speed: 0.0485s/iter; left time: 1946.9999s
	iters: 400, epoch: 3 | loss: 0.0622494
	speed: 0.0472s/iter; left time: 1893.1910s
Epoch: 3 cost time: 19.595542669296265
Epoch: 3, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.086 Vali Acc: 0.971 Test Loss: 0.086 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0182468
	speed: 0.1645s/iter; left time: 6574.4831s
	iters: 200, epoch: 4 | loss: 0.0013450
	speed: 0.0482s/iter; left time: 1919.8384s
	iters: 300, epoch: 4 | loss: 0.0153641
	speed: 0.0487s/iter; left time: 1937.8495s
	iters: 400, epoch: 4 | loss: 0.0088373
	speed: 0.0440s/iter; left time: 1746.8757s
Epoch: 4 cost time: 20.024149656295776
Epoch: 4, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.082 Vali Acc: 0.972 Test Loss: 0.082 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0012406
	speed: 0.1463s/iter; left time: 5786.9177s
	iters: 200, epoch: 5 | loss: 0.0537245
	speed: 0.0432s/iter; left time: 1702.5078s
	iters: 300, epoch: 5 | loss: 0.1005076
	speed: 0.0450s/iter; left time: 1768.9517s
	iters: 400, epoch: 5 | loss: 0.0228453
	speed: 0.0439s/iter; left time: 1724.7155s
Epoch: 5 cost time: 18.70846962928772
Epoch: 5, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.974078 --> -0.976352).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0004443
	speed: 0.1503s/iter; left time: 5880.2437s
	iters: 200, epoch: 6 | loss: 0.0076860
	speed: 0.0456s/iter; left time: 1779.0158s
	iters: 300, epoch: 6 | loss: 0.0064668
	speed: 0.0424s/iter; left time: 1652.6717s
	iters: 400, epoch: 6 | loss: 0.0001277
	speed: 0.0467s/iter; left time: 1812.4510s
Epoch: 6 cost time: 18.996204376220703
Epoch: 6, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0047509
	speed: 0.1677s/iter; left time: 6494.3931s
	iters: 200, epoch: 7 | loss: 0.0003892
	speed: 0.0502s/iter; left time: 1937.7018s
	iters: 300, epoch: 7 | loss: 0.0021350
	speed: 0.0489s/iter; left time: 1882.7212s
	iters: 400, epoch: 7 | loss: 0.0022428
	speed: 0.0478s/iter; left time: 1836.9304s
Epoch: 7 cost time: 20.211443185806274
Epoch: 7, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.976352 --> -0.979535).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0006026
	speed: 0.1589s/iter; left time: 6085.7131s
	iters: 200, epoch: 8 | loss: 0.0832418
	speed: 0.0444s/iter; left time: 1697.1096s
	iters: 300, epoch: 8 | loss: 0.0002566
	speed: 0.0436s/iter; left time: 1662.7371s
	iters: 400, epoch: 8 | loss: 0.0021707
	speed: 0.0437s/iter; left time: 1661.3873s
Epoch: 8 cost time: 18.705957889556885
Epoch: 8, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979535 --> -0.979535).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0136748
	speed: 0.1527s/iter; left time: 5787.7323s
	iters: 200, epoch: 9 | loss: 0.0019831
	speed: 0.0458s/iter; left time: 1731.8642s
	iters: 300, epoch: 9 | loss: 0.0001868
	speed: 0.0455s/iter; left time: 1716.8805s
	iters: 400, epoch: 9 | loss: 0.0000118
	speed: 0.0444s/iter; left time: 1669.0750s
Epoch: 9 cost time: 19.02289128303528
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0021435
	speed: 0.1575s/iter; left time: 5903.5831s
	iters: 200, epoch: 10 | loss: 0.0042143
	speed: 0.0494s/iter; left time: 1846.8292s
	iters: 300, epoch: 10 | loss: 0.0086278
	speed: 0.0465s/iter; left time: 1732.4310s
	iters: 400, epoch: 10 | loss: 0.0032147
	speed: 0.0482s/iter; left time: 1791.5103s
Epoch: 10 cost time: 20.43277907371521
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000188
	speed: 0.1687s/iter; left time: 6253.1980s
	iters: 200, epoch: 11 | loss: 0.0001065
	speed: 0.0445s/iter; left time: 1645.8212s
	iters: 300, epoch: 11 | loss: 0.0055321
	speed: 0.0436s/iter; left time: 1608.1505s
	iters: 400, epoch: 11 | loss: 0.0014761
	speed: 0.0452s/iter; left time: 1660.3967s
Epoch: 11 cost time: 18.771692037582397
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.050 Vali Acc: 0.985 Test Loss: 0.050 Test Acc: 0.985
Validation loss decreased (-0.979535 --> -0.984993).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000024
	speed: 0.1450s/iter; left time: 5316.2776s
	iters: 200, epoch: 12 | loss: 0.0003909
	speed: 0.0461s/iter; left time: 1684.4121s
	iters: 300, epoch: 12 | loss: 0.0033445
	speed: 0.0432s/iter; left time: 1573.7115s
	iters: 400, epoch: 12 | loss: 0.0027583
	speed: 0.0436s/iter; left time: 1584.7618s
Epoch: 12 cost time: 18.717727661132812
Epoch: 12, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000171
	speed: 0.1578s/iter; left time: 5717.8422s
	iters: 200, epoch: 13 | loss: 0.0001126
	speed: 0.0456s/iter; left time: 1647.7103s
	iters: 300, epoch: 13 | loss: 0.0015612
	speed: 0.0486s/iter; left time: 1750.7824s
	iters: 400, epoch: 13 | loss: 0.0002007
	speed: 0.0485s/iter; left time: 1743.8964s
Epoch: 13 cost time: 20.026989936828613
Epoch: 13, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000009
	speed: 0.1637s/iter; left time: 5866.3116s
	iters: 200, epoch: 14 | loss: 0.2455335
	speed: 0.0471s/iter; left time: 1682.1802s
	iters: 300, epoch: 14 | loss: 0.0001086
	speed: 0.0458s/iter; left time: 1633.1784s
	iters: 400, epoch: 14 | loss: 0.0000157
	speed: 0.0433s/iter; left time: 1538.8771s
Epoch: 14 cost time: 19.505829572677612
Epoch: 14, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000052
	speed: 0.1562s/iter; left time: 5530.7039s
	iters: 200, epoch: 15 | loss: 0.0003559
	speed: 0.0467s/iter; left time: 1650.1578s
	iters: 300, epoch: 15 | loss: 0.0000018
	speed: 0.0459s/iter; left time: 1616.1053s
	iters: 400, epoch: 15 | loss: 0.0020489
	speed: 0.0456s/iter; left time: 1600.0184s
Epoch: 15 cost time: 19.36016273498535
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000221
	speed: 0.1472s/iter; left time: 5151.3217s
	iters: 200, epoch: 16 | loss: 0.0017576
	speed: 0.0473s/iter; left time: 1650.8938s
	iters: 300, epoch: 16 | loss: 0.0000144
	speed: 0.0450s/iter; left time: 1567.3770s
	iters: 400, epoch: 16 | loss: 0.0008349
	speed: 0.0495s/iter; left time: 1718.8324s
Epoch: 16 cost time: 19.69036865234375
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000006
	speed: 0.1656s/iter; left time: 5728.4108s
	iters: 200, epoch: 17 | loss: 0.0000407
	speed: 0.0488s/iter; left time: 1684.1595s
	iters: 300, epoch: 17 | loss: 0.0002539
	speed: 0.0522s/iter; left time: 1795.2866s
	iters: 400, epoch: 17 | loss: 0.0000412
	speed: 0.0507s/iter; left time: 1737.8246s
Epoch: 17 cost time: 20.633116006851196
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0025768
	speed: 0.1599s/iter; left time: 5464.8667s
	iters: 200, epoch: 18 | loss: 0.0000134
	speed: 0.0442s/iter; left time: 1505.6490s
	iters: 300, epoch: 18 | loss: 0.0000029
	speed: 0.0434s/iter; left time: 1473.7062s
	iters: 400, epoch: 18 | loss: 0.0199354
	speed: 0.0437s/iter; left time: 1480.0328s
Epoch: 18 cost time: 18.884591341018677
Epoch: 18, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000016
	speed: 0.1464s/iter; left time: 4941.8530s
	iters: 200, epoch: 19 | loss: 0.0000086
	speed: 0.0442s/iter; left time: 1488.9291s
	iters: 300, epoch: 19 | loss: 0.0002926
	speed: 0.0453s/iter; left time: 1520.5525s
	iters: 400, epoch: 19 | loss: 0.0000038
	speed: 0.0460s/iter; left time: 1541.1491s
Epoch: 19 cost time: 18.892398595809937
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.982 Test Loss: 0.113 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0003022
	speed: 0.1627s/iter; left time: 5427.1367s
	iters: 200, epoch: 20 | loss: 0.0000045
	speed: 0.0488s/iter; left time: 1624.1928s
	iters: 300, epoch: 20 | loss: 0.0000001
	speed: 0.0457s/iter; left time: 1513.9051s
	iters: 400, epoch: 20 | loss: 0.0000005
	speed: 0.0484s/iter; left time: 1601.4281s
Epoch: 20 cost time: 20.183903217315674
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.984 Test Loss: 0.094 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0007656
	speed: 0.1719s/iter; left time: 5663.7638s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 1452.5771s
	iters: 300, epoch: 21 | loss: 0.0000032
	speed: 0.0456s/iter; left time: 1491.6960s
	iters: 400, epoch: 21 | loss: 0.0000009
	speed: 0.0464s/iter; left time: 1516.0207s
Epoch: 21 cost time: 19.234129190444946
Epoch: 21, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 148690
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8226926
	speed: 0.0612s/iter; left time: 2522.0301s
	iters: 200, epoch: 1 | loss: 0.2227806
	speed: 0.0443s/iter; left time: 1819.9247s
	iters: 300, epoch: 1 | loss: 0.1281555
	speed: 0.0455s/iter; left time: 1864.0974s
	iters: 400, epoch: 1 | loss: 0.0441468
	speed: 0.0431s/iter; left time: 1762.6445s
Epoch: 1 cost time: 20.058135509490967
Epoch: 1, Steps: 413 | Train Loss: 0.571 Vali Loss: 0.125 Vali Acc: 0.961 Test Loss: 0.125 Test Acc: 0.961
Validation loss decreased (inf --> -0.961345).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0565675
	speed: 0.1721s/iter; left time: 7019.7863s
	iters: 200, epoch: 2 | loss: 0.0075007
	speed: 0.0477s/iter; left time: 1941.4906s
	iters: 300, epoch: 2 | loss: 0.0796373
	speed: 0.0464s/iter; left time: 1882.7688s
	iters: 400, epoch: 2 | loss: 0.0333468
	speed: 0.0494s/iter; left time: 1998.2487s
Epoch: 2 cost time: 20.391508102416992
Epoch: 2, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
Validation loss decreased (-0.961345 --> -0.974988).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0345717
	speed: 0.1691s/iter; left time: 6826.3880s
	iters: 200, epoch: 3 | loss: 0.0006045
	speed: 0.0471s/iter; left time: 1896.8134s
	iters: 300, epoch: 3 | loss: 0.0254856
	speed: 0.0442s/iter; left time: 1777.5060s
	iters: 400, epoch: 3 | loss: 0.1116983
	speed: 0.0430s/iter; left time: 1725.0348s
Epoch: 3 cost time: 18.71358346939087
Epoch: 3, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0085238
	speed: 0.1382s/iter; left time: 5522.3088s
	iters: 200, epoch: 4 | loss: 0.0011877
	speed: 0.0449s/iter; left time: 1791.5752s
	iters: 300, epoch: 4 | loss: 0.0109414
	speed: 0.0421s/iter; left time: 1673.8435s
	iters: 400, epoch: 4 | loss: 0.0036775
	speed: 0.0449s/iter; left time: 1779.3193s
Epoch: 4 cost time: 18.322266340255737
Epoch: 4, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
Validation loss decreased (-0.974988 --> -0.977716).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0022430
	speed: 0.1486s/iter; left time: 5878.8357s
	iters: 200, epoch: 5 | loss: 0.2571719
	speed: 0.0470s/iter; left time: 1853.2943s
	iters: 300, epoch: 5 | loss: 0.0285980
	speed: 0.0470s/iter; left time: 1847.9990s
	iters: 400, epoch: 5 | loss: 0.0062516
	speed: 0.0457s/iter; left time: 1794.8586s
Epoch: 5 cost time: 19.544363737106323
Epoch: 5, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0013979
	speed: 0.1631s/iter; left time: 6384.7581s
	iters: 200, epoch: 6 | loss: 0.0119189
	speed: 0.0454s/iter; left time: 1771.8350s
	iters: 300, epoch: 6 | loss: 0.0024167
	speed: 0.0427s/iter; left time: 1661.3321s
	iters: 400, epoch: 6 | loss: 0.0030483
	speed: 0.0457s/iter; left time: 1774.1690s
Epoch: 6 cost time: 19.104048252105713
Epoch: 6, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.980445).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0028027
	speed: 0.1496s/iter; left time: 5791.4611s
	iters: 200, epoch: 7 | loss: 0.0001611
	speed: 0.0440s/iter; left time: 1699.5642s
	iters: 300, epoch: 7 | loss: 0.0052102
	speed: 0.0445s/iter; left time: 1715.4554s
	iters: 400, epoch: 7 | loss: 0.0011416
	speed: 0.0438s/iter; left time: 1682.9798s
Epoch: 7 cost time: 18.718527793884277
Epoch: 7, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0015965
	speed: 0.1465s/iter; left time: 5610.9904s
	iters: 200, epoch: 8 | loss: 0.0974022
	speed: 0.0440s/iter; left time: 1680.4067s
	iters: 300, epoch: 8 | loss: 0.0010680
	speed: 0.0453s/iter; left time: 1726.8782s
	iters: 400, epoch: 8 | loss: 0.0002099
	speed: 0.0474s/iter; left time: 1800.8679s
Epoch: 8 cost time: 19.153497457504272
Epoch: 8, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0018751
	speed: 0.1688s/iter; left time: 6398.2631s
	iters: 200, epoch: 9 | loss: 0.0020956
	speed: 0.0496s/iter; left time: 1875.5659s
	iters: 300, epoch: 9 | loss: 0.0000386
	speed: 0.0502s/iter; left time: 1892.3586s
	iters: 400, epoch: 9 | loss: 0.1312110
	speed: 0.0480s/iter; left time: 1805.5340s
Epoch: 9 cost time: 20.278305053710938
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000899
	speed: 0.1597s/iter; left time: 5987.5201s
	iters: 200, epoch: 10 | loss: 0.0001425
	speed: 0.0448s/iter; left time: 1675.6807s
	iters: 300, epoch: 10 | loss: 0.0070690
	speed: 0.0432s/iter; left time: 1611.6426s
	iters: 400, epoch: 10 | loss: 0.0014690
	speed: 0.0446s/iter; left time: 1657.2145s
Epoch: 10 cost time: 18.67799663543701
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000041
	speed: 0.1545s/iter; left time: 5726.6658s
	iters: 200, epoch: 11 | loss: 0.0000243
	speed: 0.0465s/iter; left time: 1718.2628s
	iters: 300, epoch: 11 | loss: 0.0122013
	speed: 0.0453s/iter; left time: 1669.8397s
	iters: 400, epoch: 11 | loss: 0.0000341
	speed: 0.0429s/iter; left time: 1578.3625s
Epoch: 11 cost time: 18.827730894088745
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.980445 --> -0.980445).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000077
	speed: 0.1724s/iter; left time: 6319.5860s
	iters: 200, epoch: 12 | loss: 0.0002464
	speed: 0.0457s/iter; left time: 1670.2456s
	iters: 300, epoch: 12 | loss: 0.0000392
	speed: 0.0454s/iter; left time: 1656.9579s
	iters: 400, epoch: 12 | loss: 0.0003290
	speed: 0.0476s/iter; left time: 1731.2072s
Epoch: 12 cost time: 19.796145915985107
Epoch: 12, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
Validation loss decreased (-0.980445 --> -0.986357).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000226
	speed: 0.1636s/iter; left time: 5931.1010s
	iters: 200, epoch: 13 | loss: 0.0000814
	speed: 0.0450s/iter; left time: 1628.2099s
	iters: 300, epoch: 13 | loss: 0.0354695
	speed: 0.0442s/iter; left time: 1592.9507s
	iters: 400, epoch: 13 | loss: 0.0037506
	speed: 0.0442s/iter; left time: 1588.5184s
Epoch: 13 cost time: 18.656748294830322
Epoch: 13, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000137
	speed: 0.1523s/iter; left time: 5456.9360s
	iters: 200, epoch: 14 | loss: 0.0319210
	speed: 0.0441s/iter; left time: 1577.4190s
	iters: 300, epoch: 14 | loss: 0.0006937
	speed: 0.0426s/iter; left time: 1517.0022s
	iters: 400, epoch: 14 | loss: 0.0000268
	speed: 0.0422s/iter; left time: 1500.8482s
Epoch: 14 cost time: 18.181294918060303
Epoch: 14, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0078924
	speed: 0.1404s/iter; left time: 4971.1246s
	iters: 200, epoch: 15 | loss: 0.0000871
	speed: 0.0452s/iter; left time: 1594.7901s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1616.3266s
	iters: 400, epoch: 15 | loss: 0.0013084
	speed: 0.0455s/iter; left time: 1598.2367s
Epoch: 15 cost time: 18.871171951293945
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0001740
	speed: 0.1599s/iter; left time: 5598.2652s
	iters: 200, epoch: 16 | loss: 0.0001058
	speed: 0.0474s/iter; left time: 1655.0228s
	iters: 300, epoch: 16 | loss: 0.0002088
	speed: 0.0451s/iter; left time: 1568.0206s
	iters: 400, epoch: 16 | loss: 0.0009207
	speed: 0.0419s/iter; left time: 1454.9813s
Epoch: 16 cost time: 19.07708716392517
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000006
	speed: 0.1476s/iter; left time: 5107.0644s
	iters: 200, epoch: 17 | loss: 0.0321797
	speed: 0.0416s/iter; left time: 1435.6042s
	iters: 300, epoch: 17 | loss: 0.0013367
	speed: 0.0398s/iter; left time: 1368.8171s
	iters: 400, epoch: 17 | loss: 0.0000003
	speed: 0.0363s/iter; left time: 1243.8834s
Epoch: 17 cost time: 16.478652954101562
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0571394
	speed: 0.1497s/iter; left time: 5117.3248s
	iters: 200, epoch: 18 | loss: 0.0000022
	speed: 0.0446s/iter; left time: 1518.8917s
	iters: 300, epoch: 18 | loss: 0.0000166
	speed: 0.0450s/iter; left time: 1529.8687s
	iters: 400, epoch: 18 | loss: 0.0000051
	speed: 0.0457s/iter; left time: 1548.7064s
Epoch: 18 cost time: 18.76016592979431
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.054 Vali Acc: 0.986 Test Loss: 0.054 Test Acc: 0.986
Validation loss decreased (-0.986357 --> -0.986357).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.1500s/iter; left time: 5066.1491s
	iters: 200, epoch: 19 | loss: 0.0194231
	speed: 0.0430s/iter; left time: 1447.0567s
	iters: 300, epoch: 19 | loss: 0.0000337
	speed: 0.0431s/iter; left time: 1446.9604s
	iters: 400, epoch: 19 | loss: 0.0008732
	speed: 0.0439s/iter; left time: 1468.5399s
Epoch: 19 cost time: 18.368404626846313
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0341344
	speed: 0.1657s/iter; left time: 5526.7676s
	iters: 200, epoch: 20 | loss: 0.0000320
	speed: 0.0500s/iter; left time: 1663.8344s
	iters: 300, epoch: 20 | loss: 0.0000327
	speed: 0.0474s/iter; left time: 1571.7627s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0467s/iter; left time: 1542.6563s
Epoch: 20 cost time: 20.12293267250061
Epoch: 20, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.068 Vali Acc: 0.986 Test Loss: 0.068 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000068
	speed: 0.1646s/iter; left time: 5422.8825s
	iters: 200, epoch: 21 | loss: 0.3506144
	speed: 0.0428s/iter; left time: 1405.0062s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 1374.8221s
	iters: 400, epoch: 21 | loss: 0.0000015
	speed: 0.0449s/iter; left time: 1467.0383s
Epoch: 21 cost time: 18.362581729888916
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000326
	speed: 0.1469s/iter; left time: 4778.9857s
	iters: 200, epoch: 22 | loss: 0.0000002
	speed: 0.0449s/iter; left time: 1456.0792s
	iters: 300, epoch: 22 | loss: 0.0024675
	speed: 0.0452s/iter; left time: 1461.9220s
	iters: 400, epoch: 22 | loss: 0.0000004
	speed: 0.0423s/iter; left time: 1362.0811s
Epoch: 22 cost time: 18.497284412384033
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000190
	speed: 0.1485s/iter; left time: 4768.4837s
	iters: 200, epoch: 23 | loss: 0.0000007
	speed: 0.0468s/iter; left time: 1498.1190s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.0468s/iter; left time: 1492.0682s
	iters: 400, epoch: 23 | loss: 0.0000282
	speed: 0.0469s/iter; left time: 1491.6761s
Epoch: 23 cost time: 19.87387204170227
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.4407664
	speed: 0.1724s/iter; left time: 5466.5339s
	iters: 200, epoch: 24 | loss: 0.0000707
	speed: 0.0517s/iter; left time: 1635.3828s
	iters: 300, epoch: 24 | loss: 0.0000002
	speed: 0.0449s/iter; left time: 1414.4101s
	iters: 400, epoch: 24 | loss: 0.0000032
	speed: 0.0443s/iter; left time: 1392.3719s
Epoch: 24 cost time: 19.816752910614014
Epoch: 24, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0014800
	speed: 0.1494s/iter; left time: 4675.0805s
	iters: 200, epoch: 25 | loss: 0.0000055
	speed: 0.0442s/iter; left time: 1378.4187s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1393.7861s
	iters: 400, epoch: 25 | loss: 0.0000002
	speed: 0.0458s/iter; left time: 1418.6244s
Epoch: 25 cost time: 18.96520972251892
Epoch: 25, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000278
	speed: 0.1539s/iter; left time: 4750.3169s
	iters: 200, epoch: 26 | loss: 0.0009466
	speed: 0.0447s/iter; left time: 1374.9122s
	iters: 300, epoch: 26 | loss: 0.2402341
	speed: 0.0481s/iter; left time: 1476.4570s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 1409.1848s
Epoch: 26 cost time: 19.27935767173767
Epoch: 26, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.980 Test Loss: 0.169 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000148
	speed: 0.1603s/iter; left time: 4883.2126s
	iters: 200, epoch: 27 | loss: 0.0000003
	speed: 0.0434s/iter; left time: 1318.4352s
	iters: 300, epoch: 27 | loss: 0.0000020
	speed: 0.0450s/iter; left time: 1360.4365s
	iters: 400, epoch: 27 | loss: 0.0000270
	speed: 0.0441s/iter; left time: 1330.5785s
Epoch: 27 cost time: 19.02726936340332
Epoch: 27, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000001
	speed: 0.1546s/iter; left time: 4647.0980s
	iters: 200, epoch: 28 | loss: 0.0000008
	speed: 0.0416s/iter; left time: 1244.6046s
	iters: 300, epoch: 28 | loss: 0.0000102
	speed: 0.0437s/iter; left time: 1304.0950s
	iters: 400, epoch: 28 | loss: 0.0000045
	speed: 0.0442s/iter; left time: 1314.0070s
Epoch: 28 cost time: 18.247479915618896
Epoch: 28, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 148690
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0292088
	speed: 0.0654s/iter; left time: 2694.5646s
	iters: 200, epoch: 1 | loss: 0.2390227
	speed: 0.0473s/iter; left time: 1943.5204s
	iters: 300, epoch: 1 | loss: 0.2317451
	speed: 0.0502s/iter; left time: 2058.3421s
	iters: 400, epoch: 1 | loss: 0.0763137
	speed: 0.0465s/iter; left time: 1903.6276s
Epoch: 1 cost time: 21.652073621749878
Epoch: 1, Steps: 413 | Train Loss: 0.650 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
Validation loss decreased (inf --> -0.958616).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1413486
	speed: 0.1777s/iter; left time: 7249.7125s
	iters: 200, epoch: 2 | loss: 0.0130565
	speed: 0.0482s/iter; left time: 1959.7479s
	iters: 300, epoch: 2 | loss: 0.1226163
	speed: 0.0442s/iter; left time: 1795.4629s
	iters: 400, epoch: 2 | loss: 0.0984251
	speed: 0.0456s/iter; left time: 1846.1901s
Epoch: 2 cost time: 19.70653247833252
Epoch: 2, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.958616 --> -0.972714).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0096853
	speed: 0.1514s/iter; left time: 6114.2323s
	iters: 200, epoch: 3 | loss: 0.0008101
	speed: 0.0458s/iter; left time: 1843.1795s
	iters: 300, epoch: 3 | loss: 0.0108150
	speed: 0.0459s/iter; left time: 1844.7158s
	iters: 400, epoch: 3 | loss: 0.0903408
	speed: 0.0437s/iter; left time: 1749.9058s
Epoch: 3 cost time: 18.96702527999878
Epoch: 3, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.092 Vali Acc: 0.967 Test Loss: 0.092 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0063700
	speed: 0.1444s/iter; left time: 5771.3442s
	iters: 200, epoch: 4 | loss: 0.0006735
	speed: 0.0428s/iter; left time: 1707.4970s
	iters: 300, epoch: 4 | loss: 0.0075414
	speed: 0.0459s/iter; left time: 1826.9418s
	iters: 400, epoch: 4 | loss: 0.0302762
	speed: 0.0456s/iter; left time: 1807.0374s
Epoch: 4 cost time: 18.85013484954834
Epoch: 4, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.064 Vali Acc: 0.978 Test Loss: 0.064 Test Acc: 0.978
Validation loss decreased (-0.972714 --> -0.978171).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0034741
	speed: 0.1653s/iter; left time: 6536.0102s
	iters: 200, epoch: 5 | loss: 0.3765023
	speed: 0.0470s/iter; left time: 1855.4012s
	iters: 300, epoch: 5 | loss: 0.0004788
	speed: 0.0476s/iter; left time: 1871.9604s
	iters: 400, epoch: 5 | loss: 0.0091772
	speed: 0.0477s/iter; left time: 1871.6170s
Epoch: 5 cost time: 19.843510627746582
Epoch: 5, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.051 Vali Acc: 0.986 Test Loss: 0.051 Test Acc: 0.986
Validation loss decreased (-0.978171 --> -0.986357).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0018708
	speed: 0.1390s/iter; left time: 5440.6030s
	iters: 200, epoch: 6 | loss: 0.0014340
	speed: 0.0416s/iter; left time: 1623.3892s
	iters: 300, epoch: 6 | loss: 0.0077352
	speed: 0.0434s/iter; left time: 1690.4290s
	iters: 400, epoch: 6 | loss: 0.0247493
	speed: 0.0432s/iter; left time: 1676.4493s
Epoch: 6 cost time: 18.10800337791443
Epoch: 6, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0090822
	speed: 0.1498s/iter; left time: 5801.0046s
	iters: 200, epoch: 7 | loss: 0.0052192
	speed: 0.0438s/iter; left time: 1690.1028s
	iters: 300, epoch: 7 | loss: 0.0187010
	speed: 0.0461s/iter; left time: 1776.5930s
	iters: 400, epoch: 7 | loss: 0.0334079
	speed: 0.0456s/iter; left time: 1752.2953s
Epoch: 7 cost time: 18.84654402732849
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0374287
	speed: 0.1731s/iter; left time: 6631.9903s
	iters: 200, epoch: 8 | loss: 0.0001427
	speed: 0.0468s/iter; left time: 1787.8712s
	iters: 300, epoch: 8 | loss: 0.0001171
	speed: 0.0492s/iter; left time: 1875.2956s
	iters: 400, epoch: 8 | loss: 0.0007578
	speed: 0.0476s/iter; left time: 1808.3032s
Epoch: 8 cost time: 20.243923902511597
Epoch: 8, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0396944
	speed: 0.1674s/iter; left time: 6345.8308s
	iters: 200, epoch: 9 | loss: 0.0612169
	speed: 0.0436s/iter; left time: 1646.1481s
	iters: 300, epoch: 9 | loss: 0.0022944
	speed: 0.0451s/iter; left time: 1700.1746s
	iters: 400, epoch: 9 | loss: 0.0001686
	speed: 0.0444s/iter; left time: 1669.9394s
Epoch: 9 cost time: 18.731416702270508
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0013252
	speed: 0.1431s/iter; left time: 5362.1684s
	iters: 200, epoch: 10 | loss: 0.0037515
	speed: 0.0452s/iter; left time: 1690.3839s
	iters: 300, epoch: 10 | loss: 0.0023344
	speed: 0.0429s/iter; left time: 1598.9365s
	iters: 400, epoch: 10 | loss: 0.1335053
	speed: 0.0425s/iter; left time: 1579.1686s
Epoch: 10 cost time: 18.408780097961426
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0001840
	speed: 0.1511s/iter; left time: 5603.1541s
	iters: 200, epoch: 11 | loss: 0.0305608
	speed: 0.0452s/iter; left time: 1670.4861s
	iters: 300, epoch: 11 | loss: 0.0029045
	speed: 0.0456s/iter; left time: 1680.0783s
	iters: 400, epoch: 11 | loss: 0.0000067
	speed: 0.0481s/iter; left time: 1767.2285s
Epoch: 11 cost time: 19.649236917495728
Epoch: 11, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0016225
	speed: 0.1644s/iter; left time: 6025.9490s
	iters: 200, epoch: 12 | loss: 0.0008374
	speed: 0.0475s/iter; left time: 1738.2190s
	iters: 300, epoch: 12 | loss: 0.0006279
	speed: 0.0437s/iter; left time: 1591.5323s
	iters: 400, epoch: 12 | loss: 0.0027342
	speed: 0.0424s/iter; left time: 1540.2568s
Epoch: 12 cost time: 18.712695598602295
Epoch: 12, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000544
	speed: 0.1479s/iter; left time: 5362.3553s
	iters: 200, epoch: 13 | loss: 0.0000106
	speed: 0.0426s/iter; left time: 1541.4632s
	iters: 300, epoch: 13 | loss: 0.0000441
	speed: 0.0433s/iter; left time: 1559.5250s
	iters: 400, epoch: 13 | loss: 0.0000007
	speed: 0.0427s/iter; left time: 1534.2869s
Epoch: 13 cost time: 18.56795048713684
Epoch: 13, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000005
	speed: 0.1539s/iter; left time: 5516.2705s
	iters: 200, epoch: 14 | loss: 0.0092519
	speed: 0.0427s/iter; left time: 1525.2405s
	iters: 300, epoch: 14 | loss: 0.0000125
	speed: 0.0498s/iter; left time: 1776.0298s
	iters: 400, epoch: 14 | loss: 0.0023115
	speed: 0.0493s/iter; left time: 1752.5508s
Epoch: 14 cost time: 19.591810703277588
Epoch: 14, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.4894709
	speed: 0.1668s/iter; left time: 5908.7077s
	iters: 200, epoch: 15 | loss: 0.2049566
	speed: 0.0499s/iter; left time: 1762.7932s
	iters: 300, epoch: 15 | loss: 0.0017647
	speed: 0.0478s/iter; left time: 1682.2235s
	iters: 400, epoch: 15 | loss: 0.0014061
	speed: 0.0458s/iter; left time: 1607.9722s
Epoch: 15 cost time: 20.44399929046631
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 148690
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5717351
	speed: 0.0614s/iter; left time: 2528.3055s
	iters: 200, epoch: 1 | loss: 0.3032210
	speed: 0.0445s/iter; left time: 1827.9558s
	iters: 300, epoch: 1 | loss: 0.4110061
	speed: 0.0450s/iter; left time: 1845.4257s
	iters: 400, epoch: 1 | loss: 0.0424767
	speed: 0.0455s/iter; left time: 1859.0806s
Epoch: 1 cost time: 20.322514533996582
Epoch: 1, Steps: 413 | Train Loss: 0.539 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
Validation loss decreased (inf --> -0.966347).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0445111
	speed: 0.1441s/iter; left time: 5878.7295s
	iters: 200, epoch: 2 | loss: 0.0642009
	speed: 0.0482s/iter; left time: 1960.0964s
	iters: 300, epoch: 2 | loss: 0.0262512
	speed: 0.0473s/iter; left time: 1919.7770s
	iters: 400, epoch: 2 | loss: 0.0346064
	speed: 0.0467s/iter; left time: 1890.7945s
Epoch: 2 cost time: 19.704179048538208
Epoch: 2, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
Validation loss decreased (-0.966347 --> -0.969986).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0202950
	speed: 0.1670s/iter; left time: 6741.2072s
	iters: 200, epoch: 3 | loss: 0.0202428
	speed: 0.0474s/iter; left time: 1910.8231s
	iters: 300, epoch: 3 | loss: 0.0320938
	speed: 0.0504s/iter; left time: 2024.4502s
	iters: 400, epoch: 3 | loss: 0.1333384
	speed: 0.0459s/iter; left time: 1838.0549s
Epoch: 3 cost time: 20.054333448410034
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.969986 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0024469
	speed: 0.1552s/iter; left time: 6202.2996s
	iters: 200, epoch: 4 | loss: 0.0049714
	speed: 0.0468s/iter; left time: 1863.9766s
	iters: 300, epoch: 4 | loss: 0.0744030
	speed: 0.0456s/iter; left time: 1811.2850s
	iters: 400, epoch: 4 | loss: 0.0177315
	speed: 0.0444s/iter; left time: 1762.3093s
Epoch: 4 cost time: 19.245240449905396
Epoch: 4, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.974533).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0013692
	speed: 0.1558s/iter; left time: 6163.6429s
	iters: 200, epoch: 5 | loss: 0.0005258
	speed: 0.0448s/iter; left time: 1768.8020s
	iters: 300, epoch: 5 | loss: 0.0209038
	speed: 0.0476s/iter; left time: 1871.3254s
	iters: 400, epoch: 5 | loss: 0.0020625
	speed: 0.0513s/iter; left time: 2014.5463s
Epoch: 5 cost time: 20.052255153656006
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.974533 --> -0.978171).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0020636
	speed: 0.1622s/iter; left time: 6347.8404s
	iters: 200, epoch: 6 | loss: 0.0096637
	speed: 0.0488s/iter; left time: 1905.5578s
	iters: 300, epoch: 6 | loss: 0.0142592
	speed: 0.0469s/iter; left time: 1824.4376s
	iters: 400, epoch: 6 | loss: 0.0013128
	speed: 0.0463s/iter; left time: 1799.5230s
Epoch: 6 cost time: 19.791563749313354
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0226498
	speed: 0.1400s/iter; left time: 5420.1065s
	iters: 200, epoch: 7 | loss: 0.0334096
	speed: 0.0449s/iter; left time: 1735.0576s
	iters: 300, epoch: 7 | loss: 0.0028122
	speed: 0.0449s/iter; left time: 1730.6468s
	iters: 400, epoch: 7 | loss: 0.0066012
	speed: 0.0445s/iter; left time: 1710.7259s
Epoch: 7 cost time: 18.762911319732666
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
Validation loss decreased (-0.978171 --> -0.982719).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0659468
	speed: 0.1431s/iter; left time: 5483.6870s
	iters: 200, epoch: 8 | loss: 0.0010881
	speed: 0.0425s/iter; left time: 1623.9567s
	iters: 300, epoch: 8 | loss: 0.0000202
	speed: 0.0433s/iter; left time: 1650.7644s
	iters: 400, epoch: 8 | loss: 0.0000919
	speed: 0.0441s/iter; left time: 1674.3887s
Epoch: 8 cost time: 18.24439573287964
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0165479
	speed: 0.1622s/iter; left time: 6146.7019s
	iters: 200, epoch: 9 | loss: 0.0000966
	speed: 0.0489s/iter; left time: 1849.7246s
	iters: 300, epoch: 9 | loss: 0.0000285
	speed: 0.0475s/iter; left time: 1789.4477s
	iters: 400, epoch: 9 | loss: 0.0000289
	speed: 0.0483s/iter; left time: 1816.0330s
Epoch: 9 cost time: 20.25718402862549
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0411188
	speed: 0.1738s/iter; left time: 6513.5978s
	iters: 200, epoch: 10 | loss: 0.0007871
	speed: 0.0447s/iter; left time: 1670.1723s
	iters: 300, epoch: 10 | loss: 0.0025265
	speed: 0.0469s/iter; left time: 1749.6820s
	iters: 400, epoch: 10 | loss: 0.0001199
	speed: 0.0450s/iter; left time: 1672.6397s
Epoch: 10 cost time: 19.21197271347046
Epoch: 10, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0004596
	speed: 0.1527s/iter; left time: 5659.2061s
	iters: 200, epoch: 11 | loss: 0.0001413
	speed: 0.0458s/iter; left time: 1693.0939s
	iters: 300, epoch: 11 | loss: 0.1795273
	speed: 0.0467s/iter; left time: 1720.2893s
	iters: 400, epoch: 11 | loss: 0.0002068
	speed: 0.0429s/iter; left time: 1575.6968s
Epoch: 11 cost time: 18.96245503425598
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000097
	speed: 0.1418s/iter; left time: 5196.8489s
	iters: 200, epoch: 12 | loss: 0.0010281
	speed: 0.0464s/iter; left time: 1696.9123s
	iters: 300, epoch: 12 | loss: 0.0000086
	speed: 0.0490s/iter; left time: 1785.8829s
	iters: 400, epoch: 12 | loss: 0.0000007
	speed: 0.0473s/iter; left time: 1719.3120s
Epoch: 12 cost time: 19.834392547607422
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0010889
	speed: 0.1583s/iter; left time: 5739.0009s
	iters: 200, epoch: 13 | loss: 0.0000016
	speed: 0.0438s/iter; left time: 1582.5481s
	iters: 300, epoch: 13 | loss: 0.0000022
	speed: 0.0450s/iter; left time: 1622.2967s
	iters: 400, epoch: 13 | loss: 0.3214473
	speed: 0.0439s/iter; left time: 1577.9128s
Epoch: 13 cost time: 18.95023465156555
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000493
	speed: 0.1424s/iter; left time: 5101.2773s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0430s/iter; left time: 1537.7976s
	iters: 300, epoch: 14 | loss: 0.0036819
	speed: 0.0446s/iter; left time: 1589.9518s
	iters: 400, epoch: 14 | loss: 0.0002809
	speed: 0.0439s/iter; left time: 1560.6404s
Epoch: 14 cost time: 18.513954162597656
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000006
	speed: 0.1482s/iter; left time: 5250.1689s
	iters: 200, epoch: 15 | loss: 0.0000111
	speed: 0.0505s/iter; left time: 1783.7079s
	iters: 300, epoch: 15 | loss: 0.0007772
	speed: 0.0486s/iter; left time: 1712.0526s
	iters: 400, epoch: 15 | loss: 0.4629804
	speed: 0.0509s/iter; left time: 1787.1743s
Epoch: 15 cost time: 20.38320016860962
Epoch: 15, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000016
	speed: 0.1703s/iter; left time: 5961.1804s
	iters: 200, epoch: 16 | loss: 0.0000700
	speed: 0.0511s/iter; left time: 1782.6444s
	iters: 300, epoch: 16 | loss: 0.0000705
	speed: 0.0477s/iter; left time: 1660.7503s
	iters: 400, epoch: 16 | loss: 0.0018715
	speed: 0.0478s/iter; left time: 1658.7286s
Epoch: 16 cost time: 20.530709266662598
Epoch: 16, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000111
	speed: 0.1611s/iter; left time: 5574.4707s
	iters: 200, epoch: 17 | loss: 0.0010171
	speed: 0.0455s/iter; left time: 1570.7853s
	iters: 300, epoch: 17 | loss: 0.0000399
	speed: 0.0460s/iter; left time: 1581.7959s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0462s/iter; left time: 1583.8543s
Epoch: 17 cost time: 19.21798276901245
Epoch: 17, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 115922
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5790557
	speed: 0.0658s/iter; left time: 2711.0663s
	iters: 200, epoch: 1 | loss: 0.3146634
	speed: 0.0463s/iter; left time: 1902.0312s
	iters: 300, epoch: 1 | loss: 0.4096025
	speed: 0.0462s/iter; left time: 1892.5754s
	iters: 400, epoch: 1 | loss: 0.0353665
	speed: 0.0461s/iter; left time: 1885.3397s
Epoch: 1 cost time: 21.14828634262085
Epoch: 1, Steps: 413 | Train Loss: 0.540 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
Validation loss decreased (inf --> -0.963619).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0410326
	speed: 0.1668s/iter; left time: 6803.7809s
	iters: 200, epoch: 2 | loss: 0.1150780
	speed: 0.0433s/iter; left time: 1763.1741s
	iters: 300, epoch: 2 | loss: 0.0186984
	speed: 0.0452s/iter; left time: 1832.5536s
	iters: 400, epoch: 2 | loss: 0.0503014
	speed: 0.0459s/iter; left time: 1857.6567s
Epoch: 2 cost time: 19.11286735534668
Epoch: 2, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.073 Vali Acc: 0.971 Test Loss: 0.073 Test Acc: 0.971
Validation loss decreased (-0.963619 --> -0.971350).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0124960
	speed: 0.1423s/iter; left time: 5746.9512s
	iters: 200, epoch: 3 | loss: 0.0236210
	speed: 0.0445s/iter; left time: 1793.2515s
	iters: 300, epoch: 3 | loss: 0.0177645
	speed: 0.0423s/iter; left time: 1697.7510s
	iters: 400, epoch: 3 | loss: 0.1670888
	speed: 0.0430s/iter; left time: 1723.4584s
Epoch: 3 cost time: 18.40143609046936
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0039310
	speed: 0.1520s/iter; left time: 6073.4125s
	iters: 200, epoch: 4 | loss: 0.0470598
	speed: 0.0477s/iter; left time: 1903.2515s
	iters: 300, epoch: 4 | loss: 0.1626760
	speed: 0.0483s/iter; left time: 1921.8682s
	iters: 400, epoch: 4 | loss: 0.0430810
	speed: 0.0497s/iter; left time: 1972.8518s
Epoch: 4 cost time: 20.311200380325317
Epoch: 4, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
Validation loss decreased (-0.971350 --> -0.972714).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0004361
	speed: 0.1723s/iter; left time: 6815.9807s
	iters: 200, epoch: 5 | loss: 0.0000502
	speed: 0.0500s/iter; left time: 1970.4850s
	iters: 300, epoch: 5 | loss: 0.0022423
	speed: 0.0482s/iter; left time: 1897.4807s
	iters: 400, epoch: 5 | loss: 0.0012266
	speed: 0.0440s/iter; left time: 1725.7070s
Epoch: 5 cost time: 20.051058292388916
Epoch: 5, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
Validation loss decreased (-0.972714 --> -0.976807).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0018412
	speed: 0.1578s/iter; left time: 6175.9110s
	iters: 200, epoch: 6 | loss: 0.0028166
	speed: 0.0438s/iter; left time: 1708.1478s
	iters: 300, epoch: 6 | loss: 0.0010669
	speed: 0.0441s/iter; left time: 1718.4374s
	iters: 400, epoch: 6 | loss: 0.0059320
	speed: 0.0441s/iter; left time: 1713.3011s
Epoch: 6 cost time: 18.67855978012085
Epoch: 6, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0021379
	speed: 0.1460s/iter; left time: 5652.5837s
	iters: 200, epoch: 7 | loss: 0.0018389
	speed: 0.0459s/iter; left time: 1771.1812s
	iters: 300, epoch: 7 | loss: 0.0129092
	speed: 0.0433s/iter; left time: 1668.4527s
	iters: 400, epoch: 7 | loss: 0.0051708
	speed: 0.0458s/iter; left time: 1760.8007s
Epoch: 7 cost time: 19.011312246322632
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976807 --> -0.977262).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0139891
	speed: 0.1656s/iter; left time: 6344.8582s
	iters: 200, epoch: 8 | loss: 0.0094371
	speed: 0.0472s/iter; left time: 1804.7155s
	iters: 300, epoch: 8 | loss: 0.0002375
	speed: 0.0490s/iter; left time: 1868.0684s
	iters: 400, epoch: 8 | loss: 0.0706198
	speed: 0.0480s/iter; left time: 1826.2340s
Epoch: 8 cost time: 20.128931283950806
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0031654
	speed: 0.1539s/iter; left time: 5831.9822s
	iters: 200, epoch: 9 | loss: 0.0001742
	speed: 0.0476s/iter; left time: 1800.0390s
	iters: 300, epoch: 9 | loss: 0.0000036
	speed: 0.0452s/iter; left time: 1704.1440s
	iters: 400, epoch: 9 | loss: 0.0088687
	speed: 0.0414s/iter; left time: 1557.3563s
Epoch: 9 cost time: 19.06314754486084
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
Validation loss decreased (-0.977262 --> -0.978626).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001335
	speed: 0.1427s/iter; left time: 5349.0117s
	iters: 200, epoch: 10 | loss: 0.0002038
	speed: 0.0434s/iter; left time: 1623.7354s
	iters: 300, epoch: 10 | loss: 0.0014327
	speed: 0.0439s/iter; left time: 1635.2048s
	iters: 400, epoch: 10 | loss: 0.0002465
	speed: 0.0470s/iter; left time: 1749.1555s
Epoch: 10 cost time: 18.81690502166748
Epoch: 10, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.978626 --> -0.981354).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000791
	speed: 0.1505s/iter; left time: 5578.3483s
	iters: 200, epoch: 11 | loss: 0.0002053
	speed: 0.0446s/iter; left time: 1648.9567s
	iters: 300, epoch: 11 | loss: 0.0000122
	speed: 0.0448s/iter; left time: 1651.7154s
	iters: 400, epoch: 11 | loss: 0.0005953
	speed: 0.0444s/iter; left time: 1634.0001s
Epoch: 11 cost time: 18.654612064361572
Epoch: 11, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000073
	speed: 0.1626s/iter; left time: 5961.8202s
	iters: 200, epoch: 12 | loss: 0.0000064
	speed: 0.0452s/iter; left time: 1650.9653s
	iters: 300, epoch: 12 | loss: 0.0000066
	speed: 0.0460s/iter; left time: 1676.6214s
	iters: 400, epoch: 12 | loss: 0.0000207
	speed: 0.0463s/iter; left time: 1681.7079s
Epoch: 12 cost time: 19.542773246765137
Epoch: 12, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.981354 --> -0.983173).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0001632
	speed: 0.1607s/iter; left time: 5825.1006s
	iters: 200, epoch: 13 | loss: 0.0006999
	speed: 0.0475s/iter; left time: 1718.1203s
	iters: 300, epoch: 13 | loss: 0.0001075
	speed: 0.0422s/iter; left time: 1522.2964s
	iters: 400, epoch: 13 | loss: 0.0000089
	speed: 0.0436s/iter; left time: 1565.8908s
Epoch: 13 cost time: 19.008862495422363
Epoch: 13, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000041
	speed: 0.1414s/iter; left time: 5065.6660s
	iters: 200, epoch: 14 | loss: 0.0000042
	speed: 0.0437s/iter; left time: 1560.0628s
	iters: 300, epoch: 14 | loss: 0.0000220
	speed: 0.0441s/iter; left time: 1572.4518s
	iters: 400, epoch: 14 | loss: 0.0017965
	speed: 0.0425s/iter; left time: 1510.9596s
Epoch: 14 cost time: 18.54089641571045
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000392
	speed: 0.1418s/iter; left time: 5023.6541s
	iters: 200, epoch: 15 | loss: 0.0009082
	speed: 0.0418s/iter; left time: 1477.2438s
	iters: 300, epoch: 15 | loss: 0.0054453
	speed: 0.0494s/iter; left time: 1740.1944s
	iters: 400, epoch: 15 | loss: 0.0000766
	speed: 0.0495s/iter; left time: 1739.1705s
Epoch: 15 cost time: 19.38684916496277
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.979 Test Loss: 0.124 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0022275
	speed: 0.1723s/iter; left time: 6033.2029s
	iters: 200, epoch: 16 | loss: 0.5685388
	speed: 0.0486s/iter; left time: 1697.1534s
	iters: 300, epoch: 16 | loss: 0.0035392
	speed: 0.0474s/iter; left time: 1648.1778s
	iters: 400, epoch: 16 | loss: 0.2889882
	speed: 0.0495s/iter; left time: 1718.1276s
Epoch: 16 cost time: 20.503268241882324
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000025
	speed: 0.1545s/iter; left time: 5343.0663s
	iters: 200, epoch: 17 | loss: 0.0517133
	speed: 0.0461s/iter; left time: 1590.7404s
	iters: 300, epoch: 17 | loss: 0.0000112
	speed: 0.0436s/iter; left time: 1498.5873s
	iters: 400, epoch: 17 | loss: 0.0000347
	speed: 0.0451s/iter; left time: 1548.1253s
Epoch: 17 cost time: 18.813478231430054
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000268
	speed: 0.1541s/iter; left time: 5268.4269s
	iters: 200, epoch: 18 | loss: 0.0000003
	speed: 0.0430s/iter; left time: 1464.3678s
	iters: 300, epoch: 18 | loss: 0.0000322
	speed: 0.0433s/iter; left time: 1472.9552s
	iters: 400, epoch: 18 | loss: 0.0119958
	speed: 0.0441s/iter; left time: 1492.7820s
Epoch: 18 cost time: 18.5728702545166
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000003
	speed: 0.1647s/iter; left time: 5559.9834s
	iters: 200, epoch: 19 | loss: 0.0000086
	speed: 0.0476s/iter; left time: 1604.2190s
	iters: 300, epoch: 19 | loss: 0.0000110
	speed: 0.0453s/iter; left time: 1519.4154s
	iters: 400, epoch: 19 | loss: 0.0000047
	speed: 0.0481s/iter; left time: 1609.8843s
Epoch: 19 cost time: 19.85688614845276
Epoch: 19, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0923435
	speed: 0.1509s/iter; left time: 5031.8430s
	iters: 200, epoch: 20 | loss: 0.0000452
	speed: 0.0429s/iter; left time: 1427.6974s
	iters: 300, epoch: 20 | loss: 0.0082048
	speed: 0.0441s/iter; left time: 1463.6838s
	iters: 400, epoch: 20 | loss: 0.0000100
	speed: 0.0436s/iter; left time: 1442.1364s
Epoch: 20 cost time: 18.497313261032104
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.172 Vali Acc: 0.971 Test Loss: 0.172 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0004501
	speed: 0.1445s/iter; left time: 4760.6457s
	iters: 200, epoch: 21 | loss: 0.0000091
	speed: 0.0436s/iter; left time: 1432.7415s
	iters: 300, epoch: 21 | loss: 0.0000022
	speed: 0.0434s/iter; left time: 1421.7729s
	iters: 400, epoch: 21 | loss: 0.0000003
	speed: 0.0446s/iter; left time: 1454.4711s
Epoch: 21 cost time: 18.477312803268433
Epoch: 21, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0001820
	speed: 0.1644s/iter; left time: 5347.2590s
	iters: 200, epoch: 22 | loss: 0.0000064
	speed: 0.0522s/iter; left time: 1691.4863s
	iters: 300, epoch: 22 | loss: 0.0000031
	speed: 0.0498s/iter; left time: 1608.5169s
	iters: 400, epoch: 22 | loss: 0.0000018
	speed: 0.0463s/iter; left time: 1491.6784s
Epoch: 22 cost time: 20.58671474456787
Epoch: 22, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 115922
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6403438
	speed: 0.0629s/iter; left time: 2592.5428s
	iters: 200, epoch: 1 | loss: 0.3026377
	speed: 0.0440s/iter; left time: 1809.1552s
	iters: 300, epoch: 1 | loss: 0.4564770
	speed: 0.0417s/iter; left time: 1709.4951s
	iters: 400, epoch: 1 | loss: 0.0551655
	speed: 0.0427s/iter; left time: 1746.8921s
Epoch: 1 cost time: 19.79143452644348
Epoch: 1, Steps: 413 | Train Loss: 0.557 Vali Loss: 0.128 Vali Acc: 0.960 Test Loss: 0.128 Test Acc: 0.960
Validation loss decreased (inf --> -0.959981).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0421050
	speed: 0.1441s/iter; left time: 5879.1881s
	iters: 200, epoch: 2 | loss: 0.1525444
	speed: 0.0419s/iter; left time: 1703.6516s
	iters: 300, epoch: 2 | loss: 0.0156583
	speed: 0.0437s/iter; left time: 1773.8907s
	iters: 400, epoch: 2 | loss: 0.0798603
	speed: 0.0411s/iter; left time: 1662.0472s
Epoch: 2 cost time: 17.78821325302124
Epoch: 2, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
Validation loss decreased (-0.959981 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0179737
	speed: 0.1544s/iter; left time: 6234.2237s
	iters: 200, epoch: 3 | loss: 0.0473597
	speed: 0.0451s/iter; left time: 1817.3624s
	iters: 300, epoch: 3 | loss: 0.0075054
	speed: 0.0443s/iter; left time: 1781.3126s
	iters: 400, epoch: 3 | loss: 0.1589000
	speed: 0.0429s/iter; left time: 1717.8114s
Epoch: 3 cost time: 18.825480461120605
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.970440 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0034158
	speed: 0.1554s/iter; left time: 6211.5069s
	iters: 200, epoch: 4 | loss: 0.0422244
	speed: 0.0383s/iter; left time: 1525.6544s
	iters: 300, epoch: 4 | loss: 0.1426696
	speed: 0.0403s/iter; left time: 1602.9595s
	iters: 400, epoch: 4 | loss: 0.0369332
	speed: 0.0419s/iter; left time: 1663.7672s
Epoch: 4 cost time: 17.06997585296631
Epoch: 4, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.096 Vali Acc: 0.964 Test Loss: 0.096 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0071208
	speed: 0.1402s/iter; left time: 5544.2994s
	iters: 200, epoch: 5 | loss: 0.0001450
	speed: 0.0454s/iter; left time: 1791.7479s
	iters: 300, epoch: 5 | loss: 0.0043134
	speed: 0.0439s/iter; left time: 1726.5120s
	iters: 400, epoch: 5 | loss: 0.0030994
	speed: 0.0432s/iter; left time: 1694.7694s
Epoch: 5 cost time: 18.591599225997925
Epoch: 5, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.070 Vali Acc: 0.973 Test Loss: 0.070 Test Acc: 0.973
Validation loss decreased (-0.973169 --> -0.973169).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0037061
	speed: 0.1492s/iter; left time: 5840.6462s
	iters: 200, epoch: 6 | loss: 0.0066593
	speed: 0.0492s/iter; left time: 1922.2947s
	iters: 300, epoch: 6 | loss: 0.0007351
	speed: 0.0473s/iter; left time: 1843.4563s
	iters: 400, epoch: 6 | loss: 0.0005787
	speed: 0.0506s/iter; left time: 1965.7107s
Epoch: 6 cost time: 20.25160527229309
Epoch: 6, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.973169 --> -0.976807).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0010917
	speed: 0.1739s/iter; left time: 6733.3955s
	iters: 200, epoch: 7 | loss: 0.0052184
	speed: 0.0520s/iter; left time: 2009.8286s
	iters: 300, epoch: 7 | loss: 0.0006246
	speed: 0.0498s/iter; left time: 1918.8443s
	iters: 400, epoch: 7 | loss: 0.0005982
	speed: 0.0453s/iter; left time: 1741.9617s
Epoch: 7 cost time: 20.704874992370605
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.976807 --> -0.980445).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0072121
	speed: 0.1482s/iter; left time: 5678.0971s
	iters: 200, epoch: 8 | loss: 0.0057332
	speed: 0.0435s/iter; left time: 1661.9510s
	iters: 300, epoch: 8 | loss: 0.0005316
	speed: 0.0422s/iter; left time: 1609.3936s
	iters: 400, epoch: 8 | loss: 0.0003463
	speed: 0.0442s/iter; left time: 1678.5516s
Epoch: 8 cost time: 18.36861777305603
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0101935
	speed: 0.1462s/iter; left time: 5540.6417s
	iters: 200, epoch: 9 | loss: 0.0000106
	speed: 0.0460s/iter; left time: 1737.8843s
	iters: 300, epoch: 9 | loss: 0.0001161
	speed: 0.0488s/iter; left time: 1839.4396s
	iters: 400, epoch: 9 | loss: 0.0000943
	speed: 0.0502s/iter; left time: 1887.0168s
Epoch: 9 cost time: 19.696565866470337
Epoch: 9, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0022682
	speed: 0.1702s/iter; left time: 6379.4564s
	iters: 200, epoch: 10 | loss: 0.0121461
	speed: 0.0498s/iter; left time: 1863.1698s
	iters: 300, epoch: 10 | loss: 0.0007921
	speed: 0.0489s/iter; left time: 1823.9592s
	iters: 400, epoch: 10 | loss: 0.0001235
	speed: 0.0486s/iter; left time: 1806.0931s
Epoch: 10 cost time: 20.762887716293335
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000034
	speed: 0.1529s/iter; left time: 5669.7138s
	iters: 200, epoch: 11 | loss: 0.0000704
	speed: 0.0450s/iter; left time: 1664.8935s
	iters: 300, epoch: 11 | loss: 0.0101802
	speed: 0.0409s/iter; left time: 1509.6405s
	iters: 400, epoch: 11 | loss: 0.0002147
	speed: 0.0420s/iter; left time: 1545.2942s
Epoch: 11 cost time: 18.220490217208862
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
Validation loss decreased (-0.980445 --> -0.981809).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000143
	speed: 0.1466s/iter; left time: 5373.7228s
	iters: 200, epoch: 12 | loss: 0.0000970
	speed: 0.0442s/iter; left time: 1615.7708s
	iters: 300, epoch: 12 | loss: 0.0000120
	speed: 0.0447s/iter; left time: 1630.8655s
	iters: 400, epoch: 12 | loss: 0.0013304
	speed: 0.0429s/iter; left time: 1558.6832s
Epoch: 12 cost time: 18.625088691711426
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0012967
	speed: 0.1756s/iter; left time: 6363.4240s
	iters: 200, epoch: 13 | loss: 0.0000044
	speed: 0.0450s/iter; left time: 1626.8346s
	iters: 300, epoch: 13 | loss: 0.0151920
	speed: 0.0495s/iter; left time: 1785.8726s
	iters: 400, epoch: 13 | loss: 0.0007866
	speed: 0.0508s/iter; left time: 1827.0429s
Epoch: 13 cost time: 20.529305458068848
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000009
	speed: 0.1678s/iter; left time: 6011.4471s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.0432s/iter; left time: 1543.0610s
	iters: 300, epoch: 14 | loss: 0.0000076
	speed: 0.0444s/iter; left time: 1580.4647s
	iters: 400, epoch: 14 | loss: 0.0000413
	speed: 0.0418s/iter; left time: 1485.7751s
Epoch: 14 cost time: 18.737406492233276
Epoch: 14, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000088
	speed: 0.1469s/iter; left time: 5202.0297s
	iters: 200, epoch: 15 | loss: 0.0004729
	speed: 0.0421s/iter; left time: 1485.2747s
	iters: 300, epoch: 15 | loss: 0.0081457
	speed: 0.0449s/iter; left time: 1581.0254s
	iters: 400, epoch: 15 | loss: 0.0012898
	speed: 0.0440s/iter; left time: 1544.9789s
Epoch: 15 cost time: 18.55138373374939
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000371
	speed: 0.1492s/iter; left time: 5222.2997s
	iters: 200, epoch: 16 | loss: 0.0001997
	speed: 0.0482s/iter; left time: 1681.6974s
	iters: 300, epoch: 16 | loss: 0.0001483
	speed: 0.0473s/iter; left time: 1644.6570s
	iters: 400, epoch: 16 | loss: 0.0037579
	speed: 0.0464s/iter; left time: 1610.3873s
Epoch: 16 cost time: 19.89428949356079
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000007
	speed: 0.1663s/iter; left time: 5754.4114s
	iters: 200, epoch: 17 | loss: 0.0005117
	speed: 0.0482s/iter; left time: 1661.4252s
	iters: 300, epoch: 17 | loss: 0.0000187
	speed: 0.0461s/iter; left time: 1584.8714s
	iters: 400, epoch: 17 | loss: 0.0005659
	speed: 0.0462s/iter; left time: 1583.0218s
Epoch: 17 cost time: 20.108113527297974
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0011000
	speed: 0.1493s/iter; left time: 5104.1537s
	iters: 200, epoch: 18 | loss: 0.0000107
	speed: 0.0453s/iter; left time: 1543.7222s
	iters: 300, epoch: 18 | loss: 0.0000045
	speed: 0.0450s/iter; left time: 1530.7269s
	iters: 400, epoch: 18 | loss: 0.0000680
	speed: 0.0425s/iter; left time: 1441.3854s
Epoch: 18 cost time: 18.52707576751709
Epoch: 18, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000003
	speed: 0.1485s/iter; left time: 5014.1032s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1495.8615s
	iters: 300, epoch: 19 | loss: 0.0000009
	speed: 0.0477s/iter; left time: 1601.4043s
	iters: 400, epoch: 19 | loss: 0.0000183
	speed: 0.0476s/iter; left time: 1592.2030s
Epoch: 19 cost time: 19.523587226867676
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000553
	speed: 0.1691s/iter; left time: 5638.9549s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1544.2621s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1714.0197s
	iters: 400, epoch: 20 | loss: 0.0001117
	speed: 0.0473s/iter; left time: 1564.7655s
Epoch: 20 cost time: 20.09372901916504
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0001908
	speed: 0.1455s/iter; left time: 4793.9889s
	iters: 200, epoch: 21 | loss: 0.0001179
	speed: 0.0441s/iter; left time: 1447.2078s
	iters: 300, epoch: 21 | loss: 0.0006535
	speed: 0.0423s/iter; left time: 1383.5319s
	iters: 400, epoch: 21 | loss: 0.0000805
	speed: 0.0430s/iter; left time: 1404.3870s
Epoch: 21 cost time: 18.306161642074585
Epoch: 21, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 115922
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8915641
	speed: 0.0646s/iter; left time: 2661.3924s
	iters: 200, epoch: 1 | loss: 0.3381794
	speed: 0.0448s/iter; left time: 1840.6912s
	iters: 300, epoch: 1 | loss: 0.5656871
	speed: 0.0453s/iter; left time: 1855.5987s
	iters: 400, epoch: 1 | loss: 0.0558012
	speed: 0.0460s/iter; left time: 1879.7302s
Epoch: 1 cost time: 20.735387325286865
Epoch: 1, Steps: 413 | Train Loss: 0.644 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0541793
	speed: 0.1658s/iter; left time: 6763.0650s
	iters: 200, epoch: 2 | loss: 0.1085976
	speed: 0.0460s/iter; left time: 1871.5312s
	iters: 300, epoch: 2 | loss: 0.0366005
	speed: 0.0455s/iter; left time: 1846.1788s
	iters: 400, epoch: 2 | loss: 0.1292120
	speed: 0.0424s/iter; left time: 1715.1344s
Epoch: 2 cost time: 19.27129316329956
Epoch: 2, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.081 Vali Acc: 0.972 Test Loss: 0.081 Test Acc: 0.972
Validation loss decreased (-0.953614 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0371983
	speed: 0.1472s/iter; left time: 5942.4308s
	iters: 200, epoch: 3 | loss: 0.0074379
	speed: 0.0429s/iter; left time: 1727.7051s
	iters: 300, epoch: 3 | loss: 0.0056288
	speed: 0.0452s/iter; left time: 1814.8023s
	iters: 400, epoch: 3 | loss: 0.1043121
	speed: 0.0439s/iter; left time: 1761.2412s
Epoch: 3 cost time: 18.510958433151245
Epoch: 3, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0006224
	speed: 0.1381s/iter; left time: 5520.6113s
	iters: 200, epoch: 4 | loss: 0.1404849
	speed: 0.0430s/iter; left time: 1712.6134s
	iters: 300, epoch: 4 | loss: 0.0603522
	speed: 0.0427s/iter; left time: 1697.2309s
	iters: 400, epoch: 4 | loss: 0.0019156
	speed: 0.0446s/iter; left time: 1768.9333s
Epoch: 4 cost time: 18.222719192504883
Epoch: 4, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0021623
	speed: 0.1637s/iter; left time: 6474.4927s
	iters: 200, epoch: 5 | loss: 0.0004533
	speed: 0.0470s/iter; left time: 1853.1215s
	iters: 300, epoch: 5 | loss: 0.0026898
	speed: 0.0475s/iter; left time: 1870.8075s
	iters: 400, epoch: 5 | loss: 0.0026918
	speed: 0.0483s/iter; left time: 1894.2031s
Epoch: 5 cost time: 19.855003356933594
Epoch: 5, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.062 Vali Acc: 0.978 Test Loss: 0.062 Test Acc: 0.978
Validation loss decreased (-0.972259 --> -0.977717).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0166068
	speed: 0.1455s/iter; left time: 5694.0726s
	iters: 200, epoch: 6 | loss: 0.0525115
	speed: 0.0431s/iter; left time: 1681.8396s
	iters: 300, epoch: 6 | loss: 0.0030226
	speed: 0.0427s/iter; left time: 1662.6356s
	iters: 400, epoch: 6 | loss: 0.0009102
	speed: 0.0412s/iter; left time: 1601.9630s
Epoch: 6 cost time: 17.787062168121338
Epoch: 6, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0003464
	speed: 0.1478s/iter; left time: 5722.2487s
	iters: 200, epoch: 7 | loss: 0.0180044
	speed: 0.0417s/iter; left time: 1611.3081s
	iters: 300, epoch: 7 | loss: 0.0037863
	speed: 0.0422s/iter; left time: 1626.8700s
	iters: 400, epoch: 7 | loss: 0.0017427
	speed: 0.0441s/iter; left time: 1694.8747s
Epoch: 7 cost time: 17.899780750274658
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.061 Vali Acc: 0.977 Test Loss: 0.061 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0015366
	speed: 0.1558s/iter; left time: 5968.6668s
	iters: 200, epoch: 8 | loss: 0.0002889
	speed: 0.0459s/iter; left time: 1755.0224s
	iters: 300, epoch: 8 | loss: 0.0082484
	speed: 0.0438s/iter; left time: 1668.2655s
	iters: 400, epoch: 8 | loss: 0.0242061
	speed: 0.0466s/iter; left time: 1770.9834s
Epoch: 8 cost time: 19.273258209228516
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0069148
	speed: 0.1680s/iter; left time: 6366.9319s
	iters: 200, epoch: 9 | loss: 0.0091132
	speed: 0.0433s/iter; left time: 1637.4239s
	iters: 300, epoch: 9 | loss: 0.0003235
	speed: 0.0425s/iter; left time: 1603.4700s
	iters: 400, epoch: 9 | loss: 0.0007161
	speed: 0.0452s/iter; left time: 1699.1985s
Epoch: 9 cost time: 18.36383318901062
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0076024
	speed: 0.1434s/iter; left time: 5375.9376s
	iters: 200, epoch: 10 | loss: 0.0164591
	speed: 0.0434s/iter; left time: 1622.6138s
	iters: 300, epoch: 10 | loss: 0.0064418
	speed: 0.0439s/iter; left time: 1636.2720s
	iters: 400, epoch: 10 | loss: 0.0480519
	speed: 0.0426s/iter; left time: 1583.0025s
Epoch: 10 cost time: 18.352247714996338
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0001014
	speed: 0.1471s/iter; left time: 5452.2526s
	iters: 200, epoch: 11 | loss: 0.0000453
	speed: 0.0449s/iter; left time: 1660.4728s
	iters: 300, epoch: 11 | loss: 0.0001367
	speed: 0.0453s/iter; left time: 1671.4949s
	iters: 400, epoch: 11 | loss: 0.0002346
	speed: 0.0455s/iter; left time: 1671.6112s
Epoch: 11 cost time: 19.34460186958313
Epoch: 11, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.977717 --> -0.979990).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000259
	speed: 0.1573s/iter; left time: 5765.4095s
	iters: 200, epoch: 12 | loss: 0.0010105
	speed: 0.0468s/iter; left time: 1710.8461s
	iters: 300, epoch: 12 | loss: 0.0054889
	speed: 0.0457s/iter; left time: 1665.1547s
	iters: 400, epoch: 12 | loss: 0.0000451
	speed: 0.0419s/iter; left time: 1522.6130s
Epoch: 12 cost time: 18.934200525283813
Epoch: 12, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
Validation loss decreased (-0.979990 --> -0.984538).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0005734
	speed: 0.1440s/iter; left time: 5218.5713s
	iters: 200, epoch: 13 | loss: 0.0000006
	speed: 0.0421s/iter; left time: 1522.6346s
	iters: 300, epoch: 13 | loss: 0.0001892
	speed: 0.0418s/iter; left time: 1507.2095s
	iters: 400, epoch: 13 | loss: 0.0000205
	speed: 0.0446s/iter; left time: 1602.6275s
Epoch: 13 cost time: 17.919854879379272
Epoch: 13, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0078777
	speed: 0.1507s/iter; left time: 5401.5486s
	iters: 200, epoch: 14 | loss: 0.0001351
	speed: 0.0445s/iter; left time: 1589.5541s
	iters: 300, epoch: 14 | loss: 0.0000345
	speed: 0.0466s/iter; left time: 1659.1899s
	iters: 400, epoch: 14 | loss: 0.0000148
	speed: 0.0472s/iter; left time: 1676.2057s
Epoch: 14 cost time: 19.134657859802246
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000019
	speed: 0.1710s/iter; left time: 6057.6983s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 1662.9848s
	iters: 300, epoch: 15 | loss: 0.0004540
	speed: 0.0471s/iter; left time: 1657.9797s
	iters: 400, epoch: 15 | loss: 0.0000082
	speed: 0.0471s/iter; left time: 1652.3763s
Epoch: 15 cost time: 19.92916989326477
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0002291
	speed: 0.1431s/iter; left time: 5009.8208s
	iters: 200, epoch: 16 | loss: 0.0006063
	speed: 0.0421s/iter; left time: 1470.8893s
	iters: 300, epoch: 16 | loss: 0.3576552
	speed: 0.0432s/iter; left time: 1503.4839s
	iters: 400, epoch: 16 | loss: 0.0005901
	speed: 0.0427s/iter; left time: 1482.7806s
Epoch: 16 cost time: 17.98084855079651
Epoch: 16, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.984538 --> -0.986812).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000378
	speed: 0.1404s/iter; left time: 4858.1062s
	iters: 200, epoch: 17 | loss: 0.0000103
	speed: 0.0413s/iter; left time: 1425.9992s
	iters: 300, epoch: 17 | loss: 0.0000021
	speed: 0.0411s/iter; left time: 1413.8109s
	iters: 400, epoch: 17 | loss: 0.0000074
	speed: 0.0417s/iter; left time: 1429.6467s
Epoch: 17 cost time: 17.545353412628174
Epoch: 17, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.986 Test Loss: 0.066 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000241
	speed: 0.1592s/iter; left time: 5439.9489s
	iters: 200, epoch: 18 | loss: 0.0000658
	speed: 0.0506s/iter; left time: 1723.6103s
	iters: 300, epoch: 18 | loss: 0.0109119
	speed: 0.0477s/iter; left time: 1621.2298s
	iters: 400, epoch: 18 | loss: 0.0011370
	speed: 0.0456s/iter; left time: 1545.7941s
Epoch: 18 cost time: 19.9224796295166
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000002
	speed: 0.1768s/iter; left time: 5971.5638s
	iters: 200, epoch: 19 | loss: 0.0001175
	speed: 0.0437s/iter; left time: 1470.2115s
	iters: 300, epoch: 19 | loss: 0.0026219
	speed: 0.0459s/iter; left time: 1539.7261s
	iters: 400, epoch: 19 | loss: 0.0000277
	speed: 0.0467s/iter; left time: 1563.4829s
Epoch: 19 cost time: 19.432097911834717
Epoch: 19, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000239
	speed: 0.1473s/iter; left time: 4914.6107s
	iters: 200, epoch: 20 | loss: 0.0000100
	speed: 0.0440s/iter; left time: 1462.3596s
	iters: 300, epoch: 20 | loss: 0.0007202
	speed: 0.0415s/iter; left time: 1376.8872s
	iters: 400, epoch: 20 | loss: 0.0000286
	speed: 0.0414s/iter; left time: 1369.2337s
Epoch: 20 cost time: 18.034083604812622
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000084
	speed: 0.1377s/iter; left time: 4535.2338s
	iters: 200, epoch: 21 | loss: 0.0025919
	speed: 0.0452s/iter; left time: 1483.4724s
	iters: 300, epoch: 21 | loss: 0.0000632
	speed: 0.0467s/iter; left time: 1529.9934s
	iters: 400, epoch: 21 | loss: 0.0000674
	speed: 0.0493s/iter; left time: 1608.3985s
Epoch: 21 cost time: 19.286762714385986
Epoch: 21, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0005704
	speed: 0.1602s/iter; left time: 5212.0181s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0484s/iter; left time: 1567.9060s
	iters: 300, epoch: 22 | loss: 0.0000754
	speed: 0.0477s/iter; left time: 1541.7074s
	iters: 400, epoch: 22 | loss: 0.0605449
	speed: 0.0412s/iter; left time: 1327.5651s
Epoch: 22 cost time: 19.30501699447632
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000404
	speed: 0.1447s/iter; left time: 4645.9853s
	iters: 200, epoch: 23 | loss: 0.0003924
	speed: 0.0420s/iter; left time: 1344.4687s
	iters: 300, epoch: 23 | loss: 0.0000008
	speed: 0.0445s/iter; left time: 1420.9456s
	iters: 400, epoch: 23 | loss: 0.0345506
	speed: 0.0448s/iter; left time: 1424.2155s
Epoch: 23 cost time: 18.496861219406128
Epoch: 23, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000077
	speed: 0.1568s/iter; left time: 4970.9246s
	iters: 200, epoch: 24 | loss: 0.0038010
	speed: 0.0442s/iter; left time: 1396.8273s
	iters: 300, epoch: 24 | loss: 0.0000004
	speed: 0.0484s/iter; left time: 1523.4149s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 1528.7490s
Epoch: 24 cost time: 19.54181408882141
Epoch: 24, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000161
	speed: 0.1769s/iter; left time: 5534.3605s
	iters: 200, epoch: 25 | loss: 0.0001553
	speed: 0.0484s/iter; left time: 1508.5392s
	iters: 300, epoch: 25 | loss: 0.0000018
	speed: 0.0470s/iter; left time: 1460.0723s
	iters: 400, epoch: 25 | loss: 0.0000472
	speed: 0.0495s/iter; left time: 1532.7293s
Epoch: 25 cost time: 20.085432529449463
Epoch: 25, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000344
	speed: 0.1517s/iter; left time: 4682.7951s
	iters: 200, epoch: 26 | loss: 0.0000330
	speed: 0.0433s/iter; left time: 1333.7118s
	iters: 300, epoch: 26 | loss: 0.0000572
	speed: 0.0435s/iter; left time: 1333.3995s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1310.0627s
Epoch: 26 cost time: 18.38927412033081
Epoch: 26, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 115922
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3819826
	speed: 0.0626s/iter; left time: 2579.5660s
	iters: 200, epoch: 1 | loss: 0.2105035
	speed: 0.0462s/iter; left time: 1899.4203s
	iters: 300, epoch: 1 | loss: 0.3480799
	speed: 0.0475s/iter; left time: 1948.3601s
	iters: 400, epoch: 1 | loss: 0.1599470
	speed: 0.0481s/iter; left time: 1967.7697s
Epoch: 1 cost time: 21.186223030090332
Epoch: 1, Steps: 413 | Train Loss: 0.557 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
Validation loss decreased (inf --> -0.964073).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0594918
	speed: 0.1702s/iter; left time: 6943.9135s
	iters: 200, epoch: 2 | loss: 0.0416003
	speed: 0.0495s/iter; left time: 2015.2290s
	iters: 300, epoch: 2 | loss: 0.0333974
	speed: 0.0495s/iter; left time: 2009.3865s
	iters: 400, epoch: 2 | loss: 0.0906793
	speed: 0.0448s/iter; left time: 1814.3032s
Epoch: 2 cost time: 20.618558645248413
Epoch: 2, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
Validation loss decreased (-0.964073 --> -0.977716).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0053184
	speed: 0.1604s/iter; left time: 6474.5089s
	iters: 200, epoch: 3 | loss: 0.2032731
	speed: 0.0420s/iter; left time: 1691.9397s
	iters: 300, epoch: 3 | loss: 0.0197459
	speed: 0.0434s/iter; left time: 1744.1934s
	iters: 400, epoch: 3 | loss: 0.1171548
	speed: 0.0425s/iter; left time: 1702.8704s
Epoch: 3 cost time: 18.342615604400635
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0045385
	speed: 0.1410s/iter; left time: 5634.7818s
	iters: 200, epoch: 4 | loss: 0.0024203
	speed: 0.0418s/iter; left time: 1666.6971s
	iters: 300, epoch: 4 | loss: 0.0063868
	speed: 0.0420s/iter; left time: 1668.3362s
	iters: 400, epoch: 4 | loss: 0.3744021
	speed: 0.0446s/iter; left time: 1768.4597s
Epoch: 4 cost time: 18.10876750946045
Epoch: 4, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
Validation loss decreased (-0.977716 --> -0.978171).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0025054
	speed: 0.1635s/iter; left time: 6467.0815s
	iters: 200, epoch: 5 | loss: 0.1889022
	speed: 0.0465s/iter; left time: 1833.9665s
	iters: 300, epoch: 5 | loss: 0.0028489
	speed: 0.0444s/iter; left time: 1748.2829s
	iters: 400, epoch: 5 | loss: 0.0028299
	speed: 0.0459s/iter; left time: 1802.7912s
Epoch: 5 cost time: 18.94649624824524
Epoch: 5, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0031148
	speed: 0.1548s/iter; left time: 6057.5905s
	iters: 200, epoch: 6 | loss: 0.0134636
	speed: 0.0419s/iter; left time: 1635.5681s
	iters: 300, epoch: 6 | loss: 0.0005910
	speed: 0.0423s/iter; left time: 1646.6726s
	iters: 400, epoch: 6 | loss: 0.0000304
	speed: 0.0417s/iter; left time: 1619.6766s
Epoch: 6 cost time: 17.915911197662354
Epoch: 6, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0057283
	speed: 0.1460s/iter; left time: 5653.9436s
	iters: 200, epoch: 7 | loss: 0.0012283
	speed: 0.0427s/iter; left time: 1650.9136s
	iters: 300, epoch: 7 | loss: 0.1677914
	speed: 0.0435s/iter; left time: 1674.5384s
	iters: 400, epoch: 7 | loss: 0.0083770
	speed: 0.0430s/iter; left time: 1652.5962s
Epoch: 7 cost time: 18.253822326660156
Epoch: 7, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0118712
	speed: 0.1570s/iter; left time: 6013.3170s
	iters: 200, epoch: 8 | loss: 0.0130782
	speed: 0.0467s/iter; left time: 1786.2110s
	iters: 300, epoch: 8 | loss: 0.0004360
	speed: 0.0457s/iter; left time: 1742.4385s
	iters: 400, epoch: 8 | loss: 0.0001551
	speed: 0.0447s/iter; left time: 1698.6816s
Epoch: 8 cost time: 19.277161836624146
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0002996
	speed: 0.1614s/iter; left time: 6116.8783s
	iters: 200, epoch: 9 | loss: 0.0001645
	speed: 0.0427s/iter; left time: 1615.1312s
	iters: 300, epoch: 9 | loss: 0.0001362
	speed: 0.0479s/iter; left time: 1806.9684s
	iters: 400, epoch: 9 | loss: 0.0054687
	speed: 0.0471s/iter; left time: 1772.2427s
Epoch: 9 cost time: 19.39196801185608
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0009004
	speed: 0.1295s/iter; left time: 4855.2721s
	iters: 200, epoch: 10 | loss: 0.0001112
	speed: 0.0466s/iter; left time: 1742.0687s
	iters: 300, epoch: 10 | loss: 0.0362290
	speed: 0.0428s/iter; left time: 1595.6040s
	iters: 400, epoch: 10 | loss: 0.0251630
	speed: 0.0409s/iter; left time: 1521.3255s
Epoch: 10 cost time: 17.590182542800903
Epoch: 10, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0001151
	speed: 0.1356s/iter; left time: 5026.5319s
	iters: 200, epoch: 11 | loss: 0.0024348
	speed: 0.0428s/iter; left time: 1581.4865s
	iters: 300, epoch: 11 | loss: 0.0001300
	speed: 0.0442s/iter; left time: 1628.1537s
	iters: 400, epoch: 11 | loss: 0.0000421
	speed: 0.0449s/iter; left time: 1651.8133s
Epoch: 11 cost time: 18.456927061080933
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.053 Vali Acc: 0.985 Test Loss: 0.053 Test Acc: 0.985
Validation loss decreased (-0.978171 --> -0.984538).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0026258
	speed: 0.1571s/iter; left time: 5760.0911s
	iters: 200, epoch: 12 | loss: 0.0000070
	speed: 0.0435s/iter; left time: 1590.2030s
	iters: 300, epoch: 12 | loss: 0.0000328
	speed: 0.0514s/iter; left time: 1872.6931s
	iters: 400, epoch: 12 | loss: 0.0000624
	speed: 0.0459s/iter; left time: 1668.6272s
Epoch: 12 cost time: 19.634973287582397
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0229139
	speed: 0.1644s/iter; left time: 5958.0612s
	iters: 200, epoch: 13 | loss: 0.0000040
	speed: 0.0458s/iter; left time: 1655.2161s
	iters: 300, epoch: 13 | loss: 0.0011094
	speed: 0.0475s/iter; left time: 1713.6734s
	iters: 400, epoch: 13 | loss: 0.0002106
	speed: 0.0453s/iter; left time: 1629.3069s
Epoch: 13 cost time: 19.578431844711304
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.137 Vali Acc: 0.976 Test Loss: 0.137 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.5936151
	speed: 0.1406s/iter; left time: 5036.7587s
	iters: 200, epoch: 14 | loss: 0.0006745
	speed: 0.0420s/iter; left time: 1501.9967s
	iters: 300, epoch: 14 | loss: 0.0000281
	speed: 0.0436s/iter; left time: 1553.1330s
	iters: 400, epoch: 14 | loss: 0.0000481
	speed: 0.0427s/iter; left time: 1517.8614s
Epoch: 14 cost time: 17.95729422569275
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0031905
	speed: 0.1403s/iter; left time: 4969.1104s
	iters: 200, epoch: 15 | loss: 0.0000020
	speed: 0.0422s/iter; left time: 1490.0247s
	iters: 300, epoch: 15 | loss: 0.0989384
	speed: 0.0412s/iter; left time: 1450.1505s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1510.2491s
Epoch: 15 cost time: 17.89315676689148
Epoch: 15, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000212
	speed: 0.1731s/iter; left time: 6059.0562s
	iters: 200, epoch: 16 | loss: 0.0000025
	speed: 0.0492s/iter; left time: 1717.0542s
	iters: 300, epoch: 16 | loss: 0.0000671
	speed: 0.0504s/iter; left time: 1755.9221s
	iters: 400, epoch: 16 | loss: 0.0002692
	speed: 0.0493s/iter; left time: 1712.5379s
Epoch: 16 cost time: 20.68778133392334
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000139
	speed: 0.1744s/iter; left time: 6033.1728s
	iters: 200, epoch: 17 | loss: 0.0000036
	speed: 0.0433s/iter; left time: 1495.2596s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.0440s/iter; left time: 1514.5110s
	iters: 400, epoch: 17 | loss: 0.0002669
	speed: 0.0430s/iter; left time: 1474.0310s
Epoch: 17 cost time: 18.756633043289185
Epoch: 17, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.984 Test Loss: 0.086 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000005
	speed: 0.1452s/iter; left time: 4962.5088s
	iters: 200, epoch: 18 | loss: 0.0000003
	speed: 0.0437s/iter; left time: 1490.2583s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0431s/iter; left time: 1462.8762s
	iters: 400, epoch: 18 | loss: 0.0000139
	speed: 0.0423s/iter; left time: 1431.5805s
Epoch: 18 cost time: 17.999971628189087
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000017
	speed: 0.1415s/iter; left time: 4777.7385s
	iters: 200, epoch: 19 | loss: 0.0065626
	speed: 0.0464s/iter; left time: 1561.8449s
	iters: 300, epoch: 19 | loss: 0.0001137
	speed: 0.0461s/iter; left time: 1545.8989s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0454s/iter; left time: 1517.8640s
Epoch: 19 cost time: 19.168423652648926
Epoch: 19, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000009
	speed: 0.1594s/iter; left time: 5315.9273s
	iters: 200, epoch: 20 | loss: 0.0152082
	speed: 0.0467s/iter; left time: 1551.6597s
	iters: 300, epoch: 20 | loss: 0.0000543
	speed: 0.0481s/iter; left time: 1593.3039s
	iters: 400, epoch: 20 | loss: 0.0000002
	speed: 0.0416s/iter; left time: 1376.3525s
Epoch: 20 cost time: 19.055421829223633
Epoch: 20, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0001756
	speed: 0.1427s/iter; left time: 4699.0767s
	iters: 200, epoch: 21 | loss: 0.0704642
	speed: 0.0420s/iter; left time: 1379.1700s
	iters: 300, epoch: 21 | loss: 0.0000010
	speed: 0.0419s/iter; left time: 1371.2353s
	iters: 400, epoch: 21 | loss: 0.0142848
	speed: 0.0414s/iter; left time: 1351.2292s
Epoch: 21 cost time: 17.76659083366394
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 99538
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4018160
	speed: 0.0675s/iter; left time: 2781.6189s
	iters: 200, epoch: 1 | loss: 0.2209373
	speed: 0.0489s/iter; left time: 2010.9555s
	iters: 300, epoch: 1 | loss: 0.3642899
	speed: 0.0474s/iter; left time: 1943.4707s
	iters: 400, epoch: 1 | loss: 0.1660341
	speed: 0.0466s/iter; left time: 1907.8192s
Epoch: 1 cost time: 21.7514750957489
Epoch: 1, Steps: 413 | Train Loss: 0.559 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
Validation loss decreased (inf --> -0.964073).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0559512
	speed: 0.1688s/iter; left time: 6883.5931s
	iters: 200, epoch: 2 | loss: 0.0401507
	speed: 0.0448s/iter; left time: 1820.9045s
	iters: 300, epoch: 2 | loss: 0.0322077
	speed: 0.0441s/iter; left time: 1789.7859s
	iters: 400, epoch: 2 | loss: 0.0994420
	speed: 0.0442s/iter; left time: 1791.2903s
Epoch: 2 cost time: 19.170949697494507
Epoch: 2, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
Validation loss decreased (-0.964073 --> -0.972714).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0091303
	speed: 0.1431s/iter; left time: 5778.4006s
	iters: 200, epoch: 3 | loss: 0.1861246
	speed: 0.0425s/iter; left time: 1712.8398s
	iters: 300, epoch: 3 | loss: 0.0176416
	speed: 0.0455s/iter; left time: 1828.9244s
	iters: 400, epoch: 3 | loss: 0.0615489
	speed: 0.0444s/iter; left time: 1778.3931s
Epoch: 3 cost time: 18.376648902893066
Epoch: 3, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0018786
	speed: 0.1531s/iter; left time: 6118.1899s
	iters: 200, epoch: 4 | loss: 0.0042980
	speed: 0.0495s/iter; left time: 1974.0504s
	iters: 300, epoch: 4 | loss: 0.0026953
	speed: 0.0486s/iter; left time: 1930.6278s
	iters: 400, epoch: 4 | loss: 0.0810652
	speed: 0.0483s/iter; left time: 1916.1059s
Epoch: 4 cost time: 20.76962924003601
Epoch: 4, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.128 Vali Acc: 0.961 Test Loss: 0.128 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0026448
	speed: 0.1769s/iter; left time: 6994.5743s
	iters: 200, epoch: 5 | loss: 0.1697543
	speed: 0.0491s/iter; left time: 1935.5456s
	iters: 300, epoch: 5 | loss: 0.0074495
	speed: 0.0487s/iter; left time: 1917.6048s
	iters: 400, epoch: 5 | loss: 0.0539541
	speed: 0.0446s/iter; left time: 1748.5995s
Epoch: 5 cost time: 20.176385402679443
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.972714 --> -0.977716).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0014099
	speed: 0.1399s/iter; left time: 5473.8810s
	iters: 200, epoch: 6 | loss: 0.0007399
	speed: 0.0446s/iter; left time: 1742.0874s
	iters: 300, epoch: 6 | loss: 0.0001626
	speed: 0.0423s/iter; left time: 1646.6873s
	iters: 400, epoch: 6 | loss: 0.0049244
	speed: 0.0442s/iter; left time: 1716.4893s
Epoch: 6 cost time: 18.510543823242188
Epoch: 6, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0011768
	speed: 0.1460s/iter; left time: 5654.9866s
	iters: 200, epoch: 7 | loss: 0.0006462
	speed: 0.0414s/iter; left time: 1598.4189s
	iters: 300, epoch: 7 | loss: 0.0008788
	speed: 0.0473s/iter; left time: 1823.8138s
	iters: 400, epoch: 7 | loss: 0.0001996
	speed: 0.0485s/iter; left time: 1863.1938s
Epoch: 7 cost time: 19.32023310661316
Epoch: 7, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.053 Vali Acc: 0.984 Test Loss: 0.053 Test Acc: 0.984
Validation loss decreased (-0.977716 --> -0.984083).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0036078
	speed: 0.1654s/iter; left time: 6334.8803s
	iters: 200, epoch: 8 | loss: 0.0032763
	speed: 0.0512s/iter; left time: 1958.1257s
	iters: 300, epoch: 8 | loss: 0.0001672
	speed: 0.0522s/iter; left time: 1991.0345s
	iters: 400, epoch: 8 | loss: 0.0000550
	speed: 0.0490s/iter; left time: 1861.6774s
Epoch: 8 cost time: 21.0503990650177
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0063732
	speed: 0.1552s/iter; left time: 5881.1590s
	iters: 200, epoch: 9 | loss: 0.0008549
	speed: 0.0443s/iter; left time: 1673.4816s
	iters: 300, epoch: 9 | loss: 0.0031479
	speed: 0.0454s/iter; left time: 1711.8741s
	iters: 400, epoch: 9 | loss: 0.0025139
	speed: 0.0448s/iter; left time: 1684.5591s
Epoch: 9 cost time: 19.07518744468689
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000355
	speed: 0.1560s/iter; left time: 5848.5305s
	iters: 200, epoch: 10 | loss: 0.0000326
	speed: 0.0449s/iter; left time: 1678.8856s
	iters: 300, epoch: 10 | loss: 0.0072252
	speed: 0.0433s/iter; left time: 1615.3615s
	iters: 400, epoch: 10 | loss: 0.0018599
	speed: 0.0472s/iter; left time: 1755.9213s
Epoch: 10 cost time: 18.852530002593994
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.181 Vali Acc: 0.965 Test Loss: 0.181 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0004507
	speed: 0.1628s/iter; left time: 6033.9165s
	iters: 200, epoch: 11 | loss: 0.0000510
	speed: 0.0491s/iter; left time: 1813.5372s
	iters: 300, epoch: 11 | loss: 0.0000375
	speed: 0.0492s/iter; left time: 1812.7126s
	iters: 400, epoch: 11 | loss: 0.0055083
	speed: 0.0487s/iter; left time: 1789.0983s
Epoch: 11 cost time: 20.48327398300171
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000361
	speed: 0.1499s/iter; left time: 5493.2721s
	iters: 200, epoch: 12 | loss: 0.0000799
	speed: 0.0431s/iter; left time: 1575.8452s
	iters: 300, epoch: 12 | loss: 0.0000138
	speed: 0.0445s/iter; left time: 1623.2335s
	iters: 400, epoch: 12 | loss: 0.0002515
	speed: 0.0440s/iter; left time: 1599.9562s
Epoch: 12 cost time: 18.50285029411316
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0009960
	speed: 0.1515s/iter; left time: 5491.7618s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1708.7493s
	iters: 300, epoch: 13 | loss: 0.0000536
	speed: 0.0442s/iter; left time: 1593.6181s
	iters: 400, epoch: 13 | loss: 0.0020569
	speed: 0.0443s/iter; left time: 1592.8568s
Epoch: 13 cost time: 19.175816297531128
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000710
	speed: 0.1655s/iter; left time: 5931.1713s
	iters: 200, epoch: 14 | loss: 0.0000121
	speed: 0.0489s/iter; left time: 1747.8182s
	iters: 300, epoch: 14 | loss: 0.0000260
	speed: 0.0475s/iter; left time: 1693.0470s
	iters: 400, epoch: 14 | loss: 0.0002379
	speed: 0.0535s/iter; left time: 1900.2615s
Epoch: 14 cost time: 20.413789749145508
Epoch: 14, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0007097
	speed: 0.1590s/iter; left time: 5631.8248s
	iters: 200, epoch: 15 | loss: 0.0000108
	speed: 0.0446s/iter; left time: 1576.4945s
	iters: 300, epoch: 15 | loss: 0.1609829
	speed: 0.0432s/iter; left time: 1521.6987s
	iters: 400, epoch: 15 | loss: 0.0000019
	speed: 0.0420s/iter; left time: 1473.6912s
Epoch: 15 cost time: 18.2987539768219
Epoch: 15, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.3050874
	speed: 0.1447s/iter; left time: 5066.5305s
	iters: 200, epoch: 16 | loss: 0.0024280
	speed: 0.0423s/iter; left time: 1477.7081s
	iters: 300, epoch: 16 | loss: 0.0001453
	speed: 0.0436s/iter; left time: 1515.9440s
	iters: 400, epoch: 16 | loss: 0.0000033
	speed: 0.0439s/iter; left time: 1522.2705s
Epoch: 16 cost time: 18.176362991333008
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000220
	speed: 0.1452s/iter; left time: 5021.8831s
	iters: 200, epoch: 17 | loss: 0.0012265
	speed: 0.0485s/iter; left time: 1673.5776s
	iters: 300, epoch: 17 | loss: 0.0000129
	speed: 0.0508s/iter; left time: 1745.4515s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0492s/iter; left time: 1686.2491s
Epoch: 17 cost time: 20.65748357772827
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 99538
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4444645
	speed: 0.0648s/iter; left time: 2670.8218s
	iters: 200, epoch: 1 | loss: 0.2148458
	speed: 0.0462s/iter; left time: 1897.1915s
	iters: 300, epoch: 1 | loss: 0.3898501
	speed: 0.0430s/iter; left time: 1761.1016s
	iters: 400, epoch: 1 | loss: 0.0832291
	speed: 0.0432s/iter; left time: 1768.8367s
Epoch: 1 cost time: 20.403488159179688
Epoch: 1, Steps: 413 | Train Loss: 0.573 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (inf --> -0.964983).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0702070
	speed: 0.1527s/iter; left time: 6229.5536s
	iters: 200, epoch: 2 | loss: 0.0323568
	speed: 0.0435s/iter; left time: 1768.2405s
	iters: 300, epoch: 2 | loss: 0.0557241
	speed: 0.0435s/iter; left time: 1763.7424s
	iters: 400, epoch: 2 | loss: 0.0586464
	speed: 0.0430s/iter; left time: 1740.1264s
Epoch: 2 cost time: 18.360551118850708
Epoch: 2, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
Validation loss decreased (-0.964983 --> -0.969986).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0321394
	speed: 0.1607s/iter; left time: 6487.8763s
	iters: 200, epoch: 3 | loss: 0.1889271
	speed: 0.0518s/iter; left time: 2085.4130s
	iters: 300, epoch: 3 | loss: 0.0152179
	speed: 0.0467s/iter; left time: 1878.0479s
	iters: 400, epoch: 3 | loss: 0.0956393
	speed: 0.0462s/iter; left time: 1852.5384s
Epoch: 3 cost time: 20.16069746017456
Epoch: 3, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
Validation loss decreased (-0.969986 --> -0.973624).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0148230
	speed: 0.1656s/iter; left time: 6617.5533s
	iters: 200, epoch: 4 | loss: 0.0026571
	speed: 0.0440s/iter; left time: 1755.0175s
	iters: 300, epoch: 4 | loss: 0.0019810
	speed: 0.0428s/iter; left time: 1699.9573s
	iters: 400, epoch: 4 | loss: 0.0128570
	speed: 0.0467s/iter; left time: 1852.2491s
Epoch: 4 cost time: 18.671485900878906
Epoch: 4, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0007554
	speed: 0.1527s/iter; left time: 6038.0024s
	iters: 200, epoch: 5 | loss: 0.1090609
	speed: 0.0462s/iter; left time: 1822.2064s
	iters: 300, epoch: 5 | loss: 0.0051907
	speed: 0.0450s/iter; left time: 1772.1308s
	iters: 400, epoch: 5 | loss: 0.0020257
	speed: 0.0442s/iter; left time: 1734.6605s
Epoch: 5 cost time: 18.652160167694092
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.973624 --> -0.974988).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0009609
	speed: 0.1626s/iter; left time: 6365.0128s
	iters: 200, epoch: 6 | loss: 0.0033153
	speed: 0.0458s/iter; left time: 1787.1538s
	iters: 300, epoch: 6 | loss: 0.0012038
	speed: 0.0446s/iter; left time: 1737.6191s
	iters: 400, epoch: 6 | loss: 0.0002954
	speed: 0.0475s/iter; left time: 1843.5167s
Epoch: 6 cost time: 19.744423866271973
Epoch: 6, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
Validation loss decreased (-0.974988 --> -0.977716).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0118803
	speed: 0.1671s/iter; left time: 6471.3866s
	iters: 200, epoch: 7 | loss: 0.0004937
	speed: 0.0427s/iter; left time: 1648.5703s
	iters: 300, epoch: 7 | loss: 0.0012525
	speed: 0.0433s/iter; left time: 1669.1982s
	iters: 400, epoch: 7 | loss: 0.0002332
	speed: 0.0437s/iter; left time: 1678.8702s
Epoch: 7 cost time: 18.860501289367676
Epoch: 7, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.062 Vali Acc: 0.981 Test Loss: 0.062 Test Acc: 0.981
Validation loss decreased (-0.977716 --> -0.981355).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0001437
	speed: 0.1495s/iter; left time: 5726.4043s
	iters: 200, epoch: 8 | loss: 0.0762574
	speed: 0.0423s/iter; left time: 1617.6732s
	iters: 300, epoch: 8 | loss: 0.0264864
	speed: 0.0436s/iter; left time: 1660.7288s
	iters: 400, epoch: 8 | loss: 0.0000546
	speed: 0.0451s/iter; left time: 1715.5357s
Epoch: 8 cost time: 18.543614387512207
Epoch: 8, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0017029
	speed: 0.1505s/iter; left time: 5704.0437s
	iters: 200, epoch: 9 | loss: 0.0001356
	speed: 0.0503s/iter; left time: 1900.5588s
	iters: 300, epoch: 9 | loss: 0.0015824
	speed: 0.0532s/iter; left time: 2004.7020s
	iters: 400, epoch: 9 | loss: 0.2847998
	speed: 0.0491s/iter; left time: 1844.1394s
Epoch: 9 cost time: 20.921589612960815
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000170
	speed: 0.1807s/iter; left time: 6771.9479s
	iters: 200, epoch: 10 | loss: 0.0000163
	speed: 0.0506s/iter; left time: 1892.1026s
	iters: 300, epoch: 10 | loss: 0.0022782
	speed: 0.0518s/iter; left time: 1930.6079s
	iters: 400, epoch: 10 | loss: 0.0029658
	speed: 0.0485s/iter; left time: 1804.3872s
Epoch: 10 cost time: 21.268009185791016
Epoch: 10, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0075435
	speed: 0.1513s/iter; left time: 5610.4236s
	iters: 200, epoch: 11 | loss: 0.0000748
	speed: 0.0445s/iter; left time: 1644.4547s
	iters: 300, epoch: 11 | loss: 0.0000382
	speed: 0.0436s/iter; left time: 1607.5682s
	iters: 400, epoch: 11 | loss: 0.3941122
	speed: 0.0439s/iter; left time: 1612.4432s
Epoch: 11 cost time: 18.526517152786255
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0003684
	speed: 0.1448s/iter; left time: 5307.8703s
	iters: 200, epoch: 12 | loss: 0.0185014
	speed: 0.0447s/iter; left time: 1633.9545s
	iters: 300, epoch: 12 | loss: 0.0003607
	speed: 0.0449s/iter; left time: 1636.4731s
	iters: 400, epoch: 12 | loss: 0.0000187
	speed: 0.0486s/iter; left time: 1766.5141s
Epoch: 12 cost time: 19.296204328536987
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000022
	speed: 0.1662s/iter; left time: 6023.1137s
	iters: 200, epoch: 13 | loss: 0.0000007
	speed: 0.0492s/iter; left time: 1776.5490s
	iters: 300, epoch: 13 | loss: 0.0000020
	speed: 0.0503s/iter; left time: 1811.5481s
	iters: 400, epoch: 13 | loss: 0.0000075
	speed: 0.0478s/iter; left time: 1717.5743s
Epoch: 13 cost time: 20.301304578781128
Epoch: 13, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000002
	speed: 0.1595s/iter; left time: 5715.0609s
	iters: 200, epoch: 14 | loss: 0.0000364
	speed: 0.0438s/iter; left time: 1564.9945s
	iters: 300, epoch: 14 | loss: 0.0000078
	speed: 0.0460s/iter; left time: 1639.1467s
	iters: 400, epoch: 14 | loss: 0.0065555
	speed: 0.0458s/iter; left time: 1627.4945s
Epoch: 14 cost time: 19.37666630744934
Epoch: 14, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0385416
	speed: 0.1581s/iter; left time: 5598.5714s
	iters: 200, epoch: 15 | loss: 0.0000116
	speed: 0.0452s/iter; left time: 1596.0415s
	iters: 300, epoch: 15 | loss: 0.0000246
	speed: 0.0490s/iter; left time: 1724.8961s
	iters: 400, epoch: 15 | loss: 0.0000046
	speed: 0.0499s/iter; left time: 1753.3843s
Epoch: 15 cost time: 20.016680002212524
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000234
	speed: 0.1793s/iter; left time: 6277.9819s
	iters: 200, epoch: 16 | loss: 0.0000067
	speed: 0.0450s/iter; left time: 1571.7980s
	iters: 300, epoch: 16 | loss: 0.0000492
	speed: 0.0484s/iter; left time: 1685.9721s
	iters: 400, epoch: 16 | loss: 0.0000002
	speed: 0.0505s/iter; left time: 1751.7487s
Epoch: 16 cost time: 20.38858723640442
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.981355 --> -0.987266).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000017
	speed: 0.1581s/iter; left time: 5470.1085s
	iters: 200, epoch: 17 | loss: 0.0001066
	speed: 0.0432s/iter; left time: 1490.6243s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 1555.9600s
	iters: 400, epoch: 17 | loss: 0.0000086
	speed: 0.0426s/iter; left time: 1459.5144s
Epoch: 17 cost time: 18.298221826553345
Epoch: 17, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0001529
	speed: 0.1448s/iter; left time: 4947.6586s
	iters: 200, epoch: 18 | loss: 0.0000053
	speed: 0.0450s/iter; left time: 1534.1799s
	iters: 300, epoch: 18 | loss: 0.0000681
	speed: 0.0445s/iter; left time: 1511.4144s
	iters: 400, epoch: 18 | loss: 0.0000156
	speed: 0.0428s/iter; left time: 1450.1662s
Epoch: 18 cost time: 18.612414360046387
Epoch: 18, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000013
	speed: 0.1545s/iter; left time: 5216.2815s
	iters: 200, epoch: 19 | loss: 0.0000211
	speed: 0.0510s/iter; left time: 1718.1469s
	iters: 300, epoch: 19 | loss: 0.0542367
	speed: 0.0515s/iter; left time: 1729.6681s
	iters: 400, epoch: 19 | loss: 0.0000018
	speed: 0.0491s/iter; left time: 1643.2057s
Epoch: 19 cost time: 20.853343725204468
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0002466
	speed: 0.1876s/iter; left time: 6258.7436s
	iters: 200, epoch: 20 | loss: 0.0000355
	speed: 0.0489s/iter; left time: 1625.8010s
	iters: 300, epoch: 20 | loss: 0.0000004
	speed: 0.0465s/iter; left time: 1542.2211s
	iters: 400, epoch: 20 | loss: 0.0000397
	speed: 0.0467s/iter; left time: 1542.1905s
Epoch: 20 cost time: 20.775447130203247
Epoch: 20, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0486810
	speed: 0.1441s/iter; left time: 4748.0149s
	iters: 200, epoch: 21 | loss: 0.0000072
	speed: 0.0429s/iter; left time: 1409.3095s
	iters: 300, epoch: 21 | loss: 0.0000056
	speed: 0.0450s/iter; left time: 1472.8036s
	iters: 400, epoch: 21 | loss: 0.0000332
	speed: 0.0425s/iter; left time: 1386.5661s
Epoch: 21 cost time: 18.296509504318237
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.141 Vali Acc: 0.974 Test Loss: 0.141 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000014
	speed: 0.1460s/iter; left time: 4749.8118s
	iters: 200, epoch: 22 | loss: 0.0000003
	speed: 0.0456s/iter; left time: 1479.4626s
	iters: 300, epoch: 22 | loss: 0.0000090
	speed: 0.0486s/iter; left time: 1571.1961s
	iters: 400, epoch: 22 | loss: 0.0001422
	speed: 0.0513s/iter; left time: 1654.4292s
Epoch: 22 cost time: 20.046189069747925
Epoch: 22, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000086
	speed: 0.1815s/iter; left time: 5827.3491s
	iters: 200, epoch: 23 | loss: 0.0000750
	speed: 0.0522s/iter; left time: 1671.9698s
	iters: 300, epoch: 23 | loss: 0.0000016
	speed: 0.0519s/iter; left time: 1657.6380s
	iters: 400, epoch: 23 | loss: 0.0000029
	speed: 0.0465s/iter; left time: 1478.3092s
Epoch: 23 cost time: 21.033117532730103
Epoch: 23, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000051
	speed: 0.1464s/iter; left time: 4640.6970s
	iters: 200, epoch: 24 | loss: 0.0078273
	speed: 0.0440s/iter; left time: 1389.5759s
	iters: 300, epoch: 24 | loss: 0.0000014
	speed: 0.0443s/iter; left time: 1395.3859s
	iters: 400, epoch: 24 | loss: 0.0000001
	speed: 0.0431s/iter; left time: 1353.0099s
Epoch: 24 cost time: 18.460824012756348
Epoch: 24, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.983 Test Loss: 0.125 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000063
	speed: 0.1474s/iter; left time: 4612.4416s
	iters: 200, epoch: 25 | loss: 0.0000520
	speed: 0.0435s/iter; left time: 1355.7656s
	iters: 300, epoch: 25 | loss: 0.0002948
	speed: 0.0429s/iter; left time: 1333.7467s
	iters: 400, epoch: 25 | loss: 0.0617554
	speed: 0.0490s/iter; left time: 1519.2479s
Epoch: 25 cost time: 18.859619140625
Epoch: 25, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000421
	speed: 0.1811s/iter; left time: 5592.7557s
	iters: 200, epoch: 26 | loss: 0.0002038
	speed: 0.0475s/iter; left time: 1461.9561s
	iters: 300, epoch: 26 | loss: 0.0000007
	speed: 0.0502s/iter; left time: 1541.1943s
	iters: 400, epoch: 26 | loss: 0.0000002
	speed: 0.0538s/iter; left time: 1645.7936s
Epoch: 26 cost time: 21.405609369277954
Epoch: 26, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 99538
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7387066
	speed: 0.0595s/iter; left time: 2453.3475s
	iters: 200, epoch: 1 | loss: 0.3068632
	speed: 0.0432s/iter; left time: 1777.2647s
	iters: 300, epoch: 1 | loss: 0.4219330
	speed: 0.0429s/iter; left time: 1757.1607s
	iters: 400, epoch: 1 | loss: 0.0800599
	speed: 0.0440s/iter; left time: 1799.4048s
Epoch: 1 cost time: 19.595452070236206
Epoch: 1, Steps: 413 | Train Loss: 0.659 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
Validation loss decreased (inf --> -0.959526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0334685
	speed: 0.1471s/iter; left time: 6000.9576s
	iters: 200, epoch: 2 | loss: 0.0316323
	speed: 0.0476s/iter; left time: 1935.5975s
	iters: 300, epoch: 2 | loss: 0.1634231
	speed: 0.0505s/iter; left time: 2050.9366s
	iters: 400, epoch: 2 | loss: 0.0195642
	speed: 0.0493s/iter; left time: 1997.7385s
Epoch: 2 cost time: 20.648606777191162
Epoch: 2, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.066 Vali Acc: 0.979 Test Loss: 0.066 Test Acc: 0.979
Validation loss decreased (-0.959526 --> -0.979081).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0242430
	speed: 0.1763s/iter; left time: 7117.8880s
	iters: 200, epoch: 3 | loss: 0.1063638
	speed: 0.0502s/iter; left time: 2021.4406s
	iters: 300, epoch: 3 | loss: 0.0429656
	speed: 0.0500s/iter; left time: 2008.3078s
	iters: 400, epoch: 3 | loss: 0.1800275
	speed: 0.0460s/iter; left time: 1843.0035s
Epoch: 3 cost time: 20.559326648712158
Epoch: 3, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0127252
	speed: 0.1523s/iter; left time: 6085.5030s
	iters: 200, epoch: 4 | loss: 0.0028647
	speed: 0.0424s/iter; left time: 1691.9454s
	iters: 300, epoch: 4 | loss: 0.0029805
	speed: 0.0355s/iter; left time: 1412.2859s
	iters: 400, epoch: 4 | loss: 0.7607023
	speed: 0.0375s/iter; left time: 1486.4195s
Epoch: 4 cost time: 17.317941188812256
Epoch: 4, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0012020
	speed: 0.1352s/iter; left time: 5347.4725s
	iters: 200, epoch: 5 | loss: 0.0196996
	speed: 0.0455s/iter; left time: 1793.0250s
	iters: 300, epoch: 5 | loss: 0.0685270
	speed: 0.0416s/iter; left time: 1638.5698s
	iters: 400, epoch: 5 | loss: 0.0053268
	speed: 0.0439s/iter; left time: 1723.3371s
Epoch: 5 cost time: 18.17127275466919
Epoch: 5, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
Validation loss decreased (-0.979081 --> -0.981809).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0014841
	speed: 0.1600s/iter; left time: 6260.4639s
	iters: 200, epoch: 6 | loss: 0.0122546
	speed: 0.0433s/iter; left time: 1690.6754s
	iters: 300, epoch: 6 | loss: 0.0006068
	speed: 0.0455s/iter; left time: 1772.8802s
	iters: 400, epoch: 6 | loss: 0.0000194
	speed: 0.0440s/iter; left time: 1710.3238s
Epoch: 6 cost time: 19.00408625602722
Epoch: 6, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.124 Vali Acc: 0.966 Test Loss: 0.124 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0002791
	speed: 0.1559s/iter; left time: 6035.2872s
	iters: 200, epoch: 7 | loss: 0.0012105
	speed: 0.0437s/iter; left time: 1686.2213s
	iters: 300, epoch: 7 | loss: 0.0006586
	speed: 0.0428s/iter; left time: 1647.8203s
	iters: 400, epoch: 7 | loss: 0.0188589
	speed: 0.0422s/iter; left time: 1621.4114s
Epoch: 7 cost time: 18.152594327926636
Epoch: 7, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0027584
	speed: 0.1382s/iter; left time: 5294.2844s
	iters: 200, epoch: 8 | loss: 0.0048865
	speed: 0.0393s/iter; left time: 1502.7322s
	iters: 300, epoch: 8 | loss: 0.0000093
	speed: 0.0429s/iter; left time: 1633.3403s
	iters: 400, epoch: 8 | loss: 0.0000119
	speed: 0.0434s/iter; left time: 1650.6112s
Epoch: 8 cost time: 17.62845253944397
Epoch: 8, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0070942
	speed: 0.1379s/iter; left time: 5226.3738s
	iters: 200, epoch: 9 | loss: 0.0737172
	speed: 0.0419s/iter; left time: 1583.1814s
	iters: 300, epoch: 9 | loss: 0.0050040
	speed: 0.0424s/iter; left time: 1600.0372s
	iters: 400, epoch: 9 | loss: 0.0018103
	speed: 0.0420s/iter; left time: 1577.6421s
Epoch: 9 cost time: 17.681697368621826
Epoch: 9, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0014935
	speed: 0.1358s/iter; left time: 5090.6388s
	iters: 200, epoch: 10 | loss: 0.0001073
	speed: 0.0428s/iter; left time: 1601.3130s
	iters: 300, epoch: 10 | loss: 0.0002963
	speed: 0.0437s/iter; left time: 1629.2767s
	iters: 400, epoch: 10 | loss: 0.0009350
	speed: 0.0442s/iter; left time: 1642.8574s
Epoch: 10 cost time: 18.12274694442749
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0231644
	speed: 0.1485s/iter; left time: 5506.7293s
	iters: 200, epoch: 11 | loss: 0.0002515
	speed: 0.0437s/iter; left time: 1615.0602s
	iters: 300, epoch: 11 | loss: 0.0779463
	speed: 0.0434s/iter; left time: 1599.9184s
	iters: 400, epoch: 11 | loss: 0.0000320
	speed: 0.0382s/iter; left time: 1405.3869s
Epoch: 11 cost time: 17.8078670501709
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0014197
	speed: 0.1427s/iter; left time: 5231.8438s
	iters: 200, epoch: 12 | loss: 0.0000395
	speed: 0.0419s/iter; left time: 1529.9749s
	iters: 300, epoch: 12 | loss: 0.0001462
	speed: 0.0419s/iter; left time: 1528.2328s
	iters: 400, epoch: 12 | loss: 0.0000573
	speed: 0.0410s/iter; left time: 1489.6789s
Epoch: 12 cost time: 17.9295756816864
Epoch: 12, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0004906
	speed: 0.1441s/iter; left time: 5222.5006s
	iters: 200, epoch: 13 | loss: 0.1044790
	speed: 0.0389s/iter; left time: 1406.6186s
	iters: 300, epoch: 13 | loss: 0.0000393
	speed: 0.0390s/iter; left time: 1406.4101s
	iters: 400, epoch: 13 | loss: 0.0002058
	speed: 0.0379s/iter; left time: 1360.7716s
Epoch: 13 cost time: 16.50842547416687
Epoch: 13, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0075843
	speed: 0.1472s/iter; left time: 5275.5953s
	iters: 200, epoch: 14 | loss: 0.0063180
	speed: 0.0408s/iter; left time: 1459.0734s
	iters: 300, epoch: 14 | loss: 0.0000237
	speed: 0.0414s/iter; left time: 1474.8842s
	iters: 400, epoch: 14 | loss: 0.0026306
	speed: 0.0409s/iter; left time: 1454.7595s
Epoch: 14 cost time: 17.626647233963013
Epoch: 14, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000568
	speed: 0.1534s/iter; left time: 5432.6704s
	iters: 200, epoch: 15 | loss: 0.0000111
	speed: 0.0394s/iter; left time: 1391.9931s
	iters: 300, epoch: 15 | loss: 0.0028580
	speed: 0.0392s/iter; left time: 1380.8091s
	iters: 400, epoch: 15 | loss: 0.0000028
	speed: 0.0383s/iter; left time: 1345.2142s
Epoch: 15 cost time: 16.75903844833374
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
Validation loss decreased (-0.981809 --> -0.982264).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0001804
	speed: 0.1303s/iter; left time: 4559.5394s
	iters: 200, epoch: 16 | loss: 0.0000031
	speed: 0.0399s/iter; left time: 1391.0794s
	iters: 300, epoch: 16 | loss: 0.0000228
	speed: 0.0410s/iter; left time: 1426.5935s
	iters: 400, epoch: 16 | loss: 0.0000227
	speed: 0.0399s/iter; left time: 1386.1437s
Epoch: 16 cost time: 17.095641374588013
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.984 Test Loss: 0.089 Test Acc: 0.984
Validation loss decreased (-0.982264 --> -0.983628).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0041672
	speed: 0.1305s/iter; left time: 4515.8184s
	iters: 200, epoch: 17 | loss: 0.0006929
	speed: 0.0405s/iter; left time: 1397.5016s
	iters: 300, epoch: 17 | loss: 0.0000047
	speed: 0.0446s/iter; left time: 1532.5893s
	iters: 400, epoch: 17 | loss: 0.0000004
	speed: 0.0443s/iter; left time: 1520.1194s
Epoch: 17 cost time: 17.90643286705017
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000021
	speed: 0.1411s/iter; left time: 4822.3018s
	iters: 200, epoch: 18 | loss: 0.0001956
	speed: 0.0455s/iter; left time: 1551.1349s
	iters: 300, epoch: 18 | loss: 0.0000166
	speed: 0.0457s/iter; left time: 1552.9911s
	iters: 400, epoch: 18 | loss: 0.0641537
	speed: 0.0417s/iter; left time: 1411.2926s
Epoch: 18 cost time: 18.403122186660767
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000016
	speed: 0.1428s/iter; left time: 4823.4949s
	iters: 200, epoch: 19 | loss: 0.0003687
	speed: 0.0386s/iter; left time: 1298.7620s
	iters: 300, epoch: 19 | loss: 0.0054940
	speed: 0.0398s/iter; left time: 1337.2079s
	iters: 400, epoch: 19 | loss: 0.0000273
	speed: 0.0414s/iter; left time: 1386.0155s
Epoch: 19 cost time: 16.945472478866577
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.984993).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000279
	speed: 0.1348s/iter; left time: 4494.5124s
	iters: 200, epoch: 20 | loss: 0.0001044
	speed: 0.0398s/iter; left time: 1324.1197s
	iters: 300, epoch: 20 | loss: 0.0000008
	speed: 0.0397s/iter; left time: 1315.5973s
	iters: 400, epoch: 20 | loss: 0.0000199
	speed: 0.0400s/iter; left time: 1323.3572s
Epoch: 20 cost time: 16.701958656311035
Epoch: 20, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000274
	speed: 0.1501s/iter; left time: 4945.3076s
	iters: 200, epoch: 21 | loss: 0.0790764
	speed: 0.0422s/iter; left time: 1385.4021s
	iters: 300, epoch: 21 | loss: 0.0066033
	speed: 0.0401s/iter; left time: 1313.2775s
	iters: 400, epoch: 21 | loss: 0.0000802
	speed: 0.0428s/iter; left time: 1397.8304s
Epoch: 21 cost time: 18.13760757446289
Epoch: 21, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.1512s/iter; left time: 4916.8928s
	iters: 200, epoch: 22 | loss: 0.0011138
	speed: 0.0391s/iter; left time: 1268.7848s
	iters: 300, epoch: 22 | loss: 0.0000035
	speed: 0.0391s/iter; left time: 1263.0013s
	iters: 400, epoch: 22 | loss: 0.0000186
	speed: 0.0391s/iter; left time: 1260.9795s
Epoch: 22 cost time: 16.758042812347412
Epoch: 22, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0003661
	speed: 0.1376s/iter; left time: 4418.3611s
	iters: 200, epoch: 23 | loss: 0.0013953
	speed: 0.0395s/iter; left time: 1263.8762s
	iters: 300, epoch: 23 | loss: 0.0000137
	speed: 0.0409s/iter; left time: 1306.1092s
	iters: 400, epoch: 23 | loss: 0.0000279
	speed: 0.0413s/iter; left time: 1314.9060s
Epoch: 23 cost time: 17.348533391952515
Epoch: 23, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000007
	speed: 0.1334s/iter; left time: 4227.8971s
	iters: 200, epoch: 24 | loss: 0.0000052
	speed: 0.0437s/iter; left time: 1379.6998s
	iters: 300, epoch: 24 | loss: 0.0000003
	speed: 0.0432s/iter; left time: 1359.6628s
	iters: 400, epoch: 24 | loss: 0.0000132
	speed: 0.0431s/iter; left time: 1352.7934s
Epoch: 24 cost time: 18.08843469619751
Epoch: 24, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0116158
	speed: 0.1533s/iter; left time: 4797.7343s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1529.0110s
	iters: 300, epoch: 25 | loss: 0.0341669
	speed: 0.0458s/iter; left time: 1425.1115s
	iters: 400, epoch: 25 | loss: 0.2540214
	speed: 0.0384s/iter; left time: 1189.9120s
Epoch: 25 cost time: 18.822077751159668
Epoch: 25, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0001442
	speed: 0.1460s/iter; left time: 4507.6565s
	iters: 200, epoch: 26 | loss: 0.0086848
	speed: 0.0399s/iter; left time: 1227.9063s
	iters: 300, epoch: 26 | loss: 0.0000057
	speed: 0.0408s/iter; left time: 1252.1029s
	iters: 400, epoch: 26 | loss: 0.1912387
	speed: 0.0399s/iter; left time: 1221.4679s
Epoch: 26 cost time: 17.090576648712158
Epoch: 26, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.6582971
	speed: 0.1304s/iter; left time: 3971.4797s
	iters: 200, epoch: 27 | loss: 0.0000005
	speed: 0.0415s/iter; left time: 1258.9231s
	iters: 300, epoch: 27 | loss: 0.0000061
	speed: 0.0416s/iter; left time: 1258.2020s
	iters: 400, epoch: 27 | loss: 0.0000042
	speed: 0.0432s/iter; left time: 1302.5009s
Epoch: 27 cost time: 17.586273670196533
Epoch: 27, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000011
	speed: 0.1549s/iter; left time: 4653.8614s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1359.8287s
	iters: 300, epoch: 28 | loss: 0.0000010
	speed: 0.0446s/iter; left time: 1330.4344s
	iters: 400, epoch: 28 | loss: 0.0001095
	speed: 0.0475s/iter; left time: 1414.5269s
Epoch: 28 cost time: 19.07356548309326
Epoch: 28, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.984 Test Loss: 0.096 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000087
	speed: 0.1403s/iter; left time: 4158.8045s
	iters: 200, epoch: 29 | loss: 0.0000009
	speed: 0.0422s/iter; left time: 1247.4967s
	iters: 300, epoch: 29 | loss: 0.0000001
	speed: 0.0426s/iter; left time: 1254.3360s
	iters: 400, epoch: 29 | loss: 0.0000198
	speed: 0.0395s/iter; left time: 1158.3360s
Epoch: 29 cost time: 17.453718900680542
Epoch: 29, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.984 Test Loss: 0.104 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 99538
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8296292
	speed: 0.0539s/iter; left time: 2219.4065s
	iters: 200, epoch: 1 | loss: 0.4170507
	speed: 0.0384s/iter; left time: 1580.3281s
	iters: 300, epoch: 1 | loss: 0.4340753
	speed: 0.0365s/iter; left time: 1496.3464s
	iters: 400, epoch: 1 | loss: 0.2692581
	speed: 0.0355s/iter; left time: 1453.3908s
Epoch: 1 cost time: 16.977129220962524
Epoch: 1, Steps: 413 | Train Loss: 0.692 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (inf --> -0.964983).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0238688
	speed: 0.1221s/iter; left time: 4978.5617s
	iters: 200, epoch: 2 | loss: 0.1374803
	speed: 0.0368s/iter; left time: 1498.1432s
	iters: 300, epoch: 2 | loss: 0.0149064
	speed: 0.0381s/iter; left time: 1546.0026s
	iters: 400, epoch: 2 | loss: 0.0302351
	speed: 0.0384s/iter; left time: 1553.7405s
Epoch: 2 cost time: 15.91284441947937
Epoch: 2, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.964983 --> -0.979535).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1847833
	speed: 0.1212s/iter; left time: 4894.8274s
	iters: 200, epoch: 3 | loss: 0.0167146
	speed: 0.0378s/iter; left time: 1521.2160s
	iters: 300, epoch: 3 | loss: 0.0535113
	speed: 0.0378s/iter; left time: 1516.6647s
	iters: 400, epoch: 3 | loss: 0.0065375
	speed: 0.0389s/iter; left time: 1559.7851s
Epoch: 3 cost time: 16.0975923538208
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.980900).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0195491
	speed: 0.1211s/iter; left time: 4840.0864s
	iters: 200, epoch: 4 | loss: 0.0043016
	speed: 0.0386s/iter; left time: 1539.2847s
	iters: 300, epoch: 4 | loss: 0.0281097
	speed: 0.0371s/iter; left time: 1476.9105s
	iters: 400, epoch: 4 | loss: 0.0030183
	speed: 0.0365s/iter; left time: 1446.7046s
Epoch: 4 cost time: 15.930799007415771
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0220973
	speed: 0.1221s/iter; left time: 4829.1290s
	iters: 200, epoch: 5 | loss: 0.0398430
	speed: 0.0420s/iter; left time: 1656.2304s
	iters: 300, epoch: 5 | loss: 0.0108774
	speed: 0.0377s/iter; left time: 1484.6576s
	iters: 400, epoch: 5 | loss: 0.0177679
	speed: 0.0370s/iter; left time: 1453.0473s
Epoch: 5 cost time: 16.56530785560608
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0240254
	speed: 0.1303s/iter; left time: 5099.1529s
	iters: 200, epoch: 6 | loss: 0.0071160
	speed: 0.0384s/iter; left time: 1499.8863s
	iters: 300, epoch: 6 | loss: 0.0003046
	speed: 0.0402s/iter; left time: 1563.3295s
	iters: 400, epoch: 6 | loss: 0.0055151
	speed: 0.0420s/iter; left time: 1631.2398s
Epoch: 6 cost time: 16.996156454086304
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0004203
	speed: 0.1234s/iter; left time: 4778.6992s
	iters: 200, epoch: 7 | loss: 0.0055162
	speed: 0.0376s/iter; left time: 1452.4992s
	iters: 300, epoch: 7 | loss: 0.0024869
	speed: 0.0396s/iter; left time: 1527.2148s
	iters: 400, epoch: 7 | loss: 0.0689385
	speed: 0.0417s/iter; left time: 1603.7830s
Epoch: 7 cost time: 16.643344163894653
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0003511
	speed: 0.1208s/iter; left time: 4626.8306s
	iters: 200, epoch: 8 | loss: 0.0018766
	speed: 0.0376s/iter; left time: 1438.1556s
	iters: 300, epoch: 8 | loss: 0.0011921
	speed: 0.0359s/iter; left time: 1367.2072s
	iters: 400, epoch: 8 | loss: 0.0088898
	speed: 0.0371s/iter; left time: 1409.8094s
Epoch: 8 cost time: 15.851118564605713
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0319997
	speed: 0.1234s/iter; left time: 4675.6228s
	iters: 200, epoch: 9 | loss: 0.0001157
	speed: 0.0375s/iter; left time: 1418.4275s
	iters: 300, epoch: 9 | loss: 0.0532970
	speed: 0.0378s/iter; left time: 1423.4227s
	iters: 400, epoch: 9 | loss: 0.0000373
	speed: 0.0377s/iter; left time: 1417.1480s
Epoch: 9 cost time: 16.023678064346313
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0002116
	speed: 0.1230s/iter; left time: 4611.9760s
	iters: 200, epoch: 10 | loss: 0.0061965
	speed: 0.0373s/iter; left time: 1394.0801s
	iters: 300, epoch: 10 | loss: 0.0350036
	speed: 0.0378s/iter; left time: 1407.8360s
	iters: 400, epoch: 10 | loss: 0.0084467
	speed: 0.0386s/iter; left time: 1433.6549s
Epoch: 10 cost time: 15.96140432357788
Epoch: 10, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000409
	speed: 0.1211s/iter; left time: 4488.2184s
	iters: 200, epoch: 11 | loss: 0.0001326
	speed: 0.0368s/iter; left time: 1361.8041s
	iters: 300, epoch: 11 | loss: 0.0033978
	speed: 0.0359s/iter; left time: 1322.9684s
	iters: 400, epoch: 11 | loss: 0.0000227
	speed: 0.0366s/iter; left time: 1346.6327s
Epoch: 11 cost time: 15.633341789245605
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0007243
	speed: 0.1210s/iter; left time: 4436.2119s
	iters: 200, epoch: 12 | loss: 0.0002576
	speed: 0.0420s/iter; left time: 1533.6790s
	iters: 300, epoch: 12 | loss: 0.0014301
	speed: 0.0404s/iter; left time: 1473.0513s
	iters: 400, epoch: 12 | loss: 0.0000094
	speed: 0.0388s/iter; left time: 1411.8308s
Epoch: 12 cost time: 16.934287548065186
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0002362
	speed: 0.1264s/iter; left time: 4582.6484s
	iters: 200, epoch: 13 | loss: 0.0003120
	speed: 0.0414s/iter; left time: 1494.9766s
	iters: 300, epoch: 13 | loss: 0.0052287
	speed: 0.0394s/iter; left time: 1419.6130s
	iters: 400, epoch: 13 | loss: 0.0003923
	speed: 0.0385s/iter; left time: 1382.2359s
Epoch: 13 cost time: 16.64014172554016
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 299698
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8328639
	speed: 0.0565s/iter; left time: 2327.7829s
	iters: 200, epoch: 1 | loss: 0.4542804
	speed: 0.0365s/iter; left time: 1499.1122s
	iters: 300, epoch: 1 | loss: 0.4421103
	speed: 0.0366s/iter; left time: 1499.1686s
	iters: 400, epoch: 1 | loss: 0.2684248
	speed: 0.0365s/iter; left time: 1491.8752s
Epoch: 1 cost time: 17.132440090179443
Epoch: 1, Steps: 413 | Train Loss: 0.695 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0139573
	speed: 0.1165s/iter; left time: 4752.8890s
	iters: 200, epoch: 2 | loss: 0.1299744
	speed: 0.0355s/iter; left time: 1443.1146s
	iters: 300, epoch: 2 | loss: 0.0183817
	speed: 0.0388s/iter; left time: 1572.9421s
	iters: 400, epoch: 2 | loss: 0.0321292
	speed: 0.0377s/iter; left time: 1526.2277s
Epoch: 2 cost time: 15.75200605392456
Epoch: 2, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
Validation loss decreased (-0.962709 --> -0.973623).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1849550
	speed: 0.1220s/iter; left time: 4925.3843s
	iters: 200, epoch: 3 | loss: 0.0425313
	speed: 0.0380s/iter; left time: 1530.4817s
	iters: 300, epoch: 3 | loss: 0.0455978
	speed: 0.0378s/iter; left time: 1519.9159s
	iters: 400, epoch: 3 | loss: 0.0036253
	speed: 0.0385s/iter; left time: 1541.6646s
Epoch: 3 cost time: 16.075954914093018
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
Validation loss decreased (-0.973623 --> -0.976352).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0073913
	speed: 0.1163s/iter; left time: 4645.9436s
	iters: 200, epoch: 4 | loss: 0.0176176
	speed: 0.0376s/iter; left time: 1497.5029s
	iters: 300, epoch: 4 | loss: 0.0720270
	speed: 0.0369s/iter; left time: 1467.8907s
	iters: 400, epoch: 4 | loss: 0.0022742
	speed: 0.0368s/iter; left time: 1458.7943s
Epoch: 4 cost time: 15.62808084487915
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.976352 --> -0.979536).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0541233
	speed: 0.1210s/iter; left time: 4784.9199s
	iters: 200, epoch: 5 | loss: 0.0178732
	speed: 0.0383s/iter; left time: 1509.0074s
	iters: 300, epoch: 5 | loss: 0.0080031
	speed: 0.0382s/iter; left time: 1504.4202s
	iters: 400, epoch: 5 | loss: 0.0245408
	speed: 0.0405s/iter; left time: 1591.4300s
Epoch: 5 cost time: 16.706549644470215
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0053447
	speed: 0.1201s/iter; left time: 4699.8478s
	iters: 200, epoch: 6 | loss: 0.0026570
	speed: 0.0382s/iter; left time: 1492.1457s
	iters: 300, epoch: 6 | loss: 0.0005004
	speed: 0.0399s/iter; left time: 1552.5636s
	iters: 400, epoch: 6 | loss: 0.0046369
	speed: 0.0401s/iter; left time: 1556.8559s
Epoch: 6 cost time: 16.638964414596558
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0011693
	speed: 0.1269s/iter; left time: 4915.3560s
	iters: 200, epoch: 7 | loss: 0.0124733
	speed: 0.0410s/iter; left time: 1584.2271s
	iters: 300, epoch: 7 | loss: 0.0007935
	speed: 0.0400s/iter; left time: 1541.7343s
	iters: 400, epoch: 7 | loss: 0.0223555
	speed: 0.0361s/iter; left time: 1386.1676s
Epoch: 7 cost time: 16.46265959739685
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0043229
	speed: 0.1194s/iter; left time: 4573.5935s
	iters: 200, epoch: 8 | loss: 0.0020710
	speed: 0.0364s/iter; left time: 1391.5328s
	iters: 300, epoch: 8 | loss: 0.0033310
	speed: 0.0366s/iter; left time: 1395.2557s
	iters: 400, epoch: 8 | loss: 0.0167703
	speed: 0.0369s/iter; left time: 1403.5523s
Epoch: 8 cost time: 15.581210613250732
Epoch: 8, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0017323
	speed: 0.1182s/iter; left time: 4478.6101s
	iters: 200, epoch: 9 | loss: 0.0002146
	speed: 0.0370s/iter; left time: 1400.1704s
	iters: 300, epoch: 9 | loss: 0.0020299
	speed: 0.0358s/iter; left time: 1349.0186s
	iters: 400, epoch: 9 | loss: 0.0006530
	speed: 0.0374s/iter; left time: 1407.2132s
Epoch: 9 cost time: 15.618533849716187
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0100373
	speed: 0.1158s/iter; left time: 4339.3249s
	iters: 200, epoch: 10 | loss: 0.0564722
	speed: 0.0381s/iter; left time: 1425.0761s
	iters: 300, epoch: 10 | loss: 0.0006419
	speed: 0.0376s/iter; left time: 1402.3014s
	iters: 400, epoch: 10 | loss: 0.1243622
	speed: 0.0368s/iter; left time: 1367.0995s
Epoch: 10 cost time: 15.828999042510986
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0001721
	speed: 0.1241s/iter; left time: 4601.6619s
	iters: 200, epoch: 11 | loss: 0.0002189
	speed: 0.0377s/iter; left time: 1392.1903s
	iters: 300, epoch: 11 | loss: 0.0041663
	speed: 0.0357s/iter; left time: 1316.0673s
	iters: 400, epoch: 11 | loss: 0.0480413
	speed: 0.0363s/iter; left time: 1333.0709s
Epoch: 11 cost time: 15.651211977005005
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0008931
	speed: 0.1218s/iter; left time: 4464.4588s
	iters: 200, epoch: 12 | loss: 0.0102268
	speed: 0.0397s/iter; left time: 1452.1323s
	iters: 300, epoch: 12 | loss: 0.0005650
	speed: 0.0379s/iter; left time: 1380.3230s
	iters: 400, epoch: 12 | loss: 0.0017949
	speed: 0.0390s/iter; left time: 1417.1314s
Epoch: 12 cost time: 16.513545989990234
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0020201
	speed: 0.1221s/iter; left time: 4426.5316s
	iters: 200, epoch: 13 | loss: 0.0000420
	speed: 0.0396s/iter; left time: 1431.5564s
	iters: 300, epoch: 13 | loss: 0.0236361
	speed: 0.0390s/iter; left time: 1405.1351s
	iters: 400, epoch: 13 | loss: 0.0036484
	speed: 0.0387s/iter; left time: 1389.7871s
Epoch: 13 cost time: 16.56675934791565
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0008178
	speed: 0.1283s/iter; left time: 4597.6860s
	iters: 200, epoch: 14 | loss: 0.0000587
	speed: 0.0376s/iter; left time: 1344.5413s
	iters: 300, epoch: 14 | loss: 0.0000567
	speed: 0.0392s/iter; left time: 1395.4726s
	iters: 400, epoch: 14 | loss: 0.0125199
	speed: 0.0389s/iter; left time: 1380.5579s
Epoch: 14 cost time: 16.299500226974487
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
Validation loss decreased (-0.979536 --> -0.984083).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0052856
	speed: 0.1254s/iter; left time: 4441.5048s
	iters: 200, epoch: 15 | loss: 0.0015743
	speed: 0.0366s/iter; left time: 1293.4890s
	iters: 300, epoch: 15 | loss: 0.0000238
	speed: 0.0371s/iter; left time: 1306.1407s
	iters: 400, epoch: 15 | loss: 0.0004326
	speed: 0.0373s/iter; left time: 1309.2913s
Epoch: 15 cost time: 15.716270923614502
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.984 Test Loss: 0.092 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0001327
	speed: 0.1154s/iter; left time: 4041.0515s
	iters: 200, epoch: 16 | loss: 0.0001228
	speed: 0.0365s/iter; left time: 1274.4231s
	iters: 300, epoch: 16 | loss: 0.0007506
	speed: 0.0366s/iter; left time: 1273.0734s
	iters: 400, epoch: 16 | loss: 0.0000644
	speed: 0.0364s/iter; left time: 1263.2245s
Epoch: 16 cost time: 15.784388065338135
Epoch: 16, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0001050
	speed: 0.1169s/iter; left time: 4042.7654s
	iters: 200, epoch: 17 | loss: 0.0042928
	speed: 0.0349s/iter; left time: 1203.7637s
	iters: 300, epoch: 17 | loss: 0.0341476
	speed: 0.0379s/iter; left time: 1304.9696s
	iters: 400, epoch: 17 | loss: 0.0018057
	speed: 0.0381s/iter; left time: 1307.1927s
Epoch: 17 cost time: 15.565740823745728
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0008388
	speed: 0.1219s/iter; left time: 4166.7088s
	iters: 200, epoch: 18 | loss: 0.0126282
	speed: 0.0380s/iter; left time: 1295.3708s
	iters: 300, epoch: 18 | loss: 0.0068262
	speed: 0.0385s/iter; left time: 1309.3520s
	iters: 400, epoch: 18 | loss: 0.0006957
	speed: 0.0371s/iter; left time: 1258.5908s
Epoch: 18 cost time: 16.092665910720825
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.148 Vali Acc: 0.979 Test Loss: 0.148 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000022
	speed: 0.1241s/iter; left time: 4191.7283s
	iters: 200, epoch: 19 | loss: 0.0017448
	speed: 0.0382s/iter; left time: 1286.7153s
	iters: 300, epoch: 19 | loss: 0.0000268
	speed: 0.0388s/iter; left time: 1301.4096s
	iters: 400, epoch: 19 | loss: 0.0000201
	speed: 0.0384s/iter; left time: 1285.7358s
Epoch: 19 cost time: 16.127084255218506
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0002087
	speed: 0.1151s/iter; left time: 3840.4471s
	iters: 200, epoch: 20 | loss: 0.0003788
	speed: 0.0372s/iter; left time: 1236.6409s
	iters: 300, epoch: 20 | loss: 0.0000029
	speed: 0.0399s/iter; left time: 1323.3537s
	iters: 400, epoch: 20 | loss: 0.0008853
	speed: 0.0383s/iter; left time: 1265.5153s
Epoch: 20 cost time: 16.181559801101685
Epoch: 20, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0003007
	speed: 0.1196s/iter; left time: 3939.2029s
	iters: 200, epoch: 21 | loss: 0.0000081
	speed: 0.0372s/iter; left time: 1221.8431s
	iters: 300, epoch: 21 | loss: 0.0009071
	speed: 0.0395s/iter; left time: 1293.1349s
	iters: 400, epoch: 21 | loss: 0.0000017
	speed: 0.0385s/iter; left time: 1255.8972s
Epoch: 21 cost time: 16.286458492279053
Epoch: 21, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.139 Vali Acc: 0.979 Test Loss: 0.139 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000020
	speed: 0.1217s/iter; left time: 3958.4424s
	iters: 200, epoch: 22 | loss: 0.0283965
	speed: 0.0396s/iter; left time: 1283.8794s
	iters: 300, epoch: 22 | loss: 0.0000310
	speed: 0.0379s/iter; left time: 1224.8862s
	iters: 400, epoch: 22 | loss: 0.0221531
	speed: 0.0372s/iter; left time: 1198.1705s
Epoch: 22 cost time: 16.19732904434204
Epoch: 22, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000703
	speed: 0.1192s/iter; left time: 3827.1666s
	iters: 200, epoch: 23 | loss: 0.0000081
	speed: 0.0377s/iter; left time: 1207.9372s
	iters: 300, epoch: 23 | loss: 0.0003728
	speed: 0.0363s/iter; left time: 1157.2165s
	iters: 400, epoch: 23 | loss: 0.0934753
	speed: 0.0346s/iter; left time: 1101.4583s
Epoch: 23 cost time: 15.584453105926514
Epoch: 23, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.986 Test Loss: 0.083 Test Acc: 0.986
Validation loss decreased (-0.984083 --> -0.985902).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000315
	speed: 0.1151s/iter; left time: 3649.4548s
	iters: 200, epoch: 24 | loss: 0.0001970
	speed: 0.0376s/iter; left time: 1187.8054s
	iters: 300, epoch: 24 | loss: 0.0005767
	speed: 0.0380s/iter; left time: 1197.1016s
	iters: 400, epoch: 24 | loss: 0.0002944
	speed: 0.0375s/iter; left time: 1176.2962s
Epoch: 24 cost time: 15.849233388900757
Epoch: 24, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.982 Test Loss: 0.102 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000047
	speed: 0.1193s/iter; left time: 3731.5492s
	iters: 200, epoch: 25 | loss: 0.0012043
	speed: 0.0366s/iter; left time: 1141.0015s
	iters: 300, epoch: 25 | loss: 0.0000247
	speed: 0.0374s/iter; left time: 1162.8174s
	iters: 400, epoch: 25 | loss: 0.0000207
	speed: 0.0392s/iter; left time: 1214.6976s
Epoch: 25 cost time: 16.153693437576294
Epoch: 25, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0007446
	speed: 0.1249s/iter; left time: 3857.0759s
	iters: 200, epoch: 26 | loss: 0.0000226
	speed: 0.0387s/iter; left time: 1192.5665s
	iters: 300, epoch: 26 | loss: 0.0019219
	speed: 0.0352s/iter; left time: 1080.6951s
	iters: 400, epoch: 26 | loss: 0.0002627
	speed: 0.0348s/iter; left time: 1064.4511s
Epoch: 26 cost time: 15.99824047088623
Epoch: 26, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000766
	speed: 0.1298s/iter; left time: 3955.4809s
	iters: 200, epoch: 27 | loss: 0.0065840
	speed: 0.0309s/iter; left time: 936.7741s
	iters: 300, epoch: 27 | loss: 0.0003022
	speed: 0.0305s/iter; left time: 922.2391s
	iters: 400, epoch: 27 | loss: 0.0001758
	speed: 0.0342s/iter; left time: 1030.3291s
Epoch: 27 cost time: 14.249725818634033
Epoch: 27, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.969 Test Loss: 0.186 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0001756
	speed: 0.0975s/iter; left time: 2929.7068s
	iters: 200, epoch: 28 | loss: 0.0000048
	speed: 0.0366s/iter; left time: 1095.9395s
	iters: 300, epoch: 28 | loss: 0.0026049
	speed: 0.0363s/iter; left time: 1082.3503s
	iters: 400, epoch: 28 | loss: 0.0007576
	speed: 0.0361s/iter; left time: 1072.9017s
Epoch: 28 cost time: 15.176787853240967
Epoch: 28, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1240s/iter; left time: 3675.7860s
	iters: 200, epoch: 29 | loss: 0.0017522
	speed: 0.0402s/iter; left time: 1188.2223s
	iters: 300, epoch: 29 | loss: 0.0000091
	speed: 0.0372s/iter; left time: 1094.1675s
	iters: 400, epoch: 29 | loss: 0.0000528
	speed: 0.0386s/iter; left time: 1133.3381s
Epoch: 29 cost time: 16.56381368637085
Epoch: 29, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0922298
	speed: 0.1238s/iter; left time: 3616.8626s
	iters: 200, epoch: 30 | loss: 0.0014739
	speed: 0.0369s/iter; left time: 1075.2731s
	iters: 300, epoch: 30 | loss: 0.0279634
	speed: 0.0367s/iter; left time: 1065.1642s
	iters: 400, epoch: 30 | loss: 0.2526382
	speed: 0.0390s/iter; left time: 1129.4764s
Epoch: 30 cost time: 16.03750252723694
Epoch: 30, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.979 Test Loss: 0.161 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000405
	speed: 0.1346s/iter; left time: 3877.8999s
	iters: 200, epoch: 31 | loss: 0.0000127
	speed: 0.0374s/iter; left time: 1073.4418s
	iters: 300, epoch: 31 | loss: 0.1781772
	speed: 0.0403s/iter; left time: 1153.0914s
	iters: 400, epoch: 31 | loss: 0.0000054
	speed: 0.0383s/iter; left time: 1091.8673s
Epoch: 31 cost time: 16.70052719116211
Epoch: 31, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000297
	speed: 0.1341s/iter; left time: 3809.5349s
	iters: 200, epoch: 32 | loss: 0.0000065
	speed: 0.0359s/iter; left time: 1014.9096s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 1021.4005s
	iters: 400, epoch: 32 | loss: 0.0000016
	speed: 0.0371s/iter; left time: 1041.2169s
Epoch: 32 cost time: 15.84954833984375
Epoch: 32, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000116
	speed: 0.1248s/iter; left time: 3493.6613s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1062.5134s
	iters: 300, epoch: 33 | loss: 0.0092045
	speed: 0.0384s/iter; left time: 1067.5761s
	iters: 400, epoch: 33 | loss: 0.0000224
	speed: 0.0387s/iter; left time: 1072.6429s
Epoch: 33 cost time: 16.454543828964233
Epoch: 33, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.139 Vali Acc: 0.980 Test Loss: 0.139 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 299698
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9110587
	speed: 0.0634s/iter; left time: 2612.2113s
	iters: 200, epoch: 1 | loss: 0.5048347
	speed: 0.0399s/iter; left time: 1639.8294s
	iters: 300, epoch: 1 | loss: 0.4138920
	speed: 0.0400s/iter; left time: 1640.2861s
	iters: 400, epoch: 1 | loss: 0.2765047
	speed: 0.0387s/iter; left time: 1582.9895s
Epoch: 1 cost time: 18.829005241394043
Epoch: 1, Steps: 413 | Train Loss: 0.713 Vali Loss: 0.136 Vali Acc: 0.961 Test Loss: 0.136 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0317993
	speed: 0.1352s/iter; left time: 5516.4205s
	iters: 200, epoch: 2 | loss: 0.1411487
	speed: 0.0379s/iter; left time: 1542.7406s
	iters: 300, epoch: 2 | loss: 0.0376767
	speed: 0.0368s/iter; left time: 1495.3279s
	iters: 400, epoch: 2 | loss: 0.0263225
	speed: 0.0382s/iter; left time: 1546.6167s
Epoch: 2 cost time: 16.342236757278442
Epoch: 2, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
Validation loss decreased (-0.960890 --> -0.971350).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2233595
	speed: 0.1223s/iter; left time: 4939.0326s
	iters: 200, epoch: 3 | loss: 0.0700192
	speed: 0.0380s/iter; left time: 1529.3745s
	iters: 300, epoch: 3 | loss: 0.0527526
	speed: 0.0386s/iter; left time: 1550.5354s
	iters: 400, epoch: 3 | loss: 0.0095225
	speed: 0.0362s/iter; left time: 1450.2236s
Epoch: 3 cost time: 15.93074083328247
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
Validation loss decreased (-0.971350 --> -0.974078).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0131955
	speed: 0.1186s/iter; left time: 4738.7531s
	iters: 200, epoch: 4 | loss: 0.0508258
	speed: 0.0399s/iter; left time: 1591.7660s
	iters: 300, epoch: 4 | loss: 0.1049212
	speed: 0.0365s/iter; left time: 1452.2392s
	iters: 400, epoch: 4 | loss: 0.0177267
	speed: 0.0359s/iter; left time: 1422.5013s
Epoch: 4 cost time: 15.872229099273682
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.974078 --> -0.979990).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0119874
	speed: 0.1277s/iter; left time: 5050.7998s
	iters: 200, epoch: 5 | loss: 0.0192340
	speed: 0.0377s/iter; left time: 1486.3014s
	iters: 300, epoch: 5 | loss: 0.0167601
	speed: 0.0379s/iter; left time: 1490.7391s
	iters: 400, epoch: 5 | loss: 0.0067043
	speed: 0.0389s/iter; left time: 1525.5656s
Epoch: 5 cost time: 16.1695454120636
Epoch: 5, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0197734
	speed: 0.1218s/iter; left time: 4766.4359s
	iters: 200, epoch: 6 | loss: 0.0346608
	speed: 0.0358s/iter; left time: 1397.6618s
	iters: 300, epoch: 6 | loss: 0.0009559
	speed: 0.0386s/iter; left time: 1501.8066s
	iters: 400, epoch: 6 | loss: 0.0010908
	speed: 0.0393s/iter; left time: 1525.5033s
Epoch: 6 cost time: 15.936953783035278
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0007109
	speed: 0.1180s/iter; left time: 4570.0662s
	iters: 200, epoch: 7 | loss: 0.0054265
	speed: 0.0399s/iter; left time: 1542.1769s
	iters: 300, epoch: 7 | loss: 0.0161910
	speed: 0.0368s/iter; left time: 1418.7005s
	iters: 400, epoch: 7 | loss: 0.0004168
	speed: 0.0359s/iter; left time: 1380.2761s
Epoch: 7 cost time: 15.978137493133545
Epoch: 7, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0028498
	speed: 0.1205s/iter; left time: 4615.3061s
	iters: 200, epoch: 8 | loss: 0.0006649
	speed: 0.0396s/iter; left time: 1514.0070s
	iters: 300, epoch: 8 | loss: 0.0016988
	speed: 0.0363s/iter; left time: 1382.8476s
	iters: 400, epoch: 8 | loss: 0.0015481
	speed: 0.0361s/iter; left time: 1373.9441s
Epoch: 8 cost time: 15.893813848495483
Epoch: 8, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0118301
	speed: 0.1252s/iter; left time: 4746.2100s
	iters: 200, epoch: 9 | loss: 0.0007158
	speed: 0.0360s/iter; left time: 1359.6793s
	iters: 300, epoch: 9 | loss: 0.0382189
	speed: 0.0358s/iter; left time: 1347.7646s
	iters: 400, epoch: 9 | loss: 0.0002914
	speed: 0.0374s/iter; left time: 1404.8456s
Epoch: 9 cost time: 15.344157695770264
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0212124
	speed: 0.1211s/iter; left time: 4537.9018s
	iters: 200, epoch: 10 | loss: 0.0121560
	speed: 0.0362s/iter; left time: 1351.7168s
	iters: 300, epoch: 10 | loss: 0.0034738
	speed: 0.0353s/iter; left time: 1316.3833s
	iters: 400, epoch: 10 | loss: 0.0193008
	speed: 0.0324s/iter; left time: 1205.4618s
Epoch: 10 cost time: 14.98504090309143
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000982
	speed: 0.1138s/iter; left time: 4219.6966s
	iters: 200, epoch: 11 | loss: 0.0000361
	speed: 0.0359s/iter; left time: 1328.7413s
	iters: 300, epoch: 11 | loss: 0.0964027
	speed: 0.0354s/iter; left time: 1306.0128s
	iters: 400, epoch: 11 | loss: 0.0012949
	speed: 0.0353s/iter; left time: 1299.7290s
Epoch: 11 cost time: 15.324693441390991
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0003205
	speed: 0.1179s/iter; left time: 4322.6027s
	iters: 200, epoch: 12 | loss: 0.0463613
	speed: 0.0353s/iter; left time: 1290.1384s
	iters: 300, epoch: 12 | loss: 0.0038731
	speed: 0.0376s/iter; left time: 1371.5807s
	iters: 400, epoch: 12 | loss: 0.0001312
	speed: 0.0367s/iter; left time: 1332.5347s
Epoch: 12 cost time: 15.514337062835693
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0037530
	speed: 0.1257s/iter; left time: 4554.6748s
	iters: 200, epoch: 13 | loss: 0.0000912
	speed: 0.0392s/iter; left time: 1416.9980s
	iters: 300, epoch: 13 | loss: 0.0072648
	speed: 0.0421s/iter; left time: 1519.0650s
	iters: 400, epoch: 13 | loss: 0.1446814
	speed: 0.0387s/iter; left time: 1389.8451s
Epoch: 13 cost time: 16.714202642440796
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0010837
	speed: 0.1203s/iter; left time: 4309.3649s
	iters: 200, epoch: 14 | loss: 0.0000125
	speed: 0.0392s/iter; left time: 1402.0963s
	iters: 300, epoch: 14 | loss: 0.0014573
	speed: 0.0366s/iter; left time: 1304.8256s
	iters: 400, epoch: 14 | loss: 0.0007341
	speed: 0.0395s/iter; left time: 1403.4897s
Epoch: 14 cost time: 16.475950479507446
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
Validation loss decreased (-0.979990 --> -0.981809).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0002919
	speed: 0.1202s/iter; left time: 4256.3635s
	iters: 200, epoch: 15 | loss: 0.0000724
	speed: 0.0368s/iter; left time: 1298.9553s
	iters: 300, epoch: 15 | loss: 0.0022763
	speed: 0.0369s/iter; left time: 1298.7289s
	iters: 400, epoch: 15 | loss: 0.0142206
	speed: 0.0397s/iter; left time: 1393.8358s
Epoch: 15 cost time: 16.098610401153564
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.057 Vali Acc: 0.984 Test Loss: 0.057 Test Acc: 0.984
Validation loss decreased (-0.981809 --> -0.983628).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000014
	speed: 0.1182s/iter; left time: 4138.0783s
	iters: 200, epoch: 16 | loss: 0.0136039
	speed: 0.0359s/iter; left time: 1254.4323s
	iters: 300, epoch: 16 | loss: 0.0181125
	speed: 0.0367s/iter; left time: 1275.6861s
	iters: 400, epoch: 16 | loss: 0.0000759
	speed: 0.0362s/iter; left time: 1255.9762s
Epoch: 16 cost time: 15.528286695480347
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0005498
	speed: 0.1265s/iter; left time: 4376.5273s
	iters: 200, epoch: 17 | loss: 0.0001727
	speed: 0.0377s/iter; left time: 1300.0615s
	iters: 300, epoch: 17 | loss: 0.0015274
	speed: 0.0389s/iter; left time: 1336.4564s
	iters: 400, epoch: 17 | loss: 0.0000450
	speed: 0.0377s/iter; left time: 1292.0497s
Epoch: 17 cost time: 16.10794425010681
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0008202
	speed: 0.1179s/iter; left time: 4028.9021s
	iters: 200, epoch: 18 | loss: 0.0000876
	speed: 0.0366s/iter; left time: 1245.9035s
	iters: 300, epoch: 18 | loss: 0.0029101
	speed: 0.0354s/iter; left time: 1202.6220s
	iters: 400, epoch: 18 | loss: 0.0041515
	speed: 0.0351s/iter; left time: 1190.0597s
Epoch: 18 cost time: 15.462035417556763
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0037286
	speed: 0.1186s/iter; left time: 4003.4421s
	iters: 200, epoch: 19 | loss: 0.0162101
	speed: 0.0375s/iter; left time: 1263.5009s
	iters: 300, epoch: 19 | loss: 0.0011697
	speed: 0.0350s/iter; left time: 1173.8790s
	iters: 400, epoch: 19 | loss: 0.0001133
	speed: 0.0340s/iter; left time: 1137.4065s
Epoch: 19 cost time: 15.250765800476074
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0001050
	speed: 0.1216s/iter; left time: 4057.4519s
	iters: 200, epoch: 20 | loss: 0.0000063
	speed: 0.0364s/iter; left time: 1209.6786s
	iters: 300, epoch: 20 | loss: 0.0005159
	speed: 0.0382s/iter; left time: 1267.9140s
	iters: 400, epoch: 20 | loss: 0.0013473
	speed: 0.0380s/iter; left time: 1256.7943s
Epoch: 20 cost time: 15.824697732925415
Epoch: 20, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0064641
	speed: 0.1291s/iter; left time: 4252.8406s
	iters: 200, epoch: 21 | loss: 0.0007462
	speed: 0.0386s/iter; left time: 1269.3032s
	iters: 300, epoch: 21 | loss: 0.0008337
	speed: 0.0362s/iter; left time: 1184.3647s
	iters: 400, epoch: 21 | loss: 0.0000014
	speed: 0.0413s/iter; left time: 1348.9464s
Epoch: 21 cost time: 16.636180639266968
Epoch: 21, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000086
	speed: 0.1223s/iter; left time: 3978.4525s
	iters: 200, epoch: 22 | loss: 0.0003423
	speed: 0.0387s/iter; left time: 1256.2256s
	iters: 300, epoch: 22 | loss: 0.0000661
	speed: 0.0379s/iter; left time: 1225.0173s
	iters: 400, epoch: 22 | loss: 0.0000064
	speed: 0.0381s/iter; left time: 1227.2775s
Epoch: 22 cost time: 16.31702423095703
Epoch: 22, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0226619
	speed: 0.1187s/iter; left time: 3812.3744s
	iters: 200, epoch: 23 | loss: 0.0000119
	speed: 0.0372s/iter; left time: 1190.6917s
	iters: 300, epoch: 23 | loss: 0.0018180
	speed: 0.0363s/iter; left time: 1158.2406s
	iters: 400, epoch: 23 | loss: 0.0000955
	speed: 0.0350s/iter; left time: 1114.2140s
Epoch: 23 cost time: 15.509817600250244
Epoch: 23, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000445
	speed: 0.1269s/iter; left time: 4023.9616s
	iters: 200, epoch: 24 | loss: 0.0166407
	speed: 0.0353s/iter; left time: 1115.9074s
	iters: 300, epoch: 24 | loss: 0.0350339
	speed: 0.0380s/iter; left time: 1196.7058s
	iters: 400, epoch: 24 | loss: 0.0014460
	speed: 0.0372s/iter; left time: 1169.5184s
Epoch: 24 cost time: 15.666274309158325
Epoch: 24, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000012
	speed: 0.1204s/iter; left time: 3766.3639s
	iters: 200, epoch: 25 | loss: 0.0000163
	speed: 0.0349s/iter; left time: 1087.1578s
	iters: 300, epoch: 25 | loss: 0.0000063
	speed: 0.0367s/iter; left time: 1142.1728s
	iters: 400, epoch: 25 | loss: 0.0301391
	speed: 0.0385s/iter; left time: 1192.9999s
Epoch: 25 cost time: 15.411575555801392
Epoch: 25, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 299698
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1220126
	speed: 0.0549s/iter; left time: 2260.9425s
	iters: 200, epoch: 1 | loss: 0.6922673
	speed: 0.0360s/iter; left time: 1480.7233s
	iters: 300, epoch: 1 | loss: 0.5770253
	speed: 0.0366s/iter; left time: 1499.4049s
	iters: 400, epoch: 1 | loss: 0.2295297
	speed: 0.0373s/iter; left time: 1526.7226s
Epoch: 1 cost time: 17.09993290901184
Epoch: 1, Steps: 413 | Train Loss: 0.809 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
Validation loss decreased (inf --> -0.955887).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0411949
	speed: 0.1185s/iter; left time: 4832.4002s
	iters: 200, epoch: 2 | loss: 0.1493675
	speed: 0.0399s/iter; left time: 1624.1808s
	iters: 300, epoch: 2 | loss: 0.0327964
	speed: 0.0363s/iter; left time: 1474.7130s
	iters: 400, epoch: 2 | loss: 0.0418591
	speed: 0.0366s/iter; left time: 1480.7097s
Epoch: 2 cost time: 15.62539005279541
Epoch: 2, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.955887 --> -0.972714).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2265742
	speed: 0.1238s/iter; left time: 4999.9242s
	iters: 200, epoch: 3 | loss: 0.0432030
	speed: 0.0345s/iter; left time: 1388.1803s
	iters: 300, epoch: 3 | loss: 0.0378102
	speed: 0.0362s/iter; left time: 1454.0900s
	iters: 400, epoch: 3 | loss: 0.0462586
	speed: 0.0383s/iter; left time: 1535.4814s
Epoch: 3 cost time: 15.506006002426147
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.972714 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0219641
	speed: 0.1158s/iter; left time: 4628.2393s
	iters: 200, epoch: 4 | loss: 0.0095061
	speed: 0.0355s/iter; left time: 1416.4029s
	iters: 300, epoch: 4 | loss: 0.1576129
	speed: 0.0340s/iter; left time: 1352.2977s
	iters: 400, epoch: 4 | loss: 0.0051739
	speed: 0.0342s/iter; left time: 1356.7969s
Epoch: 4 cost time: 14.91930890083313
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.073 Vali Acc: 0.972 Test Loss: 0.073 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1468349
	speed: 0.1120s/iter; left time: 4429.7352s
	iters: 200, epoch: 5 | loss: 0.0357503
	speed: 0.0349s/iter; left time: 1378.0099s
	iters: 300, epoch: 5 | loss: 0.0034087
	speed: 0.0367s/iter; left time: 1444.2652s
	iters: 400, epoch: 5 | loss: 0.0217814
	speed: 0.0344s/iter; left time: 1349.4696s
Epoch: 5 cost time: 14.785199642181396
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.082 Vali Acc: 0.971 Test Loss: 0.082 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1693965
	speed: 0.1178s/iter; left time: 4609.0063s
	iters: 200, epoch: 6 | loss: 0.0074633
	speed: 0.0354s/iter; left time: 1382.9965s
	iters: 300, epoch: 6 | loss: 0.0000963
	speed: 0.0343s/iter; left time: 1336.8995s
	iters: 400, epoch: 6 | loss: 0.0035709
	speed: 0.0360s/iter; left time: 1396.5221s
Epoch: 6 cost time: 15.015915155410767
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
Validation loss decreased (-0.976807 --> -0.981809).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0002600
	speed: 0.1181s/iter; left time: 4574.5923s
	iters: 200, epoch: 7 | loss: 0.0193124
	speed: 0.0344s/iter; left time: 1328.3466s
	iters: 300, epoch: 7 | loss: 0.0009719
	speed: 0.0370s/iter; left time: 1426.4908s
	iters: 400, epoch: 7 | loss: 0.0233760
	speed: 0.0348s/iter; left time: 1337.0005s
Epoch: 7 cost time: 15.04836106300354
Epoch: 7, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0009378
	speed: 0.1113s/iter; left time: 4263.9359s
	iters: 200, epoch: 8 | loss: 0.0806739
	speed: 0.0371s/iter; left time: 1418.7289s
	iters: 300, epoch: 8 | loss: 0.0021757
	speed: 0.0360s/iter; left time: 1372.1289s
	iters: 400, epoch: 8 | loss: 0.0008836
	speed: 0.0374s/iter; left time: 1420.5994s
Epoch: 8 cost time: 15.421727418899536
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0124058
	speed: 0.1133s/iter; left time: 4295.1463s
	iters: 200, epoch: 9 | loss: 0.0061826
	speed: 0.0355s/iter; left time: 1342.6735s
	iters: 300, epoch: 9 | loss: 0.0242586
	speed: 0.0350s/iter; left time: 1320.6036s
	iters: 400, epoch: 9 | loss: 0.0001999
	speed: 0.0352s/iter; left time: 1325.2141s
Epoch: 9 cost time: 15.143121480941772
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0281562
	speed: 0.1204s/iter; left time: 4514.4188s
	iters: 200, epoch: 10 | loss: 0.0423273
	speed: 0.0346s/iter; left time: 1294.3652s
	iters: 300, epoch: 10 | loss: 0.0020147
	speed: 0.0376s/iter; left time: 1401.9938s
	iters: 400, epoch: 10 | loss: 0.0159254
	speed: 0.0388s/iter; left time: 1443.8606s
Epoch: 10 cost time: 15.510647058486938
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0107296
	speed: 0.1171s/iter; left time: 4340.6556s
	iters: 200, epoch: 11 | loss: 0.0000860
	speed: 0.0345s/iter; left time: 1274.7200s
	iters: 300, epoch: 11 | loss: 0.0101769
	speed: 0.0351s/iter; left time: 1293.2587s
	iters: 400, epoch: 11 | loss: 0.0001079
	speed: 0.0356s/iter; left time: 1309.8327s
Epoch: 11 cost time: 14.781964540481567
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0046646
	speed: 0.1155s/iter; left time: 4232.6379s
	iters: 200, epoch: 12 | loss: 0.0128253
	speed: 0.0365s/iter; left time: 1333.6194s
	iters: 300, epoch: 12 | loss: 0.0074303
	speed: 0.0362s/iter; left time: 1320.4362s
	iters: 400, epoch: 12 | loss: 0.0006732
	speed: 0.0336s/iter; left time: 1220.7596s
Epoch: 12 cost time: 14.945983648300171
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0009021
	speed: 0.1113s/iter; left time: 4032.8930s
	iters: 200, epoch: 13 | loss: 0.0205953
	speed: 0.0339s/iter; left time: 1225.4671s
	iters: 300, epoch: 13 | loss: 0.0201911
	speed: 0.0345s/iter; left time: 1244.1414s
	iters: 400, epoch: 13 | loss: 0.0022418
	speed: 0.0368s/iter; left time: 1324.4550s
Epoch: 13 cost time: 14.745927810668945
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0048412
	speed: 0.1195s/iter; left time: 4280.3969s
	iters: 200, epoch: 14 | loss: 0.0000336
	speed: 0.0347s/iter; left time: 1240.4594s
	iters: 300, epoch: 14 | loss: 0.0032174
	speed: 0.0362s/iter; left time: 1288.9084s
	iters: 400, epoch: 14 | loss: 0.0000980
	speed: 0.0351s/iter; left time: 1246.3569s
Epoch: 14 cost time: 15.076383113861084
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0005092
	speed: 0.1187s/iter; left time: 4203.0013s
	iters: 200, epoch: 15 | loss: 0.0025760
	speed: 0.0336s/iter; left time: 1185.0213s
	iters: 300, epoch: 15 | loss: 0.0556721
	speed: 0.0371s/iter; left time: 1307.2823s
	iters: 400, epoch: 15 | loss: 0.0075750
	speed: 0.0360s/iter; left time: 1266.0373s
Epoch: 15 cost time: 14.903093576431274
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000054
	speed: 0.1140s/iter; left time: 3990.5387s
	iters: 200, epoch: 16 | loss: 0.0009252
	speed: 0.0352s/iter; left time: 1229.8804s
	iters: 300, epoch: 16 | loss: 0.0002731
	speed: 0.0352s/iter; left time: 1224.8277s
	iters: 400, epoch: 16 | loss: 0.0001253
	speed: 0.0395s/iter; left time: 1371.0049s
Epoch: 16 cost time: 15.629674911499023
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 299698
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3177462
	speed: 0.0570s/iter; left time: 2346.6004s
	iters: 200, epoch: 1 | loss: 0.4704564
	speed: 0.0408s/iter; left time: 1674.8743s
	iters: 300, epoch: 1 | loss: 0.1320334
	speed: 0.0387s/iter; left time: 1587.5541s
	iters: 400, epoch: 1 | loss: 0.0375821
	speed: 0.0401s/iter; left time: 1640.7431s
Epoch: 1 cost time: 18.270734548568726
Epoch: 1, Steps: 413 | Train Loss: 0.720 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (inf --> -0.969985).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0483069
	speed: 0.1268s/iter; left time: 5170.2223s
	iters: 200, epoch: 2 | loss: 0.2377845
	speed: 0.0369s/iter; left time: 1501.1265s
	iters: 300, epoch: 2 | loss: 0.0453087
	speed: 0.0361s/iter; left time: 1464.7385s
	iters: 400, epoch: 2 | loss: 0.0426013
	speed: 0.0356s/iter; left time: 1441.0040s
Epoch: 2 cost time: 15.633779287338257
Epoch: 2, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.969985 --> -0.973169).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0107594
	speed: 0.1159s/iter; left time: 4679.1398s
	iters: 200, epoch: 3 | loss: 0.0057941
	speed: 0.0359s/iter; left time: 1444.5962s
	iters: 300, epoch: 3 | loss: 0.2849250
	speed: 0.0387s/iter; left time: 1552.9951s
	iters: 400, epoch: 3 | loss: 0.0250093
	speed: 0.0359s/iter; left time: 1437.5201s
Epoch: 3 cost time: 15.619186878204346
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
Validation loss decreased (-0.973169 --> -0.979081).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0783249
	speed: 0.1196s/iter; left time: 4778.8578s
	iters: 200, epoch: 4 | loss: 0.0046629
	speed: 0.0362s/iter; left time: 1441.7255s
	iters: 300, epoch: 4 | loss: 0.0059601
	speed: 0.0364s/iter; left time: 1448.0382s
	iters: 400, epoch: 4 | loss: 0.0451211
	speed: 0.0381s/iter; left time: 1510.4661s
Epoch: 4 cost time: 15.645584106445312
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1101612
	speed: 0.1244s/iter; left time: 4920.8265s
	iters: 200, epoch: 5 | loss: 0.0046073
	speed: 0.0386s/iter; left time: 1522.1745s
	iters: 300, epoch: 5 | loss: 0.1726631
	speed: 0.0377s/iter; left time: 1483.3246s
	iters: 400, epoch: 5 | loss: 0.0212577
	speed: 0.0367s/iter; left time: 1441.4209s
Epoch: 5 cost time: 16.00880742073059
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
Validation loss decreased (-0.979081 --> -0.982719).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0094266
	speed: 0.1252s/iter; left time: 4898.2646s
	iters: 200, epoch: 6 | loss: 0.0088448
	speed: 0.0399s/iter; left time: 1557.0306s
	iters: 300, epoch: 6 | loss: 0.0046985
	speed: 0.0394s/iter; left time: 1532.1951s
	iters: 400, epoch: 6 | loss: 0.0105239
	speed: 0.0380s/iter; left time: 1474.2578s
Epoch: 6 cost time: 16.503138303756714
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0087622
	speed: 0.1156s/iter; left time: 4474.8482s
	iters: 200, epoch: 7 | loss: 0.0397879
	speed: 0.0397s/iter; left time: 1532.1473s
	iters: 300, epoch: 7 | loss: 0.0024445
	speed: 0.0386s/iter; left time: 1487.3430s
	iters: 400, epoch: 7 | loss: 0.0157535
	speed: 0.0396s/iter; left time: 1519.7123s
Epoch: 7 cost time: 16.51933789253235
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0014359
	speed: 0.1213s/iter; left time: 4647.0997s
	iters: 200, epoch: 8 | loss: 0.0145888
	speed: 0.0398s/iter; left time: 1519.1780s
	iters: 300, epoch: 8 | loss: 0.0012680
	speed: 0.0396s/iter; left time: 1509.4517s
	iters: 400, epoch: 8 | loss: 0.0004885
	speed: 0.0386s/iter; left time: 1468.5373s
Epoch: 8 cost time: 16.600695371627808
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0052515
	speed: 0.1237s/iter; left time: 4688.2213s
	iters: 200, epoch: 9 | loss: 0.0002766
	speed: 0.0382s/iter; left time: 1444.5983s
	iters: 300, epoch: 9 | loss: 0.0013514
	speed: 0.0375s/iter; left time: 1415.0371s
	iters: 400, epoch: 9 | loss: 0.0072511
	speed: 0.0348s/iter; left time: 1306.6933s
Epoch: 9 cost time: 15.758604526519775
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0032519
	speed: 0.1179s/iter; left time: 4417.8315s
	iters: 200, epoch: 10 | loss: 0.0145417
	speed: 0.0365s/iter; left time: 1362.8371s
	iters: 300, epoch: 10 | loss: 0.0104366
	speed: 0.0367s/iter; left time: 1369.6158s
	iters: 400, epoch: 10 | loss: 0.0004730
	speed: 0.0370s/iter; left time: 1376.9545s
Epoch: 10 cost time: 15.717666625976562
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0037604
	speed: 0.1194s/iter; left time: 4425.8476s
	iters: 200, epoch: 11 | loss: 0.0000599
	speed: 0.0365s/iter; left time: 1350.4407s
	iters: 300, epoch: 11 | loss: 0.0028436
	speed: 0.0371s/iter; left time: 1366.3007s
	iters: 400, epoch: 11 | loss: 0.0012983
	speed: 0.0378s/iter; left time: 1388.5812s
Epoch: 11 cost time: 15.930024862289429
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0100834
	speed: 0.1242s/iter; left time: 4552.4238s
	iters: 200, epoch: 12 | loss: 0.0000845
	speed: 0.0373s/iter; left time: 1362.1520s
	iters: 300, epoch: 12 | loss: 0.0002598
	speed: 0.0346s/iter; left time: 1260.3266s
	iters: 400, epoch: 12 | loss: 0.0009147
	speed: 0.0377s/iter; left time: 1371.1746s
Epoch: 12 cost time: 15.72343635559082
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0001017
	speed: 0.1331s/iter; left time: 4825.9819s
	iters: 200, epoch: 13 | loss: 0.0013902
	speed: 0.0384s/iter; left time: 1389.4125s
	iters: 300, epoch: 13 | loss: 0.0004027
	speed: 0.0383s/iter; left time: 1378.9835s
	iters: 400, epoch: 13 | loss: 0.0003462
	speed: 0.0359s/iter; left time: 1291.0005s
Epoch: 13 cost time: 16.027670860290527
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0017057
	speed: 0.1208s/iter; left time: 4329.4216s
	iters: 200, epoch: 14 | loss: 0.0253344
	speed: 0.0362s/iter; left time: 1293.5391s
	iters: 300, epoch: 14 | loss: 0.0054831
	speed: 0.0376s/iter; left time: 1338.6415s
	iters: 400, epoch: 14 | loss: 0.0029291
	speed: 0.0374s/iter; left time: 1327.1967s
Epoch: 14 cost time: 15.851816177368164
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0027465
	speed: 0.1212s/iter; left time: 4294.3762s
	iters: 200, epoch: 15 | loss: 0.0040236
	speed: 0.0356s/iter; left time: 1257.4282s
	iters: 300, epoch: 15 | loss: 0.0001420
	speed: 0.0374s/iter; left time: 1317.1285s
	iters: 400, epoch: 15 | loss: 0.0299799
	speed: 0.0375s/iter; left time: 1316.5197s
Epoch: 15 cost time: 15.796934843063354
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 168626
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2916547
	speed: 0.0577s/iter; left time: 2376.3090s
	iters: 200, epoch: 1 | loss: 0.4646889
	speed: 0.0348s/iter; left time: 1431.2788s
	iters: 300, epoch: 1 | loss: 0.1326109
	speed: 0.0358s/iter; left time: 1466.3273s
	iters: 400, epoch: 1 | loss: 0.0359853
	speed: 0.0373s/iter; left time: 1526.0930s
Epoch: 1 cost time: 17.185379028320312
Epoch: 1, Steps: 413 | Train Loss: 0.723 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (inf --> -0.970440).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0525177
	speed: 0.1171s/iter; left time: 4777.8979s
	iters: 200, epoch: 2 | loss: 0.1570963
	speed: 0.0378s/iter; left time: 1537.2093s
	iters: 300, epoch: 2 | loss: 0.0671933
	speed: 0.0372s/iter; left time: 1508.2852s
	iters: 400, epoch: 2 | loss: 0.0176118
	speed: 0.0349s/iter; left time: 1412.6851s
Epoch: 2 cost time: 15.477948665618896
Epoch: 2, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.084 Vali Acc: 0.972 Test Loss: 0.084 Test Acc: 0.972
Validation loss decreased (-0.970440 --> -0.971805).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0058535
	speed: 0.1162s/iter; left time: 4692.0894s
	iters: 200, epoch: 3 | loss: 0.0082976
	speed: 0.0363s/iter; left time: 1463.5545s
	iters: 300, epoch: 3 | loss: 0.1563272
	speed: 0.0362s/iter; left time: 1454.8321s
	iters: 400, epoch: 3 | loss: 0.0230311
	speed: 0.0362s/iter; left time: 1452.6032s
Epoch: 3 cost time: 15.315518140792847
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.060 Vali Acc: 0.977 Test Loss: 0.060 Test Acc: 0.977
Validation loss decreased (-0.971805 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0408179
	speed: 0.1275s/iter; left time: 5094.3846s
	iters: 200, epoch: 4 | loss: 0.0227997
	speed: 0.0376s/iter; left time: 1498.7923s
	iters: 300, epoch: 4 | loss: 0.0094112
	speed: 0.0394s/iter; left time: 1567.8417s
	iters: 400, epoch: 4 | loss: 0.0032780
	speed: 0.0411s/iter; left time: 1630.9794s
Epoch: 4 cost time: 16.489596605300903
Epoch: 4, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.059 Vali Acc: 0.981 Test Loss: 0.059 Test Acc: 0.981
Validation loss decreased (-0.976807 --> -0.981355).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0453250
	speed: 0.1172s/iter; left time: 4635.6816s
	iters: 200, epoch: 5 | loss: 0.0010952
	speed: 0.0390s/iter; left time: 1537.5742s
	iters: 300, epoch: 5 | loss: 0.2278419
	speed: 0.0377s/iter; left time: 1485.0588s
	iters: 400, epoch: 5 | loss: 0.0139404
	speed: 0.0378s/iter; left time: 1482.4155s
Epoch: 5 cost time: 16.292262315750122
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.057 Vali Acc: 0.980 Test Loss: 0.057 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0063474
	speed: 0.1205s/iter; left time: 4715.5865s
	iters: 200, epoch: 6 | loss: 0.0111326
	speed: 0.0401s/iter; left time: 1563.5704s
	iters: 300, epoch: 6 | loss: 0.0016790
	speed: 0.0383s/iter; left time: 1490.5482s
	iters: 400, epoch: 6 | loss: 0.0164925
	speed: 0.0359s/iter; left time: 1394.2907s
Epoch: 6 cost time: 16.10815191268921
Epoch: 6, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0107359
	speed: 0.1172s/iter; left time: 4537.6682s
	iters: 200, epoch: 7 | loss: 0.0118906
	speed: 0.0376s/iter; left time: 1450.9181s
	iters: 300, epoch: 7 | loss: 0.0173818
	speed: 0.0389s/iter; left time: 1497.5545s
	iters: 400, epoch: 7 | loss: 0.0037288
	speed: 0.0372s/iter; left time: 1428.4066s
Epoch: 7 cost time: 15.932090044021606
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.062 Vali Acc: 0.979 Test Loss: 0.062 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0005120
	speed: 0.1231s/iter; left time: 4715.8455s
	iters: 200, epoch: 8 | loss: 0.0014002
	speed: 0.0371s/iter; left time: 1418.3392s
	iters: 300, epoch: 8 | loss: 0.0332323
	speed: 0.0366s/iter; left time: 1394.3185s
	iters: 400, epoch: 8 | loss: 0.0011391
	speed: 0.0377s/iter; left time: 1434.3345s
Epoch: 8 cost time: 15.841415643692017
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0011472
	speed: 0.1150s/iter; left time: 4359.3281s
	iters: 200, epoch: 9 | loss: 0.0005512
	speed: 0.0383s/iter; left time: 1447.0016s
	iters: 300, epoch: 9 | loss: 0.0069860
	speed: 0.0356s/iter; left time: 1343.5657s
	iters: 400, epoch: 9 | loss: 0.0015115
	speed: 0.0356s/iter; left time: 1339.6141s
Epoch: 9 cost time: 15.5211763381958
Epoch: 9, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0008252
	speed: 0.1169s/iter; left time: 4382.4987s
	iters: 200, epoch: 10 | loss: 0.0414581
	speed: 0.0359s/iter; left time: 1343.5645s
	iters: 300, epoch: 10 | loss: 0.0021202
	speed: 0.0381s/iter; left time: 1420.0964s
	iters: 400, epoch: 10 | loss: 0.0190622
	speed: 0.0390s/iter; left time: 1451.5967s
Epoch: 10 cost time: 15.73984432220459
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000705
	speed: 0.1230s/iter; left time: 4559.7003s
	iters: 200, epoch: 11 | loss: 0.0000863
	speed: 0.0393s/iter; left time: 1454.4309s
	iters: 300, epoch: 11 | loss: 0.0006501
	speed: 0.0404s/iter; left time: 1488.2506s
	iters: 400, epoch: 11 | loss: 0.0016082
	speed: 0.0390s/iter; left time: 1433.2492s
Epoch: 11 cost time: 16.63291597366333
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
Validation loss decreased (-0.981355 --> -0.983628).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000800
	speed: 0.1328s/iter; left time: 4866.9210s
	iters: 200, epoch: 12 | loss: 0.0030076
	speed: 0.0380s/iter; left time: 1388.0663s
	iters: 300, epoch: 12 | loss: 0.0034011
	speed: 0.0440s/iter; left time: 1604.5935s
	iters: 400, epoch: 12 | loss: 0.0037466
	speed: 0.0443s/iter; left time: 1612.3655s
Epoch: 12 cost time: 17.928778171539307
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0030472
	speed: 0.1012s/iter; left time: 3668.7817s
	iters: 200, epoch: 13 | loss: 0.0023376
	speed: 0.0343s/iter; left time: 1240.2887s
	iters: 300, epoch: 13 | loss: 0.0000366
	speed: 0.0307s/iter; left time: 1107.7424s
	iters: 400, epoch: 13 | loss: 0.0002627
	speed: 0.0320s/iter; left time: 1149.7640s
Epoch: 13 cost time: 13.828308820724487
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0029736
	speed: 0.1151s/iter; left time: 4125.9332s
	iters: 200, epoch: 14 | loss: 0.0025092
	speed: 0.0382s/iter; left time: 1363.6325s
	iters: 300, epoch: 14 | loss: 0.0007916
	speed: 0.0356s/iter; left time: 1268.4337s
	iters: 400, epoch: 14 | loss: 0.0149751
	speed: 0.0356s/iter; left time: 1263.8814s
Epoch: 14 cost time: 15.486106872558594
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000588
	speed: 0.1151s/iter; left time: 4077.9119s
	iters: 200, epoch: 15 | loss: 0.0010856
	speed: 0.0356s/iter; left time: 1256.9676s
	iters: 300, epoch: 15 | loss: 0.0007129
	speed: 0.0383s/iter; left time: 1350.5056s
	iters: 400, epoch: 15 | loss: 0.0000547
	speed: 0.0358s/iter; left time: 1258.4254s
Epoch: 15 cost time: 15.34038257598877
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0003164
	speed: 0.1152s/iter; left time: 4034.3096s
	iters: 200, epoch: 16 | loss: 0.0284456
	speed: 0.0349s/iter; left time: 1218.2623s
	iters: 300, epoch: 16 | loss: 0.0028393
	speed: 0.0351s/iter; left time: 1222.0471s
	iters: 400, epoch: 16 | loss: 0.0003125
	speed: 0.0361s/iter; left time: 1252.8746s
Epoch: 16 cost time: 15.227267503738403
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0293016
	speed: 0.1171s/iter; left time: 4050.2028s
	iters: 200, epoch: 17 | loss: 0.0012524
	speed: 0.0366s/iter; left time: 1261.6301s
	iters: 300, epoch: 17 | loss: 0.0260424
	speed: 0.0354s/iter; left time: 1216.0811s
	iters: 400, epoch: 17 | loss: 0.0001341
	speed: 0.0350s/iter; left time: 1199.9530s
Epoch: 17 cost time: 15.205570220947266
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0007437
	speed: 0.1154s/iter; left time: 3946.0443s
	iters: 200, epoch: 18 | loss: 0.0001798
	speed: 0.0369s/iter; left time: 1256.0814s
	iters: 300, epoch: 18 | loss: 0.0000031
	speed: 0.0393s/iter; left time: 1334.1829s
	iters: 400, epoch: 18 | loss: 0.0008603
	speed: 0.0362s/iter; left time: 1225.4434s
Epoch: 18 cost time: 15.727657318115234
Epoch: 18, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000038
	speed: 0.1163s/iter; left time: 3925.9345s
	iters: 200, epoch: 19 | loss: 0.0014939
	speed: 0.0363s/iter; left time: 1221.7015s
	iters: 300, epoch: 19 | loss: 0.0007105
	speed: 0.0387s/iter; left time: 1298.1496s
	iters: 400, epoch: 19 | loss: 0.0000040
	speed: 0.0357s/iter; left time: 1195.0391s
Epoch: 19 cost time: 15.627872228622437
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0002849
	speed: 0.1137s/iter; left time: 3791.9877s
	iters: 200, epoch: 20 | loss: 0.0000197
	speed: 0.0346s/iter; left time: 1149.1099s
	iters: 300, epoch: 20 | loss: 0.0000398
	speed: 0.0338s/iter; left time: 1122.1478s
	iters: 400, epoch: 20 | loss: 0.0000197
	speed: 0.0350s/iter; left time: 1158.3593s
Epoch: 20 cost time: 14.919841051101685
Epoch: 20, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000935
	speed: 0.1152s/iter; left time: 3793.6580s
	iters: 200, epoch: 21 | loss: 0.2154895
	speed: 0.0344s/iter; left time: 1128.3340s
	iters: 300, epoch: 21 | loss: 0.0001627
	speed: 0.0350s/iter; left time: 1146.9052s
	iters: 400, epoch: 21 | loss: 0.0000011
	speed: 0.0347s/iter; left time: 1131.2172s
Epoch: 21 cost time: 14.909297704696655
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 168626
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3317738
	speed: 0.0507s/iter; left time: 2089.3076s
	iters: 200, epoch: 1 | loss: 0.4370607
	speed: 0.0342s/iter; left time: 1403.6753s
	iters: 300, epoch: 1 | loss: 0.1794917
	speed: 0.0349s/iter; left time: 1429.1269s
	iters: 400, epoch: 1 | loss: 0.0564260
	speed: 0.0344s/iter; left time: 1406.0644s
Epoch: 1 cost time: 15.906381607055664
Epoch: 1, Steps: 413 | Train Loss: 0.750 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (inf --> -0.967257).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0801509
	speed: 0.1099s/iter; left time: 4482.3705s
	iters: 200, epoch: 2 | loss: 0.1234199
	speed: 0.0343s/iter; left time: 1397.3133s
	iters: 300, epoch: 2 | loss: 0.0389983
	speed: 0.0376s/iter; left time: 1526.7474s
	iters: 400, epoch: 2 | loss: 0.0469476
	speed: 0.0391s/iter; left time: 1581.9076s
Epoch: 2 cost time: 15.353638410568237
Epoch: 2, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.091 Vali Acc: 0.969 Test Loss: 0.091 Test Acc: 0.969
Validation loss decreased (-0.967257 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0064157
	speed: 0.1213s/iter; left time: 4896.8648s
	iters: 200, epoch: 3 | loss: 0.0035421
	speed: 0.0355s/iter; left time: 1431.4039s
	iters: 300, epoch: 3 | loss: 0.3045203
	speed: 0.0356s/iter; left time: 1429.0090s
	iters: 400, epoch: 3 | loss: 0.0253137
	speed: 0.0364s/iter; left time: 1460.4343s
Epoch: 3 cost time: 15.525847673416138
Epoch: 3, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.062 Vali Acc: 0.977 Test Loss: 0.062 Test Acc: 0.977
Validation loss decreased (-0.969076 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0601901
	speed: 0.1146s/iter; left time: 4579.1732s
	iters: 200, epoch: 4 | loss: 0.0068296
	speed: 0.0377s/iter; left time: 1500.9106s
	iters: 300, epoch: 4 | loss: 0.0187013
	speed: 0.0358s/iter; left time: 1424.3621s
	iters: 400, epoch: 4 | loss: 0.0125129
	speed: 0.0365s/iter; left time: 1446.7400s
Epoch: 4 cost time: 15.878883123397827
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0480823
	speed: 0.1062s/iter; left time: 4198.5520s
	iters: 200, epoch: 5 | loss: 0.0179619
	speed: 0.0349s/iter; left time: 1375.7872s
	iters: 300, epoch: 5 | loss: 0.3446043
	speed: 0.0374s/iter; left time: 1471.0099s
	iters: 400, epoch: 5 | loss: 0.0248895
	speed: 0.0372s/iter; left time: 1459.8184s
Epoch: 5 cost time: 15.519702434539795
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.086 Vali Acc: 0.971 Test Loss: 0.086 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0265736
	speed: 0.1051s/iter; left time: 4113.1628s
	iters: 200, epoch: 6 | loss: 0.0049977
	speed: 0.0346s/iter; left time: 1349.9281s
	iters: 300, epoch: 6 | loss: 0.0065266
	speed: 0.0358s/iter; left time: 1393.2176s
	iters: 400, epoch: 6 | loss: 0.0086240
	speed: 0.0344s/iter; left time: 1335.2977s
Epoch: 6 cost time: 14.722550868988037
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
Validation loss decreased (-0.976807 --> -0.979081).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0081226
	speed: 0.1046s/iter; left time: 4051.7789s
	iters: 200, epoch: 7 | loss: 0.0129590
	speed: 0.0360s/iter; left time: 1390.9726s
	iters: 300, epoch: 7 | loss: 0.0033031
	speed: 0.0346s/iter; left time: 1332.5996s
	iters: 400, epoch: 7 | loss: 0.0027632
	speed: 0.0327s/iter; left time: 1255.8753s
Epoch: 7 cost time: 14.521529912948608
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0015908
	speed: 0.1061s/iter; left time: 4065.6830s
	iters: 200, epoch: 8 | loss: 0.0215987
	speed: 0.0353s/iter; left time: 1349.2628s
	iters: 300, epoch: 8 | loss: 0.0012488
	speed: 0.0371s/iter; left time: 1414.7735s
	iters: 400, epoch: 8 | loss: 0.0885974
	speed: 0.0376s/iter; left time: 1428.1027s
Epoch: 8 cost time: 15.501189470291138
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.063 Vali Acc: 0.982 Test Loss: 0.063 Test Acc: 0.982
Validation loss decreased (-0.979081 --> -0.982264).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0188324
	speed: 0.1037s/iter; left time: 3928.7717s
	iters: 200, epoch: 9 | loss: 0.0013804
	speed: 0.0387s/iter; left time: 1461.1549s
	iters: 300, epoch: 9 | loss: 0.0914943
	speed: 0.0386s/iter; left time: 1453.2564s
	iters: 400, epoch: 9 | loss: 0.0001332
	speed: 0.0366s/iter; left time: 1374.4720s
Epoch: 9 cost time: 15.836724281311035
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0041135
	speed: 0.1017s/iter; left time: 3810.2554s
	iters: 200, epoch: 10 | loss: 0.0034871
	speed: 0.0331s/iter; left time: 1237.2279s
	iters: 300, epoch: 10 | loss: 0.0020198
	speed: 0.0355s/iter; left time: 1324.4025s
	iters: 400, epoch: 10 | loss: 0.0004278
	speed: 0.0355s/iter; left time: 1318.6240s
Epoch: 10 cost time: 14.721751689910889
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0001248
	speed: 0.1087s/iter; left time: 4028.2141s
	iters: 200, epoch: 11 | loss: 0.0008733
	speed: 0.0368s/iter; left time: 1359.6624s
	iters: 300, epoch: 11 | loss: 0.0000265
	speed: 0.0351s/iter; left time: 1295.1281s
	iters: 400, epoch: 11 | loss: 0.0009367
	speed: 0.0355s/iter; left time: 1303.7737s
Epoch: 11 cost time: 15.12775468826294
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0281839
	speed: 0.1053s/iter; left time: 3860.9825s
	iters: 200, epoch: 12 | loss: 0.0225301
	speed: 0.0351s/iter; left time: 1284.0963s
	iters: 300, epoch: 12 | loss: 0.0001225
	speed: 0.0384s/iter; left time: 1399.5429s
	iters: 400, epoch: 12 | loss: 0.0075263
	speed: 0.0378s/iter; left time: 1374.9729s
Epoch: 12 cost time: 15.409977674484253
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0002448
	speed: 0.1043s/iter; left time: 3780.9309s
	iters: 200, epoch: 13 | loss: 0.0002077
	speed: 0.0365s/iter; left time: 1318.7175s
	iters: 300, epoch: 13 | loss: 0.0000250
	speed: 0.0373s/iter; left time: 1345.7602s
	iters: 400, epoch: 13 | loss: 0.0023256
	speed: 0.0342s/iter; left time: 1227.9482s
Epoch: 13 cost time: 14.991721391677856
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0007962
	speed: 0.1060s/iter; left time: 3797.7868s
	iters: 200, epoch: 14 | loss: 0.1183061
	speed: 0.0344s/iter; left time: 1227.4354s
	iters: 300, epoch: 14 | loss: 0.0001192
	speed: 0.0343s/iter; left time: 1222.8844s
	iters: 400, epoch: 14 | loss: 0.0032759
	speed: 0.0319s/iter; left time: 1132.8205s
Epoch: 14 cost time: 14.36262321472168
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0451232
	speed: 0.1045s/iter; left time: 3699.6125s
	iters: 200, epoch: 15 | loss: 0.0032419
	speed: 0.0344s/iter; left time: 1215.4773s
	iters: 300, epoch: 15 | loss: 0.0009570
	speed: 0.0339s/iter; left time: 1194.3625s
	iters: 400, epoch: 15 | loss: 0.0042413
	speed: 0.0350s/iter; left time: 1229.8561s
Epoch: 15 cost time: 14.540183544158936
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0001480
	speed: 0.1057s/iter; left time: 3699.6944s
	iters: 200, epoch: 16 | loss: 0.0000095
	speed: 0.0351s/iter; left time: 1226.0094s
	iters: 300, epoch: 16 | loss: 0.0042204
	speed: 0.0371s/iter; left time: 1292.7841s
	iters: 400, epoch: 16 | loss: 0.0004429
	speed: 0.0355s/iter; left time: 1231.2786s
Epoch: 16 cost time: 14.991801261901855
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0103457
	speed: 0.1023s/iter; left time: 3540.2763s
	iters: 200, epoch: 17 | loss: 0.0017002
	speed: 0.0394s/iter; left time: 1358.5350s
	iters: 300, epoch: 17 | loss: 0.0032631
	speed: 0.0399s/iter; left time: 1373.7450s
	iters: 400, epoch: 17 | loss: 0.0000136
	speed: 0.0393s/iter; left time: 1346.2681s
Epoch: 17 cost time: 16.592681407928467
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000043
	speed: 0.1142s/iter; left time: 3904.2823s
	iters: 200, epoch: 18 | loss: 0.0000679
	speed: 0.0371s/iter; left time: 1264.0493s
	iters: 300, epoch: 18 | loss: 0.0447122
	speed: 0.0397s/iter; left time: 1349.9954s
	iters: 400, epoch: 18 | loss: 0.0001263
	speed: 0.0391s/iter; left time: 1324.2080s
Epoch: 18 cost time: 16.36443567276001
Epoch: 18, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 168626
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4877430
	speed: 0.0522s/iter; left time: 2151.9555s
	iters: 200, epoch: 1 | loss: 0.5007407
	speed: 0.0366s/iter; left time: 1503.3807s
	iters: 300, epoch: 1 | loss: 0.2869892
	speed: 0.0373s/iter; left time: 1529.4948s
	iters: 400, epoch: 1 | loss: 0.1082614
	speed: 0.0337s/iter; left time: 1376.5486s
Epoch: 1 cost time: 16.493126392364502
Epoch: 1, Steps: 413 | Train Loss: 0.861 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
Validation loss decreased (inf --> -0.947702).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0987184
	speed: 0.1080s/iter; left time: 4404.8349s
	iters: 200, epoch: 2 | loss: 0.1698170
	speed: 0.0379s/iter; left time: 1543.3792s
	iters: 300, epoch: 2 | loss: 0.0532708
	speed: 0.0390s/iter; left time: 1584.6723s
	iters: 400, epoch: 2 | loss: 0.0471967
	speed: 0.0343s/iter; left time: 1388.6528s
Epoch: 2 cost time: 15.639155149459839
Epoch: 2, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.098 Vali Acc: 0.966 Test Loss: 0.098 Test Acc: 0.966
Validation loss decreased (-0.947702 --> -0.965893).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0053162
	speed: 0.1084s/iter; left time: 4374.7235s
	iters: 200, epoch: 3 | loss: 0.0152538
	speed: 0.0365s/iter; left time: 1471.7039s
	iters: 300, epoch: 3 | loss: 0.3063946
	speed: 0.0356s/iter; left time: 1429.2486s
	iters: 400, epoch: 3 | loss: 0.0216580
	speed: 0.0351s/iter; left time: 1406.1184s
Epoch: 3 cost time: 15.353332281112671
Epoch: 3, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.965893 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0755981
	speed: 0.1059s/iter; left time: 4231.0213s
	iters: 200, epoch: 4 | loss: 0.0131117
	speed: 0.0364s/iter; left time: 1450.8755s
	iters: 300, epoch: 4 | loss: 0.0088747
	speed: 0.0382s/iter; left time: 1519.5637s
	iters: 400, epoch: 4 | loss: 0.0093587
	speed: 0.0384s/iter; left time: 1523.8661s
Epoch: 4 cost time: 15.542567014694214
Epoch: 4, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.061 Vali Acc: 0.976 Test Loss: 0.061 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0844825
	speed: 0.1123s/iter; left time: 4440.5624s
	iters: 200, epoch: 5 | loss: 0.0457658
	speed: 0.0377s/iter; left time: 1487.6350s
	iters: 300, epoch: 5 | loss: 0.2748405
	speed: 0.0383s/iter; left time: 1507.2160s
	iters: 400, epoch: 5 | loss: 0.0041909
	speed: 0.0393s/iter; left time: 1540.7079s
Epoch: 5 cost time: 16.266059398651123
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0229865
	speed: 0.1109s/iter; left time: 4339.7091s
	iters: 200, epoch: 6 | loss: 0.0073165
	speed: 0.0383s/iter; left time: 1494.7616s
	iters: 300, epoch: 6 | loss: 0.0066907
	speed: 0.0390s/iter; left time: 1518.1696s
	iters: 400, epoch: 6 | loss: 0.1115616
	speed: 0.0384s/iter; left time: 1492.4004s
Epoch: 6 cost time: 16.060498237609863
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0543857
	speed: 0.1117s/iter; left time: 4326.9727s
	iters: 200, epoch: 7 | loss: 0.0075350
	speed: 0.0376s/iter; left time: 1450.8049s
	iters: 300, epoch: 7 | loss: 0.0023304
	speed: 0.0350s/iter; left time: 1349.5164s
	iters: 400, epoch: 7 | loss: 0.0725769
	speed: 0.0367s/iter; left time: 1411.8698s
Epoch: 7 cost time: 15.54138970375061
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.115 Vali Acc: 0.964 Test Loss: 0.115 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0028996
	speed: 0.1073s/iter; left time: 4110.4496s
	iters: 200, epoch: 8 | loss: 0.0031619
	speed: 0.0358s/iter; left time: 1368.3947s
	iters: 300, epoch: 8 | loss: 0.0026977
	speed: 0.0348s/iter; left time: 1324.5657s
	iters: 400, epoch: 8 | loss: 0.0010846
	speed: 0.0348s/iter; left time: 1323.3263s
Epoch: 8 cost time: 14.764901161193848
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.053 Vali Acc: 0.980 Test Loss: 0.053 Test Acc: 0.980
Validation loss decreased (-0.976807 --> -0.979536).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0024232
	speed: 0.1072s/iter; left time: 4062.8490s
	iters: 200, epoch: 9 | loss: 0.0010484
	speed: 0.0350s/iter; left time: 1322.8058s
	iters: 300, epoch: 9 | loss: 0.0381547
	speed: 0.0357s/iter; left time: 1344.9799s
	iters: 400, epoch: 9 | loss: 0.0001554
	speed: 0.0393s/iter; left time: 1477.7598s
Epoch: 9 cost time: 15.518600225448608
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979536 --> -0.980445).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0013942
	speed: 0.1078s/iter; left time: 4041.9709s
	iters: 200, epoch: 10 | loss: 0.0010425
	speed: 0.0412s/iter; left time: 1540.1811s
	iters: 300, epoch: 10 | loss: 0.0211562
	speed: 0.0426s/iter; left time: 1589.1922s
	iters: 400, epoch: 10 | loss: 0.0016147
	speed: 0.0385s/iter; left time: 1433.2608s
Epoch: 10 cost time: 16.659462690353394
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0013785
	speed: 0.1105s/iter; left time: 4097.7013s
	iters: 200, epoch: 11 | loss: 0.0000926
	speed: 0.0372s/iter; left time: 1375.5443s
	iters: 300, epoch: 11 | loss: 0.0001302
	speed: 0.0357s/iter; left time: 1315.6742s
	iters: 400, epoch: 11 | loss: 0.0001475
	speed: 0.0381s/iter; left time: 1400.5137s
Epoch: 11 cost time: 15.496755361557007
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0006440
	speed: 0.1149s/iter; left time: 4210.6892s
	iters: 200, epoch: 12 | loss: 0.0002915
	speed: 0.0368s/iter; left time: 1346.3026s
	iters: 300, epoch: 12 | loss: 0.0003259
	speed: 0.0374s/iter; left time: 1362.9789s
	iters: 400, epoch: 12 | loss: 0.0230071
	speed: 0.0388s/iter; left time: 1411.3522s
Epoch: 12 cost time: 15.682437658309937
Epoch: 12, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000954
	speed: 0.1097s/iter; left time: 3976.6080s
	iters: 200, epoch: 13 | loss: 0.0007646
	speed: 0.0365s/iter; left time: 1320.2614s
	iters: 300, epoch: 13 | loss: 0.0001873
	speed: 0.0363s/iter; left time: 1307.7906s
	iters: 400, epoch: 13 | loss: 0.0000936
	speed: 0.0383s/iter; left time: 1375.8676s
Epoch: 13 cost time: 15.499878883361816
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0127348
	speed: 0.1109s/iter; left time: 3972.7391s
	iters: 200, epoch: 14 | loss: 0.0075609
	speed: 0.0359s/iter; left time: 1283.7439s
	iters: 300, epoch: 14 | loss: 0.0002942
	speed: 0.0382s/iter; left time: 1360.1574s
	iters: 400, epoch: 14 | loss: 0.1122812
	speed: 0.0356s/iter; left time: 1264.8548s
Epoch: 14 cost time: 15.56749439239502
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000599
	speed: 0.1096s/iter; left time: 3881.7538s
	iters: 200, epoch: 15 | loss: 0.0000268
	speed: 0.0380s/iter; left time: 1343.7252s
	iters: 300, epoch: 15 | loss: 0.0004890
	speed: 0.0355s/iter; left time: 1249.2753s
	iters: 400, epoch: 15 | loss: 0.0059406
	speed: 0.0376s/iter; left time: 1320.9078s
Epoch: 15 cost time: 15.569291591644287
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.054 Vali Acc: 0.986 Test Loss: 0.054 Test Acc: 0.986
Validation loss decreased (-0.980445 --> -0.986357).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0180976
	speed: 0.1136s/iter; left time: 3975.0353s
	iters: 200, epoch: 16 | loss: 0.0001495
	speed: 0.0350s/iter; left time: 1222.6138s
	iters: 300, epoch: 16 | loss: 0.0019024
	speed: 0.0371s/iter; left time: 1291.5258s
	iters: 400, epoch: 16 | loss: 0.0052930
	speed: 0.0371s/iter; left time: 1285.9905s
Epoch: 16 cost time: 15.34569525718689
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0002896
	speed: 0.1131s/iter; left time: 3911.9134s
	iters: 200, epoch: 17 | loss: 0.0001275
	speed: 0.0368s/iter; left time: 1270.7354s
	iters: 300, epoch: 17 | loss: 0.0017815
	speed: 0.0351s/iter; left time: 1208.6444s
	iters: 400, epoch: 17 | loss: 0.0039393
	speed: 0.0351s/iter; left time: 1204.5714s
Epoch: 17 cost time: 14.972299814224243
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.055 Vali Acc: 0.985 Test Loss: 0.055 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000837
	speed: 0.1156s/iter; left time: 3950.7500s
	iters: 200, epoch: 18 | loss: 0.0002502
	speed: 0.0367s/iter; left time: 1250.0386s
	iters: 300, epoch: 18 | loss: 0.0000304
	speed: 0.0355s/iter; left time: 1205.6935s
	iters: 400, epoch: 18 | loss: 0.0013279
	speed: 0.0348s/iter; left time: 1180.6889s
Epoch: 18 cost time: 15.299998998641968
Epoch: 18, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000315
	speed: 0.1081s/iter; left time: 3649.5628s
	iters: 200, epoch: 19 | loss: 0.0230053
	speed: 0.0354s/iter; left time: 1192.6851s
	iters: 300, epoch: 19 | loss: 0.0008083
	speed: 0.0356s/iter; left time: 1194.2930s
	iters: 400, epoch: 19 | loss: 0.0003184
	speed: 0.0382s/iter; left time: 1277.0978s
Epoch: 19 cost time: 15.34206223487854
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0005580
	speed: 0.1159s/iter; left time: 3864.4760s
	iters: 200, epoch: 20 | loss: 0.0000108
	speed: 0.0375s/iter; left time: 1248.2732s
	iters: 300, epoch: 20 | loss: 0.0008335
	speed: 0.0386s/iter; left time: 1278.1313s
	iters: 400, epoch: 20 | loss: 0.0004620
	speed: 0.0375s/iter; left time: 1240.1616s
Epoch: 20 cost time: 15.997313022613525
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0002165
	speed: 0.1181s/iter; left time: 3889.5767s
	iters: 200, epoch: 21 | loss: 0.0168411
	speed: 0.0369s/iter; left time: 1210.5338s
	iters: 300, epoch: 21 | loss: 0.0011017
	speed: 0.0382s/iter; left time: 1251.3613s
	iters: 400, epoch: 21 | loss: 0.0000046
	speed: 0.0356s/iter; left time: 1163.1267s
Epoch: 21 cost time: 15.600381135940552
Epoch: 21, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000506
	speed: 0.1082s/iter; left time: 3520.5651s
	iters: 200, epoch: 22 | loss: 0.0000985
	speed: 0.0343s/iter; left time: 1110.8362s
	iters: 300, epoch: 22 | loss: 0.0786226
	speed: 0.0375s/iter; left time: 1211.0492s
	iters: 400, epoch: 22 | loss: 0.0013272
	speed: 0.0368s/iter; left time: 1184.5134s
Epoch: 22 cost time: 15.289257526397705
Epoch: 22, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000297
	speed: 0.1117s/iter; left time: 3585.7166s
	iters: 200, epoch: 23 | loss: 0.0006733
	speed: 0.0373s/iter; left time: 1194.7514s
	iters: 300, epoch: 23 | loss: 0.0000409
	speed: 0.0370s/iter; left time: 1181.0759s
	iters: 400, epoch: 23 | loss: 0.0006270
	speed: 0.0365s/iter; left time: 1160.8908s
Epoch: 23 cost time: 15.540427446365356
Epoch: 23, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0009291
	speed: 0.1184s/iter; left time: 3752.3876s
	iters: 200, epoch: 24 | loss: 0.0017870
	speed: 0.0388s/iter; left time: 1227.6941s
	iters: 300, epoch: 24 | loss: 0.0001168
	speed: 0.0381s/iter; left time: 1199.1123s
	iters: 400, epoch: 24 | loss: 0.0051997
	speed: 0.0388s/iter; left time: 1218.3786s
Epoch: 24 cost time: 16.162368535995483
Epoch: 24, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000233
	speed: 0.1142s/iter; left time: 3573.3903s
	iters: 200, epoch: 25 | loss: 0.0000134
	speed: 0.0344s/iter; left time: 1071.8271s
	iters: 300, epoch: 25 | loss: 0.0000582
	speed: 0.0367s/iter; left time: 1139.6263s
	iters: 400, epoch: 25 | loss: 0.0001266
	speed: 0.0373s/iter; left time: 1155.9865s
Epoch: 25 cost time: 15.293396711349487
Epoch: 25, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 168626
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0783672
	speed: 0.0518s/iter; left time: 2134.6405s
	iters: 200, epoch: 1 | loss: 0.3457076
	speed: 0.0355s/iter; left time: 1460.2189s
	iters: 300, epoch: 1 | loss: 0.1845154
	speed: 0.0347s/iter; left time: 1424.3009s
	iters: 400, epoch: 1 | loss: 0.3760539
	speed: 0.0354s/iter; left time: 1446.4714s
Epoch: 1 cost time: 16.258537530899048
Epoch: 1, Steps: 413 | Train Loss: 0.709 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
Validation loss decreased (inf --> -0.965892).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0238918
	speed: 0.1123s/iter; left time: 4580.0198s
	iters: 200, epoch: 2 | loss: 0.0729883
	speed: 0.0369s/iter; left time: 1501.2930s
	iters: 300, epoch: 2 | loss: 0.2672945
	speed: 0.0371s/iter; left time: 1506.4428s
	iters: 400, epoch: 2 | loss: 0.0206808
	speed: 0.0373s/iter; left time: 1509.7690s
Epoch: 2 cost time: 15.771021604537964
Epoch: 2, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (-0.965892 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0924100
	speed: 0.1230s/iter; left time: 4966.1838s
	iters: 200, epoch: 3 | loss: 0.0036686
	speed: 0.0407s/iter; left time: 1638.1822s
	iters: 300, epoch: 3 | loss: 0.0054936
	speed: 0.0373s/iter; left time: 1500.0244s
	iters: 400, epoch: 3 | loss: 0.0220336
	speed: 0.0363s/iter; left time: 1452.8440s
Epoch: 3 cost time: 16.298208475112915
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.101 Vali Acc: 0.966 Test Loss: 0.101 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0186563
	speed: 0.1131s/iter; left time: 4518.4290s
	iters: 200, epoch: 4 | loss: 0.0824345
	speed: 0.0362s/iter; left time: 1442.2095s
	iters: 300, epoch: 4 | loss: 0.1164292
	speed: 0.0360s/iter; left time: 1432.4557s
	iters: 400, epoch: 4 | loss: 0.0100685
	speed: 0.0368s/iter; left time: 1461.4964s
Epoch: 4 cost time: 15.44618272781372
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.969076 --> -0.977262).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2368953
	speed: 0.1191s/iter; left time: 4711.2822s
	iters: 200, epoch: 5 | loss: 0.0077458
	speed: 0.0372s/iter; left time: 1467.1194s
	iters: 300, epoch: 5 | loss: 0.0019869
	speed: 0.0373s/iter; left time: 1466.5509s
	iters: 400, epoch: 5 | loss: 0.0019903
	speed: 0.0352s/iter; left time: 1382.4467s
Epoch: 5 cost time: 15.546704769134521
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.063 Vali Acc: 0.976 Test Loss: 0.063 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0007294
	speed: 0.1148s/iter; left time: 4492.4507s
	iters: 200, epoch: 6 | loss: 0.0017051
	speed: 0.0375s/iter; left time: 1462.0374s
	iters: 300, epoch: 6 | loss: 0.0402456
	speed: 0.0364s/iter; left time: 1415.4666s
	iters: 400, epoch: 6 | loss: 0.0002103
	speed: 0.0372s/iter; left time: 1444.0701s
Epoch: 6 cost time: 15.575449466705322
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.977262 --> -0.979535).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0117844
	speed: 0.1175s/iter; left time: 4550.4657s
	iters: 200, epoch: 7 | loss: 0.0144948
	speed: 0.0374s/iter; left time: 1444.8048s
	iters: 300, epoch: 7 | loss: 0.0328562
	speed: 0.0379s/iter; left time: 1460.5358s
	iters: 400, epoch: 7 | loss: 0.0016723
	speed: 0.0363s/iter; left time: 1396.3668s
Epoch: 7 cost time: 15.852275371551514
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0024067
	speed: 0.1113s/iter; left time: 4265.0075s
	iters: 200, epoch: 8 | loss: 0.0126818
	speed: 0.0356s/iter; left time: 1361.1375s
	iters: 300, epoch: 8 | loss: 0.1056530
	speed: 0.0366s/iter; left time: 1393.2937s
	iters: 400, epoch: 8 | loss: 0.0076409
	speed: 0.0362s/iter; left time: 1376.5967s
Epoch: 8 cost time: 15.183201551437378
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.068 Vali Acc: 0.982 Test Loss: 0.068 Test Acc: 0.982
Validation loss decreased (-0.979535 --> -0.981809).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0309159
	speed: 0.1138s/iter; left time: 4314.5492s
	iters: 200, epoch: 9 | loss: 0.0012757
	speed: 0.0400s/iter; left time: 1510.8224s
	iters: 300, epoch: 9 | loss: 0.0077747
	speed: 0.0372s/iter; left time: 1401.9312s
	iters: 400, epoch: 9 | loss: 0.0108645
	speed: 0.0361s/iter; left time: 1358.3886s
Epoch: 9 cost time: 15.920181512832642
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.062 Vali Acc: 0.981 Test Loss: 0.062 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0014721
	speed: 0.1128s/iter; left time: 4229.3387s
	iters: 200, epoch: 10 | loss: 0.0020739
	speed: 0.0378s/iter; left time: 1412.0435s
	iters: 300, epoch: 10 | loss: 0.0216377
	speed: 0.0371s/iter; left time: 1384.3579s
	iters: 400, epoch: 10 | loss: 0.0028594
	speed: 0.0359s/iter; left time: 1334.0733s
Epoch: 10 cost time: 15.449499368667603
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0143819
	speed: 0.1178s/iter; left time: 4366.0800s
	iters: 200, epoch: 11 | loss: 0.0005874
	speed: 0.0368s/iter; left time: 1359.9321s
	iters: 300, epoch: 11 | loss: 0.1456642
	speed: 0.0387s/iter; left time: 1425.2603s
	iters: 400, epoch: 11 | loss: 0.0006396
	speed: 0.0375s/iter; left time: 1377.1795s
Epoch: 11 cost time: 15.774399042129517
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0001993
	speed: 0.1097s/iter; left time: 4020.9820s
	iters: 200, epoch: 12 | loss: 0.0003232
	speed: 0.0355s/iter; left time: 1298.1166s
	iters: 300, epoch: 12 | loss: 0.0000441
	speed: 0.0371s/iter; left time: 1351.3419s
	iters: 400, epoch: 12 | loss: 0.0002535
	speed: 0.0350s/iter; left time: 1273.3627s
Epoch: 12 cost time: 15.254467248916626
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0027871
	speed: 0.1145s/iter; left time: 4151.8039s
	iters: 200, epoch: 13 | loss: 0.0036565
	speed: 0.0368s/iter; left time: 1329.3837s
	iters: 300, epoch: 13 | loss: 0.0000217
	speed: 0.0358s/iter; left time: 1291.9504s
	iters: 400, epoch: 13 | loss: 0.0004349
	speed: 0.0373s/iter; left time: 1342.0672s
Epoch: 13 cost time: 15.38650631904602
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0810890
	speed: 0.1150s/iter; left time: 4119.8644s
	iters: 200, epoch: 14 | loss: 0.0024185
	speed: 0.0378s/iter; left time: 1351.5271s
	iters: 300, epoch: 14 | loss: 0.0078531
	speed: 0.0363s/iter; left time: 1293.7221s
	iters: 400, epoch: 14 | loss: 0.0003751
	speed: 0.0373s/iter; left time: 1324.5369s
Epoch: 14 cost time: 15.663419961929321
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000559
	speed: 0.1199s/iter; left time: 4245.8101s
	iters: 200, epoch: 15 | loss: 0.0000054
	speed: 0.0385s/iter; left time: 1360.5513s
	iters: 300, epoch: 15 | loss: 0.0000339
	speed: 0.0389s/iter; left time: 1368.8002s
	iters: 400, epoch: 15 | loss: 0.0002925
	speed: 0.0383s/iter; left time: 1344.5445s
Epoch: 15 cost time: 16.344138383865356
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.981809 --> -0.983173).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0002858
	speed: 0.1158s/iter; left time: 4052.1029s
	iters: 200, epoch: 16 | loss: 0.0001179
	speed: 0.0375s/iter; left time: 1310.3701s
	iters: 300, epoch: 16 | loss: 0.0234956
	speed: 0.0374s/iter; left time: 1301.5538s
	iters: 400, epoch: 16 | loss: 0.0000120
	speed: 0.0385s/iter; left time: 1335.0513s
Epoch: 16 cost time: 15.964666843414307
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000165
	speed: 0.1179s/iter; left time: 4078.4059s
	iters: 200, epoch: 17 | loss: 0.0001536
	speed: 0.0386s/iter; left time: 1329.9046s
	iters: 300, epoch: 17 | loss: 0.0008262
	speed: 0.0370s/iter; left time: 1273.6892s
	iters: 400, epoch: 17 | loss: 0.0003193
	speed: 0.0366s/iter; left time: 1255.0812s
Epoch: 17 cost time: 15.819828987121582
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.984 Test Loss: 0.089 Test Acc: 0.984
Validation loss decreased (-0.983173 --> -0.983628).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0010854
	speed: 0.1146s/iter; left time: 3916.9523s
	iters: 200, epoch: 18 | loss: 0.0000718
	speed: 0.0382s/iter; left time: 1302.5820s
	iters: 300, epoch: 18 | loss: 0.0057166
	speed: 0.0370s/iter; left time: 1258.6599s
	iters: 400, epoch: 18 | loss: 0.0000337
	speed: 0.0382s/iter; left time: 1294.9526s
Epoch: 18 cost time: 15.92863416671753
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
Validation loss decreased (-0.983628 --> -0.984083).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000819
	speed: 0.1216s/iter; left time: 4105.1132s
	iters: 200, epoch: 19 | loss: 0.0000177
	speed: 0.0391s/iter; left time: 1315.1109s
	iters: 300, epoch: 19 | loss: 0.0011959
	speed: 0.0367s/iter; left time: 1233.5440s
	iters: 400, epoch: 19 | loss: 0.0004514
	speed: 0.0377s/iter; left time: 1262.4813s
Epoch: 19 cost time: 15.899334907531738
Epoch: 19, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
Validation loss decreased (-0.984083 --> -0.986357).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000068
	speed: 0.1264s/iter; left time: 4217.0150s
	iters: 200, epoch: 20 | loss: 0.0000428
	speed: 0.0391s/iter; left time: 1299.7187s
	iters: 300, epoch: 20 | loss: 0.0000345
	speed: 0.0381s/iter; left time: 1264.5910s
	iters: 400, epoch: 20 | loss: 0.5319864
	speed: 0.0380s/iter; left time: 1256.0188s
Epoch: 20 cost time: 16.21333074569702
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0006695
	speed: 0.1204s/iter; left time: 3965.9564s
	iters: 200, epoch: 21 | loss: 0.0153984
	speed: 0.0366s/iter; left time: 1202.7122s
	iters: 300, epoch: 21 | loss: 0.0048403
	speed: 0.0386s/iter; left time: 1264.1109s
	iters: 400, epoch: 21 | loss: 0.0000011
	speed: 0.0371s/iter; left time: 1211.7380s
Epoch: 21 cost time: 15.87783932685852
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.985 Test Loss: 0.092 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000031
	speed: 0.1179s/iter; left time: 3834.9867s
	iters: 200, epoch: 22 | loss: 0.0000054
	speed: 0.0374s/iter; left time: 1212.2525s
	iters: 300, epoch: 22 | loss: 0.0001017
	speed: 0.0380s/iter; left time: 1226.9723s
	iters: 400, epoch: 22 | loss: 0.0055815
	speed: 0.0398s/iter; left time: 1281.9235s
Epoch: 22 cost time: 16.0251681804657
Epoch: 22, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0002180
	speed: 0.1219s/iter; left time: 3914.9342s
	iters: 200, epoch: 23 | loss: 0.0000625
	speed: 0.0389s/iter; left time: 1243.7953s
	iters: 300, epoch: 23 | loss: 0.0013614
	speed: 0.0376s/iter; left time: 1199.6327s
	iters: 400, epoch: 23 | loss: 0.0000258
	speed: 0.0383s/iter; left time: 1220.0763s
Epoch: 23 cost time: 16.189719676971436
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000608
	speed: 0.1229s/iter; left time: 3894.6912s
	iters: 200, epoch: 24 | loss: 0.0000022
	speed: 0.0353s/iter; left time: 1114.1090s
	iters: 300, epoch: 24 | loss: 0.0000023
	speed: 0.0361s/iter; left time: 1136.8339s
	iters: 400, epoch: 24 | loss: 0.0022044
	speed: 0.0344s/iter; left time: 1078.9311s
Epoch: 24 cost time: 15.297072649002075
Epoch: 24, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.1128s/iter; left time: 3529.8977s
	iters: 200, epoch: 25 | loss: 0.0000710
	speed: 0.0349s/iter; left time: 1087.9063s
	iters: 300, epoch: 25 | loss: 0.0005276
	speed: 0.0338s/iter; left time: 1051.9011s
	iters: 400, epoch: 25 | loss: 0.0000003
	speed: 0.0344s/iter; left time: 1065.9655s
Epoch: 25 cost time: 14.679033041000366
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0017875
	speed: 0.1081s/iter; left time: 3336.6528s
	iters: 200, epoch: 26 | loss: 0.0002867
	speed: 0.0342s/iter; left time: 1053.1675s
	iters: 300, epoch: 26 | loss: 0.0007092
	speed: 0.0346s/iter; left time: 1060.0949s
	iters: 400, epoch: 26 | loss: 0.0000070
	speed: 0.0349s/iter; left time: 1066.8206s
Epoch: 26 cost time: 14.638026714324951
Epoch: 26, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000230
	speed: 0.1205s/iter; left time: 3670.9612s
	iters: 200, epoch: 27 | loss: 0.0000010
	speed: 0.0354s/iter; left time: 1074.2697s
	iters: 300, epoch: 27 | loss: 0.0078459
	speed: 0.0351s/iter; left time: 1062.9543s
	iters: 400, epoch: 27 | loss: 0.0006234
	speed: 0.0334s/iter; left time: 1006.2744s
Epoch: 27 cost time: 14.882059335708618
Epoch: 27, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.973 Test Loss: 0.178 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000054
	speed: 0.1212s/iter; left time: 3640.9295s
	iters: 200, epoch: 28 | loss: 0.0001842
	speed: 0.0369s/iter; left time: 1104.8917s
	iters: 300, epoch: 28 | loss: 0.0000001
	speed: 0.0350s/iter; left time: 1044.1683s
	iters: 400, epoch: 28 | loss: 0.0148261
	speed: 0.0342s/iter; left time: 1016.2265s
Epoch: 28 cost time: 15.239925146102905
Epoch: 28, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.971 Test Loss: 0.168 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0001097
	speed: 0.1247s/iter; left time: 3694.5594s
	iters: 200, epoch: 29 | loss: 0.0000014
	speed: 0.0325s/iter; left time: 958.7241s
	iters: 300, epoch: 29 | loss: 0.0048807
	speed: 0.0326s/iter; left time: 960.5629s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 909.1494s
Epoch: 29 cost time: 14.300688028335571
Epoch: 29, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.969 Test Loss: 0.188 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 103090
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1116042
	speed: 0.0550s/iter; left time: 2266.0581s
	iters: 200, epoch: 1 | loss: 0.3655518
	speed: 0.0390s/iter; left time: 1604.3082s
	iters: 300, epoch: 1 | loss: 0.2086441
	speed: 0.0370s/iter; left time: 1516.0103s
	iters: 400, epoch: 1 | loss: 0.3015997
	speed: 0.0389s/iter; left time: 1590.3276s
Epoch: 1 cost time: 17.603789806365967
Epoch: 1, Steps: 413 | Train Loss: 0.714 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (inf --> -0.967257).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0235136
	speed: 0.1151s/iter; left time: 4693.4825s
	iters: 200, epoch: 2 | loss: 0.0671736
	speed: 0.0380s/iter; left time: 1546.6349s
	iters: 300, epoch: 2 | loss: 0.3120070
	speed: 0.0360s/iter; left time: 1461.2578s
	iters: 400, epoch: 2 | loss: 0.0198109
	speed: 0.0378s/iter; left time: 1531.0452s
Epoch: 2 cost time: 15.669954299926758
Epoch: 2, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
Validation loss decreased (-0.967257 --> -0.967712).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1020514
	speed: 0.1203s/iter; left time: 4856.1445s
	iters: 200, epoch: 3 | loss: 0.0049758
	speed: 0.0382s/iter; left time: 1536.8912s
	iters: 300, epoch: 3 | loss: 0.0141540
	speed: 0.0394s/iter; left time: 1581.0742s
	iters: 400, epoch: 3 | loss: 0.0325966
	speed: 0.0379s/iter; left time: 1518.3227s
Epoch: 3 cost time: 16.488086938858032
Epoch: 3, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.967712 --> -0.968621).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0688076
	speed: 0.1238s/iter; left time: 4948.7008s
	iters: 200, epoch: 4 | loss: 0.0450719
	speed: 0.0396s/iter; left time: 1579.6582s
	iters: 300, epoch: 4 | loss: 0.0651610
	speed: 0.0384s/iter; left time: 1525.9999s
	iters: 400, epoch: 4 | loss: 0.0222003
	speed: 0.0397s/iter; left time: 1573.1442s
Epoch: 4 cost time: 16.71165943145752
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.064 Vali Acc: 0.976 Test Loss: 0.064 Test Acc: 0.976
Validation loss decreased (-0.968621 --> -0.976352).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0499463
	speed: 0.1210s/iter; left time: 4787.3465s
	iters: 200, epoch: 5 | loss: 0.0106770
	speed: 0.0381s/iter; left time: 1502.9802s
	iters: 300, epoch: 5 | loss: 0.0014163
	speed: 0.0384s/iter; left time: 1509.0816s
	iters: 400, epoch: 5 | loss: 0.0052355
	speed: 0.0358s/iter; left time: 1404.5303s
Epoch: 5 cost time: 15.798025608062744
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.049 Vali Acc: 0.983 Test Loss: 0.049 Test Acc: 0.983
Validation loss decreased (-0.976352 --> -0.982719).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0011281
	speed: 0.1117s/iter; left time: 4371.6408s
	iters: 200, epoch: 6 | loss: 0.0010583
	speed: 0.0358s/iter; left time: 1398.1536s
	iters: 300, epoch: 6 | loss: 0.0984449
	speed: 0.0344s/iter; left time: 1339.8806s
	iters: 400, epoch: 6 | loss: 0.0001653
	speed: 0.0360s/iter; left time: 1399.1406s
Epoch: 6 cost time: 15.029512882232666
Epoch: 6, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0128620
	speed: 0.1123s/iter; left time: 4349.9418s
	iters: 200, epoch: 7 | loss: 0.0048216
	speed: 0.0371s/iter; left time: 1431.8521s
	iters: 300, epoch: 7 | loss: 0.0340908
	speed: 0.0366s/iter; left time: 1409.3382s
	iters: 400, epoch: 7 | loss: 0.0079062
	speed: 0.0368s/iter; left time: 1413.9584s
Epoch: 7 cost time: 15.591049194335938
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0029212
	speed: 0.1257s/iter; left time: 4814.9635s
	iters: 200, epoch: 8 | loss: 0.0039463
	speed: 0.0377s/iter; left time: 1441.3648s
	iters: 300, epoch: 8 | loss: 0.0006022
	speed: 0.0390s/iter; left time: 1487.6168s
	iters: 400, epoch: 8 | loss: 0.0021838
	speed: 0.0390s/iter; left time: 1481.5604s
Epoch: 8 cost time: 16.25214409828186
Epoch: 8, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
Validation loss decreased (-0.982719 --> -0.983628).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0007466
	speed: 0.1204s/iter; left time: 4563.8686s
	iters: 200, epoch: 9 | loss: 0.0015437
	speed: 0.0368s/iter; left time: 1392.1777s
	iters: 300, epoch: 9 | loss: 0.0040508
	speed: 0.0362s/iter; left time: 1364.6247s
	iters: 400, epoch: 9 | loss: 0.0019129
	speed: 0.0370s/iter; left time: 1390.2983s
Epoch: 9 cost time: 15.516278743743896
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0008349
	speed: 0.1163s/iter; left time: 4359.8389s
	iters: 200, epoch: 10 | loss: 0.0059636
	speed: 0.0381s/iter; left time: 1424.2866s
	iters: 300, epoch: 10 | loss: 0.0256029
	speed: 0.0374s/iter; left time: 1395.2871s
	iters: 400, epoch: 10 | loss: 0.0034366
	speed: 0.0376s/iter; left time: 1399.2972s
Epoch: 10 cost time: 15.937090635299683
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0779993
	speed: 0.1185s/iter; left time: 4394.4757s
	iters: 200, epoch: 11 | loss: 0.0000486
	speed: 0.0377s/iter; left time: 1394.2987s
	iters: 300, epoch: 11 | loss: 0.0325371
	speed: 0.0376s/iter; left time: 1385.5543s
	iters: 400, epoch: 11 | loss: 0.0003424
	speed: 0.0394s/iter; left time: 1447.6885s
Epoch: 11 cost time: 16.15221095085144
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000345
	speed: 0.1241s/iter; left time: 4550.1958s
	iters: 200, epoch: 12 | loss: 0.0017347
	speed: 0.0381s/iter; left time: 1393.1655s
	iters: 300, epoch: 12 | loss: 0.0001662
	speed: 0.0393s/iter; left time: 1432.2564s
	iters: 400, epoch: 12 | loss: 0.0001961
	speed: 0.0383s/iter; left time: 1393.6082s
Epoch: 12 cost time: 16.403639316558838
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0193725
	speed: 0.1229s/iter; left time: 4454.7658s
	iters: 200, epoch: 13 | loss: 0.0031190
	speed: 0.0374s/iter; left time: 1350.9294s
	iters: 300, epoch: 13 | loss: 0.0000069
	speed: 0.0373s/iter; left time: 1345.3719s
	iters: 400, epoch: 13 | loss: 0.0000283
	speed: 0.0378s/iter; left time: 1359.1366s
Epoch: 13 cost time: 15.932771921157837
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.068 Vali Acc: 0.982 Test Loss: 0.068 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0009815
	speed: 0.1244s/iter; left time: 4456.3932s
	iters: 200, epoch: 14 | loss: 0.2305890
	speed: 0.0384s/iter; left time: 1373.6362s
	iters: 300, epoch: 14 | loss: 0.1495576
	speed: 0.0368s/iter; left time: 1312.3556s
	iters: 400, epoch: 14 | loss: 0.0000960
	speed: 0.0366s/iter; left time: 1299.9886s
Epoch: 14 cost time: 15.988747596740723
Epoch: 14, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000694
	speed: 0.1217s/iter; left time: 4309.2241s
	iters: 200, epoch: 15 | loss: 0.1073923
	speed: 0.0361s/iter; left time: 1275.6597s
	iters: 300, epoch: 15 | loss: 0.0000321
	speed: 0.0373s/iter; left time: 1312.9772s
	iters: 400, epoch: 15 | loss: 0.1148494
	speed: 0.0388s/iter; left time: 1360.9588s
Epoch: 15 cost time: 15.830626487731934
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0004730
	speed: 0.1255s/iter; left time: 4391.7037s
	iters: 200, epoch: 16 | loss: 0.0058066
	speed: 0.0379s/iter; left time: 1324.5564s
	iters: 300, epoch: 16 | loss: 0.0017104
	speed: 0.0384s/iter; left time: 1335.8958s
	iters: 400, epoch: 16 | loss: 0.0015002
	speed: 0.0391s/iter; left time: 1358.1334s
Epoch: 16 cost time: 16.385587453842163
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000064
	speed: 0.1294s/iter; left time: 4475.3356s
	iters: 200, epoch: 17 | loss: 0.0002088
	speed: 0.0366s/iter; left time: 1262.4018s
	iters: 300, epoch: 17 | loss: 0.0000386
	speed: 0.0396s/iter; left time: 1363.1155s
	iters: 400, epoch: 17 | loss: 0.0000037
	speed: 0.0387s/iter; left time: 1326.5018s
Epoch: 17 cost time: 16.34839415550232
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000151
	speed: 0.1184s/iter; left time: 4047.7876s
	iters: 200, epoch: 18 | loss: 0.0000022
	speed: 0.0362s/iter; left time: 1232.7611s
	iters: 300, epoch: 18 | loss: 0.0000011
	speed: 0.0367s/iter; left time: 1247.1075s
	iters: 400, epoch: 18 | loss: 0.0002061
	speed: 0.0369s/iter; left time: 1251.8237s
Epoch: 18 cost time: 15.671550273895264
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 103090
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1921418
	speed: 0.0546s/iter; left time: 2249.9116s
	iters: 200, epoch: 1 | loss: 0.4085245
	speed: 0.0364s/iter; left time: 1494.4087s
	iters: 300, epoch: 1 | loss: 0.2375033
	speed: 0.0362s/iter; left time: 1485.9031s
	iters: 400, epoch: 1 | loss: 0.3264508
	speed: 0.0355s/iter; left time: 1450.5361s
Epoch: 1 cost time: 16.786723852157593
Epoch: 1, Steps: 413 | Train Loss: 0.739 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
Validation loss decreased (inf --> -0.960435).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0317032
	speed: 0.1198s/iter; left time: 4886.4936s
	iters: 200, epoch: 2 | loss: 0.0552942
	speed: 0.0375s/iter; left time: 1525.0805s
	iters: 300, epoch: 2 | loss: 0.3670245
	speed: 0.0372s/iter; left time: 1508.0902s
	iters: 400, epoch: 2 | loss: 0.0283597
	speed: 0.0352s/iter; left time: 1424.1747s
Epoch: 2 cost time: 15.846885919570923
Epoch: 2, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.960435 --> -0.969531).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0634421
	speed: 0.1086s/iter; left time: 4383.4678s
	iters: 200, epoch: 3 | loss: 0.0052093
	speed: 0.0352s/iter; left time: 1418.2557s
	iters: 300, epoch: 3 | loss: 0.0058564
	speed: 0.0334s/iter; left time: 1342.8815s
	iters: 400, epoch: 3 | loss: 0.0276795
	speed: 0.0342s/iter; left time: 1372.5515s
Epoch: 3 cost time: 14.453614234924316
Epoch: 3, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0727707
	speed: 0.1089s/iter; left time: 4351.4337s
	iters: 200, epoch: 4 | loss: 0.0859143
	speed: 0.0357s/iter; left time: 1422.5016s
	iters: 300, epoch: 4 | loss: 0.2612719
	speed: 0.0340s/iter; left time: 1352.9562s
	iters: 400, epoch: 4 | loss: 0.0061516
	speed: 0.0355s/iter; left time: 1406.7124s
Epoch: 4 cost time: 14.878839492797852
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.068 Vali Acc: 0.976 Test Loss: 0.068 Test Acc: 0.976
Validation loss decreased (-0.969531 --> -0.975897).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0589741
	speed: 0.1126s/iter; left time: 4452.3827s
	iters: 200, epoch: 5 | loss: 0.0053052
	speed: 0.0362s/iter; left time: 1428.8380s
	iters: 300, epoch: 5 | loss: 0.0117268
	speed: 0.0387s/iter; left time: 1524.4443s
	iters: 400, epoch: 5 | loss: 0.0032087
	speed: 0.0375s/iter; left time: 1472.0029s
Epoch: 5 cost time: 15.743501663208008
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0018032
	speed: 0.1257s/iter; left time: 4917.7027s
	iters: 200, epoch: 6 | loss: 0.0013563
	speed: 0.0382s/iter; left time: 1492.2561s
	iters: 300, epoch: 6 | loss: 0.0811903
	speed: 0.0384s/iter; left time: 1493.5854s
	iters: 400, epoch: 6 | loss: 0.0000652
	speed: 0.0376s/iter; left time: 1460.9479s
Epoch: 6 cost time: 16.003024578094482
Epoch: 6, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.975897 --> -0.979535).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0141313
	speed: 0.1199s/iter; left time: 4643.2191s
	iters: 200, epoch: 7 | loss: 0.0025954
	speed: 0.0371s/iter; left time: 1433.1670s
	iters: 300, epoch: 7 | loss: 0.0050665
	speed: 0.0362s/iter; left time: 1394.8331s
	iters: 400, epoch: 7 | loss: 0.0132809
	speed: 0.0362s/iter; left time: 1390.9628s
Epoch: 7 cost time: 15.674176931381226
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.049 Vali Acc: 0.981 Test Loss: 0.049 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.980900).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0075243
	speed: 0.1110s/iter; left time: 4251.4683s
	iters: 200, epoch: 8 | loss: 0.0013933
	speed: 0.0360s/iter; left time: 1375.0739s
	iters: 300, epoch: 8 | loss: 0.0093422
	speed: 0.0359s/iter; left time: 1368.6973s
	iters: 400, epoch: 8 | loss: 0.0000731
	speed: 0.0349s/iter; left time: 1327.2793s
Epoch: 8 cost time: 15.020203590393066
Epoch: 8, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0019429
	speed: 0.1151s/iter; left time: 4361.5747s
	iters: 200, epoch: 9 | loss: 0.0861119
	speed: 0.0368s/iter; left time: 1390.3257s
	iters: 300, epoch: 9 | loss: 0.0017916
	speed: 0.0359s/iter; left time: 1352.1407s
	iters: 400, epoch: 9 | loss: 0.0118630
	speed: 0.0356s/iter; left time: 1339.2675s
Epoch: 9 cost time: 15.186232328414917
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
Validation loss decreased (-0.980900 --> -0.982264).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0028876
	speed: 0.1213s/iter; left time: 4546.7901s
	iters: 200, epoch: 10 | loss: 0.0084562
	speed: 0.0398s/iter; left time: 1487.5901s
	iters: 300, epoch: 10 | loss: 0.0285923
	speed: 0.0397s/iter; left time: 1482.0119s
	iters: 400, epoch: 10 | loss: 0.0014721
	speed: 0.0396s/iter; left time: 1473.9120s
Epoch: 10 cost time: 16.798354864120483
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0249748
	speed: 0.1208s/iter; left time: 4478.2504s
	iters: 200, epoch: 11 | loss: 0.0003232
	speed: 0.0369s/iter; left time: 1363.8338s
	iters: 300, epoch: 11 | loss: 0.0398914
	speed: 0.0386s/iter; left time: 1424.3475s
	iters: 400, epoch: 11 | loss: 0.0003108
	speed: 0.0381s/iter; left time: 1402.3533s
Epoch: 11 cost time: 15.957754373550415
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0006897
	speed: 0.1246s/iter; left time: 4569.2513s
	iters: 200, epoch: 12 | loss: 0.0012509
	speed: 0.0386s/iter; left time: 1410.6337s
	iters: 300, epoch: 12 | loss: 0.0006853
	speed: 0.0386s/iter; left time: 1406.5412s
	iters: 400, epoch: 12 | loss: 0.0035268
	speed: 0.0398s/iter; left time: 1446.7204s
Epoch: 12 cost time: 16.653244018554688
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1558654
	speed: 0.1229s/iter; left time: 4453.8765s
	iters: 200, epoch: 13 | loss: 0.0023154
	speed: 0.0389s/iter; left time: 1406.9103s
	iters: 300, epoch: 13 | loss: 0.0000129
	speed: 0.0392s/iter; left time: 1412.0913s
	iters: 400, epoch: 13 | loss: 0.0010670
	speed: 0.0398s/iter; left time: 1430.4613s
Epoch: 13 cost time: 16.64860463142395
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0125169
	speed: 0.1271s/iter; left time: 4553.5680s
	iters: 200, epoch: 14 | loss: 0.0005142
	speed: 0.0397s/iter; left time: 1419.2395s
	iters: 300, epoch: 14 | loss: 0.0008314
	speed: 0.0390s/iter; left time: 1389.7345s
	iters: 400, epoch: 14 | loss: 0.0001299
	speed: 0.0378s/iter; left time: 1344.7586s
Epoch: 14 cost time: 16.56195044517517
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000018
	speed: 0.1229s/iter; left time: 4352.1512s
	iters: 200, epoch: 15 | loss: 0.0000589
	speed: 0.0385s/iter; left time: 1358.9828s
	iters: 300, epoch: 15 | loss: 0.0019164
	speed: 0.0384s/iter; left time: 1352.6727s
	iters: 400, epoch: 15 | loss: 0.0000318
	speed: 0.0382s/iter; left time: 1342.0935s
Epoch: 15 cost time: 16.33504557609558
Epoch: 15, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.051 Vali Acc: 0.988 Test Loss: 0.051 Test Acc: 0.988
Validation loss decreased (-0.982264 --> -0.987721).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0013068
	speed: 0.1241s/iter; left time: 4343.2874s
	iters: 200, epoch: 16 | loss: 0.0217694
	speed: 0.0372s/iter; left time: 1297.1948s
	iters: 300, epoch: 16 | loss: 0.0000795
	speed: 0.0381s/iter; left time: 1327.0561s
	iters: 400, epoch: 16 | loss: 0.0004078
	speed: 0.0377s/iter; left time: 1308.9628s
Epoch: 16 cost time: 16.008483171463013
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0101392
	speed: 0.1249s/iter; left time: 4320.1820s
	iters: 200, epoch: 17 | loss: 0.0000146
	speed: 0.0396s/iter; left time: 1364.5248s
	iters: 300, epoch: 17 | loss: 0.0005499
	speed: 0.0384s/iter; left time: 1321.0384s
	iters: 400, epoch: 17 | loss: 0.0177321
	speed: 0.0396s/iter; left time: 1359.2366s
Epoch: 17 cost time: 16.645344018936157
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000014
	speed: 0.1313s/iter; left time: 4487.8262s
	iters: 200, epoch: 18 | loss: 0.0000025
	speed: 0.0393s/iter; left time: 1338.4854s
	iters: 300, epoch: 18 | loss: 0.0000002
	speed: 0.0389s/iter; left time: 1320.8242s
	iters: 400, epoch: 18 | loss: 0.0046414
	speed: 0.0381s/iter; left time: 1290.0919s
Epoch: 18 cost time: 16.575133800506592
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000015
	speed: 0.1277s/iter; left time: 4311.6191s
	iters: 200, epoch: 19 | loss: 0.0001523
	speed: 0.0377s/iter; left time: 1270.0961s
	iters: 300, epoch: 19 | loss: 0.0000061
	speed: 0.0380s/iter; left time: 1274.7003s
	iters: 400, epoch: 19 | loss: 0.0000292
	speed: 0.0385s/iter; left time: 1290.0968s
Epoch: 19 cost time: 16.364123106002808
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000323
	speed: 0.1214s/iter; left time: 4047.7048s
	iters: 200, epoch: 20 | loss: 0.0003867
	speed: 0.0372s/iter; left time: 1235.5650s
	iters: 300, epoch: 20 | loss: 0.0003884
	speed: 0.0377s/iter; left time: 1248.4997s
	iters: 400, epoch: 20 | loss: 0.1950358
	speed: 0.0373s/iter; left time: 1231.5070s
Epoch: 20 cost time: 15.935850143432617
Epoch: 20, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000526
	speed: 0.1243s/iter; left time: 4095.1777s
	iters: 200, epoch: 21 | loss: 0.0001078
	speed: 0.0404s/iter; left time: 1326.4475s
	iters: 300, epoch: 21 | loss: 0.0003300
	speed: 0.0389s/iter; left time: 1273.2209s
	iters: 400, epoch: 21 | loss: 0.0005656
	speed: 0.0404s/iter; left time: 1318.7572s
Epoch: 21 cost time: 17.014354944229126
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0016164
	speed: 0.1256s/iter; left time: 4084.6934s
	iters: 200, epoch: 22 | loss: 0.0002277
	speed: 0.0381s/iter; left time: 1236.2977s
	iters: 300, epoch: 22 | loss: 0.0000233
	speed: 0.0371s/iter; left time: 1198.0280s
	iters: 400, epoch: 22 | loss: 0.0000077
	speed: 0.0372s/iter; left time: 1198.8773s
Epoch: 22 cost time: 16.063331127166748
Epoch: 22, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000215
	speed: 0.1143s/iter; left time: 3670.6323s
	iters: 200, epoch: 23 | loss: 0.0167700
	speed: 0.0358s/iter; left time: 1146.4306s
	iters: 300, epoch: 23 | loss: 0.0349032
	speed: 0.0373s/iter; left time: 1191.8955s
	iters: 400, epoch: 23 | loss: 0.0001127
	speed: 0.0352s/iter; left time: 1118.4830s
Epoch: 23 cost time: 15.18639612197876
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.061 Vali Acc: 0.984 Test Loss: 0.061 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000020
	speed: 0.1117s/iter; left time: 3541.4799s
	iters: 200, epoch: 24 | loss: 0.0000214
	speed: 0.0344s/iter; left time: 1087.0469s
	iters: 300, epoch: 24 | loss: 0.0030311
	speed: 0.0338s/iter; left time: 1065.2226s
	iters: 400, epoch: 24 | loss: 0.0005248
	speed: 0.0338s/iter; left time: 1062.8650s
Epoch: 24 cost time: 14.635506868362427
Epoch: 24, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000910
	speed: 0.1173s/iter; left time: 3669.0574s
	iters: 200, epoch: 25 | loss: 0.0000001
	speed: 0.0369s/iter; left time: 1151.3283s
	iters: 300, epoch: 25 | loss: 0.0007247
	speed: 0.0360s/iter; left time: 1117.9340s
	iters: 400, epoch: 25 | loss: 0.0000007
	speed: 0.0377s/iter; left time: 1167.2896s
Epoch: 25 cost time: 15.577439546585083
Epoch: 25, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 103090
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4322865
	speed: 0.0550s/iter; left time: 2266.1341s
	iters: 200, epoch: 1 | loss: 0.4114939
	speed: 0.0363s/iter; left time: 1492.1076s
	iters: 300, epoch: 1 | loss: 0.2602276
	speed: 0.0351s/iter; left time: 1438.0132s
	iters: 400, epoch: 1 | loss: 0.4611446
	speed: 0.0336s/iter; left time: 1374.0561s
Epoch: 1 cost time: 16.523876905441284
Epoch: 1, Steps: 413 | Train Loss: 0.848 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
Validation loss decreased (inf --> -0.951795).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0735645
	speed: 0.1103s/iter; left time: 4499.8924s
	iters: 200, epoch: 2 | loss: 0.0842622
	speed: 0.0341s/iter; left time: 1385.5346s
	iters: 300, epoch: 2 | loss: 0.2611611
	speed: 0.0361s/iter; left time: 1465.3478s
	iters: 400, epoch: 2 | loss: 0.0391869
	speed: 0.0347s/iter; left time: 1405.6966s
Epoch: 2 cost time: 14.725504875183105
Epoch: 2, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.951795 --> -0.967712).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1944191
	speed: 0.1116s/iter; left time: 4505.4913s
	iters: 200, epoch: 3 | loss: 0.0115034
	speed: 0.0356s/iter; left time: 1433.2888s
	iters: 300, epoch: 3 | loss: 0.0073016
	speed: 0.0353s/iter; left time: 1416.2825s
	iters: 400, epoch: 3 | loss: 0.0315637
	speed: 0.0338s/iter; left time: 1355.1200s
Epoch: 3 cost time: 14.631664752960205
Epoch: 3, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.967712 --> -0.969531).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0078457
	speed: 0.1151s/iter; left time: 4598.3166s
	iters: 200, epoch: 4 | loss: 0.0536730
	speed: 0.0356s/iter; left time: 1418.0450s
	iters: 300, epoch: 4 | loss: 0.2184814
	speed: 0.0357s/iter; left time: 1418.5800s
	iters: 400, epoch: 4 | loss: 0.0054483
	speed: 0.0354s/iter; left time: 1405.4927s
Epoch: 4 cost time: 15.10069465637207
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.057 Vali Acc: 0.982 Test Loss: 0.057 Test Acc: 0.982
Validation loss decreased (-0.969531 --> -0.981809).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0370371
	speed: 0.1149s/iter; left time: 4545.6377s
	iters: 200, epoch: 5 | loss: 0.0054836
	speed: 0.0363s/iter; left time: 1431.0800s
	iters: 300, epoch: 5 | loss: 0.0119673
	speed: 0.0367s/iter; left time: 1443.6495s
	iters: 400, epoch: 5 | loss: 0.0034823
	speed: 0.0377s/iter; left time: 1477.9034s
Epoch: 5 cost time: 15.506142139434814
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.061 Vali Acc: 0.977 Test Loss: 0.061 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0016748
	speed: 0.1075s/iter; left time: 4207.9483s
	iters: 200, epoch: 6 | loss: 0.0051643
	speed: 0.0356s/iter; left time: 1391.1207s
	iters: 300, epoch: 6 | loss: 0.0759075
	speed: 0.0354s/iter; left time: 1377.6573s
	iters: 400, epoch: 6 | loss: 0.0002091
	speed: 0.0370s/iter; left time: 1437.5082s
Epoch: 6 cost time: 15.086754083633423
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0012792
	speed: 0.1126s/iter; left time: 4359.3544s
	iters: 200, epoch: 7 | loss: 0.0093496
	speed: 0.0351s/iter; left time: 1357.3540s
	iters: 300, epoch: 7 | loss: 0.0180508
	speed: 0.0353s/iter; left time: 1361.5838s
	iters: 400, epoch: 7 | loss: 0.0158828
	speed: 0.0355s/iter; left time: 1365.2381s
Epoch: 7 cost time: 15.060338258743286
Epoch: 7, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0016116
	speed: 0.1134s/iter; left time: 4345.0135s
	iters: 200, epoch: 8 | loss: 0.0051847
	speed: 0.0358s/iter; left time: 1368.7434s
	iters: 300, epoch: 8 | loss: 0.0228094
	speed: 0.0348s/iter; left time: 1327.9792s
	iters: 400, epoch: 8 | loss: 0.0336481
	speed: 0.0358s/iter; left time: 1362.3489s
Epoch: 8 cost time: 14.96793270111084
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0016397
	speed: 0.1125s/iter; left time: 4264.2338s
	iters: 200, epoch: 9 | loss: 0.0027864
	speed: 0.0346s/iter; left time: 1309.6514s
	iters: 300, epoch: 9 | loss: 0.0081861
	speed: 0.0356s/iter; left time: 1342.4678s
	iters: 400, epoch: 9 | loss: 0.0011395
	speed: 0.0356s/iter; left time: 1337.8996s
Epoch: 9 cost time: 14.876672744750977
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0009116
	speed: 0.1130s/iter; left time: 4236.9448s
	iters: 200, epoch: 10 | loss: 0.0168562
	speed: 0.0342s/iter; left time: 1279.6805s
	iters: 300, epoch: 10 | loss: 0.0092570
	speed: 0.0348s/iter; left time: 1295.8909s
	iters: 400, epoch: 10 | loss: 0.0004308
	speed: 0.0345s/iter; left time: 1281.0153s
Epoch: 10 cost time: 14.491903066635132
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1444039
	speed: 0.1130s/iter; left time: 4189.0406s
	iters: 200, epoch: 11 | loss: 0.0000387
	speed: 0.0346s/iter; left time: 1279.9017s
	iters: 300, epoch: 11 | loss: 0.0133475
	speed: 0.0358s/iter; left time: 1320.8038s
	iters: 400, epoch: 11 | loss: 0.0001100
	speed: 0.0344s/iter; left time: 1265.8031s
Epoch: 11 cost time: 14.906803846359253
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0003979
	speed: 0.1125s/iter; left time: 4122.1968s
	iters: 200, epoch: 12 | loss: 0.0036961
	speed: 0.0353s/iter; left time: 1290.3229s
	iters: 300, epoch: 12 | loss: 0.0004220
	speed: 0.0347s/iter; left time: 1264.6660s
	iters: 400, epoch: 12 | loss: 0.0320777
	speed: 0.0379s/iter; left time: 1378.1581s
Epoch: 12 cost time: 15.16162657737732
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0004007
	speed: 0.1208s/iter; left time: 4377.7428s
	iters: 200, epoch: 13 | loss: 0.0007948
	speed: 0.0380s/iter; left time: 1373.3200s
	iters: 300, epoch: 13 | loss: 0.0000537
	speed: 0.0358s/iter; left time: 1291.5313s
	iters: 400, epoch: 13 | loss: 0.0002711
	speed: 0.0380s/iter; left time: 1365.7779s
Epoch: 13 cost time: 15.776319742202759
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0014954
	speed: 0.1198s/iter; left time: 4292.3903s
	iters: 200, epoch: 14 | loss: 0.0002433
	speed: 0.0356s/iter; left time: 1273.1613s
	iters: 300, epoch: 14 | loss: 0.0017133
	speed: 0.0363s/iter; left time: 1293.6482s
	iters: 400, epoch: 14 | loss: 0.0008074
	speed: 0.0371s/iter; left time: 1316.9872s
Epoch: 14 cost time: 15.446199893951416
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 103090
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1637101
	speed: 0.0533s/iter; left time: 2194.9410s
	iters: 200, epoch: 1 | loss: 0.3725141
	speed: 0.0365s/iter; left time: 1498.9387s
	iters: 300, epoch: 1 | loss: 0.1427147
	speed: 0.0348s/iter; left time: 1426.8418s
	iters: 400, epoch: 1 | loss: 0.0812115
	speed: 0.0338s/iter; left time: 1381.2097s
Epoch: 1 cost time: 16.355982542037964
Epoch: 1, Steps: 413 | Train Loss: 0.718 Vali Loss: 0.131 Vali Acc: 0.961 Test Loss: 0.131 Test Acc: 0.961
Validation loss decreased (inf --> -0.961345).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0387457
	speed: 0.1126s/iter; left time: 4592.0613s
	iters: 200, epoch: 2 | loss: 0.0185286
	speed: 0.0370s/iter; left time: 1505.4564s
	iters: 300, epoch: 2 | loss: 0.0683207
	speed: 0.0371s/iter; left time: 1506.3794s
	iters: 400, epoch: 2 | loss: 0.0556957
	speed: 0.0365s/iter; left time: 1476.2647s
Epoch: 2 cost time: 15.519253730773926
Epoch: 2, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.961345 --> -0.973169).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1161752
	speed: 0.1185s/iter; left time: 4785.3853s
	iters: 200, epoch: 3 | loss: 0.0098545
	speed: 0.0373s/iter; left time: 1503.6786s
	iters: 300, epoch: 3 | loss: 0.0385412
	speed: 0.0361s/iter; left time: 1450.0449s
	iters: 400, epoch: 3 | loss: 0.0230730
	speed: 0.0352s/iter; left time: 1411.2328s
Epoch: 3 cost time: 15.409906148910522
Epoch: 3, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.063 Vali Acc: 0.978 Test Loss: 0.063 Test Acc: 0.978
Validation loss decreased (-0.973169 --> -0.978171).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0373371
	speed: 0.1183s/iter; left time: 4728.0168s
	iters: 200, epoch: 4 | loss: 0.0461812
	speed: 0.0357s/iter; left time: 1423.0651s
	iters: 300, epoch: 4 | loss: 0.0480388
	speed: 0.0362s/iter; left time: 1441.3379s
	iters: 400, epoch: 4 | loss: 0.0384884
	speed: 0.0365s/iter; left time: 1445.6896s
Epoch: 4 cost time: 15.432574987411499
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0475428
	speed: 0.1165s/iter; left time: 4606.3168s
	iters: 200, epoch: 5 | loss: 0.0333750
	speed: 0.0366s/iter; left time: 1442.1421s
	iters: 300, epoch: 5 | loss: 0.0334847
	speed: 0.0386s/iter; left time: 1520.0250s
	iters: 400, epoch: 5 | loss: 0.0121680
	speed: 0.0355s/iter; left time: 1394.4008s
Epoch: 5 cost time: 15.403848886489868
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0042885
	speed: 0.1145s/iter; left time: 4479.3158s
	iters: 200, epoch: 6 | loss: 0.3251631
	speed: 0.0347s/iter; left time: 1353.0421s
	iters: 300, epoch: 6 | loss: 0.0002205
	speed: 0.0397s/iter; left time: 1544.4119s
	iters: 400, epoch: 6 | loss: 0.0051620
	speed: 0.0369s/iter; left time: 1432.4906s
Epoch: 6 cost time: 15.553362607955933
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0080267
	speed: 0.1198s/iter; left time: 4639.8632s
	iters: 200, epoch: 7 | loss: 0.0015550
	speed: 0.0354s/iter; left time: 1368.3813s
	iters: 300, epoch: 7 | loss: 0.0171783
	speed: 0.0354s/iter; left time: 1362.0451s
	iters: 400, epoch: 7 | loss: 0.2338512
	speed: 0.0358s/iter; left time: 1374.3046s
Epoch: 7 cost time: 14.977675199508667
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0011092
	speed: 0.1172s/iter; left time: 4491.2856s
	iters: 200, epoch: 8 | loss: 0.0000469
	speed: 0.0344s/iter; left time: 1312.5795s
	iters: 300, epoch: 8 | loss: 0.0011534
	speed: 0.0342s/iter; left time: 1304.3352s
	iters: 400, epoch: 8 | loss: 0.0001744
	speed: 0.0342s/iter; left time: 1299.7171s
Epoch: 8 cost time: 14.76069688796997
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0100823
	speed: 0.1122s/iter; left time: 4251.9864s
	iters: 200, epoch: 9 | loss: 0.0079741
	speed: 0.0355s/iter; left time: 1342.9094s
	iters: 300, epoch: 9 | loss: 0.0011311
	speed: 0.0350s/iter; left time: 1319.5405s
	iters: 400, epoch: 9 | loss: 0.0005350
	speed: 0.0351s/iter; left time: 1319.4397s
Epoch: 9 cost time: 14.8639554977417
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0001464
	speed: 0.1214s/iter; left time: 4548.6964s
	iters: 200, epoch: 10 | loss: 0.0007406
	speed: 0.0382s/iter; left time: 1427.9674s
	iters: 300, epoch: 10 | loss: 0.0052212
	speed: 0.0378s/iter; left time: 1408.7477s
	iters: 400, epoch: 10 | loss: 0.5133919
	speed: 0.0395s/iter; left time: 1467.8184s
Epoch: 10 cost time: 16.461029767990112
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0006718
	speed: 0.1336s/iter; left time: 4953.8787s
	iters: 200, epoch: 11 | loss: 0.0001699
	speed: 0.0394s/iter; left time: 1456.9376s
	iters: 300, epoch: 11 | loss: 0.0020054
	speed: 0.0399s/iter; left time: 1469.6526s
	iters: 400, epoch: 11 | loss: 0.0134264
	speed: 0.0407s/iter; left time: 1498.0847s
Epoch: 11 cost time: 17.15017604827881
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0001926
	speed: 0.1292s/iter; left time: 4737.8390s
	iters: 200, epoch: 12 | loss: 0.0004722
	speed: 0.0407s/iter; left time: 1489.0124s
	iters: 300, epoch: 12 | loss: 0.0063205
	speed: 0.0426s/iter; left time: 1552.6468s
	iters: 400, epoch: 12 | loss: 0.0000885
	speed: 0.0424s/iter; left time: 1540.7240s
Epoch: 12 cost time: 17.35217523574829
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
Validation loss decreased (-0.978171 --> -0.978626).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0005481
	speed: 0.1062s/iter; left time: 3850.2654s
	iters: 200, epoch: 13 | loss: 0.0142986
	speed: 0.0351s/iter; left time: 1268.9913s
	iters: 300, epoch: 13 | loss: 0.0013864
	speed: 0.0334s/iter; left time: 1203.5380s
	iters: 400, epoch: 13 | loss: 0.0027901
	speed: 0.0338s/iter; left time: 1215.0616s
Epoch: 13 cost time: 14.573782205581665
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0124787
	speed: 0.1230s/iter; left time: 4408.8178s
	iters: 200, epoch: 14 | loss: 0.0002838
	speed: 0.0383s/iter; left time: 1367.3663s
	iters: 300, epoch: 14 | loss: 0.0019431
	speed: 0.0392s/iter; left time: 1395.8648s
	iters: 400, epoch: 14 | loss: 0.0000110
	speed: 0.0379s/iter; left time: 1347.7498s
Epoch: 14 cost time: 16.33693218231201
Epoch: 14, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0003676
	speed: 0.1222s/iter; left time: 4329.3521s
	iters: 200, epoch: 15 | loss: 0.0005371
	speed: 0.0370s/iter; left time: 1307.8794s
	iters: 300, epoch: 15 | loss: 0.0003943
	speed: 0.0380s/iter; left time: 1338.7344s
	iters: 400, epoch: 15 | loss: 0.0054689
	speed: 0.0376s/iter; left time: 1320.7996s
Epoch: 15 cost time: 15.99683690071106
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000111
	speed: 0.1261s/iter; left time: 4413.3957s
	iters: 200, epoch: 16 | loss: 0.0005479
	speed: 0.0401s/iter; left time: 1398.9793s
	iters: 300, epoch: 16 | loss: 0.0007643
	speed: 0.0411s/iter; left time: 1429.8585s
	iters: 400, epoch: 16 | loss: 0.0008908
	speed: 0.0389s/iter; left time: 1348.4013s
Epoch: 16 cost time: 17.013784646987915
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0005460
	speed: 0.1285s/iter; left time: 4446.4295s
	iters: 200, epoch: 17 | loss: 0.0671925
	speed: 0.0374s/iter; left time: 1288.9786s
	iters: 300, epoch: 17 | loss: 0.0007660
	speed: 0.0394s/iter; left time: 1353.3681s
	iters: 400, epoch: 17 | loss: 0.0000134
	speed: 0.0374s/iter; left time: 1283.1546s
Epoch: 17 cost time: 16.160748720169067
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0017950
	speed: 0.1218s/iter; left time: 4162.1476s
	iters: 200, epoch: 18 | loss: 0.0000391
	speed: 0.0383s/iter; left time: 1305.0591s
	iters: 300, epoch: 18 | loss: 0.0022640
	speed: 0.0388s/iter; left time: 1319.5734s
	iters: 400, epoch: 18 | loss: 0.0000456
	speed: 0.0395s/iter; left time: 1338.0111s
Epoch: 18 cost time: 16.429670572280884
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0042743
	speed: 0.1204s/iter; left time: 4066.4985s
	iters: 200, epoch: 19 | loss: 0.0000562
	speed: 0.0366s/iter; left time: 1231.7960s
	iters: 300, epoch: 19 | loss: 0.0053574
	speed: 0.0356s/iter; left time: 1193.4759s
	iters: 400, epoch: 19 | loss: 0.0000990
	speed: 0.0393s/iter; left time: 1313.6124s
Epoch: 19 cost time: 15.749585628509521
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0040590
	speed: 0.1237s/iter; left time: 4125.8765s
	iters: 200, epoch: 20 | loss: 0.0007850
	speed: 0.0386s/iter; left time: 1282.6816s
	iters: 300, epoch: 20 | loss: 0.0000048
	speed: 0.0407s/iter; left time: 1350.8935s
	iters: 400, epoch: 20 | loss: 0.0030926
	speed: 0.0391s/iter; left time: 1293.5625s
Epoch: 20 cost time: 16.738464832305908
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000002
	speed: 0.1342s/iter; left time: 4421.4877s
	iters: 200, epoch: 21 | loss: 0.0002440
	speed: 0.0402s/iter; left time: 1319.7941s
	iters: 300, epoch: 21 | loss: 0.0000070
	speed: 0.0376s/iter; left time: 1232.6983s
	iters: 400, epoch: 21 | loss: 0.0095187
	speed: 0.0379s/iter; left time: 1237.7219s
Epoch: 21 cost time: 16.587117195129395
Epoch: 21, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.978626 --> -0.980445).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000235
	speed: 0.1282s/iter; left time: 4170.7261s
	iters: 200, epoch: 22 | loss: 0.0085776
	speed: 0.0377s/iter; left time: 1222.2270s
	iters: 300, epoch: 22 | loss: 0.0031349
	speed: 0.0367s/iter; left time: 1185.1312s
	iters: 400, epoch: 22 | loss: 0.0000270
	speed: 0.0377s/iter; left time: 1214.4917s
Epoch: 22 cost time: 16.09918999671936
Epoch: 22, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.122 Vali Acc: 0.983 Test Loss: 0.122 Test Acc: 0.983
Validation loss decreased (-0.980445 --> -0.982718).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0002041
	speed: 0.1204s/iter; left time: 3867.3605s
	iters: 200, epoch: 23 | loss: 0.0000108
	speed: 0.0364s/iter; left time: 1164.9462s
	iters: 300, epoch: 23 | loss: 0.0002102
	speed: 0.0387s/iter; left time: 1233.7783s
	iters: 400, epoch: 23 | loss: 0.0000813
	speed: 0.0379s/iter; left time: 1204.8327s
Epoch: 23 cost time: 16.0638370513916
Epoch: 23, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
Validation loss decreased (-0.982718 --> -0.984538).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000040
	speed: 0.1349s/iter; left time: 4275.2683s
	iters: 200, epoch: 24 | loss: 0.0000582
	speed: 0.0388s/iter; left time: 1226.2467s
	iters: 300, epoch: 24 | loss: 0.0001860
	speed: 0.0386s/iter; left time: 1215.2091s
	iters: 400, epoch: 24 | loss: 0.0000944
	speed: 0.0418s/iter; left time: 1313.9398s
Epoch: 24 cost time: 17.123372316360474
Epoch: 24, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0001310
	speed: 0.1314s/iter; left time: 4112.8958s
	iters: 200, epoch: 25 | loss: 0.0149530
	speed: 0.0370s/iter; left time: 1152.8361s
	iters: 300, epoch: 25 | loss: 0.0000005
	speed: 0.0379s/iter; left time: 1177.2504s
	iters: 400, epoch: 25 | loss: 0.0000295
	speed: 0.0365s/iter; left time: 1131.4875s
Epoch: 25 cost time: 15.863139867782593
Epoch: 25, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0027169
	speed: 0.1174s/iter; left time: 3626.3526s
	iters: 200, epoch: 26 | loss: 0.0000011
	speed: 0.0362s/iter; left time: 1114.5992s
	iters: 300, epoch: 26 | loss: 0.0027996
	speed: 0.0383s/iter; left time: 1175.6809s
	iters: 400, epoch: 26 | loss: 0.0000087
	speed: 0.0377s/iter; left time: 1153.7824s
Epoch: 26 cost time: 15.735145092010498
Epoch: 26, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.982 Test Loss: 0.114 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000206
	speed: 0.1277s/iter; left time: 3888.8826s
	iters: 200, epoch: 27 | loss: 0.0000051
	speed: 0.0381s/iter; left time: 1155.5847s
	iters: 300, epoch: 27 | loss: 0.0000024
	speed: 0.0396s/iter; left time: 1199.7049s
	iters: 400, epoch: 27 | loss: 0.0000170
	speed: 0.0384s/iter; left time: 1157.8937s
Epoch: 27 cost time: 16.542320728302002
Epoch: 27, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0001526
	speed: 0.1288s/iter; left time: 3871.2623s
	iters: 200, epoch: 28 | loss: 0.0000226
	speed: 0.0379s/iter; left time: 1134.0501s
	iters: 300, epoch: 28 | loss: 0.0000385
	speed: 0.0381s/iter; left time: 1136.0110s
	iters: 400, epoch: 28 | loss: 0.0003179
	speed: 0.0372s/iter; left time: 1107.0322s
Epoch: 28 cost time: 16.24797296524048
Epoch: 28, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.3954762
	speed: 0.1234s/iter; left time: 3656.6960s
	iters: 200, epoch: 29 | loss: 0.0000591
	speed: 0.0369s/iter; left time: 1091.1620s
	iters: 300, epoch: 29 | loss: 0.0000022
	speed: 0.0377s/iter; left time: 1110.1780s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0363s/iter; left time: 1064.3988s
Epoch: 29 cost time: 15.74553108215332
Epoch: 29, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0057320
	speed: 0.1233s/iter; left time: 3603.2575s
	iters: 200, epoch: 30 | loss: 0.0000067
	speed: 0.0393s/iter; left time: 1145.4167s
	iters: 300, epoch: 30 | loss: 0.0098849
	speed: 0.0409s/iter; left time: 1188.4840s
	iters: 400, epoch: 30 | loss: 0.1223402
	speed: 0.0378s/iter; left time: 1092.3860s
Epoch: 30 cost time: 16.553141832351685
Epoch: 30, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000193
	speed: 0.1266s/iter; left time: 3647.2717s
	iters: 200, epoch: 31 | loss: 0.0000002
	speed: 0.0419s/iter; left time: 1204.0606s
	iters: 300, epoch: 31 | loss: 0.0000002
	speed: 0.0393s/iter; left time: 1123.7890s
	iters: 400, epoch: 31 | loss: 0.0000254
	speed: 0.0413s/iter; left time: 1178.2800s
Epoch: 31 cost time: 17.047893047332764
Epoch: 31, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000066
	speed: 0.1304s/iter; left time: 3704.0207s
	iters: 200, epoch: 32 | loss: 0.0002247
	speed: 0.0416s/iter; left time: 1177.8832s
	iters: 300, epoch: 32 | loss: 0.0000084
	speed: 0.0396s/iter; left time: 1117.6389s
	iters: 400, epoch: 32 | loss: 0.0000952
	speed: 0.0394s/iter; left time: 1107.1530s
Epoch: 32 cost time: 17.16308283805847
Epoch: 32, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000012
	speed: 0.1250s/iter; left time: 3499.4994s
	iters: 200, epoch: 33 | loss: 0.0000001
	speed: 0.0374s/iter; left time: 1043.0167s
	iters: 300, epoch: 33 | loss: 0.0000004
	speed: 0.0367s/iter; left time: 1020.9706s
	iters: 400, epoch: 33 | loss: 0.0000001
	speed: 0.0386s/iter; left time: 1067.9588s
Epoch: 33 cost time: 15.932441711425781
Epoch: 33, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 70322
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1775339
	speed: 0.0562s/iter; left time: 2314.7807s
	iters: 200, epoch: 1 | loss: 0.3770319
	speed: 0.0369s/iter; left time: 1514.8106s
	iters: 300, epoch: 1 | loss: 0.1434602
	speed: 0.0375s/iter; left time: 1536.9471s
	iters: 400, epoch: 1 | loss: 0.0773833
	speed: 0.0379s/iter; left time: 1552.1425s
Epoch: 1 cost time: 17.395284175872803
Epoch: 1, Steps: 413 | Train Loss: 0.725 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
Validation loss decreased (inf --> -0.957707).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0350092
	speed: 0.1205s/iter; left time: 4914.4054s
	iters: 200, epoch: 2 | loss: 0.0188247
	speed: 0.0369s/iter; left time: 1503.3886s
	iters: 300, epoch: 2 | loss: 0.0405952
	speed: 0.0381s/iter; left time: 1548.0936s
	iters: 400, epoch: 2 | loss: 0.0852109
	speed: 0.0394s/iter; left time: 1597.2359s
Epoch: 2 cost time: 15.998760461807251
Epoch: 2, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.957707 --> -0.973169).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0756670
	speed: 0.1249s/iter; left time: 5041.4896s
	iters: 200, epoch: 3 | loss: 0.0114639
	speed: 0.0371s/iter; left time: 1492.7393s
	iters: 300, epoch: 3 | loss: 0.0260838
	speed: 0.0357s/iter; left time: 1432.7849s
	iters: 400, epoch: 3 | loss: 0.0521090
	speed: 0.0379s/iter; left time: 1520.1271s
Epoch: 3 cost time: 15.856407880783081
Epoch: 3, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.060 Vali Acc: 0.979 Test Loss: 0.060 Test Acc: 0.979
Validation loss decreased (-0.973169 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0270950
	speed: 0.1226s/iter; left time: 4899.8034s
	iters: 200, epoch: 4 | loss: 0.0807874
	speed: 0.0375s/iter; left time: 1496.6932s
	iters: 300, epoch: 4 | loss: 0.1943286
	speed: 0.0370s/iter; left time: 1473.1444s
	iters: 400, epoch: 4 | loss: 0.0140669
	speed: 0.0377s/iter; left time: 1495.9173s
Epoch: 4 cost time: 15.790718078613281
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.062 Vali Acc: 0.978 Test Loss: 0.062 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0216556
	speed: 0.1132s/iter; left time: 4477.2796s
	iters: 200, epoch: 5 | loss: 0.0125019
	speed: 0.0379s/iter; left time: 1493.9466s
	iters: 300, epoch: 5 | loss: 0.0536388
	speed: 0.0399s/iter; left time: 1568.3385s
	iters: 400, epoch: 5 | loss: 0.0343849
	speed: 0.0369s/iter; left time: 1448.0089s
Epoch: 5 cost time: 16.01964545249939
Epoch: 5, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0067081
	speed: 0.1214s/iter; left time: 4752.7088s
	iters: 200, epoch: 6 | loss: 0.0047052
	speed: 0.0384s/iter; left time: 1500.2292s
	iters: 300, epoch: 6 | loss: 0.0001868
	speed: 0.0388s/iter; left time: 1511.5144s
	iters: 400, epoch: 6 | loss: 0.0121902
	speed: 0.0397s/iter; left time: 1543.5425s
Epoch: 6 cost time: 16.62425422668457
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.063 Vali Acc: 0.979 Test Loss: 0.063 Test Acc: 0.979
Validation loss decreased (-0.978626 --> -0.979081).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0019984
	speed: 0.1174s/iter; left time: 4545.4694s
	iters: 200, epoch: 7 | loss: 0.0022327
	speed: 0.0359s/iter; left time: 1386.9770s
	iters: 300, epoch: 7 | loss: 0.0419262
	speed: 0.0380s/iter; left time: 1462.4789s
	iters: 400, epoch: 7 | loss: 0.0753674
	speed: 0.0363s/iter; left time: 1396.0451s
Epoch: 7 cost time: 15.546189308166504
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0009211
	speed: 0.1186s/iter; left time: 4545.0049s
	iters: 200, epoch: 8 | loss: 0.0001829
	speed: 0.0379s/iter; left time: 1446.9834s
	iters: 300, epoch: 8 | loss: 0.0012026
	speed: 0.0349s/iter; left time: 1331.6489s
	iters: 400, epoch: 8 | loss: 0.0001175
	speed: 0.0358s/iter; left time: 1360.6809s
Epoch: 8 cost time: 15.396722555160522
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0070953
	speed: 0.1181s/iter; left time: 4475.1997s
	iters: 200, epoch: 9 | loss: 0.1187811
	speed: 0.0376s/iter; left time: 1420.3891s
	iters: 300, epoch: 9 | loss: 0.0148597
	speed: 0.0390s/iter; left time: 1471.0490s
	iters: 400, epoch: 9 | loss: 0.0013316
	speed: 0.0391s/iter; left time: 1469.2923s
Epoch: 9 cost time: 16.019082069396973
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0002438
	speed: 0.1191s/iter; left time: 4463.3015s
	iters: 200, epoch: 10 | loss: 0.0284171
	speed: 0.0382s/iter; left time: 1426.6413s
	iters: 300, epoch: 10 | loss: 0.0001742
	speed: 0.0400s/iter; left time: 1492.7464s
	iters: 400, epoch: 10 | loss: 0.0019375
	speed: 0.0395s/iter; left time: 1467.4707s
Epoch: 10 cost time: 16.525954723358154
Epoch: 10, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0287337
	speed: 0.1185s/iter; left time: 4392.5183s
	iters: 200, epoch: 11 | loss: 0.0000141
	speed: 0.0363s/iter; left time: 1341.2727s
	iters: 300, epoch: 11 | loss: 0.0005149
	speed: 0.0353s/iter; left time: 1301.3731s
	iters: 400, epoch: 11 | loss: 0.0012903
	speed: 0.0367s/iter; left time: 1348.0367s
Epoch: 11 cost time: 15.500492811203003
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0015583
	speed: 0.1182s/iter; left time: 4331.2347s
	iters: 200, epoch: 12 | loss: 0.0004678
	speed: 0.0364s/iter; left time: 1332.4264s
	iters: 300, epoch: 12 | loss: 0.0462475
	speed: 0.0353s/iter; left time: 1286.3475s
	iters: 400, epoch: 12 | loss: 0.0000356
	speed: 0.0359s/iter; left time: 1304.7437s
Epoch: 12 cost time: 15.372066736221313
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.979081 --> -0.983174).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0044107
	speed: 0.1180s/iter; left time: 4275.2226s
	iters: 200, epoch: 13 | loss: 0.0017801
	speed: 0.0381s/iter; left time: 1378.6651s
	iters: 300, epoch: 13 | loss: 0.0002995
	speed: 0.0382s/iter; left time: 1376.0143s
	iters: 400, epoch: 13 | loss: 0.0001576
	speed: 0.0381s/iter; left time: 1368.4749s
Epoch: 13 cost time: 16.20395302772522
Epoch: 13, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1286856
	speed: 0.1276s/iter; left time: 4571.5937s
	iters: 200, epoch: 14 | loss: 0.0000824
	speed: 0.0373s/iter; left time: 1331.5555s
	iters: 300, epoch: 14 | loss: 0.0447797
	speed: 0.0379s/iter; left time: 1349.8960s
	iters: 400, epoch: 14 | loss: 0.0001784
	speed: 0.0388s/iter; left time: 1380.1368s
Epoch: 14 cost time: 16.2466721534729
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0011673
	speed: 0.1182s/iter; left time: 4185.2610s
	iters: 200, epoch: 15 | loss: 0.0000225
	speed: 0.0369s/iter; left time: 1303.3948s
	iters: 300, epoch: 15 | loss: 0.0011924
	speed: 0.0364s/iter; left time: 1282.5577s
	iters: 400, epoch: 15 | loss: 0.0084847
	speed: 0.0368s/iter; left time: 1293.8804s
Epoch: 15 cost time: 15.614360094070435
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.077 Vali Acc: 0.986 Test Loss: 0.077 Test Acc: 0.986
Validation loss decreased (-0.983174 --> -0.985902).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000168
	speed: 0.1202s/iter; left time: 4207.7780s
	iters: 200, epoch: 16 | loss: 0.0000318
	speed: 0.0382s/iter; left time: 1333.2047s
	iters: 300, epoch: 16 | loss: 0.0001236
	speed: 0.0360s/iter; left time: 1252.3789s
	iters: 400, epoch: 16 | loss: 0.0003970
	speed: 0.0365s/iter; left time: 1267.8026s
Epoch: 16 cost time: 15.742089986801147
Epoch: 16, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0109673
	speed: 0.1207s/iter; left time: 4176.8004s
	iters: 200, epoch: 17 | loss: 0.0000012
	speed: 0.0389s/iter; left time: 1343.4755s
	iters: 300, epoch: 17 | loss: 0.0001446
	speed: 0.0384s/iter; left time: 1321.4421s
	iters: 400, epoch: 17 | loss: 0.0000009
	speed: 0.0376s/iter; left time: 1289.2257s
Epoch: 17 cost time: 16.297377586364746
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0306211
	speed: 0.1209s/iter; left time: 4132.6989s
	iters: 200, epoch: 18 | loss: 0.0007114
	speed: 0.0394s/iter; left time: 1341.4742s
	iters: 300, epoch: 18 | loss: 0.0000258
	speed: 0.0384s/iter; left time: 1305.2708s
	iters: 400, epoch: 18 | loss: 0.0000827
	speed: 0.0393s/iter; left time: 1332.0501s
Epoch: 18 cost time: 16.33356261253357
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0001421
	speed: 0.1203s/iter; left time: 4062.6295s
	iters: 200, epoch: 19 | loss: 0.0001322
	speed: 0.0379s/iter; left time: 1277.5081s
	iters: 300, epoch: 19 | loss: 0.0009107
	speed: 0.0372s/iter; left time: 1247.0335s
	iters: 400, epoch: 19 | loss: 0.0000492
	speed: 0.0350s/iter; left time: 1170.7436s
Epoch: 19 cost time: 15.686363697052002
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0253828
	speed: 0.1145s/iter; left time: 3818.2285s
	iters: 200, epoch: 20 | loss: 0.0019530
	speed: 0.0359s/iter; left time: 1195.0023s
	iters: 300, epoch: 20 | loss: 0.0000029
	speed: 0.0371s/iter; left time: 1230.2480s
	iters: 400, epoch: 20 | loss: 0.0002793
	speed: 0.0362s/iter; left time: 1197.8122s
Epoch: 20 cost time: 15.503777503967285
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000809
	speed: 0.1211s/iter; left time: 3988.6291s
	iters: 200, epoch: 21 | loss: 0.0001110
	speed: 0.0391s/iter; left time: 1285.0693s
	iters: 300, epoch: 21 | loss: 0.0000619
	speed: 0.0385s/iter; left time: 1262.0081s
	iters: 400, epoch: 21 | loss: 0.0000056
	speed: 0.0389s/iter; left time: 1269.2380s
Epoch: 21 cost time: 16.4743869304657
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0001022
	speed: 0.1232s/iter; left time: 4008.6499s
	iters: 200, epoch: 22 | loss: 0.0002791
	speed: 0.0374s/iter; left time: 1213.9161s
	iters: 300, epoch: 22 | loss: 0.0000506
	speed: 0.0388s/iter; left time: 1254.2238s
	iters: 400, epoch: 22 | loss: 0.0093906
	speed: 0.0415s/iter; left time: 1337.7237s
Epoch: 22 cost time: 16.48359179496765
Epoch: 22, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0065278
	speed: 0.1153s/iter; left time: 3702.0029s
	iters: 200, epoch: 23 | loss: 0.0002040
	speed: 0.0370s/iter; left time: 1184.5854s
	iters: 300, epoch: 23 | loss: 0.0005555
	speed: 0.0368s/iter; left time: 1173.9525s
	iters: 400, epoch: 23 | loss: 0.0002295
	speed: 0.0346s/iter; left time: 1101.0530s
Epoch: 23 cost time: 15.393274068832397
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000080
	speed: 0.1153s/iter; left time: 3655.0647s
	iters: 200, epoch: 24 | loss: 0.0000399
	speed: 0.0352s/iter; left time: 1113.2062s
	iters: 300, epoch: 24 | loss: 0.0000103
	speed: 0.0372s/iter; left time: 1173.4022s
	iters: 400, epoch: 24 | loss: 0.0000025
	speed: 0.0371s/iter; left time: 1163.6938s
Epoch: 24 cost time: 15.542652368545532
Epoch: 24, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000118
	speed: 0.1217s/iter; left time: 3806.4185s
	iters: 200, epoch: 25 | loss: 0.0000419
	speed: 0.0382s/iter; left time: 1190.8900s
	iters: 300, epoch: 25 | loss: 0.0000198
	speed: 0.0384s/iter; left time: 1193.7591s
	iters: 400, epoch: 25 | loss: 0.0019920
	speed: 0.0396s/iter; left time: 1225.6896s
Epoch: 25 cost time: 16.23745083808899
Epoch: 25, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 70322
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3101343
	speed: 0.0537s/iter; left time: 2210.8452s
	iters: 200, epoch: 1 | loss: 0.4016501
	speed: 0.0349s/iter; left time: 1433.2398s
	iters: 300, epoch: 1 | loss: 0.1392650
	speed: 0.0342s/iter; left time: 1401.0069s
	iters: 400, epoch: 1 | loss: 0.0935021
	speed: 0.0352s/iter; left time: 1441.0134s
Epoch: 1 cost time: 16.30798101425171
Epoch: 1, Steps: 413 | Train Loss: 0.752 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (inf --> -0.958616).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0307629
	speed: 0.1063s/iter; left time: 4335.1125s
	iters: 200, epoch: 2 | loss: 0.0129110
	speed: 0.0353s/iter; left time: 1435.1942s
	iters: 300, epoch: 2 | loss: 0.0349125
	speed: 0.0365s/iter; left time: 1481.1884s
	iters: 400, epoch: 2 | loss: 0.0549363
	speed: 0.0353s/iter; left time: 1428.4613s
Epoch: 2 cost time: 15.043312549591064
Epoch: 2, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
Validation loss decreased (-0.958616 --> -0.971350).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0660310
	speed: 0.1137s/iter; left time: 4590.7073s
	iters: 200, epoch: 3 | loss: 0.0072944
	speed: 0.0352s/iter; left time: 1419.2975s
	iters: 300, epoch: 3 | loss: 0.0412521
	speed: 0.0346s/iter; left time: 1388.9162s
	iters: 400, epoch: 3 | loss: 0.0686152
	speed: 0.0355s/iter; left time: 1422.0995s
Epoch: 3 cost time: 14.962625741958618
Epoch: 3, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.075 Vali Acc: 0.975 Test Loss: 0.075 Test Acc: 0.975
Validation loss decreased (-0.971350 --> -0.974533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0236259
	speed: 0.1150s/iter; left time: 4596.7147s
	iters: 200, epoch: 4 | loss: 0.0347944
	speed: 0.0358s/iter; left time: 1427.3363s
	iters: 300, epoch: 4 | loss: 0.1775385
	speed: 0.0369s/iter; left time: 1465.5479s
	iters: 400, epoch: 4 | loss: 0.0295770
	speed: 0.0355s/iter; left time: 1408.5307s
Epoch: 4 cost time: 15.330626726150513
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.060 Vali Acc: 0.974 Test Loss: 0.060 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0340987
	speed: 0.1209s/iter; left time: 4783.3691s
	iters: 200, epoch: 5 | loss: 0.0160949
	speed: 0.0366s/iter; left time: 1444.3273s
	iters: 300, epoch: 5 | loss: 0.0217793
	speed: 0.0357s/iter; left time: 1403.6937s
	iters: 400, epoch: 5 | loss: 0.0393066
	speed: 0.0359s/iter; left time: 1409.6220s
Epoch: 5 cost time: 15.353416919708252
Epoch: 5, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.974533 --> -0.977262).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0065661
	speed: 0.1124s/iter; left time: 4397.5561s
	iters: 200, epoch: 6 | loss: 0.0046599
	speed: 0.0342s/iter; left time: 1334.8811s
	iters: 300, epoch: 6 | loss: 0.0015485
	speed: 0.0346s/iter; left time: 1348.3083s
	iters: 400, epoch: 6 | loss: 0.0114841
	speed: 0.0346s/iter; left time: 1343.8722s
Epoch: 6 cost time: 14.701787233352661
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.057 Vali Acc: 0.980 Test Loss: 0.057 Test Acc: 0.980
Validation loss decreased (-0.977262 --> -0.979536).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0133543
	speed: 0.1134s/iter; left time: 4392.2323s
	iters: 200, epoch: 7 | loss: 0.0046802
	speed: 0.0354s/iter; left time: 1366.1379s
	iters: 300, epoch: 7 | loss: 0.0030397
	speed: 0.0346s/iter; left time: 1333.2919s
	iters: 400, epoch: 7 | loss: 0.1162348
	speed: 0.0339s/iter; left time: 1302.4764s
Epoch: 7 cost time: 14.863342046737671
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0281575
	speed: 0.1118s/iter; left time: 4281.3914s
	iters: 200, epoch: 8 | loss: 0.0001947
	speed: 0.0355s/iter; left time: 1357.6088s
	iters: 300, epoch: 8 | loss: 0.0017667
	speed: 0.0357s/iter; left time: 1359.7795s
	iters: 400, epoch: 8 | loss: 0.0002742
	speed: 0.0347s/iter; left time: 1317.7086s
Epoch: 8 cost time: 15.112026691436768
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.053 Vali Acc: 0.982 Test Loss: 0.053 Test Acc: 0.982
Validation loss decreased (-0.979536 --> -0.982264).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0046310
	speed: 0.1169s/iter; left time: 4430.7255s
	iters: 200, epoch: 9 | loss: 0.0495670
	speed: 0.0360s/iter; left time: 1359.0812s
	iters: 300, epoch: 9 | loss: 0.0048285
	speed: 0.0377s/iter; left time: 1420.3558s
	iters: 400, epoch: 9 | loss: 0.0013327
	speed: 0.0358s/iter; left time: 1345.1361s
Epoch: 9 cost time: 15.477298021316528
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.982719).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0002974
	speed: 0.1201s/iter; left time: 4501.3292s
	iters: 200, epoch: 10 | loss: 0.0413377
	speed: 0.0344s/iter; left time: 1287.7294s
	iters: 300, epoch: 10 | loss: 0.0206199
	speed: 0.0351s/iter; left time: 1309.9789s
	iters: 400, epoch: 10 | loss: 0.2856266
	speed: 0.0350s/iter; left time: 1301.0850s
Epoch: 10 cost time: 14.911953926086426
Epoch: 10, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0004623
	speed: 0.1101s/iter; left time: 4080.0247s
	iters: 200, epoch: 11 | loss: 0.0004846
	speed: 0.0367s/iter; left time: 1357.5738s
	iters: 300, epoch: 11 | loss: 0.0099140
	speed: 0.0368s/iter; left time: 1357.6131s
	iters: 400, epoch: 11 | loss: 0.0001662
	speed: 0.0362s/iter; left time: 1331.0335s
Epoch: 11 cost time: 15.324404001235962
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0021461
	speed: 0.1141s/iter; left time: 4182.2083s
	iters: 200, epoch: 12 | loss: 0.0000628
	speed: 0.0364s/iter; left time: 1332.0308s
	iters: 300, epoch: 12 | loss: 0.0000588
	speed: 0.0367s/iter; left time: 1337.3550s
	iters: 400, epoch: 12 | loss: 0.0009949
	speed: 0.0375s/iter; left time: 1362.3494s
Epoch: 12 cost time: 15.520817756652832
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0002090
	speed: 0.1167s/iter; left time: 4230.1978s
	iters: 200, epoch: 13 | loss: 0.0058313
	speed: 0.0393s/iter; left time: 1419.6911s
	iters: 300, epoch: 13 | loss: 0.0010532
	speed: 0.0371s/iter; left time: 1337.7919s
	iters: 400, epoch: 13 | loss: 0.0038259
	speed: 0.0372s/iter; left time: 1336.5347s
Epoch: 13 cost time: 15.82624101638794
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0023638
	speed: 0.1166s/iter; left time: 4178.1285s
	iters: 200, epoch: 14 | loss: 0.0000507
	speed: 0.0366s/iter; left time: 1307.9736s
	iters: 300, epoch: 14 | loss: 0.0062266
	speed: 0.0380s/iter; left time: 1352.3514s
	iters: 400, epoch: 14 | loss: 0.0000226
	speed: 0.0363s/iter; left time: 1290.8854s
Epoch: 14 cost time: 15.712438821792603
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0004162
	speed: 0.1214s/iter; left time: 4299.6431s
	iters: 200, epoch: 15 | loss: 0.0015091
	speed: 0.0375s/iter; left time: 1324.6867s
	iters: 300, epoch: 15 | loss: 0.0037727
	speed: 0.0384s/iter; left time: 1352.0775s
	iters: 400, epoch: 15 | loss: 0.0028663
	speed: 0.0380s/iter; left time: 1334.6395s
Epoch: 15 cost time: 16.155770540237427
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000052
	speed: 0.1198s/iter; left time: 4192.3662s
	iters: 200, epoch: 16 | loss: 0.0001592
	speed: 0.0389s/iter; left time: 1356.9949s
	iters: 300, epoch: 16 | loss: 0.0020117
	speed: 0.0397s/iter; left time: 1382.2223s
	iters: 400, epoch: 16 | loss: 0.0044806
	speed: 0.0373s/iter; left time: 1294.7577s
Epoch: 16 cost time: 16.21575355529785
Epoch: 16, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000700
	speed: 0.1221s/iter; left time: 4224.1007s
	iters: 200, epoch: 17 | loss: 0.0000436
	speed: 0.0362s/iter; left time: 1249.9018s
	iters: 300, epoch: 17 | loss: 0.0005849
	speed: 0.0374s/iter; left time: 1287.7053s
	iters: 400, epoch: 17 | loss: 0.0001971
	speed: 0.0378s/iter; left time: 1294.6487s
Epoch: 17 cost time: 15.67830204963684
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000459
	speed: 0.1195s/iter; left time: 4083.6313s
	iters: 200, epoch: 18 | loss: 0.0007582
	speed: 0.0345s/iter; left time: 1174.9374s
	iters: 300, epoch: 18 | loss: 0.0000879
	speed: 0.0337s/iter; left time: 1145.8521s
	iters: 400, epoch: 18 | loss: 0.0000521
	speed: 0.0336s/iter; left time: 1139.2035s
Epoch: 18 cost time: 14.639256715774536
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0046332
	speed: 0.1136s/iter; left time: 3836.0087s
	iters: 200, epoch: 19 | loss: 0.0002255
	speed: 0.0335s/iter; left time: 1128.5178s
	iters: 300, epoch: 19 | loss: 0.0000361
	speed: 0.0345s/iter; left time: 1157.9299s
	iters: 400, epoch: 19 | loss: 0.0006537
	speed: 0.0336s/iter; left time: 1125.7379s
Epoch: 19 cost time: 14.47523021697998
Epoch: 19, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.982719 --> -0.983173).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0005863
	speed: 0.1089s/iter; left time: 3632.4146s
	iters: 200, epoch: 20 | loss: 0.0000182
	speed: 0.0340s/iter; left time: 1129.0209s
	iters: 300, epoch: 20 | loss: 0.0019112
	speed: 0.0337s/iter; left time: 1116.4230s
	iters: 400, epoch: 20 | loss: 0.0839880
	speed: 0.0352s/iter; left time: 1165.0872s
Epoch: 20 cost time: 14.374159336090088
Epoch: 20, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000024
	speed: 0.1142s/iter; left time: 3761.8970s
	iters: 200, epoch: 21 | loss: 0.0000365
	speed: 0.0347s/iter; left time: 1139.7724s
	iters: 300, epoch: 21 | loss: 0.0000021
	speed: 0.0353s/iter; left time: 1155.3821s
	iters: 400, epoch: 21 | loss: 0.0421172
	speed: 0.0356s/iter; left time: 1162.7079s
Epoch: 21 cost time: 14.91249394416809
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000202
	speed: 0.1130s/iter; left time: 3674.8128s
	iters: 200, epoch: 22 | loss: 0.0000237
	speed: 0.0354s/iter; left time: 1147.9333s
	iters: 300, epoch: 22 | loss: 0.0000079
	speed: 0.0351s/iter; left time: 1135.1042s
	iters: 400, epoch: 22 | loss: 0.0001176
	speed: 0.0350s/iter; left time: 1128.7625s
Epoch: 22 cost time: 14.958476066589355
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000273
	speed: 0.1150s/iter; left time: 3692.8200s
	iters: 200, epoch: 23 | loss: 0.0004962
	speed: 0.0361s/iter; left time: 1156.7487s
	iters: 300, epoch: 23 | loss: 0.0000182
	speed: 0.0356s/iter; left time: 1137.4615s
	iters: 400, epoch: 23 | loss: 0.0010456
	speed: 0.0354s/iter; left time: 1127.7420s
Epoch: 23 cost time: 15.222884893417358
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0002771
	speed: 0.1129s/iter; left time: 3577.7328s
	iters: 200, epoch: 24 | loss: 0.0000032
	speed: 0.0355s/iter; left time: 1120.6081s
	iters: 300, epoch: 24 | loss: 0.0000432
	speed: 0.0344s/iter; left time: 1084.5346s
	iters: 400, epoch: 24 | loss: 0.0000002
	speed: 0.0354s/iter; left time: 1111.2434s
Epoch: 24 cost time: 14.892003774642944
Epoch: 24, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000005
	speed: 0.1190s/iter; left time: 3724.2999s
	iters: 200, epoch: 25 | loss: 0.0000832
	speed: 0.0349s/iter; left time: 1088.2917s
	iters: 300, epoch: 25 | loss: 0.0000189
	speed: 0.0360s/iter; left time: 1118.1302s
	iters: 400, epoch: 25 | loss: 0.0000732
	speed: 0.0340s/iter; left time: 1052.6420s
Epoch: 25 cost time: 14.962371826171875
Epoch: 25, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000371
	speed: 0.1149s/iter; left time: 3547.9925s
	iters: 200, epoch: 26 | loss: 0.0000865
	speed: 0.0382s/iter; left time: 1175.4244s
	iters: 300, epoch: 26 | loss: 0.0000572
	speed: 0.0359s/iter; left time: 1101.0680s
	iters: 400, epoch: 26 | loss: 0.0000639
	speed: 0.0350s/iter; left time: 1069.0599s
Epoch: 26 cost time: 15.436530351638794
Epoch: 26, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0004964
	speed: 0.1111s/iter; left time: 3384.4742s
	iters: 200, epoch: 27 | loss: 0.0007052
	speed: 0.0331s/iter; left time: 1005.0051s
	iters: 300, epoch: 27 | loss: 0.0000140
	speed: 0.0331s/iter; left time: 1002.6684s
	iters: 400, epoch: 27 | loss: 0.0003942
	speed: 0.0345s/iter; left time: 1039.7204s
Epoch: 27 cost time: 14.399168252944946
Epoch: 27, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0003172
	speed: 0.1125s/iter; left time: 3380.3991s
	iters: 200, epoch: 28 | loss: 0.0000065
	speed: 0.0343s/iter; left time: 1026.8636s
	iters: 300, epoch: 28 | loss: 0.0000093
	speed: 0.0343s/iter; left time: 1023.2663s
	iters: 400, epoch: 28 | loss: 0.0000143
	speed: 0.0344s/iter; left time: 1024.0537s
Epoch: 28 cost time: 14.579694509506226
Epoch: 28, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000342
	speed: 0.1107s/iter; left time: 3280.3115s
	iters: 200, epoch: 29 | loss: 0.0002063
	speed: 0.0372s/iter; left time: 1100.2396s
	iters: 300, epoch: 29 | loss: 0.0000060
	speed: 0.0374s/iter; left time: 1100.1893s
	iters: 400, epoch: 29 | loss: 0.0002497
	speed: 0.0366s/iter; left time: 1074.5912s
Epoch: 29 cost time: 15.346307516098022
Epoch: 29, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 70322
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.6007149
	speed: 0.0558s/iter; left time: 2298.6178s
	iters: 200, epoch: 1 | loss: 0.6057945
	speed: 0.0323s/iter; left time: 1326.1837s
	iters: 300, epoch: 1 | loss: 0.2145611
	speed: 0.0368s/iter; left time: 1509.2013s
	iters: 400, epoch: 1 | loss: 0.1211457
	speed: 0.0398s/iter; left time: 1627.7050s
Epoch: 1 cost time: 17.021747827529907
Epoch: 1, Steps: 413 | Train Loss: 0.867 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
Validation loss decreased (inf --> -0.946337).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0516273
	speed: 0.1102s/iter; left time: 4495.4389s
	iters: 200, epoch: 2 | loss: 0.0286544
	speed: 0.0324s/iter; left time: 1317.1049s
	iters: 300, epoch: 2 | loss: 0.0586687
	speed: 0.0310s/iter; left time: 1259.9741s
	iters: 400, epoch: 2 | loss: 0.0937653
	speed: 0.0319s/iter; left time: 1293.4771s
Epoch: 2 cost time: 13.555723190307617
Epoch: 2, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
Validation loss decreased (-0.946337 --> -0.962254).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1931219
	speed: 0.1162s/iter; left time: 4689.8313s
	iters: 200, epoch: 3 | loss: 0.0086079
	speed: 0.0362s/iter; left time: 1458.3819s
	iters: 300, epoch: 3 | loss: 0.0750656
	speed: 0.0372s/iter; left time: 1492.7286s
	iters: 400, epoch: 3 | loss: 0.0652781
	speed: 0.0367s/iter; left time: 1470.4826s
Epoch: 3 cost time: 15.661426067352295
Epoch: 3, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.081 Vali Acc: 0.971 Test Loss: 0.081 Test Acc: 0.971
Validation loss decreased (-0.962254 --> -0.971350).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0242832
	speed: 0.1182s/iter; left time: 4724.9019s
	iters: 200, epoch: 4 | loss: 0.0675415
	speed: 0.0338s/iter; left time: 1348.4372s
	iters: 300, epoch: 4 | loss: 0.1665356
	speed: 0.0364s/iter; left time: 1446.3533s
	iters: 400, epoch: 4 | loss: 0.0682017
	speed: 0.0367s/iter; left time: 1455.5956s
Epoch: 4 cost time: 15.2505362033844
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.066 Vali Acc: 0.976 Test Loss: 0.066 Test Acc: 0.976
Validation loss decreased (-0.971350 --> -0.976352).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0691220
	speed: 0.1173s/iter; left time: 4640.1405s
	iters: 200, epoch: 5 | loss: 0.0691128
	speed: 0.0389s/iter; left time: 1532.8352s
	iters: 300, epoch: 5 | loss: 0.0358059
	speed: 0.0392s/iter; left time: 1541.7433s
	iters: 400, epoch: 5 | loss: 0.0576581
	speed: 0.0405s/iter; left time: 1587.8968s
Epoch: 5 cost time: 16.66808533668518
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.064 Vali Acc: 0.979 Test Loss: 0.064 Test Acc: 0.979
Validation loss decreased (-0.976352 --> -0.978626).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0348764
	speed: 0.1255s/iter; left time: 4910.1268s
	iters: 200, epoch: 6 | loss: 0.0019268
	speed: 0.0383s/iter; left time: 1495.7960s
	iters: 300, epoch: 6 | loss: 0.0014274
	speed: 0.0400s/iter; left time: 1558.9675s
	iters: 400, epoch: 6 | loss: 0.0053619
	speed: 0.0381s/iter; left time: 1480.8362s
Epoch: 6 cost time: 16.71935200691223
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.043 Vali Acc: 0.985 Test Loss: 0.043 Test Acc: 0.985
Validation loss decreased (-0.978626 --> -0.985448).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0009294
	speed: 0.1201s/iter; left time: 4650.9061s
	iters: 200, epoch: 7 | loss: 0.0053381
	speed: 0.0389s/iter; left time: 1501.5665s
	iters: 300, epoch: 7 | loss: 0.0067614
	speed: 0.0373s/iter; left time: 1438.3882s
	iters: 400, epoch: 7 | loss: 0.1485091
	speed: 0.0355s/iter; left time: 1363.0629s
Epoch: 7 cost time: 15.82147765159607
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0070624
	speed: 0.1164s/iter; left time: 4461.0634s
	iters: 200, epoch: 8 | loss: 0.0003408
	speed: 0.0348s/iter; left time: 1331.0551s
	iters: 300, epoch: 8 | loss: 0.0006752
	speed: 0.0351s/iter; left time: 1336.9029s
	iters: 400, epoch: 8 | loss: 0.0000724
	speed: 0.0354s/iter; left time: 1343.9027s
Epoch: 8 cost time: 14.938380241394043
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0319220
	speed: 0.1182s/iter; left time: 4480.2928s
	iters: 200, epoch: 9 | loss: 0.0379238
	speed: 0.0373s/iter; left time: 1411.5399s
	iters: 300, epoch: 9 | loss: 0.0013481
	speed: 0.0366s/iter; left time: 1380.7240s
	iters: 400, epoch: 9 | loss: 0.0532089
	speed: 0.0365s/iter; left time: 1371.0161s
Epoch: 9 cost time: 15.59970998764038
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0170620
	speed: 0.1202s/iter; left time: 4504.4900s
	iters: 200, epoch: 10 | loss: 0.0063787
	speed: 0.0366s/iter; left time: 1368.7772s
	iters: 300, epoch: 10 | loss: 0.1845394
	speed: 0.0356s/iter; left time: 1328.4879s
	iters: 400, epoch: 10 | loss: 0.0315787
	speed: 0.0333s/iter; left time: 1238.1601s
Epoch: 10 cost time: 15.164494514465332
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0007455
	speed: 0.1057s/iter; left time: 3916.7586s
	iters: 200, epoch: 11 | loss: 0.0000234
	speed: 0.0341s/iter; left time: 1259.1602s
	iters: 300, epoch: 11 | loss: 0.0014709
	speed: 0.0326s/iter; left time: 1201.5223s
	iters: 400, epoch: 11 | loss: 0.0003662
	speed: 0.0338s/iter; left time: 1241.0401s
Epoch: 11 cost time: 14.186026334762573
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0040621
	speed: 0.1094s/iter; left time: 4012.1943s
	iters: 200, epoch: 12 | loss: 0.0006048
	speed: 0.0343s/iter; left time: 1252.7336s
	iters: 300, epoch: 12 | loss: 0.0000112
	speed: 0.0337s/iter; left time: 1228.0457s
	iters: 400, epoch: 12 | loss: 0.0002646
	speed: 0.0336s/iter; left time: 1220.0987s
Epoch: 12 cost time: 14.467949867248535
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0009429
	speed: 0.1103s/iter; left time: 3997.1577s
	iters: 200, epoch: 13 | loss: 0.0048780
	speed: 0.0357s/iter; left time: 1290.9267s
	iters: 300, epoch: 13 | loss: 0.0003504
	speed: 0.0356s/iter; left time: 1284.9449s
	iters: 400, epoch: 13 | loss: 0.0004259
	speed: 0.0355s/iter; left time: 1275.0173s
Epoch: 13 cost time: 14.769981384277344
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0681811
	speed: 0.1200s/iter; left time: 4301.6189s
	iters: 200, epoch: 14 | loss: 0.0002708
	speed: 0.0367s/iter; left time: 1312.8598s
	iters: 300, epoch: 14 | loss: 0.0009414
	speed: 0.0394s/iter; left time: 1402.1953s
	iters: 400, epoch: 14 | loss: 0.0022331
	speed: 0.0383s/iter; left time: 1359.5263s
Epoch: 14 cost time: 16.069878101348877
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0001722
	speed: 0.1179s/iter; left time: 4176.4341s
	iters: 200, epoch: 15 | loss: 0.0010491
	speed: 0.0368s/iter; left time: 1300.9617s
	iters: 300, epoch: 15 | loss: 0.0003634
	speed: 0.0365s/iter; left time: 1286.2413s
	iters: 400, epoch: 15 | loss: 0.0010457
	speed: 0.0357s/iter; left time: 1255.4857s
Epoch: 15 cost time: 15.46137261390686
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0218500
	speed: 0.1138s/iter; left time: 3982.0043s
	iters: 200, epoch: 16 | loss: 0.0179882
	speed: 0.0368s/iter; left time: 1282.8119s
	iters: 300, epoch: 16 | loss: 0.0014757
	speed: 0.0369s/iter; left time: 1285.4917s
	iters: 400, epoch: 16 | loss: 0.0000206
	speed: 0.0382s/iter; left time: 1324.4665s
Epoch: 16 cost time: 15.885064363479614
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 70322
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1738557
	speed: 0.0565s/iter; left time: 2326.2088s
	iters: 200, epoch: 1 | loss: 0.2666926
	speed: 0.0353s/iter; left time: 1448.9529s
	iters: 300, epoch: 1 | loss: 0.1589088
	speed: 0.0346s/iter; left time: 1419.3707s
	iters: 400, epoch: 1 | loss: 0.3888095
	speed: 0.0340s/iter; left time: 1390.7581s
Epoch: 1 cost time: 16.552010536193848
Epoch: 1, Steps: 413 | Train Loss: 0.729 Vali Loss: 0.145 Vali Acc: 0.955 Test Loss: 0.145 Test Acc: 0.955
Validation loss decreased (inf --> -0.954523).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0468563
	speed: 0.1155s/iter; left time: 4710.4357s
	iters: 200, epoch: 2 | loss: 0.2048721
	speed: 0.0359s/iter; left time: 1462.1799s
	iters: 300, epoch: 2 | loss: 0.0261871
	speed: 0.0356s/iter; left time: 1444.5472s
	iters: 400, epoch: 2 | loss: 0.0326377
	speed: 0.0339s/iter; left time: 1371.8000s
Epoch: 2 cost time: 15.08428430557251
Epoch: 2, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.086 Vali Acc: 0.971 Test Loss: 0.086 Test Acc: 0.971
Validation loss decreased (-0.954523 --> -0.971350).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0540634
	speed: 0.1144s/iter; left time: 4619.7633s
	iters: 200, epoch: 3 | loss: 0.0551907
	speed: 0.0354s/iter; left time: 1426.9648s
	iters: 300, epoch: 3 | loss: 0.0204242
	speed: 0.0343s/iter; left time: 1377.1494s
	iters: 400, epoch: 3 | loss: 0.0317350
	speed: 0.0353s/iter; left time: 1416.5429s
Epoch: 3 cost time: 14.912073135375977
Epoch: 3, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
Validation loss decreased (-0.971350 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0366170
	speed: 0.1136s/iter; left time: 4538.5562s
	iters: 200, epoch: 4 | loss: 0.0229839
	speed: 0.0347s/iter; left time: 1382.4856s
	iters: 300, epoch: 4 | loss: 0.0434820
	speed: 0.0353s/iter; left time: 1403.8597s
	iters: 400, epoch: 4 | loss: 0.0071337
	speed: 0.0345s/iter; left time: 1370.0947s
Epoch: 4 cost time: 14.785679817199707
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0016804
	speed: 0.1131s/iter; left time: 4474.2441s
	iters: 200, epoch: 5 | loss: 0.0035533
	speed: 0.0375s/iter; left time: 1477.7338s
	iters: 300, epoch: 5 | loss: 0.0052220
	speed: 0.0369s/iter; left time: 1450.2200s
	iters: 400, epoch: 5 | loss: 0.0527983
	speed: 0.0364s/iter; left time: 1430.3947s
Epoch: 5 cost time: 15.547107934951782
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0004365
	speed: 0.1217s/iter; left time: 4764.3358s
	iters: 200, epoch: 6 | loss: 0.0011424
	speed: 0.0395s/iter; left time: 1540.8187s
	iters: 300, epoch: 6 | loss: 0.0390656
	speed: 0.0408s/iter; left time: 1587.8472s
	iters: 400, epoch: 6 | loss: 0.1246853
	speed: 0.0385s/iter; left time: 1495.3855s
Epoch: 6 cost time: 16.861369609832764
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0035212
	speed: 0.1287s/iter; left time: 4983.0125s
	iters: 200, epoch: 7 | loss: 0.0130076
	speed: 0.0398s/iter; left time: 1537.4108s
	iters: 300, epoch: 7 | loss: 0.0077178
	speed: 0.0384s/iter; left time: 1479.3924s
	iters: 400, epoch: 7 | loss: 0.0004937
	speed: 0.0375s/iter; left time: 1439.5825s
Epoch: 7 cost time: 16.424408197402954
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
Validation loss decreased (-0.977716 --> -0.979081).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0008236
	speed: 0.1217s/iter; left time: 4662.5288s
	iters: 200, epoch: 8 | loss: 0.0010924
	speed: 0.0392s/iter; left time: 1496.6946s
	iters: 300, epoch: 8 | loss: 0.0678147
	speed: 0.0375s/iter; left time: 1427.5088s
	iters: 400, epoch: 8 | loss: 0.0004603
	speed: 0.0392s/iter; left time: 1488.2539s
Epoch: 8 cost time: 16.27963948249817
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0012112
	speed: 0.1232s/iter; left time: 4669.5845s
	iters: 200, epoch: 9 | loss: 0.0001349
	speed: 0.0406s/iter; left time: 1533.8903s
	iters: 300, epoch: 9 | loss: 0.0005051
	speed: 0.0406s/iter; left time: 1531.5327s
	iters: 400, epoch: 9 | loss: 0.0836808
	speed: 0.0416s/iter; left time: 1564.2494s
Epoch: 9 cost time: 17.18900465965271
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0053794
	speed: 0.1317s/iter; left time: 4935.7563s
	iters: 200, epoch: 10 | loss: 0.0073686
	speed: 0.0406s/iter; left time: 1519.1113s
	iters: 300, epoch: 10 | loss: 0.0194821
	speed: 0.0393s/iter; left time: 1463.4563s
	iters: 400, epoch: 10 | loss: 0.0408745
	speed: 0.0406s/iter; left time: 1511.3229s
Epoch: 10 cost time: 17.136210680007935
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0011123
	speed: 0.1188s/iter; left time: 4402.4248s
	iters: 200, epoch: 11 | loss: 0.0015119
	speed: 0.0374s/iter; left time: 1381.3875s
	iters: 300, epoch: 11 | loss: 0.0000347
	speed: 0.0383s/iter; left time: 1410.8936s
	iters: 400, epoch: 11 | loss: 0.0561302
	speed: 0.0374s/iter; left time: 1374.7833s
Epoch: 11 cost time: 15.977906703948975
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0004707
	speed: 0.1182s/iter; left time: 4331.3845s
	iters: 200, epoch: 12 | loss: 0.0007021
	speed: 0.0377s/iter; left time: 1378.7743s
	iters: 300, epoch: 12 | loss: 0.0005165
	speed: 0.0375s/iter; left time: 1367.4618s
	iters: 400, epoch: 12 | loss: 0.0230945
	speed: 0.0385s/iter; left time: 1400.7954s
Epoch: 12 cost time: 16.004454851150513
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000307
	speed: 0.1250s/iter; left time: 4530.3493s
	iters: 200, epoch: 13 | loss: 0.0000853
	speed: 0.0387s/iter; left time: 1399.9023s
	iters: 300, epoch: 13 | loss: 0.0013355
	speed: 0.0399s/iter; left time: 1438.3705s
	iters: 400, epoch: 13 | loss: 0.0000615
	speed: 0.0407s/iter; left time: 1463.1612s
Epoch: 13 cost time: 16.8554904460907
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0007995
	speed: 0.1255s/iter; left time: 4496.6022s
	iters: 200, epoch: 14 | loss: 0.0214519
	speed: 0.0375s/iter; left time: 1338.7077s
	iters: 300, epoch: 14 | loss: 0.0178600
	speed: 0.0391s/iter; left time: 1394.4120s
	iters: 400, epoch: 14 | loss: 0.0030304
	speed: 0.0403s/iter; left time: 1431.0263s
Epoch: 14 cost time: 16.583341360092163
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0191355
	speed: 0.1186s/iter; left time: 4201.2912s
	iters: 200, epoch: 15 | loss: 0.0000317
	speed: 0.0377s/iter; left time: 1330.1346s
	iters: 300, epoch: 15 | loss: 0.0000016
	speed: 0.0363s/iter; left time: 1278.9334s
	iters: 400, epoch: 15 | loss: 0.0001063
	speed: 0.0387s/iter; left time: 1359.7988s
Epoch: 15 cost time: 16.05990743637085
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0005344
	speed: 0.1191s/iter; left time: 4169.0882s
	iters: 200, epoch: 16 | loss: 0.0002411
	speed: 0.0376s/iter; left time: 1311.3022s
	iters: 300, epoch: 16 | loss: 0.0000087
	speed: 0.0377s/iter; left time: 1310.7546s
	iters: 400, epoch: 16 | loss: 0.0097595
	speed: 0.0381s/iter; left time: 1323.1271s
Epoch: 16 cost time: 16.070387840270996
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000166
	speed: 0.1209s/iter; left time: 4183.2315s
	iters: 200, epoch: 17 | loss: 0.0015606
	speed: 0.0397s/iter; left time: 1370.4270s
	iters: 300, epoch: 17 | loss: 0.0107506
	speed: 0.0401s/iter; left time: 1378.2365s
	iters: 400, epoch: 17 | loss: 0.0011682
	speed: 0.0402s/iter; left time: 1380.0699s
Epoch: 17 cost time: 16.769610166549683
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 53938
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1771135
	speed: 0.0555s/iter; left time: 2284.9304s
	iters: 200, epoch: 1 | loss: 0.2686345
	speed: 0.0355s/iter; left time: 1458.6120s
	iters: 300, epoch: 1 | loss: 0.1719150
	speed: 0.0361s/iter; left time: 1480.6346s
	iters: 400, epoch: 1 | loss: 0.4337569
	speed: 0.0350s/iter; left time: 1430.6234s
Epoch: 1 cost time: 16.716936826705933
Epoch: 1, Steps: 413 | Train Loss: 0.736 Vali Loss: 0.148 Vali Acc: 0.955 Test Loss: 0.148 Test Acc: 0.955
Validation loss decreased (inf --> -0.954523).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0481134
	speed: 0.1147s/iter; left time: 4677.1607s
	iters: 200, epoch: 2 | loss: 0.1898716
	speed: 0.0343s/iter; left time: 1396.1114s
	iters: 300, epoch: 2 | loss: 0.0245570
	speed: 0.0344s/iter; left time: 1394.6452s
	iters: 400, epoch: 2 | loss: 0.0616951
	speed: 0.0336s/iter; left time: 1361.9973s
Epoch: 2 cost time: 14.706709861755371
Epoch: 2, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
Validation loss decreased (-0.954523 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0441781
	speed: 0.1125s/iter; left time: 4542.4600s
	iters: 200, epoch: 3 | loss: 0.0473316
	speed: 0.0341s/iter; left time: 1372.3015s
	iters: 300, epoch: 3 | loss: 0.0106609
	speed: 0.0340s/iter; left time: 1367.8932s
	iters: 400, epoch: 3 | loss: 0.0287821
	speed: 0.0360s/iter; left time: 1442.5689s
Epoch: 3 cost time: 14.80199122428894
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
Validation loss decreased (-0.972259 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0268063
	speed: 0.1167s/iter; left time: 4663.3517s
	iters: 200, epoch: 4 | loss: 0.0226616
	speed: 0.0368s/iter; left time: 1467.0503s
	iters: 300, epoch: 4 | loss: 0.0132531
	speed: 0.0363s/iter; left time: 1442.7139s
	iters: 400, epoch: 4 | loss: 0.0285247
	speed: 0.0372s/iter; left time: 1474.8067s
Epoch: 4 cost time: 15.463779926300049
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0038775
	speed: 0.1218s/iter; left time: 4818.4888s
	iters: 200, epoch: 5 | loss: 0.0050097
	speed: 0.0356s/iter; left time: 1406.3125s
	iters: 300, epoch: 5 | loss: 0.0060145
	speed: 0.0351s/iter; left time: 1382.7349s
	iters: 400, epoch: 5 | loss: 0.1379202
	speed: 0.0357s/iter; left time: 1399.8868s
Epoch: 5 cost time: 15.181374311447144
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0017274
	speed: 0.1152s/iter; left time: 4509.9401s
	iters: 200, epoch: 6 | loss: 0.0059035
	speed: 0.0358s/iter; left time: 1396.4224s
	iters: 300, epoch: 6 | loss: 0.0020287
	speed: 0.0344s/iter; left time: 1341.1509s
	iters: 400, epoch: 6 | loss: 0.0442696
	speed: 0.0350s/iter; left time: 1359.2019s
Epoch: 6 cost time: 15.013015031814575
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0038371
	speed: 0.1145s/iter; left time: 4434.8379s
	iters: 200, epoch: 7 | loss: 0.0007795
	speed: 0.0358s/iter; left time: 1382.2200s
	iters: 300, epoch: 7 | loss: 0.0169630
	speed: 0.0358s/iter; left time: 1379.4319s
	iters: 400, epoch: 7 | loss: 0.0012409
	speed: 0.0347s/iter; left time: 1331.4106s
Epoch: 7 cost time: 14.980967998504639
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0003042
	speed: 0.1247s/iter; left time: 4778.4626s
	iters: 200, epoch: 8 | loss: 0.0003609
	speed: 0.0368s/iter; left time: 1405.6101s
	iters: 300, epoch: 8 | loss: 0.0097318
	speed: 0.0390s/iter; left time: 1486.0132s
	iters: 400, epoch: 8 | loss: 0.0047600
	speed: 0.0354s/iter; left time: 1347.0736s
Epoch: 8 cost time: 15.765549421310425
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.980445).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000243
	speed: 0.1182s/iter; left time: 4479.9221s
	iters: 200, epoch: 9 | loss: 0.0001344
	speed: 0.0360s/iter; left time: 1359.1003s
	iters: 300, epoch: 9 | loss: 0.0002622
	speed: 0.0359s/iter; left time: 1354.6801s
	iters: 400, epoch: 9 | loss: 0.0064880
	speed: 0.0344s/iter; left time: 1292.0732s
Epoch: 9 cost time: 15.072450876235962
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0007331
	speed: 0.1098s/iter; left time: 4117.2896s
	iters: 200, epoch: 10 | loss: 0.0020247
	speed: 0.0354s/iter; left time: 1325.0126s
	iters: 300, epoch: 10 | loss: 0.0005052
	speed: 0.0342s/iter; left time: 1275.1923s
	iters: 400, epoch: 10 | loss: 0.0080193
	speed: 0.0349s/iter; left time: 1297.5237s
Epoch: 10 cost time: 14.806427478790283
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0016373
	speed: 0.1112s/iter; left time: 4124.0755s
	iters: 200, epoch: 11 | loss: 0.0013740
	speed: 0.0345s/iter; left time: 1275.5313s
	iters: 300, epoch: 11 | loss: 0.0000803
	speed: 0.0348s/iter; left time: 1283.4019s
	iters: 400, epoch: 11 | loss: 0.0088856
	speed: 0.0354s/iter; left time: 1300.6070s
Epoch: 11 cost time: 14.667701244354248
Epoch: 11, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000556
	speed: 0.1202s/iter; left time: 4406.1485s
	iters: 200, epoch: 12 | loss: 0.0007680
	speed: 0.0372s/iter; left time: 1359.9131s
	iters: 300, epoch: 12 | loss: 0.0005036
	speed: 0.0384s/iter; left time: 1398.3755s
	iters: 400, epoch: 12 | loss: 0.0007730
	speed: 0.0355s/iter; left time: 1289.5111s
Epoch: 12 cost time: 15.809999227523804
Epoch: 12, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.980899).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0004712
	speed: 0.1291s/iter; left time: 4680.6263s
	iters: 200, epoch: 13 | loss: 0.0076145
	speed: 0.0409s/iter; left time: 1479.2853s
	iters: 300, epoch: 13 | loss: 0.0004066
	speed: 0.0392s/iter; left time: 1411.8617s
	iters: 400, epoch: 13 | loss: 0.0001868
	speed: 0.0382s/iter; left time: 1373.2714s
Epoch: 13 cost time: 16.990491151809692
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1256209
	speed: 0.1145s/iter; left time: 4102.9268s
	iters: 200, epoch: 14 | loss: 0.0021616
	speed: 0.0366s/iter; left time: 1306.4618s
	iters: 300, epoch: 14 | loss: 0.0023860
	speed: 0.0358s/iter; left time: 1275.9748s
	iters: 400, epoch: 14 | loss: 0.0004993
	speed: 0.0349s/iter; left time: 1241.7881s
Epoch: 14 cost time: 15.323206663131714
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0014067
	speed: 0.1169s/iter; left time: 4139.2682s
	iters: 200, epoch: 15 | loss: 0.0002951
	speed: 0.0380s/iter; left time: 1343.0269s
	iters: 300, epoch: 15 | loss: 0.0000140
	speed: 0.0369s/iter; left time: 1299.4656s
	iters: 400, epoch: 15 | loss: 0.0000544
	speed: 0.0374s/iter; left time: 1314.4303s
Epoch: 15 cost time: 16.126041173934937
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000020
	speed: 0.1256s/iter; left time: 4397.2968s
	iters: 200, epoch: 16 | loss: 0.0000895
	speed: 0.0384s/iter; left time: 1340.9835s
	iters: 300, epoch: 16 | loss: 0.0000439
	speed: 0.0392s/iter; left time: 1365.2718s
	iters: 400, epoch: 16 | loss: 0.0004493
	speed: 0.0383s/iter; left time: 1328.2822s
Epoch: 16 cost time: 16.4234619140625
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000027
	speed: 0.1267s/iter; left time: 4382.0152s
	iters: 200, epoch: 17 | loss: 0.0000453
	speed: 0.0388s/iter; left time: 1337.8865s
	iters: 300, epoch: 17 | loss: 0.0022120
	speed: 0.0411s/iter; left time: 1412.3965s
	iters: 400, epoch: 17 | loss: 0.0004944
	speed: 0.0374s/iter; left time: 1283.5755s
Epoch: 17 cost time: 16.611610174179077
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0004999
	speed: 0.1217s/iter; left time: 4159.7015s
	iters: 200, epoch: 18 | loss: 0.0061694
	speed: 0.0366s/iter; left time: 1247.6576s
	iters: 300, epoch: 18 | loss: 0.0006015
	speed: 0.0373s/iter; left time: 1267.8271s
	iters: 400, epoch: 18 | loss: 0.0021365
	speed: 0.0374s/iter; left time: 1266.2380s
Epoch: 18 cost time: 15.913105726242065
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0025387
	speed: 0.1180s/iter; left time: 3983.5902s
	iters: 200, epoch: 19 | loss: 0.0253442
	speed: 0.0372s/iter; left time: 1250.7956s
	iters: 300, epoch: 19 | loss: 0.0008072
	speed: 0.0356s/iter; left time: 1194.3057s
	iters: 400, epoch: 19 | loss: 0.0000034
	speed: 0.0379s/iter; left time: 1267.3968s
Epoch: 19 cost time: 15.69497036933899
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000958
	speed: 0.1245s/iter; left time: 4153.8743s
	iters: 200, epoch: 20 | loss: 0.0014489
	speed: 0.0361s/iter; left time: 1200.6845s
	iters: 300, epoch: 20 | loss: 0.0001366
	speed: 0.0384s/iter; left time: 1274.6542s
	iters: 400, epoch: 20 | loss: 0.0006321
	speed: 0.0381s/iter; left time: 1259.0553s
Epoch: 20 cost time: 16.14620327949524
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0001055
	speed: 0.1254s/iter; left time: 4129.6494s
	iters: 200, epoch: 21 | loss: 0.0020709
	speed: 0.0390s/iter; left time: 1280.8626s
	iters: 300, epoch: 21 | loss: 0.0001668
	speed: 0.0386s/iter; left time: 1264.1816s
	iters: 400, epoch: 21 | loss: 0.0000062
	speed: 0.0387s/iter; left time: 1262.2603s
Epoch: 21 cost time: 16.614179849624634
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.980899 --> -0.982718).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0019046
	speed: 0.1246s/iter; left time: 4053.5577s
	iters: 200, epoch: 22 | loss: 0.0000140
	speed: 0.0385s/iter; left time: 1247.4740s
	iters: 300, epoch: 22 | loss: 0.0000029
	speed: 0.0379s/iter; left time: 1225.2733s
	iters: 400, epoch: 22 | loss: 0.0000029
	speed: 0.0373s/iter; left time: 1203.0170s
Epoch: 22 cost time: 16.195534706115723
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.982718 --> -0.982718).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000465
	speed: 0.1202s/iter; left time: 3861.1443s
	iters: 200, epoch: 23 | loss: 0.0000246
	speed: 0.0357s/iter; left time: 1143.7235s
	iters: 300, epoch: 23 | loss: 0.0017240
	speed: 0.0383s/iter; left time: 1223.6128s
	iters: 400, epoch: 23 | loss: 0.0000029
	speed: 0.0372s/iter; left time: 1182.9112s
Epoch: 23 cost time: 15.732363224029541
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0096196
	speed: 0.1217s/iter; left time: 3858.5429s
	iters: 200, epoch: 24 | loss: 0.0000124
	speed: 0.0400s/iter; left time: 1264.3362s
	iters: 300, epoch: 24 | loss: 0.0000025
	speed: 0.0410s/iter; left time: 1290.9556s
	iters: 400, epoch: 24 | loss: 0.0000021
	speed: 0.0385s/iter; left time: 1209.6600s
Epoch: 24 cost time: 17.008002281188965
Epoch: 24, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
Validation loss decreased (-0.982718 --> -0.984083).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000467
	speed: 0.1250s/iter; left time: 3911.9751s
	iters: 200, epoch: 25 | loss: 0.0010348
	speed: 0.0385s/iter; left time: 1199.4712s
	iters: 300, epoch: 25 | loss: 0.0000011
	speed: 0.0392s/iter; left time: 1219.6648s
	iters: 400, epoch: 25 | loss: 0.0001493
	speed: 0.0361s/iter; left time: 1118.6125s
Epoch: 25 cost time: 16.212087631225586
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
Validation loss decreased (-0.984083 --> -0.984538).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000021
	speed: 0.1227s/iter; left time: 3787.4488s
	iters: 200, epoch: 26 | loss: 0.0000012
	speed: 0.0388s/iter; left time: 1195.0491s
	iters: 300, epoch: 26 | loss: 0.0983376
	speed: 0.0367s/iter; left time: 1125.9439s
	iters: 400, epoch: 26 | loss: 0.0000038
	speed: 0.0361s/iter; left time: 1104.6407s
Epoch: 26 cost time: 16.010500192642212
Epoch: 26, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.069 Vali Acc: 0.988 Test Loss: 0.069 Test Acc: 0.988
Validation loss decreased (-0.984538 --> -0.987721).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0021355
	speed: 0.1235s/iter; left time: 3761.7128s
	iters: 200, epoch: 27 | loss: 0.0172716
	speed: 0.0377s/iter; left time: 1144.9912s
	iters: 300, epoch: 27 | loss: 0.0000011
	speed: 0.0383s/iter; left time: 1158.9095s
	iters: 400, epoch: 27 | loss: 0.0000517
	speed: 0.0371s/iter; left time: 1120.1248s
Epoch: 27 cost time: 16.131260633468628
Epoch: 27, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.060 Vali Acc: 0.989 Test Loss: 0.060 Test Acc: 0.989
Validation loss decreased (-0.987721 --> -0.989085).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000134
	speed: 0.1335s/iter; left time: 4010.9293s
	iters: 200, epoch: 28 | loss: 0.0000017
	speed: 0.0376s/iter; left time: 1126.2393s
	iters: 300, epoch: 28 | loss: 0.0018173
	speed: 0.0364s/iter; left time: 1087.9973s
	iters: 400, epoch: 28 | loss: 0.0010415
	speed: 0.0403s/iter; left time: 1198.9780s
Epoch: 28 cost time: 16.514874696731567
Epoch: 28, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.982 Test Loss: 0.122 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0009837
	speed: 0.1265s/iter; left time: 3748.3744s
	iters: 200, epoch: 29 | loss: 0.0000832
	speed: 0.0386s/iter; left time: 1140.1912s
	iters: 300, epoch: 29 | loss: 0.0102873
	speed: 0.0368s/iter; left time: 1082.8562s
	iters: 400, epoch: 29 | loss: 0.0013347
	speed: 0.0380s/iter; left time: 1114.5733s
Epoch: 29 cost time: 16.06208562850952
Epoch: 29, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.986 Test Loss: 0.091 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000336
	speed: 0.1262s/iter; left time: 3687.6655s
	iters: 200, epoch: 30 | loss: 0.0000013
	speed: 0.0392s/iter; left time: 1141.9663s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0387s/iter; left time: 1122.0091s
	iters: 400, epoch: 30 | loss: 0.0000029
	speed: 0.0379s/iter; left time: 1097.0910s
Epoch: 30 cost time: 16.438754558563232
Epoch: 30, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.986 Test Loss: 0.091 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000010
	speed: 0.1250s/iter; left time: 3601.5647s
	iters: 200, epoch: 31 | loss: 0.0000006
	speed: 0.0367s/iter; left time: 1054.6051s
	iters: 300, epoch: 31 | loss: 0.0000264
	speed: 0.0385s/iter; left time: 1102.1027s
	iters: 400, epoch: 31 | loss: 0.0000001
	speed: 0.0382s/iter; left time: 1088.2170s
Epoch: 31 cost time: 16.040018558502197
Epoch: 31, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.986 Test Loss: 0.098 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0000311
	speed: 0.1312s/iter; left time: 3724.8111s
	iters: 200, epoch: 32 | loss: 0.0000030
	speed: 0.0390s/iter; left time: 1102.7596s
	iters: 300, epoch: 32 | loss: 0.0000112
	speed: 0.0376s/iter; left time: 1061.3135s
	iters: 400, epoch: 32 | loss: 0.0002422
	speed: 0.0408s/iter; left time: 1145.7204s
Epoch: 32 cost time: 16.812398433685303
Epoch: 32, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1322s/iter; left time: 3699.2402s
	iters: 200, epoch: 33 | loss: 0.0000314
	speed: 0.0373s/iter; left time: 1040.7068s
	iters: 300, epoch: 33 | loss: 0.0000019
	speed: 0.0384s/iter; left time: 1065.7511s
	iters: 400, epoch: 33 | loss: 0.0060833
	speed: 0.0374s/iter; left time: 1036.0524s
Epoch: 33 cost time: 16.230233907699585
Epoch: 33, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.982 Test Loss: 0.115 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000072
	speed: 0.1251s/iter; left time: 3449.5882s
	iters: 200, epoch: 34 | loss: 0.0000678
	speed: 0.0393s/iter; left time: 1080.9824s
	iters: 300, epoch: 34 | loss: 0.0004909
	speed: 0.0400s/iter; left time: 1095.6147s
	iters: 400, epoch: 34 | loss: 0.0025859
	speed: 0.0388s/iter; left time: 1057.5983s
Epoch: 34 cost time: 16.668280124664307
Epoch: 34, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.162 Vali Acc: 0.979 Test Loss: 0.162 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000002
	speed: 0.1228s/iter; left time: 3335.5969s
	iters: 200, epoch: 35 | loss: 0.0000004
	speed: 0.0371s/iter; left time: 1002.9018s
	iters: 300, epoch: 35 | loss: 0.0000078
	speed: 0.0369s/iter; left time: 995.0227s
	iters: 400, epoch: 35 | loss: 0.0000001
	speed: 0.0375s/iter; left time: 1007.2693s
Epoch: 35 cost time: 15.986806869506836
Epoch: 35, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.984 Test Loss: 0.096 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1320s/iter; left time: 3531.0735s
	iters: 200, epoch: 36 | loss: 0.0000002
	speed: 0.0404s/iter; left time: 1077.8150s
	iters: 300, epoch: 36 | loss: 0.0001775
	speed: 0.0391s/iter; left time: 1038.9744s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 1025.8917s
Epoch: 36 cost time: 16.92720937728882
Epoch: 36, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.986 Test Loss: 0.075 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0002861
	speed: 0.1323s/iter; left time: 3483.4933s
	iters: 200, epoch: 37 | loss: 0.0078422
	speed: 0.0417s/iter; left time: 1094.5261s
	iters: 300, epoch: 37 | loss: 0.0002173
	speed: 0.0397s/iter; left time: 1038.2518s
	iters: 400, epoch: 37 | loss: 0.0006431
	speed: 0.0395s/iter; left time: 1027.5338s
Epoch: 37 cost time: 17.249611139297485
Epoch: 37, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.981 Test Loss: 0.119 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 53938
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2596616
	speed: 0.0548s/iter; left time: 2256.1311s
	iters: 200, epoch: 1 | loss: 0.2803230
	speed: 0.0375s/iter; left time: 1543.2165s
	iters: 300, epoch: 1 | loss: 0.1978678
	speed: 0.0367s/iter; left time: 1506.5817s
	iters: 400, epoch: 1 | loss: 0.3976285
	speed: 0.0360s/iter; left time: 1472.2441s
Epoch: 1 cost time: 17.020936250686646
Epoch: 1, Steps: 413 | Train Loss: 0.763 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0651127
	speed: 0.1272s/iter; left time: 5188.9089s
	iters: 200, epoch: 2 | loss: 0.1339195
	speed: 0.0387s/iter; left time: 1574.4279s
	iters: 300, epoch: 2 | loss: 0.0334504
	speed: 0.0371s/iter; left time: 1506.6854s
	iters: 400, epoch: 2 | loss: 0.0492595
	speed: 0.0383s/iter; left time: 1551.8332s
Epoch: 2 cost time: 16.21525502204895
Epoch: 2, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
Validation loss decreased (-0.953614 --> -0.973623).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0652811
	speed: 0.1289s/iter; left time: 5204.8723s
	iters: 200, epoch: 3 | loss: 0.0617455
	speed: 0.0368s/iter; left time: 1482.8379s
	iters: 300, epoch: 3 | loss: 0.0172266
	speed: 0.0374s/iter; left time: 1502.6770s
	iters: 400, epoch: 3 | loss: 0.0436149
	speed: 0.0359s/iter; left time: 1439.5901s
Epoch: 3 cost time: 15.666539430618286
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
Validation loss decreased (-0.973623 --> -0.976352).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0325840
	speed: 0.1178s/iter; left time: 4707.2503s
	iters: 200, epoch: 4 | loss: 0.0070321
	speed: 0.0360s/iter; left time: 1434.3835s
	iters: 300, epoch: 4 | loss: 0.0193413
	speed: 0.0373s/iter; left time: 1484.6317s
	iters: 400, epoch: 4 | loss: 0.0956002
	speed: 0.0357s/iter; left time: 1414.4775s
Epoch: 4 cost time: 15.657836198806763
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.063 Vali Acc: 0.977 Test Loss: 0.063 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.976807).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0012141
	speed: 0.1193s/iter; left time: 4717.0565s
	iters: 200, epoch: 5 | loss: 0.0060309
	speed: 0.0366s/iter; left time: 1444.1571s
	iters: 300, epoch: 5 | loss: 0.0176644
	speed: 0.0379s/iter; left time: 1490.4961s
	iters: 400, epoch: 5 | loss: 0.0110312
	speed: 0.0362s/iter; left time: 1422.2503s
Epoch: 5 cost time: 15.699035406112671
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.056 Vali Acc: 0.978 Test Loss: 0.056 Test Acc: 0.978
Validation loss decreased (-0.976807 --> -0.978171).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0006785
	speed: 0.1216s/iter; left time: 4758.0742s
	iters: 200, epoch: 6 | loss: 0.0049566
	speed: 0.0398s/iter; left time: 1552.6230s
	iters: 300, epoch: 6 | loss: 0.0066117
	speed: 0.0388s/iter; left time: 1512.4078s
	iters: 400, epoch: 6 | loss: 0.3664499
	speed: 0.0362s/iter; left time: 1404.8610s
Epoch: 6 cost time: 16.115194082260132
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.054 Vali Acc: 0.981 Test Loss: 0.054 Test Acc: 0.981
Validation loss decreased (-0.978171 --> -0.980900).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1637039
	speed: 0.1235s/iter; left time: 4783.6896s
	iters: 200, epoch: 7 | loss: 0.0022002
	speed: 0.0383s/iter; left time: 1479.7082s
	iters: 300, epoch: 7 | loss: 0.0153460
	speed: 0.0360s/iter; left time: 1385.1021s
	iters: 400, epoch: 7 | loss: 0.0002442
	speed: 0.0346s/iter; left time: 1328.8621s
Epoch: 7 cost time: 15.801821231842041
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.052 Vali Acc: 0.983 Test Loss: 0.052 Test Acc: 0.983
Validation loss decreased (-0.980900 --> -0.983174).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0009340
	speed: 0.1204s/iter; left time: 4611.4124s
	iters: 200, epoch: 8 | loss: 0.0044761
	speed: 0.0364s/iter; left time: 1389.6852s
	iters: 300, epoch: 8 | loss: 0.0287877
	speed: 0.0367s/iter; left time: 1397.8122s
	iters: 400, epoch: 8 | loss: 0.0036352
	speed: 0.0365s/iter; left time: 1388.5645s
Epoch: 8 cost time: 15.63489031791687
Epoch: 8, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.063 Vali Acc: 0.982 Test Loss: 0.063 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0001246
	speed: 0.1207s/iter; left time: 4574.0035s
	iters: 200, epoch: 9 | loss: 0.0001410
	speed: 0.0344s/iter; left time: 1301.4417s
	iters: 300, epoch: 9 | loss: 0.0003201
	speed: 0.0372s/iter; left time: 1402.0200s
	iters: 400, epoch: 9 | loss: 0.0008399
	speed: 0.0387s/iter; left time: 1456.3498s
Epoch: 9 cost time: 15.738896369934082
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.050 Vali Acc: 0.983 Test Loss: 0.050 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0034054
	speed: 0.1265s/iter; left time: 4739.9942s
	iters: 200, epoch: 10 | loss: 0.0079136
	speed: 0.0389s/iter; left time: 1455.6660s
	iters: 300, epoch: 10 | loss: 0.0005015
	speed: 0.0392s/iter; left time: 1461.0225s
	iters: 400, epoch: 10 | loss: 0.0001531
	speed: 0.0389s/iter; left time: 1446.7222s
Epoch: 10 cost time: 16.559863090515137
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.061 Vali Acc: 0.981 Test Loss: 0.061 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0012631
	speed: 0.1284s/iter; left time: 4760.6935s
	iters: 200, epoch: 11 | loss: 0.0027329
	speed: 0.0373s/iter; left time: 1379.9569s
	iters: 300, epoch: 11 | loss: 0.0011687
	speed: 0.0367s/iter; left time: 1354.2669s
	iters: 400, epoch: 11 | loss: 0.0703483
	speed: 0.0368s/iter; left time: 1354.2210s
Epoch: 11 cost time: 15.953730821609497
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.039 Vali Acc: 0.985 Test Loss: 0.039 Test Acc: 0.985
Validation loss decreased (-0.983174 --> -0.985448).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0018113
	speed: 0.1218s/iter; left time: 4466.5874s
	iters: 200, epoch: 12 | loss: 0.2848828
	speed: 0.0364s/iter; left time: 1330.1794s
	iters: 300, epoch: 12 | loss: 0.0000558
	speed: 0.0367s/iter; left time: 1337.4968s
	iters: 400, epoch: 12 | loss: 0.0360302
	speed: 0.0362s/iter; left time: 1315.6944s
Epoch: 12 cost time: 15.553247928619385
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0002542
	speed: 0.1182s/iter; left time: 4284.6007s
	iters: 200, epoch: 13 | loss: 0.0251833
	speed: 0.0362s/iter; left time: 1308.1949s
	iters: 300, epoch: 13 | loss: 0.0214706
	speed: 0.0386s/iter; left time: 1391.9379s
	iters: 400, epoch: 13 | loss: 0.0017913
	speed: 0.0389s/iter; left time: 1396.5349s
Epoch: 13 cost time: 15.872382879257202
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.055 Vali Acc: 0.983 Test Loss: 0.055 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000942
	speed: 0.1258s/iter; left time: 4506.6846s
	iters: 200, epoch: 14 | loss: 0.0001207
	speed: 0.0380s/iter; left time: 1359.2743s
	iters: 300, epoch: 14 | loss: 0.0168900
	speed: 0.0378s/iter; left time: 1347.7570s
	iters: 400, epoch: 14 | loss: 0.0002244
	speed: 0.0386s/iter; left time: 1369.8005s
Epoch: 14 cost time: 16.26605749130249
Epoch: 14, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.050 Vali Acc: 0.985 Test Loss: 0.050 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0015908
	speed: 0.1260s/iter; left time: 4464.2438s
	iters: 200, epoch: 15 | loss: 0.0003358
	speed: 0.0370s/iter; left time: 1307.7715s
	iters: 300, epoch: 15 | loss: 0.0000169
	speed: 0.0372s/iter; left time: 1311.4890s
	iters: 400, epoch: 15 | loss: 0.0000590
	speed: 0.0377s/iter; left time: 1325.1776s
Epoch: 15 cost time: 15.91117525100708
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.053 Vali Acc: 0.984 Test Loss: 0.053 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000478
	speed: 0.1197s/iter; left time: 4188.6703s
	iters: 200, epoch: 16 | loss: 0.0000344
	speed: 0.0363s/iter; left time: 1266.5029s
	iters: 300, epoch: 16 | loss: 0.0000200
	speed: 0.0383s/iter; left time: 1331.8448s
	iters: 400, epoch: 16 | loss: 0.0036992
	speed: 0.0356s/iter; left time: 1236.1397s
Epoch: 16 cost time: 15.58594036102295
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0500556
	speed: 0.1207s/iter; left time: 4176.0892s
	iters: 200, epoch: 17 | loss: 0.0007079
	speed: 0.0394s/iter; left time: 1357.4061s
	iters: 300, epoch: 17 | loss: 0.0152046
	speed: 0.0391s/iter; left time: 1343.3455s
	iters: 400, epoch: 17 | loss: 0.0021264
	speed: 0.0391s/iter; left time: 1342.1141s
Epoch: 17 cost time: 16.558243989944458
Epoch: 17, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0051336
	speed: 0.1369s/iter; left time: 4680.0147s
	iters: 200, epoch: 18 | loss: 0.0038275
	speed: 0.0403s/iter; left time: 1375.0248s
	iters: 300, epoch: 18 | loss: 0.0016247
	speed: 0.0398s/iter; left time: 1353.3256s
	iters: 400, epoch: 18 | loss: 0.0018334
	speed: 0.0391s/iter; left time: 1324.4260s
Epoch: 18 cost time: 17.0329806804657
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0007164
	speed: 0.1130s/iter; left time: 3816.6413s
	iters: 200, epoch: 19 | loss: 0.0000322
	speed: 0.0415s/iter; left time: 1396.6346s
	iters: 300, epoch: 19 | loss: 0.0000090
	speed: 0.0410s/iter; left time: 1375.9552s
	iters: 400, epoch: 19 | loss: 0.0000143
	speed: 0.0378s/iter; left time: 1265.6272s
Epoch: 19 cost time: 16.698538541793823
Epoch: 19, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000849
	speed: 0.1023s/iter; left time: 3411.5114s
	iters: 200, epoch: 20 | loss: 0.0300348
	speed: 0.0335s/iter; left time: 1113.7214s
	iters: 300, epoch: 20 | loss: 0.0001607
	speed: 0.0326s/iter; left time: 1081.3243s
	iters: 400, epoch: 20 | loss: 0.0000416
	speed: 0.0350s/iter; left time: 1155.3219s
Epoch: 20 cost time: 14.210737705230713
Epoch: 20, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0696297
	speed: 0.1185s/iter; left time: 3902.9410s
	iters: 200, epoch: 21 | loss: 0.0000004
	speed: 0.0358s/iter; left time: 1177.1672s
	iters: 300, epoch: 21 | loss: 0.0000037
	speed: 0.0356s/iter; left time: 1166.0198s
	iters: 400, epoch: 21 | loss: 0.0002284
	speed: 0.0354s/iter; left time: 1156.0793s
Epoch: 21 cost time: 15.35588264465332
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 53938
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.5628548
	speed: 0.0554s/iter; left time: 2282.0794s
	iters: 200, epoch: 1 | loss: 0.3925213
	speed: 0.0369s/iter; left time: 1518.6181s
	iters: 300, epoch: 1 | loss: 0.2818324
	speed: 0.0361s/iter; left time: 1479.6841s
	iters: 400, epoch: 1 | loss: 0.3076982
	speed: 0.0377s/iter; left time: 1540.5966s
Epoch: 1 cost time: 17.152408599853516
Epoch: 1, Steps: 413 | Train Loss: 0.895 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
Validation loss decreased (inf --> -0.950885).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0916755
	speed: 0.1178s/iter; left time: 4806.5712s
	iters: 200, epoch: 2 | loss: 0.1903380
	speed: 0.0375s/iter; left time: 1527.6058s
	iters: 300, epoch: 2 | loss: 0.0283739
	speed: 0.0391s/iter; left time: 1587.1917s
	iters: 400, epoch: 2 | loss: 0.0408616
	speed: 0.0371s/iter; left time: 1503.9404s
Epoch: 2 cost time: 15.954745054244995
Epoch: 2, Steps: 413 | Train Loss: 0.153 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
Validation loss decreased (-0.950885 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0528062
	speed: 0.1147s/iter; left time: 4629.9770s
	iters: 200, epoch: 3 | loss: 0.0352007
	speed: 0.0365s/iter; left time: 1470.2864s
	iters: 300, epoch: 3 | loss: 0.0600922
	speed: 0.0365s/iter; left time: 1466.0669s
	iters: 400, epoch: 3 | loss: 0.0090846
	speed: 0.0360s/iter; left time: 1443.0819s
Epoch: 3 cost time: 15.359706163406372
Epoch: 3, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.080 Vali Acc: 0.971 Test Loss: 0.080 Test Acc: 0.971
Validation loss decreased (-0.968621 --> -0.971350).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0710947
	speed: 0.1113s/iter; left time: 4448.9985s
	iters: 200, epoch: 4 | loss: 0.0075757
	speed: 0.0358s/iter; left time: 1427.1970s
	iters: 300, epoch: 4 | loss: 0.0041539
	speed: 0.0334s/iter; left time: 1327.8342s
	iters: 400, epoch: 4 | loss: 0.1786792
	speed: 0.0366s/iter; left time: 1451.6164s
Epoch: 4 cost time: 14.998189449310303
Epoch: 4, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.082 Vali Acc: 0.972 Test Loss: 0.082 Test Acc: 0.972
Validation loss decreased (-0.971350 --> -0.972259).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0013589
	speed: 0.1128s/iter; left time: 4463.0333s
	iters: 200, epoch: 5 | loss: 0.0152790
	speed: 0.0367s/iter; left time: 1446.9827s
	iters: 300, epoch: 5 | loss: 0.0094746
	speed: 0.0361s/iter; left time: 1420.1728s
	iters: 400, epoch: 5 | loss: 0.0295906
	speed: 0.0374s/iter; left time: 1466.7075s
Epoch: 5 cost time: 15.404432535171509
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.081 Vali Acc: 0.971 Test Loss: 0.081 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0012233
	speed: 0.1189s/iter; left time: 4652.8076s
	iters: 200, epoch: 6 | loss: 0.0012180
	speed: 0.0364s/iter; left time: 1421.4818s
	iters: 300, epoch: 6 | loss: 0.0212178
	speed: 0.0384s/iter; left time: 1494.1751s
	iters: 400, epoch: 6 | loss: 0.0330824
	speed: 0.0392s/iter; left time: 1522.3466s
Epoch: 6 cost time: 16.292441368103027
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.972259 --> -0.980445).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0026367
	speed: 0.1192s/iter; left time: 4613.8780s
	iters: 200, epoch: 7 | loss: 0.0045545
	speed: 0.0380s/iter; left time: 1466.8190s
	iters: 300, epoch: 7 | loss: 0.0038795
	speed: 0.0367s/iter; left time: 1413.1190s
	iters: 400, epoch: 7 | loss: 0.0011466
	speed: 0.0357s/iter; left time: 1370.4471s
Epoch: 7 cost time: 15.580204725265503
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.059 Vali Acc: 0.979 Test Loss: 0.059 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0005177
	speed: 0.1155s/iter; left time: 4423.9477s
	iters: 200, epoch: 8 | loss: 0.0051862
	speed: 0.0371s/iter; left time: 1418.2938s
	iters: 300, epoch: 8 | loss: 0.0066666
	speed: 0.0358s/iter; left time: 1365.2191s
	iters: 400, epoch: 8 | loss: 0.0060487
	speed: 0.0369s/iter; left time: 1403.6709s
Epoch: 8 cost time: 15.441194772720337
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001813
	speed: 0.1182s/iter; left time: 4478.4449s
	iters: 200, epoch: 9 | loss: 0.0017185
	speed: 0.0366s/iter; left time: 1382.5171s
	iters: 300, epoch: 9 | loss: 0.0022270
	speed: 0.0376s/iter; left time: 1416.9817s
	iters: 400, epoch: 9 | loss: 0.0006876
	speed: 0.0385s/iter; left time: 1446.9775s
Epoch: 9 cost time: 16.00892686843872
Epoch: 9, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.975 Test Loss: 0.075 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0005591
	speed: 0.1251s/iter; left time: 4689.2982s
	iters: 200, epoch: 10 | loss: 0.0090534
	speed: 0.0387s/iter; left time: 1445.6472s
	iters: 300, epoch: 10 | loss: 0.0002656
	speed: 0.0374s/iter; left time: 1394.8940s
	iters: 400, epoch: 10 | loss: 0.0033898
	speed: 0.0386s/iter; left time: 1435.8455s
Epoch: 10 cost time: 16.293466329574585
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0094773
	speed: 0.1246s/iter; left time: 4618.2825s
	iters: 200, epoch: 11 | loss: 0.0001283
	speed: 0.0363s/iter; left time: 1343.3723s
	iters: 300, epoch: 11 | loss: 0.0000921
	speed: 0.0350s/iter; left time: 1289.2422s
	iters: 400, epoch: 11 | loss: 0.2104216
	speed: 0.0353s/iter; left time: 1297.5431s
Epoch: 11 cost time: 15.202150106430054
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0070652
	speed: 0.1213s/iter; left time: 4447.6135s
	iters: 200, epoch: 12 | loss: 0.0010278
	speed: 0.0354s/iter; left time: 1295.2023s
	iters: 300, epoch: 12 | loss: 0.0002738
	speed: 0.0390s/iter; left time: 1421.0153s
	iters: 400, epoch: 12 | loss: 0.0048002
	speed: 0.0355s/iter; left time: 1290.3270s
Epoch: 12 cost time: 15.515806913375854
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000206
	speed: 0.1183s/iter; left time: 4288.5939s
	iters: 200, epoch: 13 | loss: 0.0984809
	speed: 0.0359s/iter; left time: 1298.8202s
	iters: 300, epoch: 13 | loss: 0.0027239
	speed: 0.0378s/iter; left time: 1363.7574s
	iters: 400, epoch: 13 | loss: 0.0039263
	speed: 0.0374s/iter; left time: 1343.8345s
Epoch: 13 cost time: 15.694090843200684
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0006192
	speed: 0.1224s/iter; left time: 4384.2202s
	iters: 200, epoch: 14 | loss: 0.0014166
	speed: 0.0367s/iter; left time: 1309.7235s
	iters: 300, epoch: 14 | loss: 0.0072521
	speed: 0.0388s/iter; left time: 1382.0681s
	iters: 400, epoch: 14 | loss: 0.0001201
	speed: 0.0367s/iter; left time: 1305.7499s
Epoch: 14 cost time: 15.94838285446167
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0395885
	speed: 0.1184s/iter; left time: 4192.3744s
	iters: 200, epoch: 15 | loss: 0.0002962
	speed: 0.0375s/iter; left time: 1324.6780s
	iters: 300, epoch: 15 | loss: 0.0107074
	speed: 0.0378s/iter; left time: 1330.9207s
	iters: 400, epoch: 15 | loss: 0.0000585
	speed: 0.0374s/iter; left time: 1312.1955s
Epoch: 15 cost time: 15.745720863342285
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.063 Vali Acc: 0.981 Test Loss: 0.063 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.981355).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000142
	speed: 0.1166s/iter; left time: 4081.9166s
	iters: 200, epoch: 16 | loss: 0.0000308
	speed: 0.0379s/iter; left time: 1321.2189s
	iters: 300, epoch: 16 | loss: 0.0000269
	speed: 0.0374s/iter; left time: 1300.0325s
	iters: 400, epoch: 16 | loss: 0.0031447
	speed: 0.0364s/iter; left time: 1261.6981s
Epoch: 16 cost time: 15.757400751113892
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000010
	speed: 0.1173s/iter; left time: 4056.4620s
	iters: 200, epoch: 17 | loss: 0.0002464
	speed: 0.0358s/iter; left time: 1233.2748s
	iters: 300, epoch: 17 | loss: 0.0025874
	speed: 0.0375s/iter; left time: 1289.2910s
	iters: 400, epoch: 17 | loss: 0.0076571
	speed: 0.0387s/iter; left time: 1326.8637s
Epoch: 17 cost time: 15.768067121505737
Epoch: 17, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.049 Vali Acc: 0.986 Test Loss: 0.049 Test Acc: 0.986
Validation loss decreased (-0.981355 --> -0.985902).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000883
	speed: 0.1176s/iter; left time: 4018.8632s
	iters: 200, epoch: 18 | loss: 0.0001046
	speed: 0.0368s/iter; left time: 1254.2523s
	iters: 300, epoch: 18 | loss: 0.0722588
	speed: 0.0367s/iter; left time: 1245.5466s
	iters: 400, epoch: 18 | loss: 0.0009947
	speed: 0.0366s/iter; left time: 1239.1558s
Epoch: 18 cost time: 15.54806137084961
Epoch: 18, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0002470
	speed: 0.1198s/iter; left time: 4043.8612s
	iters: 200, epoch: 19 | loss: 0.0000401
	speed: 0.0353s/iter; left time: 1187.2463s
	iters: 300, epoch: 19 | loss: 0.0003594
	speed: 0.0368s/iter; left time: 1233.9864s
	iters: 400, epoch: 19 | loss: 0.0003790
	speed: 0.0375s/iter; left time: 1253.7122s
Epoch: 19 cost time: 15.609588861465454
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0002338
	speed: 0.1203s/iter; left time: 4013.9980s
	iters: 200, epoch: 20 | loss: 0.0038888
	speed: 0.0352s/iter; left time: 1170.3106s
	iters: 300, epoch: 20 | loss: 0.0092714
	speed: 0.0358s/iter; left time: 1187.4587s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0344s/iter; left time: 1136.8389s
Epoch: 20 cost time: 15.122234582901001
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0005250
	speed: 0.1118s/iter; left time: 3682.3659s
	iters: 200, epoch: 21 | loss: 0.0141633
	speed: 0.0339s/iter; left time: 1111.6924s
	iters: 300, epoch: 21 | loss: 0.0008973
	speed: 0.0351s/iter; left time: 1150.1653s
	iters: 400, epoch: 21 | loss: 0.0003362
	speed: 0.0366s/iter; left time: 1193.0517s
Epoch: 21 cost time: 14.901578187942505
Epoch: 21, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0026804
	speed: 0.1193s/iter; left time: 3879.7252s
	iters: 200, epoch: 22 | loss: 0.0004529
	speed: 0.0383s/iter; left time: 1241.0822s
	iters: 300, epoch: 22 | loss: 0.0016198
	speed: 0.0375s/iter; left time: 1213.7984s
	iters: 400, epoch: 22 | loss: 0.0017893
	speed: 0.0374s/iter; left time: 1204.9592s
Epoch: 22 cost time: 15.936794757843018
Epoch: 22, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000002
	speed: 0.1166s/iter; left time: 3744.3224s
	iters: 200, epoch: 23 | loss: 0.0001222
	speed: 0.0374s/iter; left time: 1197.5154s
	iters: 300, epoch: 23 | loss: 0.0003886
	speed: 0.0372s/iter; left time: 1186.9382s
	iters: 400, epoch: 23 | loss: 0.0000237
	speed: 0.0362s/iter; left time: 1152.1473s
Epoch: 23 cost time: 15.544633626937866
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000010
	speed: 0.1178s/iter; left time: 3734.3388s
	iters: 200, epoch: 24 | loss: 0.0050879
	speed: 0.0373s/iter; left time: 1178.8660s
	iters: 300, epoch: 24 | loss: 0.0006961
	speed: 0.0353s/iter; left time: 1111.8604s
	iters: 400, epoch: 24 | loss: 0.0000346
	speed: 0.0346s/iter; left time: 1085.9242s
Epoch: 24 cost time: 15.26416826248169
Epoch: 24, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000509
	speed: 0.1155s/iter; left time: 3613.4540s
	iters: 200, epoch: 25 | loss: 0.0000088
	speed: 0.0384s/iter; left time: 1196.5038s
	iters: 300, epoch: 25 | loss: 0.0000008
	speed: 0.0391s/iter; left time: 1216.0618s
	iters: 400, epoch: 25 | loss: 0.0899603
	speed: 0.0384s/iter; left time: 1190.6088s
Epoch: 25 cost time: 16.110532760620117
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0009096
	speed: 0.1238s/iter; left time: 3821.4630s
	iters: 200, epoch: 26 | loss: 0.0004507
	speed: 0.0372s/iter; left time: 1144.5824s
	iters: 300, epoch: 26 | loss: 0.0001856
	speed: 0.0385s/iter; left time: 1181.3141s
	iters: 400, epoch: 26 | loss: 0.0000016
	speed: 0.0379s/iter; left time: 1159.0532s
Epoch: 26 cost time: 15.927788019180298
Epoch: 26, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000345
	speed: 0.1207s/iter; left time: 3676.2074s
	iters: 200, epoch: 27 | loss: 0.0000716
	speed: 0.0372s/iter; left time: 1128.4672s
	iters: 300, epoch: 27 | loss: 0.0000218
	speed: 0.0345s/iter; left time: 1043.0241s
	iters: 400, epoch: 27 | loss: 0.0000707
	speed: 0.0373s/iter; left time: 1125.7094s
Epoch: 27 cost time: 15.710144281387329
Epoch: 27, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 53938
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9451000
	speed: 0.0564s/iter; left time: 2323.9391s
	iters: 200, epoch: 1 | loss: 0.5869814
	speed: 0.0378s/iter; left time: 1552.2840s
	iters: 300, epoch: 1 | loss: 0.3541160
	speed: 0.0361s/iter; left time: 1480.0094s
	iters: 400, epoch: 1 | loss: 0.0809861
	speed: 0.0379s/iter; left time: 1549.3096s
Epoch: 1 cost time: 17.399985551834106
Epoch: 1, Steps: 413 | Train Loss: 0.726 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2586043
	speed: 0.1252s/iter; left time: 5108.1923s
	iters: 200, epoch: 2 | loss: 0.1693976
	speed: 0.0379s/iter; left time: 1543.7638s
	iters: 300, epoch: 2 | loss: 0.0453875
	speed: 0.0369s/iter; left time: 1496.6575s
	iters: 400, epoch: 2 | loss: 0.1663210
	speed: 0.0385s/iter; left time: 1559.6007s
Epoch: 2 cost time: 16.18299388885498
Epoch: 2, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.077 Vali Acc: 0.974 Test Loss: 0.077 Test Acc: 0.974
Validation loss decreased (-0.957252 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2109571
	speed: 0.1230s/iter; left time: 4967.5425s
	iters: 200, epoch: 3 | loss: 0.0181639
	speed: 0.0363s/iter; left time: 1463.2337s
	iters: 300, epoch: 3 | loss: 0.0087772
	speed: 0.0374s/iter; left time: 1502.9504s
	iters: 400, epoch: 3 | loss: 0.0209831
	speed: 0.0358s/iter; left time: 1435.6471s
Epoch: 3 cost time: 15.687906742095947
Epoch: 3, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0239180
	speed: 0.1178s/iter; left time: 4705.7428s
	iters: 200, epoch: 4 | loss: 0.0283455
	speed: 0.0360s/iter; left time: 1436.3684s
	iters: 300, epoch: 4 | loss: 0.0109973
	speed: 0.0380s/iter; left time: 1510.6295s
	iters: 400, epoch: 4 | loss: 0.2380399
	speed: 0.0378s/iter; left time: 1497.6371s
Epoch: 4 cost time: 15.911725997924805
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.069 Vali Acc: 0.975 Test Loss: 0.069 Test Acc: 0.975
Validation loss decreased (-0.974078 --> -0.975443).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0304652
	speed: 0.1197s/iter; left time: 4735.7202s
	iters: 200, epoch: 5 | loss: 0.0267167
	speed: 0.0351s/iter; left time: 1386.0855s
	iters: 300, epoch: 5 | loss: 0.0030275
	speed: 0.0365s/iter; left time: 1435.7130s
	iters: 400, epoch: 5 | loss: 0.0020906
	speed: 0.0382s/iter; left time: 1498.9053s
Epoch: 5 cost time: 15.477490663528442
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.066 Vali Acc: 0.975 Test Loss: 0.066 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0018540
	speed: 0.1225s/iter; left time: 4795.3372s
	iters: 200, epoch: 6 | loss: 0.0291238
	speed: 0.0389s/iter; left time: 1519.7073s
	iters: 300, epoch: 6 | loss: 0.0057444
	speed: 0.0379s/iter; left time: 1477.0474s
	iters: 400, epoch: 6 | loss: 0.0124177
	speed: 0.0375s/iter; left time: 1456.5006s
Epoch: 6 cost time: 16.068342447280884
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0067760
	speed: 0.1239s/iter; left time: 4798.7106s
	iters: 200, epoch: 7 | loss: 0.0007380
	speed: 0.0368s/iter; left time: 1423.1405s
	iters: 300, epoch: 7 | loss: 0.0405275
	speed: 0.0384s/iter; left time: 1480.7961s
	iters: 400, epoch: 7 | loss: 0.0041542
	speed: 0.0373s/iter; left time: 1432.5335s
Epoch: 7 cost time: 16.161222457885742
Epoch: 7, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.062 Vali Acc: 0.979 Test Loss: 0.062 Test Acc: 0.979
Validation loss decreased (-0.975443 --> -0.978626).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2427912
	speed: 0.1189s/iter; left time: 4556.1222s
	iters: 200, epoch: 8 | loss: 0.0161735
	speed: 0.0373s/iter; left time: 1426.8267s
	iters: 300, epoch: 8 | loss: 0.0004147
	speed: 0.0379s/iter; left time: 1444.8605s
	iters: 400, epoch: 8 | loss: 0.0196430
	speed: 0.0372s/iter; left time: 1413.6014s
Epoch: 8 cost time: 15.924822092056274
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.978626 --> -0.980445).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0025882
	speed: 0.1209s/iter; left time: 4581.8411s
	iters: 200, epoch: 9 | loss: 0.0078802
	speed: 0.0381s/iter; left time: 1441.5289s
	iters: 300, epoch: 9 | loss: 0.0425661
	speed: 0.0407s/iter; left time: 1535.5800s
	iters: 400, epoch: 9 | loss: 0.0094309
	speed: 0.0401s/iter; left time: 1508.7703s
Epoch: 9 cost time: 16.521831512451172
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.980445 --> -0.980445).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3542213
	speed: 0.1233s/iter; left time: 4620.4282s
	iters: 200, epoch: 10 | loss: 0.0015036
	speed: 0.0385s/iter; left time: 1438.3328s
	iters: 300, epoch: 10 | loss: 0.0001202
	speed: 0.0386s/iter; left time: 1439.9949s
	iters: 400, epoch: 10 | loss: 0.0009025
	speed: 0.0389s/iter; left time: 1445.8214s
Epoch: 10 cost time: 16.281994819641113
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0014522
	speed: 0.1235s/iter; left time: 4578.1678s
	iters: 200, epoch: 11 | loss: 0.1767474
	speed: 0.0378s/iter; left time: 1397.8257s
	iters: 300, epoch: 11 | loss: 0.0001510
	speed: 0.0368s/iter; left time: 1356.4807s
	iters: 400, epoch: 11 | loss: 0.0325470
	speed: 0.0352s/iter; left time: 1294.8565s
Epoch: 11 cost time: 15.761601686477661
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.980900).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0002422
	speed: 0.1136s/iter; left time: 4163.7292s
	iters: 200, epoch: 12 | loss: 0.0000100
	speed: 0.0359s/iter; left time: 1313.3563s
	iters: 300, epoch: 12 | loss: 0.0006762
	speed: 0.0369s/iter; left time: 1346.8768s
	iters: 400, epoch: 12 | loss: 0.0008404
	speed: 0.0376s/iter; left time: 1365.7931s
Epoch: 12 cost time: 15.710259199142456
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0040326
	speed: 0.1183s/iter; left time: 4286.1216s
	iters: 200, epoch: 13 | loss: 0.0015147
	speed: 0.0390s/iter; left time: 1408.0698s
	iters: 300, epoch: 13 | loss: 0.0015996
	speed: 0.0375s/iter; left time: 1350.5567s
	iters: 400, epoch: 13 | loss: 0.0000358
	speed: 0.0393s/iter; left time: 1413.0888s
Epoch: 13 cost time: 16.130704641342163
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.980900 --> -0.981354).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0004833
	speed: 0.1262s/iter; left time: 4520.4217s
	iters: 200, epoch: 14 | loss: 0.0075206
	speed: 0.0392s/iter; left time: 1400.0999s
	iters: 300, epoch: 14 | loss: 0.0028526
	speed: 0.0400s/iter; left time: 1425.8540s
	iters: 400, epoch: 14 | loss: 0.0000427
	speed: 0.0380s/iter; left time: 1349.9049s
Epoch: 14 cost time: 16.73018741607666
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000007
	speed: 0.1198s/iter; left time: 4244.7886s
	iters: 200, epoch: 15 | loss: 0.0000230
	speed: 0.0383s/iter; left time: 1353.4917s
	iters: 300, epoch: 15 | loss: 0.0000525
	speed: 0.0366s/iter; left time: 1287.6690s
	iters: 400, epoch: 15 | loss: 0.0000284
	speed: 0.0373s/iter; left time: 1311.5292s
Epoch: 15 cost time: 15.73874807357788
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0037676
	speed: 0.1138s/iter; left time: 3983.4173s
	iters: 200, epoch: 16 | loss: 0.0118488
	speed: 0.0373s/iter; left time: 1302.7029s
	iters: 300, epoch: 16 | loss: 0.0000458
	speed: 0.0380s/iter; left time: 1321.2950s
	iters: 400, epoch: 16 | loss: 0.0007057
	speed: 0.0370s/iter; left time: 1283.6307s
Epoch: 16 cost time: 15.793436765670776
Epoch: 16, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.981354 --> -0.983173).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0251309
	speed: 0.1223s/iter; left time: 4230.4973s
	iters: 200, epoch: 17 | loss: 0.0000406
	speed: 0.0391s/iter; left time: 1348.6656s
	iters: 300, epoch: 17 | loss: 0.0057103
	speed: 0.0386s/iter; left time: 1327.1977s
	iters: 400, epoch: 17 | loss: 0.0006803
	speed: 0.0383s/iter; left time: 1314.7829s
Epoch: 17 cost time: 16.562170267105103
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000156
	speed: 0.1253s/iter; left time: 4282.1030s
	iters: 200, epoch: 18 | loss: 0.0004094
	speed: 0.0374s/iter; left time: 1276.1025s
	iters: 300, epoch: 18 | loss: 0.3884204
	speed: 0.0379s/iter; left time: 1288.7496s
	iters: 400, epoch: 18 | loss: 0.0000869
	speed: 0.0372s/iter; left time: 1261.5143s
Epoch: 18 cost time: 16.05676293373108
Epoch: 18, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983173 --> -0.983174).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000837
	speed: 0.1181s/iter; left time: 3986.8573s
	iters: 200, epoch: 19 | loss: 0.0001174
	speed: 0.0376s/iter; left time: 1264.7814s
	iters: 300, epoch: 19 | loss: 0.0007271
	speed: 0.0365s/iter; left time: 1224.0139s
	iters: 400, epoch: 19 | loss: 0.0000154
	speed: 0.0360s/iter; left time: 1203.3191s
Epoch: 19 cost time: 15.581291675567627
Epoch: 19, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0001601
	speed: 0.1122s/iter; left time: 3741.2034s
	iters: 200, epoch: 20 | loss: 0.0001883
	speed: 0.0370s/iter; left time: 1230.2681s
	iters: 300, epoch: 20 | loss: 0.0027141
	speed: 0.0376s/iter; left time: 1246.2712s
	iters: 400, epoch: 20 | loss: 0.0002559
	speed: 0.0371s/iter; left time: 1226.9307s
Epoch: 20 cost time: 15.674628973007202
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000230
	speed: 0.1216s/iter; left time: 4005.6661s
	iters: 200, epoch: 21 | loss: 0.0001067
	speed: 0.0409s/iter; left time: 1343.1699s
	iters: 300, epoch: 21 | loss: 0.0004153
	speed: 0.0395s/iter; left time: 1293.2718s
	iters: 400, epoch: 21 | loss: 0.0006883
	speed: 0.0382s/iter; left time: 1245.2616s
Epoch: 21 cost time: 16.843266010284424
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000913
	speed: 0.1266s/iter; left time: 4119.0886s
	iters: 200, epoch: 22 | loss: 0.0000134
	speed: 0.0398s/iter; left time: 1292.1923s
	iters: 300, epoch: 22 | loss: 0.0239209
	speed: 0.0377s/iter; left time: 1219.4405s
	iters: 400, epoch: 22 | loss: 0.0000002
	speed: 0.0396s/iter; left time: 1274.7197s
Epoch: 22 cost time: 16.542158365249634
Epoch: 22, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0005213
	speed: 0.1206s/iter; left time: 3874.0174s
	iters: 200, epoch: 23 | loss: 0.0000282
	speed: 0.0383s/iter; left time: 1225.4308s
	iters: 300, epoch: 23 | loss: 0.0009769
	speed: 0.0391s/iter; left time: 1247.5666s
	iters: 400, epoch: 23 | loss: 0.0001325
	speed: 0.0396s/iter; left time: 1261.2617s
Epoch: 23 cost time: 16.531142711639404
Epoch: 23, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.983174 --> -0.985447).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000374
	speed: 0.1242s/iter; left time: 3938.0886s
	iters: 200, epoch: 24 | loss: 0.0000099
	speed: 0.0394s/iter; left time: 1244.0085s
	iters: 300, epoch: 24 | loss: 0.0013510
	speed: 0.0387s/iter; left time: 1219.1548s
	iters: 400, epoch: 24 | loss: 0.0035290
	speed: 0.0400s/iter; left time: 1255.9555s
Epoch: 24 cost time: 16.77135992050171
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0001439
	speed: 0.1248s/iter; left time: 3906.0880s
	iters: 200, epoch: 25 | loss: 0.0000498
	speed: 0.0383s/iter; left time: 1194.2189s
	iters: 300, epoch: 25 | loss: 0.0000124
	speed: 0.0375s/iter; left time: 1164.7104s
	iters: 400, epoch: 25 | loss: 0.0000001
	speed: 0.0376s/iter; left time: 1163.8278s
Epoch: 25 cost time: 16.331613063812256
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.985 Test Loss: 0.094 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000311
	speed: 0.1228s/iter; left time: 3791.5669s
	iters: 200, epoch: 26 | loss: 0.0000612
	speed: 0.0356s/iter; left time: 1096.3940s
	iters: 300, epoch: 26 | loss: 0.0000029
	speed: 0.0378s/iter; left time: 1160.6647s
	iters: 400, epoch: 26 | loss: 0.0000010
	speed: 0.0378s/iter; left time: 1157.2742s
Epoch: 26 cost time: 15.718042850494385
Epoch: 26, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0068583
	speed: 0.1144s/iter; left time: 3485.8787s
	iters: 200, epoch: 27 | loss: 0.0000663
	speed: 0.0375s/iter; left time: 1139.5630s
	iters: 300, epoch: 27 | loss: 0.0000844
	speed: 0.0368s/iter; left time: 1113.3174s
	iters: 400, epoch: 27 | loss: 0.0009546
	speed: 0.0366s/iter; left time: 1104.6463s
Epoch: 27 cost time: 15.538516521453857
Epoch: 27, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0041992
	speed: 0.1157s/iter; left time: 3476.0546s
	iters: 200, epoch: 28 | loss: 0.0009909
	speed: 0.0373s/iter; left time: 1118.0864s
	iters: 300, epoch: 28 | loss: 0.0018237
	speed: 0.0364s/iter; left time: 1087.5644s
	iters: 400, epoch: 28 | loss: 0.0000008
	speed: 0.0357s/iter; left time: 1061.7762s
Epoch: 28 cost time: 15.644472122192383
Epoch: 28, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000005
	speed: 0.1224s/iter; left time: 3626.2723s
	iters: 200, epoch: 29 | loss: 0.0001751
	speed: 0.0374s/iter; left time: 1103.3878s
	iters: 300, epoch: 29 | loss: 0.0452108
	speed: 0.0373s/iter; left time: 1096.8206s
	iters: 400, epoch: 29 | loss: 0.0000035
	speed: 0.0385s/iter; left time: 1129.7198s
Epoch: 29 cost time: 16.216464519500732
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0002019
	speed: 0.1221s/iter; left time: 3568.0328s
	iters: 200, epoch: 30 | loss: 0.0000003
	speed: 0.0371s/iter; left time: 1080.9842s
	iters: 300, epoch: 30 | loss: 0.0000251
	speed: 0.0382s/iter; left time: 1107.3642s
	iters: 400, epoch: 30 | loss: 0.0000204
	speed: 0.0373s/iter; left time: 1078.0779s
Epoch: 30 cost time: 15.904064178466797
Epoch: 30, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000038
	speed: 0.1164s/iter; left time: 3352.6673s
	iters: 200, epoch: 31 | loss: 0.0000079
	speed: 0.0377s/iter; left time: 1083.3367s
	iters: 300, epoch: 31 | loss: 0.0003954
	speed: 0.0370s/iter; left time: 1058.8572s
	iters: 400, epoch: 31 | loss: 0.0000005
	speed: 0.0362s/iter; left time: 1032.3123s
Epoch: 31 cost time: 15.68528437614441
Epoch: 31, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000441
	speed: 0.1176s/iter; left time: 3338.5172s
	iters: 200, epoch: 32 | loss: 0.0000028
	speed: 0.0384s/iter; left time: 1085.7328s
	iters: 300, epoch: 32 | loss: 0.1402264
	speed: 0.0347s/iter; left time: 978.6778s
	iters: 400, epoch: 32 | loss: 0.0000372
	speed: 0.0374s/iter; left time: 1049.6515s
Epoch: 32 cost time: 15.519423723220825
Epoch: 32, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000001
	speed: 0.1186s/iter; left time: 3317.6336s
	iters: 200, epoch: 33 | loss: 0.0000001
	speed: 0.0389s/iter; left time: 1084.0160s
	iters: 300, epoch: 33 | loss: 0.0001202
	speed: 0.0390s/iter; left time: 1084.7167s
	iters: 400, epoch: 33 | loss: 0.0002372
	speed: 0.0383s/iter; left time: 1059.8021s
Epoch: 33 cost time: 16.281509399414062
Epoch: 33, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 45746
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9691133
	speed: 0.0545s/iter; left time: 2246.5158s
	iters: 200, epoch: 1 | loss: 0.6198279
	speed: 0.0353s/iter; left time: 1452.1525s
	iters: 300, epoch: 1 | loss: 0.3312243
	speed: 0.0356s/iter; left time: 1461.4712s
	iters: 400, epoch: 1 | loss: 0.0857807
	speed: 0.0349s/iter; left time: 1425.8107s
Epoch: 1 cost time: 16.585888385772705
Epoch: 1, Steps: 413 | Train Loss: 0.732 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
Validation loss decreased (inf --> -0.960435).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1994012
	speed: 0.1163s/iter; left time: 4741.6737s
	iters: 200, epoch: 2 | loss: 0.1838556
	speed: 0.0377s/iter; left time: 1535.6467s
	iters: 300, epoch: 2 | loss: 0.0507920
	speed: 0.0371s/iter; left time: 1505.8798s
	iters: 400, epoch: 2 | loss: 0.2205470
	speed: 0.0380s/iter; left time: 1538.5783s
Epoch: 2 cost time: 16.060317516326904
Epoch: 2, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.081 Vali Acc: 0.974 Test Loss: 0.081 Test Acc: 0.974
Validation loss decreased (-0.960435 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1859699
	speed: 0.1211s/iter; left time: 4890.3633s
	iters: 200, epoch: 3 | loss: 0.0188909
	speed: 0.0381s/iter; left time: 1536.4334s
	iters: 300, epoch: 3 | loss: 0.0124156
	speed: 0.0381s/iter; left time: 1531.4415s
	iters: 400, epoch: 3 | loss: 0.0287624
	speed: 0.0391s/iter; left time: 1568.2227s
Epoch: 3 cost time: 16.184014797210693
Epoch: 3, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0363567
	speed: 0.1205s/iter; left time: 4814.7963s
	iters: 200, epoch: 4 | loss: 0.0312445
	speed: 0.0374s/iter; left time: 1492.5538s
	iters: 300, epoch: 4 | loss: 0.0088513
	speed: 0.0384s/iter; left time: 1526.3622s
	iters: 400, epoch: 4 | loss: 0.2220337
	speed: 0.0402s/iter; left time: 1594.9404s
Epoch: 4 cost time: 16.424909591674805
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
Validation loss decreased (-0.974078 --> -0.976352).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0403279
	speed: 0.1236s/iter; left time: 4889.1194s
	iters: 200, epoch: 5 | loss: 0.0297521
	speed: 0.0390s/iter; left time: 1537.6102s
	iters: 300, epoch: 5 | loss: 0.0045055
	speed: 0.0368s/iter; left time: 1447.4962s
	iters: 400, epoch: 5 | loss: 0.0040049
	speed: 0.0357s/iter; left time: 1400.4632s
Epoch: 5 cost time: 15.885358810424805
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0011949
	speed: 0.1179s/iter; left time: 4613.7649s
	iters: 200, epoch: 6 | loss: 0.0234211
	speed: 0.0375s/iter; left time: 1462.4952s
	iters: 300, epoch: 6 | loss: 0.0047759
	speed: 0.0381s/iter; left time: 1483.2887s
	iters: 400, epoch: 6 | loss: 0.0083218
	speed: 0.0370s/iter; left time: 1437.9528s
Epoch: 6 cost time: 15.79103970527649
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
Validation loss decreased (-0.976352 --> -0.982264).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0041963
	speed: 0.1100s/iter; left time: 4260.1090s
	iters: 200, epoch: 7 | loss: 0.0013243
	speed: 0.0353s/iter; left time: 1364.3448s
	iters: 300, epoch: 7 | loss: 0.1047405
	speed: 0.0366s/iter; left time: 1408.3422s
	iters: 400, epoch: 7 | loss: 0.0009000
	speed: 0.0360s/iter; left time: 1383.2242s
Epoch: 7 cost time: 15.373997926712036
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.070 Vali Acc: 0.975 Test Loss: 0.070 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0156051
	speed: 0.1213s/iter; left time: 4646.9524s
	iters: 200, epoch: 8 | loss: 0.0120737
	speed: 0.0399s/iter; left time: 1525.1087s
	iters: 300, epoch: 8 | loss: 0.0001096
	speed: 0.0383s/iter; left time: 1460.7008s
	iters: 400, epoch: 8 | loss: 0.0146488
	speed: 0.0387s/iter; left time: 1470.6083s
Epoch: 8 cost time: 16.52031183242798
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001100
	speed: 0.1287s/iter; left time: 4876.3596s
	iters: 200, epoch: 9 | loss: 0.0032534
	speed: 0.0398s/iter; left time: 1502.5927s
	iters: 300, epoch: 9 | loss: 0.0006511
	speed: 0.0390s/iter; left time: 1468.3146s
	iters: 400, epoch: 9 | loss: 0.0195716
	speed: 0.0391s/iter; left time: 1470.5134s
Epoch: 9 cost time: 16.724801540374756
Epoch: 9, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0143220
	speed: 0.1213s/iter; left time: 4546.2802s
	iters: 200, epoch: 10 | loss: 0.0028097
	speed: 0.0374s/iter; left time: 1399.4586s
	iters: 300, epoch: 10 | loss: 0.0040377
	speed: 0.0382s/iter; left time: 1425.8256s
	iters: 400, epoch: 10 | loss: 0.0001994
	speed: 0.0375s/iter; left time: 1394.2414s
Epoch: 10 cost time: 16.030538320541382
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0013326
	speed: 0.1217s/iter; left time: 4511.0613s
	iters: 200, epoch: 11 | loss: 0.0024805
	speed: 0.0370s/iter; left time: 1367.1090s
	iters: 300, epoch: 11 | loss: 0.0002241
	speed: 0.0365s/iter; left time: 1346.9240s
	iters: 400, epoch: 11 | loss: 0.0029468
	speed: 0.0373s/iter; left time: 1370.0870s
Epoch: 11 cost time: 16.053414821624756
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000397
	speed: 0.1242s/iter; left time: 4553.6339s
	iters: 200, epoch: 12 | loss: 0.0002102
	speed: 0.0398s/iter; left time: 1454.2909s
	iters: 300, epoch: 12 | loss: 0.0000583
	speed: 0.0393s/iter; left time: 1432.9565s
	iters: 400, epoch: 12 | loss: 0.0055358
	speed: 0.0392s/iter; left time: 1424.8201s
Epoch: 12 cost time: 16.73297619819641
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0025514
	speed: 0.1278s/iter; left time: 4633.5453s
	iters: 200, epoch: 13 | loss: 0.0016716
	speed: 0.0390s/iter; left time: 1409.7908s
	iters: 300, epoch: 13 | loss: 0.0093329
	speed: 0.0388s/iter; left time: 1397.7224s
	iters: 400, epoch: 13 | loss: 0.0000027
	speed: 0.0371s/iter; left time: 1334.2269s
Epoch: 13 cost time: 16.3658127784729
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0004956
	speed: 0.1210s/iter; left time: 4335.6618s
	iters: 200, epoch: 14 | loss: 0.0057846
	speed: 0.0413s/iter; left time: 1474.6592s
	iters: 300, epoch: 14 | loss: 0.0021332
	speed: 0.0397s/iter; left time: 1415.7725s
	iters: 400, epoch: 14 | loss: 0.0003353
	speed: 0.0343s/iter; left time: 1219.5171s
Epoch: 14 cost time: 16.35478639602661
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000023
	speed: 0.0991s/iter; left time: 3510.8999s
	iters: 200, epoch: 15 | loss: 0.0001464
	speed: 0.0329s/iter; left time: 1163.0990s
	iters: 300, epoch: 15 | loss: 0.0007873
	speed: 0.0378s/iter; left time: 1332.7626s
	iters: 400, epoch: 15 | loss: 0.0008555
	speed: 0.0366s/iter; left time: 1285.7723s
Epoch: 15 cost time: 14.793444156646729
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0006749
	speed: 0.1174s/iter; left time: 4109.0542s
	iters: 200, epoch: 16 | loss: 0.0008022
	speed: 0.0390s/iter; left time: 1360.2061s
	iters: 300, epoch: 16 | loss: 0.0000135
	speed: 0.0371s/iter; left time: 1291.1548s
	iters: 400, epoch: 16 | loss: 0.0025589
	speed: 0.0369s/iter; left time: 1280.4161s
Epoch: 16 cost time: 15.888051509857178
Epoch: 16, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 45746
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0291281
	speed: 0.0586s/iter; left time: 2414.7627s
	iters: 200, epoch: 1 | loss: 0.6223890
	speed: 0.0364s/iter; left time: 1495.6739s
	iters: 300, epoch: 1 | loss: 0.3274176
	speed: 0.0358s/iter; left time: 1467.0606s
	iters: 400, epoch: 1 | loss: 0.0717793
	speed: 0.0357s/iter; left time: 1459.8139s
Epoch: 1 cost time: 17.187567710876465
Epoch: 1, Steps: 413 | Train Loss: 0.757 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
Validation loss decreased (inf --> -0.952249).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1878423
	speed: 0.1182s/iter; left time: 4819.2350s
	iters: 200, epoch: 2 | loss: 0.2053273
	speed: 0.0356s/iter; left time: 1449.2897s
	iters: 300, epoch: 2 | loss: 0.0606990
	speed: 0.0358s/iter; left time: 1454.5709s
	iters: 400, epoch: 2 | loss: 0.1822946
	speed: 0.0360s/iter; left time: 1459.4248s
Epoch: 2 cost time: 15.326027393341064
Epoch: 2, Steps: 413 | Train Loss: 0.134 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.952249 --> -0.972714).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1847712
	speed: 0.1141s/iter; left time: 4605.5010s
	iters: 200, epoch: 3 | loss: 0.0187881
	speed: 0.0359s/iter; left time: 1446.0859s
	iters: 300, epoch: 3 | loss: 0.0153215
	speed: 0.0338s/iter; left time: 1359.6791s
	iters: 400, epoch: 3 | loss: 0.0469260
	speed: 0.0344s/iter; left time: 1378.7463s
Epoch: 3 cost time: 14.889760732650757
Epoch: 3, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1306366
	speed: 0.1098s/iter; left time: 4386.7868s
	iters: 200, epoch: 4 | loss: 0.0115497
	speed: 0.0364s/iter; left time: 1452.8326s
	iters: 300, epoch: 4 | loss: 0.1070486
	speed: 0.0354s/iter; left time: 1408.2937s
	iters: 400, epoch: 4 | loss: 0.2065507
	speed: 0.0367s/iter; left time: 1455.6004s
Epoch: 4 cost time: 15.231940746307373
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.067 Vali Acc: 0.975 Test Loss: 0.067 Test Acc: 0.975
Validation loss decreased (-0.972714 --> -0.975443).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0311159
	speed: 0.1120s/iter; left time: 4429.2960s
	iters: 200, epoch: 5 | loss: 0.0292848
	speed: 0.0362s/iter; left time: 1426.5674s
	iters: 300, epoch: 5 | loss: 0.0040884
	speed: 0.0372s/iter; left time: 1463.9979s
	iters: 400, epoch: 5 | loss: 0.0046986
	speed: 0.0362s/iter; left time: 1422.7621s
Epoch: 5 cost time: 15.284627914428711
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.975443 --> -0.976807).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0053641
	speed: 0.1173s/iter; left time: 4589.2652s
	iters: 200, epoch: 6 | loss: 0.0394789
	speed: 0.0364s/iter; left time: 1419.4841s
	iters: 300, epoch: 6 | loss: 0.0109625
	speed: 0.0351s/iter; left time: 1365.6518s
	iters: 400, epoch: 6 | loss: 0.0019178
	speed: 0.0359s/iter; left time: 1392.4858s
Epoch: 6 cost time: 15.13703465461731
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.064 Vali Acc: 0.978 Test Loss: 0.064 Test Acc: 0.978
Validation loss decreased (-0.976807 --> -0.977717).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0048569
	speed: 0.1082s/iter; left time: 4189.0448s
	iters: 200, epoch: 7 | loss: 0.0004839
	speed: 0.0329s/iter; left time: 1271.5584s
	iters: 300, epoch: 7 | loss: 0.0152241
	speed: 0.0335s/iter; left time: 1291.1312s
	iters: 400, epoch: 7 | loss: 0.0016151
	speed: 0.0341s/iter; left time: 1311.1044s
Epoch: 7 cost time: 14.213838815689087
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0294750
	speed: 0.1108s/iter; left time: 4246.4770s
	iters: 200, epoch: 8 | loss: 0.0094652
	speed: 0.0341s/iter; left time: 1303.7932s
	iters: 300, epoch: 8 | loss: 0.0100361
	speed: 0.0339s/iter; left time: 1291.2494s
	iters: 400, epoch: 8 | loss: 0.0134823
	speed: 0.0363s/iter; left time: 1378.9801s
Epoch: 8 cost time: 14.762634038925171
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0002163
	speed: 0.1106s/iter; left time: 4190.7937s
	iters: 200, epoch: 9 | loss: 0.0008740
	speed: 0.0358s/iter; left time: 1353.9056s
	iters: 300, epoch: 9 | loss: 0.0002866
	speed: 0.0359s/iter; left time: 1352.7063s
	iters: 400, epoch: 9 | loss: 0.0144212
	speed: 0.0368s/iter; left time: 1383.0657s
Epoch: 9 cost time: 15.203768491744995
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
Validation loss decreased (-0.977717 --> -0.978626).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1057018
	speed: 0.1241s/iter; left time: 4652.5186s
	iters: 200, epoch: 10 | loss: 0.0046410
	speed: 0.0356s/iter; left time: 1331.2439s
	iters: 300, epoch: 10 | loss: 0.0011391
	speed: 0.0379s/iter; left time: 1414.1141s
	iters: 400, epoch: 10 | loss: 0.0033347
	speed: 0.0374s/iter; left time: 1392.3332s
Epoch: 10 cost time: 15.653501510620117
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0001649
	speed: 0.1189s/iter; left time: 4406.6115s
	iters: 200, epoch: 11 | loss: 0.0416512
	speed: 0.0352s/iter; left time: 1301.8211s
	iters: 300, epoch: 11 | loss: 0.0012106
	speed: 0.0367s/iter; left time: 1354.2261s
	iters: 400, epoch: 11 | loss: 0.0006512
	speed: 0.0351s/iter; left time: 1289.6008s
Epoch: 11 cost time: 15.05930495262146
Epoch: 11, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0005482
	speed: 0.1161s/iter; left time: 4257.1273s
	iters: 200, epoch: 12 | loss: 0.0001281
	speed: 0.0360s/iter; left time: 1317.1931s
	iters: 300, epoch: 12 | loss: 0.0008190
	speed: 0.0364s/iter; left time: 1327.9853s
	iters: 400, epoch: 12 | loss: 0.0002795
	speed: 0.0357s/iter; left time: 1297.1774s
Epoch: 12 cost time: 15.416385650634766
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0001144
	speed: 0.1136s/iter; left time: 4115.6954s
	iters: 200, epoch: 13 | loss: 0.3714689
	speed: 0.0356s/iter; left time: 1287.3232s
	iters: 300, epoch: 13 | loss: 0.0037313
	speed: 0.0370s/iter; left time: 1334.3212s
	iters: 400, epoch: 13 | loss: 0.0013057
	speed: 0.0374s/iter; left time: 1345.7585s
Epoch: 13 cost time: 15.43142056465149
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
Validation loss decreased (-0.978626 --> -0.982264).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0004816
	speed: 0.1237s/iter; left time: 4433.3749s
	iters: 200, epoch: 14 | loss: 0.0000577
	speed: 0.0355s/iter; left time: 1269.6763s
	iters: 300, epoch: 14 | loss: 0.0470391
	speed: 0.0373s/iter; left time: 1330.6740s
	iters: 400, epoch: 14 | loss: 0.0000211
	speed: 0.0375s/iter; left time: 1332.3803s
Epoch: 14 cost time: 15.75708556175232
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000006
	speed: 0.1172s/iter; left time: 4151.6424s
	iters: 200, epoch: 15 | loss: 0.0000292
	speed: 0.0364s/iter; left time: 1284.6236s
	iters: 300, epoch: 15 | loss: 0.0000185
	speed: 0.0342s/iter; left time: 1204.7240s
	iters: 400, epoch: 15 | loss: 0.0000046
	speed: 0.0358s/iter; left time: 1256.0884s
Epoch: 15 cost time: 15.015226125717163
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1016507
	speed: 0.1144s/iter; left time: 4005.1610s
	iters: 200, epoch: 16 | loss: 0.0025200
	speed: 0.0335s/iter; left time: 1167.8384s
	iters: 300, epoch: 16 | loss: 0.0000342
	speed: 0.0344s/iter; left time: 1198.6661s
	iters: 400, epoch: 16 | loss: 0.0003806
	speed: 0.0335s/iter; left time: 1162.0601s
Epoch: 16 cost time: 14.558972835540771
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0003972
	speed: 0.1150s/iter; left time: 3979.2782s
	iters: 200, epoch: 17 | loss: 0.0000838
	speed: 0.0352s/iter; left time: 1215.3959s
	iters: 300, epoch: 17 | loss: 0.0001819
	speed: 0.0373s/iter; left time: 1282.5215s
	iters: 400, epoch: 17 | loss: 0.1220713
	speed: 0.0349s/iter; left time: 1196.2082s
Epoch: 17 cost time: 15.091899871826172
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0001076
	speed: 0.1168s/iter; left time: 3991.6110s
	iters: 200, epoch: 18 | loss: 0.0003636
	speed: 0.0358s/iter; left time: 1218.5376s
	iters: 300, epoch: 18 | loss: 0.0016189
	speed: 0.0368s/iter; left time: 1249.6621s
	iters: 400, epoch: 18 | loss: 0.0024385
	speed: 0.0354s/iter; left time: 1201.0352s
Epoch: 18 cost time: 15.466952085494995
Epoch: 18, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
Validation loss decreased (-0.982264 --> -0.984538).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000085
	speed: 0.1139s/iter; left time: 3847.6307s
	iters: 200, epoch: 19 | loss: 0.0000620
	speed: 0.0362s/iter; left time: 1218.9072s
	iters: 300, epoch: 19 | loss: 0.0003678
	speed: 0.0354s/iter; left time: 1186.9326s
	iters: 400, epoch: 19 | loss: 0.0000326
	speed: 0.0329s/iter; left time: 1102.2733s
Epoch: 19 cost time: 14.866713285446167
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000054
	speed: 0.1068s/iter; left time: 3563.3375s
	iters: 200, epoch: 20 | loss: 0.0117833
	speed: 0.0340s/iter; left time: 1131.8540s
	iters: 300, epoch: 20 | loss: 0.0000199
	speed: 0.0361s/iter; left time: 1196.9703s
	iters: 400, epoch: 20 | loss: 0.0005220
	speed: 0.0355s/iter; left time: 1174.3874s
Epoch: 20 cost time: 14.728981733322144
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0092497
	speed: 0.1082s/iter; left time: 3564.5136s
	iters: 200, epoch: 21 | loss: 0.0001214
	speed: 0.0346s/iter; left time: 1136.9709s
	iters: 300, epoch: 21 | loss: 0.0000030
	speed: 0.0343s/iter; left time: 1124.4343s
	iters: 400, epoch: 21 | loss: 0.0000251
	speed: 0.0344s/iter; left time: 1123.8209s
Epoch: 21 cost time: 14.524856090545654
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0014462
	speed: 0.1133s/iter; left time: 3684.7625s
	iters: 200, epoch: 22 | loss: 0.0000487
	speed: 0.0370s/iter; left time: 1201.0402s
	iters: 300, epoch: 22 | loss: 0.0000010
	speed: 0.0359s/iter; left time: 1161.5084s
	iters: 400, epoch: 22 | loss: 0.0000004
	speed: 0.0378s/iter; left time: 1219.3113s
Epoch: 22 cost time: 15.592963933944702
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0005616
	speed: 0.1230s/iter; left time: 3951.0004s
	iters: 200, epoch: 23 | loss: 0.0000116
	speed: 0.0369s/iter; left time: 1179.8143s
	iters: 300, epoch: 23 | loss: 0.0000106
	speed: 0.0371s/iter; left time: 1182.9256s
	iters: 400, epoch: 23 | loss: 0.0015532
	speed: 0.0354s/iter; left time: 1126.9436s
Epoch: 23 cost time: 15.657017707824707
Epoch: 23, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
Validation loss decreased (-0.984538 --> -0.984992).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0002217
	speed: 0.1138s/iter; left time: 3607.9351s
	iters: 200, epoch: 24 | loss: 0.0000134
	speed: 0.0346s/iter; left time: 1092.6449s
	iters: 300, epoch: 24 | loss: 0.0004657
	speed: 0.0356s/iter; left time: 1121.2414s
	iters: 400, epoch: 24 | loss: 0.0000243
	speed: 0.0359s/iter; left time: 1126.2776s
Epoch: 24 cost time: 14.901453256607056
Epoch: 24, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0001069
	speed: 0.1142s/iter; left time: 3574.5059s
	iters: 200, epoch: 25 | loss: 0.0002994
	speed: 0.0342s/iter; left time: 1067.1237s
	iters: 300, epoch: 25 | loss: 0.0000053
	speed: 0.0355s/iter; left time: 1102.3689s
	iters: 400, epoch: 25 | loss: 0.0000048
	speed: 0.0344s/iter; left time: 1065.0890s
Epoch: 25 cost time: 14.769782066345215
Epoch: 25, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000657
	speed: 0.1116s/iter; left time: 3446.6305s
	iters: 200, epoch: 26 | loss: 0.0000164
	speed: 0.0360s/iter; left time: 1107.8045s
	iters: 300, epoch: 26 | loss: 0.0008372
	speed: 0.0363s/iter; left time: 1113.7144s
	iters: 400, epoch: 26 | loss: 0.0000018
	speed: 0.0364s/iter; left time: 1113.7163s
Epoch: 26 cost time: 15.226670980453491
Epoch: 26, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0207795
	speed: 0.1195s/iter; left time: 3639.2763s
	iters: 200, epoch: 27 | loss: 0.0000194
	speed: 0.0366s/iter; left time: 1111.4482s
	iters: 300, epoch: 27 | loss: 0.0000019
	speed: 0.0371s/iter; left time: 1122.5078s
	iters: 400, epoch: 27 | loss: 0.0058260
	speed: 0.0370s/iter; left time: 1115.7079s
Epoch: 27 cost time: 15.685102224349976
Epoch: 27, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000061
	speed: 0.1212s/iter; left time: 3642.7086s
	iters: 200, epoch: 28 | loss: 0.0000115
	speed: 0.0375s/iter; left time: 1124.4599s
	iters: 300, epoch: 28 | loss: 0.0000020
	speed: 0.0376s/iter; left time: 1123.6589s
	iters: 400, epoch: 28 | loss: 0.0000050
	speed: 0.0372s/iter; left time: 1107.8320s
Epoch: 28 cost time: 15.999795198440552
Epoch: 28, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000016
	speed: 0.1174s/iter; left time: 3478.8271s
	iters: 200, epoch: 29 | loss: 0.0000015
	speed: 0.0352s/iter; left time: 1040.0734s
	iters: 300, epoch: 29 | loss: 0.0007155
	speed: 0.0346s/iter; left time: 1018.6034s
	iters: 400, epoch: 29 | loss: 0.0000664
	speed: 0.0374s/iter; left time: 1097.4899s
Epoch: 29 cost time: 15.110920190811157
Epoch: 29, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0023742
	speed: 0.1146s/iter; left time: 3348.8823s
	iters: 200, epoch: 30 | loss: 0.0000122
	speed: 0.0357s/iter; left time: 1039.9559s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 1082.6371s
	iters: 400, epoch: 30 | loss: 0.0002024
	speed: 0.0362s/iter; left time: 1047.8793s
Epoch: 30 cost time: 15.405447006225586
Epoch: 30, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000006
	speed: 0.1187s/iter; left time: 3418.7264s
	iters: 200, epoch: 31 | loss: 0.0026457
	speed: 0.0372s/iter; left time: 1068.8683s
	iters: 300, epoch: 31 | loss: 0.0037784
	speed: 0.0361s/iter; left time: 1032.9483s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0372s/iter; left time: 1060.7002s
Epoch: 31 cost time: 15.69284963607788
Epoch: 31, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000029
	speed: 0.1193s/iter; left time: 3386.5091s
	iters: 200, epoch: 32 | loss: 0.0000004
	speed: 0.0355s/iter; left time: 1005.3583s
	iters: 300, epoch: 32 | loss: 0.0005260
	speed: 0.0346s/iter; left time: 975.9419s
	iters: 400, epoch: 32 | loss: 0.0000034
	speed: 0.0353s/iter; left time: 992.9550s
Epoch: 32 cost time: 15.04746675491333
Epoch: 32, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.981 Test Loss: 0.119 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000099
	speed: 0.1148s/iter; left time: 3212.3625s
	iters: 200, epoch: 33 | loss: 0.0000056
	speed: 0.0358s/iter; left time: 999.3694s
	iters: 300, epoch: 33 | loss: 0.0001791
	speed: 0.0356s/iter; left time: 990.2573s
	iters: 400, epoch: 33 | loss: 0.1298332
	speed: 0.0347s/iter; left time: 960.3772s
Epoch: 33 cost time: 15.000704765319824
Epoch: 33, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 45746
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2690865
	speed: 0.0595s/iter; left time: 2449.9512s
	iters: 200, epoch: 1 | loss: 0.7479664
	speed: 0.0367s/iter; left time: 1508.7590s
	iters: 300, epoch: 1 | loss: 0.4621126
	speed: 0.0374s/iter; left time: 1531.6086s
	iters: 400, epoch: 1 | loss: 0.1067643
	speed: 0.0388s/iter; left time: 1587.3898s
Epoch: 1 cost time: 17.863855361938477
Epoch: 1, Steps: 413 | Train Loss: 0.886 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (inf --> -0.944064).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1853217
	speed: 0.1239s/iter; left time: 5055.5620s
	iters: 200, epoch: 2 | loss: 0.2582051
	speed: 0.0364s/iter; left time: 1479.0291s
	iters: 300, epoch: 2 | loss: 0.1003590
	speed: 0.0349s/iter; left time: 1418.3039s
	iters: 400, epoch: 2 | loss: 0.2557843
	speed: 0.0368s/iter; left time: 1490.1093s
Epoch: 2 cost time: 15.474721431732178
Epoch: 2, Steps: 413 | Train Loss: 0.157 Vali Loss: 0.104 Vali Acc: 0.963 Test Loss: 0.104 Test Acc: 0.963
Validation loss decreased (-0.944064 --> -0.963164).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1834446
	speed: 0.1169s/iter; left time: 4718.4139s
	iters: 200, epoch: 3 | loss: 0.0282070
	speed: 0.0350s/iter; left time: 1408.5028s
	iters: 300, epoch: 3 | loss: 0.0552888
	speed: 0.0341s/iter; left time: 1371.8787s
	iters: 400, epoch: 3 | loss: 0.0122948
	speed: 0.0350s/iter; left time: 1404.1809s
Epoch: 3 cost time: 14.999305248260498
Epoch: 3, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.097 Vali Acc: 0.967 Test Loss: 0.097 Test Acc: 0.967
Validation loss decreased (-0.963164 --> -0.967257).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0895060
	speed: 0.1126s/iter; left time: 4498.6616s
	iters: 200, epoch: 4 | loss: 0.0078162
	speed: 0.0338s/iter; left time: 1348.7724s
	iters: 300, epoch: 4 | loss: 0.0281429
	speed: 0.0344s/iter; left time: 1366.1467s
	iters: 400, epoch: 4 | loss: 0.3049400
	speed: 0.0356s/iter; left time: 1413.4052s
Epoch: 4 cost time: 14.860816955566406
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.967257 --> -0.973169).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0117435
	speed: 0.1184s/iter; left time: 4680.6560s
	iters: 200, epoch: 5 | loss: 0.0072600
	speed: 0.0380s/iter; left time: 1500.1489s
	iters: 300, epoch: 5 | loss: 0.0040973
	speed: 0.0370s/iter; left time: 1454.6886s
	iters: 400, epoch: 5 | loss: 0.0097108
	speed: 0.0366s/iter; left time: 1434.5760s
Epoch: 5 cost time: 15.674855470657349
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.973169 --> -0.977262).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0026121
	speed: 0.1200s/iter; left time: 4698.1354s
	iters: 200, epoch: 6 | loss: 0.0066516
	speed: 0.0360s/iter; left time: 1404.1764s
	iters: 300, epoch: 6 | loss: 0.0090454
	speed: 0.0351s/iter; left time: 1366.5466s
	iters: 400, epoch: 6 | loss: 0.0142117
	speed: 0.0349s/iter; left time: 1354.8412s
Epoch: 6 cost time: 15.078462600708008
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.050 Vali Acc: 0.982 Test Loss: 0.050 Test Acc: 0.982
Validation loss decreased (-0.977262 --> -0.981809).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0105277
	speed: 0.1161s/iter; left time: 4496.4100s
	iters: 200, epoch: 7 | loss: 0.0085310
	speed: 0.0367s/iter; left time: 1417.2926s
	iters: 300, epoch: 7 | loss: 0.0010226
	speed: 0.0373s/iter; left time: 1435.5896s
	iters: 400, epoch: 7 | loss: 0.0239109
	speed: 0.0370s/iter; left time: 1421.8510s
Epoch: 7 cost time: 15.734729051589966
Epoch: 7, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.068 Vali Acc: 0.976 Test Loss: 0.068 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1412273
	speed: 0.1115s/iter; left time: 4273.0853s
	iters: 200, epoch: 8 | loss: 0.0182899
	speed: 0.0359s/iter; left time: 1372.2468s
	iters: 300, epoch: 8 | loss: 0.0011175
	speed: 0.0386s/iter; left time: 1470.2954s
	iters: 400, epoch: 8 | loss: 0.0102027
	speed: 0.0381s/iter; left time: 1449.1075s
Epoch: 8 cost time: 15.59850788116455
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.981809 --> -0.982719).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0001973
	speed: 0.1258s/iter; left time: 4765.8169s
	iters: 200, epoch: 9 | loss: 0.0037029
	speed: 0.0396s/iter; left time: 1495.7683s
	iters: 300, epoch: 9 | loss: 0.0022705
	speed: 0.0386s/iter; left time: 1454.8319s
	iters: 400, epoch: 9 | loss: 0.0006156
	speed: 0.0379s/iter; left time: 1425.3218s
Epoch: 9 cost time: 16.386631727218628
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0217178
	speed: 0.1196s/iter; left time: 4484.1282s
	iters: 200, epoch: 10 | loss: 0.0002161
	speed: 0.0358s/iter; left time: 1339.2875s
	iters: 300, epoch: 10 | loss: 0.0002538
	speed: 0.0373s/iter; left time: 1391.6412s
	iters: 400, epoch: 10 | loss: 0.0018122
	speed: 0.0362s/iter; left time: 1347.0988s
Epoch: 10 cost time: 15.464882612228394
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0002937
	speed: 0.1121s/iter; left time: 4156.0210s
	iters: 200, epoch: 11 | loss: 0.0010550
	speed: 0.0376s/iter; left time: 1389.5500s
	iters: 300, epoch: 11 | loss: 0.0003340
	speed: 0.0356s/iter; left time: 1311.0683s
	iters: 400, epoch: 11 | loss: 0.0008787
	speed: 0.0356s/iter; left time: 1309.2002s
Epoch: 11 cost time: 15.391778707504272
Epoch: 11, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000155
	speed: 0.1171s/iter; left time: 4293.1240s
	iters: 200, epoch: 12 | loss: 0.0001064
	speed: 0.0351s/iter; left time: 1283.7605s
	iters: 300, epoch: 12 | loss: 0.0231259
	speed: 0.0349s/iter; left time: 1272.2553s
	iters: 400, epoch: 12 | loss: 0.0007909
	speed: 0.0369s/iter; left time: 1340.9778s
Epoch: 12 cost time: 15.391582012176514
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0010725
	speed: 0.1220s/iter; left time: 4421.4706s
	iters: 200, epoch: 13 | loss: 0.0140550
	speed: 0.0366s/iter; left time: 1323.6124s
	iters: 300, epoch: 13 | loss: 0.0056495
	speed: 0.0368s/iter; left time: 1326.3726s
	iters: 400, epoch: 13 | loss: 0.0000227
	speed: 0.0382s/iter; left time: 1371.3282s
Epoch: 13 cost time: 15.794325113296509
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0005201
	speed: 0.1252s/iter; left time: 4486.2570s
	iters: 200, epoch: 14 | loss: 0.0003567
	speed: 0.0364s/iter; left time: 1299.1371s
	iters: 300, epoch: 14 | loss: 0.0536829
	speed: 0.0358s/iter; left time: 1275.9171s
	iters: 400, epoch: 14 | loss: 0.0000162
	speed: 0.0352s/iter; left time: 1251.7570s
Epoch: 14 cost time: 15.674093246459961
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000023
	speed: 0.1158s/iter; left time: 4101.4475s
	iters: 200, epoch: 15 | loss: 0.0008970
	speed: 0.0386s/iter; left time: 1364.5997s
	iters: 300, epoch: 15 | loss: 0.0002492
	speed: 0.0359s/iter; left time: 1263.0182s
	iters: 400, epoch: 15 | loss: 0.0005101
	speed: 0.0367s/iter; left time: 1289.3160s
Epoch: 15 cost time: 15.835313320159912
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.058 Vali Acc: 0.982 Test Loss: 0.058 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0400889
	speed: 0.1152s/iter; left time: 4031.2462s
	iters: 200, epoch: 16 | loss: 0.0038076
	speed: 0.0352s/iter; left time: 1229.5699s
	iters: 300, epoch: 16 | loss: 0.0000296
	speed: 0.0363s/iter; left time: 1265.0255s
	iters: 400, epoch: 16 | loss: 0.0001979
	speed: 0.0401s/iter; left time: 1390.9882s
Epoch: 16 cost time: 15.739537715911865
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0088265
	speed: 0.1213s/iter; left time: 4194.8038s
	iters: 200, epoch: 17 | loss: 0.0005565
	speed: 0.0370s/iter; left time: 1277.8308s
	iters: 300, epoch: 17 | loss: 0.0000058
	speed: 0.0373s/iter; left time: 1281.5016s
	iters: 400, epoch: 17 | loss: 0.1828828
	speed: 0.0368s/iter; left time: 1260.4394s
Epoch: 17 cost time: 15.790351629257202
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000810
	speed: 0.1189s/iter; left time: 4062.4909s
	iters: 200, epoch: 18 | loss: 0.0003811
	speed: 0.0355s/iter; left time: 1209.2255s
	iters: 300, epoch: 18 | loss: 0.0043158
	speed: 0.0354s/iter; left time: 1203.9833s
	iters: 400, epoch: 18 | loss: 0.0009641
	speed: 0.0354s/iter; left time: 1198.3093s
Epoch: 18 cost time: 15.377043962478638
Epoch: 18, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
Validation loss decreased (-0.982719 --> -0.984083).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0001483
	speed: 0.1109s/iter; left time: 3745.8875s
	iters: 200, epoch: 19 | loss: 0.0001622
	speed: 0.0369s/iter; left time: 1241.7276s
	iters: 300, epoch: 19 | loss: 0.0003749
	speed: 0.0363s/iter; left time: 1217.0114s
	iters: 400, epoch: 19 | loss: 0.0000015
	speed: 0.0358s/iter; left time: 1198.7317s
Epoch: 19 cost time: 15.4710693359375
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000157
	speed: 0.1170s/iter; left time: 3903.5326s
	iters: 200, epoch: 20 | loss: 0.0000325
	speed: 0.0363s/iter; left time: 1205.9887s
	iters: 300, epoch: 20 | loss: 0.0000080
	speed: 0.0358s/iter; left time: 1187.6064s
	iters: 400, epoch: 20 | loss: 0.0000129
	speed: 0.0392s/iter; left time: 1297.3624s
Epoch: 20 cost time: 15.691721677780151
Epoch: 20, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000813
	speed: 0.1227s/iter; left time: 4041.4507s
	iters: 200, epoch: 21 | loss: 0.0001297
	speed: 0.0376s/iter; left time: 1234.0178s
	iters: 300, epoch: 21 | loss: 0.0022805
	speed: 0.0395s/iter; left time: 1293.4970s
	iters: 400, epoch: 21 | loss: 0.0005970
	speed: 0.0384s/iter; left time: 1252.0761s
Epoch: 21 cost time: 16.31687879562378
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0152578
	speed: 0.1202s/iter; left time: 3910.5005s
	iters: 200, epoch: 22 | loss: 0.0008670
	speed: 0.0369s/iter; left time: 1197.7440s
	iters: 300, epoch: 22 | loss: 0.0000052
	speed: 0.0361s/iter; left time: 1166.5502s
	iters: 400, epoch: 22 | loss: 0.0000083
	speed: 0.0368s/iter; left time: 1186.2265s
Epoch: 22 cost time: 15.496139287948608
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0014842
	speed: 0.1157s/iter; left time: 3716.7522s
	iters: 200, epoch: 23 | loss: 0.0004252
	speed: 0.0371s/iter; left time: 1187.1076s
	iters: 300, epoch: 23 | loss: 0.0093247
	speed: 0.0357s/iter; left time: 1140.4095s
	iters: 400, epoch: 23 | loss: 0.0000769
	speed: 0.0347s/iter; left time: 1104.5619s
Epoch: 23 cost time: 15.215283632278442
Epoch: 23, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0051033
	speed: 0.1171s/iter; left time: 3713.5755s
	iters: 200, epoch: 24 | loss: 0.0002445
	speed: 0.0361s/iter; left time: 1140.0914s
	iters: 300, epoch: 24 | loss: 0.0000002
	speed: 0.0363s/iter; left time: 1142.3115s
	iters: 400, epoch: 24 | loss: 0.0002138
	speed: 0.0370s/iter; left time: 1161.1070s
Epoch: 24 cost time: 15.384625911712646
Epoch: 24, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.068 Vali Acc: 0.982 Test Loss: 0.068 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0009688
	speed: 0.1192s/iter; left time: 3731.1709s
	iters: 200, epoch: 25 | loss: 0.0000135
	speed: 0.0364s/iter; left time: 1135.9956s
	iters: 300, epoch: 25 | loss: 0.0014453
	speed: 0.0380s/iter; left time: 1182.8931s
	iters: 400, epoch: 25 | loss: 0.0000016
	speed: 0.0407s/iter; left time: 1260.2684s
Epoch: 25 cost time: 16.156563997268677
Epoch: 25, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000218
	speed: 0.1198s/iter; left time: 3697.8628s
	iters: 200, epoch: 26 | loss: 0.0000048
	speed: 0.0358s/iter; left time: 1102.7449s
	iters: 300, epoch: 26 | loss: 0.0000356
	speed: 0.0350s/iter; left time: 1073.1054s
	iters: 400, epoch: 26 | loss: 0.0000168
	speed: 0.0362s/iter; left time: 1105.8595s
Epoch: 26 cost time: 15.342903137207031
Epoch: 26, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0001724
	speed: 0.1142s/iter; left time: 3478.2105s
	iters: 200, epoch: 27 | loss: 0.0000045
	speed: 0.0344s/iter; left time: 1045.3869s
	iters: 300, epoch: 27 | loss: 0.0000118
	speed: 0.0366s/iter; left time: 1107.8299s
	iters: 400, epoch: 27 | loss: 0.0001080
	speed: 0.0346s/iter; left time: 1042.3376s
Epoch: 27 cost time: 15.067525863647461
Epoch: 27, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000066
	speed: 0.1149s/iter; left time: 3452.2513s
	iters: 200, epoch: 28 | loss: 0.0000387
	speed: 0.0365s/iter; left time: 1093.5850s
	iters: 300, epoch: 28 | loss: 0.0000057
	speed: 0.0376s/iter; left time: 1122.3131s
	iters: 400, epoch: 28 | loss: 0.0000197
	speed: 0.0384s/iter; left time: 1142.6465s
Epoch: 28 cost time: 15.67743968963623
Epoch: 28, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 45746
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0871744
	speed: 0.0518s/iter; left time: 2134.0035s
	iters: 200, epoch: 1 | loss: 0.0031567
	speed: 0.0311s/iter; left time: 1276.8547s
	iters: 300, epoch: 1 | loss: 0.2045731
	speed: 0.0293s/iter; left time: 1202.2887s
	iters: 400, epoch: 1 | loss: 0.9634281
	speed: 0.0305s/iter; left time: 1246.1862s
Epoch: 1 cost time: 14.743115663528442
Epoch: 1, Steps: 413 | Train Loss: 0.287 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0194383
	speed: 0.0991s/iter; left time: 4040.8642s
	iters: 200, epoch: 2 | loss: 0.0006238
	speed: 0.0285s/iter; left time: 1161.4886s
	iters: 300, epoch: 2 | loss: 0.0309914
	speed: 0.0286s/iter; left time: 1160.9604s
	iters: 400, epoch: 2 | loss: 0.0015350
	speed: 0.0296s/iter; left time: 1198.7166s
Epoch: 2 cost time: 12.349711656570435
Epoch: 2, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
Validation loss decreased (-0.957252 --> -0.965437).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0537264
	speed: 0.1175s/iter; left time: 4743.7486s
	iters: 200, epoch: 3 | loss: 0.0070941
	speed: 0.0304s/iter; left time: 1224.0951s
	iters: 300, epoch: 3 | loss: 0.6554369
	speed: 0.0301s/iter; left time: 1208.1833s
	iters: 400, epoch: 3 | loss: 0.0000000
	speed: 0.0295s/iter; left time: 1181.9061s
Epoch: 3 cost time: 12.750137090682983
Epoch: 3, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.965437 --> -0.975442).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0011745
	speed: 0.1089s/iter; left time: 4350.1044s
	iters: 200, epoch: 4 | loss: 0.0000001
	speed: 0.0287s/iter; left time: 1142.6239s
	iters: 300, epoch: 4 | loss: 0.0243392
	speed: 0.0306s/iter; left time: 1215.2801s
	iters: 400, epoch: 4 | loss: 0.0000096
	speed: 0.0310s/iter; left time: 1230.4416s
Epoch: 4 cost time: 12.813575267791748
Epoch: 4, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000001
	speed: 0.1202s/iter; left time: 4752.6341s
	iters: 200, epoch: 5 | loss: 0.2747303
	speed: 0.0305s/iter; left time: 1201.7880s
	iters: 300, epoch: 5 | loss: 0.0000026
	speed: 0.0295s/iter; left time: 1160.3101s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 1194.9950s
Epoch: 5 cost time: 12.914796829223633
Epoch: 5, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.375 Vali Acc: 0.964 Test Loss: 0.375 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0666335
	speed: 0.1174s/iter; left time: 4595.1266s
	iters: 200, epoch: 6 | loss: 1.1485630
	speed: 0.0303s/iter; left time: 1182.0313s
	iters: 300, epoch: 6 | loss: 0.8916597
	speed: 0.0284s/iter; left time: 1104.0491s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 1185.3733s
Epoch: 6 cost time: 12.747901678085327
Epoch: 6, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.400 Vali Acc: 0.968 Test Loss: 0.400 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2920845
	speed: 0.1073s/iter; left time: 4155.8358s
	iters: 200, epoch: 7 | loss: 0.0000152
	speed: 0.0296s/iter; left time: 1142.2898s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 1140.3678s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 1124.5574s
Epoch: 7 cost time: 12.579103231430054
Epoch: 7, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.298 Vali Acc: 0.976 Test Loss: 0.298 Test Acc: 0.976
Validation loss decreased (-0.975442 --> -0.976350).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0168962
	speed: 0.1125s/iter; left time: 4308.6642s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 1171.9332s
	iters: 300, epoch: 8 | loss: 2.0155282
	speed: 0.0308s/iter; left time: 1173.2737s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 1147.0797s
Epoch: 8 cost time: 13.086119651794434
Epoch: 8, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.452 Vali Acc: 0.970 Test Loss: 0.452 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0062871
	speed: 0.1030s/iter; left time: 3905.2711s
	iters: 200, epoch: 9 | loss: 0.2716055
	speed: 0.0288s/iter; left time: 1088.5754s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 1227.9279s
	iters: 400, epoch: 9 | loss: 0.0000242
	speed: 0.0316s/iter; left time: 1189.5452s
Epoch: 9 cost time: 13.147878408432007
Epoch: 9, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.338 Vali Acc: 0.972 Test Loss: 0.338 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0077953
	speed: 0.1208s/iter; left time: 4528.4080s
	iters: 200, epoch: 10 | loss: 0.3201196
	speed: 0.0291s/iter; left time: 1087.6814s
	iters: 300, epoch: 10 | loss: 0.0000058
	speed: 0.0318s/iter; left time: 1184.9768s
	iters: 400, epoch: 10 | loss: 0.0039169
	speed: 0.0317s/iter; left time: 1177.4892s
Epoch: 10 cost time: 13.321943521499634
Epoch: 10, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.530 Vali Acc: 0.966 Test Loss: 0.530 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000014
	speed: 0.1207s/iter; left time: 4473.3095s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0324s/iter; left time: 1198.2018s
	iters: 300, epoch: 11 | loss: 0.0000007
	speed: 0.0299s/iter; left time: 1100.6364s
	iters: 400, epoch: 11 | loss: 0.0757326
	speed: 0.0302s/iter; left time: 1111.7759s
Epoch: 11 cost time: 13.406113147735596
Epoch: 11, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.366 Vali Acc: 0.977 Test Loss: 0.366 Test Acc: 0.977
Validation loss decreased (-0.976350 --> -0.977259).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1052s/iter; left time: 3858.1020s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0288s/iter; left time: 1052.4833s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 1045.8795s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 1038.4675s
Epoch: 12 cost time: 12.366748094558716
Epoch: 12, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.561 Vali Acc: 0.965 Test Loss: 0.561 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6965785
	speed: 0.1066s/iter; left time: 3862.2643s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 1048.3914s
	iters: 300, epoch: 13 | loss: 0.0000004
	speed: 0.0297s/iter; left time: 1070.0040s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 1047.5396s
Epoch: 13 cost time: 12.635900259017944
Epoch: 13, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.391 Vali Acc: 0.980 Test Loss: 0.391 Test Acc: 0.980
Validation loss decreased (-0.977259 --> -0.979987).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0504583
	speed: 0.1046s/iter; left time: 3748.5588s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 1025.3125s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 1131.7097s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 1091.2956s
Epoch: 14 cost time: 12.869847536087036
Epoch: 14, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.409 Vali Acc: 0.979 Test Loss: 0.409 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1191s/iter; left time: 4219.6061s
	iters: 200, epoch: 15 | loss: 0.0000004
	speed: 0.0302s/iter; left time: 1065.6775s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0299s/iter; left time: 1052.0653s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 1019.5418s
Epoch: 15 cost time: 13.020010232925415
Epoch: 15, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.341 Vali Acc: 0.981 Test Loss: 0.341 Test Acc: 0.981
Validation loss decreased (-0.979987 --> -0.981352).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1205s/iter; left time: 4217.4188s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 1071.5766s
	iters: 300, epoch: 16 | loss: 0.0000007
	speed: 0.0295s/iter; left time: 1027.8248s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0298s/iter; left time: 1033.5923s
Epoch: 16 cost time: 12.906720638275146
Epoch: 16, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.374 Vali Acc: 0.977 Test Loss: 0.374 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000027
	speed: 0.1057s/iter; left time: 3655.4398s
	iters: 200, epoch: 17 | loss: 0.0027204
	speed: 0.0299s/iter; left time: 1033.0639s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 1001.0235s
	iters: 400, epoch: 17 | loss: 0.1058342
	speed: 0.0297s/iter; left time: 1017.2335s
Epoch: 17 cost time: 12.71478796005249
Epoch: 17, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.738 Vali Acc: 0.968 Test Loss: 0.738 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1119s/iter; left time: 3826.3921s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0316s/iter; left time: 1076.7821s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 1097.1177s
	iters: 400, epoch: 18 | loss: 1.5276172
	speed: 0.0317s/iter; left time: 1075.2065s
Epoch: 18 cost time: 13.598058700561523
Epoch: 18, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.357 Vali Acc: 0.980 Test Loss: 0.357 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1040s/iter; left time: 3511.6766s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 1037.9134s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0312s/iter; left time: 1046.6090s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 1089.0976s
Epoch: 19 cost time: 13.384978532791138
Epoch: 19, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.306 Vali Acc: 0.982 Test Loss: 0.306 Test Acc: 0.982
Validation loss decreased (-0.981352 --> -0.981807).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1177s/iter; left time: 3924.6265s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0315s/iter; left time: 1048.5627s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 1071.7419s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0299s/iter; left time: 989.0739s
Epoch: 20 cost time: 13.50177788734436
Epoch: 20, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.986 Test Loss: 0.207 Test Acc: 0.986
Validation loss decreased (-0.981807 --> -0.985901).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1160s/iter; left time: 3819.6798s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 1009.4086s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0315s/iter; left time: 1029.7653s
	iters: 400, epoch: 21 | loss: 0.0000592
	speed: 0.0299s/iter; left time: 977.4146s
Epoch: 21 cost time: 13.218859672546387
Epoch: 21, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.543 Vali Acc: 0.970 Test Loss: 0.543 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 2.9461763
	speed: 0.0995s/iter; left time: 3236.9905s
	iters: 200, epoch: 22 | loss: 0.2657841
	speed: 0.0296s/iter; left time: 959.0265s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 955.5577s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0303s/iter; left time: 976.0984s
Epoch: 22 cost time: 12.645768642425537
Epoch: 22, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.476 Vali Acc: 0.978 Test Loss: 0.476 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0971s/iter; left time: 3119.4973s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 936.7412s
	iters: 300, epoch: 23 | loss: 0.0000099
	speed: 0.0286s/iter; left time: 913.7165s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 897.7347s
Epoch: 23 cost time: 12.20907998085022
Epoch: 23, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.379 Vali Acc: 0.980 Test Loss: 0.379 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1003s/iter; left time: 3180.1976s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 925.4698s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 905.1916s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 890.2095s
Epoch: 24 cost time: 12.340619087219238
Epoch: 24, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.937 Vali Acc: 0.968 Test Loss: 0.937 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000002
	speed: 0.1148s/iter; left time: 3592.6204s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 976.8015s
	iters: 300, epoch: 25 | loss: 0.0003523
	speed: 0.0297s/iter; left time: 923.7482s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0303s/iter; left time: 938.6885s
Epoch: 25 cost time: 13.10770034790039
Epoch: 25, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.593 Vali Acc: 0.976 Test Loss: 0.593 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1118s/iter; left time: 3451.8794s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0294s/iter; left time: 905.6811s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 842.5106s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 887.3605s
Epoch: 26 cost time: 12.3873450756073
Epoch: 26, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.466 Vali Acc: 0.979 Test Loss: 0.466 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1098s/iter; left time: 3344.5223s
	iters: 200, epoch: 27 | loss: 0.0114872
	speed: 0.0335s/iter; left time: 1018.1613s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 991.5867s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 981.7571s
Epoch: 27 cost time: 14.088297128677368
Epoch: 27, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.554 Vali Acc: 0.975 Test Loss: 0.554 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 2564.7090s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0229s/iter; left time: 684.6000s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0234s/iter; left time: 699.7649s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0224s/iter; left time: 667.6570s
Epoch: 28 cost time: 9.847103357315063
Epoch: 28, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.388 Vali Acc: 0.980 Test Loss: 0.388 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1032s/iter; left time: 3058.9596s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0297s/iter; left time: 878.1566s
	iters: 300, epoch: 29 | loss: 2.6578660
	speed: 0.0301s/iter; left time: 884.6154s
	iters: 400, epoch: 29 | loss: 0.0010491
	speed: 0.0309s/iter; left time: 905.6178s
Epoch: 29 cost time: 12.793922901153564
Epoch: 29, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.443 Vali Acc: 0.983 Test Loss: 0.443 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1039s/iter; left time: 3037.0938s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 896.3327s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0320s/iter; left time: 928.9281s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 895.5543s
Epoch: 30 cost time: 13.218886852264404
Epoch: 30, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.395 Vali Acc: 0.980 Test Loss: 0.395 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 3137102
model size : 21.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0748394
	speed: 0.0458s/iter; left time: 1888.9114s
	iters: 200, epoch: 1 | loss: 0.0046876
	speed: 0.0291s/iter; left time: 1195.3349s
	iters: 300, epoch: 1 | loss: 0.1457923
	speed: 0.0287s/iter; left time: 1178.2760s
	iters: 400, epoch: 1 | loss: 1.1369019
	speed: 0.0284s/iter; left time: 1162.9208s
Epoch: 1 cost time: 13.64790940284729
Epoch: 1, Steps: 413 | Train Loss: 0.288 Vali Loss: 0.121 Vali Acc: 0.960 Test Loss: 0.121 Test Acc: 0.960
Validation loss decreased (inf --> -0.960435).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0036090
	speed: 0.1057s/iter; left time: 4311.6475s
	iters: 200, epoch: 2 | loss: 0.2586684
	speed: 0.0292s/iter; left time: 1189.7222s
	iters: 300, epoch: 2 | loss: 0.2796290
	speed: 0.0291s/iter; left time: 1182.2259s
	iters: 400, epoch: 2 | loss: 0.0000265
	speed: 0.0286s/iter; left time: 1156.5232s
Epoch: 2 cost time: 12.282346963882446
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
Validation loss decreased (-0.960435 --> -0.969075).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0375106
	speed: 0.1075s/iter; left time: 4340.4354s
	iters: 200, epoch: 3 | loss: 0.0419677
	speed: 0.0280s/iter; left time: 1126.0463s
	iters: 300, epoch: 3 | loss: 0.3765425
	speed: 0.0295s/iter; left time: 1185.2081s
	iters: 400, epoch: 3 | loss: 0.0000014
	speed: 0.0280s/iter; left time: 1122.3632s
Epoch: 3 cost time: 12.164561986923218
Epoch: 3, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.189 Vali Acc: 0.965 Test Loss: 0.189 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0021041
	speed: 0.0980s/iter; left time: 3917.7998s
	iters: 200, epoch: 4 | loss: 0.0029252
	speed: 0.0280s/iter; left time: 1116.4067s
	iters: 300, epoch: 4 | loss: 0.0000016
	speed: 0.0290s/iter; left time: 1152.2396s
	iters: 400, epoch: 4 | loss: 0.0065769
	speed: 0.0287s/iter; left time: 1139.8223s
Epoch: 4 cost time: 12.094826936721802
Epoch: 4, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.969075 --> -0.974532).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0693499
	speed: 0.0995s/iter; left time: 3935.1815s
	iters: 200, epoch: 5 | loss: 0.0009132
	speed: 0.0277s/iter; left time: 1091.6475s
	iters: 300, epoch: 5 | loss: 0.0000002
	speed: 0.0282s/iter; left time: 1107.9338s
	iters: 400, epoch: 5 | loss: 0.0000703
	speed: 0.0285s/iter; left time: 1116.9831s
Epoch: 5 cost time: 11.974764347076416
Epoch: 5, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974532 --> -0.974987).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1269072
	speed: 0.1004s/iter; left time: 3928.4731s
	iters: 200, epoch: 6 | loss: 0.0000036
	speed: 0.0293s/iter; left time: 1144.5321s
	iters: 300, epoch: 6 | loss: 0.0000091
	speed: 0.0281s/iter; left time: 1093.9847s
	iters: 400, epoch: 6 | loss: 0.1193274
	speed: 0.0293s/iter; left time: 1137.4645s
Epoch: 6 cost time: 12.105453252792358
Epoch: 6, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0012494
	speed: 0.1185s/iter; left time: 4589.3490s
	iters: 200, epoch: 7 | loss: 0.0000005
	speed: 0.0282s/iter; left time: 1089.0204s
	iters: 300, epoch: 7 | loss: 0.0000003
	speed: 0.0293s/iter; left time: 1128.8354s
	iters: 400, epoch: 7 | loss: 0.0019233
	speed: 0.0295s/iter; left time: 1134.8457s
Epoch: 7 cost time: 12.486979722976685
Epoch: 7, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.283 Vali Acc: 0.971 Test Loss: 0.283 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1204034
	speed: 0.1108s/iter; left time: 4246.3040s
	iters: 200, epoch: 8 | loss: 0.0225318
	speed: 0.0301s/iter; left time: 1151.0478s
	iters: 300, epoch: 8 | loss: 0.0025389
	speed: 0.0266s/iter; left time: 1015.5801s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 1114.7799s
Epoch: 8 cost time: 12.46239972114563
Epoch: 8, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.498 Vali Acc: 0.964 Test Loss: 0.498 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0977649
	speed: 0.1048s/iter; left time: 3973.4481s
	iters: 200, epoch: 9 | loss: 1.0706455
	speed: 0.0291s/iter; left time: 1099.1870s
	iters: 300, epoch: 9 | loss: 0.0014894
	speed: 0.0292s/iter; left time: 1101.8386s
	iters: 400, epoch: 9 | loss: 0.0004016
	speed: 0.0295s/iter; left time: 1107.5421s
Epoch: 9 cost time: 12.387948751449585
Epoch: 9, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.300 Vali Acc: 0.972 Test Loss: 0.300 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.1983861
	speed: 0.1014s/iter; left time: 3799.8835s
	iters: 200, epoch: 10 | loss: 0.0207965
	speed: 0.0288s/iter; left time: 1075.6929s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 1062.4268s
	iters: 400, epoch: 10 | loss: 0.1750177
	speed: 0.0276s/iter; left time: 1024.9582s
Epoch: 10 cost time: 12.146380424499512
Epoch: 10, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.266 Vali Acc: 0.974 Test Loss: 0.266 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000012
	speed: 0.0958s/iter; left time: 3552.9096s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 1019.3582s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 1004.3142s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0294s/iter; left time: 1081.0054s
Epoch: 11 cost time: 12.02795696258545
Epoch: 11, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.255 Vali Acc: 0.977 Test Loss: 0.255 Test Acc: 0.977
Validation loss decreased (-0.974987 --> -0.976805).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1128s/iter; left time: 4133.8513s
	iters: 200, epoch: 12 | loss: 0.1080683
	speed: 0.0286s/iter; left time: 1044.6438s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 1042.2403s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 999.0480s
Epoch: 12 cost time: 12.339950323104858
Epoch: 12, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.736 Vali Acc: 0.963 Test Loss: 0.736 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.5161390
	speed: 0.1114s/iter; left time: 4039.3020s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 1031.1594s
	iters: 300, epoch: 13 | loss: 4.2575984
	speed: 0.0284s/iter; left time: 1022.1723s
	iters: 400, epoch: 13 | loss: 0.2416502
	speed: 0.0275s/iter; left time: 989.0390s
Epoch: 13 cost time: 12.134873628616333
Epoch: 13, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.415 Vali Acc: 0.973 Test Loss: 0.415 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3255005
	speed: 0.1025s/iter; left time: 3672.6243s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 973.6044s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 984.8336s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 976.4131s
Epoch: 14 cost time: 11.927137851715088
Epoch: 14, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.256 Vali Acc: 0.984 Test Loss: 0.256 Test Acc: 0.984
Validation loss decreased (-0.976805 --> -0.984081).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.0942s/iter; left time: 3335.0542s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 977.8165s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 970.1504s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 975.0805s
Epoch: 15 cost time: 11.866640329360962
Epoch: 15, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.339 Vali Acc: 0.980 Test Loss: 0.339 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0940s/iter; left time: 3289.8916s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 984.6969s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 950.2904s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 944.5731s
Epoch: 16 cost time: 11.785338640213013
Epoch: 16, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.468 Vali Acc: 0.975 Test Loss: 0.468 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1085s/iter; left time: 3752.6484s
	iters: 200, epoch: 17 | loss: 0.1431747
	speed: 0.0300s/iter; left time: 1036.4742s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 1043.9188s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 1034.7828s
Epoch: 17 cost time: 13.116015672683716
Epoch: 17, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.347 Vali Acc: 0.979 Test Loss: 0.347 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1028s/iter; left time: 3512.0569s
	iters: 200, epoch: 18 | loss: 0.0000042
	speed: 0.0296s/iter; left time: 1008.5143s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 1005.9780s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 1020.2849s
Epoch: 18 cost time: 12.795736074447632
Epoch: 18, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.327 Vali Acc: 0.975 Test Loss: 0.327 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0994s/iter; left time: 3357.1279s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 928.8706s
	iters: 300, epoch: 19 | loss: 0.0013097
	speed: 0.0284s/iter; left time: 954.6722s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0300s/iter; left time: 1004.6368s
Epoch: 19 cost time: 12.206799745559692
Epoch: 19, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.715 Vali Acc: 0.967 Test Loss: 0.715 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0954s/iter; left time: 3183.4838s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 949.9771s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 935.6590s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 922.4462s
Epoch: 20 cost time: 12.180636882781982
Epoch: 20, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.559 Vali Acc: 0.970 Test Loss: 0.559 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0949s/iter; left time: 3125.8387s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 876.5510s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 906.0310s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 924.0997s
Epoch: 21 cost time: 11.748162508010864
Epoch: 21, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.400 Vali Acc: 0.977 Test Loss: 0.400 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1017s/iter; left time: 3307.1715s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 916.0450s
	iters: 300, epoch: 22 | loss: 0.0000028
	speed: 0.0282s/iter; left time: 910.6682s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0294s/iter; left time: 946.0524s
Epoch: 22 cost time: 12.225557804107666
Epoch: 22, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.486 Vali Acc: 0.977 Test Loss: 0.486 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2142896
	speed: 0.1194s/iter; left time: 3833.3048s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 978.6830s
	iters: 300, epoch: 23 | loss: 0.6769851
	speed: 0.0283s/iter; left time: 903.9017s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 892.3615s
Epoch: 23 cost time: 12.511010885238647
Epoch: 23, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.390 Vali Acc: 0.981 Test Loss: 0.390 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1117s/iter; left time: 3541.8783s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 813.6328s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 856.8169s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 876.1097s
Epoch: 24 cost time: 11.851143836975098
Epoch: 24, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.306 Vali Acc: 0.985 Test Loss: 0.306 Test Acc: 0.985
Validation loss decreased (-0.984081 --> -0.984990).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0028921
	speed: 0.1029s/iter; left time: 3219.7425s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 864.5621s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 869.6884s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0288s/iter; left time: 893.0735s
Epoch: 25 cost time: 12.03723955154419
Epoch: 25, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.265 Vali Acc: 0.984 Test Loss: 0.265 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1032s/iter; left time: 3187.5415s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 831.1446s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 847.6407s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 876.3698s
Epoch: 26 cost time: 11.852055311203003
Epoch: 26, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.673 Vali Acc: 0.978 Test Loss: 0.673 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1013s/iter; left time: 3085.3817s
	iters: 200, epoch: 27 | loss: 0.0036356
	speed: 0.0291s/iter; left time: 883.5486s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 925.5462s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 916.7264s
Epoch: 27 cost time: 12.460206508636475
Epoch: 27, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.508 Vali Acc: 0.979 Test Loss: 0.508 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.3864630
	speed: 0.1125s/iter; left time: 3381.3417s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 842.9140s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 917.0655s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 897.5775s
Epoch: 28 cost time: 12.747339010238647
Epoch: 28, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.931 Vali Acc: 0.971 Test Loss: 0.931 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1173s/iter; left time: 3477.7165s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 865.9815s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0299s/iter; left time: 879.4141s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 846.3876s
Epoch: 29 cost time: 12.75660753250122
Epoch: 29, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.310 Vali Acc: 0.985 Test Loss: 0.310 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1023s/iter; left time: 2989.5802s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 834.0658s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 827.6354s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 824.9999s
Epoch: 30 cost time: 12.260629653930664
Epoch: 30, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.302 Vali Acc: 0.984 Test Loss: 0.302 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.0945s/iter; left time: 2721.7462s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 800.8950s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 792.5862s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 797.8804s
Epoch: 31 cost time: 11.887678146362305
Epoch: 31, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.686 Vali Acc: 0.977 Test Loss: 0.686 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.0988s/iter; left time: 2804.5473s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 768.3495s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 816.3843s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0288s/iter; left time: 808.7418s
Epoch: 32 cost time: 12.148711204528809
Epoch: 32, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.328 Vali Acc: 0.984 Test Loss: 0.328 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1063s/iter; left time: 2976.1229s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 780.4145s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 759.9377s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 799.1297s
Epoch: 33 cost time: 12.158193588256836
Epoch: 33, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.981 Test Loss: 0.485 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1091s/iter; left time: 3009.4833s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 781.6153s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0294s/iter; left time: 805.8076s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 719.2857s
Epoch: 34 cost time: 12.18995714187622
Epoch: 34, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.611 Vali Acc: 0.978 Test Loss: 0.611 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 3137102
model size : 21.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0851159
	speed: 0.0437s/iter; left time: 1802.3269s
	iters: 200, epoch: 1 | loss: 0.0173475
	speed: 0.0251s/iter; left time: 1030.6493s
	iters: 300, epoch: 1 | loss: 0.1016505
	speed: 0.0262s/iter; left time: 1072.8553s
	iters: 400, epoch: 1 | loss: 0.3871585
	speed: 0.0261s/iter; left time: 1067.4877s
Epoch: 1 cost time: 12.516946077346802
Epoch: 1, Steps: 413 | Train Loss: 0.292 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
Validation loss decreased (inf --> -0.971804).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2897331
	speed: 0.0918s/iter; left time: 3744.3341s
	iters: 200, epoch: 2 | loss: 0.0014910
	speed: 0.0277s/iter; left time: 1125.8372s
	iters: 300, epoch: 2 | loss: 0.1918221
	speed: 0.0267s/iter; left time: 1085.2563s
	iters: 400, epoch: 2 | loss: 0.0000031
	speed: 0.0275s/iter; left time: 1114.2416s
Epoch: 2 cost time: 11.610949754714966
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.234 Vali Acc: 0.959 Test Loss: 0.234 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0226278
	speed: 0.1023s/iter; left time: 4132.1594s
	iters: 200, epoch: 3 | loss: 0.0000005
	speed: 0.0283s/iter; left time: 1141.0791s
	iters: 300, epoch: 3 | loss: 0.3579823
	speed: 0.0277s/iter; left time: 1113.3797s
	iters: 400, epoch: 3 | loss: 0.0000005
	speed: 0.0276s/iter; left time: 1104.9008s
Epoch: 3 cost time: 11.977187156677246
Epoch: 3, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0004044
	speed: 0.1011s/iter; left time: 4039.1946s
	iters: 200, epoch: 4 | loss: 0.0010396
	speed: 0.0279s/iter; left time: 1111.9633s
	iters: 300, epoch: 4 | loss: 0.0000066
	speed: 0.0287s/iter; left time: 1143.0150s
	iters: 400, epoch: 4 | loss: 0.0000026
	speed: 0.0285s/iter; left time: 1129.8825s
Epoch: 4 cost time: 12.100293636322021
Epoch: 4, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0005187
	speed: 0.1067s/iter; left time: 4221.0752s
	iters: 200, epoch: 5 | loss: 0.0550307
	speed: 0.0268s/iter; left time: 1056.8741s
	iters: 300, epoch: 5 | loss: 0.0000040
	speed: 0.0272s/iter; left time: 1069.3881s
	iters: 400, epoch: 5 | loss: 0.0000563
	speed: 0.0266s/iter; left time: 1042.7635s
Epoch: 5 cost time: 11.520095348358154
Epoch: 5, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.362 Vali Acc: 0.955 Test Loss: 0.362 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.3260309
	speed: 0.0927s/iter; left time: 3627.9064s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 1023.9056s
	iters: 300, epoch: 6 | loss: 0.0001766
	speed: 0.0262s/iter; left time: 1018.3617s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 1039.6001s
Epoch: 6 cost time: 11.33913540840149
Epoch: 6, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.235 Vali Acc: 0.969 Test Loss: 0.235 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.0956s/iter; left time: 3703.2445s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0266s/iter; left time: 1026.6559s
	iters: 300, epoch: 7 | loss: 0.0000004
	speed: 0.0262s/iter; left time: 1010.8346s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.0260s/iter; left time: 999.6989s
Epoch: 7 cost time: 11.262176275253296
Epoch: 7, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.272 Vali Acc: 0.973 Test Loss: 0.272 Test Acc: 0.973
Validation loss decreased (-0.971804 --> -0.973167).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000383
	speed: 0.0959s/iter; left time: 3674.2933s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 1007.1569s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 1056.0955s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 1032.7883s
Epoch: 8 cost time: 11.383773803710938
Epoch: 8, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.495 Vali Acc: 0.959 Test Loss: 0.495 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000204
	speed: 0.0976s/iter; left time: 3698.6642s
	iters: 200, epoch: 9 | loss: 0.0001519
	speed: 0.0273s/iter; left time: 1031.6059s
	iters: 300, epoch: 9 | loss: 0.0000038
	speed: 0.0259s/iter; left time: 976.2429s
	iters: 400, epoch: 9 | loss: 0.3236615
	speed: 0.0269s/iter; left time: 1010.1633s
Epoch: 9 cost time: 11.404682397842407
Epoch: 9, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.490 Vali Acc: 0.958 Test Loss: 0.490 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1043s/iter; left time: 3911.3187s
	iters: 200, epoch: 10 | loss: 0.0000004
	speed: 0.0267s/iter; left time: 999.4723s
	iters: 300, epoch: 10 | loss: 0.0000855
	speed: 0.0281s/iter; left time: 1046.4757s
	iters: 400, epoch: 10 | loss: 0.2273196
	speed: 0.0263s/iter; left time: 976.7235s
Epoch: 10 cost time: 11.56049919128418
Epoch: 10, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.431 Vali Acc: 0.974 Test Loss: 0.431 Test Acc: 0.974
Validation loss decreased (-0.973167 --> -0.973620).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0987s/iter; left time: 3660.5250s
	iters: 200, epoch: 11 | loss: 0.0700788
	speed: 0.0263s/iter; left time: 971.5749s
	iters: 300, epoch: 11 | loss: 1.5212679
	speed: 0.0267s/iter; left time: 985.1092s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.0271s/iter; left time: 995.3509s
Epoch: 11 cost time: 11.463425159454346
Epoch: 11, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.356 Vali Acc: 0.970 Test Loss: 0.356 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0941s/iter; left time: 3449.8667s
	iters: 200, epoch: 12 | loss: 1.3059983
	speed: 0.0276s/iter; left time: 1007.5029s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 988.2141s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 986.3369s
Epoch: 12 cost time: 11.510124444961548
Epoch: 12, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.347 Vali Acc: 0.970 Test Loss: 0.347 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0961s/iter; left time: 3481.5476s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 973.5298s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 990.6514s
	iters: 400, epoch: 13 | loss: 0.2154513
	speed: 0.0278s/iter; left time: 998.3467s
Epoch: 13 cost time: 11.606684923171997
Epoch: 13, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.447 Vali Acc: 0.970 Test Loss: 0.447 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.1404629
	speed: 0.1049s/iter; left time: 3759.3987s
	iters: 200, epoch: 14 | loss: 0.0407772
	speed: 0.0286s/iter; left time: 1022.6994s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 1015.7182s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 1017.7429s
Epoch: 14 cost time: 12.149243593215942
Epoch: 14, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.505 Vali Acc: 0.979 Test Loss: 0.505 Test Acc: 0.979
Validation loss decreased (-0.973620 --> -0.979076).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3546778
	speed: 0.1070s/iter; left time: 3791.4230s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0278s/iter; left time: 982.4715s
	iters: 300, epoch: 15 | loss: 0.0000005
	speed: 0.0279s/iter; left time: 982.9665s
	iters: 400, epoch: 15 | loss: 0.6169339
	speed: 0.0282s/iter; left time: 990.9488s
Epoch: 15 cost time: 12.033161878585815
Epoch: 15, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.498 Vali Acc: 0.972 Test Loss: 0.498 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1039s/iter; left time: 3635.8174s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 874.7433s
	iters: 300, epoch: 16 | loss: 0.1708967
	speed: 0.0256s/iter; left time: 889.7180s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 879.0321s
Epoch: 16 cost time: 10.851692914962769
Epoch: 16, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.258 Vali Acc: 0.982 Test Loss: 0.258 Test Acc: 0.982
Validation loss decreased (-0.979076 --> -0.981807).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0966s/iter; left time: 3339.9927s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 912.1442s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 876.9817s
	iters: 400, epoch: 17 | loss: 0.2104379
	speed: 0.0260s/iter; left time: 892.1612s
Epoch: 17 cost time: 11.138045072555542
Epoch: 17, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.683 Vali Acc: 0.961 Test Loss: 0.683 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0979s/iter; left time: 3345.7095s
	iters: 200, epoch: 18 | loss: 0.0000242
	speed: 0.0261s/iter; left time: 888.0017s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 949.7027s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 902.0847s
Epoch: 18 cost time: 11.460511684417725
Epoch: 18, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.340 Vali Acc: 0.976 Test Loss: 0.340 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0934s/iter; left time: 3154.0229s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 882.7165s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 932.1134s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 905.1752s
Epoch: 19 cost time: 11.434934854507446
Epoch: 19, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.554 Vali Acc: 0.976 Test Loss: 0.554 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0988s/iter; left time: 3296.5286s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 892.8853s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 859.6534s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 908.4483s
Epoch: 20 cost time: 11.440227508544922
Epoch: 20, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.620 Vali Acc: 0.970 Test Loss: 0.620 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1024s/iter; left time: 3371.9621s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 879.0074s
	iters: 300, epoch: 21 | loss: 1.9292345
	speed: 0.0269s/iter; left time: 882.1178s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 884.7873s
Epoch: 21 cost time: 11.593708515167236
Epoch: 21, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.474 Vali Acc: 0.975 Test Loss: 0.474 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0950s/iter; left time: 3089.8210s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 812.0225s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 847.9255s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 878.1541s
Epoch: 22 cost time: 11.182433605194092
Epoch: 22, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.497 Vali Acc: 0.980 Test Loss: 0.497 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000005
	speed: 0.0918s/iter; left time: 2949.5654s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 869.2608s
	iters: 300, epoch: 23 | loss: 0.0536228
	speed: 0.0277s/iter; left time: 883.2548s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 848.3290s
Epoch: 23 cost time: 11.541618824005127
Epoch: 23, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.351 Vali Acc: 0.985 Test Loss: 0.351 Test Acc: 0.985
Validation loss decreased (-0.981807 --> -0.985444).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0937s/iter; left time: 2970.4981s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 844.2933s
	iters: 300, epoch: 24 | loss: 0.0000005
	speed: 0.0267s/iter; left time: 840.6493s
	iters: 400, epoch: 24 | loss: 0.1459780
	speed: 0.0278s/iter; left time: 872.1954s
Epoch: 24 cost time: 11.506931781768799
Epoch: 24, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.486 Vali Acc: 0.979 Test Loss: 0.486 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0969s/iter; left time: 3032.3311s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 883.3239s
	iters: 300, epoch: 25 | loss: 0.1786664
	speed: 0.0283s/iter; left time: 880.7621s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 889.0443s
Epoch: 25 cost time: 12.126209735870361
Epoch: 25, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.327 Vali Acc: 0.984 Test Loss: 0.327 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1086s/iter; left time: 3351.8852s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 856.7567s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 875.5641s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 849.1556s
Epoch: 26 cost time: 11.978908061981201
Epoch: 26, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.599 Vali Acc: 0.976 Test Loss: 0.599 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1125s/iter; left time: 3428.5131s
	iters: 200, epoch: 27 | loss: 0.0676375
	speed: 0.0255s/iter; left time: 773.1475s
	iters: 300, epoch: 27 | loss: 4.5321927
	speed: 0.0266s/iter; left time: 803.5288s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 758.1849s
Epoch: 27 cost time: 11.289007425308228
Epoch: 27, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.444 Vali Acc: 0.980 Test Loss: 0.444 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0951s/iter; left time: 2859.2491s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 781.1417s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 778.2372s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 762.7803s
Epoch: 28 cost time: 11.232635259628296
Epoch: 28, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.478 Vali Acc: 0.976 Test Loss: 0.478 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.0959s/iter; left time: 2842.3161s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 804.1939s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 792.2089s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 760.9735s
Epoch: 29 cost time: 11.355817317962646
Epoch: 29, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.653 Vali Acc: 0.981 Test Loss: 0.653 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000068
	speed: 0.1010s/iter; left time: 2952.7200s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 766.0416s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 806.3342s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0300s/iter; left time: 866.7208s
Epoch: 30 cost time: 11.91433072090149
Epoch: 30, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.337 Vali Acc: 0.980 Test Loss: 0.337 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1110s/iter; left time: 3197.6420s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0292s/iter; left time: 837.8816s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 799.1234s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 748.2463s
Epoch: 31 cost time: 11.897291421890259
Epoch: 31, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.877 Vali Acc: 0.973 Test Loss: 0.877 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1011s/iter; left time: 2872.2855s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 771.0678s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 771.9727s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 739.0825s
Epoch: 32 cost time: 11.525050640106201
Epoch: 32, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.306 Vali Acc: 0.983 Test Loss: 0.306 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.0910s/iter; left time: 2546.4124s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 769.6980s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 751.1177s
	iters: 400, epoch: 33 | loss: 0.0637238
	speed: 0.0268s/iter; left time: 742.8624s
Epoch: 33 cost time: 11.590644121170044
Epoch: 33, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.409 Vali Acc: 0.984 Test Loss: 0.409 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 3137102
model size : 21.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0927883
	speed: 0.0478s/iter; left time: 1968.6214s
	iters: 200, epoch: 1 | loss: 0.0480053
	speed: 0.0275s/iter; left time: 1129.1149s
	iters: 300, epoch: 1 | loss: 0.0257041
	speed: 0.0279s/iter; left time: 1142.3917s
	iters: 400, epoch: 1 | loss: 0.0787408
	speed: 0.0274s/iter; left time: 1120.4469s
Epoch: 1 cost time: 13.4898362159729
Epoch: 1, Steps: 413 | Train Loss: 0.321 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (inf --> -0.962254).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0598507
	speed: 0.0999s/iter; left time: 4074.3378s
	iters: 200, epoch: 2 | loss: 0.0007049
	speed: 0.0291s/iter; left time: 1183.2033s
	iters: 300, epoch: 2 | loss: 0.1731779
	speed: 0.0310s/iter; left time: 1258.4054s
	iters: 400, epoch: 2 | loss: 0.0001496
	speed: 0.0297s/iter; left time: 1203.7076s
Epoch: 2 cost time: 12.760155200958252
Epoch: 2, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0038778
	speed: 0.1034s/iter; left time: 4174.3929s
	iters: 200, epoch: 3 | loss: 0.2403516
	speed: 0.0266s/iter; left time: 1072.1346s
	iters: 300, epoch: 3 | loss: 0.3581594
	speed: 0.0269s/iter; left time: 1079.4341s
	iters: 400, epoch: 3 | loss: 0.0000100
	speed: 0.0274s/iter; left time: 1099.1868s
Epoch: 3 cost time: 11.678121089935303
Epoch: 3, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.176 Vali Acc: 0.969 Test Loss: 0.176 Test Acc: 0.969
Validation loss decreased (-0.962254 --> -0.968620).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0912188
	speed: 0.1020s/iter; left time: 4074.5938s
	iters: 200, epoch: 4 | loss: 0.0000073
	speed: 0.0233s/iter; left time: 927.4088s
	iters: 300, epoch: 4 | loss: 0.0000008
	speed: 0.0261s/iter; left time: 1035.8852s
	iters: 400, epoch: 4 | loss: 0.0812275
	speed: 0.0254s/iter; left time: 1008.2760s
Epoch: 4 cost time: 10.892823219299316
Epoch: 4, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.270 Vali Acc: 0.962 Test Loss: 0.270 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0024965
	speed: 0.0934s/iter; left time: 3692.5486s
	iters: 200, epoch: 5 | loss: 0.0007628
	speed: 0.0258s/iter; left time: 1015.8390s
	iters: 300, epoch: 5 | loss: 0.4943312
	speed: 0.0263s/iter; left time: 1036.7775s
	iters: 400, epoch: 5 | loss: 0.0001909
	speed: 0.0261s/iter; left time: 1023.0844s
Epoch: 5 cost time: 11.300436735153198
Epoch: 5, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.253 Vali Acc: 0.966 Test Loss: 0.253 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000227
	speed: 0.0923s/iter; left time: 3613.3564s
	iters: 200, epoch: 6 | loss: 0.0003867
	speed: 0.0260s/iter; left time: 1013.9487s
	iters: 300, epoch: 6 | loss: 0.0277082
	speed: 0.0272s/iter; left time: 1058.7721s
	iters: 400, epoch: 6 | loss: 0.0000762
	speed: 0.0258s/iter; left time: 1002.8561s
Epoch: 6 cost time: 11.2495596408844
Epoch: 6, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.279 Vali Acc: 0.971 Test Loss: 0.279 Test Acc: 0.971
Validation loss decreased (-0.968620 --> -0.971348).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000388
	speed: 0.0951s/iter; left time: 3684.1662s
	iters: 200, epoch: 7 | loss: 0.0000012
	speed: 0.0280s/iter; left time: 1083.2920s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 1068.2126s
	iters: 400, epoch: 7 | loss: 0.0021428
	speed: 0.0280s/iter; left time: 1074.6266s
Epoch: 7 cost time: 11.57752013206482
Epoch: 7, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.971348 --> -0.974986).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1064s/iter; left time: 4074.3181s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 1015.2671s
	iters: 300, epoch: 8 | loss: 0.0001068
	speed: 0.0270s/iter; left time: 1027.1955s
	iters: 400, epoch: 8 | loss: 0.0000382
	speed: 0.0286s/iter; left time: 1086.1745s
Epoch: 8 cost time: 11.751933813095093
Epoch: 8, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.393 Vali Acc: 0.972 Test Loss: 0.393 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0158540
	speed: 0.1125s/iter; left time: 4262.8266s
	iters: 200, epoch: 9 | loss: 0.0000024
	speed: 0.0276s/iter; left time: 1044.6429s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 968.0895s
	iters: 400, epoch: 9 | loss: 0.0027131
	speed: 0.0265s/iter; left time: 995.3291s
Epoch: 9 cost time: 11.77220344543457
Epoch: 9, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.353 Vali Acc: 0.968 Test Loss: 0.353 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0939s/iter; left time: 3521.0923s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0271s/iter; left time: 1013.6526s
	iters: 300, epoch: 10 | loss: 0.0000004
	speed: 0.0272s/iter; left time: 1014.2100s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0277s/iter; left time: 1029.3524s
Epoch: 10 cost time: 11.676860094070435
Epoch: 10, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.383 Vali Acc: 0.972 Test Loss: 0.383 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0949s/iter; left time: 3519.0069s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 962.3052s
	iters: 300, epoch: 11 | loss: 1.5750052
	speed: 0.0259s/iter; left time: 955.4452s
	iters: 400, epoch: 11 | loss: 0.0000005
	speed: 0.0263s/iter; left time: 965.6355s
Epoch: 11 cost time: 11.29803991317749
Epoch: 11, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.341 Vali Acc: 0.975 Test Loss: 0.341 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0938s/iter; left time: 3436.8554s
	iters: 200, epoch: 12 | loss: 0.1226773
	speed: 0.0248s/iter; left time: 906.8676s
	iters: 300, epoch: 12 | loss: 0.0000091
	speed: 0.0264s/iter; left time: 962.3736s
	iters: 400, epoch: 12 | loss: 0.0019957
	speed: 0.0283s/iter; left time: 1030.6811s
Epoch: 12 cost time: 11.484559774398804
Epoch: 12, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.705 Vali Acc: 0.956 Test Loss: 0.705 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0614650
	speed: 0.1022s/iter; left time: 3703.6522s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 1001.6247s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 943.1027s
	iters: 400, epoch: 13 | loss: 0.0042621
	speed: 0.0264s/iter; left time: 947.8514s
Epoch: 13 cost time: 11.50542140007019
Epoch: 13, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.635 Vali Acc: 0.971 Test Loss: 0.635 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0985s/iter; left time: 3530.3864s
	iters: 200, epoch: 14 | loss: 0.0000007
	speed: 0.0277s/iter; left time: 991.5474s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 950.1714s
	iters: 400, epoch: 14 | loss: 0.0000058
	speed: 0.0260s/iter; left time: 924.6540s
Epoch: 14 cost time: 11.411621570587158
Epoch: 14, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.433 Vali Acc: 0.969 Test Loss: 0.433 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0883s/iter; left time: 3126.0815s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 986.0853s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 986.3584s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 848.6350s
Epoch: 15 cost time: 11.548399209976196
Epoch: 15, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.617 Vali Acc: 0.965 Test Loss: 0.617 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.8659015
	speed: 0.0753s/iter; left time: 2635.3807s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 768.6795s
	iters: 300, epoch: 16 | loss: 0.0849252
	speed: 0.0241s/iter; left time: 839.2124s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0235s/iter; left time: 813.9179s
Epoch: 16 cost time: 9.799703598022461
Epoch: 16, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.431 Vali Acc: 0.974 Test Loss: 0.431 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 3151.9570s
	iters: 200, epoch: 17 | loss: 0.0066667
	speed: 0.0248s/iter; left time: 853.9988s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 869.2315s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 858.2625s
Epoch: 17 cost time: 10.892667293548584
Epoch: 17, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.633 Vali Acc: 0.968 Test Loss: 0.633 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9749886311959982
model parameter : 3137102
model size : 21.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2058501
	speed: 0.0446s/iter; left time: 1837.5409s
	iters: 200, epoch: 1 | loss: 0.0377739
	speed: 0.0290s/iter; left time: 1190.4319s
	iters: 300, epoch: 1 | loss: 0.0075451
	speed: 0.0287s/iter; left time: 1175.1223s
	iters: 400, epoch: 1 | loss: 0.1451583
	speed: 0.0293s/iter; left time: 1197.6881s
Epoch: 1 cost time: 13.604727029800415
Epoch: 1, Steps: 413 | Train Loss: 0.273 Vali Loss: 0.080 Vali Acc: 0.972 Test Loss: 0.080 Test Acc: 0.972
Validation loss decreased (inf --> -0.971805).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0031836
	speed: 0.1044s/iter; left time: 4257.1748s
	iters: 200, epoch: 2 | loss: 0.0621011
	speed: 0.0303s/iter; left time: 1234.3862s
	iters: 300, epoch: 2 | loss: 0.0000493
	speed: 0.0303s/iter; left time: 1230.3356s
	iters: 400, epoch: 2 | loss: 0.0828806
	speed: 0.0320s/iter; left time: 1296.0100s
Epoch: 2 cost time: 13.07872986793518
Epoch: 2, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.971805 --> -0.974988).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0070917
	speed: 0.1111s/iter; left time: 4486.6093s
	iters: 200, epoch: 3 | loss: 0.0000039
	speed: 0.0310s/iter; left time: 1249.4574s
	iters: 300, epoch: 3 | loss: 0.0004513
	speed: 0.0310s/iter; left time: 1244.4434s
	iters: 400, epoch: 3 | loss: 0.0000563
	speed: 0.0308s/iter; left time: 1235.9590s
Epoch: 3 cost time: 13.149581670761108
Epoch: 3, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.217 Vali Acc: 0.965 Test Loss: 0.217 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0002512
	speed: 0.0979s/iter; left time: 3911.4653s
	iters: 200, epoch: 4 | loss: 0.0000679
	speed: 0.0284s/iter; left time: 1130.8404s
	iters: 300, epoch: 4 | loss: 0.0000004
	speed: 0.0271s/iter; left time: 1078.0026s
	iters: 400, epoch: 4 | loss: 1.3944480
	speed: 0.0272s/iter; left time: 1078.0345s
Epoch: 4 cost time: 11.723214149475098
Epoch: 4, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.0929s/iter; left time: 3674.0944s
	iters: 200, epoch: 5 | loss: 0.4627815
	speed: 0.0266s/iter; left time: 1049.9684s
	iters: 300, epoch: 5 | loss: 0.4016249
	speed: 0.0275s/iter; left time: 1082.2674s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 1072.9900s
Epoch: 5 cost time: 11.666603565216064
Epoch: 5, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.476 Vali Acc: 0.963 Test Loss: 0.476 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.0921s/iter; left time: 3604.7444s
	iters: 200, epoch: 6 | loss: 0.0000070
	speed: 0.0285s/iter; left time: 1112.9739s
	iters: 300, epoch: 6 | loss: 0.0660857
	speed: 0.0279s/iter; left time: 1085.2403s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 1052.4198s
Epoch: 6 cost time: 11.827884197235107
Epoch: 6, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.328 Vali Acc: 0.967 Test Loss: 0.328 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2972354
	speed: 0.0971s/iter; left time: 3760.6851s
	iters: 200, epoch: 7 | loss: 1.5995691
	speed: 0.0291s/iter; left time: 1122.9401s
	iters: 300, epoch: 7 | loss: 0.0258596
	speed: 0.0289s/iter; left time: 1113.5187s
	iters: 400, epoch: 7 | loss: 0.3854927
	speed: 0.0295s/iter; left time: 1132.6391s
Epoch: 7 cost time: 12.539844274520874
Epoch: 7, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.295 Vali Acc: 0.973 Test Loss: 0.295 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000129
	speed: 0.1013s/iter; left time: 3882.4009s
	iters: 200, epoch: 8 | loss: 0.0071148
	speed: 0.0283s/iter; left time: 1081.4269s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 1042.9190s
	iters: 400, epoch: 8 | loss: 0.0008474
	speed: 0.0277s/iter; left time: 1051.3250s
Epoch: 8 cost time: 12.010517597198486
Epoch: 8, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.262 Vali Acc: 0.977 Test Loss: 0.262 Test Acc: 0.977
Validation loss decreased (-0.974988 --> -0.977260).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0208128
	speed: 0.0997s/iter; left time: 3776.6388s
	iters: 200, epoch: 9 | loss: 0.0000003
	speed: 0.0270s/iter; left time: 1020.6199s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0272s/iter; left time: 1026.4135s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 1065.5293s
Epoch: 9 cost time: 11.767658233642578
Epoch: 9, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.287 Vali Acc: 0.972 Test Loss: 0.287 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 3413.7072s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 1073.7366s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0292s/iter; left time: 1088.4004s
	iters: 400, epoch: 10 | loss: 0.1694714
	speed: 0.0294s/iter; left time: 1092.1285s
Epoch: 10 cost time: 12.402878284454346
Epoch: 10, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.448 Vali Acc: 0.963 Test Loss: 0.448 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0937s/iter; left time: 3472.8813s
	iters: 200, epoch: 11 | loss: 0.3521953
	speed: 0.0291s/iter; left time: 1075.7842s
	iters: 300, epoch: 11 | loss: 0.0000005
	speed: 0.0283s/iter; left time: 1044.2180s
	iters: 400, epoch: 11 | loss: 0.0000534
	speed: 0.0289s/iter; left time: 1063.3359s
Epoch: 11 cost time: 12.232725143432617
Epoch: 11, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.363 Vali Acc: 0.974 Test Loss: 0.363 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000098
	speed: 0.0995s/iter; left time: 3648.0718s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 1125.6431s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 1139.4811s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0312s/iter; left time: 1133.7872s
Epoch: 12 cost time: 13.241023302078247
Epoch: 12, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.595 Vali Acc: 0.969 Test Loss: 0.595 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1090s/iter; left time: 3952.1197s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 1111.5208s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 1106.6867s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0304s/iter; left time: 1091.3667s
Epoch: 13 cost time: 13.11035704612732
Epoch: 13, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.353 Vali Acc: 0.976 Test Loss: 0.353 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0983s/iter; left time: 3523.7650s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 966.6175s
	iters: 300, epoch: 14 | loss: 0.0037926
	speed: 0.0278s/iter; left time: 991.8186s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 963.0107s
Epoch: 14 cost time: 11.691834211349487
Epoch: 14, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.398 Vali Acc: 0.975 Test Loss: 0.398 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 3232.3086s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 932.6455s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 947.0515s
	iters: 400, epoch: 15 | loss: 0.3394440
	speed: 0.0275s/iter; left time: 966.1671s
Epoch: 15 cost time: 11.613072156906128
Epoch: 15, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.374 Vali Acc: 0.979 Test Loss: 0.374 Test Acc: 0.979
Validation loss decreased (-0.977260 --> -0.979078).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0950s/iter; left time: 3327.2078s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 943.2938s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 952.9703s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 938.0825s
Epoch: 16 cost time: 11.59986162185669
Epoch: 16, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.270 Vali Acc: 0.981 Test Loss: 0.270 Test Acc: 0.981
Validation loss decreased (-0.979078 --> -0.981352).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0967s/iter; left time: 3344.2489s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 999.9048s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0288s/iter; left time: 990.3166s
	iters: 400, epoch: 17 | loss: 0.0011732
	speed: 0.0291s/iter; left time: 998.6890s
Epoch: 17 cost time: 12.350357294082642
Epoch: 17, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.267 Vali Acc: 0.981 Test Loss: 0.267 Test Acc: 0.981
Validation loss decreased (-0.981352 --> -0.981352).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1066s/iter; left time: 3645.2074s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 997.5165s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0294s/iter; left time: 997.5977s
	iters: 400, epoch: 18 | loss: 0.0222476
	speed: 0.0289s/iter; left time: 980.5720s
Epoch: 18 cost time: 12.50087308883667
Epoch: 18, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.275 Vali Acc: 0.982 Test Loss: 0.275 Test Acc: 0.982
Validation loss decreased (-0.981352 --> -0.982262).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1037s/iter; left time: 3500.7565s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 919.8680s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0286s/iter; left time: 959.2608s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 915.7704s
Epoch: 19 cost time: 11.722282409667969
Epoch: 19, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.477 Vali Acc: 0.972 Test Loss: 0.477 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0881s/iter; left time: 2937.2224s
	iters: 200, epoch: 20 | loss: 0.0101654
	speed: 0.0288s/iter; left time: 959.2200s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 965.8779s
	iters: 400, epoch: 20 | loss: 0.3064553
	speed: 0.0295s/iter; left time: 975.9539s
Epoch: 20 cost time: 12.331463813781738
Epoch: 20, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.545 Vali Acc: 0.981 Test Loss: 0.545 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0937s/iter; left time: 3084.9624s
	iters: 200, epoch: 21 | loss: 0.0000020
	speed: 0.0286s/iter; left time: 938.0904s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 920.3822s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 925.2239s
Epoch: 21 cost time: 12.106122970581055
Epoch: 21, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.442 Vali Acc: 0.974 Test Loss: 0.442 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.7455097
	speed: 0.0916s/iter; left time: 2978.8184s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 999.1904s
	iters: 300, epoch: 22 | loss: 0.0000002
	speed: 0.0314s/iter; left time: 1014.0814s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 973.3523s
Epoch: 22 cost time: 12.790029287338257
Epoch: 22, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.518 Vali Acc: 0.973 Test Loss: 0.518 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1122s/iter; left time: 3604.7332s
	iters: 200, epoch: 23 | loss: 0.0000267
	speed: 0.0314s/iter; left time: 1005.6957s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0315s/iter; left time: 1004.4890s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 907.3935s
Epoch: 23 cost time: 12.7547926902771
Epoch: 23, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.436 Vali Acc: 0.979 Test Loss: 0.436 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1059s/iter; left time: 3358.0804s
	iters: 200, epoch: 24 | loss: 0.0762238
	speed: 0.0280s/iter; left time: 883.6468s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 863.1743s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 882.0671s
Epoch: 24 cost time: 11.667704582214355
Epoch: 24, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.466 Vali Acc: 0.977 Test Loss: 0.466 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1002s/iter; left time: 3135.5932s
	iters: 200, epoch: 25 | loss: 0.3415765
	speed: 0.0277s/iter; left time: 863.0231s
	iters: 300, epoch: 25 | loss: 0.0214911
	speed: 0.0277s/iter; left time: 860.1847s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 875.5510s
Epoch: 25 cost time: 12.005343675613403
Epoch: 25, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.357 Vali Acc: 0.980 Test Loss: 0.357 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.0961s/iter; left time: 2967.4707s
	iters: 200, epoch: 26 | loss: 0.0001565
	speed: 0.0270s/iter; left time: 831.3774s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 863.5875s
	iters: 400, epoch: 26 | loss: 0.1668416
	speed: 0.0289s/iter; left time: 883.1611s
Epoch: 26 cost time: 11.98724365234375
Epoch: 26, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.525 Vali Acc: 0.976 Test Loss: 0.525 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0944s/iter; left time: 2874.5738s
	iters: 200, epoch: 27 | loss: 2.8066268
	speed: 0.0283s/iter; left time: 858.2488s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.0301s/iter; left time: 911.9083s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0303s/iter; left time: 914.9028s
Epoch: 27 cost time: 12.523868322372437
Epoch: 27, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.549 Vali Acc: 0.978 Test Loss: 0.549 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1039s/iter; left time: 3123.3219s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 865.9004s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 839.2137s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 841.4212s
Epoch: 28 cost time: 12.086121559143066
Epoch: 28, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.554 Vali Acc: 0.975 Test Loss: 0.554 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 2088526
model size : 17.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2180943
	speed: 0.0429s/iter; left time: 1768.1473s
	iters: 200, epoch: 1 | loss: 0.0384538
	speed: 0.0264s/iter; left time: 1086.2098s
	iters: 300, epoch: 1 | loss: 0.0125251
	speed: 0.0262s/iter; left time: 1072.4792s
	iters: 400, epoch: 1 | loss: 0.2921917
	speed: 0.0262s/iter; left time: 1071.5056s
Epoch: 1 cost time: 12.560844659805298
Epoch: 1, Steps: 413 | Train Loss: 0.277 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (inf --> -0.975897).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0005986
	speed: 0.0873s/iter; left time: 3558.8306s
	iters: 200, epoch: 2 | loss: 0.0003695
	speed: 0.0257s/iter; left time: 1044.5638s
	iters: 300, epoch: 2 | loss: 0.1194384
	speed: 0.0262s/iter; left time: 1062.5754s
	iters: 400, epoch: 2 | loss: 0.0002015
	speed: 0.0264s/iter; left time: 1070.2981s
Epoch: 2 cost time: 11.234793663024902
Epoch: 2, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
Validation loss decreased (-0.975897 --> -0.979081).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0501793
	speed: 0.0887s/iter; left time: 3581.3993s
	iters: 200, epoch: 3 | loss: 0.0002322
	speed: 0.0263s/iter; left time: 1060.3168s
	iters: 300, epoch: 3 | loss: 0.0016176
	speed: 0.0268s/iter; left time: 1077.1218s
	iters: 400, epoch: 3 | loss: 0.0004193
	speed: 0.0260s/iter; left time: 1043.7095s
Epoch: 3 cost time: 11.236241579055786
Epoch: 3, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0015298
	speed: 0.1030s/iter; left time: 4114.3212s
	iters: 200, epoch: 4 | loss: 0.4585121
	speed: 0.0289s/iter; left time: 1151.7858s
	iters: 300, epoch: 4 | loss: 0.0000765
	speed: 0.0262s/iter; left time: 1041.9031s
	iters: 400, epoch: 4 | loss: 0.5478642
	speed: 0.0277s/iter; left time: 1100.5376s
Epoch: 4 cost time: 11.953183650970459
Epoch: 4, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.251 Vali Acc: 0.974 Test Loss: 0.251 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.1063s/iter; left time: 4204.6730s
	iters: 200, epoch: 5 | loss: 0.0121592
	speed: 0.0266s/iter; left time: 1049.4266s
	iters: 300, epoch: 5 | loss: 0.0000092
	speed: 0.0271s/iter; left time: 1065.4405s
	iters: 400, epoch: 5 | loss: 0.0000080
	speed: 0.0267s/iter; left time: 1048.0601s
Epoch: 5 cost time: 11.579680681228638
Epoch: 5, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.226 Vali Acc: 0.973 Test Loss: 0.226 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0003638
	speed: 0.1066s/iter; left time: 4171.0493s
	iters: 200, epoch: 6 | loss: 0.0000006
	speed: 0.0256s/iter; left time: 998.3377s
	iters: 300, epoch: 6 | loss: 0.0245925
	speed: 0.0264s/iter; left time: 1028.4183s
	iters: 400, epoch: 6 | loss: 0.5948544
	speed: 0.0251s/iter; left time: 974.4756s
Epoch: 6 cost time: 11.020226955413818
Epoch: 6, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.292 Vali Acc: 0.969 Test Loss: 0.292 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0069494
	speed: 0.0945s/iter; left time: 3659.7916s
	iters: 200, epoch: 7 | loss: 0.0150575
	speed: 0.0253s/iter; left time: 976.4686s
	iters: 300, epoch: 7 | loss: 0.1375558
	speed: 0.0258s/iter; left time: 994.6213s
	iters: 400, epoch: 7 | loss: 0.0086680
	speed: 0.0260s/iter; left time: 997.5030s
Epoch: 7 cost time: 11.137176036834717
Epoch: 7, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.265 Vali Acc: 0.976 Test Loss: 0.265 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 3329.4583s
	iters: 200, epoch: 8 | loss: 0.0000009
	speed: 0.0254s/iter; left time: 971.3734s
	iters: 300, epoch: 8 | loss: 0.7549734
	speed: 0.0247s/iter; left time: 941.6497s
	iters: 400, epoch: 8 | loss: 0.2705410
	speed: 0.0251s/iter; left time: 955.8149s
Epoch: 8 cost time: 10.857164144515991
Epoch: 8, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.351 Vali Acc: 0.974 Test Loss: 0.351 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0341128
	speed: 0.0856s/iter; left time: 3244.4264s
	iters: 200, epoch: 9 | loss: 0.1850832
	speed: 0.0258s/iter; left time: 975.4395s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 1031.0886s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 1021.9470s
Epoch: 9 cost time: 11.21121096611023
Epoch: 9, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.289 Vali Acc: 0.980 Test Loss: 0.289 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979533).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1003s/iter; left time: 3759.9218s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 987.8103s
	iters: 300, epoch: 10 | loss: 0.0000003
	speed: 0.0255s/iter; left time: 951.0708s
	iters: 400, epoch: 10 | loss: 0.0000023
	speed: 0.0268s/iter; left time: 998.2094s
Epoch: 10 cost time: 11.4081130027771
Epoch: 10, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.369 Vali Acc: 0.976 Test Loss: 0.369 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2830146
	speed: 0.0983s/iter; left time: 3645.9117s
	iters: 200, epoch: 11 | loss: 0.0000011
	speed: 0.0285s/iter; left time: 1053.0438s
	iters: 300, epoch: 11 | loss: 0.0000316
	speed: 0.0282s/iter; left time: 1039.7138s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 919.3078s
Epoch: 11 cost time: 11.851401090621948
Epoch: 11, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.319 Vali Acc: 0.978 Test Loss: 0.319 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0896s/iter; left time: 3285.7880s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 987.1166s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 956.8331s
	iters: 400, epoch: 12 | loss: 0.0116963
	speed: 0.0263s/iter; left time: 955.1958s
Epoch: 12 cost time: 11.413501739501953
Epoch: 12, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.584 Vali Acc: 0.970 Test Loss: 0.584 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0099077
	speed: 0.0918s/iter; left time: 3326.2040s
	iters: 200, epoch: 13 | loss: 0.0000533
	speed: 0.0267s/iter; left time: 964.7457s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 1002.3678s
	iters: 400, epoch: 13 | loss: 0.0008754
	speed: 0.0273s/iter; left time: 981.7024s
Epoch: 13 cost time: 11.586616277694702
Epoch: 13, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.493 Vali Acc: 0.980 Test Loss: 0.493 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0891s/iter; left time: 3193.6519s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 980.8469s
	iters: 300, epoch: 14 | loss: 1.2613429
	speed: 0.0267s/iter; left time: 952.6525s
	iters: 400, epoch: 14 | loss: 0.0011065
	speed: 0.0269s/iter; left time: 956.0750s
Epoch: 14 cost time: 11.447953224182129
Epoch: 14, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.289 Vali Acc: 0.983 Test Loss: 0.289 Test Acc: 0.983
Validation loss decreased (-0.979533 --> -0.983171).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.1034s/iter; left time: 3660.6480s
	iters: 200, epoch: 15 | loss: 0.6360989
	speed: 0.0283s/iter; left time: 998.9024s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 984.4601s
	iters: 400, epoch: 15 | loss: 0.0000003
	speed: 0.0279s/iter; left time: 981.5145s
Epoch: 15 cost time: 11.958817720413208
Epoch: 15, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.776 Vali Acc: 0.961 Test Loss: 0.776 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.1385761
	speed: 0.0994s/iter; left time: 3478.1858s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 982.5633s
	iters: 300, epoch: 16 | loss: 0.7692727
	speed: 0.0279s/iter; left time: 970.7422s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 983.9309s
Epoch: 16 cost time: 12.149548053741455
Epoch: 16, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.402 Vali Acc: 0.975 Test Loss: 0.402 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1018s/iter; left time: 3520.3591s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 972.0378s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 907.9046s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 900.0182s
Epoch: 17 cost time: 11.728408813476562
Epoch: 17, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.430 Vali Acc: 0.980 Test Loss: 0.430 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0934s/iter; left time: 3193.6419s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 911.5012s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 907.9377s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 859.8380s
Epoch: 18 cost time: 11.322089910507202
Epoch: 18, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.394 Vali Acc: 0.979 Test Loss: 0.394 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 3111.8483s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 903.5137s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 911.3784s
	iters: 400, epoch: 19 | loss: 0.0044132
	speed: 0.0269s/iter; left time: 900.6563s
Epoch: 19 cost time: 11.551664113998413
Epoch: 19, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.394 Vali Acc: 0.979 Test Loss: 0.394 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0968s/iter; left time: 3227.2788s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 940.2417s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0288s/iter; left time: 955.6577s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 961.6691s
Epoch: 20 cost time: 12.37247371673584
Epoch: 20, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.240 Vali Acc: 0.985 Test Loss: 0.240 Test Acc: 0.985
Validation loss decreased (-0.983171 --> -0.984536).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.2217577
	speed: 0.1049s/iter; left time: 3456.1276s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0294s/iter; left time: 965.3869s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0297s/iter; left time: 973.9476s
	iters: 400, epoch: 21 | loss: 0.5423250
	speed: 0.0286s/iter; left time: 934.9766s
Epoch: 21 cost time: 12.398204565048218
Epoch: 21, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.423 Vali Acc: 0.978 Test Loss: 0.423 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1067s/iter; left time: 3470.3630s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 898.1996s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 885.4952s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 873.3135s
Epoch: 22 cost time: 11.74950647354126
Epoch: 22, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.208 Vali Acc: 0.988 Test Loss: 0.208 Test Acc: 0.988
Validation loss decreased (-0.984536 --> -0.988174).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.4195116
	speed: 0.0960s/iter; left time: 3082.8887s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 898.8866s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 915.8396s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 901.8012s
Epoch: 23 cost time: 12.15100908279419
Epoch: 23, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.655 Vali Acc: 0.974 Test Loss: 0.655 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000178
	speed: 0.0938s/iter; left time: 2974.4363s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 863.8041s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 883.1892s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 869.2036s
Epoch: 24 cost time: 11.836486577987671
Epoch: 24, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.581 Vali Acc: 0.976 Test Loss: 0.581 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0985s/iter; left time: 3082.8780s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 923.1611s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 905.2230s
	iters: 400, epoch: 25 | loss: 0.0000338
	speed: 0.0274s/iter; left time: 849.5847s
Epoch: 25 cost time: 12.298104286193848
Epoch: 25, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.279 Vali Acc: 0.986 Test Loss: 0.279 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1033s/iter; left time: 3189.5999s
	iters: 200, epoch: 26 | loss: 0.2809478
	speed: 0.0284s/iter; left time: 874.5833s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 880.4817s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 854.4721s
Epoch: 26 cost time: 11.970673084259033
Epoch: 26, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.293 Vali Acc: 0.983 Test Loss: 0.293 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1045s/iter; left time: 3184.5756s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 815.1156s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 760.6941s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 784.7795s
Epoch: 27 cost time: 11.199912548065186
Epoch: 27, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.583 Vali Acc: 0.984 Test Loss: 0.583 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0972s/iter; left time: 2919.8157s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 808.4841s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 804.2561s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 770.3719s
Epoch: 28 cost time: 11.450808048248291
Epoch: 28, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.337 Vali Acc: 0.985 Test Loss: 0.337 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.0995s/iter; left time: 2950.2902s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 784.6960s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 833.1815s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 805.7446s
Epoch: 29 cost time: 11.693679809570312
Epoch: 29, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.574 Vali Acc: 0.977 Test Loss: 0.574 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000047
	speed: 0.0950s/iter; left time: 2775.6823s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 806.5634s
	iters: 300, epoch: 30 | loss: 0.5909880
	speed: 0.0275s/iter; left time: 798.7983s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 848.6522s
Epoch: 30 cost time: 11.952619314193726
Epoch: 30, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.545 Vali Acc: 0.971 Test Loss: 0.545 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1052s/iter; left time: 3029.5851s
	iters: 200, epoch: 31 | loss: 0.0002826
	speed: 0.0283s/iter; left time: 813.3071s
	iters: 300, epoch: 31 | loss: 1.2368964
	speed: 0.0285s/iter; left time: 815.5579s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 810.3578s
Epoch: 31 cost time: 12.013060569763184
Epoch: 31, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.495 Vali Acc: 0.977 Test Loss: 0.495 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1082s/iter; left time: 3073.0316s
	iters: 200, epoch: 32 | loss: 0.0000590
	speed: 0.0278s/iter; left time: 786.6463s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0248s/iter; left time: 700.5356s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 736.2584s
Epoch: 32 cost time: 11.589959383010864
Epoch: 32, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.464 Vali Acc: 0.980 Test Loss: 0.464 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9881764438381082
model parameter : 2088526
model size : 17.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2258670
	speed: 0.0396s/iter; left time: 1632.8552s
	iters: 200, epoch: 1 | loss: 0.0274200
	speed: 0.0248s/iter; left time: 1019.3506s
	iters: 300, epoch: 1 | loss: 0.0384755
	speed: 0.0265s/iter; left time: 1084.6005s
	iters: 400, epoch: 1 | loss: 0.1314410
	speed: 0.0274s/iter; left time: 1119.5572s
Epoch: 1 cost time: 12.253641366958618
Epoch: 1, Steps: 413 | Train Loss: 0.284 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
Validation loss decreased (inf --> -0.974988).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0002036
	speed: 0.0919s/iter; left time: 3748.9450s
	iters: 200, epoch: 2 | loss: 0.0001029
	speed: 0.0267s/iter; left time: 1085.3327s
	iters: 300, epoch: 2 | loss: 0.0048732
	speed: 0.0271s/iter; left time: 1098.3214s
	iters: 400, epoch: 2 | loss: 0.0208412
	speed: 0.0268s/iter; left time: 1084.8575s
Epoch: 2 cost time: 11.530560970306396
Epoch: 2, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0002133
	speed: 0.1005s/iter; left time: 4058.0154s
	iters: 200, epoch: 3 | loss: 0.1206639
	speed: 0.0285s/iter; left time: 1147.7100s
	iters: 300, epoch: 3 | loss: 0.0008990
	speed: 0.0296s/iter; left time: 1187.3611s
	iters: 400, epoch: 3 | loss: 0.2321721
	speed: 0.0275s/iter; left time: 1101.3031s
Epoch: 3 cost time: 12.220521211624146
Epoch: 3, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0023229
	speed: 0.1021s/iter; left time: 4081.9976s
	iters: 200, epoch: 4 | loss: 0.6763054
	speed: 0.0287s/iter; left time: 1143.2091s
	iters: 300, epoch: 4 | loss: 0.0030345
	speed: 0.0287s/iter; left time: 1141.9444s
	iters: 400, epoch: 4 | loss: 0.3328429
	speed: 0.0258s/iter; left time: 1021.9272s
Epoch: 4 cost time: 11.982371807098389
Epoch: 4, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.191 Vali Acc: 0.974 Test Loss: 0.191 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0000001
	speed: 0.0906s/iter; left time: 3582.4437s
	iters: 200, epoch: 5 | loss: 0.0000902
	speed: 0.0261s/iter; left time: 1029.9231s
	iters: 300, epoch: 5 | loss: 0.0000003
	speed: 0.0257s/iter; left time: 1011.6154s
	iters: 400, epoch: 5 | loss: 0.0000291
	speed: 0.0255s/iter; left time: 1000.2892s
Epoch: 5 cost time: 11.126062631607056
Epoch: 5, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.206 Vali Acc: 0.977 Test Loss: 0.206 Test Acc: 0.977
Validation loss decreased (-0.974988 --> -0.976806).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000007
	speed: 0.0898s/iter; left time: 3515.1285s
	iters: 200, epoch: 6 | loss: 0.0000006
	speed: 0.0257s/iter; left time: 1002.9214s
	iters: 300, epoch: 6 | loss: 0.0003264
	speed: 0.0254s/iter; left time: 988.9975s
	iters: 400, epoch: 6 | loss: 0.0000071
	speed: 0.0262s/iter; left time: 1017.1271s
Epoch: 6 cost time: 10.950414180755615
Epoch: 6, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.467 Vali Acc: 0.957 Test Loss: 0.467 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000018
	speed: 0.0883s/iter; left time: 3420.3538s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 984.4323s
	iters: 300, epoch: 7 | loss: 0.1584301
	speed: 0.0257s/iter; left time: 989.2288s
	iters: 400, epoch: 7 | loss: 0.0002869
	speed: 0.0255s/iter; left time: 980.2966s
Epoch: 7 cost time: 10.955940961837769
Epoch: 7, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.433 Vali Acc: 0.964 Test Loss: 0.433 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1005s/iter; left time: 3848.6595s
	iters: 200, epoch: 8 | loss: 0.0000002
	speed: 0.0275s/iter; left time: 1049.5839s
	iters: 300, epoch: 8 | loss: 0.0000003
	speed: 0.0272s/iter; left time: 1035.6672s
	iters: 400, epoch: 8 | loss: 1.3679914
	speed: 0.0275s/iter; left time: 1044.3525s
Epoch: 8 cost time: 11.678261995315552
Epoch: 8, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.256 Vali Acc: 0.972 Test Loss: 0.256 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000004
	speed: 0.0946s/iter; left time: 3583.2772s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 1024.7964s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 1017.8133s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 992.4926s
Epoch: 9 cost time: 11.468456506729126
Epoch: 9, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.388 Vali Acc: 0.973 Test Loss: 0.388 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000005
	speed: 0.0894s/iter; left time: 3349.2127s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 932.6702s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 941.8571s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 962.0718s
Epoch: 10 cost time: 10.763758897781372
Epoch: 10, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.518 Vali Acc: 0.968 Test Loss: 0.518 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000040
	speed: 0.0852s/iter; left time: 3157.9154s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 970.3952s
	iters: 300, epoch: 11 | loss: 0.0000064
	speed: 0.0264s/iter; left time: 974.5474s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0270s/iter; left time: 993.6142s
Epoch: 11 cost time: 11.34561538696289
Epoch: 11, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.298 Vali Acc: 0.980 Test Loss: 0.298 Test Acc: 0.980
Validation loss decreased (-0.976806 --> -0.979533).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9058523
	speed: 0.0882s/iter; left time: 3234.2435s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0263s/iter; left time: 963.0160s
	iters: 300, epoch: 12 | loss: 0.0000023
	speed: 0.0268s/iter; left time: 975.5654s
	iters: 400, epoch: 12 | loss: 0.1046628
	speed: 0.0259s/iter; left time: 941.6853s
Epoch: 12 cost time: 11.237332344055176
Epoch: 12, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.304 Vali Acc: 0.980 Test Loss: 0.304 Test Acc: 0.980
Validation loss decreased (-0.979533 --> -0.979988).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0936s/iter; left time: 3393.0585s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 972.2858s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 1023.6891s
	iters: 400, epoch: 13 | loss: 0.0000060
	speed: 0.0277s/iter; left time: 995.7454s
Epoch: 13 cost time: 11.659586906433105
Epoch: 13, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.320 Vali Acc: 0.974 Test Loss: 0.320 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.0785724
	speed: 0.1050s/iter; left time: 3760.7383s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 910.3282s
	iters: 300, epoch: 14 | loss: 0.5829579
	speed: 0.0284s/iter; left time: 1011.1370s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 987.3419s
Epoch: 14 cost time: 11.775324821472168
Epoch: 14, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.392 Vali Acc: 0.978 Test Loss: 0.392 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1053s/iter; left time: 3731.0453s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 964.5402s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 933.7114s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 896.6320s
Epoch: 15 cost time: 11.476854801177979
Epoch: 15, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.694 Vali Acc: 0.972 Test Loss: 0.694 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0998459
	speed: 0.0947s/iter; left time: 3316.4265s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 877.4091s
	iters: 300, epoch: 16 | loss: 0.9601620
	speed: 0.0256s/iter; left time: 891.3012s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 894.3517s
Epoch: 16 cost time: 11.015820980072021
Epoch: 16, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.499 Vali Acc: 0.968 Test Loss: 0.499 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0938s/iter; left time: 3246.3273s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 933.1628s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 867.7885s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 880.6363s
Epoch: 17 cost time: 11.15002965927124
Epoch: 17, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.340 Vali Acc: 0.982 Test Loss: 0.340 Test Acc: 0.982
Validation loss decreased (-0.979988 --> -0.982261).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0975s/iter; left time: 3330.9141s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 907.1222s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 859.0720s
	iters: 400, epoch: 18 | loss: 0.0002470
	speed: 0.0256s/iter; left time: 868.1457s
Epoch: 18 cost time: 11.161533117294312
Epoch: 18, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.464 Vali Acc: 0.979 Test Loss: 0.464 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1028s/iter; left time: 3471.7345s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 928.8156s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 916.2791s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 916.5102s
Epoch: 19 cost time: 11.752016305923462
Epoch: 19, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.546 Vali Acc: 0.981 Test Loss: 0.546 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0017045
	speed: 0.1005s/iter; left time: 3352.2901s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 912.3581s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 890.2778s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 945.0474s
Epoch: 20 cost time: 11.785783052444458
Epoch: 20, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.519 Vali Acc: 0.985 Test Loss: 0.519 Test Acc: 0.985
Validation loss decreased (-0.982261 --> -0.984988).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3040963
	speed: 0.0932s/iter; left time: 3068.9526s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 861.4416s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 879.6263s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 851.6370s
Epoch: 21 cost time: 11.291771650314331
Epoch: 21, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.482 Vali Acc: 0.975 Test Loss: 0.482 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 2780.8137s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 859.6524s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 831.6255s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 838.3795s
Epoch: 22 cost time: 11.025395631790161
Epoch: 22, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.508 Vali Acc: 0.970 Test Loss: 0.508 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0875s/iter; left time: 2808.5537s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 854.8932s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 835.7841s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 810.7467s
Epoch: 23 cost time: 11.173770904541016
Epoch: 23, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.522 Vali Acc: 0.973 Test Loss: 0.522 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 2895.8165s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 921.1785s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 879.0766s
	iters: 400, epoch: 24 | loss: 1.3546963
	speed: 0.0264s/iter; left time: 828.6048s
Epoch: 24 cost time: 11.762183904647827
Epoch: 24, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.629 Vali Acc: 0.970 Test Loss: 0.629 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1076s/iter; left time: 3368.2030s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 855.7777s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 853.4418s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 868.5337s
Epoch: 25 cost time: 11.672322511672974
Epoch: 25, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.643 Vali Acc: 0.975 Test Loss: 0.643 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1068s/iter; left time: 3297.7164s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 767.7720s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 779.8662s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 792.5207s
Epoch: 26 cost time: 11.067265510559082
Epoch: 26, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.936 Vali Acc: 0.972 Test Loss: 0.936 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0926s/iter; left time: 2821.8687s
	iters: 200, epoch: 27 | loss: 0.3969055
	speed: 0.0250s/iter; left time: 760.2618s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 796.2481s
	iters: 400, epoch: 27 | loss: 0.0000191
	speed: 0.0265s/iter; left time: 799.7503s
Epoch: 27 cost time: 11.222607612609863
Epoch: 27, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.521 Vali Acc: 0.977 Test Loss: 0.521 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0984s/iter; left time: 2955.5823s
	iters: 200, epoch: 28 | loss: 0.0000058
	speed: 0.0261s/iter; left time: 782.1255s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 765.4444s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 771.7616s
Epoch: 28 cost time: 11.242948055267334
Epoch: 28, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.549 Vali Acc: 0.976 Test Loss: 0.549 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.0898s/iter; left time: 2662.2023s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 794.8383s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 803.1487s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 784.9901s
Epoch: 29 cost time: 11.50218152999878
Epoch: 29, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.814 Vali Acc: 0.971 Test Loss: 0.814 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1002s/iter; left time: 2927.7212s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 787.2015s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 760.6409s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 769.3960s
Epoch: 30 cost time: 11.310949802398682
Epoch: 30, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.681 Vali Acc: 0.975 Test Loss: 0.681 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 2088526
model size : 17.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2192166
	speed: 0.0444s/iter; left time: 1829.5636s
	iters: 200, epoch: 1 | loss: 0.0430422
	speed: 0.0265s/iter; left time: 1089.5850s
	iters: 300, epoch: 1 | loss: 0.0235429
	speed: 0.0264s/iter; left time: 1080.5908s
	iters: 400, epoch: 1 | loss: 0.1636950
	speed: 0.0261s/iter; left time: 1069.5341s
Epoch: 1 cost time: 12.769383192062378
Epoch: 1, Steps: 413 | Train Loss: 0.315 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
Validation loss decreased (inf --> -0.958616).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0022295
	speed: 0.0936s/iter; left time: 3816.6091s
	iters: 200, epoch: 2 | loss: 0.0003480
	speed: 0.0260s/iter; left time: 1057.1959s
	iters: 300, epoch: 2 | loss: 0.0176243
	speed: 0.0272s/iter; left time: 1105.2790s
	iters: 400, epoch: 2 | loss: 0.0604998
	speed: 0.0270s/iter; left time: 1094.4908s
Epoch: 2 cost time: 11.438246250152588
Epoch: 2, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
Validation loss decreased (-0.958616 --> -0.961799).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0005891
	speed: 0.0913s/iter; left time: 3687.5022s
	iters: 200, epoch: 3 | loss: 0.0038587
	speed: 0.0256s/iter; left time: 1031.9483s
	iters: 300, epoch: 3 | loss: 0.0093023
	speed: 0.0256s/iter; left time: 1029.2318s
	iters: 400, epoch: 3 | loss: 0.0002324
	speed: 0.0245s/iter; left time: 980.2479s
Epoch: 3 cost time: 10.759563446044922
Epoch: 3, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0055579
	speed: 0.1065s/iter; left time: 4255.1501s
	iters: 200, epoch: 4 | loss: 0.0235224
	speed: 0.0271s/iter; left time: 1079.3825s
	iters: 300, epoch: 4 | loss: 0.0000079
	speed: 0.0269s/iter; left time: 1069.7681s
	iters: 400, epoch: 4 | loss: 0.0000008
	speed: 0.0260s/iter; left time: 1030.0806s
Epoch: 4 cost time: 11.486920833587646
Epoch: 4, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.182 Vali Acc: 0.973 Test Loss: 0.182 Test Acc: 0.973
Validation loss decreased (-0.961799 --> -0.973168).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000259
	speed: 0.1070s/iter; left time: 4230.2284s
	iters: 200, epoch: 5 | loss: 0.4016301
	speed: 0.0265s/iter; left time: 1046.3430s
	iters: 300, epoch: 5 | loss: 0.1145949
	speed: 0.0273s/iter; left time: 1073.2264s
	iters: 400, epoch: 5 | loss: 0.0022298
	speed: 0.0268s/iter; left time: 1050.2648s
Epoch: 5 cost time: 11.601374626159668
Epoch: 5, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.137 Vali Acc: 0.978 Test Loss: 0.137 Test Acc: 0.978
Validation loss decreased (-0.973168 --> -0.977716).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000033
	speed: 0.0904s/iter; left time: 3538.2348s
	iters: 200, epoch: 6 | loss: 0.0000002
	speed: 0.0253s/iter; left time: 988.6708s
	iters: 300, epoch: 6 | loss: 0.0853046
	speed: 0.0256s/iter; left time: 997.9804s
	iters: 400, epoch: 6 | loss: 0.0005227
	speed: 0.0250s/iter; left time: 969.0355s
Epoch: 6 cost time: 10.94569730758667
Epoch: 6, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.288 Vali Acc: 0.972 Test Loss: 0.288 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0288539
	speed: 0.0908s/iter; left time: 3514.3876s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 994.0704s
	iters: 300, epoch: 7 | loss: 0.4432038
	speed: 0.0248s/iter; left time: 955.1420s
	iters: 400, epoch: 7 | loss: 0.0001584
	speed: 0.0251s/iter; left time: 963.4369s
Epoch: 7 cost time: 10.88905143737793
Epoch: 7, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.526 Vali Acc: 0.959 Test Loss: 0.526 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1816921
	speed: 0.0921s/iter; left time: 3529.6802s
	iters: 200, epoch: 8 | loss: 0.0000247
	speed: 0.0253s/iter; left time: 967.8824s
	iters: 300, epoch: 8 | loss: 0.0000002
	speed: 0.0260s/iter; left time: 989.4702s
	iters: 400, epoch: 8 | loss: 0.0911401
	speed: 0.0257s/iter; left time: 978.0743s
Epoch: 8 cost time: 11.004286527633667
Epoch: 8, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.481 Vali Acc: 0.955 Test Loss: 0.481 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0177124
	speed: 0.0981s/iter; left time: 3716.6746s
	iters: 200, epoch: 9 | loss: 0.0000047
	speed: 0.0273s/iter; left time: 1029.9770s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 1020.2228s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 1005.7991s
Epoch: 9 cost time: 11.664037942886353
Epoch: 9, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.401 Vali Acc: 0.965 Test Loss: 0.401 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.1342883
	speed: 0.0970s/iter; left time: 3637.4457s
	iters: 200, epoch: 10 | loss: 0.0000891
	speed: 0.0280s/iter; left time: 1047.8620s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 1054.7907s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 1024.2134s
Epoch: 10 cost time: 11.96617603302002
Epoch: 10, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.162 Vali Acc: 0.985 Test Loss: 0.162 Test Acc: 0.985
Validation loss decreased (-0.977716 --> -0.985446).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0973s/iter; left time: 3605.5695s
	iters: 200, epoch: 11 | loss: 1.0687262
	speed: 0.0259s/iter; left time: 956.3207s
	iters: 300, epoch: 11 | loss: 0.0000015
	speed: 0.0256s/iter; left time: 945.3452s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 950.6549s
Epoch: 11 cost time: 11.14657998085022
Epoch: 11, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.303 Vali Acc: 0.977 Test Loss: 0.303 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000020
	speed: 0.0878s/iter; left time: 3217.8372s
	iters: 200, epoch: 12 | loss: 0.3419524
	speed: 0.0260s/iter; left time: 950.0912s
	iters: 300, epoch: 12 | loss: 0.0000036
	speed: 0.0263s/iter; left time: 958.0176s
	iters: 400, epoch: 12 | loss: 0.0000016
	speed: 0.0254s/iter; left time: 923.0397s
Epoch: 12 cost time: 11.050817012786865
Epoch: 12, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.587 Vali Acc: 0.962 Test Loss: 0.587 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0463994
	speed: 0.0935s/iter; left time: 3389.5579s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 901.6656s
	iters: 300, epoch: 13 | loss: 0.0000067
	speed: 0.0250s/iter; left time: 901.1082s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 951.1030s
Epoch: 13 cost time: 10.92446255683899
Epoch: 13, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.623 Vali Acc: 0.965 Test Loss: 0.623 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0997s/iter; left time: 3573.1851s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 963.9935s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 950.6922s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 939.4522s
Epoch: 14 cost time: 11.597914457321167
Epoch: 14, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.527 Vali Acc: 0.970 Test Loss: 0.527 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1067s/iter; left time: 3779.5682s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 968.8739s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 943.0557s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 977.5080s
Epoch: 15 cost time: 11.861774682998657
Epoch: 15, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.609 Vali Acc: 0.962 Test Loss: 0.609 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1053s/iter; left time: 3684.6102s
	iters: 200, epoch: 16 | loss: 0.0003489
	speed: 0.0283s/iter; left time: 988.8826s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 1011.8019s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 1008.5394s
Epoch: 16 cost time: 11.753496170043945
Epoch: 16, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.455 Vali Acc: 0.972 Test Loss: 0.455 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0664073
	speed: 0.0923s/iter; left time: 3194.4204s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 716.0510s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 714.8106s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 719.9478s
Epoch: 17 cost time: 8.98352336883545
Epoch: 17, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.851 Vali Acc: 0.953 Test Loss: 0.851 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0885s/iter; left time: 3025.7798s
	iters: 200, epoch: 18 | loss: 0.0000847
	speed: 0.0250s/iter; left time: 850.5074s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 867.8309s
	iters: 400, epoch: 18 | loss: 0.0000008
	speed: 0.0255s/iter; left time: 864.5237s
Epoch: 18 cost time: 10.87581729888916
Epoch: 18, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.367 Vali Acc: 0.977 Test Loss: 0.367 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0910s/iter; left time: 3073.8565s
	iters: 200, epoch: 19 | loss: 0.9091613
	speed: 0.0261s/iter; left time: 879.0602s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 888.5651s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 877.7755s
Epoch: 19 cost time: 11.294424295425415
Epoch: 19, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.521 Vali Acc: 0.976 Test Loss: 0.521 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 2897.6087s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 861.4827s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 871.3636s
	iters: 400, epoch: 20 | loss: 0.7576901
	speed: 0.0249s/iter; left time: 824.3917s
Epoch: 20 cost time: 11.043175458908081
Epoch: 20, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.463 Vali Acc: 0.976 Test Loss: 0.463 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 2088526
model size : 17.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2804577
	speed: 0.0463s/iter; left time: 1908.0735s
	iters: 200, epoch: 1 | loss: 0.0602077
	speed: 0.0276s/iter; left time: 1135.7331s
	iters: 300, epoch: 1 | loss: 0.1922227
	speed: 0.0256s/iter; left time: 1051.3988s
	iters: 400, epoch: 1 | loss: 0.0386946
	speed: 0.0276s/iter; left time: 1127.9895s
Epoch: 1 cost time: 13.152187824249268
Epoch: 1, Steps: 413 | Train Loss: 0.294 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
Validation loss decreased (inf --> -0.968621).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0066744
	speed: 0.0994s/iter; left time: 4052.4731s
	iters: 200, epoch: 2 | loss: 0.0003306
	speed: 0.0287s/iter; left time: 1166.8582s
	iters: 300, epoch: 2 | loss: 0.6773911
	speed: 0.0285s/iter; left time: 1155.1216s
	iters: 400, epoch: 2 | loss: 0.0057271
	speed: 0.0267s/iter; left time: 1079.3640s
Epoch: 2 cost time: 11.883285999298096
Epoch: 2, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.154 Vali Acc: 0.966 Test Loss: 0.154 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2749714
	speed: 0.0945s/iter; left time: 3815.4928s
	iters: 200, epoch: 3 | loss: 0.0594770
	speed: 0.0268s/iter; left time: 1079.3272s
	iters: 300, epoch: 3 | loss: 0.0392555
	speed: 0.0273s/iter; left time: 1095.4929s
	iters: 400, epoch: 3 | loss: 0.2744264
	speed: 0.0278s/iter; left time: 1113.6251s
Epoch: 3 cost time: 11.623191356658936
Epoch: 3, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.222 Vali Acc: 0.968 Test Loss: 0.222 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.0968s/iter; left time: 3869.1779s
	iters: 200, epoch: 4 | loss: 1.2568731
	speed: 0.0271s/iter; left time: 1080.2091s
	iters: 300, epoch: 4 | loss: 0.0254605
	speed: 0.0273s/iter; left time: 1086.5644s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 1096.0472s
Epoch: 4 cost time: 11.789908409118652
Epoch: 4, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.237 Vali Acc: 0.969 Test Loss: 0.237 Test Acc: 0.969
Validation loss decreased (-0.968621 --> -0.969074).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0001254
	speed: 0.0992s/iter; left time: 3925.1137s
	iters: 200, epoch: 5 | loss: 0.0016761
	speed: 0.0267s/iter; left time: 1055.1608s
	iters: 300, epoch: 5 | loss: 0.7399731
	speed: 0.0265s/iter; left time: 1042.7582s
	iters: 400, epoch: 5 | loss: 0.0000034
	speed: 0.0256s/iter; left time: 1006.0398s
Epoch: 5 cost time: 11.415368556976318
Epoch: 5, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.125 Vali Acc: 0.981 Test Loss: 0.125 Test Acc: 0.981
Validation loss decreased (-0.969074 --> -0.980899).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1099s/iter; left time: 4301.5732s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 1113.8807s
	iters: 300, epoch: 6 | loss: 0.0000002
	speed: 0.0279s/iter; left time: 1086.1984s
	iters: 400, epoch: 6 | loss: 0.0000002
	speed: 0.0291s/iter; left time: 1129.6787s
Epoch: 6 cost time: 12.164020538330078
Epoch: 6, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.361 Vali Acc: 0.965 Test Loss: 0.361 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000002
	speed: 0.1062s/iter; left time: 4112.2840s
	iters: 200, epoch: 7 | loss: 0.1975391
	speed: 0.0291s/iter; left time: 1122.9639s
	iters: 300, epoch: 7 | loss: 0.0001079
	speed: 0.0291s/iter; left time: 1121.1701s
	iters: 400, epoch: 7 | loss: 0.0002140
	speed: 0.0293s/iter; left time: 1124.9798s
Epoch: 7 cost time: 12.558307647705078
Epoch: 7, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.363 Vali Acc: 0.971 Test Loss: 0.363 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.0966s/iter; left time: 3700.7066s
	iters: 200, epoch: 8 | loss: 0.0000088
	speed: 0.0280s/iter; left time: 1070.0475s
	iters: 300, epoch: 8 | loss: 0.0227314
	speed: 0.0280s/iter; left time: 1066.8562s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 1047.1443s
Epoch: 8 cost time: 11.797151327133179
Epoch: 8, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.739 Vali Acc: 0.956 Test Loss: 0.739 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0906689
	speed: 0.0919s/iter; left time: 3482.3462s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 1073.3738s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 1047.6047s
	iters: 400, epoch: 9 | loss: 0.8940939
	speed: 0.0276s/iter; left time: 1037.2817s
Epoch: 9 cost time: 11.930705070495605
Epoch: 9, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 3552.7860s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 1064.9510s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 1076.3938s
	iters: 400, epoch: 10 | loss: 2.2088561
	speed: 0.0274s/iter; left time: 1020.1768s
Epoch: 10 cost time: 12.183228015899658
Epoch: 10, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.387 Vali Acc: 0.967 Test Loss: 0.387 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0897s/iter; left time: 3325.5605s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 1038.2402s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 1051.8006s
	iters: 400, epoch: 11 | loss: 0.0000013
	speed: 0.0282s/iter; left time: 1037.0954s
Epoch: 11 cost time: 12.18738865852356
Epoch: 11, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.382 Vali Acc: 0.973 Test Loss: 0.382 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0992s/iter; left time: 3636.7280s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 1028.5670s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 1007.6180s
	iters: 400, epoch: 12 | loss: 0.0056620
	speed: 0.0273s/iter; left time: 993.0858s
Epoch: 12 cost time: 11.920645475387573
Epoch: 12, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.379 Vali Acc: 0.977 Test Loss: 0.379 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1010s/iter; left time: 3659.4355s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 990.6125s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 948.0757s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.0272s/iter; left time: 976.6899s
Epoch: 13 cost time: 11.526885986328125
Epoch: 13, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.591 Vali Acc: 0.963 Test Loss: 0.591 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0921s/iter; left time: 3300.7339s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 956.6290s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 954.2965s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 946.0832s
Epoch: 14 cost time: 11.606449604034424
Epoch: 14, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.302 Vali Acc: 0.979 Test Loss: 0.302 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0930s/iter; left time: 3292.4859s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 945.1718s
	iters: 300, epoch: 15 | loss: 1.4016734
	speed: 0.0265s/iter; left time: 932.5345s
	iters: 400, epoch: 15 | loss: 0.0006898
	speed: 0.0269s/iter; left time: 943.5617s
Epoch: 15 cost time: 11.443458080291748
Epoch: 15, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.499 Vali Acc: 0.969 Test Loss: 0.499 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 1564238
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2600064
	speed: 0.0487s/iter; left time: 2006.3978s
	iters: 200, epoch: 1 | loss: 0.0703956
	speed: 0.0255s/iter; left time: 1048.8450s
	iters: 300, epoch: 1 | loss: 0.0422963
	speed: 0.0291s/iter; left time: 1193.2853s
	iters: 400, epoch: 1 | loss: 0.0679026
	speed: 0.0282s/iter; left time: 1151.6462s
Epoch: 1 cost time: 13.596320152282715
Epoch: 1, Steps: 413 | Train Loss: 0.281 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
Validation loss decreased (inf --> -0.967256).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0010087
	speed: 0.1044s/iter; left time: 4259.3331s
	iters: 200, epoch: 2 | loss: 0.0001626
	speed: 0.0268s/iter; left time: 1091.8997s
	iters: 300, epoch: 2 | loss: 0.8002894
	speed: 0.0268s/iter; left time: 1087.0911s
	iters: 400, epoch: 2 | loss: 0.0236774
	speed: 0.0277s/iter; left time: 1123.4417s
Epoch: 2 cost time: 11.71375298500061
Epoch: 2, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0728019
	speed: 0.0954s/iter; left time: 3849.9081s
	iters: 200, epoch: 3 | loss: 0.0000094
	speed: 0.0281s/iter; left time: 1131.0218s
	iters: 300, epoch: 3 | loss: 0.0018111
	speed: 0.0268s/iter; left time: 1075.9866s
	iters: 400, epoch: 3 | loss: 0.0020833
	speed: 0.0273s/iter; left time: 1093.8546s
Epoch: 3 cost time: 11.660082340240479
Epoch: 3, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
Validation loss decreased (-0.967256 --> -0.973168).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0007758
	speed: 0.0915s/iter; left time: 3657.6268s
	iters: 200, epoch: 4 | loss: 0.1399570
	speed: 0.0278s/iter; left time: 1109.1780s
	iters: 300, epoch: 4 | loss: 0.0000010
	speed: 0.0257s/iter; left time: 1020.8306s
	iters: 400, epoch: 4 | loss: 0.0000004
	speed: 0.0269s/iter; left time: 1065.9477s
Epoch: 4 cost time: 11.504153490066528
Epoch: 4, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.317 Vali Acc: 0.965 Test Loss: 0.317 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0103884
	speed: 0.0925s/iter; left time: 3657.2498s
	iters: 200, epoch: 5 | loss: 0.0028853
	speed: 0.0268s/iter; left time: 1058.7186s
	iters: 300, epoch: 5 | loss: 0.1276684
	speed: 0.0277s/iter; left time: 1089.7757s
	iters: 400, epoch: 5 | loss: 0.2056955
	speed: 0.0293s/iter; left time: 1148.3675s
Epoch: 5 cost time: 11.846941709518433
Epoch: 5, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.340 Vali Acc: 0.965 Test Loss: 0.340 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0001046
	speed: 0.1111s/iter; left time: 4349.8748s
	iters: 200, epoch: 6 | loss: 0.0002678
	speed: 0.0272s/iter; left time: 1063.6989s
	iters: 300, epoch: 6 | loss: 0.0000001
	speed: 0.0267s/iter; left time: 1040.2535s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 1027.8174s
Epoch: 6 cost time: 11.636655569076538
Epoch: 6, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.397 Vali Acc: 0.965 Test Loss: 0.397 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000132
	speed: 0.1008s/iter; left time: 3903.0755s
	iters: 200, epoch: 7 | loss: 0.0154105
	speed: 0.0265s/iter; left time: 1023.0796s
	iters: 300, epoch: 7 | loss: 0.3482017
	speed: 0.0270s/iter; left time: 1041.4502s
	iters: 400, epoch: 7 | loss: 0.0003238
	speed: 0.0265s/iter; left time: 1017.0796s
Epoch: 7 cost time: 11.630039691925049
Epoch: 7, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.194 Vali Acc: 0.983 Test Loss: 0.194 Test Acc: 0.983
Validation loss decreased (-0.973168 --> -0.982717).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4118791
	speed: 0.0896s/iter; left time: 3432.7913s
	iters: 200, epoch: 8 | loss: 0.0000020
	speed: 0.0265s/iter; left time: 1012.9955s
	iters: 300, epoch: 8 | loss: 0.0086801
	speed: 0.0258s/iter; left time: 985.0430s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 983.2078s
Epoch: 8 cost time: 11.14629578590393
Epoch: 8, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000050
	speed: 0.0872s/iter; left time: 3304.8419s
	iters: 200, epoch: 9 | loss: 0.0000013
	speed: 0.0253s/iter; left time: 956.5684s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 973.8523s
	iters: 400, epoch: 9 | loss: 0.4606205
	speed: 0.0263s/iter; left time: 989.6964s
Epoch: 9 cost time: 11.077754497528076
Epoch: 9, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.360 Vali Acc: 0.973 Test Loss: 0.360 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0882s/iter; left time: 3306.1481s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 981.9407s
	iters: 300, epoch: 10 | loss: 0.0012984
	speed: 0.0258s/iter; left time: 962.0553s
	iters: 400, epoch: 10 | loss: 0.0052022
	speed: 0.0267s/iter; left time: 991.3285s
Epoch: 10 cost time: 11.197532653808594
Epoch: 10, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.289 Vali Acc: 0.980 Test Loss: 0.289 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0537411
	speed: 0.0998s/iter; left time: 3701.4905s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 1056.4062s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0292s/iter; left time: 1076.2152s
	iters: 400, epoch: 11 | loss: 0.3129807
	speed: 0.0275s/iter; left time: 1012.0935s
Epoch: 11 cost time: 12.133111953735352
Epoch: 11, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.317 Vali Acc: 0.978 Test Loss: 0.317 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0970s/iter; left time: 3555.2870s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 1043.4252s
	iters: 300, epoch: 12 | loss: 0.0000006
	speed: 0.0278s/iter; left time: 1013.7348s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 1003.9511s
Epoch: 12 cost time: 11.940995931625366
Epoch: 12, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.212 Vali Acc: 0.980 Test Loss: 0.212 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0249725
	speed: 0.0953s/iter; left time: 3454.8229s
	iters: 200, epoch: 13 | loss: 0.7998812
	speed: 0.0279s/iter; left time: 1006.7428s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 970.1924s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 934.0179s
Epoch: 13 cost time: 11.484989166259766
Epoch: 13, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.314 Vali Acc: 0.979 Test Loss: 0.314 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0044285
	speed: 0.0908s/iter; left time: 3252.4859s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 948.1331s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 949.0229s
	iters: 400, epoch: 14 | loss: 0.0000261
	speed: 0.0264s/iter; left time: 937.6825s
Epoch: 14 cost time: 11.412990808486938
Epoch: 14, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.606 Vali Acc: 0.967 Test Loss: 0.606 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 3164.9514s
	iters: 200, epoch: 15 | loss: 0.0001987
	speed: 0.0265s/iter; left time: 935.0685s
	iters: 300, epoch: 15 | loss: 1.5408521
	speed: 0.0252s/iter; left time: 888.5587s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 914.7066s
Epoch: 15 cost time: 11.20468521118164
Epoch: 15, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.411 Vali Acc: 0.978 Test Loss: 0.411 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 3194.9566s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 956.3840s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 953.5298s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 954.1637s
Epoch: 16 cost time: 11.790430784225464
Epoch: 16, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.439 Vali Acc: 0.975 Test Loss: 0.439 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0990s/iter; left time: 3425.0587s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 929.6394s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 960.8126s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 888.3833s
Epoch: 17 cost time: 11.423829078674316
Epoch: 17, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.407 Vali Acc: 0.977 Test Loss: 0.407 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 1564238
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2434441
	speed: 0.0461s/iter; left time: 1900.6877s
	iters: 200, epoch: 1 | loss: 0.1116978
	speed: 0.0254s/iter; left time: 1041.9580s
	iters: 300, epoch: 1 | loss: 0.2550958
	speed: 0.0251s/iter; left time: 1030.7298s
	iters: 400, epoch: 1 | loss: 0.0168575
	speed: 0.0250s/iter; left time: 1022.9817s
Epoch: 1 cost time: 12.552589654922485
Epoch: 1, Steps: 413 | Train Loss: 0.295 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (inf --> -0.969985).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0028542
	speed: 0.0857s/iter; left time: 3497.2765s
	iters: 200, epoch: 2 | loss: 0.0024798
	speed: 0.0256s/iter; left time: 1040.9831s
	iters: 300, epoch: 2 | loss: 0.2633627
	speed: 0.0265s/iter; left time: 1073.5739s
	iters: 400, epoch: 2 | loss: 0.0436070
	speed: 0.0258s/iter; left time: 1045.6476s
Epoch: 2 cost time: 10.997069120407104
Epoch: 2, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
Validation loss decreased (-0.969985 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0761325
	speed: 0.0880s/iter; left time: 3554.2778s
	iters: 200, epoch: 3 | loss: 0.0016619
	speed: 0.0265s/iter; left time: 1065.5026s
	iters: 300, epoch: 3 | loss: 0.0075393
	speed: 0.0261s/iter; left time: 1048.5288s
	iters: 400, epoch: 3 | loss: 0.0000762
	speed: 0.0262s/iter; left time: 1048.9309s
Epoch: 3 cost time: 11.394416093826294
Epoch: 3, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.181 Vali Acc: 0.969 Test Loss: 0.181 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0010762
	speed: 0.0959s/iter; left time: 3830.6530s
	iters: 200, epoch: 4 | loss: 0.0000003
	speed: 0.0273s/iter; left time: 1089.0004s
	iters: 300, epoch: 4 | loss: 0.0512697
	speed: 0.0269s/iter; left time: 1070.0552s
	iters: 400, epoch: 4 | loss: 0.3271891
	speed: 0.0280s/iter; left time: 1111.7693s
Epoch: 4 cost time: 11.630900621414185
Epoch: 4, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.459 Vali Acc: 0.944 Test Loss: 0.459 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000001
	speed: 0.0977s/iter; left time: 3862.3178s
	iters: 200, epoch: 5 | loss: 0.0000464
	speed: 0.0274s/iter; left time: 1081.4998s
	iters: 300, epoch: 5 | loss: 0.0000049
	speed: 0.0264s/iter; left time: 1037.1071s
	iters: 400, epoch: 5 | loss: 0.0000015
	speed: 0.0267s/iter; left time: 1048.8407s
Epoch: 5 cost time: 11.59140396118164
Epoch: 5, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.249 Vali Acc: 0.974 Test Loss: 0.249 Test Acc: 0.974
Validation loss decreased (-0.972259 --> -0.973622).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2756566
	speed: 0.0864s/iter; left time: 3383.2827s
	iters: 200, epoch: 6 | loss: 0.0000001
	speed: 0.0246s/iter; left time: 958.5980s
	iters: 300, epoch: 6 | loss: 0.3037059
	speed: 0.0247s/iter; left time: 961.4763s
	iters: 400, epoch: 6 | loss: 0.0000033
	speed: 0.0251s/iter; left time: 974.6350s
Epoch: 6 cost time: 10.587295055389404
Epoch: 6, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.364 Vali Acc: 0.958 Test Loss: 0.364 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000065
	speed: 0.0896s/iter; left time: 3467.7215s
	iters: 200, epoch: 7 | loss: 0.0109604
	speed: 0.0254s/iter; left time: 979.2529s
	iters: 300, epoch: 7 | loss: 0.2229278
	speed: 0.0253s/iter; left time: 974.5285s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.0253s/iter; left time: 973.3954s
Epoch: 7 cost time: 10.76237440109253
Epoch: 7, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.336 Vali Acc: 0.966 Test Loss: 0.336 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000132
	speed: 0.0879s/iter; left time: 3366.5414s
	iters: 200, epoch: 8 | loss: 0.0154225
	speed: 0.0242s/iter; left time: 922.7809s
	iters: 300, epoch: 8 | loss: 0.8275132
	speed: 0.0251s/iter; left time: 955.0937s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 1010.6160s
Epoch: 8 cost time: 10.742483615875244
Epoch: 8, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.421 Vali Acc: 0.970 Test Loss: 0.421 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000004
	speed: 0.0894s/iter; left time: 3386.2075s
	iters: 200, epoch: 9 | loss: 0.0014557
	speed: 0.0262s/iter; left time: 990.0853s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 974.6574s
	iters: 400, epoch: 9 | loss: 0.0000041
	speed: 0.0267s/iter; left time: 1005.4089s
Epoch: 9 cost time: 11.15358281135559
Epoch: 9, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.525 Vali Acc: 0.960 Test Loss: 0.525 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0959s/iter; left time: 3594.7414s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 923.7949s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 958.2757s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 965.3014s
Epoch: 10 cost time: 10.976610898971558
Epoch: 10, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.459 Vali Acc: 0.966 Test Loss: 0.459 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0409701
	speed: 0.0933s/iter; left time: 3459.6699s
	iters: 200, epoch: 11 | loss: 0.0001467
	speed: 0.0267s/iter; left time: 987.8677s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0243s/iter; left time: 896.9246s
	iters: 400, epoch: 11 | loss: 0.0559120
	speed: 0.0258s/iter; left time: 949.0561s
Epoch: 11 cost time: 10.96110725402832
Epoch: 11, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.634 Vali Acc: 0.965 Test Loss: 0.634 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0260682
	speed: 0.0862s/iter; left time: 3159.1906s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 958.7847s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 971.3385s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 1004.7490s
Epoch: 12 cost time: 11.381769180297852
Epoch: 12, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.269 Vali Acc: 0.979 Test Loss: 0.269 Test Acc: 0.979
Validation loss decreased (-0.973622 --> -0.979079).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0843s/iter; left time: 3056.0087s
	iters: 200, epoch: 13 | loss: 0.0000044
	speed: 0.0251s/iter; left time: 908.7732s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.0253s/iter; left time: 912.7828s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 913.8887s
Epoch: 13 cost time: 10.836231231689453
Epoch: 13, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.386 Vali Acc: 0.973 Test Loss: 0.386 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0651750
	speed: 0.0886s/iter; left time: 3173.4355s
	iters: 200, epoch: 14 | loss: 0.0070167
	speed: 0.0263s/iter; left time: 940.5427s
	iters: 300, epoch: 14 | loss: 0.0020984
	speed: 0.0269s/iter; left time: 956.9405s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 937.9184s
Epoch: 14 cost time: 11.261954069137573
Epoch: 14, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.170 Vali Acc: 0.985 Test Loss: 0.170 Test Acc: 0.985
Validation loss decreased (-0.979079 --> -0.984537).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1050s/iter; left time: 3717.7580s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 960.5189s
	iters: 300, epoch: 15 | loss: 1.7023075
	speed: 0.0275s/iter; left time: 968.0799s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 946.4692s
Epoch: 15 cost time: 11.461348533630371
Epoch: 15, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.440 Vali Acc: 0.970 Test Loss: 0.440 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0986s/iter; left time: 3450.8922s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 909.7928s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 869.5655s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 910.1827s
Epoch: 16 cost time: 11.024106740951538
Epoch: 16, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.387 Vali Acc: 0.977 Test Loss: 0.387 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0938s/iter; left time: 3246.1563s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 857.4962s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 877.7428s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 852.9008s
Epoch: 17 cost time: 10.837189435958862
Epoch: 17, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.452 Vali Acc: 0.975 Test Loss: 0.452 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0884s/iter; left time: 3020.5410s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 871.7607s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 833.8739s
	iters: 400, epoch: 18 | loss: 1.6605104
	speed: 0.0258s/iter; left time: 874.6352s
Epoch: 18 cost time: 10.75828504562378
Epoch: 18, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.493 Vali Acc: 0.979 Test Loss: 0.493 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 2857.1779s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 851.1170s
	iters: 300, epoch: 19 | loss: 0.0000002
	speed: 0.0254s/iter; left time: 851.8233s
	iters: 400, epoch: 19 | loss: 0.0002805
	speed: 0.0240s/iter; left time: 804.6505s
Epoch: 19 cost time: 10.659007549285889
Epoch: 19, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.673 Vali Acc: 0.967 Test Loss: 0.673 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0873s/iter; left time: 2912.0777s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 853.5012s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 874.4576s
	iters: 400, epoch: 20 | loss: 0.0000053
	speed: 0.0268s/iter; left time: 885.0471s
Epoch: 20 cost time: 11.156930685043335
Epoch: 20, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.306 Vali Acc: 0.975 Test Loss: 0.306 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000031
	speed: 0.0938s/iter; left time: 3091.1824s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 820.7099s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 860.5501s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 840.6289s
Epoch: 21 cost time: 11.040424823760986
Epoch: 21, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.608 Vali Acc: 0.971 Test Loss: 0.608 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0978s/iter; left time: 3180.3603s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 840.5515s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 835.4854s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 821.9149s
Epoch: 22 cost time: 11.127318382263184
Epoch: 22, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.461 Vali Acc: 0.977 Test Loss: 0.461 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0895s/iter; left time: 2873.3359s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 826.8904s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 815.9296s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 816.0008s
Epoch: 23 cost time: 11.072469711303711
Epoch: 23, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.431 Vali Acc: 0.980 Test Loss: 0.431 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0883s/iter; left time: 2798.2020s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 819.6042s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 810.8415s
	iters: 400, epoch: 24 | loss: 0.0004000
	speed: 0.0258s/iter; left time: 808.7337s
Epoch: 24 cost time: 11.065624237060547
Epoch: 24, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.344 Vali Acc: 0.981 Test Loss: 0.344 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 1564238
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2976170
	speed: 0.0451s/iter; left time: 1858.5344s
	iters: 200, epoch: 1 | loss: 0.0593987
	speed: 0.0261s/iter; left time: 1071.7471s
	iters: 300, epoch: 1 | loss: 0.2974724
	speed: 0.0263s/iter; left time: 1077.3767s
	iters: 400, epoch: 1 | loss: 0.1741737
	speed: 0.0252s/iter; left time: 1032.4555s
Epoch: 1 cost time: 12.677547931671143
Epoch: 1, Steps: 413 | Train Loss: 0.331 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (inf --> -0.969530).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0045476
	speed: 0.1017s/iter; left time: 4147.2436s
	iters: 200, epoch: 2 | loss: 0.0008453
	speed: 0.0269s/iter; left time: 1094.8688s
	iters: 300, epoch: 2 | loss: 0.2508112
	speed: 0.0281s/iter; left time: 1138.8702s
	iters: 400, epoch: 2 | loss: 0.3649926
	speed: 0.0273s/iter; left time: 1106.1145s
Epoch: 2 cost time: 11.83682656288147
Epoch: 2, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0242831
	speed: 0.0963s/iter; left time: 3888.3150s
	iters: 200, epoch: 3 | loss: 0.0362579
	speed: 0.0262s/iter; left time: 1056.0048s
	iters: 300, epoch: 3 | loss: 0.0004520
	speed: 0.0259s/iter; left time: 1039.4166s
	iters: 400, epoch: 3 | loss: 0.4823481
	speed: 0.0262s/iter; left time: 1051.6964s
Epoch: 3 cost time: 11.102113962173462
Epoch: 3, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0001457
	speed: 0.0878s/iter; left time: 3509.7392s
	iters: 200, epoch: 4 | loss: 0.0199420
	speed: 0.0244s/iter; left time: 974.2339s
	iters: 300, epoch: 4 | loss: 0.0062286
	speed: 0.0264s/iter; left time: 1049.4235s
	iters: 400, epoch: 4 | loss: 0.0000094
	speed: 0.0255s/iter; left time: 1012.3116s
Epoch: 4 cost time: 10.851277589797974
Epoch: 4, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.233 Vali Acc: 0.963 Test Loss: 0.233 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0005636
	speed: 0.0925s/iter; left time: 3656.5361s
	iters: 200, epoch: 5 | loss: 0.0000191
	speed: 0.0260s/iter; left time: 1027.6134s
	iters: 300, epoch: 5 | loss: 0.6746619
	speed: 0.0265s/iter; left time: 1042.6165s
	iters: 400, epoch: 5 | loss: 0.0336469
	speed: 0.0279s/iter; left time: 1094.9631s
Epoch: 5 cost time: 11.322728872299194
Epoch: 5, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.326 Vali Acc: 0.969 Test Loss: 0.326 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.6346612
	speed: 0.1070s/iter; left time: 4186.1780s
	iters: 200, epoch: 6 | loss: 0.0000087
	speed: 0.0254s/iter; left time: 991.9952s
	iters: 300, epoch: 6 | loss: 0.0000004
	speed: 0.0274s/iter; left time: 1066.5557s
	iters: 400, epoch: 6 | loss: 0.0000008
	speed: 0.0282s/iter; left time: 1096.0370s
Epoch: 6 cost time: 11.578319311141968
Epoch: 6, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.278 Vali Acc: 0.977 Test Loss: 0.278 Test Acc: 0.977
Validation loss decreased (-0.969530 --> -0.977260).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0169455
	speed: 0.0998s/iter; left time: 3862.9516s
	iters: 200, epoch: 7 | loss: 0.2022263
	speed: 0.0273s/iter; left time: 1055.7112s
	iters: 300, epoch: 7 | loss: 0.4597162
	speed: 0.0280s/iter; left time: 1079.3908s
	iters: 400, epoch: 7 | loss: 1.3331411
	speed: 0.0268s/iter; left time: 1030.0247s
Epoch: 7 cost time: 11.717946767807007
Epoch: 7, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.0955s/iter; left time: 3660.4960s
	iters: 200, epoch: 8 | loss: 0.0504825
	speed: 0.0270s/iter; left time: 1031.4076s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 970.1512s
	iters: 400, epoch: 8 | loss: 0.0003757
	speed: 0.0257s/iter; left time: 975.7920s
Epoch: 8 cost time: 10.993739604949951
Epoch: 8, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.301 Vali Acc: 0.973 Test Loss: 0.301 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000235
	speed: 0.0886s/iter; left time: 3356.3808s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 959.2441s
	iters: 300, epoch: 9 | loss: 0.0001453
	speed: 0.0269s/iter; left time: 1015.5332s
	iters: 400, epoch: 9 | loss: 1.8205553
	speed: 0.0268s/iter; left time: 1009.3852s
Epoch: 9 cost time: 11.25612759590149
Epoch: 9, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.333 Vali Acc: 0.966 Test Loss: 0.333 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0858s/iter; left time: 3215.4864s
	iters: 200, epoch: 10 | loss: 0.0000070
	speed: 0.0241s/iter; left time: 901.7871s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 937.2084s
	iters: 400, epoch: 10 | loss: 0.0050122
	speed: 0.0247s/iter; left time: 919.0043s
Epoch: 10 cost time: 10.795882225036621
Epoch: 10, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.405 Vali Acc: 0.971 Test Loss: 0.405 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0891s/iter; left time: 3301.4179s
	iters: 200, epoch: 11 | loss: 0.0001891
	speed: 0.0266s/iter; left time: 984.8674s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 937.2617s
	iters: 400, epoch: 11 | loss: 0.0018359
	speed: 0.0259s/iter; left time: 952.0376s
Epoch: 11 cost time: 10.896368741989136
Epoch: 11, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.186 Vali Acc: 0.984 Test Loss: 0.186 Test Acc: 0.984
Validation loss decreased (-0.977260 --> -0.984082).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0982s/iter; left time: 3598.4510s
	iters: 200, epoch: 12 | loss: 0.0005259
	speed: 0.0251s/iter; left time: 918.5544s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 951.6197s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 963.7464s
Epoch: 12 cost time: 11.322070598602295
Epoch: 12, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.570 Vali Acc: 0.964 Test Loss: 0.570 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.0962s/iter; left time: 3487.7717s
	iters: 200, epoch: 13 | loss: 0.0058918
	speed: 0.0259s/iter; left time: 937.1326s
	iters: 300, epoch: 13 | loss: 0.3149273
	speed: 0.0255s/iter; left time: 919.7681s
	iters: 400, epoch: 13 | loss: 0.0001879
	speed: 0.0248s/iter; left time: 891.2303s
Epoch: 13 cost time: 10.904792547225952
Epoch: 13, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.575 Vali Acc: 0.954 Test Loss: 0.575 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 3056.9808s
	iters: 200, epoch: 14 | loss: 0.4415554
	speed: 0.0247s/iter; left time: 881.3129s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 898.4451s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 904.4955s
Epoch: 14 cost time: 10.743191719055176
Epoch: 14, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.292 Vali Acc: 0.980 Test Loss: 0.292 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0887s/iter; left time: 3142.4450s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 873.1064s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 919.9275s
	iters: 400, epoch: 15 | loss: 0.0000145
	speed: 0.0254s/iter; left time: 890.2678s
Epoch: 15 cost time: 10.842064142227173
Epoch: 15, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.508 Vali Acc: 0.974 Test Loss: 0.508 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0250705
	speed: 0.0908s/iter; left time: 3178.9161s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 915.9912s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 875.3106s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 973.0908s
Epoch: 16 cost time: 11.295279264450073
Epoch: 16, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.437 Vali Acc: 0.966 Test Loss: 0.437 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0993s/iter; left time: 3433.8846s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0271s/iter; left time: 933.2323s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 999.8580s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 897.5940s
Epoch: 17 cost time: 11.719795942306519
Epoch: 17, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.247 Vali Acc: 0.985 Test Loss: 0.247 Test Acc: 0.985
Validation loss decreased (-0.984082 --> -0.984536).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1051s/iter; left time: 3593.2979s
	iters: 200, epoch: 18 | loss: 0.0000136
	speed: 0.0275s/iter; left time: 936.5355s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 932.1280s
	iters: 400, epoch: 18 | loss: 0.0002434
	speed: 0.0264s/iter; left time: 892.9199s
Epoch: 18 cost time: 11.570448637008667
Epoch: 18, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.435 Vali Acc: 0.979 Test Loss: 0.435 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000117
	speed: 0.0912s/iter; left time: 3080.0469s
	iters: 200, epoch: 19 | loss: 0.0000255
	speed: 0.0272s/iter; left time: 914.5820s
	iters: 300, epoch: 19 | loss: 0.9940369
	speed: 0.0260s/iter; left time: 871.8392s
	iters: 400, epoch: 19 | loss: 1.5356919
	speed: 0.0262s/iter; left time: 877.3629s
Epoch: 19 cost time: 11.267216682434082
Epoch: 19, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.458 Vali Acc: 0.973 Test Loss: 0.458 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 3039.0027s
	iters: 200, epoch: 20 | loss: 0.0019762
	speed: 0.0254s/iter; left time: 846.3024s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 845.3027s
	iters: 400, epoch: 20 | loss: 0.5287836
	speed: 0.0259s/iter; left time: 856.9427s
Epoch: 20 cost time: 10.95846962928772
Epoch: 20, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.555 Vali Acc: 0.974 Test Loss: 0.555 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0910s/iter; left time: 2997.3547s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.0263s/iter; left time: 863.3918s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 841.1288s
	iters: 400, epoch: 21 | loss: 1.9931004
	speed: 0.0261s/iter; left time: 852.4900s
Epoch: 21 cost time: 11.023817300796509
Epoch: 21, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.500 Vali Acc: 0.977 Test Loss: 0.500 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0004448
	speed: 0.0983s/iter; left time: 3197.6750s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 860.6760s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 834.8859s
	iters: 400, epoch: 22 | loss: 0.0905000
	speed: 0.0257s/iter; left time: 828.9115s
Epoch: 22 cost time: 11.238425731658936
Epoch: 22, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.405 Vali Acc: 0.973 Test Loss: 0.405 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0950s/iter; left time: 3049.8795s
	iters: 200, epoch: 23 | loss: 0.0000002
	speed: 0.0273s/iter; left time: 874.5372s
	iters: 300, epoch: 23 | loss: 1.1704862
	speed: 0.0262s/iter; left time: 836.8193s
	iters: 400, epoch: 23 | loss: 0.0000217
	speed: 0.0272s/iter; left time: 866.8804s
Epoch: 23 cost time: 11.54829716682434
Epoch: 23, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.562 Vali Acc: 0.973 Test Loss: 0.562 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000059
	speed: 0.0976s/iter; left time: 3093.6770s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 778.0613s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 812.9417s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 798.0666s
Epoch: 24 cost time: 11.030730485916138
Epoch: 24, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.709 Vali Acc: 0.979 Test Loss: 0.709 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0182717
	speed: 0.0885s/iter; left time: 2768.8873s
	iters: 200, epoch: 25 | loss: 0.0000019
	speed: 0.0243s/iter; left time: 756.8081s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 810.5505s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 794.7296s
Epoch: 25 cost time: 10.79525899887085
Epoch: 25, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.488 Vali Acc: 0.980 Test Loss: 0.488 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.0870s/iter; left time: 2686.9707s
	iters: 200, epoch: 26 | loss: 0.8818499
	speed: 0.0250s/iter; left time: 769.3321s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 792.6290s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 794.3818s
Epoch: 26 cost time: 10.916404008865356
Epoch: 26, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.822 Vali Acc: 0.969 Test Loss: 0.822 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.0874s/iter; left time: 2663.2284s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 816.7444s
	iters: 300, epoch: 27 | loss: 1.3755035
	speed: 0.0272s/iter; left time: 822.4914s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 816.3685s
Epoch: 27 cost time: 11.615309953689575
Epoch: 27, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.798 Vali Acc: 0.976 Test Loss: 0.798 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 1564238
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0198801
	speed: 0.0456s/iter; left time: 1877.8938s
	iters: 200, epoch: 1 | loss: 0.0517868
	speed: 0.0264s/iter; left time: 1085.2750s
	iters: 300, epoch: 1 | loss: 0.3626852
	speed: 0.0239s/iter; left time: 978.6768s
	iters: 400, epoch: 1 | loss: 0.2084025
	speed: 0.0262s/iter; left time: 1072.5025s
Epoch: 1 cost time: 12.616328001022339
Epoch: 1, Steps: 413 | Train Loss: 0.292 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
Validation loss decreased (inf --> -0.963618).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1329309
	speed: 0.0922s/iter; left time: 3758.9950s
	iters: 200, epoch: 2 | loss: 0.0001315
	speed: 0.0268s/iter; left time: 1089.6754s
	iters: 300, epoch: 2 | loss: 0.6377774
	speed: 0.0265s/iter; left time: 1075.5814s
	iters: 400, epoch: 2 | loss: 0.2121916
	speed: 0.0272s/iter; left time: 1102.0571s
Epoch: 2 cost time: 11.520349025726318
Epoch: 2, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.963618 --> -0.983173).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000103
	speed: 0.0914s/iter; left time: 3688.6522s
	iters: 200, epoch: 3 | loss: 0.0001998
	speed: 0.0264s/iter; left time: 1063.7442s
	iters: 300, epoch: 3 | loss: 0.0090224
	speed: 0.0266s/iter; left time: 1067.8286s
	iters: 400, epoch: 3 | loss: 1.6203891
	speed: 0.0275s/iter; left time: 1102.5840s
Epoch: 3 cost time: 11.410859107971191
Epoch: 3, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1172927
	speed: 0.0929s/iter; left time: 3714.0533s
	iters: 200, epoch: 4 | loss: 0.0000002
	speed: 0.0270s/iter; left time: 1074.7433s
	iters: 300, epoch: 4 | loss: 0.0000111
	speed: 0.0287s/iter; left time: 1142.2596s
	iters: 400, epoch: 4 | loss: 0.0056091
	speed: 0.0290s/iter; left time: 1149.0657s
Epoch: 4 cost time: 11.83001971244812
Epoch: 4, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0154786
	speed: 0.1037s/iter; left time: 4101.4455s
	iters: 200, epoch: 5 | loss: 0.0012170
	speed: 0.0270s/iter; left time: 1064.7667s
	iters: 300, epoch: 5 | loss: 0.0000039
	speed: 0.0255s/iter; left time: 1003.4025s
	iters: 400, epoch: 5 | loss: 0.0009304
	speed: 0.0271s/iter; left time: 1063.1058s
Epoch: 5 cost time: 11.467118978500366
Epoch: 5, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.289 Vali Acc: 0.968 Test Loss: 0.289 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000004
	speed: 0.1000s/iter; left time: 3914.8097s
	iters: 200, epoch: 6 | loss: 0.0000553
	speed: 0.0275s/iter; left time: 1075.0489s
	iters: 300, epoch: 6 | loss: 0.2412318
	speed: 0.0270s/iter; left time: 1051.3028s
	iters: 400, epoch: 6 | loss: 0.0002371
	speed: 0.0245s/iter; left time: 951.3007s
Epoch: 6 cost time: 11.355413436889648
Epoch: 6, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.375 Vali Acc: 0.961 Test Loss: 0.375 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 3429.7970s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0270s/iter; left time: 1043.4491s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 1099.7700s
	iters: 400, epoch: 7 | loss: 0.0000073
	speed: 0.0271s/iter; left time: 1040.1476s
Epoch: 7 cost time: 11.689186573028564
Epoch: 7, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.341 Vali Acc: 0.971 Test Loss: 0.341 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7026058
	speed: 0.0864s/iter; left time: 3309.2068s
	iters: 200, epoch: 8 | loss: 0.0000419
	speed: 0.0277s/iter; left time: 1058.8568s
	iters: 300, epoch: 8 | loss: 0.0000124
	speed: 0.0273s/iter; left time: 1039.2341s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 1050.1001s
Epoch: 8 cost time: 11.728511095046997
Epoch: 8, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.240 Vali Acc: 0.978 Test Loss: 0.240 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0003171
	speed: 0.0899s/iter; left time: 3407.4613s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 1041.3536s
	iters: 300, epoch: 9 | loss: 0.0000008
	speed: 0.0274s/iter; left time: 1031.4751s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 1042.8972s
Epoch: 9 cost time: 11.820142030715942
Epoch: 9, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.442 Vali Acc: 0.974 Test Loss: 0.442 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000094
	speed: 0.0962s/iter; left time: 3605.7490s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 1065.2711s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 1051.8931s
	iters: 400, epoch: 10 | loss: 0.0000005
	speed: 0.0277s/iter; left time: 1029.8662s
Epoch: 10 cost time: 11.982256889343262
Epoch: 10, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.354 Vali Acc: 0.975 Test Loss: 0.354 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0423854
	speed: 0.0931s/iter; left time: 3450.7065s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0288s/iter; left time: 1065.8542s
	iters: 300, epoch: 11 | loss: 0.0000021
	speed: 0.0289s/iter; left time: 1066.6793s
	iters: 400, epoch: 11 | loss: 0.0022527
	speed: 0.0269s/iter; left time: 988.8190s
Epoch: 11 cost time: 11.911699056625366
Epoch: 11, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.404 Vali Acc: 0.969 Test Loss: 0.404 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0955s/iter; left time: 3501.8193s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 944.7104s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 969.1167s
	iters: 400, epoch: 12 | loss: 0.0000007
	speed: 0.0266s/iter; left time: 968.8752s
Epoch: 12 cost time: 11.303476572036743
Epoch: 12, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.573 Vali Acc: 0.977 Test Loss: 0.573 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 1302094
model size : 14.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0222030
	speed: 0.0438s/iter; left time: 1804.2985s
	iters: 200, epoch: 1 | loss: 0.0609593
	speed: 0.0252s/iter; left time: 1036.3853s
	iters: 300, epoch: 1 | loss: 0.2719942
	speed: 0.0268s/iter; left time: 1098.3412s
	iters: 400, epoch: 1 | loss: 0.4949095
	speed: 0.0265s/iter; left time: 1082.4633s
Epoch: 1 cost time: 12.661863327026367
Epoch: 1, Steps: 413 | Train Loss: 0.289 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
Validation loss decreased (inf --> -0.965438).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0932776
	speed: 0.0944s/iter; left time: 3849.7373s
	iters: 200, epoch: 2 | loss: 0.0002388
	speed: 0.0268s/iter; left time: 1090.4483s
	iters: 300, epoch: 2 | loss: 0.0044226
	speed: 0.0287s/iter; left time: 1165.5998s
	iters: 400, epoch: 2 | loss: 0.3118164
	speed: 0.0291s/iter; left time: 1178.9200s
Epoch: 2 cost time: 12.00894284248352
Epoch: 2, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.292 Vali Acc: 0.945 Test Loss: 0.292 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000089
	speed: 0.1062s/iter; left time: 4287.3460s
	iters: 200, epoch: 3 | loss: 0.0112922
	speed: 0.0257s/iter; left time: 1036.9042s
	iters: 300, epoch: 3 | loss: 0.0036807
	speed: 0.0289s/iter; left time: 1159.5762s
	iters: 400, epoch: 3 | loss: 0.0338339
	speed: 0.0285s/iter; left time: 1142.2621s
Epoch: 3 cost time: 12.089113712310791
Epoch: 3, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.197 Vali Acc: 0.961 Test Loss: 0.197 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2929320
	speed: 0.1021s/iter; left time: 4081.9705s
	iters: 200, epoch: 4 | loss: 0.0000028
	speed: 0.0277s/iter; left time: 1105.8754s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 1097.8589s
	iters: 400, epoch: 4 | loss: 0.0000001
	speed: 0.0254s/iter; left time: 1008.4569s
Epoch: 4 cost time: 11.600524187088013
Epoch: 4, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.4305822
	speed: 0.0942s/iter; left time: 3724.9626s
	iters: 200, epoch: 5 | loss: 0.7007663
	speed: 0.0272s/iter; left time: 1074.5101s
	iters: 300, epoch: 5 | loss: 0.5607064
	speed: 0.0273s/iter; left time: 1073.4447s
	iters: 400, epoch: 5 | loss: 0.0000028
	speed: 0.0264s/iter; left time: 1036.5319s
Epoch: 5 cost time: 11.780086040496826
Epoch: 5, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.288 Vali Acc: 0.970 Test Loss: 0.288 Test Acc: 0.970
Validation loss decreased (-0.965438 --> -0.970438).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0037680
	speed: 0.0862s/iter; left time: 3372.1076s
	iters: 200, epoch: 6 | loss: 0.1997286
	speed: 0.0264s/iter; left time: 1029.7746s
	iters: 300, epoch: 6 | loss: 0.0000165
	speed: 0.0260s/iter; left time: 1010.4929s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 977.5776s
Epoch: 6 cost time: 10.969178915023804
Epoch: 6, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.246 Vali Acc: 0.974 Test Loss: 0.246 Test Acc: 0.974
Validation loss decreased (-0.970438 --> -0.974077).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0002458
	speed: 0.0903s/iter; left time: 3498.1990s
	iters: 200, epoch: 7 | loss: 0.0000028
	speed: 0.0262s/iter; left time: 1012.2233s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 1005.9872s
	iters: 400, epoch: 7 | loss: 0.0000020
	speed: 0.0267s/iter; left time: 1026.1129s
Epoch: 7 cost time: 11.14822793006897
Epoch: 7, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.191 Vali Acc: 0.980 Test Loss: 0.191 Test Acc: 0.980
Validation loss decreased (-0.974077 --> -0.979534).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.0915s/iter; left time: 3504.5958s
	iters: 200, epoch: 8 | loss: 1.4484752
	speed: 0.0270s/iter; left time: 1032.7092s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 952.9852s
	iters: 400, epoch: 8 | loss: 0.0041581
	speed: 0.0254s/iter; left time: 965.5120s
Epoch: 8 cost time: 11.284678936004639
Epoch: 8, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.250 Vali Acc: 0.977 Test Loss: 0.250 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0007897
	speed: 0.0965s/iter; left time: 3655.8755s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 964.7074s
	iters: 300, epoch: 9 | loss: 0.0000747
	speed: 0.0262s/iter; left time: 989.0151s
	iters: 400, epoch: 9 | loss: 0.1697682
	speed: 0.0262s/iter; left time: 985.1704s
Epoch: 9 cost time: 11.156936407089233
Epoch: 9, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.433 Vali Acc: 0.970 Test Loss: 0.433 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1054s/iter; left time: 3951.5457s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.0262s/iter; left time: 979.0131s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0236s/iter; left time: 879.1994s
	iters: 400, epoch: 10 | loss: 0.2475537
	speed: 0.0275s/iter; left time: 1023.3605s
Epoch: 10 cost time: 11.305155992507935
Epoch: 10, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.524 Vali Acc: 0.965 Test Loss: 0.524 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000005
	speed: 0.0985s/iter; left time: 3652.5409s
	iters: 200, epoch: 11 | loss: 0.0000051
	speed: 0.0245s/iter; left time: 907.3864s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 769.2395s
	iters: 400, epoch: 11 | loss: 0.0000072
	speed: 0.0224s/iter; left time: 822.7778s
Epoch: 11 cost time: 10.306159019470215
Epoch: 11, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.379 Vali Acc: 0.965 Test Loss: 0.379 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0796s/iter; left time: 2918.5211s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0227s/iter; left time: 831.3237s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 814.1524s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0230s/iter; left time: 836.9918s
Epoch: 12 cost time: 9.77715516090393
Epoch: 12, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.399 Vali Acc: 0.984 Test Loss: 0.399 Test Acc: 0.984
Validation loss decreased (-0.979534 --> -0.983625).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0914s/iter; left time: 3311.0766s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 939.2601s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 903.6209s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0268s/iter; left time: 962.0590s
Epoch: 13 cost time: 11.292813062667847
Epoch: 13, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.263 Vali Acc: 0.976 Test Loss: 0.263 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 3110.3343s
	iters: 200, epoch: 14 | loss: 0.0494016
	speed: 0.0256s/iter; left time: 913.3502s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 914.4597s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 941.8728s
Epoch: 14 cost time: 11.027218341827393
Epoch: 14, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.292 Vali Acc: 0.979 Test Loss: 0.292 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0934s/iter; left time: 3306.6960s
	iters: 200, epoch: 15 | loss: 0.0179717
	speed: 0.0266s/iter; left time: 940.2593s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 943.5206s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 952.4225s
Epoch: 15 cost time: 11.48633337020874
Epoch: 15, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.330 Vali Acc: 0.983 Test Loss: 0.330 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000004
	speed: 0.0872s/iter; left time: 3054.2000s
	iters: 200, epoch: 16 | loss: 0.0000034
	speed: 0.0253s/iter; left time: 883.9335s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 987.2079s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 976.9513s
Epoch: 16 cost time: 11.584145784378052
Epoch: 16, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.554 Vali Acc: 0.973 Test Loss: 0.554 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.4346416
	speed: 0.0982s/iter; left time: 3398.0733s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 959.2883s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 856.6789s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 959.1299s
Epoch: 17 cost time: 11.619782209396362
Epoch: 17, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.293 Vali Acc: 0.981 Test Loss: 0.293 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0984s/iter; left time: 3363.4938s
	iters: 200, epoch: 18 | loss: 0.4723365
	speed: 0.0279s/iter; left time: 949.2015s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 913.4129s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0235s/iter; left time: 795.3230s
Epoch: 18 cost time: 11.350546836853027
Epoch: 18, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.651 Vali Acc: 0.963 Test Loss: 0.651 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 2933.8785s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 842.5203s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 858.6730s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 857.6279s
Epoch: 19 cost time: 10.920244216918945
Epoch: 19, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.415 Vali Acc: 0.977 Test Loss: 0.415 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0889s/iter; left time: 2966.5803s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 889.3462s
	iters: 300, epoch: 20 | loss: 0.0000128
	speed: 0.0266s/iter; left time: 882.9570s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 847.0912s
Epoch: 20 cost time: 11.223222494125366
Epoch: 20, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.699 Vali Acc: 0.974 Test Loss: 0.699 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0920s/iter; left time: 3030.9041s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 840.3560s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 876.4460s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 825.6041s
Epoch: 21 cost time: 11.086341619491577
Epoch: 21, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.371 Vali Acc: 0.980 Test Loss: 0.371 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 3098.5493s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 856.8402s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 843.6042s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 896.6267s
Epoch: 22 cost time: 11.482582807540894
Epoch: 22, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.541 Vali Acc: 0.976 Test Loss: 0.541 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 1302094
model size : 14.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0271874
	speed: 0.0448s/iter; left time: 1845.4920s
	iters: 200, epoch: 1 | loss: 0.0693495
	speed: 0.0264s/iter; left time: 1085.7533s
	iters: 300, epoch: 1 | loss: 0.2082840
	speed: 0.0220s/iter; left time: 900.7097s
	iters: 400, epoch: 1 | loss: 0.8877178
	speed: 0.0255s/iter; left time: 1044.7318s
Epoch: 1 cost time: 12.274336099624634
Epoch: 1, Steps: 413 | Train Loss: 0.295 Vali Loss: 0.148 Vali Acc: 0.955 Test Loss: 0.148 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4949532
	speed: 0.0882s/iter; left time: 3598.8638s
	iters: 200, epoch: 2 | loss: 0.0639104
	speed: 0.0254s/iter; left time: 1034.7235s
	iters: 300, epoch: 2 | loss: 0.0108195
	speed: 0.0250s/iter; left time: 1014.9719s
	iters: 400, epoch: 2 | loss: 0.1250674
	speed: 0.0268s/iter; left time: 1085.4292s
Epoch: 2 cost time: 10.910847902297974
Epoch: 2, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
Validation loss decreased (-0.954978 --> -0.963163).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0008713
	speed: 0.0911s/iter; left time: 3677.7970s
	iters: 200, epoch: 3 | loss: 0.0389923
	speed: 0.0258s/iter; left time: 1037.5867s
	iters: 300, epoch: 3 | loss: 0.0041973
	speed: 0.0257s/iter; left time: 1033.3954s
	iters: 400, epoch: 3 | loss: 0.3169341
	speed: 0.0255s/iter; left time: 1023.8757s
Epoch: 3 cost time: 10.988213300704956
Epoch: 3, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.963163 --> -0.969530).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0327695
	speed: 0.0866s/iter; left time: 3460.4965s
	iters: 200, epoch: 4 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 1063.5948s
	iters: 300, epoch: 4 | loss: 0.0000005
	speed: 0.0251s/iter; left time: 999.6982s
	iters: 400, epoch: 4 | loss: 0.4818890
	speed: 0.0269s/iter; left time: 1068.1449s
Epoch: 4 cost time: 11.192844867706299
Epoch: 4, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.288 Vali Acc: 0.957 Test Loss: 0.288 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0003853
	speed: 0.0902s/iter; left time: 3568.4535s
	iters: 200, epoch: 5 | loss: 0.0047629
	speed: 0.0275s/iter; left time: 1083.0832s
	iters: 300, epoch: 5 | loss: 0.0013849
	speed: 0.0274s/iter; left time: 1077.0834s
	iters: 400, epoch: 5 | loss: 0.0099698
	speed: 0.0263s/iter; left time: 1031.1917s
Epoch: 5 cost time: 11.602065086364746
Epoch: 5, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.313 Vali Acc: 0.964 Test Loss: 0.313 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000064
	speed: 0.0973s/iter; left time: 3806.7217s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 1064.1137s
	iters: 300, epoch: 6 | loss: 0.0000001
	speed: 0.0268s/iter; left time: 1044.7881s
	iters: 400, epoch: 6 | loss: 0.0000003
	speed: 0.0270s/iter; left time: 1049.5753s
Epoch: 6 cost time: 11.463197708129883
Epoch: 6, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.185 Vali Acc: 0.973 Test Loss: 0.185 Test Acc: 0.973
Validation loss decreased (-0.969530 --> -0.973168).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000363
	speed: 0.0997s/iter; left time: 3860.4303s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0228s/iter; left time: 882.0811s
	iters: 300, epoch: 7 | loss: 0.0000036
	speed: 0.0256s/iter; left time: 987.3815s
	iters: 400, epoch: 7 | loss: 0.0000010
	speed: 0.0257s/iter; left time: 987.4892s
Epoch: 7 cost time: 10.763514995574951
Epoch: 7, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.234 Vali Acc: 0.981 Test Loss: 0.234 Test Acc: 0.981
Validation loss decreased (-0.973168 --> -0.981353).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.0921s/iter; left time: 3530.1273s
	iters: 200, epoch: 8 | loss: 0.0003951
	speed: 0.0252s/iter; left time: 961.9405s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0248s/iter; left time: 945.4332s
	iters: 400, epoch: 8 | loss: 0.0000005
	speed: 0.0242s/iter; left time: 918.6127s
Epoch: 8 cost time: 10.563061475753784
Epoch: 8, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.263 Vali Acc: 0.976 Test Loss: 0.263 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.5654897
	speed: 0.0915s/iter; left time: 3468.3880s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 971.6953s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 878.4864s
	iters: 400, epoch: 9 | loss: 0.0000871
	speed: 0.0245s/iter; left time: 922.8339s
Epoch: 9 cost time: 10.630500078201294
Epoch: 9, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.520 Vali Acc: 0.965 Test Loss: 0.520 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0008713
	speed: 0.0907s/iter; left time: 3401.3668s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 923.2879s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 944.0891s
	iters: 400, epoch: 10 | loss: 0.0000016
	speed: 0.0237s/iter; left time: 881.8698s
Epoch: 10 cost time: 10.60248327255249
Epoch: 10, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.286 Vali Acc: 0.979 Test Loss: 0.286 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.7397887
	speed: 0.1015s/iter; left time: 3763.0635s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 989.8209s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 944.3107s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 902.8479s
Epoch: 11 cost time: 11.114139795303345
Epoch: 11, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.522 Vali Acc: 0.965 Test Loss: 0.522 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000011
	speed: 0.0879s/iter; left time: 3222.0645s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 1037.8299s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 982.4422s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 985.8965s
Epoch: 12 cost time: 11.686541557312012
Epoch: 12, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.629 Vali Acc: 0.966 Test Loss: 0.629 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0170543
	speed: 0.0958s/iter; left time: 3471.2202s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 940.9171s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 943.4919s
	iters: 400, epoch: 13 | loss: 0.0006411
	speed: 0.0255s/iter; left time: 915.1840s
Epoch: 13 cost time: 11.036995887756348
Epoch: 13, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.297 Vali Acc: 0.980 Test Loss: 0.297 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0101336
	speed: 0.0878s/iter; left time: 3147.6382s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 929.0514s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 929.4126s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 958.5210s
Epoch: 14 cost time: 11.273858785629272
Epoch: 14, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.287 Vali Acc: 0.980 Test Loss: 0.287 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 3166.9861s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 948.1391s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 987.5269s
	iters: 400, epoch: 15 | loss: 0.0000017
	speed: 0.0272s/iter; left time: 954.0231s
Epoch: 15 cost time: 11.827375650405884
Epoch: 15, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.538 Vali Acc: 0.969 Test Loss: 0.538 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000087
	speed: 0.0878s/iter; left time: 3072.1839s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 969.1886s
	iters: 300, epoch: 16 | loss: 0.7727182
	speed: 0.0279s/iter; left time: 972.2039s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 926.6650s
Epoch: 16 cost time: 11.616250991821289
Epoch: 16, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.494 Vali Acc: 0.972 Test Loss: 0.494 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1079s/iter; left time: 3733.9724s
	iters: 200, epoch: 17 | loss: 1.0346292
	speed: 0.0291s/iter; left time: 1004.2165s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0289s/iter; left time: 993.7012s
	iters: 400, epoch: 17 | loss: 1.2665925
	speed: 0.0278s/iter; left time: 953.9627s
Epoch: 17 cost time: 12.338088035583496
Epoch: 17, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.278 Vali Acc: 0.982 Test Loss: 0.278 Test Acc: 0.982
Validation loss decreased (-0.981353 --> -0.981807).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0005953
	speed: 0.1053s/iter; left time: 3600.6429s
	iters: 200, epoch: 18 | loss: 0.0014999
	speed: 0.0275s/iter; left time: 935.9031s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 861.4045s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 890.2942s
Epoch: 18 cost time: 11.43701434135437
Epoch: 18, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.278 Vali Acc: 0.981 Test Loss: 0.278 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 3081.9005s
	iters: 200, epoch: 19 | loss: 0.0001467
	speed: 0.0256s/iter; left time: 860.8662s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0265s/iter; left time: 890.6151s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 856.1357s
Epoch: 19 cost time: 11.2241051197052
Epoch: 19, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.341 Vali Acc: 0.979 Test Loss: 0.341 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0932s/iter; left time: 3108.2240s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 853.6280s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 830.5450s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 892.3984s
Epoch: 20 cost time: 11.150253534317017
Epoch: 20, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.385 Vali Acc: 0.978 Test Loss: 0.385 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0901s/iter; left time: 2969.5040s
	iters: 200, epoch: 21 | loss: 0.0781485
	speed: 0.0259s/iter; left time: 852.0216s
	iters: 300, epoch: 21 | loss: 1.2482762
	speed: 0.0252s/iter; left time: 824.4945s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 851.7165s
Epoch: 21 cost time: 11.139105319976807
Epoch: 21, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.282 Vali Acc: 0.985 Test Loss: 0.282 Test Acc: 0.985
Validation loss decreased (-0.981807 --> -0.984990).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1080s/iter; left time: 3512.0287s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 897.7336s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0295s/iter; left time: 953.3899s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 856.5994s
Epoch: 22 cost time: 12.044609308242798
Epoch: 22, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.680 Vali Acc: 0.963 Test Loss: 0.680 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1048s/iter; left time: 3366.8743s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0294s/iter; left time: 941.8729s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.0289s/iter; left time: 923.0271s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 813.7203s
Epoch: 23 cost time: 11.956832647323608
Epoch: 23, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.353 Vali Acc: 0.984 Test Loss: 0.353 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 2834.1878s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 845.4462s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 822.4937s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 835.7167s
Epoch: 24 cost time: 11.441066980361938
Epoch: 24, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.406 Vali Acc: 0.978 Test Loss: 0.406 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0954s/iter; left time: 2986.4037s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 833.2955s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 811.5147s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 805.5451s
Epoch: 25 cost time: 11.401857137680054
Epoch: 25, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.532 Vali Acc: 0.973 Test Loss: 0.532 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 2885.4506s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 785.9853s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 766.5819s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 752.7476s
Epoch: 26 cost time: 10.919950723648071
Epoch: 26, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.375 Vali Acc: 0.980 Test Loss: 0.375 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0996s/iter; left time: 3034.2137s
	iters: 200, epoch: 27 | loss: 0.0000002
	speed: 0.0281s/iter; left time: 854.0366s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 817.8383s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 804.6948s
Epoch: 27 cost time: 11.769272327423096
Epoch: 27, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.402 Vali Acc: 0.985 Test Loss: 0.402 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0979s/iter; left time: 2943.3845s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 768.6945s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 789.9265s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 776.8710s
Epoch: 28 cost time: 11.223270416259766
Epoch: 28, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.602 Vali Acc: 0.977 Test Loss: 0.602 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 2772.4956s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 720.6020s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0248s/iter; left time: 729.8571s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 718.9246s
Epoch: 29 cost time: 10.568375587463379
Epoch: 29, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.482 Vali Acc: 0.980 Test Loss: 0.482 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.0878s/iter; left time: 2566.4772s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 745.0471s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 752.9563s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 725.5221s
Epoch: 30 cost time: 10.924206733703613
Epoch: 30, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.492 Vali Acc: 0.978 Test Loss: 0.492 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.0887s/iter; left time: 2555.2631s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 721.5727s
	iters: 300, epoch: 31 | loss: 0.0000296
	speed: 0.0259s/iter; left time: 742.2446s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 743.4218s
Epoch: 31 cost time: 10.961150169372559
Epoch: 31, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.603 Vali Acc: 0.976 Test Loss: 0.603 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 1302094
model size : 14.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0535073
	speed: 0.0485s/iter; left time: 1998.5170s
	iters: 200, epoch: 1 | loss: 0.0686301
	speed: 0.0271s/iter; left time: 1112.1333s
	iters: 300, epoch: 1 | loss: 0.1827618
	speed: 0.0279s/iter; left time: 1144.4991s
	iters: 400, epoch: 1 | loss: 0.2535990
	speed: 0.0260s/iter; left time: 1063.0688s
Epoch: 1 cost time: 13.392826795578003
Epoch: 1, Steps: 413 | Train Loss: 0.325 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
Validation loss decreased (inf --> -0.959526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0634822
	speed: 0.0997s/iter; left time: 4064.7263s
	iters: 200, epoch: 2 | loss: 0.0004833
	speed: 0.0272s/iter; left time: 1107.0902s
	iters: 300, epoch: 2 | loss: 0.0013869
	speed: 0.0275s/iter; left time: 1115.9978s
	iters: 400, epoch: 2 | loss: 0.0438641
	speed: 0.0236s/iter; left time: 956.1762s
Epoch: 2 cost time: 11.447248220443726
Epoch: 2, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
Validation loss decreased (-0.959526 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0121645
	speed: 0.0916s/iter; left time: 3700.0722s
	iters: 200, epoch: 3 | loss: 0.0005621
	speed: 0.0261s/iter; left time: 1050.7380s
	iters: 300, epoch: 3 | loss: 0.0481392
	speed: 0.0268s/iter; left time: 1075.1115s
	iters: 400, epoch: 3 | loss: 0.9764416
	speed: 0.0259s/iter; left time: 1037.5308s
Epoch: 3 cost time: 11.251415252685547
Epoch: 3, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.230 Vali Acc: 0.951 Test Loss: 0.230 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000117
	speed: 0.0903s/iter; left time: 3610.5366s
	iters: 200, epoch: 4 | loss: 0.0503038
	speed: 0.0258s/iter; left time: 1028.6218s
	iters: 300, epoch: 4 | loss: 0.0316722
	speed: 0.0248s/iter; left time: 985.3830s
	iters: 400, epoch: 4 | loss: 0.0021374
	speed: 0.0245s/iter; left time: 970.2110s
Epoch: 4 cost time: 10.795553207397461
Epoch: 4, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.267 Vali Acc: 0.960 Test Loss: 0.267 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000040
	speed: 0.0909s/iter; left time: 3594.3685s
	iters: 200, epoch: 5 | loss: 0.8288745
	speed: 0.0244s/iter; left time: 963.8171s
	iters: 300, epoch: 5 | loss: 0.0000002
	speed: 0.0261s/iter; left time: 1028.3903s
	iters: 400, epoch: 5 | loss: 0.0735033
	speed: 0.0248s/iter; left time: 974.2437s
Epoch: 5 cost time: 10.820968389511108
Epoch: 5, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.197 Vali Acc: 0.972 Test Loss: 0.197 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0792255
	speed: 0.1004s/iter; left time: 3929.6614s
	iters: 200, epoch: 6 | loss: 0.0038346
	speed: 0.0261s/iter; left time: 1017.0787s
	iters: 300, epoch: 6 | loss: 0.0001370
	speed: 0.0263s/iter; left time: 1025.7273s
	iters: 400, epoch: 6 | loss: 0.0000032
	speed: 0.0267s/iter; left time: 1035.6983s
Epoch: 6 cost time: 11.349074602127075
Epoch: 6, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.265 Vali Acc: 0.974 Test Loss: 0.265 Test Acc: 0.974
Validation loss decreased (-0.972259 --> -0.973622).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1011s/iter; left time: 3914.7672s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 979.0688s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 1017.7972s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 981.4140s
Epoch: 7 cost time: 11.207620859146118
Epoch: 7, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.493 Vali Acc: 0.957 Test Loss: 0.493 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5825248
	speed: 0.0979s/iter; left time: 3751.9706s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 958.8530s
	iters: 300, epoch: 8 | loss: 0.0000320
	speed: 0.0258s/iter; left time: 983.5691s
	iters: 400, epoch: 8 | loss: 0.0000020
	speed: 0.0255s/iter; left time: 968.0446s
Epoch: 8 cost time: 10.79313325881958
Epoch: 8, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.340 Vali Acc: 0.966 Test Loss: 0.340 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4108469
	speed: 0.0903s/iter; left time: 3420.4130s
	iters: 200, epoch: 9 | loss: 0.0001019
	speed: 0.0252s/iter; left time: 953.7145s
	iters: 300, epoch: 9 | loss: 0.3802975
	speed: 0.0244s/iter; left time: 919.0191s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 927.9541s
Epoch: 9 cost time: 10.63376760482788
Epoch: 9, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.405 Vali Acc: 0.965 Test Loss: 0.405 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.0893s/iter; left time: 3348.5695s
	iters: 200, epoch: 10 | loss: 0.0000008
	speed: 0.0251s/iter; left time: 938.1936s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 945.3152s
	iters: 400, epoch: 10 | loss: 0.0001211
	speed: 0.0256s/iter; left time: 952.3231s
Epoch: 10 cost time: 10.956519603729248
Epoch: 10, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.204 Vali Acc: 0.983 Test Loss: 0.204 Test Acc: 0.983
Validation loss decreased (-0.973622 --> -0.982717).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000214
	speed: 0.0889s/iter; left time: 3295.0484s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 905.5153s
	iters: 300, epoch: 11 | loss: 0.0000122
	speed: 0.0269s/iter; left time: 993.3783s
	iters: 400, epoch: 11 | loss: 0.3054364
	speed: 0.0272s/iter; left time: 999.2482s
Epoch: 11 cost time: 11.271512746810913
Epoch: 11, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.534 Vali Acc: 0.972 Test Loss: 0.534 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000615
	speed: 0.1003s/iter; left time: 3676.8446s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 1025.9697s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 893.8358s
	iters: 400, epoch: 12 | loss: 0.0000475
	speed: 0.0261s/iter; left time: 948.7062s
Epoch: 12 cost time: 11.481030464172363
Epoch: 12, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.414 Vali Acc: 0.972 Test Loss: 0.414 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.0997s/iter; left time: 3612.3473s
	iters: 200, epoch: 13 | loss: 0.4876162
	speed: 0.0260s/iter; left time: 940.8755s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 939.2813s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 867.7241s
Epoch: 13 cost time: 11.049585819244385
Epoch: 13, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.329 Vali Acc: 0.978 Test Loss: 0.329 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.0428385
	speed: 0.0907s/iter; left time: 3251.5172s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 895.5531s
	iters: 300, epoch: 14 | loss: 0.0185633
	speed: 0.0252s/iter; left time: 898.4083s
	iters: 400, epoch: 14 | loss: 0.0000005
	speed: 0.0251s/iter; left time: 893.2305s
Epoch: 14 cost time: 10.807322025299072
Epoch: 14, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.411 Vali Acc: 0.977 Test Loss: 0.411 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 3232.5619s
	iters: 200, epoch: 15 | loss: 0.0000025
	speed: 0.0251s/iter; left time: 885.7648s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 876.7002s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 866.7429s
Epoch: 15 cost time: 10.851884841918945
Epoch: 15, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.375 Vali Acc: 0.973 Test Loss: 0.375 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000885
	speed: 0.0900s/iter; left time: 3152.0526s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 883.0517s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 905.4346s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 854.0079s
Epoch: 16 cost time: 10.81021237373352
Epoch: 16, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.445 Vali Acc: 0.981 Test Loss: 0.445 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.1014s/iter; left time: 3508.5368s
	iters: 200, epoch: 17 | loss: 2.3761899
	speed: 0.0248s/iter; left time: 857.1240s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 889.5342s
	iters: 400, epoch: 17 | loss: 0.0014643
	speed: 0.0254s/iter; left time: 870.3473s
Epoch: 17 cost time: 11.16484808921814
Epoch: 17, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.483 Vali Acc: 0.971 Test Loss: 0.483 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0993s/iter; left time: 3395.2803s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 884.0391s
	iters: 300, epoch: 18 | loss: 0.0399006
	speed: 0.0257s/iter; left time: 872.6554s
	iters: 400, epoch: 18 | loss: 0.0012205
	speed: 0.0262s/iter; left time: 886.1074s
Epoch: 18 cost time: 11.18944239616394
Epoch: 18, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.808 Vali Acc: 0.963 Test Loss: 0.808 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0998s/iter; left time: 3369.1933s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 839.2202s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 806.6319s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 836.8238s
Epoch: 19 cost time: 10.614978790283203
Epoch: 19, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.667 Vali Acc: 0.970 Test Loss: 0.667 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0896s/iter; left time: 2989.1865s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 797.7910s
	iters: 300, epoch: 20 | loss: 0.7353698
	speed: 0.0263s/iter; left time: 872.9227s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 834.8835s
Epoch: 20 cost time: 10.810794591903687
Epoch: 20, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.431 Vali Acc: 0.977 Test Loss: 0.431 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 1302094
model size : 14.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0394166
	speed: 0.0458s/iter; left time: 1887.4566s
	iters: 200, epoch: 1 | loss: 0.4331420
	speed: 0.0268s/iter; left time: 1102.9473s
	iters: 300, epoch: 1 | loss: 0.0057299
	speed: 0.0277s/iter; left time: 1133.9218s
	iters: 400, epoch: 1 | loss: 0.4774865
	speed: 0.0271s/iter; left time: 1106.9271s
Epoch: 1 cost time: 13.163319826126099
Epoch: 1, Steps: 413 | Train Loss: 0.304 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (inf --> -0.975897).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1349877
	speed: 0.1015s/iter; left time: 4141.2186s
	iters: 200, epoch: 2 | loss: 0.0191565
	speed: 0.0278s/iter; left time: 1130.9868s
	iters: 300, epoch: 2 | loss: 0.4594384
	speed: 0.0270s/iter; left time: 1094.4195s
	iters: 400, epoch: 2 | loss: 0.0008194
	speed: 0.0275s/iter; left time: 1113.2163s
Epoch: 2 cost time: 11.776850700378418
Epoch: 2, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0014104
	speed: 0.1002s/iter; left time: 4045.8432s
	iters: 200, epoch: 3 | loss: 0.0000445
	speed: 0.0274s/iter; left time: 1101.6930s
	iters: 300, epoch: 3 | loss: 0.0002248
	speed: 0.0273s/iter; left time: 1094.9879s
	iters: 400, epoch: 3 | loss: 0.6172747
	speed: 0.0273s/iter; left time: 1094.6965s
Epoch: 3 cost time: 11.804548978805542
Epoch: 3, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.229 Vali Acc: 0.963 Test Loss: 0.229 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000362
	speed: 0.0979s/iter; left time: 3911.5711s
	iters: 200, epoch: 4 | loss: 0.0003224
	speed: 0.0254s/iter; left time: 1014.0926s
	iters: 300, epoch: 4 | loss: 0.0000018
	speed: 0.0264s/iter; left time: 1050.1171s
	iters: 400, epoch: 4 | loss: 0.5688621
	speed: 0.0259s/iter; left time: 1028.3299s
Epoch: 4 cost time: 10.862216711044312
Epoch: 4, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.264 Vali Acc: 0.959 Test Loss: 0.264 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0000183
	speed: 0.0848s/iter; left time: 3354.6678s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 1011.7545s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 1090.5234s
	iters: 400, epoch: 5 | loss: 0.1394554
	speed: 0.0273s/iter; left time: 1072.0012s
Epoch: 5 cost time: 11.308021783828735
Epoch: 5, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.174 Vali Acc: 0.976 Test Loss: 0.174 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.0903s/iter; left time: 3532.8524s
	iters: 200, epoch: 6 | loss: 0.0000058
	speed: 0.0262s/iter; left time: 1021.7794s
	iters: 300, epoch: 6 | loss: 0.5119398
	speed: 0.0259s/iter; left time: 1007.9057s
	iters: 400, epoch: 6 | loss: 2.0174434
	speed: 0.0265s/iter; left time: 1028.8780s
Epoch: 6 cost time: 11.1963369846344
Epoch: 6, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.280 Vali Acc: 0.967 Test Loss: 0.280 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000003
	speed: 0.0901s/iter; left time: 3490.3078s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0261s/iter; left time: 1006.8222s
	iters: 300, epoch: 7 | loss: 0.0398875
	speed: 0.0245s/iter; left time: 941.9670s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 1013.6647s
Epoch: 7 cost time: 11.059854507446289
Epoch: 7, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.475 Vali Acc: 0.963 Test Loss: 0.475 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.0945s/iter; left time: 3621.1323s
	iters: 200, epoch: 8 | loss: 0.0000011
	speed: 0.0272s/iter; left time: 1039.5454s
	iters: 300, epoch: 8 | loss: 0.0001243
	speed: 0.0279s/iter; left time: 1062.1833s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 950.8067s
Epoch: 8 cost time: 11.401051044464111
Epoch: 8, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.295 Vali Acc: 0.971 Test Loss: 0.295 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0150596
	speed: 0.0969s/iter; left time: 3670.9330s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 1051.4197s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 1046.5095s
	iters: 400, epoch: 9 | loss: 0.0041735
	speed: 0.0273s/iter; left time: 1028.2036s
Epoch: 9 cost time: 11.831026315689087
Epoch: 9, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.285 Vali Acc: 0.979 Test Loss: 0.285 Test Acc: 0.979
Validation loss decreased (-0.975897 --> -0.978624).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0960s/iter; left time: 3599.3182s
	iters: 200, epoch: 10 | loss: 0.0000014
	speed: 0.0268s/iter; left time: 1000.1843s
	iters: 300, epoch: 10 | loss: 0.0153660
	speed: 0.0267s/iter; left time: 994.8662s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 995.4997s
Epoch: 10 cost time: 11.401978731155396
Epoch: 10, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.296 Vali Acc: 0.977 Test Loss: 0.296 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 3383.3662s
	iters: 200, epoch: 11 | loss: 0.0000379
	speed: 0.0266s/iter; left time: 984.8964s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 1001.2991s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 969.0033s
Epoch: 11 cost time: 11.401326894760132
Epoch: 11, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.315 Vali Acc: 0.979 Test Loss: 0.315 Test Acc: 0.979
Validation loss decreased (-0.978624 --> -0.979078).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000203
	speed: 0.0945s/iter; left time: 3463.1466s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 980.4881s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 953.3842s
	iters: 400, epoch: 12 | loss: 0.0000264
	speed: 0.0265s/iter; left time: 964.3616s
Epoch: 12 cost time: 11.330168008804321
Epoch: 12, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.700 Vali Acc: 0.955 Test Loss: 0.700 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000003
	speed: 0.0884s/iter; left time: 3205.5508s
	iters: 200, epoch: 13 | loss: 0.0000519
	speed: 0.0237s/iter; left time: 856.8940s
	iters: 300, epoch: 13 | loss: 0.0118837
	speed: 0.0269s/iter; left time: 968.1565s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 997.7991s
Epoch: 13 cost time: 11.106233358383179
Epoch: 13, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.443 Vali Acc: 0.980 Test Loss: 0.443 Test Acc: 0.980
Validation loss decreased (-0.979078 --> -0.979532).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0989s/iter; left time: 3544.2643s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 1002.9768s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 940.7862s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 934.4288s
Epoch: 14 cost time: 11.461308479309082
Epoch: 14, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.469 Vali Acc: 0.969 Test Loss: 0.469 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0987s/iter; left time: 3495.7376s
	iters: 200, epoch: 15 | loss: 0.0027476
	speed: 0.0266s/iter; left time: 938.0564s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 957.7613s
	iters: 400, epoch: 15 | loss: 0.0000594
	speed: 0.0277s/iter; left time: 973.2710s
Epoch: 15 cost time: 11.696385860443115
Epoch: 15, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.509 Vali Acc: 0.970 Test Loss: 0.509 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0813851
	speed: 0.0859s/iter; left time: 3007.3634s
	iters: 200, epoch: 16 | loss: 0.0000562
	speed: 0.0256s/iter; left time: 892.9925s
	iters: 300, epoch: 16 | loss: 0.0450445
	speed: 0.0258s/iter; left time: 899.5555s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 911.4452s
Epoch: 16 cost time: 11.073852300643921
Epoch: 16, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.304 Vali Acc: 0.982 Test Loss: 0.304 Test Acc: 0.982
Validation loss decreased (-0.979532 --> -0.981807).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1328322
	speed: 0.0917s/iter; left time: 3172.6633s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 909.4651s
	iters: 300, epoch: 17 | loss: 2.1658154
	speed: 0.0262s/iter; left time: 901.1194s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 909.3167s
Epoch: 17 cost time: 11.332895040512085
Epoch: 17, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.323 Vali Acc: 0.978 Test Loss: 0.323 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.0945s/iter; left time: 3231.1423s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 891.2900s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 905.8970s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 911.5595s
Epoch: 18 cost time: 11.400152206420898
Epoch: 18, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.684 Vali Acc: 0.968 Test Loss: 0.684 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0976s/iter; left time: 3295.3853s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 979.9412s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 946.6687s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0288s/iter; left time: 963.5013s
Epoch: 19 cost time: 12.291672945022583
Epoch: 19, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.305 Vali Acc: 0.986 Test Loss: 0.305 Test Acc: 0.986
Validation loss decreased (-0.981807 --> -0.985900).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1067s/iter; left time: 3560.4445s
	iters: 200, epoch: 20 | loss: 0.3776910
	speed: 0.0276s/iter; left time: 918.1673s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0288s/iter; left time: 955.3154s
	iters: 400, epoch: 20 | loss: 0.0000006
	speed: 0.0288s/iter; left time: 952.5628s
Epoch: 20 cost time: 11.92361569404602
Epoch: 20, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.417 Vali Acc: 0.981 Test Loss: 0.417 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0989s/iter; left time: 3257.9707s
	iters: 200, epoch: 21 | loss: 0.0006270
	speed: 0.0263s/iter; left time: 862.9939s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 845.3224s
	iters: 400, epoch: 21 | loss: 0.0000310
	speed: 0.0270s/iter; left time: 882.1498s
Epoch: 21 cost time: 11.47237229347229
Epoch: 21, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.420 Vali Acc: 0.976 Test Loss: 0.420 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0885s/iter; left time: 2879.0808s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 851.5952s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.0269s/iter; left time: 868.7345s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 808.9365s
Epoch: 22 cost time: 11.301650285720825
Epoch: 22, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.778 Vali Acc: 0.970 Test Loss: 0.778 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 2806.1019s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 827.3243s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 822.8299s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 848.9131s
Epoch: 23 cost time: 11.166375160217285
Epoch: 23, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.481 Vali Acc: 0.981 Test Loss: 0.481 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 2704.1098s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 846.2569s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 842.8599s
	iters: 400, epoch: 24 | loss: 0.0095336
	speed: 0.0257s/iter; left time: 806.4943s
Epoch: 24 cost time: 11.205247640609741
Epoch: 24, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.363 Vali Acc: 0.980 Test Loss: 0.363 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000004
	speed: 0.1024s/iter; left time: 3205.2267s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 828.6289s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 851.7252s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 835.5142s
Epoch: 25 cost time: 11.610631942749023
Epoch: 25, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.803 Vali Acc: 0.970 Test Loss: 0.803 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1042s/iter; left time: 3217.4693s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 842.8168s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 844.9339s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 837.7409s
Epoch: 26 cost time: 11.79471731185913
Epoch: 26, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.509 Vali Acc: 0.981 Test Loss: 0.509 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1087s/iter; left time: 3311.3921s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 794.4397s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 784.5131s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 779.4515s
Epoch: 27 cost time: 11.06258487701416
Epoch: 27, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.452 Vali Acc: 0.977 Test Loss: 0.452 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.6099801
	speed: 0.0955s/iter; left time: 2870.6127s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 770.4515s
	iters: 300, epoch: 28 | loss: 0.9356983
	speed: 0.0257s/iter; left time: 768.4560s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 768.4854s
Epoch: 28 cost time: 11.142640590667725
Epoch: 28, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.500 Vali Acc: 0.981 Test Loss: 0.500 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.0859s/iter; left time: 2547.1698s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 795.8224s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 786.9997s
	iters: 400, epoch: 29 | loss: 0.8567944
	speed: 0.0277s/iter; left time: 813.1072s
Epoch: 29 cost time: 11.59302020072937
Epoch: 29, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.343 Vali Acc: 0.982 Test Loss: 0.343 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 1171022
model size : 14.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0345628
	speed: 0.0456s/iter; left time: 1877.7214s
	iters: 200, epoch: 1 | loss: 0.2968970
	speed: 0.0271s/iter; left time: 1114.5447s
	iters: 300, epoch: 1 | loss: 0.0085124
	speed: 0.0261s/iter; left time: 1070.7097s
	iters: 400, epoch: 1 | loss: 0.0856808
	speed: 0.0271s/iter; left time: 1109.2894s
Epoch: 1 cost time: 13.035166501998901
Epoch: 1, Steps: 413 | Train Loss: 0.295 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2675360
	speed: 0.0929s/iter; left time: 3791.2128s
	iters: 200, epoch: 2 | loss: 0.0516149
	speed: 0.0281s/iter; left time: 1143.3313s
	iters: 300, epoch: 2 | loss: 0.1546568
	speed: 0.0276s/iter; left time: 1119.3747s
	iters: 400, epoch: 2 | loss: 0.5656981
	speed: 0.0275s/iter; left time: 1111.9258s
Epoch: 2 cost time: 11.76351284980774
Epoch: 2, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0026979
	speed: 0.0915s/iter; left time: 3692.3101s
	iters: 200, epoch: 3 | loss: 0.0004641
	speed: 0.0255s/iter; left time: 1027.2862s
	iters: 300, epoch: 3 | loss: 0.0000328
	speed: 0.0252s/iter; left time: 1011.1467s
	iters: 400, epoch: 3 | loss: 0.1992073
	speed: 0.0250s/iter; left time: 1003.3607s
Epoch: 3 cost time: 10.84656572341919
Epoch: 3, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.216 Vali Acc: 0.962 Test Loss: 0.216 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0121435
	speed: 0.0947s/iter; left time: 3782.7398s
	iters: 200, epoch: 4 | loss: 0.0001477
	speed: 0.0261s/iter; left time: 1039.0224s
	iters: 300, epoch: 4 | loss: 0.0000005
	speed: 0.0263s/iter; left time: 1046.5289s
	iters: 400, epoch: 4 | loss: 0.0002376
	speed: 0.0253s/iter; left time: 1004.6310s
Epoch: 4 cost time: 11.145381689071655
Epoch: 4, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.360 Vali Acc: 0.962 Test Loss: 0.360 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0001089
	speed: 0.0896s/iter; left time: 3544.9563s
	iters: 200, epoch: 5 | loss: 0.0117762
	speed: 0.0264s/iter; left time: 1040.2267s
	iters: 300, epoch: 5 | loss: 0.0000056
	speed: 0.0256s/iter; left time: 1005.5509s
	iters: 400, epoch: 5 | loss: 0.0002322
	speed: 0.0250s/iter; left time: 982.4935s
Epoch: 5 cost time: 10.986076354980469
Epoch: 5, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.224 Vali Acc: 0.974 Test Loss: 0.224 Test Acc: 0.974
Validation loss decreased (-0.970895 --> -0.973622).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.0895s/iter; left time: 3500.8229s
	iters: 200, epoch: 6 | loss: 0.0000542
	speed: 0.0251s/iter; left time: 980.3899s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 1034.0746s
	iters: 400, epoch: 6 | loss: 0.0000555
	speed: 0.0266s/iter; left time: 1034.3235s
Epoch: 6 cost time: 11.188270568847656
Epoch: 6, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.973622 --> -0.974532).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1051s/iter; left time: 4071.5732s
	iters: 200, epoch: 7 | loss: 0.0000114
	speed: 0.0279s/iter; left time: 1075.9955s
	iters: 300, epoch: 7 | loss: 0.0021902
	speed: 0.0264s/iter; left time: 1016.6296s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.0257s/iter; left time: 988.3012s
Epoch: 7 cost time: 11.44997525215149
Epoch: 7, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.521 Vali Acc: 0.960 Test Loss: 0.521 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5136706
	speed: 0.1015s/iter; left time: 3888.4533s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 1042.2843s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 1024.2709s
	iters: 400, epoch: 8 | loss: 0.3465931
	speed: 0.0280s/iter; left time: 1062.6625s
Epoch: 8 cost time: 11.713150262832642
Epoch: 8, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.239 Vali Acc: 0.974 Test Loss: 0.239 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3795641
	speed: 0.0906s/iter; left time: 3433.0389s
	iters: 200, epoch: 9 | loss: 0.0000017
	speed: 0.0307s/iter; left time: 1159.4873s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 1152.2988s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 1164.3573s
Epoch: 9 cost time: 13.269114971160889
Epoch: 9, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.583 Vali Acc: 0.965 Test Loss: 0.583 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 3101.3397s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 814.8051s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 827.5490s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 892.7889s
Epoch: 10 cost time: 9.783181428909302
Epoch: 10, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.408 Vali Acc: 0.976 Test Loss: 0.408 Test Acc: 0.976
Validation loss decreased (-0.974532 --> -0.975894).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000790
	speed: 0.0826s/iter; left time: 3060.8109s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 932.1996s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 972.0910s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 957.4993s
Epoch: 11 cost time: 10.97713303565979
Epoch: 11, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.549 Vali Acc: 0.968 Test Loss: 0.549 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0004394
	speed: 0.0909s/iter; left time: 3330.6588s
	iters: 200, epoch: 12 | loss: 0.1291045
	speed: 0.0266s/iter; left time: 973.7703s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 931.8963s
	iters: 400, epoch: 12 | loss: 1.6784170
	speed: 0.0265s/iter; left time: 964.1780s
Epoch: 12 cost time: 11.267380475997925
Epoch: 12, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.348 Vali Acc: 0.978 Test Loss: 0.348 Test Acc: 0.978
Validation loss decreased (-0.975894 --> -0.977714).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0897s/iter; left time: 3249.6609s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 918.5966s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 923.7135s
	iters: 400, epoch: 13 | loss: 0.0000009
	speed: 0.0265s/iter; left time: 953.6865s
Epoch: 13 cost time: 11.109866380691528
Epoch: 13, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.452 Vali Acc: 0.975 Test Loss: 0.452 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0979s/iter; left time: 3509.1316s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 949.7134s
	iters: 300, epoch: 14 | loss: 1.3293077
	speed: 0.0261s/iter; left time: 928.2947s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 982.5921s
Epoch: 14 cost time: 11.510231733322144
Epoch: 14, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.796 Vali Acc: 0.959 Test Loss: 0.796 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1097s/iter; left time: 3885.6037s
	iters: 200, epoch: 15 | loss: 0.0000003
	speed: 0.0269s/iter; left time: 950.1407s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 937.5631s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 913.6682s
Epoch: 15 cost time: 11.623616218566895
Epoch: 15, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.619 Vali Acc: 0.968 Test Loss: 0.619 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1064s/iter; left time: 3726.1038s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 927.4821s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 966.4928s
	iters: 400, epoch: 16 | loss: 1.7067082
	speed: 0.0276s/iter; left time: 959.3873s
Epoch: 16 cost time: 11.765032291412354
Epoch: 16, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.679 Vali Acc: 0.969 Test Loss: 0.679 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1067s/iter; left time: 3689.6168s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 908.4300s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 896.8758s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 889.7387s
Epoch: 17 cost time: 11.415818214416504
Epoch: 17, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.480 Vali Acc: 0.978 Test Loss: 0.480 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0811196
	speed: 0.1015s/iter; left time: 3468.5846s
	iters: 200, epoch: 18 | loss: 0.4852707
	speed: 0.0255s/iter; left time: 867.8830s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 864.4103s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 895.4723s
Epoch: 18 cost time: 11.27527928352356
Epoch: 18, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.390 Vali Acc: 0.981 Test Loss: 0.390 Test Acc: 0.981
Validation loss decreased (-0.977714 --> -0.981351).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 3218.7430s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 891.9997s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 879.9680s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 899.0137s
Epoch: 19 cost time: 11.450326681137085
Epoch: 19, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.632 Vali Acc: 0.975 Test Loss: 0.632 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000172
	speed: 0.0973s/iter; left time: 3245.9262s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0280s/iter; left time: 932.2658s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 929.3966s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 939.7478s
Epoch: 20 cost time: 12.13901400566101
Epoch: 20, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.950 Vali Acc: 0.968 Test Loss: 0.950 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000015
	speed: 0.0988s/iter; left time: 3253.0236s
	iters: 200, epoch: 21 | loss: 0.7789140
	speed: 0.0275s/iter; left time: 901.7375s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 931.0626s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 929.3177s
Epoch: 21 cost time: 12.07268762588501
Epoch: 21, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.389 Vali Acc: 0.982 Test Loss: 0.389 Test Acc: 0.982
Validation loss decreased (-0.981351 --> -0.982261).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0964s/iter; left time: 3135.9426s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 888.7506s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 823.6903s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 858.0776s
Epoch: 22 cost time: 11.55666208267212
Epoch: 22, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.387 Vali Acc: 0.981 Test Loss: 0.387 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0915s/iter; left time: 2939.4395s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 851.8780s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 823.0990s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 811.5534s
Epoch: 23 cost time: 11.403820753097534
Epoch: 23, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.540 Vali Acc: 0.977 Test Loss: 0.540 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0749800
	speed: 0.0952s/iter; left time: 3018.5787s
	iters: 200, epoch: 24 | loss: 0.1210428
	speed: 0.0268s/iter; left time: 847.3785s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 846.0707s
	iters: 400, epoch: 24 | loss: 0.0864349
	speed: 0.0257s/iter; left time: 807.1224s
Epoch: 24 cost time: 11.430074691772461
Epoch: 24, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.429 Vali Acc: 0.979 Test Loss: 0.429 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0978s/iter; left time: 3060.9296s
	iters: 200, epoch: 25 | loss: 0.0000128
	speed: 0.0280s/iter; left time: 874.3374s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 862.6377s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 851.5925s
Epoch: 25 cost time: 12.074834823608398
Epoch: 25, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.354 Vali Acc: 0.979 Test Loss: 0.354 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1040s/iter; left time: 3210.0871s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 894.3944s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 891.3641s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 839.3589s
Epoch: 26 cost time: 12.18610429763794
Epoch: 26, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.516 Vali Acc: 0.976 Test Loss: 0.516 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1080s/iter; left time: 3289.3974s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 808.2375s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 806.2961s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 813.0656s
Epoch: 27 cost time: 11.710369110107422
Epoch: 27, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.447 Vali Acc: 0.975 Test Loss: 0.447 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 2771.6527s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 791.7838s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 813.1989s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 829.5099s
Epoch: 28 cost time: 11.754674911499023
Epoch: 28, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.578 Vali Acc: 0.973 Test Loss: 0.578 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0010144
	speed: 0.0879s/iter; left time: 2604.7144s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 818.3407s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 818.4302s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 792.3589s
Epoch: 29 cost time: 11.804645776748657
Epoch: 29, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.396 Vali Acc: 0.980 Test Loss: 0.396 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.0908s/iter; left time: 2653.0188s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 717.1633s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 816.1122s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 840.2089s
Epoch: 30 cost time: 11.730302572250366
Epoch: 30, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.628 Vali Acc: 0.976 Test Loss: 0.628 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1027s/iter; left time: 2960.1768s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 810.7128s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 740.4425s
	iters: 400, epoch: 31 | loss: 0.0001077
	speed: 0.0292s/iter; left time: 832.3511s
Epoch: 31 cost time: 12.082695484161377
Epoch: 31, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.392 Vali Acc: 0.984 Test Loss: 0.392 Test Acc: 0.984
Validation loss decreased (-0.982261 --> -0.983625).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1063s/iter; left time: 3018.6863s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 780.3334s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 742.8414s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 754.5870s
Epoch: 32 cost time: 11.638253211975098
Epoch: 32, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.251 Vali Acc: 0.985 Test Loss: 0.251 Test Acc: 0.985
Validation loss decreased (-0.983625 --> -0.984991).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1017s/iter; left time: 2844.7935s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 742.3549s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 740.6594s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 755.8528s
Epoch: 33 cost time: 11.588413000106812
Epoch: 33, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.618 Vali Acc: 0.980 Test Loss: 0.618 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 1.2566001
	speed: 0.0968s/iter; left time: 2670.1257s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 718.9418s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 733.6693s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 722.1486s
Epoch: 34 cost time: 11.41631555557251
Epoch: 34, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.570 Vali Acc: 0.979 Test Loss: 0.570 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1034s/iter; left time: 2807.0128s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 704.6328s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 727.4043s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 770.6328s
Epoch: 35 cost time: 11.82952618598938
Epoch: 35, Steps: 413 | Train Loss: 0.027 Vali Loss: 1.219 Vali Acc: 0.969 Test Loss: 1.219 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1158s/iter; left time: 3098.0138s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 716.1818s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 684.2638s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 726.9502s
Epoch: 36 cost time: 11.666086435317993
Epoch: 36, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.311 Vali Acc: 0.983 Test Loss: 0.311 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1185s/iter; left time: 3120.1258s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 702.9418s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 720.8136s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 703.3203s
Epoch: 37 cost time: 11.817846775054932
Epoch: 37, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.443 Vali Acc: 0.978 Test Loss: 0.443 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.0892s/iter; left time: 2312.3014s
	iters: 200, epoch: 38 | loss: 0.1863490
	speed: 0.0258s/iter; left time: 664.9868s
	iters: 300, epoch: 38 | loss: 1.0950983
	speed: 0.0269s/iter; left time: 691.6228s
	iters: 400, epoch: 38 | loss: 0.0000220
	speed: 0.0276s/iter; left time: 707.2323s
Epoch: 38 cost time: 11.481767177581787
Epoch: 38, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.552 Vali Acc: 0.974 Test Loss: 0.552 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.0923s/iter; left time: 2355.3138s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 674.0975s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 685.4269s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 666.7315s
Epoch: 39 cost time: 11.513266324996948
Epoch: 39, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.411 Vali Acc: 0.984 Test Loss: 0.411 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0000003
	speed: 0.0923s/iter; left time: 2316.5075s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 669.0635s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 664.1750s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 620.3504s
Epoch: 40 cost time: 11.361192464828491
Epoch: 40, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.442 Vali Acc: 0.978 Test Loss: 0.442 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0003656
	speed: 0.1012s/iter; left time: 2497.3088s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 703.5597s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 674.0825s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 686.7335s
Epoch: 41 cost time: 12.089707136154175
Epoch: 41, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.677 Vali Acc: 0.972 Test Loss: 0.677 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.1130s/iter; left time: 2741.8637s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 707.2095s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 668.2251s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 668.0669s
Epoch: 42 cost time: 12.41104793548584
Epoch: 42, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.770 Vali Acc: 0.970 Test Loss: 0.770 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 1171022
model size : 14.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0477315
	speed: 0.0430s/iter; left time: 1772.4765s
	iters: 200, epoch: 1 | loss: 0.3892030
	speed: 0.0244s/iter; left time: 1003.1974s
	iters: 300, epoch: 1 | loss: 0.0122607
	speed: 0.0252s/iter; left time: 1034.2136s
	iters: 400, epoch: 1 | loss: 0.2265256
	speed: 0.0257s/iter; left time: 1050.8605s
Epoch: 1 cost time: 12.235713958740234
Epoch: 1, Steps: 413 | Train Loss: 0.293 Vali Loss: 0.094 Vali Acc: 0.964 Test Loss: 0.094 Test Acc: 0.964
Validation loss decreased (inf --> -0.963619).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0022911
	speed: 0.0908s/iter; left time: 3703.3264s
	iters: 200, epoch: 2 | loss: 0.0736870
	speed: 0.0263s/iter; left time: 1068.6293s
	iters: 300, epoch: 2 | loss: 0.5550267
	speed: 0.0252s/iter; left time: 1023.0531s
	iters: 400, epoch: 2 | loss: 0.0610249
	speed: 0.0248s/iter; left time: 1005.1883s
Epoch: 2 cost time: 10.94735836982727
Epoch: 2, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2016778
	speed: 0.0911s/iter; left time: 3678.2140s
	iters: 200, epoch: 3 | loss: 0.0162222
	speed: 0.0273s/iter; left time: 1098.7628s
	iters: 300, epoch: 3 | loss: 0.0280807
	speed: 0.0255s/iter; left time: 1024.2569s
	iters: 400, epoch: 3 | loss: 0.0570901
	speed: 0.0265s/iter; left time: 1061.5232s
Epoch: 3 cost time: 11.418630599975586
Epoch: 3, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.208 Vali Acc: 0.970 Test Loss: 0.208 Test Acc: 0.970
Validation loss decreased (-0.963619 --> -0.969530).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0066563
	speed: 0.0981s/iter; left time: 3920.8529s
	iters: 200, epoch: 4 | loss: 0.1115153
	speed: 0.0265s/iter; left time: 1058.2478s
	iters: 300, epoch: 4 | loss: 0.0000096
	speed: 0.0269s/iter; left time: 1070.6868s
	iters: 400, epoch: 4 | loss: 0.0538902
	speed: 0.0267s/iter; left time: 1057.7169s
Epoch: 4 cost time: 11.33506989479065
Epoch: 4, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.230 Vali Acc: 0.972 Test Loss: 0.230 Test Acc: 0.972
Validation loss decreased (-0.969530 --> -0.971803).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2609826
	speed: 0.1014s/iter; left time: 4010.0566s
	iters: 200, epoch: 5 | loss: 0.0016631
	speed: 0.0238s/iter; left time: 938.0703s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 1026.3500s
	iters: 400, epoch: 5 | loss: 0.0000861
	speed: 0.0255s/iter; left time: 1001.5944s
Epoch: 5 cost time: 11.029003143310547
Epoch: 5, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.216 Vali Acc: 0.971 Test Loss: 0.216 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000003
	speed: 0.0893s/iter; left time: 3494.4296s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 985.4158s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 1033.9915s
	iters: 400, epoch: 6 | loss: 0.2956693
	speed: 0.0256s/iter; left time: 993.0961s
Epoch: 6 cost time: 11.142895936965942
Epoch: 6, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.324 Vali Acc: 0.963 Test Loss: 0.324 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 3571.9686s
	iters: 200, epoch: 7 | loss: 0.0001535
	speed: 0.0271s/iter; left time: 1045.1290s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0265s/iter; left time: 1019.3027s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 1059.6881s
Epoch: 7 cost time: 11.541702032089233
Epoch: 7, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.453 Vali Acc: 0.960 Test Loss: 0.453 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0003407
	speed: 0.0945s/iter; left time: 3621.5939s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 923.2285s
	iters: 300, epoch: 8 | loss: 0.0344895
	speed: 0.0273s/iter; left time: 1042.2658s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 962.6938s
Epoch: 8 cost time: 11.250959396362305
Epoch: 8, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.315 Vali Acc: 0.975 Test Loss: 0.315 Test Acc: 0.975
Validation loss decreased (-0.971803 --> -0.974531).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0454546
	speed: 0.1083s/iter; left time: 4103.4244s
	iters: 200, epoch: 9 | loss: 0.0000089
	speed: 0.0272s/iter; left time: 1028.3252s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0268s/iter; left time: 1011.8897s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0299s/iter; left time: 1123.2448s
Epoch: 9 cost time: 12.092488527297974
Epoch: 9, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.974531 --> -0.975440).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000031
	speed: 0.1187s/iter; left time: 4447.6860s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 1022.5356s
	iters: 300, epoch: 10 | loss: 0.0000098
	speed: 0.0267s/iter; left time: 994.9659s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 945.9115s
Epoch: 10 cost time: 11.616026639938354
Epoch: 10, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.218 Vali Acc: 0.983 Test Loss: 0.218 Test Acc: 0.983
Validation loss decreased (-0.975440 --> -0.982717).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0979s/iter; left time: 3630.6482s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 940.7384s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 954.2510s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 983.4046s
Epoch: 11 cost time: 11.145179271697998
Epoch: 11, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.217 Vali Acc: 0.981 Test Loss: 0.217 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0945s/iter; left time: 3464.6469s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 939.0751s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0255s/iter; left time: 928.0937s
	iters: 400, epoch: 12 | loss: 0.0000024
	speed: 0.0255s/iter; left time: 927.7971s
Epoch: 12 cost time: 11.015865802764893
Epoch: 12, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.274 Vali Acc: 0.977 Test Loss: 0.274 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0930s/iter; left time: 3369.4905s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 915.0230s
	iters: 300, epoch: 13 | loss: 0.2882671
	speed: 0.0257s/iter; left time: 926.8413s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 929.2407s
Epoch: 13 cost time: 11.086279392242432
Epoch: 13, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.377 Vali Acc: 0.976 Test Loss: 0.377 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000347
	speed: 0.0998s/iter; left time: 3576.9111s
	iters: 200, epoch: 14 | loss: 0.0000124
	speed: 0.0277s/iter; left time: 991.3731s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 982.9671s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 906.1726s
Epoch: 14 cost time: 11.718246698379517
Epoch: 14, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.415 Vali Acc: 0.969 Test Loss: 0.415 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0054990
	speed: 0.1078s/iter; left time: 3819.6620s
	iters: 200, epoch: 15 | loss: 0.0000012
	speed: 0.0282s/iter; left time: 994.9592s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 964.8925s
	iters: 400, epoch: 15 | loss: 0.0000076
	speed: 0.0267s/iter; left time: 938.9756s
Epoch: 15 cost time: 11.96534013748169
Epoch: 15, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.472 Vali Acc: 0.973 Test Loss: 0.472 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0013061
	speed: 0.1051s/iter; left time: 3677.8506s
	iters: 200, epoch: 16 | loss: 0.0000065
	speed: 0.0265s/iter; left time: 926.5918s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 938.2169s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 932.0849s
Epoch: 16 cost time: 11.515737533569336
Epoch: 16, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.434 Vali Acc: 0.976 Test Loss: 0.434 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0982s/iter; left time: 3397.1408s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 929.6592s
	iters: 300, epoch: 17 | loss: 0.0000013
	speed: 0.0259s/iter; left time: 890.8939s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 874.9912s
Epoch: 17 cost time: 11.312801361083984
Epoch: 17, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.385 Vali Acc: 0.974 Test Loss: 0.385 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0994s/iter; left time: 3397.7252s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0248s/iter; left time: 843.7080s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 858.9469s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 861.8770s
Epoch: 18 cost time: 10.958609819412231
Epoch: 18, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.486 Vali Acc: 0.970 Test Loss: 0.486 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0120138
	speed: 0.0962s/iter; left time: 3249.8973s
	iters: 200, epoch: 19 | loss: 0.0000018
	speed: 0.0266s/iter; left time: 896.8073s
	iters: 300, epoch: 19 | loss: 0.0000041
	speed: 0.0264s/iter; left time: 885.4905s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 890.8438s
Epoch: 19 cost time: 11.496703624725342
Epoch: 19, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.398 Vali Acc: 0.977 Test Loss: 0.398 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1033s/iter; left time: 3444.7129s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 875.3380s
	iters: 300, epoch: 20 | loss: 0.0000023
	speed: 0.0259s/iter; left time: 857.7644s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 878.6874s
Epoch: 20 cost time: 11.177781343460083
Epoch: 20, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.259 Vali Acc: 0.982 Test Loss: 0.259 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 1171022
model size : 14.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1061156
	speed: 0.0424s/iter; left time: 1747.5637s
	iters: 200, epoch: 1 | loss: 0.5103741
	speed: 0.0257s/iter; left time: 1057.2013s
	iters: 300, epoch: 1 | loss: 0.0061354
	speed: 0.0258s/iter; left time: 1059.0675s
	iters: 400, epoch: 1 | loss: 0.0166679
	speed: 0.0249s/iter; left time: 1017.4538s
Epoch: 1 cost time: 12.276840209960938
Epoch: 1, Steps: 413 | Train Loss: 0.319 Vali Loss: 0.078 Vali Acc: 0.971 Test Loss: 0.078 Test Acc: 0.971
Validation loss decreased (inf --> -0.971350).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0010033
	speed: 0.0939s/iter; left time: 3829.3696s
	iters: 200, epoch: 2 | loss: 0.1175722
	speed: 0.0253s/iter; left time: 1027.5659s
	iters: 300, epoch: 2 | loss: 0.6563917
	speed: 0.0260s/iter; left time: 1056.7659s
	iters: 400, epoch: 2 | loss: 0.0202114
	speed: 0.0259s/iter; left time: 1049.4597s
Epoch: 2 cost time: 10.966386556625366
Epoch: 2, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0020177
	speed: 0.0871s/iter; left time: 3516.7159s
	iters: 200, epoch: 3 | loss: 0.0129293
	speed: 0.0255s/iter; left time: 1026.3944s
	iters: 300, epoch: 3 | loss: 0.0015454
	speed: 0.0247s/iter; left time: 990.7241s
	iters: 400, epoch: 3 | loss: 0.1381891
	speed: 0.0273s/iter; left time: 1092.5008s
Epoch: 3 cost time: 10.975898742675781
Epoch: 3, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.250 Vali Acc: 0.959 Test Loss: 0.250 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0980996
	speed: 0.1058s/iter; left time: 4226.8736s
	iters: 200, epoch: 4 | loss: 0.0035725
	speed: 0.0269s/iter; left time: 1070.7602s
	iters: 300, epoch: 4 | loss: 0.0000044
	speed: 0.0265s/iter; left time: 1055.1659s
	iters: 400, epoch: 4 | loss: 0.4151566
	speed: 0.0247s/iter; left time: 981.0559s
Epoch: 4 cost time: 11.444026231765747
Epoch: 4, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.299 Vali Acc: 0.947 Test Loss: 0.299 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.8045450
	speed: 0.1029s/iter; left time: 4069.7602s
	iters: 200, epoch: 5 | loss: 0.8028269
	speed: 0.0270s/iter; left time: 1067.0275s
	iters: 300, epoch: 5 | loss: 0.0000909
	speed: 0.0276s/iter; left time: 1086.1852s
	iters: 400, epoch: 5 | loss: 0.1476037
	speed: 0.0259s/iter; left time: 1018.1019s
Epoch: 5 cost time: 11.453904867172241
Epoch: 5, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.287 Vali Acc: 0.965 Test Loss: 0.287 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.0834s/iter; left time: 3263.4989s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0238s/iter; left time: 930.7922s
	iters: 300, epoch: 6 | loss: 0.0000003
	speed: 0.0248s/iter; left time: 963.8035s
	iters: 400, epoch: 6 | loss: 0.0000111
	speed: 0.0245s/iter; left time: 953.4054s
Epoch: 6 cost time: 10.557566404342651
Epoch: 6, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.308 Vali Acc: 0.965 Test Loss: 0.308 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0476142
	speed: 0.0879s/iter; left time: 3402.8362s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 955.0035s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 929.6848s
	iters: 400, epoch: 7 | loss: 0.0000005
	speed: 0.0241s/iter; left time: 926.7719s
Epoch: 7 cost time: 10.561460733413696
Epoch: 7, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.382 Vali Acc: 0.956 Test Loss: 0.382 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000421
	speed: 0.0874s/iter; left time: 3348.9811s
	iters: 200, epoch: 8 | loss: 0.0469869
	speed: 0.0256s/iter; left time: 980.0687s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 916.8941s
	iters: 400, epoch: 8 | loss: 0.1792136
	speed: 0.0245s/iter; left time: 929.8308s
Epoch: 8 cost time: 10.893271684646606
Epoch: 8, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.288 Vali Acc: 0.973 Test Loss: 0.288 Test Acc: 0.973
Validation loss decreased (-0.971350 --> -0.972712).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.0914s/iter; left time: 3464.9169s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0263s/iter; left time: 995.3803s
	iters: 300, epoch: 9 | loss: 0.0064097
	speed: 0.0274s/iter; left time: 1032.9889s
	iters: 400, epoch: 9 | loss: 0.6982281
	speed: 0.0266s/iter; left time: 998.3208s
Epoch: 9 cost time: 11.488697052001953
Epoch: 9, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.317 Vali Acc: 0.973 Test Loss: 0.317 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1005s/iter; left time: 3767.4814s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 1039.6650s
	iters: 300, epoch: 10 | loss: 0.0000030
	speed: 0.0276s/iter; left time: 1030.2439s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 965.1789s
Epoch: 10 cost time: 11.456990003585815
Epoch: 10, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.443 Vali Acc: 0.969 Test Loss: 0.443 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0081150
	speed: 0.0995s/iter; left time: 3688.3767s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 952.3056s
	iters: 300, epoch: 11 | loss: 0.3480143
	speed: 0.0255s/iter; left time: 941.4142s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 953.1679s
Epoch: 11 cost time: 11.113286256790161
Epoch: 11, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.462 Vali Acc: 0.966 Test Loss: 0.462 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0866s/iter; left time: 3176.0936s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 934.7255s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 940.8396s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 959.6006s
Epoch: 12 cost time: 11.257080554962158
Epoch: 12, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.474 Vali Acc: 0.966 Test Loss: 0.474 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000395
	speed: 0.0879s/iter; left time: 3187.6078s
	iters: 200, epoch: 13 | loss: 0.0003782
	speed: 0.0257s/iter; left time: 929.1021s
	iters: 300, epoch: 13 | loss: 0.0000033
	speed: 0.0251s/iter; left time: 904.6140s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 912.4687s
Epoch: 13 cost time: 10.954758167266846
Epoch: 13, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.453 Vali Acc: 0.974 Test Loss: 0.453 Test Acc: 0.974
Validation loss decreased (-0.972712 --> -0.974075).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 3118.7195s
	iters: 200, epoch: 14 | loss: 0.0481727
	speed: 0.0260s/iter; left time: 927.3332s
	iters: 300, epoch: 14 | loss: 0.0000035
	speed: 0.0242s/iter; left time: 861.3885s
	iters: 400, epoch: 14 | loss: 0.4586964
	speed: 0.0239s/iter; left time: 847.8968s
Epoch: 14 cost time: 10.585971593856812
Epoch: 14, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.634 Vali Acc: 0.968 Test Loss: 0.634 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0995s/iter; left time: 3525.7303s
	iters: 200, epoch: 15 | loss: 0.0000007
	speed: 0.0262s/iter; left time: 926.2681s
	iters: 300, epoch: 15 | loss: 2.1237195
	speed: 0.0261s/iter; left time: 917.5012s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 886.6169s
Epoch: 15 cost time: 11.267654657363892
Epoch: 15, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.329 Vali Acc: 0.977 Test Loss: 0.329 Test Acc: 0.977
Validation loss decreased (-0.974075 --> -0.977259).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000021
	speed: 0.1029s/iter; left time: 3601.8365s
	iters: 200, epoch: 16 | loss: 0.2136021
	speed: 0.0252s/iter; left time: 879.3507s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 864.9541s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 867.6186s
Epoch: 16 cost time: 10.872241020202637
Epoch: 16, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.362 Vali Acc: 0.978 Test Loss: 0.362 Test Acc: 0.978
Validation loss decreased (-0.977259 --> -0.977714).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0999s/iter; left time: 3455.3225s
	iters: 200, epoch: 17 | loss: 0.0000004
	speed: 0.0252s/iter; left time: 869.1663s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 839.2552s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 837.8945s
Epoch: 17 cost time: 10.67311406135559
Epoch: 17, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.565 Vali Acc: 0.975 Test Loss: 0.565 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0960s/iter; left time: 3279.9820s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0248s/iter; left time: 844.7829s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 813.9738s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0248s/iter; left time: 838.5466s
Epoch: 18 cost time: 10.808271884918213
Epoch: 18, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.526 Vali Acc: 0.977 Test Loss: 0.526 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0931s/iter; left time: 3142.7522s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 829.1896s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0243s/iter; left time: 816.4702s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 827.3275s
Epoch: 19 cost time: 10.647432565689087
Epoch: 19, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.477 Vali Acc: 0.972 Test Loss: 0.477 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0947s/iter; left time: 3158.5994s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 908.4604s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 875.9763s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 883.4911s
Epoch: 20 cost time: 11.716409683227539
Epoch: 20, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.625 Vali Acc: 0.977 Test Loss: 0.625 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1000s/iter; left time: 3295.1811s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.0245s/iter; left time: 805.5160s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 868.2950s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 871.0493s
Epoch: 21 cost time: 11.268988609313965
Epoch: 21, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.501 Vali Acc: 0.972 Test Loss: 0.501 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0947s/iter; left time: 3081.3205s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 828.9581s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 782.0917s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 801.3717s
Epoch: 22 cost time: 10.819697618484497
Epoch: 22, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.897 Vali Acc: 0.970 Test Loss: 0.897 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.6934824
	speed: 0.0826s/iter; left time: 2653.5845s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 825.7839s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 829.6896s
	iters: 400, epoch: 23 | loss: 0.2586851
	speed: 0.0261s/iter; left time: 831.3991s
Epoch: 23 cost time: 11.073444843292236
Epoch: 23, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.791 Vali Acc: 0.964 Test Loss: 0.791 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 2664.7946s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 777.1615s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 789.2253s
	iters: 400, epoch: 24 | loss: 0.0152088
	speed: 0.0253s/iter; left time: 793.6012s
Epoch: 24 cost time: 10.7826087474823
Epoch: 24, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.363 Vali Acc: 0.983 Test Loss: 0.363 Test Acc: 0.983
Validation loss decreased (-0.977714 --> -0.982716).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0884s/iter; left time: 2765.2535s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 811.0559s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 807.6123s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 760.3975s
Epoch: 25 cost time: 10.958840370178223
Epoch: 25, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.509 Vali Acc: 0.975 Test Loss: 0.509 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000016
	speed: 0.1029s/iter; left time: 3177.0381s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 765.6826s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 740.1275s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0243s/iter; left time: 743.1495s
Epoch: 26 cost time: 10.685615539550781
Epoch: 26, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.792 Vali Acc: 0.973 Test Loss: 0.792 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0933s/iter; left time: 2843.1668s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 742.7616s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 755.8570s
	iters: 400, epoch: 27 | loss: 0.8359399
	speed: 0.0255s/iter; left time: 768.0670s
Epoch: 27 cost time: 10.672526359558105
Epoch: 27, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.407 Vali Acc: 0.984 Test Loss: 0.407 Test Acc: 0.984
Validation loss decreased (-0.982716 --> -0.984080).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0906s/iter; left time: 2722.6104s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0235s/iter; left time: 704.5433s
	iters: 300, epoch: 28 | loss: 0.0000001
	speed: 0.0235s/iter; left time: 701.1395s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0243s/iter; left time: 721.7482s
Epoch: 28 cost time: 10.330809116363525
Epoch: 28, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.683 Vali Acc: 0.967 Test Loss: 0.683 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.0917s/iter; left time: 2718.0725s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0236s/iter; left time: 697.1113s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0237s/iter; left time: 697.0657s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 710.6155s
Epoch: 29 cost time: 10.129715204238892
Epoch: 29, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.610 Vali Acc: 0.979 Test Loss: 0.610 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.0838s/iter; left time: 2449.4339s
	iters: 200, epoch: 30 | loss: 0.1616649
	speed: 0.0233s/iter; left time: 679.4535s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0238s/iter; left time: 690.5097s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0238s/iter; left time: 689.0701s
Epoch: 30 cost time: 10.19967770576477
Epoch: 30, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.613 Vali Acc: 0.978 Test Loss: 0.613 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 2325.3877s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 738.9935s
	iters: 300, epoch: 31 | loss: 0.0000259
	speed: 0.0251s/iter; left time: 717.5098s
	iters: 400, epoch: 31 | loss: 0.4467071
	speed: 0.0260s/iter; left time: 740.6494s
Epoch: 31 cost time: 10.691921472549438
Epoch: 31, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.480 Vali Acc: 0.979 Test Loss: 0.480 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.0888s/iter; left time: 2522.5452s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0238s/iter; left time: 674.7297s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 713.6718s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 719.8965s
Epoch: 32 cost time: 10.779776573181152
Epoch: 32, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.960 Vali Acc: 0.973 Test Loss: 0.960 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.0849s/iter; left time: 2375.7363s
	iters: 200, epoch: 33 | loss: 0.0000002
	speed: 0.0270s/iter; left time: 753.8514s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 611.1423s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 692.8795s
Epoch: 33 cost time: 10.628747701644897
Epoch: 33, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.910 Vali Acc: 0.971 Test Loss: 0.910 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.0792s/iter; left time: 2185.0223s
	iters: 200, epoch: 34 | loss: 0.0007178
	speed: 0.0244s/iter; left time: 671.6733s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 682.5806s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0243s/iter; left time: 662.9674s
Epoch: 34 cost time: 10.547567367553711
Epoch: 34, Steps: 413 | Train Loss: 0.108 Vali Loss: 1.235 Vali Acc: 0.968 Test Loss: 1.235 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2085.1403s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0230s/iter; left time: 621.5292s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 652.7640s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0237s/iter; left time: 636.1143s
Epoch: 35 cost time: 10.055813074111938
Epoch: 35, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.552 Vali Acc: 0.978 Test Loss: 0.552 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 2109.6661s
	iters: 200, epoch: 36 | loss: 0.0000001
	speed: 0.0241s/iter; left time: 643.0822s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 642.1932s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0226s/iter; left time: 598.0487s
Epoch: 36 cost time: 10.130337953567505
Epoch: 36, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.521 Vali Acc: 0.983 Test Loss: 0.521 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.0959s/iter; left time: 2524.4466s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 656.0511s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 642.7071s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 655.9980s
Epoch: 37 cost time: 10.648982524871826
Epoch: 37, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.658 Vali Acc: 0.975 Test Loss: 0.658 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 1171022
model size : 14.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0753330
	speed: 0.0416s/iter; left time: 1713.5589s
	iters: 200, epoch: 1 | loss: 0.0892074
	speed: 0.0202s/iter; left time: 832.1322s
	iters: 300, epoch: 1 | loss: 0.1071781
	speed: 0.0217s/iter; left time: 889.0941s
	iters: 400, epoch: 1 | loss: 0.0003239
	speed: 0.0265s/iter; left time: 1082.6380s
Epoch: 1 cost time: 11.435242891311646
Epoch: 1, Steps: 413 | Train Loss: 0.286 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
Validation loss decreased (inf --> -0.969076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0012833
	speed: 0.0910s/iter; left time: 3710.7794s
	iters: 200, epoch: 2 | loss: 0.1979869
	speed: 0.0233s/iter; left time: 948.4816s
	iters: 300, epoch: 2 | loss: 0.8578063
	speed: 0.0203s/iter; left time: 824.7985s
	iters: 400, epoch: 2 | loss: 0.1049874
	speed: 0.0190s/iter; left time: 768.1107s
Epoch: 2 cost time: 9.550804138183594
Epoch: 2, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969076 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000066
	speed: 0.0710s/iter; left time: 2868.5021s
	iters: 200, epoch: 3 | loss: 0.6698937
	speed: 0.0197s/iter; left time: 795.2347s
	iters: 300, epoch: 3 | loss: 0.0071965
	speed: 0.0203s/iter; left time: 814.3178s
	iters: 400, epoch: 3 | loss: 0.3390651
	speed: 0.0187s/iter; left time: 747.4911s
Epoch: 3 cost time: 8.6120126247406
Epoch: 3, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
Validation loss decreased (-0.970440 --> -0.973623).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000014
	speed: 0.0764s/iter; left time: 3051.2935s
	iters: 200, epoch: 4 | loss: 0.0039367
	speed: 0.0241s/iter; left time: 961.2148s
	iters: 300, epoch: 4 | loss: 0.0160184
	speed: 0.0248s/iter; left time: 985.7494s
	iters: 400, epoch: 4 | loss: 0.0004299
	speed: 0.0245s/iter; left time: 972.5301s
Epoch: 4 cost time: 10.539019584655762
Epoch: 4, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.364 Vali Acc: 0.954 Test Loss: 0.364 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0086047
	speed: 0.0774s/iter; left time: 3059.3110s
	iters: 200, epoch: 5 | loss: 0.0001526
	speed: 0.0245s/iter; left time: 965.4708s
	iters: 300, epoch: 5 | loss: 0.0006245
	speed: 0.0240s/iter; left time: 943.3764s
	iters: 400, epoch: 5 | loss: 0.0000023
	speed: 0.0244s/iter; left time: 956.4651s
Epoch: 5 cost time: 10.433845281600952
Epoch: 5, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.215 Vali Acc: 0.976 Test Loss: 0.215 Test Acc: 0.976
Validation loss decreased (-0.973623 --> -0.975896).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.0807s/iter; left time: 3158.7579s
	iters: 200, epoch: 6 | loss: 0.5426473
	speed: 0.0254s/iter; left time: 992.0166s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 1004.5305s
	iters: 400, epoch: 6 | loss: 0.0001142
	speed: 0.0255s/iter; left time: 991.6154s
Epoch: 6 cost time: 10.855337858200073
Epoch: 6, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.158 Vali Acc: 0.980 Test Loss: 0.158 Test Acc: 0.980
Validation loss decreased (-0.975896 --> -0.980444).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0003483
	speed: 0.0768s/iter; left time: 2975.0917s
	iters: 200, epoch: 7 | loss: 0.0018882
	speed: 0.0248s/iter; left time: 957.1329s
	iters: 300, epoch: 7 | loss: 0.0251793
	speed: 0.0253s/iter; left time: 975.4046s
	iters: 400, epoch: 7 | loss: 0.0000012
	speed: 0.0231s/iter; left time: 886.6045s
Epoch: 7 cost time: 10.47328805923462
Epoch: 7, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.312 Vali Acc: 0.973 Test Loss: 0.312 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0001594
	speed: 0.0902s/iter; left time: 3454.2308s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 944.5163s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 959.4965s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 956.2422s
Epoch: 8 cost time: 10.75105357170105
Epoch: 8, Steps: 413 | Train Loss: 0.154 Vali Loss: 0.363 Vali Acc: 0.976 Test Loss: 0.363 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0718319
	speed: 0.0869s/iter; left time: 3294.1023s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 961.6325s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 962.3551s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 936.6908s
Epoch: 9 cost time: 10.754953861236572
Epoch: 9, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.373 Vali Acc: 0.976 Test Loss: 0.373 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0188623
	speed: 0.0861s/iter; left time: 3226.5550s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0243s/iter; left time: 908.0243s
	iters: 300, epoch: 10 | loss: 0.0000002
	speed: 0.0248s/iter; left time: 925.1716s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 891.1008s
Epoch: 10 cost time: 10.560369729995728
Epoch: 10, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.0836s/iter; left time: 3098.2955s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0243s/iter; left time: 898.1127s
	iters: 300, epoch: 11 | loss: 0.5076146
	speed: 0.0242s/iter; left time: 891.7204s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 914.8880s
Epoch: 11 cost time: 10.56819772720337
Epoch: 11, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.656 Vali Acc: 0.964 Test Loss: 0.656 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000010
	speed: 0.0807s/iter; left time: 2959.3030s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0243s/iter; left time: 889.9689s
	iters: 300, epoch: 12 | loss: 0.3699212
	speed: 0.0245s/iter; left time: 894.0157s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 877.8364s
Epoch: 12 cost time: 10.4647376537323
Epoch: 12, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.396 Vali Acc: 0.973 Test Loss: 0.396 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000004
	speed: 0.0839s/iter; left time: 3040.4084s
	iters: 200, epoch: 13 | loss: 1.0267956
	speed: 0.0249s/iter; left time: 898.5699s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0241s/iter; left time: 868.7766s
	iters: 400, epoch: 13 | loss: 0.0524032
	speed: 0.0272s/iter; left time: 976.7387s
Epoch: 13 cost time: 10.92392110824585
Epoch: 13, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.444 Vali Acc: 0.970 Test Loss: 0.444 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000019
	speed: 0.0911s/iter; left time: 3265.6191s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 928.3177s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0239s/iter; left time: 851.1926s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0267s/iter; left time: 948.5454s
Epoch: 14 cost time: 11.154200553894043
Epoch: 14, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.274 Vali Acc: 0.982 Test Loss: 0.274 Test Acc: 0.982
Validation loss decreased (-0.980444 --> -0.982262).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0866s/iter; left time: 3068.4099s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 910.4735s
	iters: 300, epoch: 15 | loss: 0.0889325
	speed: 0.0253s/iter; left time: 892.3117s
	iters: 400, epoch: 15 | loss: 0.7131623
	speed: 0.0240s/iter; left time: 842.3069s
Epoch: 15 cost time: 10.89427399635315
Epoch: 15, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.318 Vali Acc: 0.978 Test Loss: 0.318 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 2833.5070s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 877.4326s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 923.1068s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 883.1790s
Epoch: 16 cost time: 10.846647024154663
Epoch: 16, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.437 Vali Acc: 0.977 Test Loss: 0.437 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 2727.9126s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 861.7868s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0246s/iter; left time: 845.3198s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 846.1538s
Epoch: 17 cost time: 10.641350746154785
Epoch: 17, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.379 Vali Acc: 0.983 Test Loss: 0.379 Test Acc: 0.983
Validation loss decreased (-0.982262 --> -0.982716).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0829s/iter; left time: 2832.0842s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0239s/iter; left time: 814.2099s
	iters: 300, epoch: 18 | loss: 0.0011197
	speed: 0.0235s/iter; left time: 798.9070s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0237s/iter; left time: 803.4964s
Epoch: 18 cost time: 10.276923894882202
Epoch: 18, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.431 Vali Acc: 0.978 Test Loss: 0.431 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000053
	speed: 0.0785s/iter; left time: 2651.1206s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 812.0690s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 841.4388s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 817.4700s
Epoch: 19 cost time: 10.311400651931763
Epoch: 19, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.167 Vali Acc: 0.985 Test Loss: 0.167 Test Acc: 0.985
Validation loss decreased (-0.982716 --> -0.984537).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0920s/iter; left time: 3068.7271s
	iters: 200, epoch: 20 | loss: 0.0000002
	speed: 0.0250s/iter; left time: 831.5738s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 797.1893s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0248s/iter; left time: 818.3903s
Epoch: 20 cost time: 10.5701744556427
Epoch: 20, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.320 Vali Acc: 0.984 Test Loss: 0.320 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 2917.2218s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 820.9727s
	iters: 300, epoch: 21 | loss: 0.6935047
	speed: 0.0241s/iter; left time: 790.2737s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 782.3049s
Epoch: 21 cost time: 10.484506130218506
Epoch: 21, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.406 Vali Acc: 0.976 Test Loss: 0.406 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 2680.5938s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 778.8688s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 775.8366s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 790.3429s
Epoch: 22 cost time: 10.355781316757202
Epoch: 22, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.354 Vali Acc: 0.983 Test Loss: 0.354 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 2562.8123s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0235s/iter; left time: 751.8485s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 788.1845s
	iters: 400, epoch: 23 | loss: 0.0084272
	speed: 0.0250s/iter; left time: 796.4115s
Epoch: 23 cost time: 10.398781538009644
Epoch: 23, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.541 Vali Acc: 0.976 Test Loss: 0.541 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 2569.4300s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 798.8206s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.0259s/iter; left time: 814.8872s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 785.9095s
Epoch: 24 cost time: 10.893214464187622
Epoch: 24, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.362 Vali Acc: 0.978 Test Loss: 0.362 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0784s/iter; left time: 2453.4797s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 769.1976s
	iters: 300, epoch: 25 | loss: 0.0011889
	speed: 0.0260s/iter; left time: 806.8650s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 790.8391s
Epoch: 25 cost time: 10.840599298477173
Epoch: 25, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.245 Vali Acc: 0.982 Test Loss: 0.245 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 2734.4812s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 785.9388s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 713.6683s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 799.5220s
Epoch: 26 cost time: 10.904480695724487
Epoch: 26, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.541 Vali Acc: 0.973 Test Loss: 0.541 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0871s/iter; left time: 2652.8078s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 778.6478s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 773.6429s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0239s/iter; left time: 720.4302s
Epoch: 27 cost time: 10.888969421386719
Epoch: 27, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.414 Vali Acc: 0.977 Test Loss: 0.414 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 2374.2965s
	iters: 200, epoch: 28 | loss: 0.4912511
	speed: 0.0251s/iter; left time: 751.5623s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 736.8825s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0236s/iter; left time: 702.8976s
Epoch: 28 cost time: 10.528700590133667
Epoch: 28, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.469 Vali Acc: 0.977 Test Loss: 0.469 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.0820s/iter; left time: 2431.4347s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0238s/iter; left time: 703.8041s
	iters: 300, epoch: 29 | loss: 0.0000018
	speed: 0.0253s/iter; left time: 744.6260s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 716.3192s
Epoch: 29 cost time: 10.496500015258789
Epoch: 29, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.295 Vali Acc: 0.986 Test Loss: 0.295 Test Acc: 0.986
Validation loss decreased (-0.984537 --> -0.986354).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000005
	speed: 0.0805s/iter; left time: 2352.8561s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 699.5233s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 698.8341s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 712.0489s
Epoch: 30 cost time: 10.320101261138916
Epoch: 30, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.342 Vali Acc: 0.978 Test Loss: 0.342 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 2235.6711s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 704.6798s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 711.5614s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 716.4987s
Epoch: 31 cost time: 10.479746580123901
Epoch: 31, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.373 Vali Acc: 0.980 Test Loss: 0.373 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000001
	speed: 0.0883s/iter; left time: 2506.5705s
	iters: 200, epoch: 32 | loss: 1.0951841
	speed: 0.0230s/iter; left time: 652.2074s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 729.2869s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 694.0776s
Epoch: 32 cost time: 10.610507249832153
Epoch: 32, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.461 Vali Acc: 0.978 Test Loss: 0.461 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.0901s/iter; left time: 2521.6280s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 719.6725s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0227s/iter; left time: 630.7580s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 677.7974s
Epoch: 33 cost time: 10.6582772731781
Epoch: 33, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.511 Vali Acc: 0.979 Test Loss: 0.511 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.0815s/iter; left time: 2246.0595s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 671.2819s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 681.7195s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 685.7613s
Epoch: 34 cost time: 10.682522535324097
Epoch: 34, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.448 Vali Acc: 0.978 Test Loss: 0.448 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.0803s/iter; left time: 2179.9779s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 665.8186s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 684.2756s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 681.2365s
Epoch: 35 cost time: 10.728594541549683
Epoch: 35, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.683 Vali Acc: 0.974 Test Loss: 0.683 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 2125.4727s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 678.9156s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 664.2704s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 660.4154s
Epoch: 36 cost time: 10.737948656082153
Epoch: 36, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.634 Vali Acc: 0.978 Test Loss: 0.634 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 2163.0697s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 682.5051s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 679.5005s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 680.8114s
Epoch: 37 cost time: 11.18759036064148
Epoch: 37, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.608 Vali Acc: 0.976 Test Loss: 0.608 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.0892s/iter; left time: 2311.9170s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 685.0484s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 651.8642s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 654.6494s
Epoch: 38 cost time: 10.959530353546143
Epoch: 38, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.759 Vali Acc: 0.970 Test Loss: 0.759 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.0888s/iter; left time: 2263.7715s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 611.9253s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 635.9533s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 622.3255s
Epoch: 39 cost time: 10.521251440048218
Epoch: 39, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.443 Vali Acc: 0.982 Test Loss: 0.443 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 1105486
model size : 13.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0936102
	speed: 0.0401s/iter; left time: 1653.6292s
	iters: 200, epoch: 1 | loss: 0.0748382
	speed: 0.0243s/iter; left time: 997.4295s
	iters: 300, epoch: 1 | loss: 0.0528615
	speed: 0.0241s/iter; left time: 987.5660s
	iters: 400, epoch: 1 | loss: 0.0039217
	speed: 0.0238s/iter; left time: 973.9195s
Epoch: 1 cost time: 11.60866117477417
Epoch: 1, Steps: 413 | Train Loss: 0.276 Vali Loss: 0.089 Vali Acc: 0.967 Test Loss: 0.089 Test Acc: 0.967
Validation loss decreased (inf --> -0.967257).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0015478
	speed: 0.0845s/iter; left time: 3444.6981s
	iters: 200, epoch: 2 | loss: 0.0173663
	speed: 0.0234s/iter; left time: 953.8962s
	iters: 300, epoch: 2 | loss: 0.3886240
	speed: 0.0233s/iter; left time: 945.9354s
	iters: 400, epoch: 2 | loss: 2.0507588
	speed: 0.0235s/iter; left time: 949.9645s
Epoch: 2 cost time: 10.163565635681152
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0170643
	speed: 0.0822s/iter; left time: 3318.1084s
	iters: 200, epoch: 3 | loss: 0.1045407
	speed: 0.0238s/iter; left time: 958.0495s
	iters: 300, epoch: 3 | loss: 0.0000517
	speed: 0.0244s/iter; left time: 980.8370s
	iters: 400, epoch: 3 | loss: 0.0000321
	speed: 0.0240s/iter; left time: 963.3689s
Epoch: 3 cost time: 10.396090745925903
Epoch: 3, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
Validation loss decreased (-0.967257 --> -0.976352).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0002075
	speed: 0.0864s/iter; left time: 3453.1786s
	iters: 200, epoch: 4 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 979.7917s
	iters: 300, epoch: 4 | loss: 0.0266337
	speed: 0.0236s/iter; left time: 937.3495s
	iters: 400, epoch: 4 | loss: 0.0776063
	speed: 0.0247s/iter; left time: 978.6814s
Epoch: 4 cost time: 10.371973991394043
Epoch: 4, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.128 Vali Acc: 0.979 Test Loss: 0.128 Test Acc: 0.979
Validation loss decreased (-0.976352 --> -0.978625).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.0912s/iter; left time: 3608.6545s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 954.1021s
	iters: 300, epoch: 5 | loss: 0.1604893
	speed: 0.0237s/iter; left time: 931.9362s
	iters: 400, epoch: 5 | loss: 0.5235734
	speed: 0.0250s/iter; left time: 982.5063s
Epoch: 5 cost time: 10.65651535987854
Epoch: 5, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.267 Vali Acc: 0.973 Test Loss: 0.267 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0050041
	speed: 0.0788s/iter; left time: 3084.2550s
	iters: 200, epoch: 6 | loss: 0.0000002
	speed: 0.0249s/iter; left time: 970.1764s
	iters: 300, epoch: 6 | loss: 0.0010631
	speed: 0.0239s/iter; left time: 931.2182s
	iters: 400, epoch: 6 | loss: 0.3974938
	speed: 0.0232s/iter; left time: 902.1374s
Epoch: 6 cost time: 10.416411638259888
Epoch: 6, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.0794s/iter; left time: 3074.6722s
	iters: 200, epoch: 7 | loss: 0.0000315
	speed: 0.0239s/iter; left time: 921.5229s
	iters: 300, epoch: 7 | loss: 0.0084693
	speed: 0.0249s/iter; left time: 957.4452s
	iters: 400, epoch: 7 | loss: 0.0163321
	speed: 0.0236s/iter; left time: 905.2314s
Epoch: 7 cost time: 10.372015237808228
Epoch: 7, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.277 Vali Acc: 0.970 Test Loss: 0.277 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000718
	speed: 0.0779s/iter; left time: 2982.7542s
	iters: 200, epoch: 8 | loss: 0.0000029
	speed: 0.0247s/iter; left time: 942.6267s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0243s/iter; left time: 924.5455s
	iters: 400, epoch: 8 | loss: 0.0127763
	speed: 0.0246s/iter; left time: 934.4842s
Epoch: 8 cost time: 10.493550777435303
Epoch: 8, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.823 Vali Acc: 0.952 Test Loss: 0.823 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.0856s/iter; left time: 3245.1122s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 905.2512s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0236s/iter; left time: 888.6782s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 908.9461s
Epoch: 9 cost time: 10.44007921218872
Epoch: 9, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.374 Vali Acc: 0.979 Test Loss: 0.374 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 3230.8191s
	iters: 200, epoch: 10 | loss: 0.0000003
	speed: 0.0237s/iter; left time: 887.3151s
	iters: 300, epoch: 10 | loss: 0.0001751
	speed: 0.0237s/iter; left time: 884.6111s
	iters: 400, epoch: 10 | loss: 0.3371800
	speed: 0.0242s/iter; left time: 899.2862s
Epoch: 10 cost time: 10.319023132324219
Epoch: 10, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.362 Vali Acc: 0.969 Test Loss: 0.362 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 3199.1443s
	iters: 200, epoch: 11 | loss: 0.0000010
	speed: 0.0221s/iter; left time: 817.3643s
	iters: 300, epoch: 11 | loss: 0.0011749
	speed: 0.0244s/iter; left time: 899.0946s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0236s/iter; left time: 867.6841s
Epoch: 11 cost time: 10.010108709335327
Epoch: 11, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.463 Vali Acc: 0.976 Test Loss: 0.463 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 3003.1359s
	iters: 200, epoch: 12 | loss: 0.0000004
	speed: 0.0240s/iter; left time: 875.8933s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 875.6217s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 917.6241s
Epoch: 12 cost time: 10.511829614639282
Epoch: 12, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.524 Vali Acc: 0.967 Test Loss: 0.524 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000070
	speed: 0.0800s/iter; left time: 2900.5761s
	iters: 200, epoch: 13 | loss: 0.0000029
	speed: 0.0230s/iter; left time: 832.0072s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 871.7438s
	iters: 400, epoch: 13 | loss: 0.7830352
	speed: 0.0230s/iter; left time: 825.8341s
Epoch: 13 cost time: 10.046702146530151
Epoch: 13, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.445 Vali Acc: 0.982 Test Loss: 0.445 Test Acc: 0.982
Validation loss decreased (-0.978625 --> -0.982260).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0044226
	speed: 0.0808s/iter; left time: 2894.0093s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 786.4709s
	iters: 300, epoch: 14 | loss: 0.0000004
	speed: 0.0231s/iter; left time: 821.8687s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 792.9696s
Epoch: 14 cost time: 9.766718864440918
Epoch: 14, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.493 Vali Acc: 0.967 Test Loss: 0.493 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0833s/iter; left time: 2950.3590s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 916.1901s
	iters: 300, epoch: 15 | loss: 0.0000282
	speed: 0.0263s/iter; left time: 926.4469s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 906.6593s
Epoch: 15 cost time: 11.03164029121399
Epoch: 15, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.361 Vali Acc: 0.976 Test Loss: 0.361 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 3022.6006s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 918.7518s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 923.4088s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 874.0923s
Epoch: 16 cost time: 11.171773433685303
Epoch: 16, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.235 Vali Acc: 0.982 Test Loss: 0.235 Test Acc: 0.982
Validation loss decreased (-0.982260 --> -0.982262).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000008
	speed: 0.0868s/iter; left time: 3002.3492s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0238s/iter; left time: 820.1377s
	iters: 300, epoch: 17 | loss: 0.0007968
	speed: 0.0246s/iter; left time: 846.7351s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 821.8436s
Epoch: 17 cost time: 10.264599323272705
Epoch: 17, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.296 Vali Acc: 0.978 Test Loss: 0.296 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0469688
	speed: 0.0768s/iter; left time: 2624.7799s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 838.7454s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 822.4621s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 843.9282s
Epoch: 18 cost time: 10.431476593017578
Epoch: 18, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.489 Vali Acc: 0.978 Test Loss: 0.489 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 2783.1864s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 807.8085s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0236s/iter; left time: 793.5999s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0236s/iter; left time: 791.2391s
Epoch: 19 cost time: 10.092025756835938
Epoch: 19, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.343 Vali Acc: 0.984 Test Loss: 0.343 Test Acc: 0.984
Validation loss decreased (-0.982262 --> -0.984080).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0003147
	speed: 0.0803s/iter; left time: 2677.9188s
	iters: 200, epoch: 20 | loss: 0.0035904
	speed: 0.0235s/iter; left time: 783.0936s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 799.6418s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0237s/iter; left time: 781.7412s
Epoch: 20 cost time: 10.157585620880127
Epoch: 20, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.372 Vali Acc: 0.980 Test Loss: 0.372 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0906s/iter; left time: 2985.2818s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 812.5452s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 804.7982s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 805.4258s
Epoch: 21 cost time: 10.616116523742676
Epoch: 21, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.550 Vali Acc: 0.973 Test Loss: 0.550 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0889s/iter; left time: 2893.1087s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0239s/iter; left time: 775.5276s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 811.1556s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 788.8855s
Epoch: 22 cost time: 10.563433170318604
Epoch: 22, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.360 Vali Acc: 0.978 Test Loss: 0.360 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 2701.4390s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0239s/iter; left time: 765.3007s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 773.9309s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 770.8497s
Epoch: 23 cost time: 10.148918628692627
Epoch: 23, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.370 Vali Acc: 0.979 Test Loss: 0.370 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0792s/iter; left time: 2510.7500s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0234s/iter; left time: 738.6498s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0230s/iter; left time: 725.9908s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 757.4087s
Epoch: 24 cost time: 10.025148868560791
Epoch: 24, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.325 Vali Acc: 0.981 Test Loss: 0.325 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 2475.4406s
	iters: 200, epoch: 25 | loss: 0.0985230
	speed: 0.0248s/iter; left time: 772.1642s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 765.3600s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0248s/iter; left time: 768.9744s
Epoch: 25 cost time: 10.457707405090332
Epoch: 25, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.613 Vali Acc: 0.974 Test Loss: 0.613 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0803s/iter; left time: 2479.8694s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0248s/iter; left time: 762.2928s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 740.8175s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 745.0567s
Epoch: 26 cost time: 10.473689556121826
Epoch: 26, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.444 Vali Acc: 0.979 Test Loss: 0.444 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0889s/iter; left time: 2707.7548s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 783.7793s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 803.0390s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 775.1358s
Epoch: 27 cost time: 11.110300302505493
Epoch: 27, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.426 Vali Acc: 0.976 Test Loss: 0.426 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0898s/iter; left time: 2698.4564s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 765.9407s
	iters: 300, epoch: 28 | loss: 0.0000156
	speed: 0.0262s/iter; left time: 783.4873s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 788.3457s
Epoch: 28 cost time: 11.123658418655396
Epoch: 28, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.496 Vali Acc: 0.973 Test Loss: 0.496 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000025
	speed: 0.0780s/iter; left time: 2310.8660s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0228s/iter; left time: 672.4916s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 728.2804s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 709.5305s
Epoch: 29 cost time: 10.348814249038696
Epoch: 29, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.401 Vali Acc: 0.981 Test Loss: 0.401 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 1105486
model size : 13.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1125628
	speed: 0.0426s/iter; left time: 1754.8467s
	iters: 200, epoch: 1 | loss: 0.0474956
	speed: 0.0255s/iter; left time: 1048.6324s
	iters: 300, epoch: 1 | loss: 0.0387895
	speed: 0.0259s/iter; left time: 1060.7692s
	iters: 400, epoch: 1 | loss: 0.0014014
	speed: 0.0266s/iter; left time: 1089.6554s
Epoch: 1 cost time: 12.440982103347778
Epoch: 1, Steps: 413 | Train Loss: 0.284 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (inf --> -0.961799).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0002768
	speed: 0.0834s/iter; left time: 3401.0480s
	iters: 200, epoch: 2 | loss: 0.3875554
	speed: 0.0254s/iter; left time: 1031.7857s
	iters: 300, epoch: 2 | loss: 0.0404028
	speed: 0.0256s/iter; left time: 1037.3405s
	iters: 400, epoch: 2 | loss: 0.0068912
	speed: 0.0254s/iter; left time: 1027.6440s
Epoch: 2 cost time: 10.94172978401184
Epoch: 2, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
Validation loss decreased (-0.961799 --> -0.963164).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0002189
	speed: 0.0948s/iter; left time: 3828.6280s
	iters: 200, epoch: 3 | loss: 0.0099931
	speed: 0.0261s/iter; left time: 1050.5590s
	iters: 300, epoch: 3 | loss: 0.0000066
	speed: 0.0255s/iter; left time: 1024.2044s
	iters: 400, epoch: 3 | loss: 0.2364851
	speed: 0.0257s/iter; left time: 1031.8677s
Epoch: 3 cost time: 10.981751918792725
Epoch: 3, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.963164 --> -0.975442).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001391
	speed: 0.0933s/iter; left time: 3729.7007s
	iters: 200, epoch: 4 | loss: 0.0000002
	speed: 0.0228s/iter; left time: 906.9697s
	iters: 300, epoch: 4 | loss: 0.5076055
	speed: 0.0246s/iter; left time: 977.1312s
	iters: 400, epoch: 4 | loss: 0.0031685
	speed: 0.0250s/iter; left time: 991.3617s
Epoch: 4 cost time: 10.543799638748169
Epoch: 4, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.200 Vali Acc: 0.970 Test Loss: 0.200 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000122
	speed: 0.0836s/iter; left time: 3307.0767s
	iters: 200, epoch: 5 | loss: 0.8470186
	speed: 0.0254s/iter; left time: 1001.4986s
	iters: 300, epoch: 5 | loss: 0.0000015
	speed: 0.0258s/iter; left time: 1013.5430s
	iters: 400, epoch: 5 | loss: 0.0000206
	speed: 0.0248s/iter; left time: 973.1845s
Epoch: 5 cost time: 10.742705583572388
Epoch: 5, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.262 Vali Acc: 0.965 Test Loss: 0.262 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000034
	speed: 0.0819s/iter; left time: 3203.2942s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 1000.1564s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 962.7006s
	iters: 400, epoch: 6 | loss: 0.0055360
	speed: 0.0254s/iter; left time: 987.9894s
Epoch: 6 cost time: 10.768875122070312
Epoch: 6, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.287 Vali Acc: 0.969 Test Loss: 0.287 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.0835s/iter; left time: 3231.7171s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 993.9155s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0238s/iter; left time: 916.2421s
	iters: 400, epoch: 7 | loss: 0.0566075
	speed: 0.0276s/iter; left time: 1058.9711s
Epoch: 7 cost time: 10.98076605796814
Epoch: 7, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.546 Vali Acc: 0.960 Test Loss: 0.546 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1973408
	speed: 0.0944s/iter; left time: 3617.4058s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 1039.1530s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 987.2852s
	iters: 400, epoch: 8 | loss: 0.0286184
	speed: 0.0270s/iter; left time: 1027.5607s
Epoch: 8 cost time: 11.410404920578003
Epoch: 8, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.343 Vali Acc: 0.974 Test Loss: 0.343 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.0938s/iter; left time: 3555.1812s
	iters: 200, epoch: 9 | loss: 0.0000041
	speed: 0.0260s/iter; left time: 981.0484s
	iters: 300, epoch: 9 | loss: 0.0000017
	speed: 0.0261s/iter; left time: 984.5058s
	iters: 400, epoch: 9 | loss: 0.0000040
	speed: 0.0232s/iter; left time: 871.2138s
Epoch: 9 cost time: 10.83515191078186
Epoch: 9, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.233 Vali Acc: 0.973 Test Loss: 0.233 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.0843s/iter; left time: 3161.1118s
	iters: 200, epoch: 10 | loss: 0.0000118
	speed: 0.0246s/iter; left time: 920.1228s
	iters: 300, epoch: 10 | loss: 0.0000003
	speed: 0.0255s/iter; left time: 950.7792s
	iters: 400, epoch: 10 | loss: 0.3877684
	speed: 0.0236s/iter; left time: 878.0495s
Epoch: 10 cost time: 10.543895483016968
Epoch: 10, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.364 Vali Acc: 0.975 Test Loss: 0.364 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000619
	speed: 0.0840s/iter; left time: 3115.4364s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 861.5169s
	iters: 300, epoch: 11 | loss: 0.3858650
	speed: 0.0248s/iter; left time: 912.9059s
	iters: 400, epoch: 11 | loss: 0.0000277
	speed: 0.0252s/iter; left time: 925.5281s
Epoch: 11 cost time: 10.471770763397217
Epoch: 11, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.333 Vali Acc: 0.975 Test Loss: 0.333 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0806s/iter; left time: 2955.5643s
	iters: 200, epoch: 12 | loss: 0.6245072
	speed: 0.0242s/iter; left time: 884.9143s
	iters: 300, epoch: 12 | loss: 0.0000052
	speed: 0.0248s/iter; left time: 905.7573s
	iters: 400, epoch: 12 | loss: 0.0067931
	speed: 0.0236s/iter; left time: 857.3219s
Epoch: 12 cost time: 10.365814685821533
Epoch: 12, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.320 Vali Acc: 0.975 Test Loss: 0.320 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0905s/iter; left time: 3279.9233s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0243s/iter; left time: 878.2885s
	iters: 300, epoch: 13 | loss: 0.1127858
	speed: 0.0255s/iter; left time: 919.4678s
	iters: 400, epoch: 13 | loss: 0.9302506
	speed: 0.0265s/iter; left time: 954.2473s
Epoch: 13 cost time: 10.816941022872925
Epoch: 13, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.451 Vali Acc: 0.970 Test Loss: 0.451 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 1105486
model size : 13.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1574776
	speed: 0.0425s/iter; left time: 1752.3950s
	iters: 200, epoch: 1 | loss: 0.0289504
	speed: 0.0234s/iter; left time: 960.2506s
	iters: 300, epoch: 1 | loss: 0.0398638
	speed: 0.0241s/iter; left time: 988.6522s
	iters: 400, epoch: 1 | loss: 0.0004017
	speed: 0.0235s/iter; left time: 959.6472s
Epoch: 1 cost time: 11.708370447158813
Epoch: 1, Steps: 413 | Train Loss: 0.309 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
Validation loss decreased (inf --> -0.974988).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0002449
	speed: 0.0784s/iter; left time: 3196.7031s
	iters: 200, epoch: 2 | loss: 0.0036131
	speed: 0.0250s/iter; left time: 1016.1944s
	iters: 300, epoch: 2 | loss: 0.1781633
	speed: 0.0236s/iter; left time: 956.1875s
	iters: 400, epoch: 2 | loss: 0.0155773
	speed: 0.0239s/iter; left time: 966.3042s
Epoch: 2 cost time: 10.354567527770996
Epoch: 2, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.234 Vali Acc: 0.946 Test Loss: 0.234 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000011
	speed: 0.0784s/iter; left time: 3164.7453s
	iters: 200, epoch: 3 | loss: 0.0002251
	speed: 0.0267s/iter; left time: 1076.8110s
	iters: 300, epoch: 3 | loss: 0.0040579
	speed: 0.0252s/iter; left time: 1011.5449s
	iters: 400, epoch: 3 | loss: 0.0000252
	speed: 0.0244s/iter; left time: 976.3561s
Epoch: 3 cost time: 10.681928396224976
Epoch: 3, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.210 Vali Acc: 0.968 Test Loss: 0.210 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0236041
	speed: 0.0807s/iter; left time: 3222.9496s
	iters: 200, epoch: 4 | loss: 0.0000501
	speed: 0.0239s/iter; left time: 953.4234s
	iters: 300, epoch: 4 | loss: 0.0014628
	speed: 0.0240s/iter; left time: 956.2458s
	iters: 400, epoch: 4 | loss: 0.4070223
	speed: 0.0250s/iter; left time: 991.4592s
Epoch: 4 cost time: 10.494606018066406
Epoch: 4, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.354 Vali Acc: 0.946 Test Loss: 0.354 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3286306
	speed: 0.0903s/iter; left time: 3572.9767s
	iters: 200, epoch: 5 | loss: 0.0000347
	speed: 0.0244s/iter; left time: 963.6525s
	iters: 300, epoch: 5 | loss: 0.0000002
	speed: 0.0236s/iter; left time: 928.4138s
	iters: 400, epoch: 5 | loss: 0.0000001
	speed: 0.0244s/iter; left time: 957.3830s
Epoch: 5 cost time: 10.451297760009766
Epoch: 5, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.262 Vali Acc: 0.967 Test Loss: 0.262 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000021
	speed: 0.0908s/iter; left time: 3553.4821s
	iters: 200, epoch: 6 | loss: 0.0452691
	speed: 0.0251s/iter; left time: 978.7838s
	iters: 300, epoch: 6 | loss: 0.0005452
	speed: 0.0243s/iter; left time: 946.2714s
	iters: 400, epoch: 6 | loss: 0.3154784
	speed: 0.0235s/iter; left time: 910.8843s
Epoch: 6 cost time: 10.413511991500854
Epoch: 6, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.459 Vali Acc: 0.965 Test Loss: 0.459 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000003
	speed: 0.0804s/iter; left time: 3112.9224s
	iters: 200, epoch: 7 | loss: 0.0000028
	speed: 0.0236s/iter; left time: 909.6245s
	iters: 300, epoch: 7 | loss: 0.1988675
	speed: 0.0238s/iter; left time: 915.4953s
	iters: 400, epoch: 7 | loss: 0.0000145
	speed: 0.0242s/iter; left time: 931.2657s
Epoch: 7 cost time: 10.199158906936646
Epoch: 7, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.524 Vali Acc: 0.963 Test Loss: 0.524 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0004706
	speed: 0.0847s/iter; left time: 3244.5156s
	iters: 200, epoch: 8 | loss: 0.0000107
	speed: 0.0238s/iter; left time: 907.8050s
	iters: 300, epoch: 8 | loss: 0.1278614
	speed: 0.0246s/iter; left time: 939.1185s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 937.4289s
Epoch: 8 cost time: 10.347697973251343
Epoch: 8, Steps: 413 | Train Loss: 0.112 Vali Loss: 1.178 Vali Acc: 0.934 Test Loss: 1.178 Test Acc: 0.934
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000003
	speed: 0.0840s/iter; left time: 3185.0952s
	iters: 200, epoch: 9 | loss: 0.0000010
	speed: 0.0240s/iter; left time: 905.9730s
	iters: 300, epoch: 9 | loss: 0.0009006
	speed: 0.0241s/iter; left time: 908.7945s
	iters: 400, epoch: 9 | loss: 0.0000076
	speed: 0.0235s/iter; left time: 882.7909s
Epoch: 9 cost time: 10.28779649734497
Epoch: 9, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.303 Vali Acc: 0.979 Test Loss: 0.303 Test Acc: 0.979
Validation loss decreased (-0.974988 --> -0.979078).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0039455
	speed: 0.0888s/iter; left time: 3329.0377s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 1025.7843s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 929.5305s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0249s/iter; left time: 927.6921s
Epoch: 10 cost time: 11.067334413528442
Epoch: 10, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 3315.8889s
	iters: 200, epoch: 11 | loss: 0.3946686
	speed: 0.0252s/iter; left time: 933.2259s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 930.6640s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 901.0810s
Epoch: 11 cost time: 10.732988119125366
Epoch: 11, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.410 Vali Acc: 0.974 Test Loss: 0.410 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0905s/iter; left time: 3318.4008s
	iters: 200, epoch: 12 | loss: 0.0000059
	speed: 0.0238s/iter; left time: 869.8196s
	iters: 300, epoch: 12 | loss: 0.0177111
	speed: 0.0222s/iter; left time: 808.4396s
	iters: 400, epoch: 12 | loss: 1.6425709
	speed: 0.0247s/iter; left time: 896.9417s
Epoch: 12 cost time: 10.02665400505066
Epoch: 12, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.551 Vali Acc: 0.970 Test Loss: 0.551 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0008777
	speed: 0.0741s/iter; left time: 2685.7058s
	iters: 200, epoch: 13 | loss: 0.0036929
	speed: 0.0234s/iter; left time: 846.1209s
	iters: 300, epoch: 13 | loss: 0.0000043
	speed: 0.0224s/iter; left time: 808.6360s
	iters: 400, epoch: 13 | loss: 0.0000003
	speed: 0.0239s/iter; left time: 860.7085s
Epoch: 13 cost time: 9.919338703155518
Epoch: 13, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.629 Vali Acc: 0.962 Test Loss: 0.629 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0802s/iter; left time: 2874.0863s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 901.5489s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 911.4675s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 884.4878s
Epoch: 14 cost time: 10.821040868759155
Epoch: 14, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.600 Vali Acc: 0.975 Test Loss: 0.600 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 2891.3880s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 894.5236s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 949.9619s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 933.9218s
Epoch: 15 cost time: 11.065781593322754
Epoch: 15, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.558 Vali Acc: 0.975 Test Loss: 0.558 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 3102.5390s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 852.6874s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 903.3420s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 892.3666s
Epoch: 16 cost time: 10.940644264221191
Epoch: 16, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.404 Vali Acc: 0.980 Test Loss: 0.404 Test Acc: 0.980
Validation loss decreased (-0.979078 --> -0.979532).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2438180
	speed: 0.0936s/iter; left time: 3238.5194s
	iters: 200, epoch: 17 | loss: 0.0000008
	speed: 0.0229s/iter; left time: 789.1361s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0235s/iter; left time: 808.1308s
	iters: 400, epoch: 17 | loss: 0.0069183
	speed: 0.0243s/iter; left time: 833.4530s
Epoch: 17 cost time: 10.403064012527466
Epoch: 17, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.665 Vali Acc: 0.969 Test Loss: 0.665 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000012
	speed: 0.0818s/iter; left time: 2796.6602s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 839.8526s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 845.6452s
	iters: 400, epoch: 18 | loss: 0.0978947
	speed: 0.0247s/iter; left time: 837.9044s
Epoch: 18 cost time: 10.329200506210327
Epoch: 18, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.495 Vali Acc: 0.970 Test Loss: 0.495 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 2771.7337s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 811.2001s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 845.1813s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0238s/iter; left time: 795.8137s
Epoch: 19 cost time: 10.541579484939575
Epoch: 19, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.333 Vali Acc: 0.983 Test Loss: 0.333 Test Acc: 0.983
Validation loss decreased (-0.979532 --> -0.983171).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0812s/iter; left time: 2707.5362s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 833.4950s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 862.6890s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 832.1075s
Epoch: 20 cost time: 10.689018726348877
Epoch: 20, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.486 Vali Acc: 0.978 Test Loss: 0.486 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0940s/iter; left time: 3096.0206s
	iters: 200, epoch: 21 | loss: 1.9323034
	speed: 0.0242s/iter; left time: 794.4631s
	iters: 300, epoch: 21 | loss: 0.0000073
	speed: 0.0245s/iter; left time: 802.4401s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0228s/iter; left time: 743.1663s
Epoch: 21 cost time: 10.414778232574463
Epoch: 21, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.538 Vali Acc: 0.973 Test Loss: 0.538 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0944s/iter; left time: 3070.9067s
	iters: 200, epoch: 22 | loss: 0.0000004
	speed: 0.0246s/iter; left time: 797.5425s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 789.5453s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 827.1162s
Epoch: 22 cost time: 10.745819807052612
Epoch: 22, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.569 Vali Acc: 0.976 Test Loss: 0.569 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0836s/iter; left time: 2685.5538s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 818.0701s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 771.2714s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 777.7402s
Epoch: 23 cost time: 10.772982358932495
Epoch: 23, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.615 Vali Acc: 0.972 Test Loss: 0.615 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 2566.1234s
	iters: 200, epoch: 24 | loss: 0.0014443
	speed: 0.0244s/iter; left time: 772.1622s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0234s/iter; left time: 738.6581s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 822.0931s
Epoch: 24 cost time: 10.580938577651978
Epoch: 24, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.360 Vali Acc: 0.979 Test Loss: 0.360 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 2551.7592s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 759.4880s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0232s/iter; left time: 719.7440s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0243s/iter; left time: 753.1817s
Epoch: 25 cost time: 10.366543292999268
Epoch: 25, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.521 Vali Acc: 0.978 Test Loss: 0.521 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0840s/iter; left time: 2594.4020s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 784.5961s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 756.4148s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 767.0628s
Epoch: 26 cost time: 10.774471044540405
Epoch: 26, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.621 Vali Acc: 0.970 Test Loss: 0.621 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0919s/iter; left time: 2799.1012s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 742.0638s
	iters: 300, epoch: 27 | loss: 1.5171473
	speed: 0.0247s/iter; left time: 746.3495s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 753.8439s
Epoch: 27 cost time: 10.660894632339478
Epoch: 27, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.713 Vali Acc: 0.976 Test Loss: 0.713 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 2809.5222s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0232s/iter; left time: 695.2231s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0234s/iter; left time: 699.2434s
	iters: 400, epoch: 28 | loss: 4.2386055
	speed: 0.0231s/iter; left time: 687.2958s
Epoch: 28 cost time: 10.251336336135864
Epoch: 28, Steps: 413 | Train Loss: 0.095 Vali Loss: 1.058 Vali Acc: 0.966 Test Loss: 1.058 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000027
	speed: 0.0830s/iter; left time: 2459.9351s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 714.8265s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 720.2197s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 706.9944s
Epoch: 29 cost time: 10.140315532684326
Epoch: 29, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.548 Vali Acc: 0.980 Test Loss: 0.548 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 1105486
model size : 13.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1863499
	speed: 0.0411s/iter; left time: 1692.5419s
	iters: 200, epoch: 1 | loss: 0.1001951
	speed: 0.0222s/iter; left time: 913.6902s
	iters: 300, epoch: 1 | loss: 0.2703270
	speed: 0.0202s/iter; left time: 829.9188s
	iters: 400, epoch: 1 | loss: 0.6711742
	speed: 0.0244s/iter; left time: 998.8971s
Epoch: 1 cost time: 11.167961359024048
Epoch: 1, Steps: 413 | Train Loss: 0.319 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
Validation loss decreased (inf --> -0.971350).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0135667
	speed: 0.0859s/iter; left time: 3503.7785s
	iters: 200, epoch: 2 | loss: 0.0965102
	speed: 0.0239s/iter; left time: 972.0304s
	iters: 300, epoch: 2 | loss: 0.0053141
	speed: 0.0238s/iter; left time: 964.1130s
	iters: 400, epoch: 2 | loss: 0.1892363
	speed: 0.0211s/iter; left time: 853.8806s
Epoch: 2 cost time: 10.023598432540894
Epoch: 2, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.121 Vali Acc: 0.963 Test Loss: 0.121 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0008683
	speed: 0.0860s/iter; left time: 3471.2721s
	iters: 200, epoch: 3 | loss: 0.0341951
	speed: 0.0238s/iter; left time: 958.0550s
	iters: 300, epoch: 3 | loss: 0.0308162
	speed: 0.0237s/iter; left time: 951.4417s
	iters: 400, epoch: 3 | loss: 0.0001235
	speed: 0.0241s/iter; left time: 965.6095s
Epoch: 3 cost time: 10.194773197174072
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.971350 --> -0.978171).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000343
	speed: 0.0743s/iter; left time: 2970.1702s
	iters: 200, epoch: 4 | loss: 0.0375537
	speed: 0.0221s/iter; left time: 880.9921s
	iters: 300, epoch: 4 | loss: 0.0000338
	speed: 0.0219s/iter; left time: 872.2341s
	iters: 400, epoch: 4 | loss: 0.0326283
	speed: 0.0229s/iter; left time: 908.4605s
Epoch: 4 cost time: 9.61133623123169
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.200 Vali Acc: 0.961 Test Loss: 0.200 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0529784
	speed: 0.0743s/iter; left time: 2936.6555s
	iters: 200, epoch: 5 | loss: 0.0000055
	speed: 0.0225s/iter; left time: 889.1484s
	iters: 300, epoch: 5 | loss: 0.0000020
	speed: 0.0217s/iter; left time: 854.4559s
	iters: 400, epoch: 5 | loss: 0.0040568
	speed: 0.0237s/iter; left time: 931.6527s
Epoch: 5 cost time: 9.692804098129272
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0815471
	speed: 0.0773s/iter; left time: 3025.0468s
	iters: 200, epoch: 6 | loss: 0.0008615
	speed: 0.0228s/iter; left time: 890.2463s
	iters: 300, epoch: 6 | loss: 0.3574997
	speed: 0.0220s/iter; left time: 856.0563s
	iters: 400, epoch: 6 | loss: 0.0033166
	speed: 0.0220s/iter; left time: 853.9956s
Epoch: 6 cost time: 9.62857985496521
Epoch: 6, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.194 Vali Acc: 0.973 Test Loss: 0.194 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0001720
	speed: 0.0793s/iter; left time: 3069.6304s
	iters: 200, epoch: 7 | loss: 0.0000201
	speed: 0.0225s/iter; left time: 869.0636s
	iters: 300, epoch: 7 | loss: 0.0014357
	speed: 0.0235s/iter; left time: 903.6948s
	iters: 400, epoch: 7 | loss: 0.0000202
	speed: 0.0251s/iter; left time: 965.7233s
Epoch: 7 cost time: 10.076685905456543
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
Validation loss decreased (-0.978171 --> -0.978625).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.0843s/iter; left time: 3228.9760s
	iters: 200, epoch: 8 | loss: 0.1533109
	speed: 0.0225s/iter; left time: 859.1983s
	iters: 300, epoch: 8 | loss: 0.0000091
	speed: 0.0218s/iter; left time: 831.9213s
	iters: 400, epoch: 8 | loss: 0.0000058
	speed: 0.0228s/iter; left time: 866.6904s
Epoch: 8 cost time: 9.719419479370117
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.0845s/iter; left time: 3200.7166s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 842.9464s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 828.4714s
	iters: 400, epoch: 9 | loss: 0.0000067
	speed: 0.0229s/iter; left time: 859.4177s
Epoch: 9 cost time: 9.631088972091675
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.214 Vali Acc: 0.974 Test Loss: 0.214 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000550
	speed: 0.0765s/iter; left time: 2866.2122s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0231s/iter; left time: 862.6533s
	iters: 300, epoch: 10 | loss: 0.0000827
	speed: 0.0236s/iter; left time: 878.7610s
	iters: 400, epoch: 10 | loss: 0.0000004
	speed: 0.0225s/iter; left time: 835.9344s
Epoch: 10 cost time: 10.063509702682495
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.220 Vali Acc: 0.976 Test Loss: 0.220 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 2569.4489s
	iters: 200, epoch: 11 | loss: 0.0155745
	speed: 0.0194s/iter; left time: 718.8240s
	iters: 300, epoch: 11 | loss: 0.0000918
	speed: 0.0189s/iter; left time: 698.6123s
	iters: 400, epoch: 11 | loss: 0.1816126
	speed: 0.0205s/iter; left time: 755.0854s
Epoch: 11 cost time: 8.515411853790283
Epoch: 11, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.161 Vali Acc: 0.973 Test Loss: 0.161 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0637s/iter; left time: 2333.9722s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 757.6031s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 794.9754s
	iters: 400, epoch: 12 | loss: 0.0136258
	speed: 0.0221s/iter; left time: 803.3307s
Epoch: 12 cost time: 9.11378002166748
Epoch: 12, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.281 Vali Acc: 0.967 Test Loss: 0.281 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0035735
	speed: 0.0750s/iter; left time: 2716.5685s
	iters: 200, epoch: 13 | loss: 0.0000244
	speed: 0.0234s/iter; left time: 846.1042s
	iters: 300, epoch: 13 | loss: 0.0022374
	speed: 0.0230s/iter; left time: 828.2983s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0224s/iter; left time: 806.8175s
Epoch: 13 cost time: 9.908322811126709
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.166 Vali Acc: 0.985 Test Loss: 0.166 Test Acc: 0.985
Validation loss decreased (-0.978625 --> -0.984992).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0756s/iter; left time: 2708.2770s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0231s/iter; left time: 824.8503s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0229s/iter; left time: 817.7162s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0236s/iter; left time: 838.7144s
Epoch: 14 cost time: 9.866194009780884
Epoch: 14, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.180 Vali Acc: 0.981 Test Loss: 0.180 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0101114
	speed: 0.0729s/iter; left time: 2581.4342s
	iters: 200, epoch: 15 | loss: 0.0000802
	speed: 0.0215s/iter; left time: 757.6668s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 759.7797s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0217s/iter; left time: 762.2552s
Epoch: 15 cost time: 9.377728700637817
Epoch: 15, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 2728.0154s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 760.1593s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 751.8601s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0219s/iter; left time: 760.5753s
Epoch: 16 cost time: 9.463904619216919
Epoch: 16, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.188 Vali Acc: 0.980 Test Loss: 0.188 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 2833.6703s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0206s/iter; left time: 709.9883s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 752.6683s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0226s/iter; left time: 773.8293s
Epoch: 17 cost time: 9.301376581192017
Epoch: 17, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.257 Vali Acc: 0.977 Test Loss: 0.257 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0014763
	speed: 0.0795s/iter; left time: 2715.6489s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0219s/iter; left time: 745.4825s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 742.4213s
	iters: 400, epoch: 18 | loss: 0.0000023
	speed: 0.0236s/iter; left time: 798.1325s
Epoch: 18 cost time: 9.673762083053589
Epoch: 18, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.229 Vali Acc: 0.984 Test Loss: 0.229 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0764s/iter; left time: 2581.1357s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 720.8388s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 725.4990s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 733.7498s
Epoch: 19 cost time: 9.284042835235596
Epoch: 19, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.316 Vali Acc: 0.975 Test Loss: 0.316 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0769s/iter; left time: 2563.6139s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 700.9677s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 715.5039s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 736.7880s
Epoch: 20 cost time: 9.39699411392212
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.318 Vali Acc: 0.973 Test Loss: 0.318 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0764s/iter; left time: 2515.6597s
	iters: 200, epoch: 21 | loss: 0.2894945
	speed: 0.0224s/iter; left time: 734.4741s
	iters: 300, epoch: 21 | loss: 0.0000008
	speed: 0.0227s/iter; left time: 743.6428s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0236s/iter; left time: 771.4308s
Epoch: 21 cost time: 9.866285562515259
Epoch: 21, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.226 Vali Acc: 0.982 Test Loss: 0.226 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000007
	speed: 0.0747s/iter; left time: 2428.2519s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 718.1615s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 717.5521s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.0223s/iter; left time: 718.0199s
Epoch: 22 cost time: 9.554708242416382
Epoch: 22, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.248 Vali Acc: 0.981 Test Loss: 0.248 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0808s/iter; left time: 2593.5666s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 697.2868s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 699.2199s
	iters: 400, epoch: 23 | loss: 0.0007258
	speed: 0.0215s/iter; left time: 682.8674s
Epoch: 23 cost time: 9.312353134155273
Epoch: 23, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.226 Vali Acc: 0.980 Test Loss: 0.226 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 1437518
model size : 10.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2039735
	speed: 0.0400s/iter; left time: 1646.7257s
	iters: 200, epoch: 1 | loss: 0.0898994
	speed: 0.0220s/iter; left time: 902.3291s
	iters: 300, epoch: 1 | loss: 0.2643095
	speed: 0.0221s/iter; left time: 904.6205s
	iters: 400, epoch: 1 | loss: 0.6991851
	speed: 0.0225s/iter; left time: 921.2610s
Epoch: 1 cost time: 11.0183687210083
Epoch: 1, Steps: 413 | Train Loss: 0.325 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (inf --> -0.973169).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0213502
	speed: 0.0845s/iter; left time: 3446.8236s
	iters: 200, epoch: 2 | loss: 0.1040559
	speed: 0.0216s/iter; left time: 878.5581s
	iters: 300, epoch: 2 | loss: 0.0020774
	speed: 0.0233s/iter; left time: 947.4648s
	iters: 400, epoch: 2 | loss: 0.5403346
	speed: 0.0225s/iter; left time: 909.1908s
Epoch: 2 cost time: 9.748090982437134
Epoch: 2, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000420
	speed: 0.0800s/iter; left time: 3231.4425s
	iters: 200, epoch: 3 | loss: 0.0113458
	speed: 0.0234s/iter; left time: 942.1211s
	iters: 300, epoch: 3 | loss: 0.0034042
	speed: 0.0219s/iter; left time: 881.3078s
	iters: 400, epoch: 3 | loss: 0.0000387
	speed: 0.0227s/iter; left time: 910.6707s
Epoch: 3 cost time: 9.700972318649292
Epoch: 3, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.973169 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0013706
	speed: 0.0812s/iter; left time: 3246.3304s
	iters: 200, epoch: 4 | loss: 0.0147897
	speed: 0.0216s/iter; left time: 860.5034s
	iters: 300, epoch: 4 | loss: 0.0000054
	speed: 0.0212s/iter; left time: 841.5507s
	iters: 400, epoch: 4 | loss: 0.0011123
	speed: 0.0222s/iter; left time: 881.7522s
Epoch: 4 cost time: 9.47957468032837
Epoch: 4, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3254572
	speed: 0.0822s/iter; left time: 3249.5917s
	iters: 200, epoch: 5 | loss: 0.0014567
	speed: 0.0211s/iter; left time: 831.4781s
	iters: 300, epoch: 5 | loss: 0.0000107
	speed: 0.0202s/iter; left time: 795.3340s
	iters: 400, epoch: 5 | loss: 0.0006958
	speed: 0.0192s/iter; left time: 752.6797s
Epoch: 5 cost time: 8.95172667503357
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5360733
	speed: 0.0793s/iter; left time: 3102.8917s
	iters: 200, epoch: 6 | loss: 0.0000005
	speed: 0.0209s/iter; left time: 816.0956s
	iters: 300, epoch: 6 | loss: 0.4201507
	speed: 0.0215s/iter; left time: 835.5769s
	iters: 400, epoch: 6 | loss: 0.0000518
	speed: 0.0207s/iter; left time: 804.3532s
Epoch: 6 cost time: 9.162784099578857
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.207 Vali Acc: 0.971 Test Loss: 0.207 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1267302
	speed: 0.0723s/iter; left time: 2798.1580s
	iters: 200, epoch: 7 | loss: 0.0008401
	speed: 0.0216s/iter; left time: 834.0806s
	iters: 300, epoch: 7 | loss: 0.0000097
	speed: 0.0218s/iter; left time: 839.2346s
	iters: 400, epoch: 7 | loss: 0.0044728
	speed: 0.0213s/iter; left time: 818.3304s
Epoch: 7 cost time: 9.276082515716553
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000275
	speed: 0.0728s/iter; left time: 2790.8315s
	iters: 200, epoch: 8 | loss: 0.0003245
	speed: 0.0218s/iter; left time: 831.6623s
	iters: 300, epoch: 8 | loss: 0.0000131
	speed: 0.0222s/iter; left time: 845.9660s
	iters: 400, epoch: 8 | loss: 0.0000700
	speed: 0.0216s/iter; left time: 819.7556s
Epoch: 8 cost time: 9.444159269332886
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.219 Vali Acc: 0.969 Test Loss: 0.219 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000189
	speed: 0.0740s/iter; left time: 2805.4363s
	iters: 200, epoch: 9 | loss: 0.0000027
	speed: 0.0216s/iter; left time: 818.0184s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0218s/iter; left time: 821.1428s
	iters: 400, epoch: 9 | loss: 0.0000087
	speed: 0.0216s/iter; left time: 812.0902s
Epoch: 9 cost time: 9.38603687286377
Epoch: 9, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0512795
	speed: 0.0754s/iter; left time: 2825.1548s
	iters: 200, epoch: 10 | loss: 0.0000009
	speed: 0.0216s/iter; left time: 807.0025s
	iters: 300, epoch: 10 | loss: 0.0000020
	speed: 0.0212s/iter; left time: 791.3105s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0203s/iter; left time: 754.7644s
Epoch: 10 cost time: 9.177759885787964
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.091 Vali Acc: 0.986 Test Loss: 0.091 Test Acc: 0.986
Validation loss decreased (-0.977716 --> -0.986357).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 2919.9647s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0206s/iter; left time: 762.3428s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 764.5833s
	iters: 400, epoch: 11 | loss: 0.0004337
	speed: 0.0204s/iter; left time: 749.7639s
Epoch: 11 cost time: 9.007975339889526
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.196 Vali Acc: 0.977 Test Loss: 0.196 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 2891.4401s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 767.4200s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0196s/iter; left time: 714.2987s
	iters: 400, epoch: 12 | loss: 0.0000023
	speed: 0.0204s/iter; left time: 741.8824s
Epoch: 12 cost time: 8.929474830627441
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.278 Vali Acc: 0.972 Test Loss: 0.278 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0002073
	speed: 0.0792s/iter; left time: 2868.9560s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0189s/iter; left time: 684.0069s
	iters: 300, epoch: 13 | loss: 0.0000216
	speed: 0.0213s/iter; left time: 766.1072s
	iters: 400, epoch: 13 | loss: 0.0010473
	speed: 0.0214s/iter; left time: 770.3838s
Epoch: 13 cost time: 8.923199892044067
Epoch: 13, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.387 Vali Acc: 0.965 Test Loss: 0.387 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2763.1909s
	iters: 200, epoch: 14 | loss: 0.0000241
	speed: 0.0210s/iter; left time: 750.3610s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0212s/iter; left time: 755.5759s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 737.5634s
Epoch: 14 cost time: 9.07079792022705
Epoch: 14, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.199 Vali Acc: 0.974 Test Loss: 0.199 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000011
	speed: 0.0787s/iter; left time: 2787.7703s
	iters: 200, epoch: 15 | loss: 0.0097491
	speed: 0.0222s/iter; left time: 783.5976s
	iters: 300, epoch: 15 | loss: 0.0136757
	speed: 0.0219s/iter; left time: 770.8016s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 772.2427s
Epoch: 15 cost time: 9.48086166381836
Epoch: 15, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.100 Vali Acc: 0.986 Test Loss: 0.100 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0727s/iter; left time: 2543.3177s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 771.1589s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 761.5441s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 755.6050s
Epoch: 16 cost time: 9.482664108276367
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.981 Test Loss: 0.174 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2665.8679s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 716.3726s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 754.2043s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 715.5672s
Epoch: 17 cost time: 9.246424198150635
Epoch: 17, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.986 Test Loss: 0.129 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 2827.0029s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 738.1882s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 706.0028s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 708.4958s
Epoch: 18 cost time: 9.265991926193237
Epoch: 18, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.307 Vali Acc: 0.980 Test Loss: 0.307 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0804s/iter; left time: 2713.7832s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 695.1085s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 699.4653s
	iters: 400, epoch: 19 | loss: 0.0000666
	speed: 0.0211s/iter; left time: 706.1875s
Epoch: 19 cost time: 9.178929090499878
Epoch: 19, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.402 Vali Acc: 0.974 Test Loss: 0.402 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2593.4039s
	iters: 200, epoch: 20 | loss: 0.0011233
	speed: 0.0208s/iter; left time: 692.0170s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 680.3353s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 694.9243s
Epoch: 20 cost time: 9.068050384521484
Epoch: 20, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.192 Vali Acc: 0.983 Test Loss: 0.192 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 1437518
model size : 10.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1992159
	speed: 0.0382s/iter; left time: 1575.6301s
	iters: 200, epoch: 1 | loss: 0.1076774
	speed: 0.0204s/iter; left time: 839.8328s
	iters: 300, epoch: 1 | loss: 0.2412979
	speed: 0.0213s/iter; left time: 871.6919s
	iters: 400, epoch: 1 | loss: 0.8898963
	speed: 0.0215s/iter; left time: 877.3864s
Epoch: 1 cost time: 10.464250564575195
Epoch: 1, Steps: 413 | Train Loss: 0.344 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
Validation loss decreased (inf --> -0.982719).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0355809
	speed: 0.0771s/iter; left time: 3146.5108s
	iters: 200, epoch: 2 | loss: 0.1166035
	speed: 0.0204s/iter; left time: 829.1081s
	iters: 300, epoch: 2 | loss: 0.0214666
	speed: 0.0211s/iter; left time: 856.6277s
	iters: 400, epoch: 2 | loss: 0.3028726
	speed: 0.0209s/iter; left time: 848.0222s
Epoch: 2 cost time: 9.00756025314331
Epoch: 2, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.103 Vali Acc: 0.960 Test Loss: 0.103 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0003206
	speed: 0.0836s/iter; left time: 3376.8831s
	iters: 200, epoch: 3 | loss: 0.0030401
	speed: 0.0205s/iter; left time: 826.3194s
	iters: 300, epoch: 3 | loss: 0.0348989
	speed: 0.0212s/iter; left time: 851.9468s
	iters: 400, epoch: 3 | loss: 0.0035871
	speed: 0.0201s/iter; left time: 805.4228s
Epoch: 3 cost time: 9.15470266342163
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0003743
	speed: 0.0768s/iter; left time: 3067.4582s
	iters: 200, epoch: 4 | loss: 0.0049886
	speed: 0.0204s/iter; left time: 814.8508s
	iters: 300, epoch: 4 | loss: 0.0000001
	speed: 0.0206s/iter; left time: 818.6781s
	iters: 400, epoch: 4 | loss: 0.0080475
	speed: 0.0206s/iter; left time: 815.7000s
Epoch: 4 cost time: 8.886525869369507
Epoch: 4, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0109411
	speed: 0.0744s/iter; left time: 2943.8616s
	iters: 200, epoch: 5 | loss: 0.0003173
	speed: 0.0209s/iter; left time: 825.2249s
	iters: 300, epoch: 5 | loss: 0.0001110
	speed: 0.0218s/iter; left time: 857.7391s
	iters: 400, epoch: 5 | loss: 0.1329685
	speed: 0.0221s/iter; left time: 866.1428s
Epoch: 5 cost time: 9.273683786392212
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.179 Vali Acc: 0.961 Test Loss: 0.179 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000013
	speed: 0.0727s/iter; left time: 2845.7986s
	iters: 200, epoch: 6 | loss: 0.0000005
	speed: 0.0207s/iter; left time: 806.9681s
	iters: 300, epoch: 6 | loss: 0.3250125
	speed: 0.0220s/iter; left time: 856.0878s
	iters: 400, epoch: 6 | loss: 0.0631270
	speed: 0.0214s/iter; left time: 832.7005s
Epoch: 6 cost time: 9.205979585647583
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0868115
	speed: 0.0686s/iter; left time: 2654.7810s
	iters: 200, epoch: 7 | loss: 0.0004920
	speed: 0.0211s/iter; left time: 815.0248s
	iters: 300, epoch: 7 | loss: 0.0000012
	speed: 0.0214s/iter; left time: 823.5663s
	iters: 400, epoch: 7 | loss: 0.0000309
	speed: 0.0211s/iter; left time: 811.3003s
Epoch: 7 cost time: 9.035224199295044
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0626212
	speed: 0.0724s/iter; left time: 2774.0521s
	iters: 200, epoch: 8 | loss: 0.0018782
	speed: 0.0204s/iter; left time: 781.2810s
	iters: 300, epoch: 8 | loss: 0.0000020
	speed: 0.0210s/iter; left time: 798.7287s
	iters: 400, epoch: 8 | loss: 0.0031044
	speed: 0.0209s/iter; left time: 794.7858s
Epoch: 8 cost time: 8.987418174743652
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.982719 --> -0.985447).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0016421
	speed: 0.0788s/iter; left time: 2986.3813s
	iters: 200, epoch: 9 | loss: 0.0003885
	speed: 0.0203s/iter; left time: 766.2288s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 824.5568s
	iters: 400, epoch: 9 | loss: 0.0000002
	speed: 0.0208s/iter; left time: 780.8873s
Epoch: 9 cost time: 9.118536710739136
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.178 Vali Acc: 0.973 Test Loss: 0.178 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000105
	speed: 0.0769s/iter; left time: 2884.0220s
	iters: 200, epoch: 10 | loss: 0.0001398
	speed: 0.0210s/iter; left time: 784.5444s
	iters: 300, epoch: 10 | loss: 0.1384147
	speed: 0.0204s/iter; left time: 759.2580s
	iters: 400, epoch: 10 | loss: 0.0000020
	speed: 0.0210s/iter; left time: 779.9132s
Epoch: 10 cost time: 8.8452467918396
Epoch: 10, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000006
	speed: 0.0785s/iter; left time: 2911.4310s
	iters: 200, epoch: 11 | loss: 0.0000036
	speed: 0.0216s/iter; left time: 798.5877s
	iters: 300, epoch: 11 | loss: 0.0016935
	speed: 0.0195s/iter; left time: 720.5883s
	iters: 400, epoch: 11 | loss: 0.0000045
	speed: 0.0198s/iter; left time: 726.6345s
Epoch: 11 cost time: 8.896614789962769
Epoch: 11, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.250 Vali Acc: 0.972 Test Loss: 0.250 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000015
	speed: 0.0743s/iter; left time: 2723.7187s
	iters: 200, epoch: 12 | loss: 0.3026130
	speed: 0.0205s/iter; left time: 748.9376s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 761.3178s
	iters: 400, epoch: 12 | loss: 0.0001671
	speed: 0.0202s/iter; left time: 734.9676s
Epoch: 12 cost time: 8.911540269851685
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.151 Vali Acc: 0.978 Test Loss: 0.151 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000126
	speed: 0.0717s/iter; left time: 2598.2850s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 793.9731s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 771.1015s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 776.2946s
Epoch: 13 cost time: 9.28022027015686
Epoch: 13, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.203 Vali Acc: 0.971 Test Loss: 0.203 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000007
	speed: 0.0713s/iter; left time: 2553.9778s
	iters: 200, epoch: 14 | loss: 0.0000006
	speed: 0.0216s/iter; left time: 772.4143s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0209s/iter; left time: 743.3190s
	iters: 400, epoch: 14 | loss: 0.8019383
	speed: 0.0214s/iter; left time: 760.7816s
Epoch: 14 cost time: 9.17029094696045
Epoch: 14, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000007
	speed: 0.0711s/iter; left time: 2519.8579s
	iters: 200, epoch: 15 | loss: 0.0000193
	speed: 0.0203s/iter; left time: 715.6994s
	iters: 300, epoch: 15 | loss: 0.0056694
	speed: 0.0212s/iter; left time: 746.4360s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 743.1448s
Epoch: 15 cost time: 9.090857028961182
Epoch: 15, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.251 Vali Acc: 0.978 Test Loss: 0.251 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0743s/iter; left time: 2601.2545s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 717.6681s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 742.1722s
	iters: 400, epoch: 16 | loss: 0.0010058
	speed: 0.0197s/iter; left time: 684.3554s
Epoch: 16 cost time: 8.896484613418579
Epoch: 16, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.372 Vali Acc: 0.973 Test Loss: 0.372 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2655.9777s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 763.7674s
	iters: 300, epoch: 17 | loss: 0.0000015
	speed: 0.0202s/iter; left time: 695.9080s
	iters: 400, epoch: 17 | loss: 0.0000025
	speed: 0.0224s/iter; left time: 768.2734s
Epoch: 17 cost time: 9.271092653274536
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.258 Vali Acc: 0.978 Test Loss: 0.258 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0825s/iter; left time: 2818.3563s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0201s/iter; left time: 683.6929s
	iters: 300, epoch: 18 | loss: 0.0000279
	speed: 0.0203s/iter; left time: 688.3081s
	iters: 400, epoch: 18 | loss: 0.0000030
	speed: 0.0210s/iter; left time: 710.4858s
Epoch: 18 cost time: 8.873774766921997
Epoch: 18, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.698 Vali Acc: 0.960 Test Loss: 0.698 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 1437518
model size : 10.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2282521
	speed: 0.0376s/iter; left time: 1548.8779s
	iters: 200, epoch: 1 | loss: 0.1331245
	speed: 0.0218s/iter; left time: 895.2349s
	iters: 300, epoch: 1 | loss: 0.1777888
	speed: 0.0225s/iter; left time: 920.7778s
	iters: 400, epoch: 1 | loss: 0.5969262
	speed: 0.0222s/iter; left time: 906.3734s
Epoch: 1 cost time: 10.75045895576477
Epoch: 1, Steps: 413 | Train Loss: 0.400 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (inf --> -0.979536).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0302720
	speed: 0.0818s/iter; left time: 3334.5803s
	iters: 200, epoch: 2 | loss: 0.0122319
	speed: 0.0224s/iter; left time: 911.6131s
	iters: 300, epoch: 2 | loss: 0.0086110
	speed: 0.0226s/iter; left time: 915.4035s
	iters: 400, epoch: 2 | loss: 0.1492018
	speed: 0.0217s/iter; left time: 879.3922s
Epoch: 2 cost time: 9.609594106674194
Epoch: 2, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0005689
	speed: 0.0805s/iter; left time: 3252.1365s
	iters: 200, epoch: 3 | loss: 0.0094628
	speed: 0.0223s/iter; left time: 896.4585s
	iters: 300, epoch: 3 | loss: 0.1209068
	speed: 0.0218s/iter; left time: 874.8725s
	iters: 400, epoch: 3 | loss: 0.0003549
	speed: 0.0226s/iter; left time: 904.6971s
Epoch: 3 cost time: 9.601662874221802
Epoch: 3, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0012832
	speed: 0.0795s/iter; left time: 3178.5932s
	iters: 200, epoch: 4 | loss: 0.0543914
	speed: 0.0216s/iter; left time: 862.8861s
	iters: 300, epoch: 4 | loss: 0.0000040
	speed: 0.0223s/iter; left time: 887.5051s
	iters: 400, epoch: 4 | loss: 0.0002112
	speed: 0.0240s/iter; left time: 953.8177s
Epoch: 4 cost time: 9.645756483078003
Epoch: 4, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0628726
	speed: 0.0856s/iter; left time: 3386.0879s
	iters: 200, epoch: 5 | loss: 0.0546558
	speed: 0.0207s/iter; left time: 815.1630s
	iters: 300, epoch: 5 | loss: 0.0000627
	speed: 0.0228s/iter; left time: 898.4942s
	iters: 400, epoch: 5 | loss: 0.0007138
	speed: 0.0217s/iter; left time: 851.8740s
Epoch: 5 cost time: 9.382423639297485
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
Validation loss decreased (-0.979536 --> -0.981354).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0009186
	speed: 0.0730s/iter; left time: 2858.8138s
	iters: 200, epoch: 6 | loss: 0.0000260
	speed: 0.0224s/iter; left time: 875.0875s
	iters: 300, epoch: 6 | loss: 0.0000875
	speed: 0.0217s/iter; left time: 843.4790s
	iters: 400, epoch: 6 | loss: 0.0001372
	speed: 0.0217s/iter; left time: 840.9108s
Epoch: 6 cost time: 9.486783742904663
Epoch: 6, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.238 Vali Acc: 0.957 Test Loss: 0.238 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0892072
	speed: 0.0704s/iter; left time: 2726.4306s
	iters: 200, epoch: 7 | loss: 0.0000031
	speed: 0.0223s/iter; left time: 859.6940s
	iters: 300, epoch: 7 | loss: 0.0044470
	speed: 0.0214s/iter; left time: 826.1837s
	iters: 400, epoch: 7 | loss: 0.0015440
	speed: 0.0220s/iter; left time: 844.3515s
Epoch: 7 cost time: 9.302400588989258
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0024218
	speed: 0.0740s/iter; left time: 2836.8034s
	iters: 200, epoch: 8 | loss: 0.0000696
	speed: 0.0209s/iter; left time: 797.3476s
	iters: 300, epoch: 8 | loss: 0.0000007
	speed: 0.0215s/iter; left time: 818.0225s
	iters: 400, epoch: 8 | loss: 0.0704254
	speed: 0.0219s/iter; left time: 831.4695s
Epoch: 8 cost time: 9.518524169921875
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.330 Vali Acc: 0.951 Test Loss: 0.330 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000358
	speed: 0.0790s/iter; left time: 2994.3433s
	iters: 200, epoch: 9 | loss: 0.0001174
	speed: 0.0213s/iter; left time: 804.3604s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0202s/iter; left time: 759.9131s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0209s/iter; left time: 784.7012s
Epoch: 9 cost time: 9.150199890136719
Epoch: 9, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.144 Vali Acc: 0.978 Test Loss: 0.144 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5100046
	speed: 0.0811s/iter; left time: 3039.0634s
	iters: 200, epoch: 10 | loss: 0.0022129
	speed: 0.0207s/iter; left time: 774.8908s
	iters: 300, epoch: 10 | loss: 0.0000099
	speed: 0.0225s/iter; left time: 840.5237s
	iters: 400, epoch: 10 | loss: 0.0000004
	speed: 0.0225s/iter; left time: 838.3026s
Epoch: 10 cost time: 9.45249891281128
Epoch: 10, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0009247
	speed: 0.0776s/iter; left time: 2875.9405s
	iters: 200, epoch: 11 | loss: 0.0004299
	speed: 0.0208s/iter; left time: 769.6808s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 779.8369s
	iters: 400, epoch: 11 | loss: 0.0009345
	speed: 0.0214s/iter; left time: 786.8880s
Epoch: 11 cost time: 9.160865545272827
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.142 Vali Acc: 0.980 Test Loss: 0.142 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000004
	speed: 0.0766s/iter; left time: 2806.2541s
	iters: 200, epoch: 12 | loss: 0.0000288
	speed: 0.0209s/iter; left time: 765.5110s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 780.0793s
	iters: 400, epoch: 12 | loss: 0.0001711
	speed: 0.0209s/iter; left time: 759.6590s
Epoch: 12 cost time: 9.176128149032593
Epoch: 12, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.095 Vali Acc: 0.986 Test Loss: 0.095 Test Acc: 0.986
Validation loss decreased (-0.981354 --> -0.986356).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000012
	speed: 0.0757s/iter; left time: 2743.1145s
	iters: 200, epoch: 13 | loss: 0.1975173
	speed: 0.0214s/iter; left time: 774.3868s
	iters: 300, epoch: 13 | loss: 0.0000230
	speed: 0.0207s/iter; left time: 746.9484s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0213s/iter; left time: 766.8588s
Epoch: 13 cost time: 9.125952959060669
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.981 Test Loss: 0.151 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 2650.7730s
	iters: 200, epoch: 14 | loss: 0.0000076
	speed: 0.0221s/iter; left time: 789.1854s
	iters: 300, epoch: 14 | loss: 0.0000129
	speed: 0.0218s/iter; left time: 776.9327s
	iters: 400, epoch: 14 | loss: 0.0000239
	speed: 0.0219s/iter; left time: 778.1472s
Epoch: 14 cost time: 9.348966598510742
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.186 Vali Acc: 0.976 Test Loss: 0.186 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0736s/iter; left time: 2607.0024s
	iters: 200, epoch: 15 | loss: 0.0014402
	speed: 0.0202s/iter; left time: 713.9308s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 731.8886s
	iters: 400, epoch: 15 | loss: 0.0000052
	speed: 0.0210s/iter; left time: 739.2087s
Epoch: 15 cost time: 9.004628896713257
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.0775s/iter; left time: 2712.3048s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0203s/iter; left time: 709.1272s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 734.5851s
	iters: 400, epoch: 16 | loss: 0.0009647
	speed: 0.0210s/iter; left time: 730.3530s
Epoch: 16 cost time: 8.997422456741333
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.085 Vali Acc: 0.985 Test Loss: 0.085 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 2636.5170s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0203s/iter; left time: 700.9129s
	iters: 300, epoch: 17 | loss: 0.0480016
	speed: 0.0206s/iter; left time: 707.5165s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0217s/iter; left time: 743.4700s
Epoch: 17 cost time: 9.073523044586182
Epoch: 17, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.147 Vali Acc: 0.981 Test Loss: 0.147 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000004
	speed: 0.0746s/iter; left time: 2549.4497s
	iters: 200, epoch: 18 | loss: 0.0000021
	speed: 0.0214s/iter; left time: 729.2183s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0204s/iter; left time: 694.3201s
	iters: 400, epoch: 18 | loss: 0.0019562
	speed: 0.0215s/iter; left time: 728.0309s
Epoch: 18 cost time: 9.19393253326416
Epoch: 18, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.179 Vali Acc: 0.980 Test Loss: 0.179 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 2668.0704s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 710.6535s
	iters: 300, epoch: 19 | loss: 0.0000029
	speed: 0.0208s/iter; left time: 698.3817s
	iters: 400, epoch: 19 | loss: 0.0000021
	speed: 0.0207s/iter; left time: 691.3990s
Epoch: 19 cost time: 9.116919040679932
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.182 Vali Acc: 0.979 Test Loss: 0.182 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000316
	speed: 0.0783s/iter; left time: 2611.0249s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 714.0121s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 681.1619s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 704.4861s
Epoch: 20 cost time: 9.213576555252075
Epoch: 20, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.200 Vali Acc: 0.976 Test Loss: 0.200 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0835s/iter; left time: 2749.4476s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 728.2412s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 764.2914s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.0225s/iter; left time: 734.3943s
Epoch: 21 cost time: 9.812304258346558
Epoch: 21, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.292 Vali Acc: 0.978 Test Loss: 0.292 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 2828.8960s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 687.3465s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0224s/iter; left time: 723.5403s
	iters: 400, epoch: 22 | loss: 0.0032964
	speed: 0.0218s/iter; left time: 702.2167s
Epoch: 22 cost time: 9.399939775466919
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.223 Vali Acc: 0.980 Test Loss: 0.223 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 1437518
model size : 10.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2869648
	speed: 0.0395s/iter; left time: 1628.2610s
	iters: 200, epoch: 1 | loss: 0.0754609
	speed: 0.0232s/iter; left time: 953.3349s
	iters: 300, epoch: 1 | loss: 0.0664525
	speed: 0.0231s/iter; left time: 948.7118s
	iters: 400, epoch: 1 | loss: 0.0301840
	speed: 0.0230s/iter; left time: 940.1674s
Epoch: 1 cost time: 11.287981033325195
Epoch: 1, Steps: 413 | Train Loss: 0.322 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (inf --> -0.976807).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4044780
	speed: 0.0746s/iter; left time: 3044.3967s
	iters: 200, epoch: 2 | loss: 0.0083764
	speed: 0.0247s/iter; left time: 1003.1457s
	iters: 300, epoch: 2 | loss: 0.0228224
	speed: 0.0226s/iter; left time: 917.3992s
	iters: 400, epoch: 2 | loss: 0.0462248
	speed: 0.0216s/iter; left time: 876.3904s
Epoch: 2 cost time: 9.715695858001709
Epoch: 2, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.105 Vali Acc: 0.966 Test Loss: 0.105 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0041003
	speed: 0.0732s/iter; left time: 2957.1217s
	iters: 200, epoch: 3 | loss: 0.0002186
	speed: 0.0227s/iter; left time: 912.9449s
	iters: 300, epoch: 3 | loss: 0.0003412
	speed: 0.0231s/iter; left time: 926.8934s
	iters: 400, epoch: 3 | loss: 0.0574656
	speed: 0.0234s/iter; left time: 936.2862s
Epoch: 3 cost time: 9.864435911178589
Epoch: 3, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0073310
	speed: 0.0775s/iter; left time: 3098.7949s
	iters: 200, epoch: 4 | loss: 0.0006166
	speed: 0.0226s/iter; left time: 901.4100s
	iters: 300, epoch: 4 | loss: 0.0013708
	speed: 0.0216s/iter; left time: 860.1898s
	iters: 400, epoch: 4 | loss: 0.4120477
	speed: 0.0226s/iter; left time: 895.2862s
Epoch: 4 cost time: 9.626397609710693
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.4170466
	speed: 0.0824s/iter; left time: 3258.9807s
	iters: 200, epoch: 5 | loss: 0.0002659
	speed: 0.0226s/iter; left time: 892.9712s
	iters: 300, epoch: 5 | loss: 0.0376676
	speed: 0.0220s/iter; left time: 865.1629s
	iters: 400, epoch: 5 | loss: 0.0000054
	speed: 0.0218s/iter; left time: 855.3700s
Epoch: 5 cost time: 9.415397882461548
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0006823
	speed: 0.0857s/iter; left time: 3353.0348s
	iters: 200, epoch: 6 | loss: 0.0536112
	speed: 0.0211s/iter; left time: 824.4273s
	iters: 300, epoch: 6 | loss: 0.3491450
	speed: 0.0206s/iter; left time: 802.8643s
	iters: 400, epoch: 6 | loss: 0.0000142
	speed: 0.0214s/iter; left time: 829.5146s
Epoch: 6 cost time: 9.282467603683472
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.202 Vali Acc: 0.971 Test Loss: 0.202 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0097376
	speed: 0.0754s/iter; left time: 2918.3660s
	iters: 200, epoch: 7 | loss: 0.0390156
	speed: 0.0200s/iter; left time: 772.9570s
	iters: 300, epoch: 7 | loss: 0.0000097
	speed: 0.0216s/iter; left time: 830.4570s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 839.0775s
Epoch: 7 cost time: 9.12605094909668
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.225 Vali Acc: 0.968 Test Loss: 0.225 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0591002
	speed: 0.0757s/iter; left time: 2898.6801s
	iters: 200, epoch: 8 | loss: 0.0441063
	speed: 0.0217s/iter; left time: 827.8154s
	iters: 300, epoch: 8 | loss: 0.0002300
	speed: 0.0215s/iter; left time: 819.9321s
	iters: 400, epoch: 8 | loss: 0.0000634
	speed: 0.0217s/iter; left time: 825.4545s
Epoch: 8 cost time: 9.295725345611572
Epoch: 8, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.165 Vali Acc: 0.979 Test Loss: 0.165 Test Acc: 0.979
Validation loss decreased (-0.976807 --> -0.979080).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.0753s/iter; left time: 2854.0112s
	iters: 200, epoch: 9 | loss: 0.2167137
	speed: 0.0209s/iter; left time: 789.6535s
	iters: 300, epoch: 9 | loss: 0.0000400
	speed: 0.0219s/iter; left time: 825.1273s
	iters: 400, epoch: 9 | loss: 0.0000004
	speed: 0.0211s/iter; left time: 791.6485s
Epoch: 9 cost time: 9.245388269424438
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
Validation loss decreased (-0.979080 --> -0.981354).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000054
	speed: 0.0743s/iter; left time: 2784.3129s
	iters: 200, epoch: 10 | loss: 0.0000021
	speed: 0.0220s/iter; left time: 823.1452s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 805.8175s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 813.6368s
Epoch: 10 cost time: 9.447795629501343
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.985 Test Loss: 0.115 Test Acc: 0.985
Validation loss decreased (-0.981354 --> -0.985447).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.5093521
	speed: 0.0734s/iter; left time: 2721.2545s
	iters: 200, epoch: 11 | loss: 0.0429144
	speed: 0.0216s/iter; left time: 800.1595s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 793.5610s
	iters: 400, epoch: 11 | loss: 0.0000009
	speed: 0.0220s/iter; left time: 809.5234s
Epoch: 11 cost time: 9.20053482055664
Epoch: 11, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 2969.7508s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0227s/iter; left time: 831.4366s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 806.8210s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 807.5855s
Epoch: 12 cost time: 9.581523895263672
Epoch: 12, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 2640.8547s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 782.9855s
	iters: 300, epoch: 13 | loss: 0.0000013
	speed: 0.0221s/iter; left time: 794.9067s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0235s/iter; left time: 844.3756s
Epoch: 13 cost time: 9.606051445007324
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.181 Vali Acc: 0.979 Test Loss: 0.181 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0725s/iter; left time: 2598.3370s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.0224s/iter; left time: 799.0883s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0228s/iter; left time: 812.2061s
	iters: 400, epoch: 14 | loss: 0.0000075
	speed: 0.0220s/iter; left time: 780.8985s
Epoch: 14 cost time: 9.614484310150146
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.336 Vali Acc: 0.970 Test Loss: 0.336 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0767s/iter; left time: 2716.5001s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 766.4022s
	iters: 300, epoch: 15 | loss: 1.1183329
	speed: 0.0227s/iter; left time: 799.2316s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 775.6192s
Epoch: 15 cost time: 9.631295680999756
Epoch: 15, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.320 Vali Acc: 0.972 Test Loss: 0.320 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 2736.8988s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 747.5620s
	iters: 300, epoch: 16 | loss: 0.0000012
	speed: 0.0214s/iter; left time: 744.5126s
	iters: 400, epoch: 16 | loss: 0.1158579
	speed: 0.0217s/iter; left time: 752.1174s
Epoch: 16 cost time: 9.271896600723267
Epoch: 16, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.181 Vali Acc: 0.980 Test Loss: 0.181 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000010
	speed: 0.0816s/iter; left time: 2822.9265s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0236s/iter; left time: 813.6822s
	iters: 300, epoch: 17 | loss: 0.0301607
	speed: 0.0227s/iter; left time: 781.8897s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0232s/iter; left time: 796.5962s
Epoch: 17 cost time: 9.929860830307007
Epoch: 17, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.187 Vali Acc: 0.978 Test Loss: 0.187 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.2252226
	speed: 0.0828s/iter; left time: 2828.6821s
	iters: 200, epoch: 18 | loss: 0.0208593
	speed: 0.0202s/iter; left time: 688.5904s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 765.2388s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 715.0860s
Epoch: 18 cost time: 9.322668552398682
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.142 Vali Acc: 0.987 Test Loss: 0.142 Test Acc: 0.987
Validation loss decreased (-0.985447 --> -0.987266).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2604.0682s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0211s/iter; left time: 708.9048s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0226s/iter; left time: 758.2057s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 741.1223s
Epoch: 19 cost time: 9.392447471618652
Epoch: 19, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.196 Vali Acc: 0.979 Test Loss: 0.196 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0753s/iter; left time: 2512.0525s
	iters: 200, epoch: 20 | loss: 0.0021405
	speed: 0.0211s/iter; left time: 700.2461s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 715.4843s
	iters: 400, epoch: 20 | loss: 0.0000656
	speed: 0.0219s/iter; left time: 722.5098s
Epoch: 20 cost time: 9.227012157440186
Epoch: 20, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.189 Vali Acc: 0.987 Test Loss: 0.189 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0747s/iter; left time: 2461.4338s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 724.7732s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 728.5835s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 700.0037s
Epoch: 21 cost time: 9.436564922332764
Epoch: 21, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.386 Vali Acc: 0.978 Test Loss: 0.386 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0745s/iter; left time: 2421.7558s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 711.0895s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 687.3915s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 701.2882s
Epoch: 22 cost time: 9.30920672416687
Epoch: 22, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.205 Vali Acc: 0.984 Test Loss: 0.205 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.5185783
	speed: 0.0781s/iter; left time: 2508.0692s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 674.7783s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 665.7351s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 685.0588s
Epoch: 23 cost time: 9.05997109413147
Epoch: 23, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.313 Vali Acc: 0.978 Test Loss: 0.313 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2465.9213s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 669.5599s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 647.2135s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 643.3392s
Epoch: 24 cost time: 8.981598615646362
Epoch: 24, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.267 Vali Acc: 0.980 Test Loss: 0.267 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0756s/iter; left time: 2364.0347s
	iters: 200, epoch: 25 | loss: 0.1339006
	speed: 0.0210s/iter; left time: 654.6162s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 687.3269s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 651.5269s
Epoch: 25 cost time: 9.223950624465942
Epoch: 25, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.218 Vali Acc: 0.981 Test Loss: 0.218 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 2453.4473s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 671.4392s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 660.7787s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 635.3070s
Epoch: 26 cost time: 9.404573917388916
Epoch: 26, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.296 Vali Acc: 0.975 Test Loss: 0.296 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 2400.7166s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 637.6015s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 632.8281s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 638.6310s
Epoch: 27 cost time: 9.133136510848999
Epoch: 27, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.293 Vali Acc: 0.978 Test Loss: 0.293 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2315.3869s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 613.1750s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0200s/iter; left time: 598.0988s
	iters: 400, epoch: 28 | loss: 0.0000001
	speed: 0.0218s/iter; left time: 649.3567s
Epoch: 28 cost time: 8.981400489807129
Epoch: 28, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.354 Vali Acc: 0.978 Test Loss: 0.354 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 913230
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2994697
	speed: 0.0363s/iter; left time: 1495.2586s
	iters: 200, epoch: 1 | loss: 0.0821863
	speed: 0.0207s/iter; left time: 852.0195s
	iters: 300, epoch: 1 | loss: 0.0399049
	speed: 0.0193s/iter; left time: 789.7545s
	iters: 400, epoch: 1 | loss: 0.0135657
	speed: 0.0201s/iter; left time: 820.6478s
Epoch: 1 cost time: 9.984818696975708
Epoch: 1, Steps: 413 | Train Loss: 0.327 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (inf --> -0.975897).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2486378
	speed: 0.0679s/iter; left time: 2769.5465s
	iters: 200, epoch: 2 | loss: 0.0411201
	speed: 0.0216s/iter; left time: 877.1793s
	iters: 300, epoch: 2 | loss: 0.0078975
	speed: 0.0217s/iter; left time: 881.2133s
	iters: 400, epoch: 2 | loss: 0.0008886
	speed: 0.0208s/iter; left time: 841.0103s
Epoch: 2 cost time: 9.060107707977295
Epoch: 2, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0014727
	speed: 0.0702s/iter; left time: 2832.3956s
	iters: 200, epoch: 3 | loss: 0.0000184
	speed: 0.0212s/iter; left time: 853.8970s
	iters: 300, epoch: 3 | loss: 0.0005410
	speed: 0.0219s/iter; left time: 881.3922s
	iters: 400, epoch: 3 | loss: 0.0189185
	speed: 0.0216s/iter; left time: 863.8837s
Epoch: 3 cost time: 9.202208757400513
Epoch: 3, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000499
	speed: 0.0707s/iter; left time: 2826.1589s
	iters: 200, epoch: 4 | loss: 0.0000678
	speed: 0.0215s/iter; left time: 857.8826s
	iters: 300, epoch: 4 | loss: 0.0045345
	speed: 0.0214s/iter; left time: 849.9483s
	iters: 400, epoch: 4 | loss: 0.0312843
	speed: 0.0218s/iter; left time: 862.9419s
Epoch: 4 cost time: 9.169512510299683
Epoch: 4, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0058297
	speed: 0.0697s/iter; left time: 2756.4437s
	iters: 200, epoch: 5 | loss: 0.0000092
	speed: 0.0202s/iter; left time: 797.6884s
	iters: 300, epoch: 5 | loss: 0.0008296
	speed: 0.0208s/iter; left time: 817.5679s
	iters: 400, epoch: 5 | loss: 0.0000048
	speed: 0.0201s/iter; left time: 789.9642s
Epoch: 5 cost time: 8.809048414230347
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.145 Vali Acc: 0.978 Test Loss: 0.145 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.977716).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000028
	speed: 0.0798s/iter; left time: 3124.0297s
	iters: 200, epoch: 6 | loss: 0.0003793
	speed: 0.0204s/iter; left time: 798.0642s
	iters: 300, epoch: 6 | loss: 0.0000058
	speed: 0.0209s/iter; left time: 813.0258s
	iters: 400, epoch: 6 | loss: 0.0000247
	speed: 0.0205s/iter; left time: 796.5190s
Epoch: 6 cost time: 8.978010892868042
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0619460
	speed: 0.0781s/iter; left time: 3025.3539s
	iters: 200, epoch: 7 | loss: 0.0000022
	speed: 0.0206s/iter; left time: 795.0688s
	iters: 300, epoch: 7 | loss: 0.0169620
	speed: 0.0207s/iter; left time: 798.6460s
	iters: 400, epoch: 7 | loss: 0.0002400
	speed: 0.0196s/iter; left time: 751.4867s
Epoch: 7 cost time: 8.90751576423645
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2952.8471s
	iters: 200, epoch: 8 | loss: 0.2069561
	speed: 0.0214s/iter; left time: 819.1659s
	iters: 300, epoch: 8 | loss: 0.0000391
	speed: 0.0225s/iter; left time: 855.6166s
	iters: 400, epoch: 8 | loss: 0.0082734
	speed: 0.0214s/iter; left time: 812.0481s
Epoch: 8 cost time: 9.408203125
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.157 Vali Acc: 0.977 Test Loss: 0.157 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000003
	speed: 0.0758s/iter; left time: 2871.0601s
	iters: 200, epoch: 9 | loss: 0.0000836
	speed: 0.0213s/iter; left time: 806.2749s
	iters: 300, epoch: 9 | loss: 0.0001216
	speed: 0.0209s/iter; left time: 788.9032s
	iters: 400, epoch: 9 | loss: 0.0024131
	speed: 0.0212s/iter; left time: 797.3829s
Epoch: 9 cost time: 9.208076238632202
Epoch: 9, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.163 Vali Acc: 0.978 Test Loss: 0.163 Test Acc: 0.978
Validation loss decreased (-0.977716 --> -0.978170).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0019651
	speed: 0.0734s/iter; left time: 2752.0493s
	iters: 200, epoch: 10 | loss: 0.0000041
	speed: 0.0209s/iter; left time: 780.2169s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 780.9265s
	iters: 400, epoch: 10 | loss: 0.0014736
	speed: 0.0226s/iter; left time: 841.7466s
Epoch: 10 cost time: 9.117357730865479
Epoch: 10, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.160 Vali Acc: 0.983 Test Loss: 0.160 Test Acc: 0.983
Validation loss decreased (-0.978170 --> -0.982718).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.4111446
	speed: 0.0719s/iter; left time: 2664.8524s
	iters: 200, epoch: 11 | loss: 0.0000005
	speed: 0.0210s/iter; left time: 777.2336s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0213s/iter; left time: 784.3947s
	iters: 400, epoch: 11 | loss: 0.2986807
	speed: 0.0213s/iter; left time: 782.2740s
Epoch: 11 cost time: 9.122419118881226
Epoch: 11, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0159956
	speed: 0.0773s/iter; left time: 2833.9424s
	iters: 200, epoch: 12 | loss: 0.0000017
	speed: 0.0221s/iter; left time: 807.1299s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0195s/iter; left time: 712.0089s
	iters: 400, epoch: 12 | loss: 0.0001297
	speed: 0.0199s/iter; left time: 724.6263s
Epoch: 12 cost time: 8.921867370605469
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.366 Vali Acc: 0.961 Test Loss: 0.366 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000023
	speed: 0.0769s/iter; left time: 2786.2437s
	iters: 200, epoch: 13 | loss: 0.0000023
	speed: 0.0210s/iter; left time: 759.5164s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 794.7946s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 764.9869s
Epoch: 13 cost time: 9.108282089233398
Epoch: 13, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.981 Test Loss: 0.211 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 2590.1872s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 786.5852s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 751.2464s
	iters: 400, epoch: 14 | loss: 0.0000163
	speed: 0.0215s/iter; left time: 764.5241s
Epoch: 14 cost time: 9.321456670761108
Epoch: 14, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.172 Vali Acc: 0.976 Test Loss: 0.172 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000312
	speed: 0.0751s/iter; left time: 2660.4209s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 769.5443s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 724.9170s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 734.0053s
Epoch: 15 cost time: 9.068209648132324
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.223 Vali Acc: 0.980 Test Loss: 0.223 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.0755s/iter; left time: 2643.9424s
	iters: 200, epoch: 16 | loss: 0.0012876
	speed: 0.0202s/iter; left time: 705.8582s
	iters: 300, epoch: 16 | loss: 0.0000007
	speed: 0.0219s/iter; left time: 762.3386s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 750.1311s
Epoch: 16 cost time: 9.157182693481445
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.149 Vali Acc: 0.982 Test Loss: 0.149 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000015
	speed: 0.0796s/iter; left time: 2752.3012s
	iters: 200, epoch: 17 | loss: 0.0000004
	speed: 0.0211s/iter; left time: 726.2738s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 733.8644s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 743.1114s
Epoch: 17 cost time: 9.35867714881897
Epoch: 17, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.225 Vali Acc: 0.976 Test Loss: 0.225 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0805s/iter; left time: 2752.1404s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 731.9674s
	iters: 300, epoch: 18 | loss: 0.0000178
	speed: 0.0205s/iter; left time: 696.3270s
	iters: 400, epoch: 18 | loss: 0.0000108
	speed: 0.0210s/iter; left time: 711.6844s
Epoch: 18 cost time: 9.08193564414978
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.238 Vali Acc: 0.977 Test Loss: 0.238 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0831s/iter; left time: 2806.8856s
	iters: 200, epoch: 19 | loss: 0.0000253
	speed: 0.0206s/iter; left time: 694.9153s
	iters: 300, epoch: 19 | loss: 0.0000002
	speed: 0.0222s/iter; left time: 745.1528s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 702.7387s
Epoch: 19 cost time: 9.252245903015137
Epoch: 19, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.186 Vali Acc: 0.982 Test Loss: 0.186 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0822s/iter; left time: 2742.7189s
	iters: 200, epoch: 20 | loss: 0.5062480
	speed: 0.0210s/iter; left time: 699.9921s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 687.1399s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 719.3519s
Epoch: 20 cost time: 9.145198822021484
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.253 Vali Acc: 0.979 Test Loss: 0.253 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 913230
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3449945
	speed: 0.0357s/iter; left time: 1471.8390s
	iters: 200, epoch: 1 | loss: 0.0914216
	speed: 0.0225s/iter; left time: 924.3369s
	iters: 300, epoch: 1 | loss: 0.0414222
	speed: 0.0225s/iter; left time: 922.0964s
	iters: 400, epoch: 1 | loss: 0.0086845
	speed: 0.0228s/iter; left time: 932.0375s
Epoch: 1 cost time: 10.717055082321167
Epoch: 1, Steps: 413 | Train Loss: 0.346 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (inf --> -0.978171).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1078061
	speed: 0.0745s/iter; left time: 3040.6497s
	iters: 200, epoch: 2 | loss: 0.0445971
	speed: 0.0221s/iter; left time: 897.7189s
	iters: 300, epoch: 2 | loss: 0.0915879
	speed: 0.0235s/iter; left time: 955.7024s
	iters: 400, epoch: 2 | loss: 0.0019375
	speed: 0.0213s/iter; left time: 863.7605s
Epoch: 2 cost time: 9.598672866821289
Epoch: 2, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.091 Vali Acc: 0.967 Test Loss: 0.091 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0003031
	speed: 0.0749s/iter; left time: 3023.6103s
	iters: 200, epoch: 3 | loss: 0.0030381
	speed: 0.0218s/iter; left time: 876.3275s
	iters: 300, epoch: 3 | loss: 0.0007511
	speed: 0.0225s/iter; left time: 905.2413s
	iters: 400, epoch: 3 | loss: 0.0023457
	speed: 0.0224s/iter; left time: 897.6308s
Epoch: 3 cost time: 9.401238203048706
Epoch: 3, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4366617
	speed: 0.0755s/iter; left time: 3017.9247s
	iters: 200, epoch: 4 | loss: 0.0003882
	speed: 0.0224s/iter; left time: 891.3746s
	iters: 300, epoch: 4 | loss: 0.0020527
	speed: 0.0208s/iter; left time: 827.5909s
	iters: 400, epoch: 4 | loss: 0.0305974
	speed: 0.0209s/iter; left time: 829.9158s
Epoch: 4 cost time: 9.287940740585327
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0000894
	speed: 0.0783s/iter; left time: 3095.1482s
	iters: 200, epoch: 5 | loss: 0.0001458
	speed: 0.0213s/iter; left time: 839.6654s
	iters: 300, epoch: 5 | loss: 0.0000009
	speed: 0.0215s/iter; left time: 847.5842s
	iters: 400, epoch: 5 | loss: 0.0000242
	speed: 0.0225s/iter; left time: 881.9019s
Epoch: 5 cost time: 9.303643465042114
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000009
	speed: 0.0761s/iter; left time: 2978.7362s
	iters: 200, epoch: 6 | loss: 0.0257380
	speed: 0.0208s/iter; left time: 813.2875s
	iters: 300, epoch: 6 | loss: 0.0000058
	speed: 0.0237s/iter; left time: 921.8658s
	iters: 400, epoch: 6 | loss: 0.0000092
	speed: 0.0217s/iter; left time: 841.3037s
Epoch: 6 cost time: 9.401119470596313
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.2408172
	speed: 0.0735s/iter; left time: 2844.7714s
	iters: 200, epoch: 7 | loss: 0.2187177
	speed: 0.0208s/iter; left time: 803.1876s
	iters: 300, epoch: 7 | loss: 0.0872565
	speed: 0.0216s/iter; left time: 831.3294s
	iters: 400, epoch: 7 | loss: 0.0056032
	speed: 0.0219s/iter; left time: 842.1295s
Epoch: 7 cost time: 9.226487874984741
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0327626
	speed: 0.0740s/iter; left time: 2833.8028s
	iters: 200, epoch: 8 | loss: 0.0002417
	speed: 0.0219s/iter; left time: 837.5324s
	iters: 300, epoch: 8 | loss: 0.0001691
	speed: 0.0220s/iter; left time: 837.0595s
	iters: 400, epoch: 8 | loss: 0.0046718
	speed: 0.0208s/iter; left time: 791.8562s
Epoch: 8 cost time: 9.194276571273804
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000281
	speed: 0.0812s/iter; left time: 3077.1044s
	iters: 200, epoch: 9 | loss: 0.0110546
	speed: 0.0218s/iter; left time: 824.4799s
	iters: 300, epoch: 9 | loss: 0.0000205
	speed: 0.0220s/iter; left time: 828.1866s
	iters: 400, epoch: 9 | loss: 0.0001024
	speed: 0.0211s/iter; left time: 791.7310s
Epoch: 9 cost time: 9.390419721603394
Epoch: 9, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.979 Test Loss: 0.140 Test Acc: 0.979
Validation loss decreased (-0.978171 --> -0.978625).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0004357
	speed: 0.0759s/iter; left time: 2843.5556s
	iters: 200, epoch: 10 | loss: 0.0809313
	speed: 0.0217s/iter; left time: 811.0441s
	iters: 300, epoch: 10 | loss: 0.0000051
	speed: 0.0211s/iter; left time: 787.8907s
	iters: 400, epoch: 10 | loss: 0.0000088
	speed: 0.0220s/iter; left time: 819.8737s
Epoch: 10 cost time: 9.333557605743408
Epoch: 10, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.162 Vali Acc: 0.978 Test Loss: 0.162 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0585774
	speed: 0.0784s/iter; left time: 2905.3850s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 804.1982s
	iters: 300, epoch: 11 | loss: 0.0615502
	speed: 0.0222s/iter; left time: 818.9464s
	iters: 400, epoch: 11 | loss: 0.0000086
	speed: 0.0217s/iter; left time: 798.0353s
Epoch: 11 cost time: 9.373536825180054
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.983 Test Loss: 0.138 Test Acc: 0.983
Validation loss decreased (-0.978625 --> -0.982718).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000004
	speed: 0.0736s/iter; left time: 2698.1245s
	iters: 200, epoch: 12 | loss: 0.0000006
	speed: 0.0233s/iter; left time: 851.9582s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0229s/iter; left time: 835.8961s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 791.0054s
Epoch: 12 cost time: 9.678560495376587
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0751s/iter; left time: 2720.2978s
	iters: 200, epoch: 13 | loss: 0.0009502
	speed: 0.0226s/iter; left time: 817.4313s
	iters: 300, epoch: 13 | loss: 0.0003638
	speed: 0.0228s/iter; left time: 821.7865s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 836.0469s
Epoch: 13 cost time: 9.739360809326172
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.206 Vali Acc: 0.977 Test Loss: 0.206 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0279301
	speed: 0.0722s/iter; left time: 2586.9682s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 774.2246s
	iters: 300, epoch: 14 | loss: 0.0023610
	speed: 0.0218s/iter; left time: 777.1022s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 776.4929s
Epoch: 14 cost time: 9.360594987869263
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.984 Test Loss: 0.148 Test Acc: 0.984
Validation loss decreased (-0.982718 --> -0.984082).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0004301
	speed: 0.0862s/iter; left time: 3054.4467s
	iters: 200, epoch: 15 | loss: 0.0003219
	speed: 0.0232s/iter; left time: 819.4128s
	iters: 300, epoch: 15 | loss: 0.0001177
	speed: 0.0226s/iter; left time: 797.6672s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0224s/iter; left time: 787.9895s
Epoch: 15 cost time: 9.88774299621582
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.282 Vali Acc: 0.978 Test Loss: 0.282 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 3016.2810s
	iters: 200, epoch: 16 | loss: 0.0017421
	speed: 0.0227s/iter; left time: 792.7444s
	iters: 300, epoch: 16 | loss: 0.0000002
	speed: 0.0220s/iter; left time: 765.2388s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0224s/iter; left time: 778.9797s
Epoch: 16 cost time: 9.706303596496582
Epoch: 16, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.168 Vali Acc: 0.981 Test Loss: 0.168 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 2884.4626s
	iters: 200, epoch: 17 | loss: 0.0000022
	speed: 0.0220s/iter; left time: 758.2405s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 755.2449s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 771.0785s
Epoch: 17 cost time: 9.603693723678589
Epoch: 17, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.986 Test Loss: 0.093 Test Acc: 0.986
Validation loss decreased (-0.984082 --> -0.985902).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0815s/iter; left time: 2787.3332s
	iters: 200, epoch: 18 | loss: 0.0000137
	speed: 0.0217s/iter; left time: 738.3901s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0230s/iter; left time: 782.0183s
	iters: 400, epoch: 18 | loss: 0.0000031
	speed: 0.0217s/iter; left time: 736.3733s
Epoch: 18 cost time: 9.598244428634644
Epoch: 18, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.205 Vali Acc: 0.980 Test Loss: 0.205 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0804s/iter; left time: 2715.8475s
	iters: 200, epoch: 19 | loss: 0.0001172
	speed: 0.0232s/iter; left time: 781.2649s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 707.2671s
	iters: 400, epoch: 19 | loss: 0.0008211
	speed: 0.0205s/iter; left time: 685.5898s
Epoch: 19 cost time: 9.291361808776855
Epoch: 19, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.185 Vali Acc: 0.977 Test Loss: 0.185 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 2463.2098s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0232s/iter; left time: 772.2273s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 720.3130s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0218s/iter; left time: 721.4435s
Epoch: 20 cost time: 9.508780241012573
Epoch: 20, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.366 Vali Acc: 0.971 Test Loss: 0.366 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 2565.1638s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0201s/iter; left time: 659.1593s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 678.0939s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 687.4099s
Epoch: 21 cost time: 8.939557790756226
Epoch: 21, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.986 Test Loss: 0.124 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 2472.1686s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 672.0741s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0204s/iter; left time: 660.5483s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0204s/iter; left time: 658.6786s
Epoch: 22 cost time: 8.949240684509277
Epoch: 22, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.985 Test Loss: 0.119 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0738s/iter; left time: 2369.1808s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 708.3667s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 694.9147s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 717.1899s
Epoch: 23 cost time: 9.390478372573853
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.161 Vali Acc: 0.979 Test Loss: 0.161 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0743s/iter; left time: 2354.3639s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 676.0093s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 672.2319s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 683.5187s
Epoch: 24 cost time: 9.266036748886108
Epoch: 24, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2394.2011s
	iters: 200, epoch: 25 | loss: 0.0018526
	speed: 0.0211s/iter; left time: 657.7058s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 642.2792s
	iters: 400, epoch: 25 | loss: 0.0000006
	speed: 0.0218s/iter; left time: 674.9879s
Epoch: 25 cost time: 9.127993822097778
Epoch: 25, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.980 Test Loss: 0.210 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.7906527
	speed: 0.0751s/iter; left time: 2318.2724s
	iters: 200, epoch: 26 | loss: 0.0025616
	speed: 0.0206s/iter; left time: 632.9489s
	iters: 300, epoch: 26 | loss: 0.0000197
	speed: 0.0212s/iter; left time: 649.5913s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 687.1230s
Epoch: 26 cost time: 9.25266432762146
Epoch: 26, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.168 Vali Acc: 0.980 Test Loss: 0.168 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0833s/iter; left time: 2536.8559s
	iters: 200, epoch: 27 | loss: 0.0286738
	speed: 0.0218s/iter; left time: 661.1726s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.0213s/iter; left time: 645.8437s
	iters: 400, epoch: 27 | loss: 0.0197228
	speed: 0.0218s/iter; left time: 656.8794s
Epoch: 27 cost time: 9.471542119979858
Epoch: 27, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.985 Test Loss: 0.129 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 913230
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4220302
	speed: 0.0382s/iter; left time: 1573.5985s
	iters: 200, epoch: 1 | loss: 0.1129691
	speed: 0.0218s/iter; left time: 896.4798s
	iters: 300, epoch: 1 | loss: 0.0538240
	speed: 0.0217s/iter; left time: 890.7024s
	iters: 400, epoch: 1 | loss: 0.0266330
	speed: 0.0213s/iter; left time: 872.8499s
Epoch: 1 cost time: 10.656845331192017
Epoch: 1, Steps: 413 | Train Loss: 0.395 Vali Loss: 0.054 Vali Acc: 0.983 Test Loss: 0.054 Test Acc: 0.983
Validation loss decreased (inf --> -0.982719).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0190412
	speed: 0.0704s/iter; left time: 2872.1771s
	iters: 200, epoch: 2 | loss: 0.3515022
	speed: 0.0215s/iter; left time: 873.6640s
	iters: 300, epoch: 2 | loss: 0.0213079
	speed: 0.0199s/iter; left time: 809.5807s
	iters: 400, epoch: 2 | loss: 0.0003888
	speed: 0.0184s/iter; left time: 745.6121s
Epoch: 2 cost time: 8.565238952636719
Epoch: 2, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.067 Vali Acc: 0.976 Test Loss: 0.067 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0099501
	speed: 0.0649s/iter; left time: 2621.7829s
	iters: 200, epoch: 3 | loss: 0.0001029
	speed: 0.0204s/iter; left time: 820.3358s
	iters: 300, epoch: 3 | loss: 0.0022778
	speed: 0.0234s/iter; left time: 938.4161s
	iters: 400, epoch: 3 | loss: 0.0072006
	speed: 0.0227s/iter; left time: 910.7757s
Epoch: 3 cost time: 9.324859857559204
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0090995
	speed: 0.0743s/iter; left time: 2968.7859s
	iters: 200, epoch: 4 | loss: 0.0009014
	speed: 0.0214s/iter; left time: 854.2508s
	iters: 300, epoch: 4 | loss: 0.0010780
	speed: 0.0210s/iter; left time: 835.2843s
	iters: 400, epoch: 4 | loss: 0.0021784
	speed: 0.0216s/iter; left time: 858.0404s
Epoch: 4 cost time: 9.29634690284729
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0859148
	speed: 0.0760s/iter; left time: 3005.9380s
	iters: 200, epoch: 5 | loss: 0.0000361
	speed: 0.0214s/iter; left time: 844.2867s
	iters: 300, epoch: 5 | loss: 0.0001090
	speed: 0.0222s/iter; left time: 871.7107s
	iters: 400, epoch: 5 | loss: 0.0001729
	speed: 0.0216s/iter; left time: 845.9958s
Epoch: 5 cost time: 9.456485271453857
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000209
	speed: 0.0785s/iter; left time: 3073.4487s
	iters: 200, epoch: 6 | loss: 0.0000360
	speed: 0.0212s/iter; left time: 826.8832s
	iters: 300, epoch: 6 | loss: 0.0043930
	speed: 0.0212s/iter; left time: 824.2835s
	iters: 400, epoch: 6 | loss: 0.0000454
	speed: 0.0209s/iter; left time: 811.3013s
Epoch: 6 cost time: 9.286957740783691
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000159
	speed: 0.0858s/iter; left time: 3320.8115s
	iters: 200, epoch: 7 | loss: 0.0025142
	speed: 0.0218s/iter; left time: 841.2445s
	iters: 300, epoch: 7 | loss: 0.0000082
	speed: 0.0216s/iter; left time: 832.9581s
	iters: 400, epoch: 7 | loss: 0.0000006
	speed: 0.0220s/iter; left time: 846.2087s
Epoch: 7 cost time: 9.57140827178955
Epoch: 7, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.156 Vali Acc: 0.976 Test Loss: 0.156 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.1648996
	speed: 0.0822s/iter; left time: 3147.6750s
	iters: 200, epoch: 8 | loss: 0.6119069
	speed: 0.0217s/iter; left time: 828.1715s
	iters: 300, epoch: 8 | loss: 0.0001628
	speed: 0.0216s/iter; left time: 824.0468s
	iters: 400, epoch: 8 | loss: 0.1058018
	speed: 0.0214s/iter; left time: 811.7025s
Epoch: 8 cost time: 9.410834312438965
Epoch: 8, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.240 Vali Acc: 0.966 Test Loss: 0.240 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0001934
	speed: 0.0892s/iter; left time: 3382.1443s
	iters: 200, epoch: 9 | loss: 0.0052216
	speed: 0.0227s/iter; left time: 858.5550s
	iters: 300, epoch: 9 | loss: 0.0000791
	speed: 0.0222s/iter; left time: 838.5162s
	iters: 400, epoch: 9 | loss: 0.0727262
	speed: 0.0217s/iter; left time: 815.7293s
Epoch: 9 cost time: 9.730119705200195
Epoch: 9, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0229440
	speed: 0.0798s/iter; left time: 2990.1275s
	iters: 200, epoch: 10 | loss: 0.0005696
	speed: 0.0209s/iter; left time: 782.2451s
	iters: 300, epoch: 10 | loss: 0.0081124
	speed: 0.0208s/iter; left time: 777.1614s
	iters: 400, epoch: 10 | loss: 0.0000077
	speed: 0.0219s/iter; left time: 815.6125s
Epoch: 10 cost time: 9.237507343292236
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0007856
	speed: 0.0735s/iter; left time: 2725.4481s
	iters: 200, epoch: 11 | loss: 0.0000016
	speed: 0.0218s/iter; left time: 806.6559s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0209s/iter; left time: 772.1367s
	iters: 400, epoch: 11 | loss: 0.0000003
	speed: 0.0220s/iter; left time: 810.6635s
Epoch: 11 cost time: 9.340264320373535
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.243 Vali Acc: 0.968 Test Loss: 0.243 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 913230
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2303210
	speed: 0.0381s/iter; left time: 1571.1015s
	iters: 200, epoch: 1 | loss: 0.0856320
	speed: 0.0215s/iter; left time: 881.7931s
	iters: 300, epoch: 1 | loss: 0.0168774
	speed: 0.0205s/iter; left time: 842.4543s
	iters: 400, epoch: 1 | loss: 0.1654627
	speed: 0.0212s/iter; left time: 865.9321s
Epoch: 1 cost time: 10.469437837600708
Epoch: 1, Steps: 413 | Train Loss: 0.313 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
Validation loss decreased (inf --> -0.969986).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0108738
	speed: 0.0703s/iter; left time: 2865.7088s
	iters: 200, epoch: 2 | loss: 0.2487425
	speed: 0.0205s/iter; left time: 833.7346s
	iters: 300, epoch: 2 | loss: 0.0651914
	speed: 0.0210s/iter; left time: 850.5173s
	iters: 400, epoch: 2 | loss: 0.0016513
	speed: 0.0217s/iter; left time: 879.3740s
Epoch: 2 cost time: 8.943661212921143
Epoch: 2, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.969986 --> -0.980900).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0006920
	speed: 0.0755s/iter; left time: 3049.5354s
	iters: 200, epoch: 3 | loss: 0.3043515
	speed: 0.0223s/iter; left time: 897.9418s
	iters: 300, epoch: 3 | loss: 0.0002072
	speed: 0.0213s/iter; left time: 857.2781s
	iters: 400, epoch: 3 | loss: 0.0001495
	speed: 0.0219s/iter; left time: 878.2583s
Epoch: 3 cost time: 9.345729112625122
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000908
	speed: 0.0738s/iter; left time: 2948.0990s
	iters: 200, epoch: 4 | loss: 0.0307896
	speed: 0.0209s/iter; left time: 834.7506s
	iters: 300, epoch: 4 | loss: 0.0000716
	speed: 0.0217s/iter; left time: 862.0643s
	iters: 400, epoch: 4 | loss: 0.0000049
	speed: 0.0213s/iter; left time: 846.7705s
Epoch: 4 cost time: 9.18346095085144
Epoch: 4, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.164 Vali Acc: 0.966 Test Loss: 0.164 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000388
	speed: 0.0772s/iter; left time: 3052.7967s
	iters: 200, epoch: 5 | loss: 0.0000197
	speed: 0.0211s/iter; left time: 834.1120s
	iters: 300, epoch: 5 | loss: 0.0004358
	speed: 0.0223s/iter; left time: 876.9361s
	iters: 400, epoch: 5 | loss: 0.0589874
	speed: 0.0220s/iter; left time: 865.0668s
Epoch: 5 cost time: 9.484023332595825
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.389 Vali Acc: 0.947 Test Loss: 0.389 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000060
	speed: 0.0722s/iter; left time: 2827.1765s
	iters: 200, epoch: 6 | loss: 0.0690840
	speed: 0.0211s/iter; left time: 824.1531s
	iters: 300, epoch: 6 | loss: 0.0201912
	speed: 0.0207s/iter; left time: 804.7585s
	iters: 400, epoch: 6 | loss: 0.3046381
	speed: 0.0218s/iter; left time: 845.8552s
Epoch: 6 cost time: 9.012606859207153
Epoch: 6, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.269 Vali Acc: 0.965 Test Loss: 0.269 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1026899
	speed: 0.0801s/iter; left time: 3100.8295s
	iters: 200, epoch: 7 | loss: 0.0000673
	speed: 0.0205s/iter; left time: 789.8956s
	iters: 300, epoch: 7 | loss: 0.0000040
	speed: 0.0206s/iter; left time: 794.8356s
	iters: 400, epoch: 7 | loss: 0.0000420
	speed: 0.0210s/iter; left time: 807.8884s
Epoch: 7 cost time: 8.93140172958374
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.097 Vali Acc: 0.985 Test Loss: 0.097 Test Acc: 0.985
Validation loss decreased (-0.980900 --> -0.985447).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0002050
	speed: 0.0792s/iter; left time: 3033.2427s
	iters: 200, epoch: 8 | loss: 0.0117397
	speed: 0.0206s/iter; left time: 788.9280s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 820.9148s
	iters: 400, epoch: 8 | loss: 0.0015049
	speed: 0.0209s/iter; left time: 794.6257s
Epoch: 8 cost time: 9.121732711791992
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0007560
	speed: 0.0735s/iter; left time: 2785.8662s
	iters: 200, epoch: 9 | loss: 0.0000024
	speed: 0.0220s/iter; left time: 830.2110s
	iters: 300, epoch: 9 | loss: 0.0000002
	speed: 0.0230s/iter; left time: 866.8807s
	iters: 400, epoch: 9 | loss: 0.0000015
	speed: 0.0226s/iter; left time: 847.9336s
Epoch: 9 cost time: 9.589077234268188
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.173 Vali Acc: 0.979 Test Loss: 0.173 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0010994
	speed: 0.0728s/iter; left time: 2729.1292s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0231s/iter; left time: 864.0576s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0230s/iter; left time: 856.2356s
	iters: 400, epoch: 10 | loss: 0.0000092
	speed: 0.0228s/iter; left time: 847.0946s
Epoch: 10 cost time: 9.778156757354736
Epoch: 10, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.179 Vali Acc: 0.980 Test Loss: 0.179 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 2773.8352s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0236s/iter; left time: 874.1401s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0227s/iter; left time: 838.6998s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0233s/iter; left time: 855.4663s
Epoch: 11 cost time: 9.971026182174683
Epoch: 11, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.320 Vali Acc: 0.971 Test Loss: 0.320 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.0752s/iter; left time: 2756.6556s
	iters: 200, epoch: 12 | loss: 0.0003655
	speed: 0.0228s/iter; left time: 833.0205s
	iters: 300, epoch: 12 | loss: 0.0000040
	speed: 0.0232s/iter; left time: 846.3187s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 846.7887s
Epoch: 12 cost time: 9.91219711303711
Epoch: 12, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.182 Vali Acc: 0.982 Test Loss: 0.182 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000023
	speed: 0.0866s/iter; left time: 3139.5478s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 800.9541s
	iters: 300, epoch: 13 | loss: 0.0008923
	speed: 0.0217s/iter; left time: 782.5444s
	iters: 400, epoch: 13 | loss: 4.1227288
	speed: 0.0225s/iter; left time: 809.0760s
Epoch: 13 cost time: 9.621448040008545
Epoch: 13, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.286 Vali Acc: 0.973 Test Loss: 0.286 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0861s/iter; left time: 3084.0685s
	iters: 200, epoch: 14 | loss: 0.1348266
	speed: 0.0224s/iter; left time: 801.6136s
	iters: 300, epoch: 14 | loss: 0.0004552
	speed: 0.0227s/iter; left time: 809.0887s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 788.1207s
Epoch: 14 cost time: 9.79627251625061
Epoch: 14, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.150 Vali Acc: 0.979 Test Loss: 0.150 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000123
	speed: 0.0774s/iter; left time: 2740.8956s
	iters: 200, epoch: 15 | loss: 0.0000056
	speed: 0.0222s/iter; left time: 783.9406s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0224s/iter; left time: 790.1704s
	iters: 400, epoch: 15 | loss: 0.0001358
	speed: 0.0217s/iter; left time: 762.1199s
Epoch: 15 cost time: 9.509938716888428
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.979 Test Loss: 0.199 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 2746.5389s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 747.5198s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 763.2066s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 752.0761s
Epoch: 16 cost time: 9.332751512527466
Epoch: 16, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.342 Vali Acc: 0.967 Test Loss: 0.342 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 2714.3561s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0222s/iter; left time: 766.5079s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 730.3759s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 758.5547s
Epoch: 17 cost time: 9.393031597137451
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.159 Vali Acc: 0.983 Test Loss: 0.159 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 651086
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2574903
	speed: 0.0398s/iter; left time: 1640.2676s
	iters: 200, epoch: 1 | loss: 0.0965671
	speed: 0.0208s/iter; left time: 855.8986s
	iters: 300, epoch: 1 | loss: 0.0210542
	speed: 0.0210s/iter; left time: 860.1984s
	iters: 400, epoch: 1 | loss: 0.1489234
	speed: 0.0206s/iter; left time: 843.8662s
Epoch: 1 cost time: 10.542256355285645
Epoch: 1, Steps: 413 | Train Loss: 0.321 Vali Loss: 0.095 Vali Acc: 0.963 Test Loss: 0.095 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0055166
	speed: 0.0783s/iter; left time: 3193.4479s
	iters: 200, epoch: 2 | loss: 0.5676202
	speed: 0.0218s/iter; left time: 888.5698s
	iters: 300, epoch: 2 | loss: 0.0284762
	speed: 0.0204s/iter; left time: 826.8885s
	iters: 400, epoch: 2 | loss: 0.0081369
	speed: 0.0225s/iter; left time: 910.2830s
Epoch: 2 cost time: 9.339654207229614
Epoch: 2, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.962709 --> -0.985447).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0069773
	speed: 0.0728s/iter; left time: 2941.0350s
	iters: 200, epoch: 3 | loss: 0.0020376
	speed: 0.0228s/iter; left time: 917.7041s
	iters: 300, epoch: 3 | loss: 0.0152113
	speed: 0.0220s/iter; left time: 882.0495s
	iters: 400, epoch: 3 | loss: 0.0762116
	speed: 0.0224s/iter; left time: 897.4445s
Epoch: 3 cost time: 9.566247701644897
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000140
	speed: 0.0757s/iter; left time: 3025.6281s
	iters: 200, epoch: 4 | loss: 0.0004185
	speed: 0.0227s/iter; left time: 904.1056s
	iters: 300, epoch: 4 | loss: 0.0082935
	speed: 0.0229s/iter; left time: 909.8397s
	iters: 400, epoch: 4 | loss: 0.0000157
	speed: 0.0220s/iter; left time: 871.7690s
Epoch: 4 cost time: 9.63001537322998
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0375771
	speed: 0.0723s/iter; left time: 2860.4927s
	iters: 200, epoch: 5 | loss: 0.0000002
	speed: 0.0222s/iter; left time: 876.9714s
	iters: 300, epoch: 5 | loss: 0.0008327
	speed: 0.0231s/iter; left time: 907.9643s
	iters: 400, epoch: 5 | loss: 0.0000025
	speed: 0.0224s/iter; left time: 880.4971s
Epoch: 5 cost time: 9.495145082473755
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3663735
	speed: 0.0833s/iter; left time: 3259.5140s
	iters: 200, epoch: 6 | loss: 0.0016937
	speed: 0.0229s/iter; left time: 893.0616s
	iters: 300, epoch: 6 | loss: 0.0000058
	speed: 0.0222s/iter; left time: 863.6335s
	iters: 400, epoch: 6 | loss: 0.0054964
	speed: 0.0219s/iter; left time: 849.1572s
Epoch: 6 cost time: 9.76825475692749
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.236 Vali Acc: 0.964 Test Loss: 0.236 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 3162.3556s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0228s/iter; left time: 879.0562s
	iters: 300, epoch: 7 | loss: 0.0772874
	speed: 0.0217s/iter; left time: 835.6448s
	iters: 400, epoch: 7 | loss: 0.0003343
	speed: 0.0219s/iter; left time: 841.6944s
Epoch: 7 cost time: 9.544965982437134
Epoch: 7, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0279671
	speed: 0.0813s/iter; left time: 3116.2101s
	iters: 200, epoch: 8 | loss: 0.0000819
	speed: 0.0210s/iter; left time: 803.6922s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 857.3880s
	iters: 400, epoch: 8 | loss: 0.0000247
	speed: 0.0225s/iter; left time: 853.5321s
Epoch: 8 cost time: 9.60031270980835
Epoch: 8, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.194 Vali Acc: 0.977 Test Loss: 0.194 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000288
	speed: 0.0766s/iter; left time: 2903.8236s
	iters: 200, epoch: 9 | loss: 0.0009705
	speed: 0.0226s/iter; left time: 854.0922s
	iters: 300, epoch: 9 | loss: 0.0002371
	speed: 0.0222s/iter; left time: 838.2107s
	iters: 400, epoch: 9 | loss: 0.0000293
	speed: 0.0223s/iter; left time: 836.9838s
Epoch: 9 cost time: 9.542459726333618
Epoch: 9, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.279 Vali Acc: 0.969 Test Loss: 0.279 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0196360
	speed: 0.0752s/iter; left time: 2820.5988s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 811.3857s
	iters: 300, epoch: 10 | loss: 0.0000002
	speed: 0.0227s/iter; left time: 846.8452s
	iters: 400, epoch: 10 | loss: 0.1167974
	speed: 0.0226s/iter; left time: 839.0193s
Epoch: 10 cost time: 9.599952220916748
Epoch: 10, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.227 Vali Acc: 0.977 Test Loss: 0.227 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 2813.6093s
	iters: 200, epoch: 11 | loss: 0.0000030
	speed: 0.0240s/iter; left time: 886.4508s
	iters: 300, epoch: 11 | loss: 0.3995443
	speed: 0.0238s/iter; left time: 877.5222s
	iters: 400, epoch: 11 | loss: 0.0586271
	speed: 0.0240s/iter; left time: 884.3335s
Epoch: 11 cost time: 10.131198167800903
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.232 Vali Acc: 0.972 Test Loss: 0.232 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 2864.8375s
	iters: 200, epoch: 12 | loss: 0.0000187
	speed: 0.0213s/iter; left time: 778.6585s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0222s/iter; left time: 808.6062s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0214s/iter; left time: 778.6228s
Epoch: 12 cost time: 9.34051251411438
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.977 Test Loss: 0.185 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 651086
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2767371
	speed: 0.0378s/iter; left time: 1557.2723s
	iters: 200, epoch: 1 | loss: 0.0617220
	speed: 0.0219s/iter; left time: 899.1568s
	iters: 300, epoch: 1 | loss: 0.0278916
	speed: 0.0203s/iter; left time: 832.2308s
	iters: 400, epoch: 1 | loss: 0.1448106
	speed: 0.0214s/iter; left time: 876.4177s
Epoch: 1 cost time: 10.500197410583496
Epoch: 1, Steps: 413 | Train Loss: 0.338 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
Validation loss decreased (inf --> -0.974988).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0139999
	speed: 0.0766s/iter; left time: 3124.1280s
	iters: 200, epoch: 2 | loss: 0.2004251
	speed: 0.0221s/iter; left time: 900.6752s
	iters: 300, epoch: 2 | loss: 0.0554761
	speed: 0.0209s/iter; left time: 849.3377s
	iters: 400, epoch: 2 | loss: 0.0011967
	speed: 0.0208s/iter; left time: 842.8380s
Epoch: 2 cost time: 9.203468561172485
Epoch: 2, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
Validation loss decreased (-0.974988 --> -0.978626).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0058237
	speed: 0.0773s/iter; left time: 3121.0528s
	iters: 200, epoch: 3 | loss: 0.0688320
	speed: 0.0220s/iter; left time: 887.2540s
	iters: 300, epoch: 3 | loss: 0.0096353
	speed: 0.0213s/iter; left time: 856.8284s
	iters: 400, epoch: 3 | loss: 0.0007934
	speed: 0.0229s/iter; left time: 916.5152s
Epoch: 3 cost time: 9.462572813034058
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000588
	speed: 0.0792s/iter; left time: 3163.5095s
	iters: 200, epoch: 4 | loss: 0.1106908
	speed: 0.0215s/iter; left time: 857.1485s
	iters: 300, epoch: 4 | loss: 0.1121873
	speed: 0.0219s/iter; left time: 869.5370s
	iters: 400, epoch: 4 | loss: 0.0005305
	speed: 0.0210s/iter; left time: 833.3733s
Epoch: 4 cost time: 9.207319259643555
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.230 Vali Acc: 0.960 Test Loss: 0.230 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0001720
	speed: 0.0840s/iter; left time: 3320.6573s
	iters: 200, epoch: 5 | loss: 0.0000004
	speed: 0.0209s/iter; left time: 823.5100s
	iters: 300, epoch: 5 | loss: 0.0002564
	speed: 0.0216s/iter; left time: 849.4987s
	iters: 400, epoch: 5 | loss: 0.0005047
	speed: 0.0217s/iter; left time: 853.4450s
Epoch: 5 cost time: 9.282294273376465
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.978626 --> -0.979081).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0019016
	speed: 0.0828s/iter; left time: 3239.9459s
	iters: 200, epoch: 6 | loss: 0.0001651
	speed: 0.0223s/iter; left time: 870.3196s
	iters: 300, epoch: 6 | loss: 0.1505498
	speed: 0.0237s/iter; left time: 923.4153s
	iters: 400, epoch: 6 | loss: 0.0254803
	speed: 0.0228s/iter; left time: 883.8795s
Epoch: 6 cost time: 9.914425373077393
Epoch: 6, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.327 Vali Acc: 0.944 Test Loss: 0.327 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 3130.8175s
	iters: 200, epoch: 7 | loss: 0.0000369
	speed: 0.0213s/iter; left time: 821.5866s
	iters: 300, epoch: 7 | loss: 0.0671831
	speed: 0.0216s/iter; left time: 833.8253s
	iters: 400, epoch: 7 | loss: 0.0000191
	speed: 0.0216s/iter; left time: 831.2476s
Epoch: 7 cost time: 9.305458068847656
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1182707
	speed: 0.0735s/iter; left time: 2814.2276s
	iters: 200, epoch: 8 | loss: 0.0005979
	speed: 0.0219s/iter; left time: 835.3114s
	iters: 300, epoch: 8 | loss: 0.1277388
	speed: 0.0224s/iter; left time: 852.6867s
	iters: 400, epoch: 8 | loss: 0.0001414
	speed: 0.0222s/iter; left time: 842.7266s
Epoch: 8 cost time: 9.543185949325562
Epoch: 8, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000034
	speed: 0.0718s/iter; left time: 2721.8546s
	iters: 200, epoch: 9 | loss: 0.0000123
	speed: 0.0220s/iter; left time: 831.1413s
	iters: 300, epoch: 9 | loss: 0.0000004
	speed: 0.0217s/iter; left time: 818.9326s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 808.4237s
Epoch: 9 cost time: 9.296920537948608
Epoch: 9, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.179 Vali Acc: 0.976 Test Loss: 0.179 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.0722s/iter; left time: 2706.0612s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 818.9670s
	iters: 300, epoch: 10 | loss: 0.0323021
	speed: 0.0203s/iter; left time: 756.6666s
	iters: 400, epoch: 10 | loss: 0.0018197
	speed: 0.0208s/iter; left time: 771.7066s
Epoch: 10 cost time: 8.972673654556274
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.256 Vali Acc: 0.970 Test Loss: 0.256 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 2815.2605s
	iters: 200, epoch: 11 | loss: 0.0006039
	speed: 0.0221s/iter; left time: 816.5304s
	iters: 300, epoch: 11 | loss: 0.0000161
	speed: 0.0223s/iter; left time: 823.0279s
	iters: 400, epoch: 11 | loss: 0.0005172
	speed: 0.0204s/iter; left time: 749.7144s
Epoch: 11 cost time: 9.410794258117676
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.196 Vali Acc: 0.976 Test Loss: 0.196 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0005624
	speed: 0.0774s/iter; left time: 2836.5204s
	iters: 200, epoch: 12 | loss: 0.0015172
	speed: 0.0207s/iter; left time: 758.5652s
	iters: 300, epoch: 12 | loss: 0.0000003
	speed: 0.0214s/iter; left time: 778.8106s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 769.3417s
Epoch: 12 cost time: 9.138945817947388
Epoch: 12, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.277 Vali Acc: 0.966 Test Loss: 0.277 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1657556
	speed: 0.0786s/iter; left time: 2848.0102s
	iters: 200, epoch: 13 | loss: 0.0000014
	speed: 0.0225s/iter; left time: 812.9667s
	iters: 300, epoch: 13 | loss: 0.0000697
	speed: 0.0215s/iter; left time: 774.6184s
	iters: 400, epoch: 13 | loss: 0.0010675
	speed: 0.0220s/iter; left time: 789.0398s
Epoch: 13 cost time: 9.58808946609497
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.271 Vali Acc: 0.976 Test Loss: 0.271 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0720s/iter; left time: 2579.5614s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0196s/iter; left time: 698.7965s
	iters: 300, epoch: 14 | loss: 0.0036605
	speed: 0.0216s/iter; left time: 771.1299s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 734.2030s
Epoch: 14 cost time: 8.860841274261475
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.980 Test Loss: 0.192 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979534).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0753s/iter; left time: 2666.3345s
	iters: 200, epoch: 15 | loss: 0.0019396
	speed: 0.0210s/iter; left time: 741.3352s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0220s/iter; left time: 773.0694s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 757.5257s
Epoch: 15 cost time: 9.281297206878662
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.321 Vali Acc: 0.972 Test Loss: 0.321 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0736s/iter; left time: 2574.7828s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 733.8435s
	iters: 300, epoch: 16 | loss: 0.0000004
	speed: 0.0210s/iter; left time: 730.9314s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 746.0394s
Epoch: 16 cost time: 9.079246997833252
Epoch: 16, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.198 Vali Acc: 0.977 Test Loss: 0.198 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0003596
	speed: 0.0758s/iter; left time: 2623.3563s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 708.7146s
	iters: 300, epoch: 17 | loss: 0.0000024
	speed: 0.0206s/iter; left time: 707.9290s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0199s/iter; left time: 681.9672s
Epoch: 17 cost time: 8.69739580154419
Epoch: 17, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.285 Vali Acc: 0.978 Test Loss: 0.285 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000004
	speed: 0.0773s/iter; left time: 2643.3616s
	iters: 200, epoch: 18 | loss: 0.0000005
	speed: 0.0217s/iter; left time: 738.2556s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 725.4484s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 696.2481s
Epoch: 18 cost time: 9.23026418685913
Epoch: 18, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.218 Vali Acc: 0.980 Test Loss: 0.218 Test Acc: 0.980
Validation loss decreased (-0.979534 --> -0.980443).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0337435
	speed: 0.0770s/iter; left time: 2601.7223s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0226s/iter; left time: 760.0278s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 719.5154s
	iters: 400, epoch: 19 | loss: 0.0000011
	speed: 0.0222s/iter; left time: 743.1924s
Epoch: 19 cost time: 9.333217859268188
Epoch: 19, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.980 Test Loss: 0.202 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0024874
	speed: 0.0614s/iter; left time: 2048.3781s
	iters: 200, epoch: 20 | loss: 0.0000024
	speed: 0.0190s/iter; left time: 631.9529s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0196s/iter; left time: 649.7168s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 689.0600s
Epoch: 20 cost time: 8.436068296432495
Epoch: 20, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.248 Vali Acc: 0.980 Test Loss: 0.248 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0629s/iter; left time: 2071.1635s
	iters: 200, epoch: 21 | loss: 0.8553297
	speed: 0.0200s/iter; left time: 656.5610s
	iters: 300, epoch: 21 | loss: 0.0000173
	speed: 0.0213s/iter; left time: 697.3555s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 717.2563s
Epoch: 21 cost time: 9.03403639793396
Epoch: 21, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.985 Test Loss: 0.124 Test Acc: 0.985
Validation loss decreased (-0.980443 --> -0.985447).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 2388.8903s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 708.2267s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 695.2264s
	iters: 400, epoch: 22 | loss: 0.0000873
	speed: 0.0205s/iter; left time: 660.4484s
Epoch: 22 cost time: 9.143020153045654
Epoch: 22, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.224 Vali Acc: 0.980 Test Loss: 0.224 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0751s/iter; left time: 2412.2592s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 668.4507s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.0214s/iter; left time: 682.5659s
	iters: 400, epoch: 23 | loss: 0.0041474
	speed: 0.0208s/iter; left time: 662.9680s
Epoch: 23 cost time: 9.003809690475464
Epoch: 23, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0754s/iter; left time: 2391.3444s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 673.2805s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 656.7504s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 697.0322s
Epoch: 24 cost time: 9.290841341018677
Epoch: 24, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.218 Vali Acc: 0.984 Test Loss: 0.218 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0793s/iter; left time: 2480.7738s
	iters: 200, epoch: 25 | loss: 0.0000010
	speed: 0.0217s/iter; left time: 676.9919s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 671.6406s
	iters: 400, epoch: 25 | loss: 0.0145048
	speed: 0.0218s/iter; left time: 674.1841s
Epoch: 25 cost time: 9.320763349533081
Epoch: 25, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.163 Vali Acc: 0.983 Test Loss: 0.163 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0738s/iter; left time: 2277.9310s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 635.9201s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 661.9237s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 662.1459s
Epoch: 26 cost time: 9.215214729309082
Epoch: 26, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.171 Vali Acc: 0.981 Test Loss: 0.171 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2338.2159s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0204s/iter; left time: 618.3478s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 645.1358s
	iters: 400, epoch: 27 | loss: 0.0000001
	speed: 0.0208s/iter; left time: 626.4825s
Epoch: 27 cost time: 9.11531949043274
Epoch: 27, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.168 Vali Acc: 0.984 Test Loss: 0.168 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0800s/iter; left time: 2402.5976s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 621.9931s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 619.4714s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 645.1000s
Epoch: 28 cost time: 9.197423219680786
Epoch: 28, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.194 Vali Acc: 0.983 Test Loss: 0.194 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.0820s/iter; left time: 2430.3979s
	iters: 200, epoch: 29 | loss: 0.0000155
	speed: 0.0210s/iter; left time: 619.4293s
	iters: 300, epoch: 29 | loss: 0.0000050
	speed: 0.0214s/iter; left time: 629.4491s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 622.4297s
Epoch: 29 cost time: 9.221502780914307
Epoch: 29, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.171 Vali Acc: 0.982 Test Loss: 0.171 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.0847s/iter; left time: 2475.5806s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 677.3986s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0224s/iter; left time: 648.9023s
	iters: 400, epoch: 30 | loss: 0.0000003
	speed: 0.0215s/iter; left time: 621.4498s
Epoch: 30 cost time: 9.737089157104492
Epoch: 30, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.985 Test Loss: 0.202 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 2253.8812s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0203s/iter; left time: 583.5987s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 596.0435s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 614.1952s
Epoch: 31 cost time: 8.948745965957642
Epoch: 31, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.271 Vali Acc: 0.976 Test Loss: 0.271 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 651086
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4075657
	speed: 0.0366s/iter; left time: 1508.4629s
	iters: 200, epoch: 1 | loss: 0.0909335
	speed: 0.0212s/iter; left time: 869.5464s
	iters: 300, epoch: 1 | loss: 0.0110006
	speed: 0.0220s/iter; left time: 902.1007s
	iters: 400, epoch: 1 | loss: 0.1809634
	speed: 0.0224s/iter; left time: 916.5494s
Epoch: 1 cost time: 10.531418800354004
Epoch: 1, Steps: 413 | Train Loss: 0.391 Vali Loss: 0.078 Vali Acc: 0.972 Test Loss: 0.078 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0151966
	speed: 0.0710s/iter; left time: 2896.0683s
	iters: 200, epoch: 2 | loss: 0.3659111
	speed: 0.0221s/iter; left time: 901.1900s
	iters: 300, epoch: 2 | loss: 0.0592491
	speed: 0.0227s/iter; left time: 920.4427s
	iters: 400, epoch: 2 | loss: 0.0138535
	speed: 0.0222s/iter; left time: 897.2236s
Epoch: 2 cost time: 9.378864526748657
Epoch: 2, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1603704
	speed: 0.0743s/iter; left time: 2998.5361s
	iters: 200, epoch: 3 | loss: 0.1218170
	speed: 0.0213s/iter; left time: 858.4816s
	iters: 300, epoch: 3 | loss: 0.0143255
	speed: 0.0215s/iter; left time: 864.3095s
	iters: 400, epoch: 3 | loss: 0.0049069
	speed: 0.0209s/iter; left time: 836.5457s
Epoch: 3 cost time: 9.096853971481323
Epoch: 3, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0002558
	speed: 0.0745s/iter; left time: 2976.3502s
	iters: 200, epoch: 4 | loss: 0.0014147
	speed: 0.0210s/iter; left time: 837.1312s
	iters: 300, epoch: 4 | loss: 0.0007571
	speed: 0.0220s/iter; left time: 875.5268s
	iters: 400, epoch: 4 | loss: 0.0007143
	speed: 0.0217s/iter; left time: 859.9851s
Epoch: 4 cost time: 9.400647401809692
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.190 Vali Acc: 0.966 Test Loss: 0.190 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0002109
	speed: 0.0783s/iter; left time: 3097.2954s
	iters: 200, epoch: 5 | loss: 0.0001755
	speed: 0.0214s/iter; left time: 843.1079s
	iters: 300, epoch: 5 | loss: 0.0000418
	speed: 0.0217s/iter; left time: 851.9974s
	iters: 400, epoch: 5 | loss: 0.0000449
	speed: 0.0216s/iter; left time: 847.3821s
Epoch: 5 cost time: 9.224961519241333
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
Validation loss decreased (-0.972259 --> -0.978171).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000058
	speed: 0.0746s/iter; left time: 2918.7588s
	iters: 200, epoch: 6 | loss: 0.2078926
	speed: 0.0213s/iter; left time: 830.3485s
	iters: 300, epoch: 6 | loss: 0.0000965
	speed: 0.0227s/iter; left time: 883.9209s
	iters: 400, epoch: 6 | loss: 0.0013992
	speed: 0.0225s/iter; left time: 875.3669s
Epoch: 6 cost time: 9.421290874481201
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1027069
	speed: 0.0738s/iter; left time: 2858.2389s
	iters: 200, epoch: 7 | loss: 0.0000007
	speed: 0.0208s/iter; left time: 802.1723s
	iters: 300, epoch: 7 | loss: 0.3836075
	speed: 0.0229s/iter; left time: 882.3285s
	iters: 400, epoch: 7 | loss: 0.0000611
	speed: 0.0241s/iter; left time: 924.6665s
Epoch: 7 cost time: 9.567965984344482
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0006166
	speed: 0.0769s/iter; left time: 2946.8765s
	iters: 200, epoch: 8 | loss: 0.0000005
	speed: 0.0212s/iter; left time: 809.3777s
	iters: 300, epoch: 8 | loss: 0.0000011
	speed: 0.0224s/iter; left time: 852.9944s
	iters: 400, epoch: 8 | loss: 0.0004817
	speed: 0.0222s/iter; left time: 842.5967s
Epoch: 8 cost time: 9.40762710571289
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.974 Test Loss: 0.159 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0206971
	speed: 0.0753s/iter; left time: 2854.5609s
	iters: 200, epoch: 9 | loss: 0.0007158
	speed: 0.0203s/iter; left time: 766.4526s
	iters: 300, epoch: 9 | loss: 0.0000033
	speed: 0.0201s/iter; left time: 758.8469s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 769.3118s
Epoch: 9 cost time: 8.799044132232666
Epoch: 9, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
Validation loss decreased (-0.978171 --> -0.985447).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000005
	speed: 0.0765s/iter; left time: 2868.4665s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0212s/iter; left time: 791.5408s
	iters: 300, epoch: 10 | loss: 0.1205510
	speed: 0.0204s/iter; left time: 761.8096s
	iters: 400, epoch: 10 | loss: 0.5993120
	speed: 0.0212s/iter; left time: 786.5370s
Epoch: 10 cost time: 9.0086510181427
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0714s/iter; left time: 2648.3790s
	iters: 200, epoch: 11 | loss: 0.0088218
	speed: 0.0214s/iter; left time: 790.9032s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0219s/iter; left time: 807.0668s
	iters: 400, epoch: 11 | loss: 0.0000448
	speed: 0.0234s/iter; left time: 858.8604s
Epoch: 11 cost time: 9.52603530883789
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.972 Test Loss: 0.222 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000014
	speed: 0.0718s/iter; left time: 2631.9718s
	iters: 200, epoch: 12 | loss: 0.0000335
	speed: 0.0221s/iter; left time: 808.9166s
	iters: 300, epoch: 12 | loss: 0.0095575
	speed: 0.0225s/iter; left time: 822.0679s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0216s/iter; left time: 786.8689s
Epoch: 12 cost time: 9.452705144882202
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.209 Vali Acc: 0.967 Test Loss: 0.209 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0005403
	speed: 0.0715s/iter; left time: 2592.8219s
	iters: 200, epoch: 13 | loss: 0.2613598
	speed: 0.0220s/iter; left time: 794.4885s
	iters: 300, epoch: 13 | loss: 0.0000012
	speed: 0.0215s/iter; left time: 774.2388s
	iters: 400, epoch: 13 | loss: 0.0015848
	speed: 0.0215s/iter; left time: 771.7944s
Epoch: 13 cost time: 9.365149021148682
Epoch: 13, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.264 Vali Acc: 0.978 Test Loss: 0.264 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1489623
	speed: 0.0771s/iter; left time: 2762.9764s
	iters: 200, epoch: 14 | loss: 0.0000090
	speed: 0.0230s/iter; left time: 822.7983s
	iters: 300, epoch: 14 | loss: 0.0000006
	speed: 0.0225s/iter; left time: 802.3167s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.0231s/iter; left time: 819.5839s
Epoch: 14 cost time: 9.733887434005737
Epoch: 14, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0828s/iter; left time: 2931.6352s
	iters: 200, epoch: 15 | loss: 0.0000044
	speed: 0.0210s/iter; left time: 743.2993s
	iters: 300, epoch: 15 | loss: 0.0000411
	speed: 0.0220s/iter; left time: 773.2129s
	iters: 400, epoch: 15 | loss: 0.0000209
	speed: 0.0214s/iter; left time: 751.3668s
Epoch: 15 cost time: 9.3624107837677
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.164 Vali Acc: 0.984 Test Loss: 0.164 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 2884.8046s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 768.1125s
	iters: 300, epoch: 16 | loss: 0.0000006
	speed: 0.0230s/iter; left time: 800.7539s
	iters: 400, epoch: 16 | loss: 0.0000112
	speed: 0.0228s/iter; left time: 790.6647s
Epoch: 16 cost time: 9.704205751419067
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.205 Vali Acc: 0.981 Test Loss: 0.205 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000003
	speed: 0.0769s/iter; left time: 2661.6664s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 714.2463s
	iters: 300, epoch: 17 | loss: 0.2141024
	speed: 0.0210s/iter; left time: 721.2354s
	iters: 400, epoch: 17 | loss: 0.0001714
	speed: 0.0202s/iter; left time: 692.4121s
Epoch: 17 cost time: 9.018235683441162
Epoch: 17, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.133 Vali Acc: 0.979 Test Loss: 0.133 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000007
	speed: 0.0774s/iter; left time: 2646.2459s
	iters: 200, epoch: 18 | loss: 0.0993528
	speed: 0.0214s/iter; left time: 727.8581s
	iters: 300, epoch: 18 | loss: 0.0000697
	speed: 0.0209s/iter; left time: 709.6559s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 706.5371s
Epoch: 18 cost time: 9.077950954437256
Epoch: 18, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.140 Vali Acc: 0.984 Test Loss: 0.140 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0728s/iter; left time: 2456.7855s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0219s/iter; left time: 737.0902s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 723.8792s
	iters: 400, epoch: 19 | loss: 0.0007664
	speed: 0.0212s/iter; left time: 710.9443s
Epoch: 19 cost time: 9.345497369766235
Epoch: 19, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.984 Test Loss: 0.143 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 651086
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1291559
	speed: 0.0404s/iter; left time: 1663.7607s
	iters: 200, epoch: 1 | loss: 0.0612194
	speed: 0.0220s/iter; left time: 902.7297s
	iters: 300, epoch: 1 | loss: 0.0385326
	speed: 0.0218s/iter; left time: 893.7849s
	iters: 400, epoch: 1 | loss: 0.3833731
	speed: 0.0223s/iter; left time: 910.7145s
Epoch: 1 cost time: 11.008447885513306
Epoch: 1, Steps: 413 | Train Loss: 0.328 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
Validation loss decreased (inf --> -0.967257).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1713492
	speed: 0.0787s/iter; left time: 3209.6900s
	iters: 200, epoch: 2 | loss: 0.0010265
	speed: 0.0219s/iter; left time: 891.9821s
	iters: 300, epoch: 2 | loss: 0.0005332
	speed: 0.0216s/iter; left time: 876.7792s
	iters: 400, epoch: 2 | loss: 0.0254697
	speed: 0.0231s/iter; left time: 933.7050s
Epoch: 2 cost time: 9.568174839019775
Epoch: 2, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.967257 --> -0.974988).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0001158
	speed: 0.0744s/iter; left time: 3004.5145s
	iters: 200, epoch: 3 | loss: 0.0558130
	speed: 0.0221s/iter; left time: 890.1360s
	iters: 300, epoch: 3 | loss: 0.1951486
	speed: 0.0219s/iter; left time: 877.9932s
	iters: 400, epoch: 3 | loss: 0.0030064
	speed: 0.0222s/iter; left time: 890.9383s
Epoch: 3 cost time: 9.583641052246094
Epoch: 3, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.974988 --> -0.980900).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0337840
	speed: 0.0788s/iter; left time: 3150.5459s
	iters: 200, epoch: 4 | loss: 0.0843545
	speed: 0.0231s/iter; left time: 922.1076s
	iters: 300, epoch: 4 | loss: 0.0004609
	speed: 0.0227s/iter; left time: 903.0102s
	iters: 400, epoch: 4 | loss: 0.0002675
	speed: 0.0221s/iter; left time: 877.0225s
Epoch: 4 cost time: 9.732279539108276
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000415
	speed: 0.0785s/iter; left time: 3104.9703s
	iters: 200, epoch: 5 | loss: 0.0000002
	speed: 0.0223s/iter; left time: 881.4718s
	iters: 300, epoch: 5 | loss: 0.0010937
	speed: 0.0235s/iter; left time: 922.7652s
	iters: 400, epoch: 5 | loss: 0.0748026
	speed: 0.0222s/iter; left time: 870.2298s
Epoch: 5 cost time: 9.764012098312378
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0004935
	speed: 0.0793s/iter; left time: 3101.5484s
	iters: 200, epoch: 6 | loss: 0.0427613
	speed: 0.0226s/iter; left time: 882.2576s
	iters: 300, epoch: 6 | loss: 0.1632221
	speed: 0.0222s/iter; left time: 863.4311s
	iters: 400, epoch: 6 | loss: 0.0000880
	speed: 0.0222s/iter; left time: 861.6586s
Epoch: 6 cost time: 9.68868088722229
Epoch: 6, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000155
	speed: 0.0803s/iter; left time: 3109.1914s
	iters: 200, epoch: 7 | loss: 0.4605453
	speed: 0.0213s/iter; left time: 822.0216s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 859.8870s
	iters: 400, epoch: 7 | loss: 0.0000483
	speed: 0.0217s/iter; left time: 834.6843s
Epoch: 7 cost time: 9.462114095687866
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0002761
	speed: 0.0810s/iter; left time: 3102.3501s
	iters: 200, epoch: 8 | loss: 0.0000446
	speed: 0.0223s/iter; left time: 853.1384s
	iters: 300, epoch: 8 | loss: 0.0000140
	speed: 0.0222s/iter; left time: 847.1939s
	iters: 400, epoch: 8 | loss: 0.0000050
	speed: 0.0232s/iter; left time: 881.1531s
Epoch: 8 cost time: 9.712058782577515
Epoch: 8, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.195 Vali Acc: 0.965 Test Loss: 0.195 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0119613
	speed: 0.0733s/iter; left time: 2777.0155s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 835.7545s
	iters: 300, epoch: 9 | loss: 0.0000041
	speed: 0.0227s/iter; left time: 855.0191s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 874.5759s
Epoch: 9 cost time: 9.729389905929565
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.081 Vali Acc: 0.986 Test Loss: 0.081 Test Acc: 0.986
Validation loss decreased (-0.980900 --> -0.985902).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0077700
	speed: 0.0750s/iter; left time: 2811.4463s
	iters: 200, epoch: 10 | loss: 0.0000007
	speed: 0.0225s/iter; left time: 840.8595s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0224s/iter; left time: 835.2870s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0230s/iter; left time: 856.6709s
Epoch: 10 cost time: 9.781889200210571
Epoch: 10, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.218 Vali Acc: 0.976 Test Loss: 0.218 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2835.6462s
	iters: 200, epoch: 11 | loss: 0.0000371
	speed: 0.0237s/iter; left time: 875.2356s
	iters: 300, epoch: 11 | loss: 0.0000003
	speed: 0.0232s/iter; left time: 855.7914s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 809.8094s
Epoch: 11 cost time: 9.930265188217163
Epoch: 11, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.172 Vali Acc: 0.981 Test Loss: 0.172 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 2915.9866s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 792.1626s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 810.1596s
	iters: 400, epoch: 12 | loss: 0.0000085
	speed: 0.0223s/iter; left time: 812.5353s
Epoch: 12 cost time: 9.48598027229309
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.196 Vali Acc: 0.976 Test Loss: 0.196 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000009
	speed: 0.0785s/iter; left time: 2843.7603s
	iters: 200, epoch: 13 | loss: 0.2389774
	speed: 0.0241s/iter; left time: 870.0002s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 810.3707s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 836.4655s
Epoch: 13 cost time: 9.96203899383545
Epoch: 13, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.0837s/iter; left time: 3000.2472s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0218s/iter; left time: 780.1334s
	iters: 300, epoch: 14 | loss: 0.0000062
	speed: 0.0223s/iter; left time: 795.7902s
	iters: 400, epoch: 14 | loss: 0.0066577
	speed: 0.0226s/iter; left time: 803.7442s
Epoch: 14 cost time: 9.649911165237427
Epoch: 14, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.984 Test Loss: 0.114 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000770
	speed: 0.0801s/iter; left time: 2835.8311s
	iters: 200, epoch: 15 | loss: 0.0000390
	speed: 0.0224s/iter; left time: 790.2955s
	iters: 300, epoch: 15 | loss: 0.0000009
	speed: 0.0221s/iter; left time: 777.8847s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 818.1662s
Epoch: 15 cost time: 9.688114404678345
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.131 Vali Acc: 0.985 Test Loss: 0.131 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0435653
	speed: 0.0790s/iter; left time: 2765.3988s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 770.3502s
	iters: 300, epoch: 16 | loss: 0.0000020
	speed: 0.0229s/iter; left time: 795.8598s
	iters: 400, epoch: 16 | loss: 0.0334566
	speed: 0.0234s/iter; left time: 810.6028s
Epoch: 16 cost time: 9.726165294647217
Epoch: 16, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.371 Vali Acc: 0.968 Test Loss: 0.371 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 2884.5575s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0226s/iter; left time: 780.3004s
	iters: 300, epoch: 17 | loss: 0.0000048
	speed: 0.0228s/iter; left time: 785.3524s
	iters: 400, epoch: 17 | loss: 0.0000002
	speed: 0.0228s/iter; left time: 782.9370s
Epoch: 17 cost time: 9.797067165374756
Epoch: 17, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.234 Vali Acc: 0.983 Test Loss: 0.234 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.2702525
	speed: 0.0829s/iter; left time: 2832.0556s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0222s/iter; left time: 757.3659s
	iters: 300, epoch: 18 | loss: 0.0000675
	speed: 0.0217s/iter; left time: 737.2983s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0226s/iter; left time: 767.2614s
Epoch: 18 cost time: 9.491432905197144
Epoch: 18, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.222 Vali Acc: 0.980 Test Loss: 0.222 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0783s/iter; left time: 2644.0733s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 740.2413s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0235s/iter; left time: 787.3247s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0241s/iter; left time: 805.6525s
Epoch: 19 cost time: 9.858099222183228
Epoch: 19, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.254 Vali Acc: 0.977 Test Loss: 0.254 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 520014
model size : 6.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1368864
	speed: 0.0391s/iter; left time: 1611.1407s
	iters: 200, epoch: 1 | loss: 0.0680810
	speed: 0.0228s/iter; left time: 938.6666s
	iters: 300, epoch: 1 | loss: 0.1284002
	speed: 0.0221s/iter; left time: 907.0678s
	iters: 400, epoch: 1 | loss: 0.2364198
	speed: 0.0227s/iter; left time: 929.9554s
Epoch: 1 cost time: 11.072354078292847
Epoch: 1, Steps: 413 | Train Loss: 0.333 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (inf --> -0.968166).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1469840
	speed: 0.0753s/iter; left time: 3073.1277s
	iters: 200, epoch: 2 | loss: 0.0019406
	speed: 0.0225s/iter; left time: 916.8428s
	iters: 300, epoch: 2 | loss: 0.0025871
	speed: 0.0228s/iter; left time: 923.7385s
	iters: 400, epoch: 2 | loss: 0.1567650
	speed: 0.0229s/iter; left time: 927.7483s
Epoch: 2 cost time: 9.894306659698486
Epoch: 2, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.065 Vali Acc: 0.976 Test Loss: 0.065 Test Acc: 0.976
Validation loss decreased (-0.968166 --> -0.976352).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0005567
	speed: 0.0788s/iter; left time: 3181.8023s
	iters: 200, epoch: 3 | loss: 0.0006777
	speed: 0.0220s/iter; left time: 887.5470s
	iters: 300, epoch: 3 | loss: 0.0487461
	speed: 0.0227s/iter; left time: 911.6021s
	iters: 400, epoch: 3 | loss: 0.0007751
	speed: 0.0221s/iter; left time: 887.5634s
Epoch: 3 cost time: 9.502845287322998
Epoch: 3, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
Validation loss decreased (-0.976352 --> -0.982264).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000013
	speed: 0.0820s/iter; left time: 3275.2156s
	iters: 200, epoch: 4 | loss: 0.0282506
	speed: 0.0209s/iter; left time: 833.4940s
	iters: 300, epoch: 4 | loss: 0.0000884
	speed: 0.0217s/iter; left time: 864.1460s
	iters: 400, epoch: 4 | loss: 0.0022641
	speed: 0.0234s/iter; left time: 927.9231s
Epoch: 4 cost time: 9.503429651260376
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0016021
	speed: 0.0817s/iter; left time: 3229.3922s
	iters: 200, epoch: 5 | loss: 0.0000096
	speed: 0.0239s/iter; left time: 942.5162s
	iters: 300, epoch: 5 | loss: 0.0013824
	speed: 0.0218s/iter; left time: 858.2509s
	iters: 400, epoch: 5 | loss: 0.0000803
	speed: 0.0219s/iter; left time: 861.2911s
Epoch: 5 cost time: 9.692954063415527
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000153
	speed: 0.0756s/iter; left time: 2958.7652s
	iters: 200, epoch: 6 | loss: 0.0000183
	speed: 0.0220s/iter; left time: 859.3497s
	iters: 300, epoch: 6 | loss: 0.0000614
	speed: 0.0227s/iter; left time: 884.3892s
	iters: 400, epoch: 6 | loss: 0.0002303
	speed: 0.0229s/iter; left time: 890.0651s
Epoch: 6 cost time: 9.6720712184906
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.289 Vali Acc: 0.956 Test Loss: 0.289 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000393
	speed: 0.0774s/iter; left time: 2997.6426s
	iters: 200, epoch: 7 | loss: 0.0000003
	speed: 0.0216s/iter; left time: 832.8064s
	iters: 300, epoch: 7 | loss: 0.0000024
	speed: 0.0229s/iter; left time: 880.5013s
	iters: 400, epoch: 7 | loss: 0.0310019
	speed: 0.0217s/iter; left time: 835.4508s
Epoch: 7 cost time: 9.684150695800781
Epoch: 7, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.208 Vali Acc: 0.961 Test Loss: 0.208 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000026
	speed: 0.0724s/iter; left time: 2773.6624s
	iters: 200, epoch: 8 | loss: 0.0014055
	speed: 0.0227s/iter; left time: 865.7851s
	iters: 300, epoch: 8 | loss: 0.0989731
	speed: 0.0226s/iter; left time: 861.0877s
	iters: 400, epoch: 8 | loss: 0.0000002
	speed: 0.0225s/iter; left time: 853.3942s
Epoch: 8 cost time: 9.743682861328125
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.228 Vali Acc: 0.968 Test Loss: 0.228 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000082
	speed: 0.0763s/iter; left time: 2890.9081s
	iters: 200, epoch: 9 | loss: 0.0000007
	speed: 0.0207s/iter; left time: 781.0991s
	iters: 300, epoch: 9 | loss: 0.0000615
	speed: 0.0213s/iter; left time: 804.7899s
	iters: 400, epoch: 9 | loss: 0.0000006
	speed: 0.0230s/iter; left time: 866.2567s
Epoch: 9 cost time: 9.599767923355103
Epoch: 9, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.283 Vali Acc: 0.965 Test Loss: 0.283 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0011741
	speed: 0.0740s/iter; left time: 2773.1482s
	iters: 200, epoch: 10 | loss: 0.0000149
	speed: 0.0219s/iter; left time: 818.2994s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 805.3221s
	iters: 400, epoch: 10 | loss: 0.0003271
	speed: 0.0215s/iter; left time: 798.5288s
Epoch: 10 cost time: 9.093544721603394
Epoch: 10, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.510 Vali Acc: 0.955 Test Loss: 0.510 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6172985
	speed: 0.0791s/iter; left time: 2932.2980s
	iters: 200, epoch: 11 | loss: 0.0000265
	speed: 0.0222s/iter; left time: 819.7684s
	iters: 300, epoch: 11 | loss: 0.0000003
	speed: 0.0219s/iter; left time: 808.1490s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 816.0338s
Epoch: 11 cost time: 9.559613943099976
Epoch: 11, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.185 Vali Acc: 0.979 Test Loss: 0.185 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 2653.0782s
	iters: 200, epoch: 12 | loss: 0.0000004
	speed: 0.0228s/iter; left time: 834.8744s
	iters: 300, epoch: 12 | loss: 0.0000075
	speed: 0.0217s/iter; left time: 791.1480s
	iters: 400, epoch: 12 | loss: 1.2359047
	speed: 0.0215s/iter; left time: 780.9512s
Epoch: 12 cost time: 9.478644132614136
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.170 Vali Acc: 0.978 Test Loss: 0.170 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.1209612
	speed: 0.0774s/iter; left time: 2804.7634s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 772.0056s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 783.5015s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 770.1501s
Epoch: 13 cost time: 9.33273720741272
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.230 Vali Acc: 0.969 Test Loss: 0.230 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 520014
model size : 6.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1573161
	speed: 0.0426s/iter; left time: 1754.3582s
	iters: 200, epoch: 1 | loss: 0.0915967
	speed: 0.0225s/iter; left time: 925.9407s
	iters: 300, epoch: 1 | loss: 0.0734780
	speed: 0.0222s/iter; left time: 912.1261s
	iters: 400, epoch: 1 | loss: 0.2062660
	speed: 0.0218s/iter; left time: 893.4796s
Epoch: 1 cost time: 11.257110834121704
Epoch: 1, Steps: 413 | Train Loss: 0.349 Vali Loss: 0.087 Vali Acc: 0.972 Test Loss: 0.087 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1541781
	speed: 0.0807s/iter; left time: 3292.8371s
	iters: 200, epoch: 2 | loss: 0.0027436
	speed: 0.0210s/iter; left time: 854.2706s
	iters: 300, epoch: 2 | loss: 0.0041855
	speed: 0.0217s/iter; left time: 880.5964s
	iters: 400, epoch: 2 | loss: 0.0056281
	speed: 0.0217s/iter; left time: 880.5368s
Epoch: 2 cost time: 9.250935554504395
Epoch: 2, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.086 Vali Acc: 0.972 Test Loss: 0.086 Test Acc: 0.972
Validation loss decreased (-0.972259 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0001906
	speed: 0.0844s/iter; left time: 3407.0991s
	iters: 200, epoch: 3 | loss: 0.0124225
	speed: 0.0220s/iter; left time: 886.3572s
	iters: 300, epoch: 3 | loss: 0.0419245
	speed: 0.0202s/iter; left time: 809.5400s
	iters: 400, epoch: 3 | loss: 0.0006526
	speed: 0.0218s/iter; left time: 873.6928s
Epoch: 3 cost time: 9.38484239578247
Epoch: 3, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.972259 --> -0.980900).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000572
	speed: 0.0766s/iter; left time: 3061.7179s
	iters: 200, epoch: 4 | loss: 0.0004845
	speed: 0.0222s/iter; left time: 885.1001s
	iters: 300, epoch: 4 | loss: 0.0070179
	speed: 0.0216s/iter; left time: 857.5864s
	iters: 400, epoch: 4 | loss: 0.1468358
	speed: 0.0219s/iter; left time: 866.8477s
Epoch: 4 cost time: 9.533982276916504
Epoch: 4, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000412
	speed: 0.0745s/iter; left time: 2946.5399s
	iters: 200, epoch: 5 | loss: 0.0000201
	speed: 0.0222s/iter; left time: 874.4963s
	iters: 300, epoch: 5 | loss: 0.0000001
	speed: 0.0221s/iter; left time: 869.3175s
	iters: 400, epoch: 5 | loss: 0.0006417
	speed: 0.0218s/iter; left time: 856.6837s
Epoch: 5 cost time: 9.534326553344727
Epoch: 5, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.195 Vali Acc: 0.960 Test Loss: 0.195 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0007883
	speed: 0.0748s/iter; left time: 2928.5376s
	iters: 200, epoch: 6 | loss: 0.0000003
	speed: 0.0220s/iter; left time: 858.2846s
	iters: 300, epoch: 6 | loss: 0.0000008
	speed: 0.0222s/iter; left time: 863.3032s
	iters: 400, epoch: 6 | loss: 0.0087295
	speed: 0.0234s/iter; left time: 909.4891s
Epoch: 6 cost time: 9.822661876678467
Epoch: 6, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1467696
	speed: 0.0777s/iter; left time: 3007.9521s
	iters: 200, epoch: 7 | loss: 0.0000024
	speed: 0.0218s/iter; left time: 842.9247s
	iters: 300, epoch: 7 | loss: 0.0000004
	speed: 0.0225s/iter; left time: 867.1066s
	iters: 400, epoch: 7 | loss: 0.5165428
	speed: 0.0207s/iter; left time: 797.2515s
Epoch: 7 cost time: 9.388028860092163
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.0843s/iter; left time: 3229.7437s
	iters: 200, epoch: 8 | loss: 0.0000008
	speed: 0.0227s/iter; left time: 866.2858s
	iters: 300, epoch: 8 | loss: 0.0000146
	speed: 0.0225s/iter; left time: 857.9894s
	iters: 400, epoch: 8 | loss: 0.0001444
	speed: 0.0222s/iter; left time: 841.9453s
Epoch: 8 cost time: 9.798823356628418
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.164 Vali Acc: 0.976 Test Loss: 0.164 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000010
	speed: 0.0847s/iter; left time: 3211.6021s
	iters: 200, epoch: 9 | loss: 0.0000848
	speed: 0.0205s/iter; left time: 775.5123s
	iters: 300, epoch: 9 | loss: 0.0000801
	speed: 0.0208s/iter; left time: 785.0937s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0212s/iter; left time: 795.4991s
Epoch: 9 cost time: 9.215461730957031
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0005352
	speed: 0.0779s/iter; left time: 2920.2760s
	iters: 200, epoch: 10 | loss: 0.0000076
	speed: 0.0201s/iter; left time: 752.9265s
	iters: 300, epoch: 10 | loss: 0.0000003
	speed: 0.0193s/iter; left time: 720.3374s
	iters: 400, epoch: 10 | loss: 0.0000010
	speed: 0.0198s/iter; left time: 737.8787s
Epoch: 10 cost time: 8.781211614608765
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0018960
	speed: 0.0677s/iter; left time: 2509.2289s
	iters: 200, epoch: 11 | loss: 0.0001183
	speed: 0.0220s/iter; left time: 813.3270s
	iters: 300, epoch: 11 | loss: 0.0000051
	speed: 0.0212s/iter; left time: 779.8445s
	iters: 400, epoch: 11 | loss: 0.0000181
	speed: 0.0227s/iter; left time: 836.2752s
Epoch: 11 cost time: 9.180480003356934
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000591
	speed: 0.0763s/iter; left time: 2797.8077s
	iters: 200, epoch: 12 | loss: 0.0000007
	speed: 0.0208s/iter; left time: 760.3963s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 762.7819s
	iters: 400, epoch: 12 | loss: 0.0062163
	speed: 0.0202s/iter; left time: 735.7775s
Epoch: 12 cost time: 9.187918901443481
Epoch: 12, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.207 Vali Acc: 0.976 Test Loss: 0.207 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.0727s/iter; left time: 2636.7276s
	iters: 200, epoch: 13 | loss: 0.0000331
	speed: 0.0219s/iter; left time: 791.9873s
	iters: 300, epoch: 13 | loss: 0.0000361
	speed: 0.0219s/iter; left time: 788.0060s
	iters: 400, epoch: 13 | loss: 0.0000004
	speed: 0.0222s/iter; left time: 799.7306s
Epoch: 13 cost time: 9.448893070220947
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 520014
model size : 6.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3234123
	speed: 0.0355s/iter; left time: 1460.9153s
	iters: 200, epoch: 1 | loss: 0.1524579
	speed: 0.0201s/iter; left time: 825.7503s
	iters: 300, epoch: 1 | loss: 0.0365018
	speed: 0.0200s/iter; left time: 819.9633s
	iters: 400, epoch: 1 | loss: 0.1660914
	speed: 0.0198s/iter; left time: 807.8784s
Epoch: 1 cost time: 9.845075607299805
Epoch: 1, Steps: 413 | Train Loss: 0.401 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (inf --> -0.977262).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1820594
	speed: 0.0699s/iter; left time: 2850.6273s
	iters: 200, epoch: 2 | loss: 0.0027382
	speed: 0.0201s/iter; left time: 818.6257s
	iters: 300, epoch: 2 | loss: 0.0074248
	speed: 0.0198s/iter; left time: 803.4304s
	iters: 400, epoch: 2 | loss: 0.0061684
	speed: 0.0198s/iter; left time: 802.2855s
Epoch: 2 cost time: 8.535866022109985
Epoch: 2, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0004000
	speed: 0.0708s/iter; left time: 2859.8424s
	iters: 200, epoch: 3 | loss: 0.0505770
	speed: 0.0189s/iter; left time: 759.9271s
	iters: 300, epoch: 3 | loss: 0.0266144
	speed: 0.0204s/iter; left time: 818.6147s
	iters: 400, epoch: 3 | loss: 0.0581964
	speed: 0.0206s/iter; left time: 826.1558s
Epoch: 3 cost time: 8.554591655731201
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.085 Vali Acc: 0.971 Test Loss: 0.085 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000306
	speed: 0.0712s/iter; left time: 2843.4221s
	iters: 200, epoch: 4 | loss: 0.0020793
	speed: 0.0219s/iter; left time: 873.9469s
	iters: 300, epoch: 4 | loss: 0.0004308
	speed: 0.0206s/iter; left time: 819.9773s
	iters: 400, epoch: 4 | loss: 0.0000676
	speed: 0.0200s/iter; left time: 794.0084s
Epoch: 4 cost time: 8.929964303970337
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0002364
	speed: 0.0756s/iter; left time: 2988.0527s
	iters: 200, epoch: 5 | loss: 0.0000359
	speed: 0.0212s/iter; left time: 835.5458s
	iters: 300, epoch: 5 | loss: 0.0005378
	speed: 0.0211s/iter; left time: 831.1960s
	iters: 400, epoch: 5 | loss: 0.0012530
	speed: 0.0219s/iter; left time: 859.8128s
Epoch: 5 cost time: 9.151090860366821
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.1089494
	speed: 0.0744s/iter; left time: 2912.7885s
	iters: 200, epoch: 6 | loss: 0.0287204
	speed: 0.0214s/iter; left time: 835.5581s
	iters: 300, epoch: 6 | loss: 0.0004008
	speed: 0.0209s/iter; left time: 811.9557s
	iters: 400, epoch: 6 | loss: 0.1322634
	speed: 0.0222s/iter; left time: 862.3575s
Epoch: 6 cost time: 9.189472913742065
Epoch: 6, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0004697
	speed: 0.0768s/iter; left time: 2975.1110s
	iters: 200, epoch: 7 | loss: 0.0000117
	speed: 0.0220s/iter; left time: 847.9188s
	iters: 300, epoch: 7 | loss: 0.0473707
	speed: 0.0211s/iter; left time: 811.6375s
	iters: 400, epoch: 7 | loss: 0.0010719
	speed: 0.0222s/iter; left time: 851.4582s
Epoch: 7 cost time: 9.281765699386597
Epoch: 7, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.184 Vali Acc: 0.973 Test Loss: 0.184 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000055
	speed: 0.0819s/iter; left time: 3136.1768s
	iters: 200, epoch: 8 | loss: 0.0000332
	speed: 0.0221s/iter; left time: 843.5415s
	iters: 300, epoch: 8 | loss: 0.0000028
	speed: 0.0226s/iter; left time: 860.0507s
	iters: 400, epoch: 8 | loss: 0.0006220
	speed: 0.0211s/iter; left time: 803.5936s
Epoch: 8 cost time: 9.467071294784546
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0039689
	speed: 0.0779s/iter; left time: 2951.4556s
	iters: 200, epoch: 9 | loss: 0.0000862
	speed: 0.0220s/iter; left time: 832.7038s
	iters: 300, epoch: 9 | loss: 0.0000140
	speed: 0.0203s/iter; left time: 763.6985s
	iters: 400, epoch: 9 | loss: 0.0000020
	speed: 0.0214s/iter; left time: 804.7673s
Epoch: 9 cost time: 9.174246549606323
Epoch: 9, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.213 Vali Acc: 0.962 Test Loss: 0.213 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 2689.8029s
	iters: 200, epoch: 10 | loss: 0.0000393
	speed: 0.0208s/iter; left time: 776.1872s
	iters: 300, epoch: 10 | loss: 0.0000728
	speed: 0.0216s/iter; left time: 805.4084s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0205s/iter; left time: 761.2362s
Epoch: 10 cost time: 8.960882902145386
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 2575.9587s
	iters: 200, epoch: 11 | loss: 0.0003967
	speed: 0.0218s/iter; left time: 805.4193s
	iters: 300, epoch: 11 | loss: 0.0005703
	speed: 0.0208s/iter; left time: 766.4248s
	iters: 400, epoch: 11 | loss: 0.0079424
	speed: 0.0209s/iter; left time: 768.8688s
Epoch: 11 cost time: 9.121470212936401
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.985 Test Loss: 0.123 Test Acc: 0.985
Validation loss decreased (-0.977262 --> -0.985447).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6037509
	speed: 0.0712s/iter; left time: 2611.7698s
	iters: 200, epoch: 12 | loss: 0.0001015
	speed: 0.0216s/iter; left time: 788.7858s
	iters: 300, epoch: 12 | loss: 0.6657756
	speed: 0.0209s/iter; left time: 762.7566s
	iters: 400, epoch: 12 | loss: 0.0123556
	speed: 0.0213s/iter; left time: 773.3979s
Epoch: 12 cost time: 9.162651062011719
Epoch: 12, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.275 Vali Acc: 0.965 Test Loss: 0.275 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0012357
	speed: 0.0723s/iter; left time: 2619.9383s
	iters: 200, epoch: 13 | loss: 0.2216564
	speed: 0.0218s/iter; left time: 786.1636s
	iters: 300, epoch: 13 | loss: 0.0000009
	speed: 0.0206s/iter; left time: 742.4888s
	iters: 400, epoch: 13 | loss: 0.0000155
	speed: 0.0212s/iter; left time: 761.1653s
Epoch: 13 cost time: 9.166047096252441
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0009555
	speed: 0.0775s/iter; left time: 2777.3057s
	iters: 200, epoch: 14 | loss: 0.0007518
	speed: 0.0215s/iter; left time: 769.0096s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0203s/iter; left time: 722.2816s
	iters: 400, epoch: 14 | loss: 0.0368525
	speed: 0.0206s/iter; left time: 732.9377s
Epoch: 14 cost time: 8.99089002609253
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.162 Vali Acc: 0.981 Test Loss: 0.162 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0010339
	speed: 0.0759s/iter; left time: 2687.7816s
	iters: 200, epoch: 15 | loss: 0.0001778
	speed: 0.0196s/iter; left time: 693.0629s
	iters: 300, epoch: 15 | loss: 0.5574526
	speed: 0.0212s/iter; left time: 746.5496s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 738.6352s
Epoch: 15 cost time: 8.876379251480103
Epoch: 15, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.985 Test Loss: 0.110 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 2569.0806s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 718.2419s
	iters: 300, epoch: 16 | loss: 0.0105356
	speed: 0.0211s/iter; left time: 732.8199s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0199s/iter; left time: 688.9551s
Epoch: 16 cost time: 8.835938930511475
Epoch: 16, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.984 Test Loss: 0.127 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0057150
	speed: 0.0715s/iter; left time: 2472.3620s
	iters: 200, epoch: 17 | loss: 0.0000018
	speed: 0.0211s/iter; left time: 729.4719s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0202s/iter; left time: 695.1973s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 759.2602s
Epoch: 17 cost time: 9.184929609298706
Epoch: 17, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.157 Vali Acc: 0.979 Test Loss: 0.157 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.1118318
	speed: 0.0716s/iter; left time: 2448.0228s
	iters: 200, epoch: 18 | loss: 0.0000004
	speed: 0.0206s/iter; left time: 700.7174s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0198s/iter; left time: 673.9632s
	iters: 400, epoch: 18 | loss: 0.0033193
	speed: 0.0219s/iter; left time: 741.9388s
Epoch: 18 cost time: 8.907265901565552
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.208 Vali Acc: 0.976 Test Loss: 0.208 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0707s/iter; left time: 2388.3711s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 715.1804s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 715.3761s
	iters: 400, epoch: 19 | loss: 0.0000197
	speed: 0.0212s/iter; left time: 707.9524s
Epoch: 19 cost time: 9.073044300079346
Epoch: 19, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.299 Vali Acc: 0.970 Test Loss: 0.299 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000467
	speed: 0.0683s/iter; left time: 2279.7283s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 688.7051s
	iters: 300, epoch: 20 | loss: 0.9906908
	speed: 0.0206s/iter; left time: 682.0564s
	iters: 400, epoch: 20 | loss: 0.1524521
	speed: 0.0192s/iter; left time: 634.8549s
Epoch: 20 cost time: 8.704885482788086
Epoch: 20, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.267 Vali Acc: 0.977 Test Loss: 0.267 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0500250
	speed: 0.0715s/iter; left time: 2354.4062s
	iters: 200, epoch: 21 | loss: 0.0003011
	speed: 0.0205s/iter; left time: 671.7449s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0197s/iter; left time: 646.6304s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 675.6568s
Epoch: 21 cost time: 8.755370855331421
Epoch: 21, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.165 Vali Acc: 0.984 Test Loss: 0.165 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 520014
model size : 6.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1565834
	speed: 0.0355s/iter; left time: 1464.3524s
	iters: 200, epoch: 1 | loss: 0.1197362
	speed: 0.0208s/iter; left time: 853.1334s
	iters: 300, epoch: 1 | loss: 0.3237118
	speed: 0.0211s/iter; left time: 863.8199s
	iters: 400, epoch: 1 | loss: 0.0022472
	speed: 0.0209s/iter; left time: 854.6609s
Epoch: 1 cost time: 10.175582885742188
Epoch: 1, Steps: 413 | Train Loss: 0.322 Vali Loss: 0.063 Vali Acc: 0.977 Test Loss: 0.063 Test Acc: 0.977
Validation loss decreased (inf --> -0.977262).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0191213
	speed: 0.0728s/iter; left time: 2969.4668s
	iters: 200, epoch: 2 | loss: 0.0045677
	speed: 0.0216s/iter; left time: 880.6927s
	iters: 300, epoch: 2 | loss: 0.1534100
	speed: 0.0218s/iter; left time: 886.7946s
	iters: 400, epoch: 2 | loss: 0.0037050
	speed: 0.0226s/iter; left time: 914.7380s
Epoch: 2 cost time: 9.326643466949463
Epoch: 2, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0045797
	speed: 0.0771s/iter; left time: 3114.7266s
	iters: 200, epoch: 3 | loss: 0.0103862
	speed: 0.0219s/iter; left time: 882.7311s
	iters: 300, epoch: 3 | loss: 0.0023522
	speed: 0.0222s/iter; left time: 892.7876s
	iters: 400, epoch: 3 | loss: 0.0471613
	speed: 0.0206s/iter; left time: 826.0481s
Epoch: 3 cost time: 9.424749374389648
Epoch: 3, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0011408
	speed: 0.0777s/iter; left time: 3105.8980s
	iters: 200, epoch: 4 | loss: 0.1041151
	speed: 0.0214s/iter; left time: 853.8563s
	iters: 300, epoch: 4 | loss: 0.0017210
	speed: 0.0210s/iter; left time: 834.9807s
	iters: 400, epoch: 4 | loss: 0.0019629
	speed: 0.0212s/iter; left time: 840.2073s
Epoch: 4 cost time: 9.27735686302185
Epoch: 4, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0004501
	speed: 0.0807s/iter; left time: 3192.8356s
	iters: 200, epoch: 5 | loss: 1.1522659
	speed: 0.0211s/iter; left time: 834.0909s
	iters: 300, epoch: 5 | loss: 0.0000085
	speed: 0.0203s/iter; left time: 798.3301s
	iters: 400, epoch: 5 | loss: 0.0002052
	speed: 0.0212s/iter; left time: 833.8952s
Epoch: 5 cost time: 9.106717109680176
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
Validation loss decreased (-0.977262 --> -0.983628).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0001443
	speed: 0.0805s/iter; left time: 3148.7968s
	iters: 200, epoch: 6 | loss: 0.3966511
	speed: 0.0217s/iter; left time: 847.4284s
	iters: 300, epoch: 6 | loss: 0.0008761
	speed: 0.0203s/iter; left time: 790.3153s
	iters: 400, epoch: 6 | loss: 0.0000021
	speed: 0.0204s/iter; left time: 791.8403s
Epoch: 6 cost time: 9.055550813674927
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0011783
	speed: 0.0778s/iter; left time: 3014.4957s
	iters: 200, epoch: 7 | loss: 0.0009062
	speed: 0.0188s/iter; left time: 725.9387s
	iters: 300, epoch: 7 | loss: 0.0000004
	speed: 0.0216s/iter; left time: 832.0378s
	iters: 400, epoch: 7 | loss: 0.0014844
	speed: 0.0226s/iter; left time: 868.2588s
Epoch: 7 cost time: 9.115313291549683
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.985 Test Loss: 0.106 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.984537).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000013
	speed: 0.0758s/iter; left time: 2905.7518s
	iters: 200, epoch: 8 | loss: 0.0006883
	speed: 0.0222s/iter; left time: 848.6075s
	iters: 300, epoch: 8 | loss: 0.0000005
	speed: 0.0228s/iter; left time: 870.0777s
	iters: 400, epoch: 8 | loss: 0.0001430
	speed: 0.0215s/iter; left time: 816.1215s
Epoch: 8 cost time: 9.563124656677246
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.423 Vali Acc: 0.954 Test Loss: 0.423 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000003
	speed: 0.0763s/iter; left time: 2892.8512s
	iters: 200, epoch: 9 | loss: 0.0000002
	speed: 0.0214s/iter; left time: 810.6400s
	iters: 300, epoch: 9 | loss: 0.3629647
	speed: 0.0222s/iter; left time: 835.1018s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0231s/iter; left time: 867.5011s
Epoch: 9 cost time: 9.655816555023193
Epoch: 9, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.239 Vali Acc: 0.966 Test Loss: 0.239 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.0770s/iter; left time: 2888.0324s
	iters: 200, epoch: 10 | loss: 0.0931390
	speed: 0.0224s/iter; left time: 839.1274s
	iters: 300, epoch: 10 | loss: 0.1617788
	speed: 0.0220s/iter; left time: 819.8142s
	iters: 400, epoch: 10 | loss: 0.0000539
	speed: 0.0224s/iter; left time: 831.7823s
Epoch: 10 cost time: 9.595717430114746
Epoch: 10, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.236 Vali Acc: 0.972 Test Loss: 0.236 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.0745s/iter; left time: 2762.6369s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.0207s/iter; left time: 767.0975s
	iters: 300, epoch: 11 | loss: 0.0210271
	speed: 0.0206s/iter; left time: 761.1094s
	iters: 400, epoch: 11 | loss: 1.5432695
	speed: 0.0213s/iter; left time: 783.8246s
Epoch: 11 cost time: 9.265060424804688
Epoch: 11, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.188 Vali Acc: 0.978 Test Loss: 0.188 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 3002.0572s
	iters: 200, epoch: 12 | loss: 0.0000073
	speed: 0.0212s/iter; left time: 773.6311s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 747.6319s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 805.8772s
Epoch: 12 cost time: 9.248298406600952
Epoch: 12, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.203 Vali Acc: 0.980 Test Loss: 0.203 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 3024.1403s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 748.6187s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 742.9745s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0192s/iter; left time: 691.6755s
Epoch: 13 cost time: 8.872891664505005
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.193 Vali Acc: 0.979 Test Loss: 0.193 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1060976
	speed: 0.0733s/iter; left time: 2626.6584s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 744.4925s
	iters: 300, epoch: 14 | loss: 0.0000018
	speed: 0.0212s/iter; left time: 755.2449s
	iters: 400, epoch: 14 | loss: 0.0000012
	speed: 0.0204s/iter; left time: 726.5304s
Epoch: 14 cost time: 9.0084707736969
Epoch: 14, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.185 Vali Acc: 0.981 Test Loss: 0.185 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0124134
	speed: 0.0727s/iter; left time: 2573.5114s
	iters: 200, epoch: 15 | loss: 0.1940259
	speed: 0.0213s/iter; left time: 750.6274s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 733.9763s
	iters: 400, epoch: 15 | loss: 0.0000573
	speed: 0.0211s/iter; left time: 742.2013s
Epoch: 15 cost time: 9.004036664962769
Epoch: 15, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.324 Vali Acc: 0.970 Test Loss: 0.324 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000372
	speed: 0.0733s/iter; left time: 2565.1795s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0200s/iter; left time: 697.6529s
	iters: 300, epoch: 16 | loss: 0.0000112
	speed: 0.0201s/iter; left time: 699.5727s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0201s/iter; left time: 698.6725s
Epoch: 16 cost time: 8.754511833190918
Epoch: 16, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.275 Vali Acc: 0.975 Test Loss: 0.275 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 2526.2013s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 738.2136s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 727.1909s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 706.5011s
Epoch: 17 cost time: 9.165940046310425
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.171 Vali Acc: 0.984 Test Loss: 0.171 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 454478
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1781938
	speed: 0.0404s/iter; left time: 1663.0125s
	iters: 200, epoch: 1 | loss: 0.1229289
	speed: 0.0211s/iter; left time: 865.9253s
	iters: 300, epoch: 1 | loss: 0.3444339
	speed: 0.0206s/iter; left time: 845.8445s
	iters: 400, epoch: 1 | loss: 0.0036826
	speed: 0.0223s/iter; left time: 912.5351s
Epoch: 1 cost time: 10.765422821044922
Epoch: 1, Steps: 413 | Train Loss: 0.328 Vali Loss: 0.054 Vali Acc: 0.980 Test Loss: 0.054 Test Acc: 0.980
Validation loss decreased (inf --> -0.979990).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0020795
	speed: 0.0732s/iter; left time: 2985.6982s
	iters: 200, epoch: 2 | loss: 0.0034831
	speed: 0.0218s/iter; left time: 885.7995s
	iters: 300, epoch: 2 | loss: 0.1898940
	speed: 0.0223s/iter; left time: 907.0765s
	iters: 400, epoch: 2 | loss: 0.0008994
	speed: 0.0225s/iter; left time: 909.6526s
Epoch: 2 cost time: 9.498789072036743
Epoch: 2, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.058 Vali Acc: 0.979 Test Loss: 0.058 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2191800
	speed: 0.0738s/iter; left time: 2980.2643s
	iters: 200, epoch: 3 | loss: 0.1665900
	speed: 0.0222s/iter; left time: 895.7479s
	iters: 300, epoch: 3 | loss: 0.0015058
	speed: 0.0227s/iter; left time: 910.4731s
	iters: 400, epoch: 3 | loss: 0.0413313
	speed: 0.0237s/iter; left time: 949.7480s
Epoch: 3 cost time: 9.669685125350952
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0070908
	speed: 0.0782s/iter; left time: 3124.2421s
	iters: 200, epoch: 4 | loss: 0.0000295
	speed: 0.0220s/iter; left time: 878.9000s
	iters: 300, epoch: 4 | loss: 0.0028556
	speed: 0.0217s/iter; left time: 863.4452s
	iters: 400, epoch: 4 | loss: 0.0016997
	speed: 0.0227s/iter; left time: 899.2240s
Epoch: 4 cost time: 9.540238380432129
Epoch: 4, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.979990 --> -0.981354).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000315
	speed: 0.0746s/iter; left time: 2949.3422s
	iters: 200, epoch: 5 | loss: 0.0001179
	speed: 0.0216s/iter; left time: 853.2791s
	iters: 300, epoch: 5 | loss: 0.0001005
	speed: 0.0210s/iter; left time: 827.6468s
	iters: 400, epoch: 5 | loss: 0.0570144
	speed: 0.0219s/iter; left time: 858.6083s
Epoch: 5 cost time: 9.247026205062866
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000208
	speed: 0.0795s/iter; left time: 3110.8156s
	iters: 200, epoch: 6 | loss: 0.0000159
	speed: 0.0222s/iter; left time: 867.8258s
	iters: 300, epoch: 6 | loss: 0.0006260
	speed: 0.0223s/iter; left time: 867.3823s
	iters: 400, epoch: 6 | loss: 0.0000004
	speed: 0.0220s/iter; left time: 853.7102s
Epoch: 6 cost time: 9.538485288619995
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000116
	speed: 0.0841s/iter; left time: 3255.3106s
	iters: 200, epoch: 7 | loss: 0.0087984
	speed: 0.0211s/iter; left time: 813.6958s
	iters: 300, epoch: 7 | loss: 0.0000101
	speed: 0.0227s/iter; left time: 872.5851s
	iters: 400, epoch: 7 | loss: 0.0562323
	speed: 0.0223s/iter; left time: 858.6437s
Epoch: 7 cost time: 9.618372201919556
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.0764s/iter; left time: 2926.8991s
	iters: 200, epoch: 8 | loss: 0.0000876
	speed: 0.0216s/iter; left time: 823.4602s
	iters: 300, epoch: 8 | loss: 0.0000224
	speed: 0.0225s/iter; left time: 855.9109s
	iters: 400, epoch: 8 | loss: 0.0001450
	speed: 0.0235s/iter; left time: 893.1612s
Epoch: 8 cost time: 9.466422319412231
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.0746s/iter; left time: 2827.1951s
	iters: 200, epoch: 9 | loss: 0.0234440
	speed: 0.0237s/iter; left time: 896.1060s
	iters: 300, epoch: 9 | loss: 0.7123924
	speed: 0.0220s/iter; left time: 830.1802s
	iters: 400, epoch: 9 | loss: 0.0000074
	speed: 0.0216s/iter; left time: 811.8060s
Epoch: 9 cost time: 9.635667562484741
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.0740s/iter; left time: 2774.1141s
	iters: 200, epoch: 10 | loss: 0.0482357
	speed: 0.0221s/iter; left time: 824.3637s
	iters: 300, epoch: 10 | loss: 0.0000210
	speed: 0.0216s/iter; left time: 804.5523s
	iters: 400, epoch: 10 | loss: 0.0000363
	speed: 0.0231s/iter; left time: 858.8834s
Epoch: 10 cost time: 9.556143760681152
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000014
	speed: 0.0750s/iter; left time: 2779.1087s
	iters: 200, epoch: 11 | loss: 0.0105230
	speed: 0.0212s/iter; left time: 784.4953s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0218s/iter; left time: 802.8944s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 819.7890s
Epoch: 11 cost time: 9.351642370223999
Epoch: 11, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.268 Vali Acc: 0.964 Test Loss: 0.268 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 2688.9108s
	iters: 200, epoch: 12 | loss: 0.0000041
	speed: 0.0217s/iter; left time: 791.8349s
	iters: 300, epoch: 12 | loss: 0.2514018
	speed: 0.0214s/iter; left time: 780.9509s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 781.5963s
Epoch: 12 cost time: 9.219702005386353
Epoch: 12, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.209 Vali Acc: 0.977 Test Loss: 0.209 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0831s/iter; left time: 3013.4030s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 789.1740s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 781.2511s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 808.9057s
Epoch: 13 cost time: 9.588851690292358
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.147 Vali Acc: 0.980 Test Loss: 0.147 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000008
	speed: 0.0862s/iter; left time: 3089.9705s
	iters: 200, epoch: 14 | loss: 0.8850726
	speed: 0.0217s/iter; left time: 775.3768s
	iters: 300, epoch: 14 | loss: 0.0000775
	speed: 0.0219s/iter; left time: 780.0910s
	iters: 400, epoch: 14 | loss: 0.0000700
	speed: 0.0224s/iter; left time: 796.1178s
Epoch: 14 cost time: 9.691558122634888
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.264 Vali Acc: 0.972 Test Loss: 0.264 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 454478
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2238391
	speed: 0.0387s/iter; left time: 1593.1315s
	iters: 200, epoch: 1 | loss: 0.1200312
	speed: 0.0210s/iter; left time: 863.7858s
	iters: 300, epoch: 1 | loss: 0.3818106
	speed: 0.0215s/iter; left time: 881.4818s
	iters: 400, epoch: 1 | loss: 0.0046544
	speed: 0.0212s/iter; left time: 867.6230s
Epoch: 1 cost time: 10.57934284210205
Epoch: 1, Steps: 413 | Train Loss: 0.343 Vali Loss: 0.061 Vali Acc: 0.977 Test Loss: 0.061 Test Acc: 0.977
Validation loss decreased (inf --> -0.976807).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0018972
	speed: 0.0736s/iter; left time: 3000.1542s
	iters: 200, epoch: 2 | loss: 0.0019241
	speed: 0.0209s/iter; left time: 849.4298s
	iters: 300, epoch: 2 | loss: 0.0882910
	speed: 0.0205s/iter; left time: 831.5810s
	iters: 400, epoch: 2 | loss: 0.0044805
	speed: 0.0207s/iter; left time: 836.5498s
Epoch: 2 cost time: 8.970947265625
Epoch: 2, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.065 Vali Acc: 0.976 Test Loss: 0.065 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0840586
	speed: 0.0712s/iter; left time: 2874.3844s
	iters: 200, epoch: 3 | loss: 0.0001127
	speed: 0.0210s/iter; left time: 846.8066s
	iters: 300, epoch: 3 | loss: 0.0001677
	speed: 0.0216s/iter; left time: 868.5768s
	iters: 400, epoch: 3 | loss: 0.0013603
	speed: 0.0208s/iter; left time: 832.4765s
Epoch: 3 cost time: 9.083012104034424
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.976807 --> -0.980445).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0566274
	speed: 0.0763s/iter; left time: 3050.1657s
	iters: 200, epoch: 4 | loss: 0.0225286
	speed: 0.0197s/iter; left time: 784.4597s
	iters: 300, epoch: 4 | loss: 0.0360846
	speed: 0.0201s/iter; left time: 797.5624s
	iters: 400, epoch: 4 | loss: 0.0009992
	speed: 0.0204s/iter; left time: 809.7596s
Epoch: 4 cost time: 8.737462520599365
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0376416
	speed: 0.0749s/iter; left time: 2963.8712s
	iters: 200, epoch: 5 | loss: 0.0094792
	speed: 0.0201s/iter; left time: 792.6378s
	iters: 300, epoch: 5 | loss: 0.0000096
	speed: 0.0210s/iter; left time: 827.8291s
	iters: 400, epoch: 5 | loss: 0.0019433
	speed: 0.0203s/iter; left time: 798.0223s
Epoch: 5 cost time: 8.871066331863403
Epoch: 5, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.980899).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000379
	speed: 0.0734s/iter; left time: 2872.7400s
	iters: 200, epoch: 6 | loss: 0.0000042
	speed: 0.0226s/iter; left time: 883.5843s
	iters: 300, epoch: 6 | loss: 0.0000104
	speed: 0.0216s/iter; left time: 839.5239s
	iters: 400, epoch: 6 | loss: 0.0000042
	speed: 0.0217s/iter; left time: 841.6950s
Epoch: 6 cost time: 9.541937351226807
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000031
	speed: 0.0739s/iter; left time: 2861.6400s
	iters: 200, epoch: 7 | loss: 0.0000334
	speed: 0.0202s/iter; left time: 781.8644s
	iters: 300, epoch: 7 | loss: 0.0000433
	speed: 0.0213s/iter; left time: 821.0693s
	iters: 400, epoch: 7 | loss: 0.0646902
	speed: 0.0212s/iter; left time: 815.4420s
Epoch: 7 cost time: 9.053732872009277
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.096 Vali Acc: 0.984 Test Loss: 0.096 Test Acc: 0.984
Validation loss decreased (-0.980899 --> -0.983628).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000045
	speed: 0.0764s/iter; left time: 2928.3053s
	iters: 200, epoch: 8 | loss: 0.0000689
	speed: 0.0213s/iter; left time: 814.6642s
	iters: 300, epoch: 8 | loss: 0.0002020
	speed: 0.0216s/iter; left time: 822.5735s
	iters: 400, epoch: 8 | loss: 0.0000002
	speed: 0.0217s/iter; left time: 823.3196s
Epoch: 8 cost time: 9.34341025352478
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.971 Test Loss: 0.200 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000095
	speed: 0.0746s/iter; left time: 2828.6492s
	iters: 200, epoch: 9 | loss: 0.1462405
	speed: 0.0205s/iter; left time: 775.5907s
	iters: 300, epoch: 9 | loss: 0.0001969
	speed: 0.0201s/iter; left time: 758.3105s
	iters: 400, epoch: 9 | loss: 0.2565951
	speed: 0.0229s/iter; left time: 859.9526s
Epoch: 9 cost time: 9.138375520706177
Epoch: 9, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0001436
	speed: 0.0765s/iter; left time: 2868.4244s
	iters: 200, epoch: 10 | loss: 0.0106689
	speed: 0.0208s/iter; left time: 778.8584s
	iters: 300, epoch: 10 | loss: 0.0491826
	speed: 0.0196s/iter; left time: 731.2567s
	iters: 400, epoch: 10 | loss: 0.0000075
	speed: 0.0199s/iter; left time: 741.4670s
Epoch: 10 cost time: 8.764311075210571
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.237 Vali Acc: 0.977 Test Loss: 0.237 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000601
	speed: 0.0794s/iter; left time: 2943.8971s
	iters: 200, epoch: 11 | loss: 0.0000219
	speed: 0.0211s/iter; left time: 778.5852s
	iters: 300, epoch: 11 | loss: 0.0000014
	speed: 0.0216s/iter; left time: 794.7484s
	iters: 400, epoch: 11 | loss: 0.0000039
	speed: 0.0229s/iter; left time: 840.5417s
Epoch: 11 cost time: 9.447256326675415
Epoch: 11, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0818s/iter; left time: 2999.8961s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0210s/iter; left time: 769.2933s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 783.0732s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0224s/iter; left time: 812.6189s
Epoch: 12 cost time: 9.322786331176758
Epoch: 12, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.109 Vali Acc: 0.985 Test Loss: 0.109 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.985447).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000218
	speed: 0.0700s/iter; left time: 2537.5883s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0207s/iter; left time: 748.1219s
	iters: 300, epoch: 13 | loss: 0.0000007
	speed: 0.0218s/iter; left time: 784.0709s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 746.3555s
Epoch: 13 cost time: 9.038170576095581
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.272 Vali Acc: 0.971 Test Loss: 0.272 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000008
	speed: 0.0711s/iter; left time: 2545.9566s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 785.4783s
	iters: 300, epoch: 14 | loss: 0.0001795
	speed: 0.0221s/iter; left time: 786.7274s
	iters: 400, epoch: 14 | loss: 0.0000040
	speed: 0.0223s/iter; left time: 791.5939s
Epoch: 14 cost time: 9.37598729133606
Epoch: 14, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.411 Vali Acc: 0.962 Test Loss: 0.411 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000054
	speed: 0.0730s/iter; left time: 2585.1104s
	iters: 200, epoch: 15 | loss: 0.0029796
	speed: 0.0203s/iter; left time: 717.0616s
	iters: 300, epoch: 15 | loss: 0.0000002
	speed: 0.0213s/iter; left time: 751.1200s
	iters: 400, epoch: 15 | loss: 0.0000006
	speed: 0.0211s/iter; left time: 740.1161s
Epoch: 15 cost time: 9.006817817687988
Epoch: 15, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000013
	speed: 0.0723s/iter; left time: 2530.1730s
	iters: 200, epoch: 16 | loss: 0.0006053
	speed: 0.0220s/iter; left time: 766.2906s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 729.9210s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0216s/iter; left time: 751.0721s
Epoch: 16 cost time: 9.12061595916748
Epoch: 16, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.280 Vali Acc: 0.981 Test Loss: 0.280 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 2827.3812s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 719.5360s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 752.4076s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 762.0439s
Epoch: 17 cost time: 9.303959131240845
Epoch: 17, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.315 Vali Acc: 0.978 Test Loss: 0.315 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0844s/iter; left time: 2885.4369s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 746.4267s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0215s/iter; left time: 729.4194s
	iters: 400, epoch: 18 | loss: 0.0000099
	speed: 0.0215s/iter; left time: 728.4553s
Epoch: 18 cost time: 9.365802764892578
Epoch: 18, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.094 Vali Acc: 0.989 Test Loss: 0.094 Test Acc: 0.989
Validation loss decreased (-0.985447 --> -0.988630).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.2856706
	speed: 0.0755s/iter; left time: 2550.5675s
	iters: 200, epoch: 19 | loss: 0.0001212
	speed: 0.0206s/iter; left time: 694.1729s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 702.0355s
	iters: 400, epoch: 19 | loss: 0.7239869
	speed: 0.0209s/iter; left time: 700.2371s
Epoch: 19 cost time: 9.027257204055786
Epoch: 19, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.158 Vali Acc: 0.981 Test Loss: 0.158 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0757s/iter; left time: 2526.3067s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0201s/iter; left time: 669.2945s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 695.1144s
	iters: 400, epoch: 20 | loss: 0.0000006
	speed: 0.0217s/iter; left time: 717.9801s
Epoch: 20 cost time: 9.001671075820923
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.194 Vali Acc: 0.980 Test Loss: 0.194 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0743s/iter; left time: 2449.0791s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 699.7697s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 724.1330s
	iters: 400, epoch: 21 | loss: 0.0380507
	speed: 0.0210s/iter; left time: 685.2088s
Epoch: 21 cost time: 9.190141916275024
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.162 Vali Acc: 0.980 Test Loss: 0.162 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 2338.0017s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0202s/iter; left time: 656.5363s
	iters: 300, epoch: 22 | loss: 0.0666954
	speed: 0.0214s/iter; left time: 691.3230s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 706.9117s
Epoch: 22 cost time: 9.179226160049438
Epoch: 22, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.341 Vali Acc: 0.974 Test Loss: 0.341 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000006
	speed: 0.0713s/iter; left time: 2288.6621s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0198s/iter; left time: 634.0064s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0200s/iter; left time: 639.7558s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0195s/iter; left time: 619.3055s
Epoch: 23 cost time: 8.608200073242188
Epoch: 23, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.198 Vali Acc: 0.977 Test Loss: 0.198 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 2487.8115s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 652.6490s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 671.5014s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 643.8520s
Epoch: 24 cost time: 9.034321546554565
Epoch: 24, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.0714s/iter; left time: 2235.0383s
	iters: 200, epoch: 25 | loss: 0.0000193
	speed: 0.0208s/iter; left time: 647.8864s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 642.5934s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0201s/iter; left time: 622.4650s
Epoch: 25 cost time: 8.83477783203125
Epoch: 25, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.442 Vali Acc: 0.975 Test Loss: 0.442 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0683s/iter; left time: 2109.2735s
	iters: 200, epoch: 26 | loss: 0.0002483
	speed: 0.0209s/iter; left time: 642.5204s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0194s/iter; left time: 596.0115s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 625.5452s
Epoch: 26 cost time: 8.772324085235596
Epoch: 26, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.293 Vali Acc: 0.981 Test Loss: 0.293 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0744s/iter; left time: 2267.9518s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 653.2218s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0201s/iter; left time: 609.0360s
	iters: 400, epoch: 27 | loss: 0.4103244
	speed: 0.0225s/iter; left time: 677.6893s
Epoch: 27 cost time: 9.246166229248047
Epoch: 27, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.699 Vali Acc: 0.957 Test Loss: 0.699 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 2133.4361s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 644.1836s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 633.8567s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 631.1976s
Epoch: 28 cost time: 9.124754667282104
Epoch: 28, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.372 Vali Acc: 0.979 Test Loss: 0.372 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 454478
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4147888
	speed: 0.0377s/iter; left time: 1553.5732s
	iters: 200, epoch: 1 | loss: 0.0964259
	speed: 0.0207s/iter; left time: 849.2675s
	iters: 300, epoch: 1 | loss: 0.3137320
	speed: 0.0202s/iter; left time: 829.2665s
	iters: 400, epoch: 1 | loss: 0.0069225
	speed: 0.0219s/iter; left time: 895.3738s
Epoch: 1 cost time: 10.390581369400024
Epoch: 1, Steps: 413 | Train Loss: 0.393 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
Validation loss decreased (inf --> -0.982264).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0009721
	speed: 0.0774s/iter; left time: 3156.8378s
	iters: 200, epoch: 2 | loss: 0.0011683
	speed: 0.0211s/iter; left time: 858.5056s
	iters: 300, epoch: 2 | loss: 0.2536488
	speed: 0.0197s/iter; left time: 798.7313s
	iters: 400, epoch: 2 | loss: 0.0024554
	speed: 0.0200s/iter; left time: 809.5564s
Epoch: 2 cost time: 8.90054440498352
Epoch: 2, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3995604
	speed: 0.0692s/iter; left time: 2792.6969s
	iters: 200, epoch: 3 | loss: 0.0029114
	speed: 0.0206s/iter; left time: 828.8515s
	iters: 300, epoch: 3 | loss: 0.0015343
	speed: 0.0211s/iter; left time: 846.5267s
	iters: 400, epoch: 3 | loss: 0.0383042
	speed: 0.0214s/iter; left time: 859.2270s
Epoch: 3 cost time: 8.998433828353882
Epoch: 3, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0144458
	speed: 0.0693s/iter; left time: 2767.8919s
	iters: 200, epoch: 4 | loss: 0.0002113
	speed: 0.0201s/iter; left time: 800.6968s
	iters: 300, epoch: 4 | loss: 0.0016045
	speed: 0.0206s/iter; left time: 819.4737s
	iters: 400, epoch: 4 | loss: 0.0002770
	speed: 0.0207s/iter; left time: 821.8403s
Epoch: 4 cost time: 8.840224742889404
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0077799
	speed: 0.0707s/iter; left time: 2797.0236s
	iters: 200, epoch: 5 | loss: 0.0000065
	speed: 0.0204s/iter; left time: 803.9428s
	iters: 300, epoch: 5 | loss: 0.0000336
	speed: 0.0218s/iter; left time: 857.1460s
	iters: 400, epoch: 5 | loss: 0.0990664
	speed: 0.0203s/iter; left time: 796.4408s
Epoch: 5 cost time: 8.980605840682983
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.983173).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0025669
	speed: 0.0762s/iter; left time: 2981.2120s
	iters: 200, epoch: 6 | loss: 0.0130242
	speed: 0.0218s/iter; left time: 852.6302s
	iters: 300, epoch: 6 | loss: 0.0000075
	speed: 0.0230s/iter; left time: 895.6630s
	iters: 400, epoch: 6 | loss: 0.2177248
	speed: 0.0216s/iter; left time: 838.4737s
Epoch: 6 cost time: 9.724724054336548
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.167 Vali Acc: 0.966 Test Loss: 0.167 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000273
	speed: 0.0810s/iter; left time: 3138.2485s
	iters: 200, epoch: 7 | loss: 0.0000079
	speed: 0.0208s/iter; left time: 801.8952s
	iters: 300, epoch: 7 | loss: 0.0005407
	speed: 0.0215s/iter; left time: 828.7562s
	iters: 400, epoch: 7 | loss: 0.2162514
	speed: 0.0237s/iter; left time: 911.9378s
Epoch: 7 cost time: 9.513356447219849
Epoch: 7, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0423170
	speed: 0.0858s/iter; left time: 3288.4177s
	iters: 200, epoch: 8 | loss: 0.2738652
	speed: 0.0207s/iter; left time: 789.6583s
	iters: 300, epoch: 8 | loss: 0.0000160
	speed: 0.0216s/iter; left time: 823.2836s
	iters: 400, epoch: 8 | loss: 0.0000035
	speed: 0.0201s/iter; left time: 763.1604s
Epoch: 8 cost time: 9.262275695800781
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000006
	speed: 0.0753s/iter; left time: 2855.5305s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0208s/iter; left time: 785.9202s
	iters: 300, epoch: 9 | loss: 0.0378664
	speed: 0.0206s/iter; left time: 774.7756s
	iters: 400, epoch: 9 | loss: 0.0002107
	speed: 0.0199s/iter; left time: 747.0155s
Epoch: 9 cost time: 8.813774585723877
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000003
	speed: 0.0729s/iter; left time: 2730.9082s
	iters: 200, epoch: 10 | loss: 0.0344762
	speed: 0.0210s/iter; left time: 784.8135s
	iters: 300, epoch: 10 | loss: 0.2435412
	speed: 0.0208s/iter; left time: 775.1666s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0220s/iter; left time: 816.5256s
Epoch: 10 cost time: 8.972794532775879
Epoch: 10, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.163 Vali Acc: 0.978 Test Loss: 0.163 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.0775s/iter; left time: 2872.1669s
	iters: 200, epoch: 11 | loss: 0.0046261
	speed: 0.0201s/iter; left time: 741.9281s
	iters: 300, epoch: 11 | loss: 0.0011962
	speed: 0.0199s/iter; left time: 735.1051s
	iters: 400, epoch: 11 | loss: 0.4324106
	speed: 0.0199s/iter; left time: 732.2968s
Epoch: 11 cost time: 8.739818572998047
Epoch: 11, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.174 Vali Acc: 0.974 Test Loss: 0.174 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 2713.8300s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0201s/iter; left time: 736.6292s
	iters: 300, epoch: 12 | loss: 0.0001977
	speed: 0.0207s/iter; left time: 755.5183s
	iters: 400, epoch: 12 | loss: 0.0000005
	speed: 0.0212s/iter; left time: 769.8895s
Epoch: 12 cost time: 8.782299280166626
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.318 Vali Acc: 0.964 Test Loss: 0.318 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0736s/iter; left time: 2666.3503s
	iters: 200, epoch: 13 | loss: 0.0003074
	speed: 0.0192s/iter; left time: 695.6800s
	iters: 300, epoch: 13 | loss: 0.0004691
	speed: 0.0199s/iter; left time: 718.7664s
	iters: 400, epoch: 13 | loss: 0.0002395
	speed: 0.0200s/iter; left time: 719.2319s
Epoch: 13 cost time: 8.50332236289978
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0019899
	speed: 0.0713s/iter; left time: 2555.7090s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0193s/iter; left time: 688.9294s
	iters: 300, epoch: 14 | loss: 0.0008542
	speed: 0.0194s/iter; left time: 690.0656s
	iters: 400, epoch: 14 | loss: 0.0000022
	speed: 0.0200s/iter; left time: 708.9346s
Epoch: 14 cost time: 8.397149562835693
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.275 Vali Acc: 0.967 Test Loss: 0.275 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0016641
	speed: 0.0693s/iter; left time: 2453.0488s
	iters: 200, epoch: 15 | loss: 0.0314106
	speed: 0.0206s/iter; left time: 728.2423s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0215s/iter; left time: 758.6660s
	iters: 400, epoch: 15 | loss: 0.0630877
	speed: 0.0214s/iter; left time: 752.8631s
Epoch: 15 cost time: 8.963335514068604
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.331 Vali Acc: 0.973 Test Loss: 0.331 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 454478
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1531685
	speed: 0.0373s/iter; left time: 1536.0065s
	iters: 200, epoch: 1 | loss: 0.0202832
	speed: 0.0226s/iter; left time: 927.8765s
	iters: 300, epoch: 1 | loss: 0.0449205
	speed: 0.0224s/iter; left time: 916.4956s
	iters: 400, epoch: 1 | loss: 0.0068379
	speed: 0.0228s/iter; left time: 932.2779s
Epoch: 1 cost time: 10.846975088119507
Epoch: 1, Steps: 413 | Train Loss: 0.314 Vali Loss: 0.137 Vali Acc: 0.956 Test Loss: 0.137 Test Acc: 0.956
Validation loss decreased (inf --> -0.956342).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2146294
	speed: 0.0811s/iter; left time: 3306.8369s
	iters: 200, epoch: 2 | loss: 0.0063825
	speed: 0.0224s/iter; left time: 911.8256s
	iters: 300, epoch: 2 | loss: 0.0109043
	speed: 0.0214s/iter; left time: 870.1806s
	iters: 400, epoch: 2 | loss: 0.0000531
	speed: 0.0220s/iter; left time: 890.0421s
Epoch: 2 cost time: 9.48591685295105
Epoch: 2, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
Validation loss decreased (-0.956342 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0385394
	speed: 0.0805s/iter; left time: 3249.1626s
	iters: 200, epoch: 3 | loss: 0.0026747
	speed: 0.0206s/iter; left time: 827.8972s
	iters: 300, epoch: 3 | loss: 0.0142251
	speed: 0.0215s/iter; left time: 863.4487s
	iters: 400, epoch: 3 | loss: 0.2317878
	speed: 0.0209s/iter; left time: 838.2392s
Epoch: 3 cost time: 9.127119302749634
Epoch: 3, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0002205
	speed: 0.0791s/iter; left time: 3160.0987s
	iters: 200, epoch: 4 | loss: 0.0004464
	speed: 0.0203s/iter; left time: 807.6015s
	iters: 300, epoch: 4 | loss: 0.0271639
	speed: 0.0206s/iter; left time: 817.1606s
	iters: 400, epoch: 4 | loss: 0.0019369
	speed: 0.0211s/iter; left time: 837.5295s
Epoch: 4 cost time: 9.115808963775635
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0006458
	speed: 0.0812s/iter; left time: 3210.4027s
	iters: 200, epoch: 5 | loss: 0.1141687
	speed: 0.0213s/iter; left time: 839.8363s
	iters: 300, epoch: 5 | loss: 0.0001284
	speed: 0.0218s/iter; left time: 858.8557s
	iters: 400, epoch: 5 | loss: 0.0008663
	speed: 0.0223s/iter; left time: 874.0014s
Epoch: 5 cost time: 9.47318172454834
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
Validation loss decreased (-0.970895 --> -0.971804).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000477
	speed: 0.0739s/iter; left time: 2893.8467s
	iters: 200, epoch: 6 | loss: 0.1255625
	speed: 0.0216s/iter; left time: 844.8022s
	iters: 300, epoch: 6 | loss: 0.1823954
	speed: 0.0216s/iter; left time: 842.3381s
	iters: 400, epoch: 6 | loss: 0.0003098
	speed: 0.0208s/iter; left time: 807.5086s
Epoch: 6 cost time: 9.139325618743896
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.971804 --> -0.978171).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000049
	speed: 0.0724s/iter; left time: 2802.0324s
	iters: 200, epoch: 7 | loss: 0.0000062
	speed: 0.0222s/iter; left time: 856.8944s
	iters: 300, epoch: 7 | loss: 0.0003662
	speed: 0.0220s/iter; left time: 848.7101s
	iters: 400, epoch: 7 | loss: 0.1292208
	speed: 0.0226s/iter; left time: 868.7854s
Epoch: 7 cost time: 9.565009593963623
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.186 Vali Acc: 0.974 Test Loss: 0.186 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000082
	speed: 0.0734s/iter; left time: 2810.9862s
	iters: 200, epoch: 8 | loss: 0.3259842
	speed: 0.0222s/iter; left time: 849.5622s
	iters: 300, epoch: 8 | loss: 0.0000006
	speed: 0.0214s/iter; left time: 815.5024s
	iters: 400, epoch: 8 | loss: 0.0000201
	speed: 0.0208s/iter; left time: 790.3568s
Epoch: 8 cost time: 9.288638591766357
Epoch: 8, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0014092
	speed: 0.0737s/iter; left time: 2792.3850s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 826.1785s
	iters: 300, epoch: 9 | loss: 0.0000006
	speed: 0.0205s/iter; left time: 772.0720s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0204s/iter; left time: 767.0516s
Epoch: 9 cost time: 9.107734203338623
Epoch: 9, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.189 Vali Acc: 0.981 Test Loss: 0.189 Test Acc: 0.981
Validation loss decreased (-0.978171 --> -0.980899).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0736s/iter; left time: 2759.7932s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 791.4387s
	iters: 300, epoch: 10 | loss: 0.0129198
	speed: 0.0216s/iter; left time: 803.6025s
	iters: 400, epoch: 10 | loss: 0.0010944
	speed: 0.0209s/iter; left time: 776.4519s
Epoch: 10 cost time: 9.229968547821045
Epoch: 10, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.237 Vali Acc: 0.977 Test Loss: 0.237 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0126873
	speed: 0.0793s/iter; left time: 2939.0326s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 792.5613s
	iters: 300, epoch: 11 | loss: 0.0000099
	speed: 0.0210s/iter; left time: 775.7235s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 781.4848s
Epoch: 11 cost time: 9.17192554473877
Epoch: 11, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.093 Vali Acc: 0.987 Test Loss: 0.093 Test Acc: 0.987
Validation loss decreased (-0.980899 --> -0.987266).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 2924.1872s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.0216s/iter; left time: 790.6436s
	iters: 300, epoch: 12 | loss: 0.4036056
	speed: 0.0227s/iter; left time: 829.1239s
	iters: 400, epoch: 12 | loss: 0.0003042
	speed: 0.0218s/iter; left time: 794.0074s
Epoch: 12 cost time: 9.544708251953125
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1085116
	speed: 0.0766s/iter; left time: 2776.3812s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 773.3331s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 774.1295s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 781.2642s
Epoch: 13 cost time: 9.301334857940674
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.495 Vali Acc: 0.961 Test Loss: 0.495 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0793s/iter; left time: 2843.0336s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 793.7122s
	iters: 300, epoch: 14 | loss: 0.0000056
	speed: 0.0212s/iter; left time: 756.0832s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 754.6429s
Epoch: 14 cost time: 9.319325923919678
Epoch: 14, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.227 Vali Acc: 0.979 Test Loss: 0.227 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0825s/iter; left time: 2920.7950s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 772.9687s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 765.3254s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 750.0670s
Epoch: 15 cost time: 9.395811319351196
Epoch: 15, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.195 Vali Acc: 0.980 Test Loss: 0.195 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0799s/iter; left time: 2798.5357s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 765.8034s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 773.7778s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 745.9592s
Epoch: 16 cost time: 9.54160213470459
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.254 Vali Acc: 0.981 Test Loss: 0.254 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000003
	speed: 0.0755s/iter; left time: 2612.9369s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 741.0955s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 760.9407s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0230s/iter; left time: 789.4242s
Epoch: 17 cost time: 9.354153871536255
Epoch: 17, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.980 Test Loss: 0.227 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0121207
	speed: 0.0732s/iter; left time: 2500.7397s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0229s/iter; left time: 781.1023s
	iters: 300, epoch: 18 | loss: 0.0000015
	speed: 0.0227s/iter; left time: 772.4722s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0222s/iter; left time: 752.6905s
Epoch: 18 cost time: 9.73386549949646
Epoch: 18, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.211 Vali Acc: 0.981 Test Loss: 0.211 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0763s/iter; left time: 2577.6350s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 813.0619s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0228s/iter; left time: 764.1917s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 781.0032s
Epoch: 19 cost time: 10.028786420822144
Epoch: 19, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.224 Vali Acc: 0.978 Test Loss: 0.224 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.0754s/iter; left time: 2515.9366s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 737.4206s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 729.9002s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 679.6895s
Epoch: 20 cost time: 9.41075348854065
Epoch: 20, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.211 Vali Acc: 0.982 Test Loss: 0.211 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 2555.5841s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 687.6445s
	iters: 300, epoch: 21 | loss: 0.0000255
	speed: 0.0203s/iter; left time: 664.7421s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0226s/iter; left time: 739.2930s
Epoch: 21 cost time: 9.24633526802063
Epoch: 21, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.222 Vali Acc: 0.978 Test Loss: 0.222 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 421710
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1958578
	speed: 0.0387s/iter; left time: 1593.1809s
	iters: 200, epoch: 1 | loss: 0.0305618
	speed: 0.0220s/iter; left time: 905.6146s
	iters: 300, epoch: 1 | loss: 0.0506594
	speed: 0.0225s/iter; left time: 924.2711s
	iters: 400, epoch: 1 | loss: 0.0078688
	speed: 0.0220s/iter; left time: 898.4029s
Epoch: 1 cost time: 10.878135681152344
Epoch: 1, Steps: 413 | Train Loss: 0.321 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
Validation loss decreased (inf --> -0.951340).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0792281
	speed: 0.0729s/iter; left time: 2975.3312s
	iters: 200, epoch: 2 | loss: 0.0105389
	speed: 0.0219s/iter; left time: 892.3476s
	iters: 300, epoch: 2 | loss: 0.0186040
	speed: 0.0227s/iter; left time: 919.7491s
	iters: 400, epoch: 2 | loss: 0.0394652
	speed: 0.0222s/iter; left time: 900.3145s
Epoch: 2 cost time: 9.567673921585083
Epoch: 2, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
Validation loss decreased (-0.951340 --> -0.975443).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0644168
	speed: 0.0780s/iter; left time: 3147.4722s
	iters: 200, epoch: 3 | loss: 0.0282285
	speed: 0.0217s/iter; left time: 875.2967s
	iters: 300, epoch: 3 | loss: 0.0412953
	speed: 0.0217s/iter; left time: 872.7016s
	iters: 400, epoch: 3 | loss: 0.0078033
	speed: 0.0216s/iter; left time: 865.2988s
Epoch: 3 cost time: 9.392808198928833
Epoch: 3, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1179620
	speed: 0.0774s/iter; left time: 3093.0809s
	iters: 200, epoch: 4 | loss: 0.0004545
	speed: 0.0208s/iter; left time: 829.5324s
	iters: 300, epoch: 4 | loss: 0.0058229
	speed: 0.0212s/iter; left time: 843.3354s
	iters: 400, epoch: 4 | loss: 0.0153936
	speed: 0.0213s/iter; left time: 842.9307s
Epoch: 4 cost time: 9.188121795654297
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3753156
	speed: 0.0817s/iter; left time: 3229.8596s
	iters: 200, epoch: 5 | loss: 0.0002691
	speed: 0.0215s/iter; left time: 850.0055s
	iters: 300, epoch: 5 | loss: 0.0133261
	speed: 0.0224s/iter; left time: 882.1474s
	iters: 400, epoch: 5 | loss: 0.0000217
	speed: 0.0215s/iter; left time: 843.1744s
Epoch: 5 cost time: 9.426274299621582
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0092089
	speed: 0.0754s/iter; left time: 2949.8686s
	iters: 200, epoch: 6 | loss: 0.0061643
	speed: 0.0203s/iter; left time: 791.0087s
	iters: 300, epoch: 6 | loss: 0.0000006
	speed: 0.0215s/iter; left time: 835.7157s
	iters: 400, epoch: 6 | loss: 0.0004454
	speed: 0.0204s/iter; left time: 794.0981s
Epoch: 6 cost time: 8.957233428955078
Epoch: 6, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.210 Vali Acc: 0.968 Test Loss: 0.210 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000032
	speed: 0.0779s/iter; left time: 3018.2704s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0226s/iter; left time: 872.9943s
	iters: 300, epoch: 7 | loss: 0.0000448
	speed: 0.0223s/iter; left time: 860.7729s
	iters: 400, epoch: 7 | loss: 0.0001272
	speed: 0.0229s/iter; left time: 880.8218s
Epoch: 7 cost time: 9.528005599975586
Epoch: 7, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.234 Vali Acc: 0.964 Test Loss: 0.234 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.0774s/iter; left time: 2963.6494s
	iters: 200, epoch: 8 | loss: 0.0005557
	speed: 0.0212s/iter; left time: 808.8275s
	iters: 300, epoch: 8 | loss: 0.0215704
	speed: 0.0217s/iter; left time: 825.1409s
	iters: 400, epoch: 8 | loss: 0.0000009
	speed: 0.0224s/iter; left time: 850.2805s
Epoch: 8 cost time: 9.377793312072754
Epoch: 8, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.975443 --> -0.979990).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3648601
	speed: 0.0783s/iter; left time: 2966.3978s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 817.5674s
	iters: 300, epoch: 9 | loss: 0.0000840
	speed: 0.0211s/iter; left time: 796.4104s
	iters: 400, epoch: 9 | loss: 0.0000091
	speed: 0.0212s/iter; left time: 797.1026s
Epoch: 9 cost time: 9.272987604141235
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0786s/iter; left time: 2945.4481s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 821.4608s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 816.6361s
	iters: 400, epoch: 10 | loss: 0.0000137
	speed: 0.0211s/iter; left time: 784.6963s
Epoch: 10 cost time: 9.422940015792847
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.982 Test Loss: 0.130 Test Acc: 0.982
Validation loss decreased (-0.979990 --> -0.982263).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000003
	speed: 0.0818s/iter; left time: 3032.3637s
	iters: 200, epoch: 11 | loss: 0.0008545
	speed: 0.0222s/iter; left time: 821.1169s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 823.4197s
	iters: 400, epoch: 11 | loss: 0.0000004
	speed: 0.0209s/iter; left time: 769.5294s
Epoch: 11 cost time: 9.610046148300171
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.184 Vali Acc: 0.978 Test Loss: 0.184 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0004491
	speed: 0.0844s/iter; left time: 3093.7880s
	iters: 200, epoch: 12 | loss: 0.0004147
	speed: 0.0207s/iter; left time: 755.9977s
	iters: 300, epoch: 12 | loss: 0.0007101
	speed: 0.0215s/iter; left time: 782.1417s
	iters: 400, epoch: 12 | loss: 0.0000003
	speed: 0.0216s/iter; left time: 786.3626s
Epoch: 12 cost time: 9.455152750015259
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.984 Test Loss: 0.114 Test Acc: 0.984
Validation loss decreased (-0.982263 --> -0.983628).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 2962.8993s
	iters: 200, epoch: 13 | loss: 0.0000070
	speed: 0.0198s/iter; left time: 716.3652s
	iters: 300, epoch: 13 | loss: 0.0000305
	speed: 0.0200s/iter; left time: 720.9524s
	iters: 400, epoch: 13 | loss: 0.0003126
	speed: 0.0206s/iter; left time: 741.5960s
Epoch: 13 cost time: 8.887472152709961
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.224 Vali Acc: 0.976 Test Loss: 0.224 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 2639.6342s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0204s/iter; left time: 729.1309s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0195s/iter; left time: 694.6857s
	iters: 400, epoch: 14 | loss: 0.0000048
	speed: 0.0196s/iter; left time: 696.0984s
Epoch: 14 cost time: 8.865737438201904
Epoch: 14, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.171 Vali Acc: 0.979 Test Loss: 0.171 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000014
	speed: 0.0652s/iter; left time: 2310.9152s
	iters: 200, epoch: 15 | loss: 0.0001579
	speed: 0.0197s/iter; left time: 697.5038s
	iters: 300, epoch: 15 | loss: 0.0000011
	speed: 0.0205s/iter; left time: 720.9001s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0197s/iter; left time: 693.4779s
Epoch: 15 cost time: 8.613766431808472
Epoch: 15, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.187 Vali Acc: 0.980 Test Loss: 0.187 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 2505.7669s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 770.6412s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 784.3517s
	iters: 400, epoch: 16 | loss: 1.1801497
	speed: 0.0218s/iter; left time: 755.0614s
Epoch: 16 cost time: 9.549858808517456
Epoch: 16, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.188 Vali Acc: 0.986 Test Loss: 0.188 Test Acc: 0.986
Validation loss decreased (-0.983628 --> -0.986356).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 2693.3464s
	iters: 200, epoch: 17 | loss: 0.0000009
	speed: 0.0227s/iter; left time: 781.3459s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 775.2038s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 759.5695s
Epoch: 17 cost time: 9.755449056625366
Epoch: 17, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.354 Vali Acc: 0.970 Test Loss: 0.354 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000819
	speed: 0.0791s/iter; left time: 2702.4826s
	iters: 200, epoch: 18 | loss: 0.0000229
	speed: 0.0218s/iter; left time: 744.5068s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 821.2631s
	iters: 400, epoch: 18 | loss: 0.0000002
	speed: 0.0231s/iter; left time: 781.0113s
Epoch: 18 cost time: 9.957374334335327
Epoch: 18, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.218 Vali Acc: 0.981 Test Loss: 0.218 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0829s/iter; left time: 2798.7168s
	iters: 200, epoch: 19 | loss: 0.0713348
	speed: 0.0230s/iter; left time: 772.9165s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0225s/iter; left time: 756.1471s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0227s/iter; left time: 759.3740s
Epoch: 19 cost time: 9.76805853843689
Epoch: 19, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.227 Vali Acc: 0.982 Test Loss: 0.227 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0003062
	speed: 0.0886s/iter; left time: 2956.2552s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 731.6297s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 719.0618s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 732.0537s
Epoch: 20 cost time: 9.704431056976318
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.156 Vali Acc: 0.985 Test Loss: 0.156 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000006
	speed: 0.0825s/iter; left time: 2716.5109s
	iters: 200, epoch: 21 | loss: 0.3226653
	speed: 0.0233s/iter; left time: 763.7098s
	iters: 300, epoch: 21 | loss: 0.0000040
	speed: 0.0217s/iter; left time: 710.1263s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 694.5993s
Epoch: 21 cost time: 9.607045888900757
Epoch: 21, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.222 Vali Acc: 0.981 Test Loss: 0.222 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000021
	speed: 0.0801s/iter; left time: 2605.3419s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 703.9015s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0224s/iter; left time: 724.4722s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 724.0361s
Epoch: 22 cost time: 9.651890993118286
Epoch: 22, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.274 Vali Acc: 0.981 Test Loss: 0.274 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 2573.5859s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 703.3649s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 697.4117s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 670.1995s
Epoch: 23 cost time: 9.341846227645874
Epoch: 23, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.253 Vali Acc: 0.980 Test Loss: 0.253 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0794s/iter; left time: 2517.6328s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 673.4555s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0232s/iter; left time: 730.6707s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 695.5021s
Epoch: 24 cost time: 9.801620483398438
Epoch: 24, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.245 Vali Acc: 0.980 Test Loss: 0.245 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0744s/iter; left time: 2328.4274s
	iters: 200, epoch: 25 | loss: 0.0000025
	speed: 0.0207s/iter; left time: 644.5232s
	iters: 300, epoch: 25 | loss: 0.0000137
	speed: 0.0210s/iter; left time: 653.2435s
	iters: 400, epoch: 25 | loss: 0.0850944
	speed: 0.0211s/iter; left time: 653.4238s
Epoch: 25 cost time: 9.020314455032349
Epoch: 25, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.330 Vali Acc: 0.965 Test Loss: 0.330 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 2364.0221s
	iters: 200, epoch: 26 | loss: 0.0000002
	speed: 0.0201s/iter; left time: 618.2963s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0192s/iter; left time: 589.7472s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0201s/iter; left time: 615.5636s
Epoch: 26 cost time: 8.683391094207764
Epoch: 26, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.398 Vali Acc: 0.971 Test Loss: 0.398 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 421710
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2406850
	speed: 0.0314s/iter; left time: 1295.6718s
	iters: 200, epoch: 1 | loss: 0.0532455
	speed: 0.0194s/iter; left time: 796.2912s
	iters: 300, epoch: 1 | loss: 0.0576937
	speed: 0.0178s/iter; left time: 730.9825s
	iters: 400, epoch: 1 | loss: 0.0009016
	speed: 0.0166s/iter; left time: 679.4623s
Epoch: 1 cost time: 8.834276676177979
Epoch: 1, Steps: 413 | Train Loss: 0.339 Vali Loss: 0.142 Vali Acc: 0.952 Test Loss: 0.142 Test Acc: 0.952
Validation loss decreased (inf --> -0.951795).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0081610
	speed: 0.0571s/iter; left time: 2327.2750s
	iters: 200, epoch: 2 | loss: 0.0098176
	speed: 0.0181s/iter; left time: 735.5895s
	iters: 300, epoch: 2 | loss: 0.0443699
	speed: 0.0178s/iter; left time: 720.6360s
	iters: 400, epoch: 2 | loss: 0.0133689
	speed: 0.0178s/iter; left time: 718.8676s
Epoch: 2 cost time: 7.89230489730835
Epoch: 2, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.951795 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0650964
	speed: 0.0571s/iter; left time: 2304.4029s
	iters: 200, epoch: 3 | loss: 0.0875354
	speed: 0.0183s/iter; left time: 736.1508s
	iters: 300, epoch: 3 | loss: 0.0036156
	speed: 0.0183s/iter; left time: 734.5529s
	iters: 400, epoch: 3 | loss: 0.1040781
	speed: 0.0188s/iter; left time: 752.2858s
Epoch: 3 cost time: 8.019110202789307
Epoch: 3, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.970440 --> -0.979535).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0078319
	speed: 0.0579s/iter; left time: 2312.2306s
	iters: 200, epoch: 4 | loss: 0.0005075
	speed: 0.0195s/iter; left time: 778.6462s
	iters: 300, epoch: 4 | loss: 0.0014203
	speed: 0.0191s/iter; left time: 760.5245s
	iters: 400, epoch: 4 | loss: 0.0201087
	speed: 0.0191s/iter; left time: 756.2517s
Epoch: 4 cost time: 8.286828517913818
Epoch: 4, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0113594
	speed: 0.0556s/iter; left time: 2199.9830s
	iters: 200, epoch: 5 | loss: 0.1649881
	speed: 0.0185s/iter; left time: 729.6726s
	iters: 300, epoch: 5 | loss: 0.0059370
	speed: 0.0181s/iter; left time: 711.0743s
	iters: 400, epoch: 5 | loss: 0.0000051
	speed: 0.0195s/iter; left time: 766.8547s
Epoch: 5 cost time: 8.086533784866333
Epoch: 5, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0089648
	speed: 0.0562s/iter; left time: 2199.9758s
	iters: 200, epoch: 6 | loss: 0.0003548
	speed: 0.0182s/iter; left time: 711.1322s
	iters: 300, epoch: 6 | loss: 0.0022901
	speed: 0.0180s/iter; left time: 701.2950s
	iters: 400, epoch: 6 | loss: 0.0000602
	speed: 0.0175s/iter; left time: 678.5904s
Epoch: 6 cost time: 7.752913951873779
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.980899).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000804
	speed: 0.0559s/iter; left time: 2164.0866s
	iters: 200, epoch: 7 | loss: 0.0000052
	speed: 0.0186s/iter; left time: 717.2101s
	iters: 300, epoch: 7 | loss: 0.0057243
	speed: 0.0182s/iter; left time: 699.2722s
	iters: 400, epoch: 7 | loss: 0.0011020
	speed: 0.0185s/iter; left time: 709.9907s
Epoch: 7 cost time: 7.956472635269165
Epoch: 7, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000124
	speed: 0.0597s/iter; left time: 2285.2474s
	iters: 200, epoch: 8 | loss: 0.2162800
	speed: 0.0188s/iter; left time: 719.4524s
	iters: 300, epoch: 8 | loss: 0.0145598
	speed: 0.0181s/iter; left time: 688.8080s
	iters: 400, epoch: 8 | loss: 0.0000447
	speed: 0.0190s/iter; left time: 720.5671s
Epoch: 8 cost time: 8.06906008720398
Epoch: 8, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0004023
	speed: 0.0586s/iter; left time: 2219.0852s
	iters: 200, epoch: 9 | loss: 0.0002942
	speed: 0.0190s/iter; left time: 719.4256s
	iters: 300, epoch: 9 | loss: 0.0063554
	speed: 0.0191s/iter; left time: 720.3433s
	iters: 400, epoch: 9 | loss: 0.0000039
	speed: 0.0184s/iter; left time: 691.4091s
Epoch: 9 cost time: 8.11742639541626
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.149 Vali Acc: 0.980 Test Loss: 0.149 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000555
	speed: 0.0589s/iter; left time: 2209.4714s
	iters: 200, epoch: 10 | loss: 0.0000008
	speed: 0.0187s/iter; left time: 699.0794s
	iters: 300, epoch: 10 | loss: 0.0044842
	speed: 0.0198s/iter; left time: 737.2102s
	iters: 400, epoch: 10 | loss: 0.0000962
	speed: 0.0177s/iter; left time: 659.5151s
Epoch: 10 cost time: 8.180535316467285
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.096 Vali Acc: 0.986 Test Loss: 0.096 Test Acc: 0.986
Validation loss decreased (-0.980899 --> -0.985902).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000084
	speed: 0.0592s/iter; left time: 2195.3420s
	iters: 200, epoch: 11 | loss: 0.0057998
	speed: 0.0196s/iter; left time: 723.6687s
	iters: 300, epoch: 11 | loss: 0.0000934
	speed: 0.0189s/iter; left time: 697.6291s
	iters: 400, epoch: 11 | loss: 0.0000338
	speed: 0.0180s/iter; left time: 663.3338s
Epoch: 11 cost time: 8.104038000106812
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0001290
	speed: 0.0585s/iter; left time: 2146.1130s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0186s/iter; left time: 678.3427s
	iters: 300, epoch: 12 | loss: 0.0000668
	speed: 0.0195s/iter; left time: 711.9559s
	iters: 400, epoch: 12 | loss: 0.0000956
	speed: 0.0190s/iter; left time: 689.0607s
Epoch: 12 cost time: 8.166101455688477
Epoch: 12, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.985 Test Loss: 0.108 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.0592s/iter; left time: 2146.7744s
	iters: 200, epoch: 13 | loss: 0.0000255
	speed: 0.0183s/iter; left time: 660.6866s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0195s/iter; left time: 701.8243s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.0191s/iter; left time: 687.3313s
Epoch: 13 cost time: 8.05460810661316
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.316 Vali Acc: 0.965 Test Loss: 0.316 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000052
	speed: 0.0578s/iter; left time: 2071.7182s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0190s/iter; left time: 680.5171s
	iters: 300, epoch: 14 | loss: 0.0000011
	speed: 0.0197s/iter; left time: 701.8924s
	iters: 400, epoch: 14 | loss: 0.0000021
	speed: 0.0194s/iter; left time: 687.9903s
Epoch: 14 cost time: 8.335849046707153
Epoch: 14, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.175 Vali Acc: 0.977 Test Loss: 0.175 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0002146
	speed: 0.0584s/iter; left time: 2066.8230s
	iters: 200, epoch: 15 | loss: 0.0000005
	speed: 0.0184s/iter; left time: 648.8798s
	iters: 300, epoch: 15 | loss: 0.0000623
	speed: 0.0181s/iter; left time: 636.5631s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0178s/iter; left time: 626.1414s
Epoch: 15 cost time: 7.876763582229614
Epoch: 15, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.978 Test Loss: 0.208 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000004
	speed: 0.0579s/iter; left time: 2027.1682s
	iters: 200, epoch: 16 | loss: 0.0000013
	speed: 0.0181s/iter; left time: 630.1873s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0182s/iter; left time: 634.6776s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0177s/iter; left time: 613.6885s
Epoch: 16 cost time: 7.917447090148926
Epoch: 16, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.127 Vali Acc: 0.981 Test Loss: 0.127 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000022
	speed: 0.0532s/iter; left time: 1839.7654s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0177s/iter; left time: 612.0640s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0188s/iter; left time: 647.2746s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0186s/iter; left time: 636.4834s
Epoch: 17 cost time: 7.813352823257446
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.156 Vali Acc: 0.984 Test Loss: 0.156 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 1918.7110s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0186s/iter; left time: 632.6810s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0178s/iter; left time: 604.7598s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0181s/iter; left time: 614.2443s
Epoch: 18 cost time: 7.828799724578857
Epoch: 18, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.149 Vali Acc: 0.981 Test Loss: 0.149 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 1934.3318s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0183s/iter; left time: 615.8328s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0195s/iter; left time: 655.8246s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0199s/iter; left time: 665.7865s
Epoch: 19 cost time: 8.252830266952515
Epoch: 19, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.394 Vali Acc: 0.971 Test Loss: 0.394 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 1885.3695s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0191s/iter; left time: 635.2302s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0185s/iter; left time: 613.0396s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0195s/iter; left time: 644.8942s
Epoch: 20 cost time: 8.168268918991089
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.145 Vali Acc: 0.987 Test Loss: 0.145 Test Acc: 0.987
Validation loss decreased (-0.985902 --> -0.987265).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0028476
	speed: 0.0551s/iter; left time: 1815.9423s
	iters: 200, epoch: 21 | loss: 0.0000007
	speed: 0.0194s/iter; left time: 637.5309s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0194s/iter; left time: 633.6915s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0189s/iter; left time: 615.3457s
Epoch: 21 cost time: 8.298914432525635
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.172 Vali Acc: 0.980 Test Loss: 0.172 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.4244790
	speed: 0.0579s/iter; left time: 1882.1275s
	iters: 200, epoch: 22 | loss: 0.0000065
	speed: 0.0181s/iter; left time: 585.4776s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0177s/iter; left time: 573.0305s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0163s/iter; left time: 525.5257s
Epoch: 22 cost time: 7.697136878967285
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.173 Vali Acc: 0.980 Test Loss: 0.173 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000001
	speed: 0.0546s/iter; left time: 1754.7175s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0200s/iter; left time: 641.1164s
	iters: 300, epoch: 23 | loss: 0.0000004
	speed: 0.0201s/iter; left time: 640.8254s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0197s/iter; left time: 626.6613s
Epoch: 23 cost time: 8.420956134796143
Epoch: 23, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.979 Test Loss: 0.211 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0028565
	speed: 0.0547s/iter; left time: 1733.7731s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0153s/iter; left time: 483.0095s
	iters: 300, epoch: 24 | loss: 0.0000028
	speed: 0.0182s/iter; left time: 573.0979s
	iters: 400, epoch: 24 | loss: 0.0006632
	speed: 0.0193s/iter; left time: 605.7838s
Epoch: 24 cost time: 7.546926259994507
Epoch: 24, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.353 Vali Acc: 0.977 Test Loss: 0.353 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0536s/iter; left time: 1677.4913s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0190s/iter; left time: 592.2594s
	iters: 300, epoch: 25 | loss: 0.0010571
	speed: 0.0193s/iter; left time: 599.0922s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0176s/iter; left time: 544.1018s
Epoch: 25 cost time: 7.954931259155273
Epoch: 25, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.394 Vali Acc: 0.975 Test Loss: 0.394 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 1773.8440s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0184s/iter; left time: 566.0290s
	iters: 300, epoch: 26 | loss: 0.0000009
	speed: 0.0209s/iter; left time: 641.4586s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0190s/iter; left time: 581.0673s
Epoch: 26 cost time: 8.3197922706604
Epoch: 26, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.990 Test Loss: 0.121 Test Acc: 0.990
Validation loss decreased (-0.987265 --> -0.989994).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 1677.0886s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0193s/iter; left time: 585.2780s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 628.7450s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0198s/iter; left time: 596.7619s
Epoch: 27 cost time: 8.394949913024902
Epoch: 27, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.245 Vali Acc: 0.981 Test Loss: 0.245 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 1605.4370s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0192s/iter; left time: 575.3012s
	iters: 300, epoch: 28 | loss: 0.0000097
	speed: 0.0176s/iter; left time: 524.5177s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0183s/iter; left time: 545.0483s
Epoch: 28 cost time: 7.845893383026123
Epoch: 28, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.243 Vali Acc: 0.978 Test Loss: 0.243 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 1701.5961s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0179s/iter; left time: 530.1428s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0190s/iter; left time: 559.7191s
	iters: 400, epoch: 29 | loss: 0.0000001
	speed: 0.0169s/iter; left time: 495.0510s
Epoch: 29 cost time: 7.840921878814697
Epoch: 29, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.163 Vali Acc: 0.979 Test Loss: 0.163 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 1748.1284s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 616.9229s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0189s/iter; left time: 547.9871s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0182s/iter; left time: 527.5506s
Epoch: 30 cost time: 8.459369659423828
Epoch: 30, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.157 Vali Acc: 0.983 Test Loss: 0.157 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0275111
	speed: 0.0573s/iter; left time: 1650.1363s
	iters: 200, epoch: 31 | loss: 0.0004905
	speed: 0.0193s/iter; left time: 555.4094s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0175s/iter; left time: 500.3221s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0188s/iter; left time: 536.7949s
Epoch: 31 cost time: 8.073965072631836
Epoch: 31, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.982 Test Loss: 0.158 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 1578.7467s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0190s/iter; left time: 537.8722s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0187s/iter; left time: 527.5940s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0195s/iter; left time: 546.6221s
Epoch: 32 cost time: 8.06777572631836
Epoch: 32, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.130 Vali Acc: 0.986 Test Loss: 0.130 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 1622.1854s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0192s/iter; left time: 535.4481s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0177s/iter; left time: 491.3461s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 596.8297s
Epoch: 33 cost time: 8.478568077087402
Epoch: 33, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.273 Vali Acc: 0.981 Test Loss: 0.273 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0371845
	speed: 0.0562s/iter; left time: 1550.0025s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0189s/iter; left time: 519.9476s
	iters: 300, epoch: 34 | loss: 0.0001325
	speed: 0.0186s/iter; left time: 509.3022s
	iters: 400, epoch: 34 | loss: 0.0031084
	speed: 0.0183s/iter; left time: 499.0508s
Epoch: 34 cost time: 8.095108032226562
Epoch: 34, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.190 Vali Acc: 0.984 Test Loss: 0.190 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 1537.4602s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0193s/iter; left time: 523.1615s
	iters: 300, epoch: 35 | loss: 0.0005182
	speed: 0.0184s/iter; left time: 496.0744s
	iters: 400, epoch: 35 | loss: 0.0000002
	speed: 0.0188s/iter; left time: 506.0582s
Epoch: 35 cost time: 8.190304040908813
Epoch: 35, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.264 Vali Acc: 0.978 Test Loss: 0.264 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 1535.1728s
	iters: 200, epoch: 36 | loss: 0.0000004
	speed: 0.0198s/iter; left time: 527.1531s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0198s/iter; left time: 525.7800s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0194s/iter; left time: 513.7334s
Epoch: 36 cost time: 8.359159469604492
Epoch: 36, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.177 Vali Acc: 0.985 Test Loss: 0.177 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 421710
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3765300
	speed: 0.0381s/iter; left time: 1570.2492s
	iters: 200, epoch: 1 | loss: 0.0672187
	speed: 0.0224s/iter; left time: 922.5882s
	iters: 300, epoch: 1 | loss: 0.0474914
	speed: 0.0217s/iter; left time: 891.2995s
	iters: 400, epoch: 1 | loss: 0.0033418
	speed: 0.0217s/iter; left time: 886.6679s
Epoch: 1 cost time: 10.73463487625122
Epoch: 1, Steps: 413 | Train Loss: 0.395 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
Validation loss decreased (inf --> -0.965438).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0050925
	speed: 0.0738s/iter; left time: 3011.9205s
	iters: 200, epoch: 2 | loss: 0.0079236
	speed: 0.0217s/iter; left time: 883.2547s
	iters: 300, epoch: 2 | loss: 0.1169736
	speed: 0.0212s/iter; left time: 861.5424s
	iters: 400, epoch: 2 | loss: 0.0147716
	speed: 0.0214s/iter; left time: 864.7018s
Epoch: 2 cost time: 9.266268253326416
Epoch: 2, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.048 Vali Acc: 0.984 Test Loss: 0.048 Test Acc: 0.984
Validation loss decreased (-0.965438 --> -0.983628).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0261175
	speed: 0.0770s/iter; left time: 3109.3341s
	iters: 200, epoch: 3 | loss: 0.0035953
	speed: 0.0241s/iter; left time: 970.5161s
	iters: 300, epoch: 3 | loss: 0.0004819
	speed: 0.0219s/iter; left time: 880.2836s
	iters: 400, epoch: 3 | loss: 0.0518326
	speed: 0.0232s/iter; left time: 929.7801s
Epoch: 3 cost time: 9.748813152313232
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0039358
	speed: 0.0816s/iter; left time: 3259.2686s
	iters: 200, epoch: 4 | loss: 0.0027696
	speed: 0.0210s/iter; left time: 838.1510s
	iters: 300, epoch: 4 | loss: 0.0000866
	speed: 0.0218s/iter; left time: 866.7714s
	iters: 400, epoch: 4 | loss: 0.0048871
	speed: 0.0215s/iter; left time: 852.4298s
Epoch: 4 cost time: 9.246023178100586
Epoch: 4, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0956330
	speed: 0.0853s/iter; left time: 3374.7185s
	iters: 200, epoch: 5 | loss: 0.3983620
	speed: 0.0226s/iter; left time: 891.2365s
	iters: 300, epoch: 5 | loss: 0.0725301
	speed: 0.0226s/iter; left time: 887.4457s
	iters: 400, epoch: 5 | loss: 0.0001353
	speed: 0.0226s/iter; left time: 885.6447s
Epoch: 5 cost time: 9.797054052352905
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0011736
	speed: 0.0803s/iter; left time: 3142.1843s
	iters: 200, epoch: 6 | loss: 0.0001200
	speed: 0.0212s/iter; left time: 828.1012s
	iters: 300, epoch: 6 | loss: 0.0104464
	speed: 0.0209s/iter; left time: 813.2909s
	iters: 400, epoch: 6 | loss: 0.0000808
	speed: 0.0214s/iter; left time: 832.3024s
Epoch: 6 cost time: 9.203630208969116
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000063
	speed: 0.0777s/iter; left time: 3008.1962s
	iters: 200, epoch: 7 | loss: 0.0000016
	speed: 0.0196s/iter; left time: 757.2775s
	iters: 300, epoch: 7 | loss: 0.4619716
	speed: 0.0212s/iter; left time: 815.4848s
	iters: 400, epoch: 7 | loss: 0.3768223
	speed: 0.0204s/iter; left time: 782.7697s
Epoch: 7 cost time: 9.119864702224731
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0018311
	speed: 0.0721s/iter; left time: 2760.4563s
	iters: 200, epoch: 8 | loss: 0.0000013
	speed: 0.0208s/iter; left time: 794.0393s
	iters: 300, epoch: 8 | loss: 0.0000583
	speed: 0.0215s/iter; left time: 818.7823s
	iters: 400, epoch: 8 | loss: 0.1975670
	speed: 0.0217s/iter; left time: 825.2749s
Epoch: 8 cost time: 9.203765392303467
Epoch: 8, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.124 Vali Acc: 0.979 Test Loss: 0.124 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0029004
	speed: 0.0730s/iter; left time: 2767.3117s
	iters: 200, epoch: 9 | loss: 0.0005422
	speed: 0.0208s/iter; left time: 786.1314s
	iters: 300, epoch: 9 | loss: 0.1020277
	speed: 0.0214s/iter; left time: 806.6987s
	iters: 400, epoch: 9 | loss: 0.0000002
	speed: 0.0203s/iter; left time: 763.3569s
Epoch: 9 cost time: 9.100058794021606
Epoch: 9, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0742s/iter; left time: 2780.7410s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.0225s/iter; left time: 839.8684s
	iters: 300, epoch: 10 | loss: 0.0053397
	speed: 0.0204s/iter; left time: 759.6023s
	iters: 400, epoch: 10 | loss: 0.0206767
	speed: 0.0199s/iter; left time: 741.2848s
Epoch: 10 cost time: 9.037732601165771
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000063
	speed: 0.0748s/iter; left time: 2773.0576s
	iters: 200, epoch: 11 | loss: 0.0004729
	speed: 0.0210s/iter; left time: 778.1129s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 768.1511s
	iters: 400, epoch: 11 | loss: 0.0000095
	speed: 0.0214s/iter; left time: 786.9641s
Epoch: 11 cost time: 8.998751878738403
Epoch: 11, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.203 Vali Acc: 0.970 Test Loss: 0.203 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2816.9377s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.0207s/iter; left time: 757.8719s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0206s/iter; left time: 750.8966s
	iters: 400, epoch: 12 | loss: 0.0000053
	speed: 0.0223s/iter; left time: 810.1261s
Epoch: 12 cost time: 9.197688817977905
Epoch: 12, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 421710
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2867258
	speed: 0.0386s/iter; left time: 1588.8803s
	iters: 200, epoch: 1 | loss: 0.1050402
	speed: 0.0204s/iter; left time: 839.9745s
	iters: 300, epoch: 1 | loss: 0.2195732
	speed: 0.0211s/iter; left time: 863.3898s
	iters: 400, epoch: 1 | loss: 0.0462025
	speed: 0.0208s/iter; left time: 852.4667s
Epoch: 1 cost time: 10.417078256607056
Epoch: 1, Steps: 413 | Train Loss: 0.408 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
Validation loss decreased (inf --> -0.968166).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0193036
	speed: 0.0714s/iter; left time: 2912.8393s
	iters: 200, epoch: 2 | loss: 0.0069814
	speed: 0.0203s/iter; left time: 824.7649s
	iters: 300, epoch: 2 | loss: 0.0750521
	speed: 0.0216s/iter; left time: 876.1430s
	iters: 400, epoch: 2 | loss: 0.0074026
	speed: 0.0209s/iter; left time: 845.9555s
Epoch: 2 cost time: 8.98049259185791
Epoch: 2, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
Validation loss decreased (-0.968166 --> -0.969986).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0045009
	speed: 0.0899s/iter; left time: 3631.3024s
	iters: 200, epoch: 3 | loss: 0.0013648
	speed: 0.0221s/iter; left time: 890.9564s
	iters: 300, epoch: 3 | loss: 0.0008384
	speed: 0.0221s/iter; left time: 888.1451s
	iters: 400, epoch: 3 | loss: 0.0637412
	speed: 0.0228s/iter; left time: 914.3890s
Epoch: 3 cost time: 9.794584035873413
Epoch: 3, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.094 Vali Acc: 0.966 Test Loss: 0.094 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0022152
	speed: 0.0809s/iter; left time: 3233.5490s
	iters: 200, epoch: 4 | loss: 0.0007801
	speed: 0.0225s/iter; left time: 896.2477s
	iters: 300, epoch: 4 | loss: 0.0207227
	speed: 0.0247s/iter; left time: 982.6795s
	iters: 400, epoch: 4 | loss: 0.0140491
	speed: 0.0230s/iter; left time: 910.7590s
Epoch: 4 cost time: 10.146958351135254
Epoch: 4, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.969986 --> -0.975442).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0003205
	speed: 0.0791s/iter; left time: 3129.2563s
	iters: 200, epoch: 5 | loss: 0.0525634
	speed: 0.0213s/iter; left time: 838.4342s
	iters: 300, epoch: 5 | loss: 0.0021057
	speed: 0.0218s/iter; left time: 856.0619s
	iters: 400, epoch: 5 | loss: 0.0002032
	speed: 0.0215s/iter; left time: 842.3780s
Epoch: 5 cost time: 9.16727614402771
Epoch: 5, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000044
	speed: 0.0751s/iter; left time: 2940.6954s
	iters: 200, epoch: 6 | loss: 0.0004963
	speed: 0.0187s/iter; left time: 730.1532s
	iters: 300, epoch: 6 | loss: 0.0013284
	speed: 0.0213s/iter; left time: 828.7756s
	iters: 400, epoch: 6 | loss: 0.0094443
	speed: 0.0208s/iter; left time: 809.0257s
Epoch: 6 cost time: 8.779402256011963
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0007654
	speed: 0.0703s/iter; left time: 2723.0640s
	iters: 200, epoch: 7 | loss: 0.0001155
	speed: 0.0231s/iter; left time: 893.2988s
	iters: 300, epoch: 7 | loss: 0.0001144
	speed: 0.0211s/iter; left time: 812.8915s
	iters: 400, epoch: 7 | loss: 0.0010133
	speed: 0.0219s/iter; left time: 841.3292s
Epoch: 7 cost time: 9.652644634246826
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.975442 --> -0.975897).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0020593
	speed: 0.0725s/iter; left time: 2777.8075s
	iters: 200, epoch: 8 | loss: 0.0084803
	speed: 0.0218s/iter; left time: 834.1351s
	iters: 300, epoch: 8 | loss: 0.0000515
	speed: 0.0207s/iter; left time: 787.8409s
	iters: 400, epoch: 8 | loss: 0.0000019
	speed: 0.0219s/iter; left time: 833.3779s
Epoch: 8 cost time: 9.420295476913452
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
Validation loss decreased (-0.975897 --> -0.981355).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000058
	speed: 0.0778s/iter; left time: 2948.8380s
	iters: 200, epoch: 9 | loss: 0.0000010
	speed: 0.0215s/iter; left time: 813.0301s
	iters: 300, epoch: 9 | loss: 0.3543680
	speed: 0.0228s/iter; left time: 860.9181s
	iters: 400, epoch: 9 | loss: 0.2005723
	speed: 0.0211s/iter; left time: 794.7877s
Epoch: 9 cost time: 9.31369400024414
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0017424
	speed: 0.0777s/iter; left time: 2912.6845s
	iters: 200, epoch: 10 | loss: 0.0000093
	speed: 0.0212s/iter; left time: 792.6584s
	iters: 300, epoch: 10 | loss: 0.0000043
	speed: 0.0208s/iter; left time: 774.1248s
	iters: 400, epoch: 10 | loss: 0.0018374
	speed: 0.0219s/iter; left time: 813.3381s
Epoch: 10 cost time: 9.319751977920532
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000016
	speed: 0.0706s/iter; left time: 2617.6815s
	iters: 200, epoch: 11 | loss: 0.0000156
	speed: 0.0208s/iter; left time: 770.4519s
	iters: 300, epoch: 11 | loss: 0.0222562
	speed: 0.0210s/iter; left time: 775.8681s
	iters: 400, epoch: 11 | loss: 0.0063254
	speed: 0.0213s/iter; left time: 783.2966s
Epoch: 11 cost time: 9.0698561668396
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0030566
	speed: 0.0690s/iter; left time: 2531.1465s
	iters: 200, epoch: 12 | loss: 0.0001188
	speed: 0.0220s/iter; left time: 802.6080s
	iters: 300, epoch: 12 | loss: 0.0000002
	speed: 0.0213s/iter; left time: 777.6509s
	iters: 400, epoch: 12 | loss: 0.0000637
	speed: 0.0222s/iter; left time: 807.7314s
Epoch: 12 cost time: 9.276632070541382
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000050
	speed: 0.0760s/iter; left time: 2753.6006s
	iters: 200, epoch: 13 | loss: 0.0000758
	speed: 0.0218s/iter; left time: 786.9774s
	iters: 300, epoch: 13 | loss: 0.0000556
	speed: 0.0210s/iter; left time: 755.6398s
	iters: 400, epoch: 13 | loss: 0.0002491
	speed: 0.0220s/iter; left time: 792.3114s
Epoch: 13 cost time: 9.332821130752563
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0725s/iter; left time: 2598.0196s
	iters: 200, epoch: 14 | loss: 0.0000043
	speed: 0.0208s/iter; left time: 741.6550s
	iters: 300, epoch: 14 | loss: 0.0003238
	speed: 0.0209s/iter; left time: 744.4356s
	iters: 400, epoch: 14 | loss: 0.0501812
	speed: 0.0211s/iter; left time: 749.3556s
Epoch: 14 cost time: 9.051856517791748
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000075
	speed: 0.0828s/iter; left time: 2932.5051s
	iters: 200, epoch: 15 | loss: 0.0000409
	speed: 0.0215s/iter; left time: 760.8333s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0213s/iter; left time: 748.4753s
	iters: 400, epoch: 15 | loss: 0.0000329
	speed: 0.0215s/iter; left time: 755.3770s
Epoch: 15 cost time: 9.362493991851807
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
Validation loss decreased (-0.981355 --> -0.981809).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0003810
	speed: 0.0821s/iter; left time: 2872.8486s
	iters: 200, epoch: 16 | loss: 0.0000542
	speed: 0.0221s/iter; left time: 770.4523s
	iters: 300, epoch: 16 | loss: 0.0000025
	speed: 0.0226s/iter; left time: 785.1063s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 737.8651s
Epoch: 16 cost time: 9.429471015930176
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000574
	speed: 0.0776s/iter; left time: 2682.9792s
	iters: 200, epoch: 17 | loss: 0.0000638
	speed: 0.0221s/iter; left time: 763.5280s
	iters: 300, epoch: 17 | loss: 0.0000021
	speed: 0.0205s/iter; left time: 705.7424s
	iters: 400, epoch: 17 | loss: 0.0517197
	speed: 0.0217s/iter; left time: 744.5053s
Epoch: 17 cost time: 9.30615234375
Epoch: 17, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4409490
	speed: 0.0695s/iter; left time: 2374.7182s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 716.1436s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 750.0272s
	iters: 400, epoch: 18 | loss: 0.0000003
	speed: 0.0226s/iter; left time: 765.2949s
Epoch: 18 cost time: 9.299458980560303
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.295 Vali Acc: 0.966 Test Loss: 0.295 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0738s/iter; left time: 2493.1369s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 716.9119s
	iters: 300, epoch: 19 | loss: 0.2561533
	speed: 0.0216s/iter; left time: 724.2645s
	iters: 400, epoch: 19 | loss: 0.0001109
	speed: 0.0212s/iter; left time: 707.8435s
Epoch: 19 cost time: 9.258373022079468
Epoch: 19, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.980 Test Loss: 0.157 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0342123
	speed: 0.0722s/iter; left time: 2408.3839s
	iters: 200, epoch: 20 | loss: 0.0000273
	speed: 0.0216s/iter; left time: 717.2236s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 695.7337s
	iters: 400, epoch: 20 | loss: 0.0008411
	speed: 0.0220s/iter; left time: 727.7033s
Epoch: 20 cost time: 9.283233642578125
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.268 Vali Acc: 0.967 Test Loss: 0.268 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0802s/iter; left time: 2641.9462s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0227s/iter; left time: 744.8642s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 705.7029s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 694.9043s
Epoch: 21 cost time: 9.658419370651245
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.0881s/iter; left time: 2865.3045s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0222s/iter; left time: 719.9750s
	iters: 300, epoch: 22 | loss: 0.0000171
	speed: 0.0226s/iter; left time: 731.0771s
	iters: 400, epoch: 22 | loss: 0.0000008
	speed: 0.0225s/iter; left time: 723.9458s
Epoch: 22 cost time: 9.759163856506348
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.973 Test Loss: 0.204 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0028775
	speed: 0.0748s/iter; left time: 2403.7190s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 707.9242s
	iters: 300, epoch: 23 | loss: 0.0004275
	speed: 0.0230s/iter; left time: 732.7116s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 689.5191s
Epoch: 23 cost time: 9.661307573318481
Epoch: 23, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.977 Test Loss: 0.192 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000011
	speed: 0.0789s/iter; left time: 2500.4603s
	iters: 200, epoch: 24 | loss: 0.0000321
	speed: 0.0212s/iter; left time: 671.2061s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 678.3579s
	iters: 400, epoch: 24 | loss: 0.0000001
	speed: 0.0217s/iter; left time: 682.3707s
Epoch: 24 cost time: 9.396014928817749
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.179 Vali Acc: 0.977 Test Loss: 0.179 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.0781s/iter; left time: 2443.6381s
	iters: 200, epoch: 25 | loss: 0.0000081
	speed: 0.0206s/iter; left time: 641.9612s
	iters: 300, epoch: 25 | loss: 0.0000024
	speed: 0.0206s/iter; left time: 639.7652s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 650.2934s
Epoch: 25 cost time: 9.080020666122437
Epoch: 25, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.245 Vali Acc: 0.970 Test Loss: 0.245 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 686030
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3034471
	speed: 0.0380s/iter; left time: 1564.8491s
	iters: 200, epoch: 1 | loss: 0.1240079
	speed: 0.0193s/iter; left time: 792.4368s
	iters: 300, epoch: 1 | loss: 0.2224914
	speed: 0.0210s/iter; left time: 860.6150s
	iters: 400, epoch: 1 | loss: 0.0344946
	speed: 0.0209s/iter; left time: 854.5033s
Epoch: 1 cost time: 10.273714780807495
Epoch: 1, Steps: 413 | Train Loss: 0.422 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0099457
	speed: 0.0748s/iter; left time: 3052.5637s
	iters: 200, epoch: 2 | loss: 0.0075927
	speed: 0.0216s/iter; left time: 879.6557s
	iters: 300, epoch: 2 | loss: 0.0518577
	speed: 0.0206s/iter; left time: 836.5035s
	iters: 400, epoch: 2 | loss: 0.0086729
	speed: 0.0200s/iter; left time: 811.4420s
Epoch: 2 cost time: 8.999862432479858
Epoch: 2, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.970895 --> -0.977262).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0018189
	speed: 0.0712s/iter; left time: 2873.7688s
	iters: 200, epoch: 3 | loss: 0.0014626
	speed: 0.0217s/iter; left time: 872.2407s
	iters: 300, epoch: 3 | loss: 0.0028022
	speed: 0.0215s/iter; left time: 861.7934s
	iters: 400, epoch: 3 | loss: 0.0198423
	speed: 0.0206s/iter; left time: 823.7202s
Epoch: 3 cost time: 9.166154384613037
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0005060
	speed: 0.0733s/iter; left time: 2928.6408s
	iters: 200, epoch: 4 | loss: 0.0136973
	speed: 0.0209s/iter; left time: 834.7521s
	iters: 300, epoch: 4 | loss: 0.0071823
	speed: 0.0207s/iter; left time: 824.2091s
	iters: 400, epoch: 4 | loss: 0.0014296
	speed: 0.0214s/iter; left time: 846.9844s
Epoch: 4 cost time: 9.078124284744263
Epoch: 4, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0008364
	speed: 0.0722s/iter; left time: 2854.2217s
	iters: 200, epoch: 5 | loss: 0.0354890
	speed: 0.0213s/iter; left time: 841.1582s
	iters: 300, epoch: 5 | loss: 0.0007604
	speed: 0.0207s/iter; left time: 813.4343s
	iters: 400, epoch: 5 | loss: 0.0000518
	speed: 0.0210s/iter; left time: 825.0510s
Epoch: 5 cost time: 9.176651000976562
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0001483
	speed: 0.0755s/iter; left time: 2952.8220s
	iters: 200, epoch: 6 | loss: 0.0077371
	speed: 0.0214s/iter; left time: 834.6263s
	iters: 300, epoch: 6 | loss: 0.0001909
	speed: 0.0230s/iter; left time: 894.4602s
	iters: 400, epoch: 6 | loss: 0.0034406
	speed: 0.0215s/iter; left time: 835.9431s
Epoch: 6 cost time: 9.412277698516846
Epoch: 6, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000003
	speed: 0.0812s/iter; left time: 3143.6332s
	iters: 200, epoch: 7 | loss: 0.0009454
	speed: 0.0221s/iter; left time: 855.4362s
	iters: 300, epoch: 7 | loss: 0.0005938
	speed: 0.0203s/iter; left time: 782.1194s
	iters: 400, epoch: 7 | loss: 0.0006829
	speed: 0.0217s/iter; left time: 834.3086s
Epoch: 7 cost time: 9.29527735710144
Epoch: 7, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0009978
	speed: 0.0821s/iter; left time: 3145.9905s
	iters: 200, epoch: 8 | loss: 0.0000131
	speed: 0.0211s/iter; left time: 807.2769s
	iters: 300, epoch: 8 | loss: 0.0009787
	speed: 0.0223s/iter; left time: 848.9091s
	iters: 400, epoch: 8 | loss: 0.0000312
	speed: 0.0225s/iter; left time: 853.5054s
Epoch: 8 cost time: 9.581643104553223
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000033
	speed: 0.0766s/iter; left time: 2904.1503s
	iters: 200, epoch: 9 | loss: 0.0001525
	speed: 0.0221s/iter; left time: 836.6714s
	iters: 300, epoch: 9 | loss: 0.0067701
	speed: 0.0213s/iter; left time: 804.3142s
	iters: 400, epoch: 9 | loss: 0.0000112
	speed: 0.0222s/iter; left time: 835.0327s
Epoch: 9 cost time: 9.362746238708496
Epoch: 9, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000052
	speed: 0.0793s/iter; left time: 2972.9526s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.0198s/iter; left time: 740.3644s
	iters: 300, epoch: 10 | loss: 0.0001390
	speed: 0.0232s/iter; left time: 866.4998s
	iters: 400, epoch: 10 | loss: 0.1475026
	speed: 0.0222s/iter; left time: 826.1145s
Epoch: 10 cost time: 9.312055110931396
Epoch: 10, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.153 Vali Acc: 0.971 Test Loss: 0.153 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000918
	speed: 0.0718s/iter; left time: 2662.9616s
	iters: 200, epoch: 11 | loss: 0.0009673
	speed: 0.0217s/iter; left time: 802.2423s
	iters: 300, epoch: 11 | loss: 0.0018566
	speed: 0.0216s/iter; left time: 794.7793s
	iters: 400, epoch: 11 | loss: 0.0000755
	speed: 0.0209s/iter; left time: 768.1976s
Epoch: 11 cost time: 9.23884654045105
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.1044235
	speed: 0.0746s/iter; left time: 2733.2519s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 778.8074s
	iters: 300, epoch: 12 | loss: 0.0001847
	speed: 0.0219s/iter; left time: 799.7133s
	iters: 400, epoch: 12 | loss: 0.0000010
	speed: 0.0213s/iter; left time: 772.8557s
Epoch: 12 cost time: 9.362748146057129
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.977262 --> -0.979535).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0354309
	speed: 0.0754s/iter; left time: 2734.2238s
	iters: 200, epoch: 13 | loss: 0.0000687
	speed: 0.0212s/iter; left time: 766.5608s
	iters: 300, epoch: 13 | loss: 0.0000026
	speed: 0.0210s/iter; left time: 756.1405s
	iters: 400, epoch: 13 | loss: 0.0042656
	speed: 0.0200s/iter; left time: 720.4090s
Epoch: 13 cost time: 8.949126720428467
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.968 Test Loss: 0.221 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0742s/iter; left time: 2658.7979s
	iters: 200, epoch: 14 | loss: 0.0089060
	speed: 0.0213s/iter; left time: 759.5016s
	iters: 300, epoch: 14 | loss: 0.0002552
	speed: 0.0220s/iter; left time: 783.4873s
	iters: 400, epoch: 14 | loss: 0.0000042
	speed: 0.0206s/iter; left time: 733.1784s
Epoch: 14 cost time: 9.035876750946045
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.0696s/iter; left time: 2466.7304s
	iters: 200, epoch: 15 | loss: 0.0004120
	speed: 0.0221s/iter; left time: 779.0776s
	iters: 300, epoch: 15 | loss: 0.0002986
	speed: 0.0226s/iter; left time: 795.4245s
	iters: 400, epoch: 15 | loss: 0.0000151
	speed: 0.0227s/iter; left time: 798.2545s
Epoch: 15 cost time: 9.563382625579834
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
Validation loss decreased (-0.979535 --> -0.982264).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0001966
	speed: 0.0759s/iter; left time: 2657.9471s
	iters: 200, epoch: 16 | loss: 0.0000407
	speed: 0.0221s/iter; left time: 769.7748s
	iters: 300, epoch: 16 | loss: 0.0000015
	speed: 0.0217s/iter; left time: 754.2555s
	iters: 400, epoch: 16 | loss: 0.0000553
	speed: 0.0208s/iter; left time: 720.1839s
Epoch: 16 cost time: 9.285186767578125
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 2526.6747s
	iters: 200, epoch: 17 | loss: 0.0000002
	speed: 0.0224s/iter; left time: 772.4933s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0243s/iter; left time: 835.2443s
	iters: 400, epoch: 17 | loss: 0.0000006
	speed: 0.0217s/iter; left time: 745.4279s
Epoch: 17 cost time: 9.569122791290283
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.142 Vali Acc: 0.978 Test Loss: 0.142 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.0793s/iter; left time: 2709.4527s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 722.1483s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 713.9406s
	iters: 400, epoch: 18 | loss: 0.0000002
	speed: 0.0221s/iter; left time: 749.7910s
Epoch: 18 cost time: 9.31204080581665
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.985 Test Loss: 0.101 Test Acc: 0.985
Validation loss decreased (-0.982264 --> -0.985447).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0004201
	speed: 0.0779s/iter; left time: 2630.8277s
	iters: 200, epoch: 19 | loss: 0.0000003
	speed: 0.0206s/iter; left time: 694.5085s
	iters: 300, epoch: 19 | loss: 0.0000020
	speed: 0.0197s/iter; left time: 661.6984s
	iters: 400, epoch: 19 | loss: 0.0000008
	speed: 0.0212s/iter; left time: 710.4765s
Epoch: 19 cost time: 8.982356786727905
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.237 Vali Acc: 0.967 Test Loss: 0.237 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000058
	speed: 0.0736s/iter; left time: 2453.5252s
	iters: 200, epoch: 20 | loss: 0.0000642
	speed: 0.0209s/iter; left time: 693.4440s
	iters: 300, epoch: 20 | loss: 0.0863013
	speed: 0.0216s/iter; left time: 716.1245s
	iters: 400, epoch: 20 | loss: 0.0001628
	speed: 0.0207s/iter; left time: 685.4852s
Epoch: 20 cost time: 9.122710704803467
Epoch: 20, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0031736
	speed: 0.0703s/iter; left time: 2315.1402s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 740.3322s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 738.2527s
	iters: 400, epoch: 21 | loss: 0.0000154
	speed: 0.0219s/iter; left time: 715.1807s
Epoch: 21 cost time: 9.545993089675903
Epoch: 21, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.164 Vali Acc: 0.974 Test Loss: 0.164 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0002409
	speed: 0.0710s/iter; left time: 2309.1006s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 687.9715s
	iters: 300, epoch: 22 | loss: 0.0007177
	speed: 0.0220s/iter; left time: 710.7989s
	iters: 400, epoch: 22 | loss: 0.0000017
	speed: 0.0226s/iter; left time: 729.1297s
Epoch: 22 cost time: 9.299561738967896
Epoch: 22, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.145 Vali Acc: 0.982 Test Loss: 0.145 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000013
	speed: 0.0729s/iter; left time: 2339.9051s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 677.4678s
	iters: 300, epoch: 23 | loss: 0.0642966
	speed: 0.0219s/iter; left time: 697.5530s
	iters: 400, epoch: 23 | loss: 0.0000223
	speed: 0.0222s/iter; left time: 707.3831s
Epoch: 23 cost time: 9.358243227005005
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000002
	speed: 0.0787s/iter; left time: 2494.6198s
	iters: 200, epoch: 24 | loss: 0.0005679
	speed: 0.0218s/iter; left time: 687.8222s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 672.2441s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0230s/iter; left time: 723.4973s
Epoch: 24 cost time: 9.594589710235596
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.131 Vali Acc: 0.981 Test Loss: 0.131 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000133
	speed: 0.0856s/iter; left time: 2678.1570s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 641.5489s
	iters: 300, epoch: 25 | loss: 0.0015248
	speed: 0.0218s/iter; left time: 677.9080s
	iters: 400, epoch: 25 | loss: 0.0000004
	speed: 0.0208s/iter; left time: 643.4974s
Epoch: 25 cost time: 9.234014511108398
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.153 Vali Acc: 0.978 Test Loss: 0.153 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000061
	speed: 0.0829s/iter; left time: 2558.3032s
	iters: 200, epoch: 26 | loss: 0.0000043
	speed: 0.0210s/iter; left time: 645.7684s
	iters: 300, epoch: 26 | loss: 0.0000015
	speed: 0.0213s/iter; left time: 652.9025s
	iters: 400, epoch: 26 | loss: 0.0197296
	speed: 0.0218s/iter; left time: 665.6314s
Epoch: 26 cost time: 9.43899154663086
Epoch: 26, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.985 Test Loss: 0.111 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 2422.5498s
	iters: 200, epoch: 27 | loss: 0.0000008
	speed: 0.0213s/iter; left time: 646.6777s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 672.0217s
	iters: 400, epoch: 27 | loss: 0.0000003
	speed: 0.0219s/iter; left time: 661.9808s
Epoch: 27 cost time: 9.386506080627441
Epoch: 27, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.167 Vali Acc: 0.980 Test Loss: 0.167 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000005
	speed: 0.0776s/iter; left time: 2331.8653s
	iters: 200, epoch: 28 | loss: 0.0001068
	speed: 0.0216s/iter; left time: 648.0815s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0229s/iter; left time: 682.2660s
	iters: 400, epoch: 28 | loss: 0.0000001
	speed: 0.0220s/iter; left time: 653.5861s
Epoch: 28 cost time: 9.646662473678589
Epoch: 28, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.984 Test Loss: 0.151 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 686030
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3760161
	speed: 0.0369s/iter; left time: 1522.3010s
	iters: 200, epoch: 1 | loss: 0.1265042
	speed: 0.0244s/iter; left time: 1003.9335s
	iters: 300, epoch: 1 | loss: 0.1805800
	speed: 0.0235s/iter; left time: 965.2013s
	iters: 400, epoch: 1 | loss: 0.0469583
	speed: 0.0212s/iter; left time: 868.6126s
Epoch: 1 cost time: 10.983198404312134
Epoch: 1, Steps: 413 | Train Loss: 0.456 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
Validation loss decreased (inf --> -0.964983).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0139151
	speed: 0.0770s/iter; left time: 3141.4888s
	iters: 200, epoch: 2 | loss: 0.0102911
	speed: 0.0202s/iter; left time: 821.0484s
	iters: 300, epoch: 2 | loss: 0.0580246
	speed: 0.0200s/iter; left time: 813.5304s
	iters: 400, epoch: 2 | loss: 0.0097133
	speed: 0.0205s/iter; left time: 831.3331s
Epoch: 2 cost time: 8.726147890090942
Epoch: 2, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.062 Vali Acc: 0.977 Test Loss: 0.062 Test Acc: 0.977
Validation loss decreased (-0.964983 --> -0.976807).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0286176
	speed: 0.0691s/iter; left time: 2790.9378s
	iters: 200, epoch: 3 | loss: 0.0024161
	speed: 0.0212s/iter; left time: 852.0506s
	iters: 300, epoch: 3 | loss: 0.0034003
	speed: 0.0204s/iter; left time: 819.1161s
	iters: 400, epoch: 3 | loss: 0.0040994
	speed: 0.0201s/iter; left time: 806.1724s
Epoch: 3 cost time: 8.813683032989502
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.976807 --> -0.979535).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0020703
	speed: 0.0711s/iter; left time: 2839.7649s
	iters: 200, epoch: 4 | loss: 0.0009696
	speed: 0.0223s/iter; left time: 887.3238s
	iters: 300, epoch: 4 | loss: 0.0042023
	speed: 0.0227s/iter; left time: 901.1876s
	iters: 400, epoch: 4 | loss: 0.0196112
	speed: 0.0212s/iter; left time: 839.1701s
Epoch: 4 cost time: 9.193830490112305
Epoch: 4, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0036554
	speed: 0.0728s/iter; left time: 2879.0142s
	iters: 200, epoch: 5 | loss: 0.0217707
	speed: 0.0218s/iter; left time: 860.1966s
	iters: 300, epoch: 5 | loss: 0.0002197
	speed: 0.0212s/iter; left time: 832.8215s
	iters: 400, epoch: 5 | loss: 0.0001080
	speed: 0.0214s/iter; left time: 841.4684s
Epoch: 5 cost time: 9.283316373825073
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.191 Vali Acc: 0.946 Test Loss: 0.191 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0002321
	speed: 0.0707s/iter; left time: 2768.3205s
	iters: 200, epoch: 6 | loss: 0.0033152
	speed: 0.0213s/iter; left time: 832.4957s
	iters: 300, epoch: 6 | loss: 0.0001631
	speed: 0.0218s/iter; left time: 850.6267s
	iters: 400, epoch: 6 | loss: 0.0023280
	speed: 0.0216s/iter; left time: 838.7862s
Epoch: 6 cost time: 9.260570287704468
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000001
	speed: 0.0734s/iter; left time: 2843.6682s
	iters: 200, epoch: 7 | loss: 0.0013453
	speed: 0.0207s/iter; left time: 798.2350s
	iters: 300, epoch: 7 | loss: 0.0004427
	speed: 0.0214s/iter; left time: 824.4001s
	iters: 400, epoch: 7 | loss: 0.0479549
	speed: 0.0209s/iter; left time: 804.5150s
Epoch: 7 cost time: 9.194224119186401
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0001815
	speed: 0.0782s/iter; left time: 2995.5053s
	iters: 200, epoch: 8 | loss: 0.0007660
	speed: 0.0225s/iter; left time: 861.0570s
	iters: 300, epoch: 8 | loss: 0.0012154
	speed: 0.0219s/iter; left time: 836.2830s
	iters: 400, epoch: 8 | loss: 0.0000591
	speed: 0.0213s/iter; left time: 809.4825s
Epoch: 8 cost time: 9.361199140548706
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979535 --> -0.979990).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000003
	speed: 0.0811s/iter; left time: 3073.1001s
	iters: 200, epoch: 9 | loss: 0.0000110
	speed: 0.0202s/iter; left time: 763.6423s
	iters: 300, epoch: 9 | loss: 0.0049573
	speed: 0.0205s/iter; left time: 774.1107s
	iters: 400, epoch: 9 | loss: 0.0006276
	speed: 0.0208s/iter; left time: 781.4726s
Epoch: 9 cost time: 8.992937326431274
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.979990 --> -0.983628).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000058
	speed: 0.0739s/iter; left time: 2768.8059s
	iters: 200, epoch: 10 | loss: 0.0340306
	speed: 0.0215s/iter; left time: 804.6858s
	iters: 300, epoch: 10 | loss: 0.0000274
	speed: 0.0209s/iter; left time: 780.9134s
	iters: 400, epoch: 10 | loss: 0.0140795
	speed: 0.0209s/iter; left time: 776.8502s
Epoch: 10 cost time: 9.081514596939087
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0006669
	speed: 0.0724s/iter; left time: 2683.0562s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0217s/iter; left time: 803.8849s
	iters: 300, epoch: 11 | loss: 0.0004554
	speed: 0.0222s/iter; left time: 816.6939s
	iters: 400, epoch: 11 | loss: 0.0013763
	speed: 0.0205s/iter; left time: 755.6255s
Epoch: 11 cost time: 9.348687648773193
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0028194
	speed: 0.0695s/iter; left time: 2547.7718s
	iters: 200, epoch: 12 | loss: 0.1013340
	speed: 0.0218s/iter; left time: 797.0506s
	iters: 300, epoch: 12 | loss: 0.0000006
	speed: 0.0215s/iter; left time: 783.3123s
	iters: 400, epoch: 12 | loss: 0.0000158
	speed: 0.0209s/iter; left time: 759.2990s
Epoch: 12 cost time: 9.19626760482788
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000161
	speed: 0.0709s/iter; left time: 2569.8650s
	iters: 200, epoch: 13 | loss: 0.0000015
	speed: 0.0222s/iter; left time: 804.0839s
	iters: 300, epoch: 13 | loss: 0.0000018
	speed: 0.0220s/iter; left time: 794.7470s
	iters: 400, epoch: 13 | loss: 0.0041595
	speed: 0.0203s/iter; left time: 729.7155s
Epoch: 13 cost time: 9.275604963302612
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0002766
	speed: 0.0812s/iter; left time: 2910.6329s
	iters: 200, epoch: 14 | loss: 0.0000051
	speed: 0.0219s/iter; left time: 782.7015s
	iters: 300, epoch: 14 | loss: 0.0000004
	speed: 0.0219s/iter; left time: 779.6112s
	iters: 400, epoch: 14 | loss: 0.0158644
	speed: 0.0211s/iter; left time: 749.5039s
Epoch: 14 cost time: 9.479144096374512
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.265 Vali Acc: 0.960 Test Loss: 0.265 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000040
	speed: 0.0768s/iter; left time: 2719.9490s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0194s/iter; left time: 685.1154s
	iters: 300, epoch: 15 | loss: 0.0000018
	speed: 0.0200s/iter; left time: 703.8191s
	iters: 400, epoch: 15 | loss: 0.0000004
	speed: 0.0203s/iter; left time: 711.6087s
Epoch: 15 cost time: 8.59366488456726
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0204799
	speed: 0.0741s/iter; left time: 2593.5198s
	iters: 200, epoch: 16 | loss: 0.0000296
	speed: 0.0203s/iter; left time: 707.3223s
	iters: 300, epoch: 16 | loss: 0.0018444
	speed: 0.0195s/iter; left time: 679.0309s
	iters: 400, epoch: 16 | loss: 0.0023200
	speed: 0.0207s/iter; left time: 718.8823s
Epoch: 16 cost time: 8.801401615142822
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0002537
	speed: 0.0701s/iter; left time: 2426.3652s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0212s/iter; left time: 732.7587s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 720.3088s
	iters: 400, epoch: 17 | loss: 0.0000010
	speed: 0.0210s/iter; left time: 720.7804s
Epoch: 17 cost time: 9.029223203659058
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0003496
	speed: 0.0716s/iter; left time: 2447.5319s
	iters: 200, epoch: 18 | loss: 0.0000061
	speed: 0.0207s/iter; left time: 705.4790s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 707.9625s
	iters: 400, epoch: 18 | loss: 0.0000010
	speed: 0.0208s/iter; left time: 705.6430s
Epoch: 18 cost time: 8.96422266960144
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000049
	speed: 0.0671s/iter; left time: 2265.6433s
	iters: 200, epoch: 19 | loss: 0.0008042
	speed: 0.0223s/iter; left time: 749.7104s
	iters: 300, epoch: 19 | loss: 0.0000383
	speed: 0.0237s/iter; left time: 794.7656s
	iters: 400, epoch: 19 | loss: 0.0000003
	speed: 0.0212s/iter; left time: 708.7812s
Epoch: 19 cost time: 9.549140453338623
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.214 Vali Acc: 0.968 Test Loss: 0.214 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 686030
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5326729
	speed: 0.0382s/iter; left time: 1572.3583s
	iters: 200, epoch: 1 | loss: 0.2531630
	speed: 0.0213s/iter; left time: 873.6496s
	iters: 300, epoch: 1 | loss: 0.2963897
	speed: 0.0202s/iter; left time: 828.7965s
	iters: 400, epoch: 1 | loss: 0.0538810
	speed: 0.0205s/iter; left time: 839.0970s
Epoch: 1 cost time: 10.374845743179321
Epoch: 1, Steps: 413 | Train Loss: 0.541 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (inf --> -0.969531).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0320811
	speed: 0.0704s/iter; left time: 2870.1432s
	iters: 200, epoch: 2 | loss: 0.0113877
	speed: 0.0202s/iter; left time: 823.7683s
	iters: 300, epoch: 2 | loss: 0.0799089
	speed: 0.0208s/iter; left time: 842.2070s
	iters: 400, epoch: 2 | loss: 0.0204239
	speed: 0.0202s/iter; left time: 816.2555s
Epoch: 2 cost time: 8.744253635406494
Epoch: 2, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.063 Vali Acc: 0.977 Test Loss: 0.063 Test Acc: 0.977
Validation loss decreased (-0.969531 --> -0.976807).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0058120
	speed: 0.0665s/iter; left time: 2684.6368s
	iters: 200, epoch: 3 | loss: 0.0036396
	speed: 0.0199s/iter; left time: 802.7885s
	iters: 300, epoch: 3 | loss: 0.0087710
	speed: 0.0206s/iter; left time: 829.5139s
	iters: 400, epoch: 3 | loss: 0.0034109
	speed: 0.0213s/iter; left time: 853.9820s
Epoch: 3 cost time: 8.950958728790283
Epoch: 3, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0142383
	speed: 0.0773s/iter; left time: 3088.1372s
	iters: 200, epoch: 4 | loss: 0.0024527
	speed: 0.0212s/iter; left time: 846.3174s
	iters: 300, epoch: 4 | loss: 0.0183162
	speed: 0.0211s/iter; left time: 839.4874s
	iters: 400, epoch: 4 | loss: 0.0132700
	speed: 0.0210s/iter; left time: 833.5534s
Epoch: 4 cost time: 9.123247861862183
Epoch: 4, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0001444
	speed: 0.0719s/iter; left time: 2845.0229s
	iters: 200, epoch: 5 | loss: 0.0960193
	speed: 0.0210s/iter; left time: 826.6818s
	iters: 300, epoch: 5 | loss: 0.0028120
	speed: 0.0213s/iter; left time: 836.4732s
	iters: 400, epoch: 5 | loss: 0.0002394
	speed: 0.0217s/iter; left time: 850.5693s
Epoch: 5 cost time: 9.203328132629395
Epoch: 5, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000040
	speed: 0.0762s/iter; left time: 2980.6759s
	iters: 200, epoch: 6 | loss: 0.0011902
	speed: 0.0214s/iter; left time: 836.9271s
	iters: 300, epoch: 6 | loss: 0.0025585
	speed: 0.0223s/iter; left time: 867.5585s
	iters: 400, epoch: 6 | loss: 0.0007526
	speed: 0.0217s/iter; left time: 841.0950s
Epoch: 6 cost time: 9.275949478149414
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.976807 --> -0.979536).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0001797
	speed: 0.0800s/iter; left time: 3099.6255s
	iters: 200, epoch: 7 | loss: 0.0000902
	speed: 0.0206s/iter; left time: 797.2568s
	iters: 300, epoch: 7 | loss: 0.0001427
	speed: 0.0212s/iter; left time: 817.0197s
	iters: 400, epoch: 7 | loss: 0.0000851
	speed: 0.0208s/iter; left time: 798.3673s
Epoch: 7 cost time: 9.020038604736328
Epoch: 7, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0001135
	speed: 0.0770s/iter; left time: 2950.5095s
	iters: 200, epoch: 8 | loss: 0.0024678
	speed: 0.0205s/iter; left time: 782.8792s
	iters: 300, epoch: 8 | loss: 0.0016185
	speed: 0.0205s/iter; left time: 781.9603s
	iters: 400, epoch: 8 | loss: 0.0002060
	speed: 0.0202s/iter; left time: 766.0839s
Epoch: 8 cost time: 8.959694147109985
Epoch: 8, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000299
	speed: 0.0699s/iter; left time: 2650.1424s
	iters: 200, epoch: 9 | loss: 0.0000596
	speed: 0.0206s/iter; left time: 776.8150s
	iters: 300, epoch: 9 | loss: 0.0059928
	speed: 0.0215s/iter; left time: 809.7086s
	iters: 400, epoch: 9 | loss: 0.0000208
	speed: 0.0215s/iter; left time: 808.6988s
Epoch: 9 cost time: 9.051579475402832
Epoch: 9, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.979536 --> -0.982719).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0003009
	speed: 0.0683s/iter; left time: 2559.4381s
	iters: 200, epoch: 10 | loss: 0.0000022
	speed: 0.0195s/iter; left time: 730.3116s
	iters: 300, epoch: 10 | loss: 0.0001157
	speed: 0.0204s/iter; left time: 762.3152s
	iters: 400, epoch: 10 | loss: 0.0342815
	speed: 0.0207s/iter; left time: 770.2637s
Epoch: 10 cost time: 8.71366572380066
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0097644
	speed: 0.0672s/iter; left time: 2490.5922s
	iters: 200, epoch: 11 | loss: 0.0000894
	speed: 0.0209s/iter; left time: 774.5265s
	iters: 300, epoch: 11 | loss: 0.0001238
	speed: 0.0205s/iter; left time: 756.3570s
	iters: 400, epoch: 11 | loss: 0.1141109
	speed: 0.0214s/iter; left time: 786.3124s
Epoch: 11 cost time: 9.032781600952148
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.179 Vali Acc: 0.965 Test Loss: 0.179 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000951
	speed: 0.0671s/iter; left time: 2461.1623s
	iters: 200, epoch: 12 | loss: 0.0084139
	speed: 0.0203s/iter; left time: 741.0172s
	iters: 300, epoch: 12 | loss: 0.0004050
	speed: 0.0212s/iter; left time: 771.5762s
	iters: 400, epoch: 12 | loss: 0.0004074
	speed: 0.0213s/iter; left time: 773.6900s
Epoch: 12 cost time: 8.981660604476929
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0003288
	speed: 0.0673s/iter; left time: 2438.0640s
	iters: 200, epoch: 13 | loss: 0.0127828
	speed: 0.0201s/iter; left time: 728.0900s
	iters: 300, epoch: 13 | loss: 0.0000097
	speed: 0.0194s/iter; left time: 700.0469s
	iters: 400, epoch: 13 | loss: 0.0008383
	speed: 0.0207s/iter; left time: 744.8902s
Epoch: 13 cost time: 8.672211408615112
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000059
	speed: 0.0753s/iter; left time: 2699.0188s
	iters: 200, epoch: 14 | loss: 0.0022640
	speed: 0.0214s/iter; left time: 764.3361s
	iters: 300, epoch: 14 | loss: 0.0001412
	speed: 0.0220s/iter; left time: 784.3123s
	iters: 400, epoch: 14 | loss: 0.0096699
	speed: 0.0206s/iter; left time: 733.5639s
Epoch: 14 cost time: 9.14911937713623
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.165 Vali Acc: 0.969 Test Loss: 0.165 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000915
	speed: 0.0757s/iter; left time: 2679.6066s
	iters: 200, epoch: 15 | loss: 0.0000004
	speed: 0.0201s/iter; left time: 710.2902s
	iters: 300, epoch: 15 | loss: 0.0000014
	speed: 0.0195s/iter; left time: 685.2561s
	iters: 400, epoch: 15 | loss: 0.0009994
	speed: 0.0212s/iter; left time: 743.7879s
Epoch: 15 cost time: 8.848860263824463
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0001369
	speed: 0.0682s/iter; left time: 2389.0515s
	iters: 200, epoch: 16 | loss: 0.0000078
	speed: 0.0216s/iter; left time: 753.7138s
	iters: 300, epoch: 16 | loss: 0.0000651
	speed: 0.0217s/iter; left time: 755.2413s
	iters: 400, epoch: 16 | loss: 0.0000805
	speed: 0.0211s/iter; left time: 732.7389s
Epoch: 16 cost time: 9.113986730575562
Epoch: 16, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0051736
	speed: 0.0725s/iter; left time: 2507.3293s
	iters: 200, epoch: 17 | loss: 0.0000008
	speed: 0.0213s/iter; left time: 736.0651s
	iters: 300, epoch: 17 | loss: 0.2241457
	speed: 0.0225s/iter; left time: 773.7637s
	iters: 400, epoch: 17 | loss: 0.0001397
	speed: 0.0216s/iter; left time: 739.8788s
Epoch: 17 cost time: 9.35443639755249
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.1577271
	speed: 0.0706s/iter; left time: 2411.4074s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 742.6413s
	iters: 300, epoch: 18 | loss: 0.0006595
	speed: 0.0223s/iter; left time: 756.2095s
	iters: 400, epoch: 18 | loss: 0.0000230
	speed: 0.0203s/iter; left time: 688.5418s
Epoch: 18 cost time: 9.187862396240234
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.982 Test Loss: 0.113 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000086
	speed: 0.0704s/iter; left time: 2377.7324s
	iters: 200, epoch: 19 | loss: 0.0000035
	speed: 0.0217s/iter; left time: 729.6026s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0210s/iter; left time: 705.9995s
	iters: 400, epoch: 19 | loss: 0.0000003
	speed: 0.0207s/iter; left time: 692.8237s
Epoch: 19 cost time: 9.142722845077515
Epoch: 19, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.984 Test Loss: 0.105 Test Acc: 0.984
Validation loss decreased (-0.982719 --> -0.983628).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000002
	speed: 0.0736s/iter; left time: 2455.7651s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0202s/iter; left time: 672.3201s
	iters: 300, epoch: 20 | loss: 0.1745515
	speed: 0.0213s/iter; left time: 705.3674s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0201s/iter; left time: 663.0012s
Epoch: 20 cost time: 8.786934614181519
Epoch: 20, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000008
	speed: 0.0734s/iter; left time: 2419.4334s
	iters: 200, epoch: 21 | loss: 0.0000024
	speed: 0.0196s/iter; left time: 643.2335s
	iters: 300, epoch: 21 | loss: 0.0000008
	speed: 0.0178s/iter; left time: 584.3651s
	iters: 400, epoch: 21 | loss: 0.0002100
	speed: 0.0208s/iter; left time: 680.1768s
Epoch: 21 cost time: 8.63357663154602
Epoch: 21, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.179 Vali Acc: 0.976 Test Loss: 0.179 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.3262624
	speed: 0.0698s/iter; left time: 2271.1138s
	iters: 200, epoch: 22 | loss: 0.0000009
	speed: 0.0219s/iter; left time: 711.5081s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 716.5657s
	iters: 400, epoch: 22 | loss: 0.0002203
	speed: 0.0213s/iter; left time: 685.5458s
Epoch: 22 cost time: 9.300209999084473
Epoch: 22, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000010
	speed: 0.0719s/iter; left time: 2309.2517s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 678.2002s
	iters: 300, epoch: 23 | loss: 0.0321758
	speed: 0.0209s/iter; left time: 665.8342s
	iters: 400, epoch: 23 | loss: 0.0000008
	speed: 0.0199s/iter; left time: 633.8728s
Epoch: 23 cost time: 8.988637447357178
Epoch: 23, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.982 Test Loss: 0.113 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0034829
	speed: 0.0765s/iter; left time: 2425.7839s
	iters: 200, epoch: 24 | loss: 0.5425766
	speed: 0.0215s/iter; left time: 678.8243s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 663.7400s
	iters: 400, epoch: 24 | loss: 0.0000168
	speed: 0.0211s/iter; left time: 662.5894s
Epoch: 24 cost time: 9.17367935180664
Epoch: 24, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.135 Vali Acc: 0.981 Test Loss: 0.135 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.0780s/iter; left time: 2441.6294s
	iters: 200, epoch: 25 | loss: 0.0000008
	speed: 0.0209s/iter; left time: 651.6294s
	iters: 300, epoch: 25 | loss: 0.0065934
	speed: 0.0223s/iter; left time: 692.8420s
	iters: 400, epoch: 25 | loss: 0.0000002
	speed: 0.0216s/iter; left time: 668.0766s
Epoch: 25 cost time: 9.425429344177246
Epoch: 25, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.2472585
	speed: 0.0800s/iter; left time: 2469.0735s
	iters: 200, epoch: 26 | loss: 0.0000457
	speed: 0.0202s/iter; left time: 622.3745s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 654.1009s
	iters: 400, epoch: 26 | loss: 0.3420152
	speed: 0.0213s/iter; left time: 651.3725s
Epoch: 26 cost time: 9.213355779647827
Epoch: 26, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000006
	speed: 0.0785s/iter; left time: 2392.5629s
	iters: 200, epoch: 27 | loss: 0.0000002
	speed: 0.0214s/iter; left time: 648.8017s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0202s/iter; left time: 611.7312s
	iters: 400, epoch: 27 | loss: 0.0041113
	speed: 0.0217s/iter; left time: 653.4794s
Epoch: 27 cost time: 9.185038805007935
Epoch: 27, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.168 Vali Acc: 0.978 Test Loss: 0.168 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000012
	speed: 0.0725s/iter; left time: 2179.7600s
	iters: 200, epoch: 28 | loss: 0.7386172
	speed: 0.0211s/iter; left time: 631.1611s
	iters: 300, epoch: 28 | loss: 0.5101635
	speed: 0.0201s/iter; left time: 601.3730s
	iters: 400, epoch: 28 | loss: 0.0000007
	speed: 0.0207s/iter; left time: 615.6982s
Epoch: 28 cost time: 8.951714277267456
Epoch: 28, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.183 Vali Acc: 0.976 Test Loss: 0.183 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.0710s/iter; left time: 2104.9653s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 632.2596s
	iters: 300, epoch: 29 | loss: 0.0000002
	speed: 0.0213s/iter; left time: 627.8237s
	iters: 400, epoch: 29 | loss: 0.0000001
	speed: 0.0212s/iter; left time: 622.6116s
Epoch: 29 cost time: 9.18946886062622
Epoch: 29, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.985 Test Loss: 0.095 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.985447).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000019
	speed: 0.0709s/iter; left time: 2071.7809s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 627.6922s
	iters: 300, epoch: 30 | loss: 0.0000001
	speed: 0.0220s/iter; left time: 638.6667s
	iters: 400, epoch: 30 | loss: 0.0001168
	speed: 0.0212s/iter; left time: 613.0157s
Epoch: 30 cost time: 9.254667282104492
Epoch: 30, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.978 Test Loss: 0.170 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000001
	speed: 0.0677s/iter; left time: 1950.8576s
	iters: 200, epoch: 31 | loss: 0.0000056
	speed: 0.0218s/iter; left time: 624.5395s
	iters: 300, epoch: 31 | loss: 0.0011590
	speed: 0.0220s/iter; left time: 629.7774s
	iters: 400, epoch: 31 | loss: 0.0000011
	speed: 0.0207s/iter; left time: 591.2675s
Epoch: 31 cost time: 9.256028652191162
Epoch: 31, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.138 Vali Acc: 0.982 Test Loss: 0.138 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 2040.8680s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 629.9443s
	iters: 300, epoch: 32 | loss: 0.0000041
	speed: 0.0215s/iter; left time: 607.6601s
	iters: 400, epoch: 32 | loss: 0.0910472
	speed: 0.0224s/iter; left time: 629.7405s
Epoch: 32 cost time: 9.459418535232544
Epoch: 32, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000008
	speed: 0.0740s/iter; left time: 2069.8105s
	iters: 200, epoch: 33 | loss: 0.0000004
	speed: 0.0206s/iter; left time: 574.5891s
	iters: 300, epoch: 33 | loss: 0.0384308
	speed: 0.0216s/iter; left time: 599.3886s
	iters: 400, epoch: 33 | loss: 0.0000001
	speed: 0.0215s/iter; left time: 594.2469s
Epoch: 33 cost time: 9.342437505722046
Epoch: 33, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.984 Test Loss: 0.173 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 1979.6303s
	iters: 200, epoch: 34 | loss: 0.0000002
	speed: 0.0217s/iter; left time: 595.3963s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 588.3507s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 582.6698s
Epoch: 34 cost time: 9.210892677307129
Epoch: 34, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000001
	speed: 0.0754s/iter; left time: 2046.9856s
	iters: 200, epoch: 35 | loss: 0.0000007
	speed: 0.0221s/iter; left time: 598.0672s
	iters: 300, epoch: 35 | loss: 0.0000001
	speed: 0.0213s/iter; left time: 574.2008s
	iters: 400, epoch: 35 | loss: 0.0000003
	speed: 0.0217s/iter; left time: 583.4441s
Epoch: 35 cost time: 9.41113567352295
Epoch: 35, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.140 Vali Acc: 0.980 Test Loss: 0.140 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0007646
	speed: 0.0761s/iter; left time: 2035.1754s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 577.5486s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 564.7861s
	iters: 400, epoch: 36 | loss: 0.0000001
	speed: 0.0208s/iter; left time: 550.1773s
Epoch: 36 cost time: 9.137099027633667
Epoch: 36, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.306 Vali Acc: 0.972 Test Loss: 0.306 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0000198
	speed: 0.0786s/iter; left time: 2070.5570s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 570.6729s
	iters: 300, epoch: 37 | loss: 0.0000021
	speed: 0.0214s/iter; left time: 558.9758s
	iters: 400, epoch: 37 | loss: 0.4165931
	speed: 0.0208s/iter; left time: 540.9756s
Epoch: 37 cost time: 9.263519525527954
Epoch: 37, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.979 Test Loss: 0.192 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 1.0171647
	speed: 0.0777s/iter; left time: 2012.8928s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 556.4549s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0202s/iter; left time: 519.2135s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 553.3214s
Epoch: 38 cost time: 9.065427303314209
Epoch: 38, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.162 Vali Acc: 0.983 Test Loss: 0.162 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0009106
	speed: 0.0748s/iter; left time: 1908.9255s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 556.8174s
	iters: 300, epoch: 39 | loss: 0.0000001
	speed: 0.0225s/iter; left time: 568.6235s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 567.1931s
Epoch: 39 cost time: 9.353679656982422
Epoch: 39, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.971 Test Loss: 0.206 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 686030
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5036216
	speed: 0.0370s/iter; left time: 1526.1075s
	iters: 200, epoch: 1 | loss: 0.0794811
	speed: 0.0213s/iter; left time: 877.1139s
	iters: 300, epoch: 1 | loss: 0.1137855
	speed: 0.0212s/iter; left time: 869.4689s
	iters: 400, epoch: 1 | loss: 0.0184214
	speed: 0.0222s/iter; left time: 909.9027s
Epoch: 1 cost time: 10.541415214538574
Epoch: 1, Steps: 413 | Train Loss: 0.407 Vali Loss: 0.090 Vali Acc: 0.971 Test Loss: 0.090 Test Acc: 0.971
Validation loss decreased (inf --> -0.971350).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1185471
	speed: 0.0725s/iter; left time: 2956.0950s
	iters: 200, epoch: 2 | loss: 0.0290575
	speed: 0.0218s/iter; left time: 884.9954s
	iters: 300, epoch: 2 | loss: 0.0108776
	speed: 0.0222s/iter; left time: 900.6585s
	iters: 400, epoch: 2 | loss: 0.0366425
	speed: 0.0227s/iter; left time: 918.1476s
Epoch: 2 cost time: 9.492627382278442
Epoch: 2, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.066 Vali Acc: 0.975 Test Loss: 0.066 Test Acc: 0.975
Validation loss decreased (-0.971350 --> -0.974988).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0376656
	speed: 0.0715s/iter; left time: 2887.0189s
	iters: 200, epoch: 3 | loss: 0.3288083
	speed: 0.0201s/iter; left time: 809.0162s
	iters: 300, epoch: 3 | loss: 0.0025491
	speed: 0.0207s/iter; left time: 832.5245s
	iters: 400, epoch: 3 | loss: 0.2773120
	speed: 0.0210s/iter; left time: 843.0641s
Epoch: 3 cost time: 8.979791402816772
Epoch: 3, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.974988 --> -0.981354).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0205076
	speed: 0.0752s/iter; left time: 3006.0600s
	iters: 200, epoch: 4 | loss: 0.0005388
	speed: 0.0203s/iter; left time: 811.1561s
	iters: 300, epoch: 4 | loss: 0.0814228
	speed: 0.0211s/iter; left time: 840.1757s
	iters: 400, epoch: 4 | loss: 0.0124884
	speed: 0.0218s/iter; left time: 863.5183s
Epoch: 4 cost time: 9.070254802703857
Epoch: 4, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0014737
	speed: 0.0774s/iter; left time: 3062.9679s
	iters: 200, epoch: 5 | loss: 0.2639362
	speed: 0.0210s/iter; left time: 827.9518s
	iters: 300, epoch: 5 | loss: 0.0003121
	speed: 0.0213s/iter; left time: 837.9580s
	iters: 400, epoch: 5 | loss: 0.0025680
	speed: 0.0206s/iter; left time: 809.6842s
Epoch: 5 cost time: 9.045349597930908
Epoch: 5, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0001273
	speed: 0.0722s/iter; left time: 2825.3213s
	iters: 200, epoch: 6 | loss: 0.0019852
	speed: 0.0195s/iter; left time: 760.0183s
	iters: 300, epoch: 6 | loss: 0.0421029
	speed: 0.0213s/iter; left time: 829.0474s
	iters: 400, epoch: 6 | loss: 0.0001883
	speed: 0.0224s/iter; left time: 869.5450s
Epoch: 6 cost time: 9.041431903839111
Epoch: 6, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000055
	speed: 0.0730s/iter; left time: 2827.7598s
	iters: 200, epoch: 7 | loss: 0.0000503
	speed: 0.0189s/iter; left time: 729.0809s
	iters: 300, epoch: 7 | loss: 0.0012025
	speed: 0.0200s/iter; left time: 770.0300s
	iters: 400, epoch: 7 | loss: 0.0000020
	speed: 0.0217s/iter; left time: 835.5730s
Epoch: 7 cost time: 8.71150803565979
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0043114
	speed: 0.0647s/iter; left time: 2480.2481s
	iters: 200, epoch: 8 | loss: 0.0000001
	speed: 0.0211s/iter; left time: 805.6835s
	iters: 300, epoch: 8 | loss: 0.2872002
	speed: 0.0227s/iter; left time: 866.0511s
	iters: 400, epoch: 8 | loss: 0.0009976
	speed: 0.0214s/iter; left time: 814.0495s
Epoch: 8 cost time: 9.411351919174194
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0093803
	speed: 0.0663s/iter; left time: 2514.2069s
	iters: 200, epoch: 9 | loss: 0.0008440
	speed: 0.0215s/iter; left time: 813.8581s
	iters: 300, epoch: 9 | loss: 0.0242990
	speed: 0.0213s/iter; left time: 803.9275s
	iters: 400, epoch: 9 | loss: 0.0000334
	speed: 0.0221s/iter; left time: 832.1740s
Epoch: 9 cost time: 9.201164484024048
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.180 Vali Acc: 0.969 Test Loss: 0.180 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0708s/iter; left time: 2653.4002s
	iters: 200, epoch: 10 | loss: 0.0519741
	speed: 0.0217s/iter; left time: 811.3105s
	iters: 300, epoch: 10 | loss: 0.0002877
	speed: 0.0236s/iter; left time: 878.5465s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0220s/iter; left time: 816.7862s
Epoch: 10 cost time: 9.443392753601074
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000107
	speed: 0.0739s/iter; left time: 2739.0646s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0228s/iter; left time: 842.2914s
	iters: 300, epoch: 11 | loss: 0.0001079
	speed: 0.0243s/iter; left time: 894.4839s
	iters: 400, epoch: 11 | loss: 0.0000712
	speed: 0.0219s/iter; left time: 803.5286s
Epoch: 11 cost time: 9.890129089355469
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000119
	speed: 0.0736s/iter; left time: 2698.6057s
	iters: 200, epoch: 12 | loss: 0.0067995
	speed: 0.0210s/iter; left time: 767.0127s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 771.6587s
	iters: 400, epoch: 12 | loss: 0.0000607
	speed: 0.0218s/iter; left time: 791.2175s
Epoch: 12 cost time: 9.346250057220459
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.165 Vali Acc: 0.974 Test Loss: 0.165 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000007
	speed: 0.0862s/iter; left time: 3126.0485s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 788.9038s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0220s/iter; left time: 792.6146s
	iters: 400, epoch: 13 | loss: 0.0003242
	speed: 0.0233s/iter; left time: 836.8586s
Epoch: 13 cost time: 9.630014657974243
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 423886
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5373402
	speed: 0.0392s/iter; left time: 1616.6259s
	iters: 200, epoch: 1 | loss: 0.1070448
	speed: 0.0232s/iter; left time: 954.9708s
	iters: 300, epoch: 1 | loss: 0.1000667
	speed: 0.0205s/iter; left time: 838.7778s
	iters: 400, epoch: 1 | loss: 0.0306016
	speed: 0.0213s/iter; left time: 869.7783s
Epoch: 1 cost time: 10.780519723892212
Epoch: 1, Steps: 413 | Train Loss: 0.424 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (inf --> -0.974533).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1400287
	speed: 0.0722s/iter; left time: 2946.6884s
	iters: 200, epoch: 2 | loss: 0.0389557
	speed: 0.0209s/iter; left time: 848.4483s
	iters: 300, epoch: 2 | loss: 0.0175250
	speed: 0.0219s/iter; left time: 888.6356s
	iters: 400, epoch: 2 | loss: 0.0305095
	speed: 0.0209s/iter; left time: 846.7060s
Epoch: 2 cost time: 8.98928713798523
Epoch: 2, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.067 Vali Acc: 0.979 Test Loss: 0.067 Test Acc: 0.979
Validation loss decreased (-0.974533 --> -0.979081).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0216024
	speed: 0.0685s/iter; left time: 2766.4871s
	iters: 200, epoch: 3 | loss: 0.0906124
	speed: 0.0206s/iter; left time: 829.7258s
	iters: 300, epoch: 3 | loss: 0.0201613
	speed: 0.0222s/iter; left time: 892.2902s
	iters: 400, epoch: 3 | loss: 0.0110035
	speed: 0.0217s/iter; left time: 870.0312s
Epoch: 3 cost time: 9.273506164550781
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
Validation loss decreased (-0.979081 --> -0.981809).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0331864
	speed: 0.0683s/iter; left time: 2729.2107s
	iters: 200, epoch: 4 | loss: 0.0010032
	speed: 0.0221s/iter; left time: 879.9967s
	iters: 300, epoch: 4 | loss: 0.0147804
	speed: 0.0218s/iter; left time: 866.4483s
	iters: 400, epoch: 4 | loss: 0.0046248
	speed: 0.0210s/iter; left time: 833.9740s
Epoch: 4 cost time: 9.06135368347168
Epoch: 4, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0033176
	speed: 0.0697s/iter; left time: 2756.6819s
	iters: 200, epoch: 5 | loss: 0.0030157
	speed: 0.0211s/iter; left time: 834.3357s
	iters: 300, epoch: 5 | loss: 0.0258443
	speed: 0.0200s/iter; left time: 788.1799s
	iters: 400, epoch: 5 | loss: 0.0017056
	speed: 0.0204s/iter; left time: 801.9039s
Epoch: 5 cost time: 8.82936692237854
Epoch: 5, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0101611
	speed: 0.0679s/iter; left time: 2658.9336s
	iters: 200, epoch: 6 | loss: 0.0042424
	speed: 0.0203s/iter; left time: 793.0828s
	iters: 300, epoch: 6 | loss: 0.0011600
	speed: 0.0205s/iter; left time: 798.1460s
	iters: 400, epoch: 6 | loss: 0.0014158
	speed: 0.0202s/iter; left time: 782.6027s
Epoch: 6 cost time: 8.655801057815552
Epoch: 6, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0007179
	speed: 0.0680s/iter; left time: 2634.6607s
	iters: 200, epoch: 7 | loss: 0.0000808
	speed: 0.0208s/iter; left time: 802.3290s
	iters: 300, epoch: 7 | loss: 0.0017459
	speed: 0.0221s/iter; left time: 850.5030s
	iters: 400, epoch: 7 | loss: 0.0000008
	speed: 0.0220s/iter; left time: 845.6088s
Epoch: 7 cost time: 9.132262945175171
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0004966
	speed: 0.0772s/iter; left time: 2956.6924s
	iters: 200, epoch: 8 | loss: 0.0000149
	speed: 0.0228s/iter; left time: 870.7169s
	iters: 300, epoch: 8 | loss: 0.2039784
	speed: 0.0218s/iter; left time: 828.9236s
	iters: 400, epoch: 8 | loss: 0.0025193
	speed: 0.0225s/iter; left time: 855.1492s
Epoch: 8 cost time: 9.738576412200928
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0128816
	speed: 0.0754s/iter; left time: 2856.8674s
	iters: 200, epoch: 9 | loss: 0.0135987
	speed: 0.0205s/iter; left time: 773.9141s
	iters: 300, epoch: 9 | loss: 0.0002032
	speed: 0.0228s/iter; left time: 859.8355s
	iters: 400, epoch: 9 | loss: 0.0002171
	speed: 0.0214s/iter; left time: 805.3170s
Epoch: 9 cost time: 9.315561056137085
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.223 Vali Acc: 0.956 Test Loss: 0.223 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000006
	speed: 0.0739s/iter; left time: 2768.6642s
	iters: 200, epoch: 10 | loss: 0.1273720
	speed: 0.0227s/iter; left time: 847.7757s
	iters: 300, epoch: 10 | loss: 0.8932152
	speed: 0.0215s/iter; left time: 800.1082s
	iters: 400, epoch: 10 | loss: 0.0000261
	speed: 0.0213s/iter; left time: 792.3167s
Epoch: 10 cost time: 9.322957754135132
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0142033
	speed: 0.0796s/iter; left time: 2951.0407s
	iters: 200, epoch: 11 | loss: 0.0001292
	speed: 0.0210s/iter; left time: 774.5498s
	iters: 300, epoch: 11 | loss: 0.0000023
	speed: 0.0210s/iter; left time: 775.5960s
	iters: 400, epoch: 11 | loss: 0.0000004
	speed: 0.0224s/iter; left time: 823.6888s
Epoch: 11 cost time: 9.2634756565094
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0005132
	speed: 0.0745s/iter; left time: 2732.7839s
	iters: 200, epoch: 12 | loss: 0.0000038
	speed: 0.0207s/iter; left time: 754.9255s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 795.9676s
	iters: 400, epoch: 12 | loss: 0.0001315
	speed: 0.0208s/iter; left time: 757.7217s
Epoch: 12 cost time: 9.092465162277222
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.235 Vali Acc: 0.964 Test Loss: 0.235 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.0710s/iter; left time: 2572.6541s
	iters: 200, epoch: 13 | loss: 0.0007771
	speed: 0.0210s/iter; left time: 758.8074s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0207s/iter; left time: 746.2549s
	iters: 400, epoch: 13 | loss: 0.0000023
	speed: 0.0212s/iter; left time: 761.9511s
Epoch: 13 cost time: 8.930502653121948
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.189 Vali Acc: 0.969 Test Loss: 0.189 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 423886
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6001951
	speed: 0.0367s/iter; left time: 1512.7861s
	iters: 200, epoch: 1 | loss: 0.1508460
	speed: 0.0219s/iter; left time: 901.5488s
	iters: 300, epoch: 1 | loss: 0.0924951
	speed: 0.0230s/iter; left time: 941.4373s
	iters: 400, epoch: 1 | loss: 0.0494165
	speed: 0.0219s/iter; left time: 894.3406s
Epoch: 1 cost time: 10.690265655517578
Epoch: 1, Steps: 413 | Train Loss: 0.459 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (inf --> -0.969985).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1260667
	speed: 0.0687s/iter; left time: 2803.5942s
	iters: 200, epoch: 2 | loss: 0.0399299
	speed: 0.0201s/iter; left time: 819.3472s
	iters: 300, epoch: 2 | loss: 0.0255521
	speed: 0.0215s/iter; left time: 872.8483s
	iters: 400, epoch: 2 | loss: 0.0374124
	speed: 0.0218s/iter; left time: 881.4414s
Epoch: 2 cost time: 8.981325626373291
Epoch: 2, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
Validation loss decreased (-0.969985 --> -0.974533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0095178
	speed: 0.0730s/iter; left time: 2947.7403s
	iters: 200, epoch: 3 | loss: 0.0575231
	speed: 0.0211s/iter; left time: 850.2955s
	iters: 300, epoch: 3 | loss: 0.0034309
	speed: 0.0216s/iter; left time: 868.3364s
	iters: 400, epoch: 3 | loss: 0.0031836
	speed: 0.0226s/iter; left time: 906.2534s
Epoch: 3 cost time: 9.350391864776611
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
Validation loss decreased (-0.974533 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0289836
	speed: 0.0725s/iter; left time: 2896.8189s
	iters: 200, epoch: 4 | loss: 0.0006521
	speed: 0.0216s/iter; left time: 859.7357s
	iters: 300, epoch: 4 | loss: 0.0024479
	speed: 0.0206s/iter; left time: 818.3770s
	iters: 400, epoch: 4 | loss: 0.0199630
	speed: 0.0214s/iter; left time: 848.5916s
Epoch: 4 cost time: 9.11182951927185
Epoch: 4, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0028588
	speed: 0.0766s/iter; left time: 3027.6244s
	iters: 200, epoch: 5 | loss: 0.0028865
	speed: 0.0205s/iter; left time: 808.4582s
	iters: 300, epoch: 5 | loss: 0.0059362
	speed: 0.0214s/iter; left time: 842.6298s
	iters: 400, epoch: 5 | loss: 0.0050928
	speed: 0.0202s/iter; left time: 794.1393s
Epoch: 5 cost time: 8.98087739944458
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0049095
	speed: 0.0718s/iter; left time: 2811.4425s
	iters: 200, epoch: 6 | loss: 0.0000915
	speed: 0.0214s/iter; left time: 835.5296s
	iters: 300, epoch: 6 | loss: 0.0001338
	speed: 0.0226s/iter; left time: 880.0411s
	iters: 400, epoch: 6 | loss: 0.0035563
	speed: 0.0214s/iter; left time: 829.4152s
Epoch: 6 cost time: 9.283230543136597
Epoch: 6, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0925816
	speed: 0.0673s/iter; left time: 2607.7049s
	iters: 200, epoch: 7 | loss: 0.0000549
	speed: 0.0213s/iter; left time: 822.7332s
	iters: 300, epoch: 7 | loss: 0.0097063
	speed: 0.0212s/iter; left time: 818.4145s
	iters: 400, epoch: 7 | loss: 0.0000308
	speed: 0.0210s/iter; left time: 806.8173s
Epoch: 7 cost time: 9.069358348846436
Epoch: 7, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.979535).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0263192
	speed: 0.0668s/iter; left time: 2558.9464s
	iters: 200, epoch: 8 | loss: 0.0000690
	speed: 0.0216s/iter; left time: 826.6720s
	iters: 300, epoch: 8 | loss: 0.0000615
	speed: 0.0218s/iter; left time: 832.3165s
	iters: 400, epoch: 8 | loss: 0.0015102
	speed: 0.0220s/iter; left time: 837.4828s
Epoch: 8 cost time: 9.226438283920288
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0065350
	speed: 0.0695s/iter; left time: 2634.7683s
	iters: 200, epoch: 9 | loss: 0.0002987
	speed: 0.0217s/iter; left time: 821.4582s
	iters: 300, epoch: 9 | loss: 0.0000040
	speed: 0.0215s/iter; left time: 809.6607s
	iters: 400, epoch: 9 | loss: 0.0003150
	speed: 0.0217s/iter; left time: 817.0562s
Epoch: 9 cost time: 9.239747762680054
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000707
	speed: 0.0683s/iter; left time: 2561.5162s
	iters: 200, epoch: 10 | loss: 0.0000514
	speed: 0.0209s/iter; left time: 782.6495s
	iters: 300, epoch: 10 | loss: 0.0001449
	speed: 0.0216s/iter; left time: 806.9191s
	iters: 400, epoch: 10 | loss: 0.0004190
	speed: 0.0226s/iter; left time: 839.1890s
Epoch: 10 cost time: 9.150128841400146
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000065
	speed: 0.0738s/iter; left time: 2735.0697s
	iters: 200, epoch: 11 | loss: 0.0036004
	speed: 0.0191s/iter; left time: 706.6829s
	iters: 300, epoch: 11 | loss: 0.0000162
	speed: 0.0223s/iter; left time: 823.4696s
	iters: 400, epoch: 11 | loss: 0.0956500
	speed: 0.0216s/iter; left time: 794.7514s
Epoch: 11 cost time: 8.950699090957642
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979535 --> -0.979990).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0001157
	speed: 0.0781s/iter; left time: 2864.2804s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0215s/iter; left time: 784.5400s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0206s/iter; left time: 750.1086s
	iters: 400, epoch: 12 | loss: 0.0000466
	speed: 0.0215s/iter; left time: 782.1167s
Epoch: 12 cost time: 9.09864616394043
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979990 --> -0.979990).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000087
	speed: 0.0717s/iter; left time: 2600.4985s
	iters: 200, epoch: 13 | loss: 0.0000002
	speed: 0.0214s/iter; left time: 774.6248s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0213s/iter; left time: 768.4668s
	iters: 400, epoch: 13 | loss: 0.0020831
	speed: 0.0211s/iter; left time: 759.5466s
Epoch: 13 cost time: 9.077356338500977
Epoch: 13, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.969 Test Loss: 0.166 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000300
	speed: 0.0719s/iter; left time: 2576.8190s
	iters: 200, epoch: 14 | loss: 0.6899163
	speed: 0.0219s/iter; left time: 783.2048s
	iters: 300, epoch: 14 | loss: 0.0000043
	speed: 0.0226s/iter; left time: 804.7945s
	iters: 400, epoch: 14 | loss: 0.0000228
	speed: 0.0212s/iter; left time: 754.9329s
Epoch: 14 cost time: 9.283600091934204
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000057
	speed: 0.0725s/iter; left time: 2569.0605s
	iters: 200, epoch: 15 | loss: 0.0000520
	speed: 0.0212s/iter; left time: 747.7505s
	iters: 300, epoch: 15 | loss: 0.0000006
	speed: 0.0220s/iter; left time: 773.7405s
	iters: 400, epoch: 15 | loss: 0.0000002
	speed: 0.0216s/iter; left time: 757.9659s
Epoch: 15 cost time: 9.21518850326538
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.142 Vali Acc: 0.980 Test Loss: 0.142 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0005485
	speed: 0.0759s/iter; left time: 2658.0749s
	iters: 200, epoch: 16 | loss: 1.1292965
	speed: 0.0204s/iter; left time: 711.8286s
	iters: 300, epoch: 16 | loss: 0.0000039
	speed: 0.0207s/iter; left time: 720.6964s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 728.7585s
Epoch: 16 cost time: 9.053898096084595
Epoch: 16, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.978 Test Loss: 0.149 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0266581
	speed: 0.0747s/iter; left time: 2584.1085s
	iters: 200, epoch: 17 | loss: 0.0000002
	speed: 0.0207s/iter; left time: 713.6209s
	iters: 300, epoch: 17 | loss: 0.0000183
	speed: 0.0213s/iter; left time: 731.4776s
	iters: 400, epoch: 17 | loss: 0.0000269
	speed: 0.0208s/iter; left time: 712.5064s
Epoch: 17 cost time: 8.972049951553345
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
Validation loss decreased (-0.979990 --> -0.982264).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000026
	speed: 0.0695s/iter; left time: 2376.8189s
	iters: 200, epoch: 18 | loss: 0.0000074
	speed: 0.0204s/iter; left time: 696.2141s
	iters: 300, epoch: 18 | loss: 0.0000005
	speed: 0.0208s/iter; left time: 706.6426s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 714.5069s
Epoch: 18 cost time: 8.90922999382019
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0676s/iter; left time: 2283.5327s
	iters: 200, epoch: 19 | loss: 0.0335286
	speed: 0.0233s/iter; left time: 785.1142s
	iters: 300, epoch: 19 | loss: 0.0000073
	speed: 0.0208s/iter; left time: 697.3093s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 704.3796s
Epoch: 19 cost time: 9.28885293006897
Epoch: 19, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000006
	speed: 0.0701s/iter; left time: 2338.0131s
	iters: 200, epoch: 20 | loss: 0.0000231
	speed: 0.0222s/iter; left time: 737.4359s
	iters: 300, epoch: 20 | loss: 0.0398945
	speed: 0.0211s/iter; left time: 699.6864s
	iters: 400, epoch: 20 | loss: 0.0000094
	speed: 0.0201s/iter; left time: 663.8148s
Epoch: 20 cost time: 9.184688091278076
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.0718s/iter; left time: 2365.0722s
	iters: 200, epoch: 21 | loss: 0.0000042
	speed: 0.0204s/iter; left time: 670.6348s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.0206s/iter; left time: 675.0379s
	iters: 400, epoch: 21 | loss: 0.0040266
	speed: 0.0214s/iter; left time: 698.8000s
Epoch: 21 cost time: 8.989070653915405
Epoch: 21, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.176 Vali Acc: 0.978 Test Loss: 0.176 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 2467.9269s
	iters: 200, epoch: 22 | loss: 0.0000055
	speed: 0.0225s/iter; left time: 730.8011s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 692.1526s
	iters: 400, epoch: 22 | loss: 0.0000106
	speed: 0.0216s/iter; left time: 696.2910s
Epoch: 22 cost time: 9.351304769515991
Epoch: 22, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.204 Vali Acc: 0.978 Test Loss: 0.204 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000995
	speed: 0.0745s/iter; left time: 2392.0786s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 669.4497s
	iters: 300, epoch: 23 | loss: 0.0000012
	speed: 0.0215s/iter; left time: 685.2726s
	iters: 400, epoch: 23 | loss: 0.0000041
	speed: 0.0219s/iter; left time: 695.4618s
Epoch: 23 cost time: 9.134142637252808
Epoch: 23, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.972 Test Loss: 0.205 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0002755
	speed: 0.0762s/iter; left time: 2416.8224s
	iters: 200, epoch: 24 | loss: 0.0000466
	speed: 0.0228s/iter; left time: 720.9859s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 677.9576s
	iters: 400, epoch: 24 | loss: 0.0000007
	speed: 0.0211s/iter; left time: 661.8911s
Epoch: 24 cost time: 9.293057203292847
Epoch: 24, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.202 Vali Acc: 0.978 Test Loss: 0.202 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.2496122
	speed: 0.0771s/iter; left time: 2411.1276s
	iters: 200, epoch: 25 | loss: 0.0002978
	speed: 0.0188s/iter; left time: 585.3245s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.0222s/iter; left time: 688.7321s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 684.0461s
Epoch: 25 cost time: 9.065887451171875
Epoch: 25, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.152 Vali Acc: 0.981 Test Loss: 0.152 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0676s/iter; left time: 2086.9380s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0232s/iter; left time: 713.7909s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 670.4279s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0224s/iter; left time: 685.7292s
Epoch: 26 cost time: 9.354820966720581
Epoch: 26, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.136 Vali Acc: 0.982 Test Loss: 0.136 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0703s/iter; left time: 2140.7694s
	iters: 200, epoch: 27 | loss: 0.0000021
	speed: 0.0221s/iter; left time: 670.6011s
	iters: 300, epoch: 27 | loss: 0.0000004
	speed: 0.0225s/iter; left time: 681.4117s
	iters: 400, epoch: 27 | loss: 0.2367318
	speed: 0.0212s/iter; left time: 640.1223s
Epoch: 27 cost time: 9.386037349700928
Epoch: 27, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.986 Test Loss: 0.108 Test Acc: 0.986
Validation loss decreased (-0.982264 --> -0.985902).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000080
	speed: 0.0732s/iter; left time: 2198.7823s
	iters: 200, epoch: 28 | loss: 0.0000203
	speed: 0.0227s/iter; left time: 678.9479s
	iters: 300, epoch: 28 | loss: 0.0001847
	speed: 0.0212s/iter; left time: 632.4208s
	iters: 400, epoch: 28 | loss: 0.0001328
	speed: 0.0216s/iter; left time: 643.7772s
Epoch: 28 cost time: 9.35714840888977
Epoch: 28, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.986 Test Loss: 0.107 Test Acc: 0.986
Validation loss decreased (-0.985902 --> -0.986356).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000012
	speed: 0.0776s/iter; left time: 2299.4986s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 635.0155s
	iters: 300, epoch: 29 | loss: 0.4043988
	speed: 0.0215s/iter; left time: 631.4703s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 652.8803s
Epoch: 29 cost time: 9.352807998657227
Epoch: 29, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.137 Vali Acc: 0.985 Test Loss: 0.137 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000001
	speed: 0.0826s/iter; left time: 2413.6028s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 629.0086s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 620.7514s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 601.2360s
Epoch: 30 cost time: 9.290332078933716
Epoch: 30, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.985 Test Loss: 0.110 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 2359.8868s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 620.5703s
	iters: 300, epoch: 31 | loss: 0.0000005
	speed: 0.0221s/iter; left time: 633.2102s
	iters: 400, epoch: 31 | loss: 0.0000122
	speed: 0.0215s/iter; left time: 612.7111s
Epoch: 31 cost time: 9.383527517318726
Epoch: 31, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.981 Test Loss: 0.169 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 2039.9645s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 613.7653s
	iters: 300, epoch: 32 | loss: 0.0000025
	speed: 0.0218s/iter; left time: 615.2393s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 626.2389s
Epoch: 32 cost time: 9.370357513427734
Epoch: 32, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.982 Test Loss: 0.195 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0000479
	speed: 0.0741s/iter; left time: 2074.7975s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 588.9439s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 602.8244s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 613.9326s
Epoch: 33 cost time: 9.331781387329102
Epoch: 33, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.982 Test Loss: 0.160 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.0745s/iter; left time: 2054.2010s
	iters: 200, epoch: 34 | loss: 0.0012249
	speed: 0.0232s/iter; left time: 638.1167s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 586.5182s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0231s/iter; left time: 631.1617s
Epoch: 34 cost time: 9.600566387176514
Epoch: 34, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.166 Vali Acc: 0.982 Test Loss: 0.166 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0000013
	speed: 0.0713s/iter; left time: 1937.5154s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 578.9561s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 580.2636s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 596.9058s
Epoch: 35 cost time: 9.315584659576416
Epoch: 35, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.367 Vali Acc: 0.975 Test Loss: 0.367 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0000008
	speed: 0.0782s/iter; left time: 2091.8260s
	iters: 200, epoch: 36 | loss: 0.0594244
	speed: 0.0194s/iter; left time: 517.1717s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0246s/iter; left time: 651.9609s
	iters: 400, epoch: 36 | loss: 0.0000215
	speed: 0.0217s/iter; left time: 574.9823s
Epoch: 36 cost time: 9.463176250457764
Epoch: 36, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.127 Vali Acc: 0.982 Test Loss: 0.127 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.0757s/iter; left time: 1992.1483s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 569.0582s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 536.3323s
	iters: 400, epoch: 37 | loss: 0.0000475
	speed: 0.0216s/iter; left time: 563.0463s
Epoch: 37 cost time: 9.397694110870361
Epoch: 37, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.982 Test Loss: 0.182 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 1767.4186s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 558.9140s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 599.0577s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 567.0372s
Epoch: 38 cost time: 9.492818593978882
Epoch: 38, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.983 Test Loss: 0.233 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 423886
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8347405
	speed: 0.0414s/iter; left time: 1704.7474s
	iters: 200, epoch: 1 | loss: 0.2062935
	speed: 0.0210s/iter; left time: 864.3992s
	iters: 300, epoch: 1 | loss: 0.1170027
	speed: 0.0214s/iter; left time: 878.4287s
	iters: 400, epoch: 1 | loss: 0.0428125
	speed: 0.0211s/iter; left time: 863.7585s
Epoch: 1 cost time: 10.875850915908813
Epoch: 1, Steps: 413 | Train Loss: 0.546 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
Validation loss decreased (inf --> -0.974078).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1698212
	speed: 0.0699s/iter; left time: 2852.2641s
	iters: 200, epoch: 2 | loss: 0.0228896
	speed: 0.0224s/iter; left time: 911.8330s
	iters: 300, epoch: 2 | loss: 0.0186612
	speed: 0.0227s/iter; left time: 921.5144s
	iters: 400, epoch: 2 | loss: 0.0670679
	speed: 0.0216s/iter; left time: 875.6569s
Epoch: 2 cost time: 9.443901777267456
Epoch: 2, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.974078 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0479692
	speed: 0.0768s/iter; left time: 3102.0534s
	iters: 200, epoch: 3 | loss: 0.0234503
	speed: 0.0207s/iter; left time: 832.7845s
	iters: 300, epoch: 3 | loss: 0.0200281
	speed: 0.0219s/iter; left time: 881.5809s
	iters: 400, epoch: 3 | loss: 0.0358009
	speed: 0.0200s/iter; left time: 801.8163s
Epoch: 3 cost time: 9.065632581710815
Epoch: 3, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.978171).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0124495
	speed: 0.0767s/iter; left time: 3065.2869s
	iters: 200, epoch: 4 | loss: 0.1151636
	speed: 0.0208s/iter; left time: 830.4305s
	iters: 300, epoch: 4 | loss: 0.0517233
	speed: 0.0202s/iter; left time: 803.6222s
	iters: 400, epoch: 4 | loss: 0.0094097
	speed: 0.0206s/iter; left time: 817.2725s
Epoch: 4 cost time: 8.91777777671814
Epoch: 4, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0005704
	speed: 0.0705s/iter; left time: 2786.9241s
	iters: 200, epoch: 5 | loss: 0.0115362
	speed: 0.0204s/iter; left time: 804.1663s
	iters: 300, epoch: 5 | loss: 0.0007221
	speed: 0.0211s/iter; left time: 829.1912s
	iters: 400, epoch: 5 | loss: 0.0005088
	speed: 0.0204s/iter; left time: 802.5611s
Epoch: 5 cost time: 8.821691751480103
Epoch: 5, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0022320
	speed: 0.0668s/iter; left time: 2615.8981s
	iters: 200, epoch: 6 | loss: 0.0034354
	speed: 0.0200s/iter; left time: 782.0866s
	iters: 300, epoch: 6 | loss: 0.0289509
	speed: 0.0202s/iter; left time: 784.8206s
	iters: 400, epoch: 6 | loss: 0.0048202
	speed: 0.0196s/iter; left time: 761.8437s
Epoch: 6 cost time: 8.615717887878418
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0017436
	speed: 0.0709s/iter; left time: 2743.9685s
	iters: 200, epoch: 7 | loss: 0.0008955
	speed: 0.0199s/iter; left time: 769.1131s
	iters: 300, epoch: 7 | loss: 0.0003731
	speed: 0.0213s/iter; left time: 820.9224s
	iters: 400, epoch: 7 | loss: 0.0003681
	speed: 0.0205s/iter; left time: 785.8810s
Epoch: 7 cost time: 8.885521650314331
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.978171 --> -0.980900).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000051
	speed: 0.0702s/iter; left time: 2688.6048s
	iters: 200, epoch: 8 | loss: 0.0101914
	speed: 0.0199s/iter; left time: 760.3171s
	iters: 300, epoch: 8 | loss: 0.0000065
	speed: 0.0204s/iter; left time: 776.2561s
	iters: 400, epoch: 8 | loss: 0.2351970
	speed: 0.0213s/iter; left time: 809.4009s
Epoch: 8 cost time: 8.86958360671997
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0011792
	speed: 0.0718s/iter; left time: 2721.4151s
	iters: 200, epoch: 9 | loss: 0.0000324
	speed: 0.0201s/iter; left time: 761.1616s
	iters: 300, epoch: 9 | loss: 0.1124625
	speed: 0.0198s/iter; left time: 746.7237s
	iters: 400, epoch: 9 | loss: 0.0125383
	speed: 0.0194s/iter; left time: 728.6352s
Epoch: 9 cost time: 8.705003023147583
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000024
	speed: 0.0738s/iter; left time: 2765.4556s
	iters: 200, epoch: 10 | loss: 0.0018332
	speed: 0.0201s/iter; left time: 750.1698s
	iters: 300, epoch: 10 | loss: 0.0000040
	speed: 0.0187s/iter; left time: 698.8817s
	iters: 400, epoch: 10 | loss: 0.0000093
	speed: 0.0193s/iter; left time: 718.1627s
Epoch: 10 cost time: 8.507460594177246
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0061773
	speed: 0.0753s/iter; left time: 2790.5303s
	iters: 200, epoch: 11 | loss: 0.0000463
	speed: 0.0189s/iter; left time: 698.9277s
	iters: 300, epoch: 11 | loss: 0.0000065
	speed: 0.0193s/iter; left time: 710.3794s
	iters: 400, epoch: 11 | loss: 0.0189384
	speed: 0.0181s/iter; left time: 667.2836s
Epoch: 11 cost time: 8.32014274597168
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000031
	speed: 0.0709s/iter; left time: 2597.2247s
	iters: 200, epoch: 12 | loss: 0.0000016
	speed: 0.0205s/iter; left time: 747.8017s
	iters: 300, epoch: 12 | loss: 0.0000008
	speed: 0.0198s/iter; left time: 720.8239s
	iters: 400, epoch: 12 | loss: 0.0004594
	speed: 0.0202s/iter; left time: 733.9899s
Epoch: 12 cost time: 8.671181678771973
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.212 Vali Acc: 0.969 Test Loss: 0.212 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.0704s/iter; left time: 2552.8396s
	iters: 200, epoch: 13 | loss: 0.0000268
	speed: 0.0191s/iter; left time: 691.8225s
	iters: 300, epoch: 13 | loss: 0.0092151
	speed: 0.0200s/iter; left time: 719.6841s
	iters: 400, epoch: 13 | loss: 0.0000067
	speed: 0.0199s/iter; left time: 714.1750s
Epoch: 13 cost time: 8.703953742980957
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.971 Test Loss: 0.181 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000005
	speed: 0.0675s/iter; left time: 2417.8821s
	iters: 200, epoch: 14 | loss: 0.0007565
	speed: 0.0209s/iter; left time: 746.9743s
	iters: 300, epoch: 14 | loss: 0.0000022
	speed: 0.0204s/iter; left time: 726.0311s
	iters: 400, epoch: 14 | loss: 0.0013351
	speed: 0.0209s/iter; left time: 742.3957s
Epoch: 14 cost time: 8.665642499923706
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.980900 --> -0.982718).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000031
	speed: 0.0685s/iter; left time: 2425.7176s
	iters: 200, epoch: 15 | loss: 0.0022544
	speed: 0.0195s/iter; left time: 690.4582s
	iters: 300, epoch: 15 | loss: 0.0000038
	speed: 0.0199s/iter; left time: 701.0656s
	iters: 400, epoch: 15 | loss: 0.0000073
	speed: 0.0187s/iter; left time: 657.1383s
Epoch: 15 cost time: 8.580032587051392
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0145596
	speed: 0.0710s/iter; left time: 2485.2079s
	iters: 200, epoch: 16 | loss: 0.0001763
	speed: 0.0185s/iter; left time: 644.5702s
	iters: 300, epoch: 16 | loss: 0.0000049
	speed: 0.0195s/iter; left time: 678.2911s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0190s/iter; left time: 658.8749s
Epoch: 16 cost time: 8.341496467590332
Epoch: 16, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000043
	speed: 0.0724s/iter; left time: 2503.1239s
	iters: 200, epoch: 17 | loss: 0.0001927
	speed: 0.0194s/iter; left time: 670.0840s
	iters: 300, epoch: 17 | loss: 0.0000011
	speed: 0.0192s/iter; left time: 660.3235s
	iters: 400, epoch: 17 | loss: 0.0000003
	speed: 0.0187s/iter; left time: 641.9058s
Epoch: 17 cost time: 8.35461688041687
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.982718 --> -0.983173).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000008
	speed: 0.0724s/iter; left time: 2474.1409s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0183s/iter; left time: 623.7716s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0183s/iter; left time: 622.7687s
	iters: 400, epoch: 18 | loss: 0.0084895
	speed: 0.0206s/iter; left time: 697.0931s
Epoch: 18 cost time: 8.323731899261475
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 2323.1580s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0204s/iter; left time: 687.8888s
	iters: 300, epoch: 19 | loss: 0.0000083
	speed: 0.0202s/iter; left time: 677.9916s
	iters: 400, epoch: 19 | loss: 0.0000455
	speed: 0.0199s/iter; left time: 666.6142s
Epoch: 19 cost time: 8.738925695419312
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0001715
	speed: 0.0750s/iter; left time: 2502.1995s
	iters: 200, epoch: 20 | loss: 0.0000768
	speed: 0.0194s/iter; left time: 644.2402s
	iters: 300, epoch: 20 | loss: 0.0000002
	speed: 0.0198s/iter; left time: 658.0481s
	iters: 400, epoch: 20 | loss: 0.0000034
	speed: 0.0200s/iter; left time: 661.3834s
Epoch: 20 cost time: 8.615768432617188
Epoch: 20, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.983173 --> -0.985447).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000311
	speed: 0.0745s/iter; left time: 2455.1956s
	iters: 200, epoch: 21 | loss: 0.0000451
	speed: 0.0192s/iter; left time: 630.5594s
	iters: 300, epoch: 21 | loss: 0.0002315
	speed: 0.0199s/iter; left time: 651.9341s
	iters: 400, epoch: 21 | loss: 0.0000032
	speed: 0.0195s/iter; left time: 637.6265s
Epoch: 21 cost time: 8.595438957214355
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.982 Test Loss: 0.121 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000003
	speed: 0.0685s/iter; left time: 2227.0102s
	iters: 200, epoch: 22 | loss: 0.0428324
	speed: 0.0201s/iter; left time: 653.1681s
	iters: 300, epoch: 22 | loss: 0.0000002
	speed: 0.0189s/iter; left time: 611.0269s
	iters: 400, epoch: 22 | loss: 0.0007357
	speed: 0.0194s/iter; left time: 624.8771s
Epoch: 22 cost time: 8.437742710113525
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 2358.6247s
	iters: 200, epoch: 23 | loss: 0.0000013
	speed: 0.0190s/iter; left time: 607.0974s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.0182s/iter; left time: 581.2649s
	iters: 400, epoch: 23 | loss: 0.0000096
	speed: 0.0194s/iter; left time: 618.0230s
Epoch: 23 cost time: 8.405657052993774
Epoch: 23, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000852
	speed: 0.0729s/iter; left time: 2311.9592s
	iters: 200, epoch: 24 | loss: 0.4448854
	speed: 0.0181s/iter; left time: 570.8240s
	iters: 300, epoch: 24 | loss: 0.6041436
	speed: 0.0190s/iter; left time: 598.8892s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0198s/iter; left time: 622.8703s
Epoch: 24 cost time: 8.386013984680176
Epoch: 24, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.981 Test Loss: 0.156 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000120
	speed: 0.0671s/iter; left time: 2098.7533s
	iters: 200, epoch: 25 | loss: 0.0006600
	speed: 0.0202s/iter; left time: 631.0295s
	iters: 300, epoch: 25 | loss: 0.4102971
	speed: 0.0196s/iter; left time: 608.2196s
	iters: 400, epoch: 25 | loss: 0.0000019
	speed: 0.0197s/iter; left time: 610.5703s
Epoch: 25 cost time: 8.63399076461792
Epoch: 25, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.063 Vali Acc: 0.988 Test Loss: 0.063 Test Acc: 0.988
Validation loss decreased (-0.985447 --> -0.987721).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0670s/iter; left time: 2069.0032s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 674.0151s
	iters: 300, epoch: 26 | loss: 0.0000275
	speed: 0.0214s/iter; left time: 657.8949s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 652.5229s
Epoch: 26 cost time: 9.150176048278809
Epoch: 26, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.985 Test Loss: 0.096 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0670s/iter; left time: 2039.9911s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 628.5309s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.0201s/iter; left time: 608.4981s
	iters: 400, epoch: 27 | loss: 0.0000034
	speed: 0.0198s/iter; left time: 596.9248s
Epoch: 27 cost time: 8.806362867355347
Epoch: 27, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.983 Test Loss: 0.124 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0000379
	speed: 0.0686s/iter; left time: 2062.8711s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 614.2025s
	iters: 300, epoch: 28 | loss: 0.0001652
	speed: 0.0197s/iter; left time: 587.6716s
	iters: 400, epoch: 28 | loss: 0.0000038
	speed: 0.0206s/iter; left time: 614.1776s
Epoch: 28 cost time: 8.74857234954834
Epoch: 28, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.985 Test Loss: 0.129 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0000003
	speed: 0.0676s/iter; left time: 2003.4254s
	iters: 200, epoch: 29 | loss: 0.0000013
	speed: 0.0193s/iter; left time: 569.8505s
	iters: 300, epoch: 29 | loss: 0.0082876
	speed: 0.0192s/iter; left time: 565.8422s
	iters: 400, epoch: 29 | loss: 0.0000029
	speed: 0.0192s/iter; left time: 563.6477s
Epoch: 29 cost time: 8.453838348388672
Epoch: 29, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.986 Test Loss: 0.102 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 2302.2412s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0193s/iter; left time: 561.4516s
	iters: 300, epoch: 30 | loss: 0.0000021
	speed: 0.0204s/iter; left time: 593.4540s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 604.3757s
Epoch: 30 cost time: 8.811415433883667
Epoch: 30, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.142 Vali Acc: 0.984 Test Loss: 0.142 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0005588
	speed: 0.0802s/iter; left time: 2311.1680s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 589.2877s
	iters: 300, epoch: 31 | loss: 0.0000004
	speed: 0.0200s/iter; left time: 573.4532s
	iters: 400, epoch: 31 | loss: 0.0000030
	speed: 0.0204s/iter; left time: 581.1858s
Epoch: 31 cost time: 8.919904708862305
Epoch: 31, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.164 Vali Acc: 0.982 Test Loss: 0.164 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 1879.4792s
	iters: 200, epoch: 32 | loss: 0.0000013
	speed: 0.0196s/iter; left time: 555.0706s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0189s/iter; left time: 533.7971s
	iters: 400, epoch: 32 | loss: 0.0000001
	speed: 0.0195s/iter; left time: 547.1505s
Epoch: 32 cost time: 8.430956840515137
Epoch: 32, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.987 Test Loss: 0.114 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.0692s/iter; left time: 1936.1842s
	iters: 200, epoch: 33 | loss: 0.0000001
	speed: 0.0195s/iter; left time: 542.7483s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0199s/iter; left time: 552.8707s
	iters: 400, epoch: 33 | loss: 0.0919139
	speed: 0.0198s/iter; left time: 549.1990s
Epoch: 33 cost time: 8.516515016555786
Epoch: 33, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.977 Test Loss: 0.221 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0000002
	speed: 0.0741s/iter; left time: 2043.5972s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 569.2531s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0196s/iter; left time: 537.0036s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0189s/iter; left time: 515.7873s
Epoch: 34 cost time: 8.682602643966675
Epoch: 34, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.318 Vali Acc: 0.969 Test Loss: 0.318 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0000001
	speed: 0.0669s/iter; left time: 1817.7788s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 554.2554s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0195s/iter; left time: 527.0142s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0193s/iter; left time: 518.1442s
Epoch: 35 cost time: 8.51912784576416
Epoch: 35, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.139 Vali Acc: 0.983 Test Loss: 0.139 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 423886
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4501790
	speed: 0.0365s/iter; left time: 1502.8537s
	iters: 200, epoch: 1 | loss: 0.1244048
	speed: 0.0191s/iter; left time: 786.4140s
	iters: 300, epoch: 1 | loss: 0.0648095
	speed: 0.0188s/iter; left time: 769.7908s
	iters: 400, epoch: 1 | loss: 0.2302183
	speed: 0.0194s/iter; left time: 793.0869s
Epoch: 1 cost time: 9.710026502609253
Epoch: 1, Steps: 413 | Train Loss: 0.404 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (inf --> -0.971804).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0373060
	speed: 0.0709s/iter; left time: 2893.5099s
	iters: 200, epoch: 2 | loss: 0.0044643
	speed: 0.0208s/iter; left time: 847.5613s
	iters: 300, epoch: 2 | loss: 0.0204859
	speed: 0.0206s/iter; left time: 835.9363s
	iters: 400, epoch: 2 | loss: 0.0063397
	speed: 0.0213s/iter; left time: 863.2998s
Epoch: 2 cost time: 9.054598569869995
Epoch: 2, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.077 Vali Acc: 0.971 Test Loss: 0.077 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0166306
	speed: 0.0698s/iter; left time: 2818.0095s
	iters: 200, epoch: 3 | loss: 0.0008351
	speed: 0.0218s/iter; left time: 879.0633s
	iters: 300, epoch: 3 | loss: 0.0104694
	speed: 0.0217s/iter; left time: 870.3311s
	iters: 400, epoch: 3 | loss: 0.0015611
	speed: 0.0220s/iter; left time: 880.2524s
Epoch: 3 cost time: 9.365844249725342
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
Validation loss decreased (-0.971804 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0006608
	speed: 0.0837s/iter; left time: 3346.7733s
	iters: 200, epoch: 4 | loss: 0.1162937
	speed: 0.0212s/iter; left time: 844.1468s
	iters: 300, epoch: 4 | loss: 0.0016419
	speed: 0.0228s/iter; left time: 906.4629s
	iters: 400, epoch: 4 | loss: 0.0008924
	speed: 0.0230s/iter; left time: 910.4895s
Epoch: 4 cost time: 9.690502166748047
Epoch: 4, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0023095
	speed: 0.0792s/iter; left time: 3132.0140s
	iters: 200, epoch: 5 | loss: 0.0007662
	speed: 0.0216s/iter; left time: 853.5762s
	iters: 300, epoch: 5 | loss: 0.0002221
	speed: 0.0206s/iter; left time: 809.4713s
	iters: 400, epoch: 5 | loss: 0.0059153
	speed: 0.0209s/iter; left time: 820.8757s
Epoch: 5 cost time: 9.142231941223145
Epoch: 5, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0004593
	speed: 0.0860s/iter; left time: 3367.0308s
	iters: 200, epoch: 6 | loss: 0.0005432
	speed: 0.0210s/iter; left time: 820.2376s
	iters: 300, epoch: 6 | loss: 0.0005052
	speed: 0.0217s/iter; left time: 843.4848s
	iters: 400, epoch: 6 | loss: 0.0139927
	speed: 0.0223s/iter; left time: 864.1146s
Epoch: 6 cost time: 9.612932682037354
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000136
	speed: 0.0828s/iter; left time: 3207.2108s
	iters: 200, epoch: 7 | loss: 0.0001569
	speed: 0.0220s/iter; left time: 848.4768s
	iters: 300, epoch: 7 | loss: 0.0000442
	speed: 0.0219s/iter; left time: 841.9310s
	iters: 400, epoch: 7 | loss: 0.0308950
	speed: 0.0202s/iter; left time: 775.7286s
Epoch: 7 cost time: 9.44469666481018
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0035787
	speed: 0.0765s/iter; left time: 2932.1963s
	iters: 200, epoch: 8 | loss: 0.0002280
	speed: 0.0206s/iter; left time: 787.9703s
	iters: 300, epoch: 8 | loss: 0.0002730
	speed: 0.0216s/iter; left time: 824.8870s
	iters: 400, epoch: 8 | loss: 0.0029760
	speed: 0.0209s/iter; left time: 795.0645s
Epoch: 8 cost time: 9.231037616729736
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.978626 --> -0.980445).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0003728
	speed: 0.0712s/iter; left time: 2697.1360s
	iters: 200, epoch: 9 | loss: 0.0000965
	speed: 0.0220s/iter; left time: 831.7999s
	iters: 300, epoch: 9 | loss: 0.0000310
	speed: 0.0219s/iter; left time: 825.3312s
	iters: 400, epoch: 9 | loss: 0.0039064
	speed: 0.0213s/iter; left time: 799.6231s
Epoch: 9 cost time: 9.336994647979736
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0107271
	speed: 0.0699s/iter; left time: 2620.3965s
	iters: 200, epoch: 10 | loss: 0.0003247
	speed: 0.0216s/iter; left time: 808.4488s
	iters: 300, epoch: 10 | loss: 0.0000028
	speed: 0.0225s/iter; left time: 840.5916s
	iters: 400, epoch: 10 | loss: 0.0000092
	speed: 0.0231s/iter; left time: 859.2173s
Epoch: 10 cost time: 9.575675964355469
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000068
	speed: 0.0721s/iter; left time: 2673.4819s
	iters: 200, epoch: 11 | loss: 0.0000319
	speed: 0.0209s/iter; left time: 773.5711s
	iters: 300, epoch: 11 | loss: 0.6323391
	speed: 0.0230s/iter; left time: 847.2164s
	iters: 400, epoch: 11 | loss: 0.0186879
	speed: 0.0215s/iter; left time: 790.3532s
Epoch: 11 cost time: 9.328012943267822
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0001283
	speed: 0.0721s/iter; left time: 2642.4683s
	iters: 200, epoch: 12 | loss: 0.0000008
	speed: 0.0213s/iter; left time: 778.9579s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0214s/iter; left time: 781.2831s
	iters: 400, epoch: 12 | loss: 0.0018520
	speed: 0.0210s/iter; left time: 764.1154s
Epoch: 12 cost time: 9.240475177764893
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0012246
	speed: 0.0806s/iter; left time: 2921.3069s
	iters: 200, epoch: 13 | loss: 0.0000150
	speed: 0.0213s/iter; left time: 768.9482s
	iters: 300, epoch: 13 | loss: 0.0002585
	speed: 0.0216s/iter; left time: 776.9501s
	iters: 400, epoch: 13 | loss: 0.0002726
	speed: 0.0226s/iter; left time: 812.9827s
Epoch: 13 cost time: 9.542945623397827
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0172166
	speed: 0.0874s/iter; left time: 3132.3709s
	iters: 200, epoch: 14 | loss: 0.0000017
	speed: 0.0215s/iter; left time: 769.2932s
	iters: 300, epoch: 14 | loss: 0.0000019
	speed: 0.0210s/iter; left time: 746.5633s
	iters: 400, epoch: 14 | loss: 0.0000006
	speed: 0.0223s/iter; left time: 792.1763s
Epoch: 14 cost time: 9.54625678062439
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.981354).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.0792s/iter; left time: 2803.9994s
	iters: 200, epoch: 15 | loss: 0.0080915
	speed: 0.0209s/iter; left time: 739.6515s
	iters: 300, epoch: 15 | loss: 0.0002145
	speed: 0.0214s/iter; left time: 752.5115s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 726.0220s
Epoch: 15 cost time: 9.22064471244812
Epoch: 15, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000030
	speed: 0.0800s/iter; left time: 2801.5723s
	iters: 200, epoch: 16 | loss: 0.0000006
	speed: 0.0236s/iter; left time: 822.5629s
	iters: 300, epoch: 16 | loss: 0.0000872
	speed: 0.0217s/iter; left time: 756.5054s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 757.8251s
Epoch: 16 cost time: 9.614201545715332
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000753
	speed: 0.0773s/iter; left time: 2675.7096s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 737.6327s
	iters: 300, epoch: 17 | loss: 0.0413673
	speed: 0.0220s/iter; left time: 756.7381s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0221s/iter; left time: 758.7625s
Epoch: 17 cost time: 9.261362791061401
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0029734
	speed: 0.0817s/iter; left time: 2791.7059s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0206s/iter; left time: 701.5493s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0198s/iter; left time: 673.3610s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 700.3216s
Epoch: 18 cost time: 9.019370555877686
Epoch: 18, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.981354 --> -0.982718).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 2549.4838s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0196s/iter; left time: 658.6686s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 686.9746s
	iters: 400, epoch: 19 | loss: 0.0000998
	speed: 0.0205s/iter; left time: 685.7023s
Epoch: 19 cost time: 8.788865327835083
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.0639s/iter; left time: 2130.2525s
	iters: 200, epoch: 20 | loss: 0.0000591
	speed: 0.0196s/iter; left time: 650.2869s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0203s/iter; left time: 672.4098s
	iters: 400, epoch: 20 | loss: 0.0000076
	speed: 0.0203s/iter; left time: 672.6422s
Epoch: 20 cost time: 8.634751558303833
Epoch: 20, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.982718 --> -0.983173).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0732s/iter; left time: 2410.6858s
	iters: 200, epoch: 21 | loss: 0.0098505
	speed: 0.0206s/iter; left time: 675.0683s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0207s/iter; left time: 678.5400s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 704.9979s
Epoch: 21 cost time: 9.263757228851318
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0021697
	speed: 0.0739s/iter; left time: 2403.8447s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 757.1054s
	iters: 300, epoch: 22 | loss: 0.0000020
	speed: 0.0225s/iter; left time: 728.3636s
	iters: 400, epoch: 22 | loss: 0.0368818
	speed: 0.0247s/iter; left time: 795.3169s
Epoch: 22 cost time: 10.112805366516113
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.985 Test Loss: 0.105 Test Acc: 0.985
Validation loss decreased (-0.983173 --> -0.984992).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 2440.5613s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 712.0123s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 694.3364s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 694.2009s
Epoch: 23 cost time: 9.702058553695679
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0002687
	speed: 0.0714s/iter; left time: 2261.9862s
	iters: 200, epoch: 24 | loss: 0.0000070
	speed: 0.0211s/iter; left time: 668.3465s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 674.0037s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 655.1005s
Epoch: 24 cost time: 9.06518840789795
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000017
	speed: 0.0891s/iter; left time: 2789.0450s
	iters: 200, epoch: 25 | loss: 0.0000004
	speed: 0.0214s/iter; left time: 667.5775s
	iters: 300, epoch: 25 | loss: 0.0074133
	speed: 0.0210s/iter; left time: 651.8962s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 669.6771s
Epoch: 25 cost time: 9.59587287902832
Epoch: 25, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.144 Vali Acc: 0.979 Test Loss: 0.144 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000712
	speed: 0.0862s/iter; left time: 2661.3360s
	iters: 200, epoch: 26 | loss: 0.0000010
	speed: 0.0215s/iter; left time: 661.9370s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.0237s/iter; left time: 725.8353s
	iters: 400, epoch: 26 | loss: 0.0000006
	speed: 0.0220s/iter; left time: 673.2808s
Epoch: 26 cost time: 9.715858459472656
Epoch: 26, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.088 Vali Acc: 0.986 Test Loss: 0.088 Test Acc: 0.986
Validation loss decreased (-0.984992 --> -0.986357).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 2290.5547s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 635.3964s
	iters: 300, epoch: 27 | loss: 0.0000010
	speed: 0.0201s/iter; left time: 607.7363s
	iters: 400, epoch: 27 | loss: 0.0000002
	speed: 0.0215s/iter; left time: 647.2810s
Epoch: 27 cost time: 9.090754985809326
Epoch: 27, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.976 Test Loss: 0.254 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000086
	speed: 0.0728s/iter; left time: 2187.7821s
	iters: 200, epoch: 28 | loss: 0.0000398
	speed: 0.0198s/iter; left time: 592.3298s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0184s/iter; left time: 550.4767s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0195s/iter; left time: 579.9903s
Epoch: 28 cost time: 8.416756868362427
Epoch: 28, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0665842
	speed: 0.0798s/iter; left time: 2364.3344s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0226s/iter; left time: 666.4298s
	iters: 300, epoch: 29 | loss: 0.0005225
	speed: 0.0222s/iter; left time: 654.8157s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0236s/iter; left time: 691.6865s
Epoch: 29 cost time: 9.877039909362793
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.149 Vali Acc: 0.982 Test Loss: 0.149 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0877959
	speed: 0.0709s/iter; left time: 2072.1201s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.0221s/iter; left time: 643.5154s
	iters: 300, epoch: 30 | loss: 0.0004632
	speed: 0.0215s/iter; left time: 623.1532s
	iters: 400, epoch: 30 | loss: 0.0000020
	speed: 0.0215s/iter; left time: 622.5965s
Epoch: 30 cost time: 9.38817572593689
Epoch: 30, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000001
	speed: 0.0722s/iter; left time: 2079.8394s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 641.6638s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 639.2871s
	iters: 400, epoch: 31 | loss: 0.0000021
	speed: 0.0213s/iter; left time: 607.6294s
Epoch: 31 cost time: 9.525061130523682
Epoch: 31, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.210 Vali Acc: 0.980 Test Loss: 0.210 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.0715s/iter; left time: 2030.1370s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 620.4550s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 600.9924s
	iters: 400, epoch: 32 | loss: 0.0000582
	speed: 0.0216s/iter; left time: 606.5142s
Epoch: 32 cost time: 9.593204259872437
Epoch: 32, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.229 Vali Acc: 0.977 Test Loss: 0.229 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2157.3590s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 626.3347s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 595.6605s
	iters: 400, epoch: 33 | loss: 0.0000012
	speed: 0.0208s/iter; left time: 575.9320s
Epoch: 33 cost time: 9.294480800628662
Epoch: 33, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.985 Test Loss: 0.126 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000302
	speed: 0.0828s/iter; left time: 2283.2573s
	iters: 200, epoch: 34 | loss: 0.0164242
	speed: 0.0222s/iter; left time: 608.9709s
	iters: 300, epoch: 34 | loss: 0.0000056
	speed: 0.0207s/iter; left time: 567.9546s
	iters: 400, epoch: 34 | loss: 0.0000013
	speed: 0.0204s/iter; left time: 556.9606s
Epoch: 34 cost time: 9.415688276290894
Epoch: 34, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 2108.1791s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 602.9819s
	iters: 300, epoch: 35 | loss: 0.0000394
	speed: 0.0215s/iter; left time: 580.2758s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 576.5612s
Epoch: 35 cost time: 9.419846534729004
Epoch: 35, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.978 Test Loss: 0.186 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 2134.0867s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 552.4248s
	iters: 300, epoch: 36 | loss: 0.0000010
	speed: 0.0226s/iter; left time: 598.9430s
	iters: 400, epoch: 36 | loss: 0.0002640
	speed: 0.0212s/iter; left time: 561.1173s
Epoch: 36 cost time: 9.410892724990845
Epoch: 36, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.979 Test Loss: 0.192 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 292814
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5187684
	speed: 0.0350s/iter; left time: 1443.3456s
	iters: 200, epoch: 1 | loss: 0.1263160
	speed: 0.0208s/iter; left time: 854.4105s
	iters: 300, epoch: 1 | loss: 0.0836915
	speed: 0.0220s/iter; left time: 901.3219s
	iters: 400, epoch: 1 | loss: 0.1882067
	speed: 0.0205s/iter; left time: 836.6578s
Epoch: 1 cost time: 10.163101196289062
Epoch: 1, Steps: 413 | Train Loss: 0.422 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
Validation loss decreased (inf --> -0.971804).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0289993
	speed: 0.0737s/iter; left time: 3007.7575s
	iters: 200, epoch: 2 | loss: 0.0051416
	speed: 0.0208s/iter; left time: 847.1181s
	iters: 300, epoch: 2 | loss: 0.0130614
	speed: 0.0217s/iter; left time: 881.5158s
	iters: 400, epoch: 2 | loss: 0.0101459
	speed: 0.0224s/iter; left time: 905.7809s
Epoch: 2 cost time: 9.267226696014404
Epoch: 2, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.081 Vali Acc: 0.971 Test Loss: 0.081 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0231577
	speed: 0.0725s/iter; left time: 2927.2444s
	iters: 200, epoch: 3 | loss: 0.0005153
	speed: 0.0207s/iter; left time: 832.8064s
	iters: 300, epoch: 3 | loss: 0.0051787
	speed: 0.0206s/iter; left time: 826.6087s
	iters: 400, epoch: 3 | loss: 0.0023692
	speed: 0.0206s/iter; left time: 827.1834s
Epoch: 3 cost time: 8.844931840896606
Epoch: 3, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.971804 --> -0.979536).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0013635
	speed: 0.0662s/iter; left time: 2645.5830s
	iters: 200, epoch: 4 | loss: 0.0112203
	speed: 0.0215s/iter; left time: 858.3810s
	iters: 300, epoch: 4 | loss: 0.0031603
	speed: 0.0223s/iter; left time: 886.9974s
	iters: 400, epoch: 4 | loss: 0.0003293
	speed: 0.0198s/iter; left time: 784.5099s
Epoch: 4 cost time: 9.106945514678955
Epoch: 4, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0002772
	speed: 0.0692s/iter; left time: 2737.4473s
	iters: 200, epoch: 5 | loss: 0.0004331
	speed: 0.0223s/iter; left time: 878.3486s
	iters: 300, epoch: 5 | loss: 0.0003016
	speed: 0.0232s/iter; left time: 913.2846s
	iters: 400, epoch: 5 | loss: 0.0041192
	speed: 0.0220s/iter; left time: 861.9608s
Epoch: 5 cost time: 9.491737842559814
Epoch: 5, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0001533
	speed: 0.0750s/iter; left time: 2935.3923s
	iters: 200, epoch: 6 | loss: 0.0252474
	speed: 0.0223s/iter; left time: 871.8319s
	iters: 300, epoch: 6 | loss: 0.0000326
	speed: 0.0210s/iter; left time: 818.7680s
	iters: 400, epoch: 6 | loss: 0.0009525
	speed: 0.0219s/iter; left time: 849.1465s
Epoch: 6 cost time: 9.461827278137207
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
Validation loss decreased (-0.979536 --> -0.981809).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000424
	speed: 0.0692s/iter; left time: 2679.3713s
	iters: 200, epoch: 7 | loss: 0.3034164
	speed: 0.0210s/iter; left time: 809.8136s
	iters: 300, epoch: 7 | loss: 0.3746156
	speed: 0.0210s/iter; left time: 810.5540s
	iters: 400, epoch: 7 | loss: 0.0021042
	speed: 0.0212s/iter; left time: 814.6692s
Epoch: 7 cost time: 8.927875280380249
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
Validation loss decreased (-0.981809 --> -0.984083).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0005551
	speed: 0.0765s/iter; left time: 2932.5096s
	iters: 200, epoch: 8 | loss: 0.2085180
	speed: 0.0199s/iter; left time: 759.3908s
	iters: 300, epoch: 8 | loss: 0.6496026
	speed: 0.0202s/iter; left time: 769.0313s
	iters: 400, epoch: 8 | loss: 0.0004012
	speed: 0.0219s/iter; left time: 831.2265s
Epoch: 8 cost time: 8.920320987701416
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000229
	speed: 0.0750s/iter; left time: 2843.4289s
	iters: 200, epoch: 9 | loss: 0.0007047
	speed: 0.0213s/iter; left time: 804.6106s
	iters: 300, epoch: 9 | loss: 0.0000286
	speed: 0.0199s/iter; left time: 750.9112s
	iters: 400, epoch: 9 | loss: 0.0000658
	speed: 0.0209s/iter; left time: 784.0510s
Epoch: 9 cost time: 8.958310842514038
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000553
	speed: 0.0674s/iter; left time: 2526.5955s
	iters: 200, epoch: 10 | loss: 0.0015272
	speed: 0.0217s/iter; left time: 812.0230s
	iters: 300, epoch: 10 | loss: 0.0000038
	speed: 0.0212s/iter; left time: 791.1000s
	iters: 400, epoch: 10 | loss: 0.0001954
	speed: 0.0216s/iter; left time: 804.4282s
Epoch: 10 cost time: 9.243974208831787
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000184
	speed: 0.0703s/iter; left time: 2606.9605s
	iters: 200, epoch: 11 | loss: 0.0000066
	speed: 0.0209s/iter; left time: 773.1315s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0230s/iter; left time: 846.3139s
	iters: 400, epoch: 11 | loss: 0.0001613
	speed: 0.0221s/iter; left time: 813.6122s
Epoch: 11 cost time: 9.35457968711853
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0009384
	speed: 0.0695s/iter; left time: 2547.0750s
	iters: 200, epoch: 12 | loss: 0.0000006
	speed: 0.0217s/iter; left time: 793.7524s
	iters: 300, epoch: 12 | loss: 0.0002404
	speed: 0.0213s/iter; left time: 776.4152s
	iters: 400, epoch: 12 | loss: 0.0001189
	speed: 0.0218s/iter; left time: 790.8566s
Epoch: 12 cost time: 9.246233463287354
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.152 Vali Acc: 0.976 Test Loss: 0.152 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000070
	speed: 0.0669s/iter; left time: 2425.5162s
	iters: 200, epoch: 13 | loss: 0.0016940
	speed: 0.0223s/iter; left time: 805.6399s
	iters: 300, epoch: 13 | loss: 0.0070824
	speed: 0.0233s/iter; left time: 839.2412s
	iters: 400, epoch: 13 | loss: 0.0639479
	speed: 0.0226s/iter; left time: 814.1028s
Epoch: 13 cost time: 9.460109949111938
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.981 Test Loss: 0.135 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0075133
	speed: 0.0815s/iter; left time: 2920.7284s
	iters: 200, epoch: 14 | loss: 0.0000239
	speed: 0.0214s/iter; left time: 765.0184s
	iters: 300, epoch: 14 | loss: 0.0017394
	speed: 0.0218s/iter; left time: 777.0248s
	iters: 400, epoch: 14 | loss: 0.0018268
	speed: 0.0220s/iter; left time: 780.9096s
Epoch: 14 cost time: 9.214125394821167
Epoch: 14, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0786s/iter; left time: 2785.1316s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 725.9932s
	iters: 300, epoch: 15 | loss: 0.0000012
	speed: 0.0202s/iter; left time: 712.1775s
	iters: 400, epoch: 15 | loss: 0.0000005
	speed: 0.0198s/iter; left time: 693.6633s
Epoch: 15 cost time: 8.789222002029419
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0125060
	speed: 0.0718s/iter; left time: 2514.0345s
	iters: 200, epoch: 16 | loss: 0.0000117
	speed: 0.0209s/iter; left time: 728.4551s
	iters: 300, epoch: 16 | loss: 0.0000016
	speed: 0.0216s/iter; left time: 752.8760s
	iters: 400, epoch: 16 | loss: 0.0003401
	speed: 0.0221s/iter; left time: 765.7455s
Epoch: 16 cost time: 9.123548030853271
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0001836
	speed: 0.0712s/iter; left time: 2464.5090s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 742.9743s
	iters: 300, epoch: 17 | loss: 0.0034297
	speed: 0.0202s/iter; left time: 695.0033s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0219s/iter; left time: 750.2311s
Epoch: 17 cost time: 9.092501163482666
Epoch: 17, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.984 Test Loss: 0.097 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 292814
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6477234
	speed: 0.0371s/iter; left time: 1527.7250s
	iters: 200, epoch: 1 | loss: 0.1286640
	speed: 0.0214s/iter; left time: 880.4699s
	iters: 300, epoch: 1 | loss: 0.0862645
	speed: 0.0210s/iter; left time: 862.3578s
	iters: 400, epoch: 1 | loss: 0.1645664
	speed: 0.0219s/iter; left time: 896.2705s
Epoch: 1 cost time: 10.532777070999146
Epoch: 1, Steps: 413 | Train Loss: 0.457 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0349110
	speed: 0.0751s/iter; left time: 3062.5712s
	iters: 200, epoch: 2 | loss: 0.0031064
	speed: 0.0223s/iter; left time: 909.1238s
	iters: 300, epoch: 2 | loss: 0.0172863
	speed: 0.0201s/iter; left time: 817.7535s
	iters: 400, epoch: 2 | loss: 0.0129216
	speed: 0.0210s/iter; left time: 849.0868s
Epoch: 2 cost time: 9.054717302322388
Epoch: 2, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.970895 --> -0.976807).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0182608
	speed: 0.0706s/iter; left time: 2848.7528s
	iters: 200, epoch: 3 | loss: 0.0006505
	speed: 0.0197s/iter; left time: 795.3881s
	iters: 300, epoch: 3 | loss: 0.0051835
	speed: 0.0204s/iter; left time: 819.4676s
	iters: 400, epoch: 3 | loss: 0.0086255
	speed: 0.0203s/iter; left time: 814.5592s
Epoch: 3 cost time: 8.883922100067139
Epoch: 3, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.976807 --> -0.979990).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0002051
	speed: 0.0754s/iter; left time: 3014.0265s
	iters: 200, epoch: 4 | loss: 0.0289107
	speed: 0.0215s/iter; left time: 855.4427s
	iters: 300, epoch: 4 | loss: 0.0042893
	speed: 0.0211s/iter; left time: 838.9857s
	iters: 400, epoch: 4 | loss: 0.0019726
	speed: 0.0222s/iter; left time: 880.4100s
Epoch: 4 cost time: 9.14300274848938
Epoch: 4, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.084 Vali Acc: 0.972 Test Loss: 0.084 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0019181
	speed: 0.0720s/iter; left time: 2848.0913s
	iters: 200, epoch: 5 | loss: 0.1615557
	speed: 0.0219s/iter; left time: 863.3794s
	iters: 300, epoch: 5 | loss: 0.0097073
	speed: 0.0216s/iter; left time: 850.1350s
	iters: 400, epoch: 5 | loss: 0.0413139
	speed: 0.0206s/iter; left time: 808.3185s
Epoch: 5 cost time: 9.15504240989685
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0006539
	speed: 0.0736s/iter; left time: 2878.4939s
	iters: 200, epoch: 6 | loss: 0.0008090
	speed: 0.0208s/iter; left time: 811.4768s
	iters: 300, epoch: 6 | loss: 0.0002909
	speed: 0.0207s/iter; left time: 804.2919s
	iters: 400, epoch: 6 | loss: 0.0081399
	speed: 0.0223s/iter; left time: 865.6513s
Epoch: 6 cost time: 9.14597463607788
Epoch: 6, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0006327
	speed: 0.0774s/iter; left time: 2995.4099s
	iters: 200, epoch: 7 | loss: 0.0001174
	speed: 0.0211s/iter; left time: 816.1412s
	iters: 300, epoch: 7 | loss: 0.0000576
	speed: 0.0225s/iter; left time: 867.1438s
	iters: 400, epoch: 7 | loss: 0.0002232
	speed: 0.0205s/iter; left time: 786.5868s
Epoch: 7 cost time: 9.196786880493164
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0173239
	speed: 0.0754s/iter; left time: 2887.0361s
	iters: 200, epoch: 8 | loss: 0.0053857
	speed: 0.0202s/iter; left time: 771.9663s
	iters: 300, epoch: 8 | loss: 0.0000609
	speed: 0.0206s/iter; left time: 784.6556s
	iters: 400, epoch: 8 | loss: 0.0001225
	speed: 0.0203s/iter; left time: 773.3640s
Epoch: 8 cost time: 8.81899380683899
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0017365
	speed: 0.0727s/iter; left time: 2753.4645s
	iters: 200, epoch: 9 | loss: 0.0001369
	speed: 0.0205s/iter; left time: 772.9797s
	iters: 300, epoch: 9 | loss: 0.0000067
	speed: 0.0198s/iter; left time: 744.9762s
	iters: 400, epoch: 9 | loss: 0.1040122
	speed: 0.0200s/iter; left time: 753.2066s
Epoch: 9 cost time: 8.730618476867676
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
Validation loss decreased (-0.979990 --> -0.984538).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0013148
	speed: 0.0743s/iter; left time: 2784.2100s
	iters: 200, epoch: 10 | loss: 0.0048258
	speed: 0.0207s/iter; left time: 775.0696s
	iters: 300, epoch: 10 | loss: 0.0000440
	speed: 0.0211s/iter; left time: 785.3875s
	iters: 400, epoch: 10 | loss: 0.0000127
	speed: 0.0211s/iter; left time: 783.8702s
Epoch: 10 cost time: 9.023230791091919
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000003
	speed: 0.0699s/iter; left time: 2590.7370s
	iters: 200, epoch: 11 | loss: 0.0034123
	speed: 0.0208s/iter; left time: 770.3990s
	iters: 300, epoch: 11 | loss: 0.0000256
	speed: 0.0211s/iter; left time: 779.7241s
	iters: 400, epoch: 11 | loss: 0.0000156
	speed: 0.0227s/iter; left time: 834.0835s
Epoch: 11 cost time: 9.251948595046997
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0095267
	speed: 0.0663s/iter; left time: 2428.6040s
	iters: 200, epoch: 12 | loss: 0.0000025
	speed: 0.0212s/iter; left time: 774.7711s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 783.1267s
	iters: 400, epoch: 12 | loss: 0.0000689
	speed: 0.0221s/iter; left time: 802.5804s
Epoch: 12 cost time: 9.180567979812622
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0011421
	speed: 0.0688s/iter; left time: 2494.6374s
	iters: 200, epoch: 13 | loss: 0.2087414
	speed: 0.0208s/iter; left time: 751.6247s
	iters: 300, epoch: 13 | loss: 0.0001475
	speed: 0.0208s/iter; left time: 748.9007s
	iters: 400, epoch: 13 | loss: 0.0026801
	speed: 0.0208s/iter; left time: 747.2818s
Epoch: 13 cost time: 9.091030359268188
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.2069326
	speed: 0.0733s/iter; left time: 2625.7426s
	iters: 200, epoch: 14 | loss: 0.0000023
	speed: 0.0200s/iter; left time: 714.8652s
	iters: 300, epoch: 14 | loss: 0.0000027
	speed: 0.0202s/iter; left time: 720.6001s
	iters: 400, epoch: 14 | loss: 0.0000048
	speed: 0.0203s/iter; left time: 720.2632s
Epoch: 14 cost time: 8.713290452957153
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000004
	speed: 0.0740s/iter; left time: 2620.0115s
	iters: 200, epoch: 15 | loss: 0.0000008
	speed: 0.0218s/iter; left time: 771.0859s
	iters: 300, epoch: 15 | loss: 0.0009028
	speed: 0.0220s/iter; left time: 773.5660s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0209s/iter; left time: 734.9630s
Epoch: 15 cost time: 9.321704387664795
Epoch: 15, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0011871
	speed: 0.0800s/iter; left time: 2798.8193s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.0200s/iter; left time: 698.0176s
	iters: 300, epoch: 16 | loss: 0.0000974
	speed: 0.0204s/iter; left time: 708.6766s
	iters: 400, epoch: 16 | loss: 0.0000014
	speed: 0.0216s/iter; left time: 750.8791s
Epoch: 16 cost time: 9.075735092163086
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000395
	speed: 0.0756s/iter; left time: 2614.1424s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 728.5248s
	iters: 300, epoch: 17 | loss: 0.0001256
	speed: 0.0216s/iter; left time: 743.6233s
	iters: 400, epoch: 17 | loss: 0.0000063
	speed: 0.0204s/iter; left time: 700.2434s
Epoch: 17 cost time: 9.043339967727661
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.969 Test Loss: 0.203 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0074530
	speed: 0.0759s/iter; left time: 2595.6419s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0222s/iter; left time: 755.0829s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0213s/iter; left time: 722.8589s
	iters: 400, epoch: 18 | loss: 0.0000020
	speed: 0.0222s/iter; left time: 752.5612s
Epoch: 18 cost time: 9.433066844940186
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.984 Test Loss: 0.089 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000005
	speed: 0.0748s/iter; left time: 2524.8302s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 730.6479s
	iters: 300, epoch: 19 | loss: 0.0004090
	speed: 0.0213s/iter; left time: 714.9788s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 705.4055s
Epoch: 19 cost time: 9.206049919128418
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.982 Test Loss: 0.112 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 292814
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9240838
	speed: 0.0372s/iter; left time: 1530.8300s
	iters: 200, epoch: 1 | loss: 0.1989776
	speed: 0.0202s/iter; left time: 828.3604s
	iters: 300, epoch: 1 | loss: 0.0922455
	speed: 0.0202s/iter; left time: 827.8004s
	iters: 400, epoch: 1 | loss: 0.1429987
	speed: 0.0207s/iter; left time: 846.0168s
Epoch: 1 cost time: 10.145498752593994
Epoch: 1, Steps: 413 | Train Loss: 0.543 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
Validation loss decreased (inf --> -0.971804).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0312183
	speed: 0.0694s/iter; left time: 2830.3889s
	iters: 200, epoch: 2 | loss: 0.0035550
	speed: 0.0204s/iter; left time: 830.3801s
	iters: 300, epoch: 2 | loss: 0.0336686
	speed: 0.0211s/iter; left time: 857.4535s
	iters: 400, epoch: 2 | loss: 0.0254322
	speed: 0.0199s/iter; left time: 806.2330s
Epoch: 2 cost time: 8.795053482055664
Epoch: 2, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
Validation loss decreased (-0.971804 --> -0.975443).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0436499
	speed: 0.0651s/iter; left time: 2627.0621s
	iters: 200, epoch: 3 | loss: 0.0030095
	speed: 0.0196s/iter; left time: 789.8455s
	iters: 300, epoch: 3 | loss: 0.0055486
	speed: 0.0209s/iter; left time: 841.2964s
	iters: 400, epoch: 3 | loss: 0.0053019
	speed: 0.0211s/iter; left time: 844.6077s
Epoch: 3 cost time: 8.845155715942383
Epoch: 3, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0004560
	speed: 0.0673s/iter; left time: 2689.6483s
	iters: 200, epoch: 4 | loss: 0.0040430
	speed: 0.0205s/iter; left time: 816.4514s
	iters: 300, epoch: 4 | loss: 0.0009020
	speed: 0.0208s/iter; left time: 826.7603s
	iters: 400, epoch: 4 | loss: 0.0001387
	speed: 0.0200s/iter; left time: 791.4802s
Epoch: 4 cost time: 8.914042949676514
Epoch: 4, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0036598
	speed: 0.0712s/iter; left time: 2817.5703s
	iters: 200, epoch: 5 | loss: 0.0066645
	speed: 0.0205s/iter; left time: 809.7442s
	iters: 300, epoch: 5 | loss: 0.0088853
	speed: 0.0222s/iter; left time: 872.7327s
	iters: 400, epoch: 5 | loss: 0.0360295
	speed: 0.0222s/iter; left time: 872.2321s
Epoch: 5 cost time: 9.155420064926147
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0005480
	speed: 0.0780s/iter; left time: 3054.2738s
	iters: 200, epoch: 6 | loss: 0.0003141
	speed: 0.0221s/iter; left time: 862.4295s
	iters: 300, epoch: 6 | loss: 0.0005925
	speed: 0.0216s/iter; left time: 840.4384s
	iters: 400, epoch: 6 | loss: 0.0059195
	speed: 0.0210s/iter; left time: 813.9445s
Epoch: 6 cost time: 9.396679401397705
Epoch: 6, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.975443 --> -0.979535).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000064
	speed: 0.0774s/iter; left time: 2996.4689s
	iters: 200, epoch: 7 | loss: 0.2622992
	speed: 0.0211s/iter; left time: 814.1595s
	iters: 300, epoch: 7 | loss: 0.0007157
	speed: 0.0203s/iter; left time: 781.3982s
	iters: 400, epoch: 7 | loss: 0.0011946
	speed: 0.0217s/iter; left time: 832.7158s
Epoch: 7 cost time: 8.937245607376099
Epoch: 7, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000354
	speed: 0.0798s/iter; left time: 3055.2555s
	iters: 200, epoch: 8 | loss: 0.0001221
	speed: 0.0204s/iter; left time: 778.2360s
	iters: 300, epoch: 8 | loss: 0.0000754
	speed: 0.0206s/iter; left time: 785.6472s
	iters: 400, epoch: 8 | loss: 0.1472417
	speed: 0.0201s/iter; left time: 762.4734s
Epoch: 8 cost time: 8.979770183563232
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0182912
	speed: 0.0766s/iter; left time: 2903.5985s
	iters: 200, epoch: 9 | loss: 0.0403850
	speed: 0.0207s/iter; left time: 782.2512s
	iters: 300, epoch: 9 | loss: 0.0422706
	speed: 0.0202s/iter; left time: 760.5624s
	iters: 400, epoch: 9 | loss: 0.0055800
	speed: 0.0195s/iter; left time: 734.0238s
Epoch: 9 cost time: 8.873780965805054
Epoch: 9, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0012710
	speed: 0.0680s/iter; left time: 2550.2565s
	iters: 200, epoch: 10 | loss: 0.0039729
	speed: 0.0205s/iter; left time: 766.6338s
	iters: 300, epoch: 10 | loss: 0.0000241
	speed: 0.0202s/iter; left time: 753.5933s
	iters: 400, epoch: 10 | loss: 0.0007196
	speed: 0.0202s/iter; left time: 751.2149s
Epoch: 10 cost time: 8.773183107376099
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000008
	speed: 0.0695s/iter; left time: 2575.6946s
	iters: 200, epoch: 11 | loss: 0.0005106
	speed: 0.0209s/iter; left time: 773.3751s
	iters: 300, epoch: 11 | loss: 0.0000005
	speed: 0.0219s/iter; left time: 808.8482s
	iters: 400, epoch: 11 | loss: 0.0009420
	speed: 0.0200s/iter; left time: 735.5821s
Epoch: 11 cost time: 9.039658069610596
Epoch: 11, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000135
	speed: 0.0695s/iter; left time: 2548.1981s
	iters: 200, epoch: 12 | loss: 0.0000377
	speed: 0.0199s/iter; left time: 726.1737s
	iters: 300, epoch: 12 | loss: 0.0001200
	speed: 0.0192s/iter; left time: 701.0138s
	iters: 400, epoch: 12 | loss: 0.0000425
	speed: 0.0189s/iter; left time: 685.4568s
Epoch: 12 cost time: 8.487412929534912
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0001468
	speed: 0.0686s/iter; left time: 2485.3994s
	iters: 200, epoch: 13 | loss: 0.0000054
	speed: 0.0196s/iter; left time: 706.9084s
	iters: 300, epoch: 13 | loss: 0.0000081
	speed: 0.0184s/iter; left time: 664.5063s
	iters: 400, epoch: 13 | loss: 0.0045354
	speed: 0.0188s/iter; left time: 676.7591s
Epoch: 13 cost time: 8.280384540557861
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0055742
	speed: 0.0656s/iter; left time: 2350.2059s
	iters: 200, epoch: 14 | loss: 0.0000005
	speed: 0.0188s/iter; left time: 671.3445s
	iters: 300, epoch: 14 | loss: 0.0003363
	speed: 0.0189s/iter; left time: 671.9092s
	iters: 400, epoch: 14 | loss: 0.0368790
	speed: 0.0192s/iter; left time: 681.0785s
Epoch: 14 cost time: 8.229856967926025
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000006
	speed: 0.0686s/iter; left time: 2429.7435s
	iters: 200, epoch: 15 | loss: 0.0025429
	speed: 0.0197s/iter; left time: 697.3776s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0208s/iter; left time: 734.2497s
	iters: 400, epoch: 15 | loss: 0.0000009
	speed: 0.0202s/iter; left time: 709.2343s
Epoch: 15 cost time: 8.842464923858643
Epoch: 15, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0708s/iter; left time: 2478.0690s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0210s/iter; left time: 733.1522s
	iters: 300, epoch: 16 | loss: 0.0001269
	speed: 0.0205s/iter; left time: 714.2611s
	iters: 400, epoch: 16 | loss: 0.0000040
	speed: 0.0189s/iter; left time: 655.9082s
Epoch: 16 cost time: 8.76492166519165
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.160 Vali Acc: 0.974 Test Loss: 0.160 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 292814
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9958118
	speed: 0.0390s/iter; left time: 1604.9183s
	iters: 200, epoch: 1 | loss: 0.4614830
	speed: 0.0213s/iter; left time: 876.9938s
	iters: 300, epoch: 1 | loss: 0.2775767
	speed: 0.0215s/iter; left time: 882.8408s
	iters: 400, epoch: 1 | loss: 0.0606154
	speed: 0.0208s/iter; left time: 850.9063s
Epoch: 1 cost time: 10.590376138687134
Epoch: 1, Steps: 413 | Train Loss: 0.400 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (inf --> -0.975897).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0357190
	speed: 0.0819s/iter; left time: 3338.8613s
	iters: 200, epoch: 2 | loss: 0.1356967
	speed: 0.0192s/iter; left time: 781.8634s
	iters: 300, epoch: 2 | loss: 0.1051376
	speed: 0.0197s/iter; left time: 798.1981s
	iters: 400, epoch: 2 | loss: 0.0124468
	speed: 0.0205s/iter; left time: 831.3467s
Epoch: 2 cost time: 8.885966777801514
Epoch: 2, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0061458
	speed: 0.0702s/iter; left time: 2835.4697s
	iters: 200, epoch: 3 | loss: 0.2280858
	speed: 0.0208s/iter; left time: 838.9446s
	iters: 300, epoch: 3 | loss: 0.0003981
	speed: 0.0201s/iter; left time: 806.3690s
	iters: 400, epoch: 3 | loss: 0.0061109
	speed: 0.0207s/iter; left time: 830.0405s
Epoch: 3 cost time: 8.848559379577637
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.975897 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0093695
	speed: 0.0712s/iter; left time: 2845.1552s
	iters: 200, epoch: 4 | loss: 0.0723424
	speed: 0.0197s/iter; left time: 785.4568s
	iters: 300, epoch: 4 | loss: 0.0032776
	speed: 0.0207s/iter; left time: 822.3298s
	iters: 400, epoch: 4 | loss: 0.0021456
	speed: 0.0203s/iter; left time: 804.1825s
Epoch: 4 cost time: 8.789561033248901
Epoch: 4, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.976807 --> -0.978171).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0001162
	speed: 0.0691s/iter; left time: 2732.0423s
	iters: 200, epoch: 5 | loss: 0.0045097
	speed: 0.0213s/iter; left time: 840.4882s
	iters: 300, epoch: 5 | loss: 0.0006249
	speed: 0.0205s/iter; left time: 805.9529s
	iters: 400, epoch: 5 | loss: 0.0003833
	speed: 0.0212s/iter; left time: 833.8976s
Epoch: 5 cost time: 9.08413577079773
Epoch: 5, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0010828
	speed: 0.0651s/iter; left time: 2545.8634s
	iters: 200, epoch: 6 | loss: 0.0058520
	speed: 0.0210s/iter; left time: 818.7559s
	iters: 300, epoch: 6 | loss: 0.0001114
	speed: 0.0219s/iter; left time: 853.4051s
	iters: 400, epoch: 6 | loss: 0.0048374
	speed: 0.0214s/iter; left time: 832.2290s
Epoch: 6 cost time: 9.127825021743774
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0007321
	speed: 0.0697s/iter; left time: 2697.1667s
	iters: 200, epoch: 7 | loss: 0.0000094
	speed: 0.0211s/iter; left time: 814.8322s
	iters: 300, epoch: 7 | loss: 0.0361040
	speed: 0.0211s/iter; left time: 813.3243s
	iters: 400, epoch: 7 | loss: 0.0016263
	speed: 0.0216s/iter; left time: 830.9521s
Epoch: 7 cost time: 9.177092552185059
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.184 Vali Acc: 0.961 Test Loss: 0.184 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0151273
	speed: 0.0740s/iter; left time: 2833.6492s
	iters: 200, epoch: 8 | loss: 0.3130883
	speed: 0.0197s/iter; left time: 752.8013s
	iters: 300, epoch: 8 | loss: 0.0048372
	speed: 0.0196s/iter; left time: 748.1147s
	iters: 400, epoch: 8 | loss: 0.0000005
	speed: 0.0207s/iter; left time: 788.3642s
Epoch: 8 cost time: 8.675955772399902
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0032673
	speed: 0.0735s/iter; left time: 2783.8410s
	iters: 200, epoch: 9 | loss: 0.0000012
	speed: 0.0208s/iter; left time: 784.5956s
	iters: 300, epoch: 9 | loss: 0.0000007
	speed: 0.0192s/iter; left time: 724.5882s
	iters: 400, epoch: 9 | loss: 0.0010738
	speed: 0.0206s/iter; left time: 773.0366s
Epoch: 9 cost time: 8.800353527069092
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.980445).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 2657.7607s
	iters: 200, epoch: 10 | loss: 0.0020933
	speed: 0.0204s/iter; left time: 761.2807s
	iters: 300, epoch: 10 | loss: 0.1042235
	speed: 0.0212s/iter; left time: 788.9357s
	iters: 400, epoch: 10 | loss: 0.0108159
	speed: 0.0200s/iter; left time: 742.3781s
Epoch: 10 cost time: 8.762285947799683
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.156 Vali Acc: 0.968 Test Loss: 0.156 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000260
	speed: 0.0725s/iter; left time: 2689.4653s
	iters: 200, epoch: 11 | loss: 0.0001275
	speed: 0.0210s/iter; left time: 775.6249s
	iters: 300, epoch: 11 | loss: 0.0003514
	speed: 0.0214s/iter; left time: 788.7584s
	iters: 400, epoch: 11 | loss: 0.0045047
	speed: 0.0201s/iter; left time: 739.3558s
Epoch: 11 cost time: 8.980490684509277
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.981354).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000003
	speed: 0.0735s/iter; left time: 2695.2335s
	iters: 200, epoch: 12 | loss: 0.0000242
	speed: 0.0207s/iter; left time: 757.8214s
	iters: 300, epoch: 12 | loss: 0.0003580
	speed: 0.0209s/iter; left time: 761.9603s
	iters: 400, epoch: 12 | loss: 0.0008120
	speed: 0.0222s/iter; left time: 808.0509s
Epoch: 12 cost time: 9.39067554473877
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0006713
	speed: 0.0714s/iter; left time: 2589.1995s
	iters: 200, epoch: 13 | loss: 0.0000177
	speed: 0.0212s/iter; left time: 765.2479s
	iters: 300, epoch: 13 | loss: 0.0000008
	speed: 0.0219s/iter; left time: 789.6781s
	iters: 400, epoch: 13 | loss: 0.0000773
	speed: 0.0215s/iter; left time: 771.8613s
Epoch: 13 cost time: 9.345270156860352
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000187
	speed: 0.0729s/iter; left time: 2613.3672s
	iters: 200, epoch: 14 | loss: 0.0000003
	speed: 0.0197s/iter; left time: 703.7869s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0197s/iter; left time: 703.6098s
	iters: 400, epoch: 14 | loss: 0.0000048
	speed: 0.0201s/iter; left time: 715.9565s
Epoch: 14 cost time: 8.550408363342285
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 2561.1916s
	iters: 200, epoch: 15 | loss: 0.0000007
	speed: 0.0213s/iter; left time: 751.6489s
	iters: 300, epoch: 15 | loss: 0.0000025
	speed: 0.0201s/iter; left time: 707.1368s
	iters: 400, epoch: 15 | loss: 0.0000110
	speed: 0.0201s/iter; left time: 706.4899s
Epoch: 15 cost time: 8.884875297546387
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.088 Vali Acc: 0.982 Test Loss: 0.088 Test Acc: 0.982
Validation loss decreased (-0.981354 --> -0.982264).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000489
	speed: 0.0681s/iter; left time: 2383.3735s
	iters: 200, epoch: 16 | loss: 0.0214164
	speed: 0.0193s/iter; left time: 674.0090s
	iters: 300, epoch: 16 | loss: 0.0020833
	speed: 0.0212s/iter; left time: 738.1670s
	iters: 400, epoch: 16 | loss: 0.0000358
	speed: 0.0209s/iter; left time: 726.6945s
Epoch: 16 cost time: 8.822007417678833
Epoch: 16, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000131
	speed: 0.0718s/iter; left time: 2482.6023s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 713.2896s
	iters: 300, epoch: 17 | loss: 0.0000246
	speed: 0.0220s/iter; left time: 756.7556s
	iters: 400, epoch: 17 | loss: 0.0000003
	speed: 0.0208s/iter; left time: 713.2879s
Epoch: 17 cost time: 9.110491275787354
Epoch: 17, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.128 Vali Acc: 0.983 Test Loss: 0.128 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.983173).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 2569.0239s
	iters: 200, epoch: 18 | loss: 0.0000017
	speed: 0.0212s/iter; left time: 723.8478s
	iters: 300, epoch: 18 | loss: 0.0000042
	speed: 0.0201s/iter; left time: 681.7391s
	iters: 400, epoch: 18 | loss: 0.0000002
	speed: 0.0210s/iter; left time: 712.4200s
Epoch: 18 cost time: 9.0380699634552
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1529149
	speed: 0.0706s/iter; left time: 2385.0891s
	iters: 200, epoch: 19 | loss: 0.0000016
	speed: 0.0216s/iter; left time: 728.1996s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 712.5854s
	iters: 400, epoch: 19 | loss: 0.0983953
	speed: 0.0221s/iter; left time: 740.0276s
Epoch: 19 cost time: 9.301424264907837
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0714s/iter; left time: 2383.0447s
	iters: 200, epoch: 20 | loss: 0.0955566
	speed: 0.0202s/iter; left time: 672.7397s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0192s/iter; left time: 635.3376s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0192s/iter; left time: 635.7184s
Epoch: 20 cost time: 8.65417766571045
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000005
	speed: 0.0705s/iter; left time: 2321.2081s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0202s/iter; left time: 663.6295s
	iters: 300, epoch: 21 | loss: 0.0000026
	speed: 0.0210s/iter; left time: 689.1646s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0204s/iter; left time: 665.9842s
Epoch: 21 cost time: 8.802078485488892
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.259 Vali Acc: 0.969 Test Loss: 0.259 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0754s/iter; left time: 2452.3227s
	iters: 200, epoch: 22 | loss: 0.0000016
	speed: 0.0198s/iter; left time: 641.0193s
	iters: 300, epoch: 22 | loss: 0.0000097
	speed: 0.0210s/iter; left time: 680.0578s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.0214s/iter; left time: 690.3280s
Epoch: 22 cost time: 8.975930452346802
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.986 Test Loss: 0.107 Test Acc: 0.986
Validation loss decreased (-0.983173 --> -0.986356).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 2403.6956s
	iters: 200, epoch: 23 | loss: 0.0000253
	speed: 0.0216s/iter; left time: 693.0725s
	iters: 300, epoch: 23 | loss: 0.0000412
	speed: 0.0224s/iter; left time: 715.5401s
	iters: 400, epoch: 23 | loss: 0.0000024
	speed: 0.0208s/iter; left time: 663.1622s
Epoch: 23 cost time: 9.379088640213013
Epoch: 23, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0697s/iter; left time: 2209.7440s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 674.7723s
	iters: 300, epoch: 24 | loss: 0.0000130
	speed: 0.0212s/iter; left time: 668.4701s
	iters: 400, epoch: 24 | loss: 0.0002662
	speed: 0.0219s/iter; left time: 686.6917s
Epoch: 24 cost time: 9.20020079612732
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.974 Test Loss: 0.191 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0703s/iter; left time: 2200.7983s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 670.9164s
	iters: 300, epoch: 25 | loss: 0.0279984
	speed: 0.0212s/iter; left time: 660.4350s
	iters: 400, epoch: 25 | loss: 0.0000012
	speed: 0.0213s/iter; left time: 661.3599s
Epoch: 25 cost time: 9.298976182937622
Epoch: 25, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.140 Vali Acc: 0.982 Test Loss: 0.140 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0293323
	speed: 0.0766s/iter; left time: 2363.6846s
	iters: 200, epoch: 26 | loss: 0.0000003
	speed: 0.0216s/iter; left time: 665.1625s
	iters: 300, epoch: 26 | loss: 0.0000005
	speed: 0.0201s/iter; left time: 617.9832s
	iters: 400, epoch: 26 | loss: 0.0000514
	speed: 0.0195s/iter; left time: 595.7274s
Epoch: 26 cost time: 8.892741680145264
Epoch: 26, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.241 Vali Acc: 0.976 Test Loss: 0.241 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0001556
	speed: 0.0760s/iter; left time: 2315.5595s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0202s/iter; left time: 613.4728s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 624.1265s
	iters: 400, epoch: 27 | loss: 0.0000016
	speed: 0.0199s/iter; left time: 601.2732s
Epoch: 27 cost time: 8.739777326583862
Epoch: 27, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.320 Vali Acc: 0.968 Test Loss: 0.320 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0720s/iter; left time: 2162.7842s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0202s/iter; left time: 604.9957s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0195s/iter; left time: 583.3611s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 637.8866s
Epoch: 28 cost time: 8.833572387695312
Epoch: 28, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.205 Vali Acc: 0.976 Test Loss: 0.205 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 2079.7295s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 639.8441s
	iters: 300, epoch: 29 | loss: 0.0000041
	speed: 0.0203s/iter; left time: 598.5602s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 638.1317s
Epoch: 29 cost time: 9.1274573802948
Epoch: 29, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.986 Test Loss: 0.104 Test Acc: 0.986
Validation loss decreased (-0.986356 --> -0.986356).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 2112.1859s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 608.3340s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 619.2548s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 644.6011s
Epoch: 30 cost time: 9.21471881866455
Epoch: 30, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.168 Vali Acc: 0.980 Test Loss: 0.168 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.0684s/iter; left time: 1969.7225s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 620.6512s
	iters: 300, epoch: 31 | loss: 0.5106348
	speed: 0.0209s/iter; left time: 597.5787s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 606.6791s
Epoch: 31 cost time: 9.172432899475098
Epoch: 31, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.0684s/iter; left time: 1942.4577s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 586.5048s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 602.8269s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 579.7109s
Epoch: 32 cost time: 9.004259586334229
Epoch: 32, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.983 Test Loss: 0.237 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 2027.2109s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0200s/iter; left time: 558.1222s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 572.8779s
	iters: 400, epoch: 33 | loss: 0.0080930
	speed: 0.0203s/iter; left time: 562.8178s
Epoch: 33 cost time: 8.706926107406616
Epoch: 33, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.240 Vali Acc: 0.980 Test Loss: 0.240 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 1953.9227s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0202s/iter; left time: 555.5568s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0204s/iter; left time: 559.5253s
	iters: 400, epoch: 34 | loss: 0.0108653
	speed: 0.0201s/iter; left time: 548.1580s
Epoch: 34 cost time: 8.715104103088379
Epoch: 34, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.978 Test Loss: 0.267 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.0786s/iter; left time: 2134.2929s
	iters: 200, epoch: 35 | loss: 0.0000025
	speed: 0.0204s/iter; left time: 553.2850s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0202s/iter; left time: 544.9270s
	iters: 400, epoch: 35 | loss: 0.0000149
	speed: 0.0210s/iter; left time: 564.4651s
Epoch: 35 cost time: 8.965654134750366
Epoch: 35, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.247 Vali Acc: 0.980 Test Loss: 0.247 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0000001
	speed: 0.0759s/iter; left time: 2030.8442s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 548.9419s
	iters: 300, epoch: 36 | loss: 0.0000001
	speed: 0.0215s/iter; left time: 571.0050s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 551.4478s
Epoch: 36 cost time: 9.076514482498169
Epoch: 36, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.237 Vali Acc: 0.980 Test Loss: 0.237 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0000002
	speed: 0.0715s/iter; left time: 1882.5308s
	iters: 200, epoch: 37 | loss: 0.0000002
	speed: 0.0214s/iter; left time: 561.3496s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 535.8029s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 540.3638s
Epoch: 37 cost time: 9.047687768936157
Epoch: 37, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.253 Vali Acc: 0.978 Test Loss: 0.253 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 1900.2698s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 549.4146s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 549.9045s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 553.1839s
Epoch: 38 cost time: 9.278175592422485
Epoch: 38, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.243 Vali Acc: 0.977 Test Loss: 0.243 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 1819.3223s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0200s/iter; left time: 507.3197s
	iters: 300, epoch: 39 | loss: 0.0000008
	speed: 0.0209s/iter; left time: 527.9315s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0204s/iter; left time: 514.3772s
Epoch: 39 cost time: 8.854888439178467
Epoch: 39, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.981 Test Loss: 0.161 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 227278
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0266798
	speed: 0.0381s/iter; left time: 1567.8917s
	iters: 200, epoch: 1 | loss: 0.4749328
	speed: 0.0198s/iter; left time: 812.8530s
	iters: 300, epoch: 1 | loss: 0.2744983
	speed: 0.0215s/iter; left time: 880.7768s
	iters: 400, epoch: 1 | loss: 0.0618361
	speed: 0.0213s/iter; left time: 870.5886s
Epoch: 1 cost time: 10.436809062957764
Epoch: 1, Steps: 413 | Train Loss: 0.416 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (inf --> -0.976807).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0617031
	speed: 0.0681s/iter; left time: 2779.0840s
	iters: 200, epoch: 2 | loss: 0.1258780
	speed: 0.0215s/iter; left time: 875.6135s
	iters: 300, epoch: 2 | loss: 0.1250162
	speed: 0.0211s/iter; left time: 858.0233s
	iters: 400, epoch: 2 | loss: 0.0124800
	speed: 0.0223s/iter; left time: 904.8008s
Epoch: 2 cost time: 9.35193920135498
Epoch: 2, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0026708
	speed: 0.0698s/iter; left time: 2816.8007s
	iters: 200, epoch: 3 | loss: 0.2542482
	speed: 0.0202s/iter; left time: 814.9355s
	iters: 300, epoch: 3 | loss: 0.0003936
	speed: 0.0211s/iter; left time: 847.0707s
	iters: 400, epoch: 3 | loss: 0.0033472
	speed: 0.0216s/iter; left time: 866.6121s
Epoch: 3 cost time: 9.06376338005066
Epoch: 3, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
Validation loss decreased (-0.976807 --> -0.979081).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0016412
	speed: 0.0736s/iter; left time: 2941.8668s
	iters: 200, epoch: 4 | loss: 0.1151165
	speed: 0.0217s/iter; left time: 866.2458s
	iters: 300, epoch: 4 | loss: 0.0116161
	speed: 0.0202s/iter; left time: 801.3360s
	iters: 400, epoch: 4 | loss: 0.0043222
	speed: 0.0218s/iter; left time: 863.8186s
Epoch: 4 cost time: 9.183644771575928
Epoch: 4, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0001448
	speed: 0.0755s/iter; left time: 2984.3095s
	iters: 200, epoch: 5 | loss: 0.0008427
	speed: 0.0202s/iter; left time: 798.6329s
	iters: 300, epoch: 5 | loss: 0.0048426
	speed: 0.0202s/iter; left time: 796.3993s
	iters: 400, epoch: 5 | loss: 0.0004848
	speed: 0.0224s/iter; left time: 878.6226s
Epoch: 5 cost time: 9.166209936141968
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979535).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0154580
	speed: 0.0761s/iter; left time: 2977.8764s
	iters: 200, epoch: 6 | loss: 0.0774180
	speed: 0.0200s/iter; left time: 780.3251s
	iters: 300, epoch: 6 | loss: 0.0012471
	speed: 0.0199s/iter; left time: 776.4376s
	iters: 400, epoch: 6 | loss: 0.0030960
	speed: 0.0198s/iter; left time: 768.2545s
Epoch: 6 cost time: 8.85545039176941
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.206 Vali Acc: 0.953 Test Loss: 0.206 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000512
	speed: 0.0791s/iter; left time: 3063.1179s
	iters: 200, epoch: 7 | loss: 0.0000310
	speed: 0.0198s/iter; left time: 763.8345s
	iters: 300, epoch: 7 | loss: 0.0040518
	speed: 0.0194s/iter; left time: 746.8749s
	iters: 400, epoch: 7 | loss: 0.0000662
	speed: 0.0195s/iter; left time: 748.3261s
Epoch: 7 cost time: 8.59210467338562
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0001094
	speed: 0.0691s/iter; left time: 2647.8951s
	iters: 200, epoch: 8 | loss: 0.0003985
	speed: 0.0189s/iter; left time: 721.1044s
	iters: 300, epoch: 8 | loss: 0.0000459
	speed: 0.0201s/iter; left time: 767.3089s
	iters: 400, epoch: 8 | loss: 0.0000287
	speed: 0.0201s/iter; left time: 763.3462s
Epoch: 8 cost time: 8.73041582107544
Epoch: 8, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0005754
	speed: 0.0644s/iter; left time: 2441.4554s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0196s/iter; left time: 742.3871s
	iters: 300, epoch: 9 | loss: 0.0043986
	speed: 0.0180s/iter; left time: 678.7568s
	iters: 400, epoch: 9 | loss: 0.0000041
	speed: 0.0196s/iter; left time: 735.7330s
Epoch: 9 cost time: 8.47618556022644
Epoch: 9, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.980900).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000738
	speed: 0.0637s/iter; left time: 2386.7452s
	iters: 200, epoch: 10 | loss: 0.0000916
	speed: 0.0189s/iter; left time: 705.6137s
	iters: 300, epoch: 10 | loss: 0.0000021
	speed: 0.0195s/iter; left time: 727.0685s
	iters: 400, epoch: 10 | loss: 0.0091449
	speed: 0.0215s/iter; left time: 799.3739s
Epoch: 10 cost time: 8.727005958557129
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0001008
	speed: 0.0674s/iter; left time: 2499.4944s
	iters: 200, epoch: 11 | loss: 0.0001086
	speed: 0.0212s/iter; left time: 782.5165s
	iters: 300, epoch: 11 | loss: 0.1164316
	speed: 0.0215s/iter; left time: 792.7608s
	iters: 400, epoch: 11 | loss: 0.1808625
	speed: 0.0214s/iter; left time: 785.4021s
Epoch: 11 cost time: 9.2410728931427
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.139 Vali Acc: 0.979 Test Loss: 0.139 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000008
	speed: 0.0688s/iter; left time: 2523.2709s
	iters: 200, epoch: 12 | loss: 0.0000196
	speed: 0.0204s/iter; left time: 746.1774s
	iters: 300, epoch: 12 | loss: 0.0000008
	speed: 0.0216s/iter; left time: 789.0426s
	iters: 400, epoch: 12 | loss: 0.0027790
	speed: 0.0211s/iter; left time: 767.8738s
Epoch: 12 cost time: 9.005362272262573
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.985 Test Loss: 0.092 Test Acc: 0.985
Validation loss decreased (-0.980900 --> -0.984538).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000724
	speed: 0.0686s/iter; left time: 2484.7327s
	iters: 200, epoch: 13 | loss: 0.0000663
	speed: 0.0221s/iter; left time: 799.2856s
	iters: 300, epoch: 13 | loss: 0.0010487
	speed: 0.0208s/iter; left time: 751.0918s
	iters: 400, epoch: 13 | loss: 0.0000302
	speed: 0.0203s/iter; left time: 729.5050s
Epoch: 13 cost time: 9.140703201293945
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0002220
	speed: 0.0725s/iter; left time: 2599.1108s
	iters: 200, epoch: 14 | loss: 0.0018186
	speed: 0.0215s/iter; left time: 766.6288s
	iters: 300, epoch: 14 | loss: 0.0000067
	speed: 0.0206s/iter; left time: 735.4507s
	iters: 400, epoch: 14 | loss: 0.0030859
	speed: 0.0199s/iter; left time: 706.8187s
Epoch: 14 cost time: 8.849492073059082
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.138 Vali Acc: 0.981 Test Loss: 0.138 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.0799s/iter; left time: 2830.2818s
	iters: 200, epoch: 15 | loss: 0.0000006
	speed: 0.0217s/iter; left time: 767.6022s
	iters: 300, epoch: 15 | loss: 0.0046898
	speed: 0.0209s/iter; left time: 735.0812s
	iters: 400, epoch: 15 | loss: 0.0000984
	speed: 0.0213s/iter; left time: 747.7892s
Epoch: 15 cost time: 9.163581609725952
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000355
	speed: 0.0760s/iter; left time: 2660.4120s
	iters: 200, epoch: 16 | loss: 0.0000003
	speed: 0.0209s/iter; left time: 730.4460s
	iters: 300, epoch: 16 | loss: 0.0000160
	speed: 0.0199s/iter; left time: 693.9037s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 743.1505s
Epoch: 16 cost time: 8.878918409347534
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.983 Test Loss: 0.125 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.3125388
	speed: 0.0705s/iter; left time: 2439.4778s
	iters: 200, epoch: 17 | loss: 0.0000002
	speed: 0.0198s/iter; left time: 682.3398s
	iters: 300, epoch: 17 | loss: 0.0002326
	speed: 0.0207s/iter; left time: 711.9156s
	iters: 400, epoch: 17 | loss: 0.0040052
	speed: 0.0204s/iter; left time: 700.9378s
Epoch: 17 cost time: 8.805107593536377
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.968 Test Loss: 0.223 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0099303
	speed: 0.0716s/iter; left time: 2446.3971s
	iters: 200, epoch: 18 | loss: 0.0000018
	speed: 0.0215s/iter; left time: 734.3679s
	iters: 300, epoch: 18 | loss: 0.0003975
	speed: 0.0206s/iter; left time: 698.7973s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 737.4829s
Epoch: 18 cost time: 9.025544881820679
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.974 Test Loss: 0.197 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0611385
	speed: 0.0664s/iter; left time: 2242.3460s
	iters: 200, epoch: 19 | loss: 0.0041418
	speed: 0.0211s/iter; left time: 709.9930s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0210s/iter; left time: 706.0388s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 719.5451s
Epoch: 19 cost time: 9.1909499168396
Epoch: 19, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 2289.9552s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 712.3995s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0198s/iter; left time: 655.7427s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0201s/iter; left time: 663.3135s
Epoch: 20 cost time: 8.9591543674469
Epoch: 20, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000138
	speed: 0.0677s/iter; left time: 2231.7214s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0197s/iter; left time: 646.9623s
	iters: 300, epoch: 21 | loss: 0.0021861
	speed: 0.0199s/iter; left time: 651.2884s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 675.2699s
Epoch: 21 cost time: 8.641662836074829
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 2305.4372s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0195s/iter; left time: 632.7845s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0190s/iter; left time: 613.7670s
	iters: 400, epoch: 22 | loss: 0.0000064
	speed: 0.0195s/iter; left time: 629.6341s
Epoch: 22 cost time: 8.446946382522583
Epoch: 22, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 227278
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0785912
	speed: 0.0388s/iter; left time: 1596.8502s
	iters: 200, epoch: 1 | loss: 0.4299411
	speed: 0.0204s/iter; left time: 838.8927s
	iters: 300, epoch: 1 | loss: 0.3458772
	speed: 0.0209s/iter; left time: 858.9242s
	iters: 400, epoch: 1 | loss: 0.0797445
	speed: 0.0207s/iter; left time: 845.0083s
Epoch: 1 cost time: 10.424240112304688
Epoch: 1, Steps: 413 | Train Loss: 0.452 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (inf --> -0.976807).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1021730
	speed: 0.0699s/iter; left time: 2852.8039s
	iters: 200, epoch: 2 | loss: 0.1053386
	speed: 0.0202s/iter; left time: 821.8631s
	iters: 300, epoch: 2 | loss: 0.1555343
	speed: 0.0205s/iter; left time: 831.3395s
	iters: 400, epoch: 2 | loss: 0.0117644
	speed: 0.0203s/iter; left time: 820.8647s
Epoch: 2 cost time: 8.902342796325684
Epoch: 2, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.087 Vali Acc: 0.972 Test Loss: 0.087 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0042634
	speed: 0.0719s/iter; left time: 2903.2331s
	iters: 200, epoch: 3 | loss: 0.2107507
	speed: 0.0203s/iter; left time: 818.1412s
	iters: 300, epoch: 3 | loss: 0.0019993
	speed: 0.0200s/iter; left time: 805.2160s
	iters: 400, epoch: 3 | loss: 0.0087760
	speed: 0.0209s/iter; left time: 838.7635s
Epoch: 3 cost time: 8.776089429855347
Epoch: 3, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976807 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0297588
	speed: 0.0750s/iter; left time: 2997.4364s
	iters: 200, epoch: 4 | loss: 0.0193966
	speed: 0.0199s/iter; left time: 794.4828s
	iters: 300, epoch: 4 | loss: 0.0003725
	speed: 0.0201s/iter; left time: 798.5917s
	iters: 400, epoch: 4 | loss: 0.0097374
	speed: 0.0192s/iter; left time: 761.2321s
Epoch: 4 cost time: 8.638083934783936
Epoch: 4, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0070461
	speed: 0.0721s/iter; left time: 2850.1784s
	iters: 200, epoch: 5 | loss: 0.0007007
	speed: 0.0195s/iter; left time: 770.6045s
	iters: 300, epoch: 5 | loss: 0.0033683
	speed: 0.0200s/iter; left time: 785.8401s
	iters: 400, epoch: 5 | loss: 0.0004590
	speed: 0.0202s/iter; left time: 791.8957s
Epoch: 5 cost time: 8.664591789245605
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0009328
	speed: 0.0728s/iter; left time: 2848.2902s
	iters: 200, epoch: 6 | loss: 0.0000686
	speed: 0.0199s/iter; left time: 775.6934s
	iters: 300, epoch: 6 | loss: 0.0007478
	speed: 0.0197s/iter; left time: 767.3728s
	iters: 400, epoch: 6 | loss: 0.4070495
	speed: 0.0201s/iter; left time: 782.3815s
Epoch: 6 cost time: 8.576676845550537
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.976807 --> -0.978171).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0015081
	speed: 0.0661s/iter; left time: 2557.7863s
	iters: 200, epoch: 7 | loss: 0.0000369
	speed: 0.0222s/iter; left time: 857.8630s
	iters: 300, epoch: 7 | loss: 0.0019412
	speed: 0.0206s/iter; left time: 792.3741s
	iters: 400, epoch: 7 | loss: 0.0000887
	speed: 0.0211s/iter; left time: 810.7103s
Epoch: 7 cost time: 9.190024852752686
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0002191
	speed: 0.0664s/iter; left time: 2541.8833s
	iters: 200, epoch: 8 | loss: 0.0000028
	speed: 0.0221s/iter; left time: 843.6143s
	iters: 300, epoch: 8 | loss: 0.0000182
	speed: 0.0213s/iter; left time: 813.1102s
	iters: 400, epoch: 8 | loss: 0.0000096
	speed: 0.0211s/iter; left time: 802.8750s
Epoch: 8 cost time: 9.231915950775146
Epoch: 8, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0003024
	speed: 0.0680s/iter; left time: 2575.1592s
	iters: 200, epoch: 9 | loss: 0.0000020
	speed: 0.0227s/iter; left time: 858.3659s
	iters: 300, epoch: 9 | loss: 0.0000003
	speed: 0.0210s/iter; left time: 791.4563s
	iters: 400, epoch: 9 | loss: 0.0000010
	speed: 0.0194s/iter; left time: 730.4635s
Epoch: 9 cost time: 9.095970630645752
Epoch: 9, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.978171 --> -0.980899).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000006
	speed: 0.0732s/iter; left time: 2742.6294s
	iters: 200, epoch: 10 | loss: 0.0000523
	speed: 0.0200s/iter; left time: 746.5442s
	iters: 300, epoch: 10 | loss: 0.0000079
	speed: 0.0196s/iter; left time: 732.3728s
	iters: 400, epoch: 10 | loss: 0.0000089
	speed: 0.0191s/iter; left time: 710.1999s
Epoch: 10 cost time: 8.793350219726562
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0008084
	speed: 0.0721s/iter; left time: 2673.6440s
	iters: 200, epoch: 11 | loss: 0.0218733
	speed: 0.0186s/iter; left time: 688.2137s
	iters: 300, epoch: 11 | loss: 0.0934637
	speed: 0.0185s/iter; left time: 681.6561s
	iters: 400, epoch: 11 | loss: 0.0009944
	speed: 0.0181s/iter; left time: 665.7843s
Epoch: 11 cost time: 8.161624908447266
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.060 Vali Acc: 0.990 Test Loss: 0.060 Test Acc: 0.990
Validation loss decreased (-0.980899 --> -0.989540).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000118
	speed: 0.0725s/iter; left time: 2658.4205s
	iters: 200, epoch: 12 | loss: 0.0000013
	speed: 0.0188s/iter; left time: 687.0044s
	iters: 300, epoch: 12 | loss: 0.0004719
	speed: 0.0183s/iter; left time: 666.9608s
	iters: 400, epoch: 12 | loss: 0.0031949
	speed: 0.0184s/iter; left time: 667.9906s
Epoch: 12 cost time: 8.175835371017456
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0005780
	speed: 0.0695s/iter; left time: 2517.5946s
	iters: 200, epoch: 13 | loss: 0.0001242
	speed: 0.0203s/iter; left time: 734.6643s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.0198s/iter; left time: 712.7753s
	iters: 400, epoch: 13 | loss: 0.0000265
	speed: 0.0195s/iter; left time: 702.1972s
Epoch: 13 cost time: 8.670202016830444
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000278
	speed: 0.0726s/iter; left time: 2600.3351s
	iters: 200, epoch: 14 | loss: 0.0000021
	speed: 0.0190s/iter; left time: 679.0832s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0203s/iter; left time: 724.5595s
	iters: 400, epoch: 14 | loss: 0.1133036
	speed: 0.0216s/iter; left time: 767.9009s
Epoch: 14 cost time: 8.75990343093872
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000003
	speed: 0.0686s/iter; left time: 2429.4269s
	iters: 200, epoch: 15 | loss: 0.0000050
	speed: 0.0205s/iter; left time: 723.7133s
	iters: 300, epoch: 15 | loss: 0.0000605
	speed: 0.0203s/iter; left time: 713.6143s
	iters: 400, epoch: 15 | loss: 0.0002256
	speed: 0.0196s/iter; left time: 690.0271s
Epoch: 15 cost time: 8.829233646392822
Epoch: 15, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0009165
	speed: 0.0712s/iter; left time: 2491.9510s
	iters: 200, epoch: 16 | loss: 0.0000003
	speed: 0.0205s/iter; left time: 716.8961s
	iters: 300, epoch: 16 | loss: 0.0000892
	speed: 0.0211s/iter; left time: 734.7773s
	iters: 400, epoch: 16 | loss: 0.0192760
	speed: 0.0198s/iter; left time: 687.3373s
Epoch: 16 cost time: 8.870609283447266
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 2245.4904s
	iters: 200, epoch: 17 | loss: 0.0000161
	speed: 0.0190s/iter; left time: 655.1152s
	iters: 300, epoch: 17 | loss: 0.0000022
	speed: 0.0189s/iter; left time: 650.8135s
	iters: 400, epoch: 17 | loss: 0.0000011
	speed: 0.0192s/iter; left time: 658.1905s
Epoch: 17 cost time: 8.3539400100708
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.139 Vali Acc: 0.978 Test Loss: 0.139 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.1954828
	speed: 0.0684s/iter; left time: 2337.0433s
	iters: 200, epoch: 18 | loss: 0.1408597
	speed: 0.0196s/iter; left time: 668.8484s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0190s/iter; left time: 646.3824s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0196s/iter; left time: 664.7891s
Epoch: 18 cost time: 8.397765159606934
Epoch: 18, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.277 Vali Acc: 0.966 Test Loss: 0.277 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000148
	speed: 0.0679s/iter; left time: 2293.3241s
	iters: 200, epoch: 19 | loss: 0.0062834
	speed: 0.0187s/iter; left time: 629.9065s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0193s/iter; left time: 646.6326s
	iters: 400, epoch: 19 | loss: 0.0000026
	speed: 0.0199s/iter; left time: 666.0689s
Epoch: 19 cost time: 8.399744033813477
Epoch: 19, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0031418
	speed: 0.0697s/iter; left time: 2323.6890s
	iters: 200, epoch: 20 | loss: 0.0000121
	speed: 0.0206s/iter; left time: 685.5556s
	iters: 300, epoch: 20 | loss: 0.0098373
	speed: 0.0200s/iter; left time: 662.8209s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0194s/iter; left time: 642.1242s
Epoch: 20 cost time: 8.694122314453125
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.080 Vali Acc: 0.986 Test Loss: 0.080 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0009661
	speed: 0.0735s/iter; left time: 2422.6232s
	iters: 200, epoch: 21 | loss: 0.0000017
	speed: 0.0193s/iter; left time: 634.2134s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.0186s/iter; left time: 607.4726s
	iters: 400, epoch: 21 | loss: 0.0000029
	speed: 0.0200s/iter; left time: 654.4260s
Epoch: 21 cost time: 8.425584554672241
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 227278
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1545827
	speed: 0.0371s/iter; left time: 1527.8786s
	iters: 200, epoch: 1 | loss: 0.4638186
	speed: 0.0191s/iter; left time: 785.7508s
	iters: 300, epoch: 1 | loss: 0.3142324
	speed: 0.0199s/iter; left time: 814.1372s
	iters: 400, epoch: 1 | loss: 0.1088567
	speed: 0.0208s/iter; left time: 849.7210s
Epoch: 1 cost time: 9.987516641616821
Epoch: 1, Steps: 413 | Train Loss: 0.539 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (inf --> -0.969531).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0599921
	speed: 0.0636s/iter; left time: 2594.5089s
	iters: 200, epoch: 2 | loss: 0.0972979
	speed: 0.0178s/iter; left time: 724.4630s
	iters: 300, epoch: 2 | loss: 0.0672611
	speed: 0.0199s/iter; left time: 808.9632s
	iters: 400, epoch: 2 | loss: 0.0183732
	speed: 0.0205s/iter; left time: 827.9994s
Epoch: 2 cost time: 8.096225023269653
Epoch: 2, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.969531 --> -0.976807).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0056124
	speed: 0.0624s/iter; left time: 2520.9105s
	iters: 200, epoch: 3 | loss: 0.1465883
	speed: 0.0191s/iter; left time: 767.5128s
	iters: 300, epoch: 3 | loss: 0.0079143
	speed: 0.0189s/iter; left time: 759.7836s
	iters: 400, epoch: 3 | loss: 0.0194576
	speed: 0.0199s/iter; left time: 796.8327s
Epoch: 3 cost time: 8.261398553848267
Epoch: 3, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976807 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0104172
	speed: 0.0631s/iter; left time: 2523.0039s
	iters: 200, epoch: 4 | loss: 0.0030815
	speed: 0.0202s/iter; left time: 806.6728s
	iters: 300, epoch: 4 | loss: 0.0061001
	speed: 0.0199s/iter; left time: 791.7953s
	iters: 400, epoch: 4 | loss: 0.0145331
	speed: 0.0207s/iter; left time: 821.4465s
Epoch: 4 cost time: 8.511706352233887
Epoch: 4, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0008305
	speed: 0.0638s/iter; left time: 2524.5856s
	iters: 200, epoch: 5 | loss: 0.0050881
	speed: 0.0204s/iter; left time: 805.1716s
	iters: 300, epoch: 5 | loss: 0.0344296
	speed: 0.0209s/iter; left time: 823.0072s
	iters: 400, epoch: 5 | loss: 0.0002164
	speed: 0.0216s/iter; left time: 847.3143s
Epoch: 5 cost time: 8.91832160949707
Epoch: 5, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0036973
	speed: 0.0639s/iter; left time: 2500.6316s
	iters: 200, epoch: 6 | loss: 0.0053531
	speed: 0.0200s/iter; left time: 780.4413s
	iters: 300, epoch: 6 | loss: 0.0001169
	speed: 0.0204s/iter; left time: 793.5624s
	iters: 400, epoch: 6 | loss: 0.0122579
	speed: 0.0203s/iter; left time: 786.5841s
Epoch: 6 cost time: 8.625216484069824
Epoch: 6, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0004237
	speed: 0.0674s/iter; left time: 2608.7812s
	iters: 200, epoch: 7 | loss: 0.0000289
	speed: 0.0189s/iter; left time: 728.9841s
	iters: 300, epoch: 7 | loss: 0.0007468
	speed: 0.0192s/iter; left time: 739.1390s
	iters: 400, epoch: 7 | loss: 0.0001535
	speed: 0.0196s/iter; left time: 751.4664s
Epoch: 7 cost time: 8.211575031280518
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0001594
	speed: 0.0679s/iter; left time: 2602.8806s
	iters: 200, epoch: 8 | loss: 0.0002925
	speed: 0.0198s/iter; left time: 756.4183s
	iters: 300, epoch: 8 | loss: 0.0008398
	speed: 0.0199s/iter; left time: 759.0163s
	iters: 400, epoch: 8 | loss: 0.0000799
	speed: 0.0202s/iter; left time: 767.7873s
Epoch: 8 cost time: 8.509528875350952
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0057086
	speed: 0.0763s/iter; left time: 2892.4305s
	iters: 200, epoch: 9 | loss: 0.0000008
	speed: 0.0191s/iter; left time: 720.8971s
	iters: 300, epoch: 9 | loss: 0.4193355
	speed: 0.0191s/iter; left time: 720.8934s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0179s/iter; left time: 672.5111s
Epoch: 9 cost time: 8.361231565475464
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.202 Vali Acc: 0.965 Test Loss: 0.202 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0013520
	speed: 0.0679s/iter; left time: 2545.7882s
	iters: 200, epoch: 10 | loss: 0.0000796
	speed: 0.0186s/iter; left time: 695.9148s
	iters: 300, epoch: 10 | loss: 0.0000013
	speed: 0.0187s/iter; left time: 698.9132s
	iters: 400, epoch: 10 | loss: 0.0013401
	speed: 0.0185s/iter; left time: 689.6124s
Epoch: 10 cost time: 8.196889638900757
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000561
	speed: 0.0660s/iter; left time: 2445.9421s
	iters: 200, epoch: 11 | loss: 0.0001318
	speed: 0.0205s/iter; left time: 758.9584s
	iters: 300, epoch: 11 | loss: 0.0000005
	speed: 0.0202s/iter; left time: 744.9713s
	iters: 400, epoch: 11 | loss: 0.0000078
	speed: 0.0199s/iter; left time: 730.9570s
Epoch: 11 cost time: 8.573323965072632
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000706
	speed: 0.0640s/iter; left time: 2346.4850s
	iters: 200, epoch: 12 | loss: 0.0023349
	speed: 0.0205s/iter; left time: 748.2315s
	iters: 300, epoch: 12 | loss: 0.0000293
	speed: 0.0200s/iter; left time: 727.7867s
	iters: 400, epoch: 12 | loss: 0.0001384
	speed: 0.0199s/iter; left time: 725.1122s
Epoch: 12 cost time: 8.60408329963684
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000090
	speed: 0.0632s/iter; left time: 2289.2341s
	iters: 200, epoch: 13 | loss: 0.0000696
	speed: 0.0210s/iter; left time: 759.2424s
	iters: 300, epoch: 13 | loss: 0.0000032
	speed: 0.0214s/iter; left time: 772.5583s
	iters: 400, epoch: 13 | loss: 0.3145255
	speed: 0.0209s/iter; left time: 751.9641s
Epoch: 13 cost time: 9.073674201965332
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.263 Vali Acc: 0.965 Test Loss: 0.263 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9768076398362893
model parameter : 227278
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7034630
	speed: 0.0404s/iter; left time: 1662.6613s
	iters: 200, epoch: 1 | loss: 0.1250540
	speed: 0.0211s/iter; left time: 868.9054s
	iters: 300, epoch: 1 | loss: 0.1005098
	speed: 0.0220s/iter; left time: 903.6541s
	iters: 400, epoch: 1 | loss: 0.0807830
	speed: 0.0205s/iter; left time: 836.7878s
Epoch: 1 cost time: 10.756232261657715
Epoch: 1, Steps: 413 | Train Loss: 0.406 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (inf --> -0.964983).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0386053
	speed: 0.0725s/iter; left time: 2957.2900s
	iters: 200, epoch: 2 | loss: 0.0024689
	speed: 0.0201s/iter; left time: 819.1173s
	iters: 300, epoch: 2 | loss: 0.0123919
	speed: 0.0208s/iter; left time: 843.0261s
	iters: 400, epoch: 2 | loss: 0.0073550
	speed: 0.0213s/iter; left time: 861.1241s
Epoch: 2 cost time: 8.89598274230957
Epoch: 2, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
Validation loss decreased (-0.964983 --> -0.975443).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0016897
	speed: 0.0700s/iter; left time: 2825.0407s
	iters: 200, epoch: 3 | loss: 0.0019337
	speed: 0.0189s/iter; left time: 760.6234s
	iters: 300, epoch: 3 | loss: 0.1286865
	speed: 0.0201s/iter; left time: 808.5160s
	iters: 400, epoch: 3 | loss: 0.0001376
	speed: 0.0189s/iter; left time: 756.4648s
Epoch: 3 cost time: 8.459446668624878
Epoch: 3, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.066 Vali Acc: 0.976 Test Loss: 0.066 Test Acc: 0.976
Validation loss decreased (-0.975443 --> -0.976352).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0217865
	speed: 0.0695s/iter; left time: 2776.8982s
	iters: 200, epoch: 4 | loss: 0.0276794
	speed: 0.0205s/iter; left time: 818.4857s
	iters: 300, epoch: 4 | loss: 0.0011863
	speed: 0.0217s/iter; left time: 864.1412s
	iters: 400, epoch: 4 | loss: 0.0068546
	speed: 0.0227s/iter; left time: 901.7191s
Epoch: 4 cost time: 9.186696529388428
Epoch: 4, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0338366
	speed: 0.0708s/iter; left time: 2798.1284s
	iters: 200, epoch: 5 | loss: 0.1496908
	speed: 0.0201s/iter; left time: 791.7900s
	iters: 300, epoch: 5 | loss: 0.0040615
	speed: 0.0216s/iter; left time: 848.7414s
	iters: 400, epoch: 5 | loss: 0.0022297
	speed: 0.0219s/iter; left time: 860.8728s
Epoch: 5 cost time: 9.104581117630005
Epoch: 5, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0002509
	speed: 0.0711s/iter; left time: 2781.8854s
	iters: 200, epoch: 6 | loss: 0.0024987
	speed: 0.0211s/iter; left time: 824.1061s
	iters: 300, epoch: 6 | loss: 0.2898287
	speed: 0.0212s/iter; left time: 824.4949s
	iters: 400, epoch: 6 | loss: 0.0002675
	speed: 0.0199s/iter; left time: 774.0364s
Epoch: 6 cost time: 9.091513395309448
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.053 Vali Acc: 0.984 Test Loss: 0.053 Test Acc: 0.984
Validation loss decreased (-0.976352 --> -0.983628).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0001542
	speed: 0.0727s/iter; left time: 2815.3592s
	iters: 200, epoch: 7 | loss: 0.0003711
	speed: 0.0203s/iter; left time: 785.3566s
	iters: 300, epoch: 7 | loss: 0.0000007
	speed: 0.0205s/iter; left time: 789.9749s
	iters: 400, epoch: 7 | loss: 0.0000155
	speed: 0.0203s/iter; left time: 780.8005s
Epoch: 7 cost time: 8.809698343276978
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0051014
	speed: 0.0739s/iter; left time: 2833.0213s
	iters: 200, epoch: 8 | loss: 0.0000298
	speed: 0.0205s/iter; left time: 781.9972s
	iters: 300, epoch: 8 | loss: 0.0028743
	speed: 0.0196s/iter; left time: 746.9906s
	iters: 400, epoch: 8 | loss: 0.0003775
	speed: 0.0194s/iter; left time: 739.0986s
Epoch: 8 cost time: 8.580971240997314
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0005360
	speed: 0.0759s/iter; left time: 2876.2887s
	iters: 200, epoch: 9 | loss: 0.0396730
	speed: 0.0204s/iter; left time: 771.5198s
	iters: 300, epoch: 9 | loss: 0.0001129
	speed: 0.0204s/iter; left time: 769.1521s
	iters: 400, epoch: 9 | loss: 0.0078094
	speed: 0.0219s/iter; left time: 822.0800s
Epoch: 9 cost time: 9.040525674819946
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0005722
	speed: 0.0647s/iter; left time: 2425.4199s
	iters: 200, epoch: 10 | loss: 0.0001732
	speed: 0.0208s/iter; left time: 777.4410s
	iters: 300, epoch: 10 | loss: 0.0000173
	speed: 0.0221s/iter; left time: 822.1772s
	iters: 400, epoch: 10 | loss: 0.0129237
	speed: 0.0215s/iter; left time: 801.2784s
Epoch: 10 cost time: 9.190514326095581
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.0675s/iter; left time: 2503.0234s
	iters: 200, epoch: 11 | loss: 0.0002088
	speed: 0.0222s/iter; left time: 821.7829s
	iters: 300, epoch: 11 | loss: 0.0005929
	speed: 0.0228s/iter; left time: 839.2115s
	iters: 400, epoch: 11 | loss: 0.0000118
	speed: 0.0223s/iter; left time: 820.2114s
Epoch: 11 cost time: 9.637940406799316
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000152
	speed: 0.0657s/iter; left time: 2410.0037s
	iters: 200, epoch: 12 | loss: 0.0035325
	speed: 0.0224s/iter; left time: 817.3334s
	iters: 300, epoch: 12 | loss: 0.0000263
	speed: 0.0213s/iter; left time: 778.3404s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 790.4708s
Epoch: 12 cost time: 9.314059257507324
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000569
	speed: 0.0719s/iter; left time: 2606.3516s
	iters: 200, epoch: 13 | loss: 0.0000055
	speed: 0.0216s/iter; left time: 781.1335s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 777.5703s
	iters: 400, epoch: 13 | loss: 0.0000040
	speed: 0.0216s/iter; left time: 776.5727s
Epoch: 13 cost time: 9.2062406539917
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000009
	speed: 0.0790s/iter; left time: 2832.4629s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0211s/iter; left time: 755.2819s
	iters: 300, epoch: 14 | loss: 0.0000003
	speed: 0.0211s/iter; left time: 753.0123s
	iters: 400, epoch: 14 | loss: 0.0000007
	speed: 0.0215s/iter; left time: 764.9343s
Epoch: 14 cost time: 9.208505868911743
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.401 Vali Acc: 0.951 Test Loss: 0.401 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0751s/iter; left time: 2658.7869s
	iters: 200, epoch: 15 | loss: 0.0000259
	speed: 0.0205s/iter; left time: 725.0201s
	iters: 300, epoch: 15 | loss: 0.0000075
	speed: 0.0203s/iter; left time: 716.0632s
	iters: 400, epoch: 15 | loss: 0.0002824
	speed: 0.0209s/iter; left time: 732.3488s
Epoch: 15 cost time: 9.026309251785278
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.971 Test Loss: 0.201 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000006
	speed: 0.0777s/iter; left time: 2719.2849s
	iters: 200, epoch: 16 | loss: 0.0003146
	speed: 0.0198s/iter; left time: 689.4080s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0210s/iter; left time: 732.3456s
	iters: 400, epoch: 16 | loss: 0.0000008
	speed: 0.0210s/iter; left time: 730.3283s
Epoch: 16 cost time: 8.871017694473267
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.237 Vali Acc: 0.972 Test Loss: 0.237 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 194510
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6717708
	speed: 0.0351s/iter; left time: 1445.5172s
	iters: 200, epoch: 1 | loss: 0.1186487
	speed: 0.0214s/iter; left time: 880.2228s
	iters: 300, epoch: 1 | loss: 0.0827080
	speed: 0.0219s/iter; left time: 899.5415s
	iters: 400, epoch: 1 | loss: 0.0604253
	speed: 0.0205s/iter; left time: 838.7551s
Epoch: 1 cost time: 10.24074125289917
Epoch: 1, Steps: 413 | Train Loss: 0.420 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0104573
	speed: 0.0636s/iter; left time: 2593.6060s
	iters: 200, epoch: 2 | loss: 0.0028825
	speed: 0.0207s/iter; left time: 843.0727s
	iters: 300, epoch: 2 | loss: 0.0137536
	speed: 0.0206s/iter; left time: 837.5352s
	iters: 400, epoch: 2 | loss: 0.0087669
	speed: 0.0216s/iter; left time: 875.3958s
Epoch: 2 cost time: 8.86836290359497
Epoch: 2, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.064 Vali Acc: 0.978 Test Loss: 0.064 Test Acc: 0.978
Validation loss decreased (-0.966802 --> -0.977717).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0009985
	speed: 0.0608s/iter; left time: 2456.6198s
	iters: 200, epoch: 3 | loss: 0.0016178
	speed: 0.0198s/iter; left time: 796.0696s
	iters: 300, epoch: 3 | loss: 0.0918390
	speed: 0.0191s/iter; left time: 765.3957s
	iters: 400, epoch: 3 | loss: 0.0001445
	speed: 0.0205s/iter; left time: 821.1060s
Epoch: 3 cost time: 8.354190826416016
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0462922
	speed: 0.0634s/iter; left time: 2532.7135s
	iters: 200, epoch: 4 | loss: 0.0169745
	speed: 0.0197s/iter; left time: 784.4056s
	iters: 300, epoch: 4 | loss: 0.0021814
	speed: 0.0190s/iter; left time: 753.6195s
	iters: 400, epoch: 4 | loss: 0.0053292
	speed: 0.0189s/iter; left time: 751.4676s
Epoch: 4 cost time: 8.298720121383667
Epoch: 4, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0009245
	speed: 0.0697s/iter; left time: 2758.3394s
	iters: 200, epoch: 5 | loss: 0.0014814
	speed: 0.0191s/iter; left time: 752.9377s
	iters: 300, epoch: 5 | loss: 0.0919677
	speed: 0.0209s/iter; left time: 821.5935s
	iters: 400, epoch: 5 | loss: 0.0001682
	speed: 0.0201s/iter; left time: 789.1560s
Epoch: 5 cost time: 8.55075740814209
Epoch: 5, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0001455
	speed: 0.0709s/iter; left time: 2773.2184s
	iters: 200, epoch: 6 | loss: 0.1165144
	speed: 0.0191s/iter; left time: 746.8864s
	iters: 300, epoch: 6 | loss: 0.0000323
	speed: 0.0193s/iter; left time: 750.0370s
	iters: 400, epoch: 6 | loss: 0.0913575
	speed: 0.0201s/iter; left time: 779.3737s
Epoch: 6 cost time: 8.350247621536255
Epoch: 6, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0037867
	speed: 0.0678s/iter; left time: 2627.3374s
	iters: 200, epoch: 7 | loss: 0.0000334
	speed: 0.0203s/iter; left time: 784.9507s
	iters: 300, epoch: 7 | loss: 0.0013330
	speed: 0.0198s/iter; left time: 764.5986s
	iters: 400, epoch: 7 | loss: 0.0000788
	speed: 0.0204s/iter; left time: 782.9304s
Epoch: 7 cost time: 8.569754362106323
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0874139
	speed: 0.0674s/iter; left time: 2583.2875s
	iters: 200, epoch: 8 | loss: 0.0515246
	speed: 0.0205s/iter; left time: 782.8254s
	iters: 300, epoch: 8 | loss: 0.0043420
	speed: 0.0199s/iter; left time: 758.0006s
	iters: 400, epoch: 8 | loss: 0.0000034
	speed: 0.0210s/iter; left time: 798.3676s
Epoch: 8 cost time: 8.708470821380615
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0013750
	speed: 0.0655s/iter; left time: 2484.0400s
	iters: 200, epoch: 9 | loss: 0.0272931
	speed: 0.0204s/iter; left time: 771.4540s
	iters: 300, epoch: 9 | loss: 0.0000168
	speed: 0.0202s/iter; left time: 760.2484s
	iters: 400, epoch: 9 | loss: 0.0000005
	speed: 0.0208s/iter; left time: 781.5784s
Epoch: 9 cost time: 8.727569818496704
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000219
	speed: 0.0679s/iter; left time: 2546.6942s
	iters: 200, epoch: 10 | loss: 0.0000026
	speed: 0.0188s/iter; left time: 701.1695s
	iters: 300, epoch: 10 | loss: 0.0018579
	speed: 0.0190s/iter; left time: 706.7938s
	iters: 400, epoch: 10 | loss: 0.0000042
	speed: 0.0183s/iter; left time: 679.9934s
Epoch: 10 cost time: 8.05571174621582
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.4137045
	speed: 0.0649s/iter; left time: 2405.7957s
	iters: 200, epoch: 11 | loss: 0.0097519
	speed: 0.0203s/iter; left time: 750.7723s
	iters: 300, epoch: 11 | loss: 0.0047946
	speed: 0.0206s/iter; left time: 759.7518s
	iters: 400, epoch: 11 | loss: 0.0000267
	speed: 0.0216s/iter; left time: 793.3672s
Epoch: 11 cost time: 8.892825603485107
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000434
	speed: 0.0684s/iter; left time: 2508.7091s
	iters: 200, epoch: 12 | loss: 0.0000916
	speed: 0.0199s/iter; left time: 728.2244s
	iters: 300, epoch: 12 | loss: 0.0007164
	speed: 0.0197s/iter; left time: 718.4794s
	iters: 400, epoch: 12 | loss: 0.0000152
	speed: 0.0212s/iter; left time: 771.3496s
Epoch: 12 cost time: 8.818948030471802
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 194510
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7382916
	speed: 0.0395s/iter; left time: 1629.2029s
	iters: 200, epoch: 1 | loss: 0.1291437
	speed: 0.0211s/iter; left time: 865.7558s
	iters: 300, epoch: 1 | loss: 0.0943498
	speed: 0.0208s/iter; left time: 854.3467s
	iters: 400, epoch: 1 | loss: 0.0442286
	speed: 0.0214s/iter; left time: 875.4612s
Epoch: 1 cost time: 10.627346754074097
Epoch: 1, Steps: 413 | Train Loss: 0.452 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
Validation loss decreased (inf --> -0.962254).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0541717
	speed: 0.0678s/iter; left time: 2765.8981s
	iters: 200, epoch: 2 | loss: 0.0031483
	speed: 0.0208s/iter; left time: 847.0255s
	iters: 300, epoch: 2 | loss: 0.0119454
	speed: 0.0193s/iter; left time: 783.1386s
	iters: 400, epoch: 2 | loss: 0.0135893
	speed: 0.0202s/iter; left time: 818.5214s
Epoch: 2 cost time: 8.663250923156738
Epoch: 2, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.054 Vali Acc: 0.980 Test Loss: 0.054 Test Acc: 0.980
Validation loss decreased (-0.962254 --> -0.980445).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0014421
	speed: 0.0667s/iter; left time: 2694.4091s
	iters: 200, epoch: 3 | loss: 0.0066862
	speed: 0.0199s/iter; left time: 801.0789s
	iters: 300, epoch: 3 | loss: 0.0251329
	speed: 0.0198s/iter; left time: 797.4186s
	iters: 400, epoch: 3 | loss: 0.0003990
	speed: 0.0192s/iter; left time: 768.1251s
Epoch: 3 cost time: 8.42557954788208
Epoch: 3, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.059 Vali Acc: 0.978 Test Loss: 0.059 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0079478
	speed: 0.0689s/iter; left time: 2754.5564s
	iters: 200, epoch: 4 | loss: 0.0126702
	speed: 0.0195s/iter; left time: 775.8335s
	iters: 300, epoch: 4 | loss: 0.0005874
	speed: 0.0186s/iter; left time: 738.5575s
	iters: 400, epoch: 4 | loss: 0.0265321
	speed: 0.0189s/iter; left time: 749.4760s
Epoch: 4 cost time: 8.170871019363403
Epoch: 4, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0510303
	speed: 0.0670s/iter; left time: 2651.5565s
	iters: 200, epoch: 5 | loss: 0.2731656
	speed: 0.0194s/iter; left time: 764.3246s
	iters: 300, epoch: 5 | loss: 0.0039588
	speed: 0.0196s/iter; left time: 770.4960s
	iters: 400, epoch: 5 | loss: 0.0145854
	speed: 0.0201s/iter; left time: 789.0024s
Epoch: 5 cost time: 8.410654544830322
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0001861
	speed: 0.0677s/iter; left time: 2647.9212s
	iters: 200, epoch: 6 | loss: 0.0033727
	speed: 0.0203s/iter; left time: 790.6547s
	iters: 300, epoch: 6 | loss: 0.0003712
	speed: 0.0206s/iter; left time: 802.9062s
	iters: 400, epoch: 6 | loss: 0.0001604
	speed: 0.0208s/iter; left time: 806.4401s
Epoch: 6 cost time: 8.77147626876831
Epoch: 6, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0006864
	speed: 0.0731s/iter; left time: 2831.0094s
	iters: 200, epoch: 7 | loss: 0.0010661
	speed: 0.0195s/iter; left time: 754.0976s
	iters: 300, epoch: 7 | loss: 0.0000832
	speed: 0.0215s/iter; left time: 829.5501s
	iters: 400, epoch: 7 | loss: 0.0000470
	speed: 0.0221s/iter; left time: 850.3088s
Epoch: 7 cost time: 9.104851722717285
Epoch: 7, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1971150
	speed: 0.0694s/iter; left time: 2659.9935s
	iters: 200, epoch: 8 | loss: 0.5838702
	speed: 0.0211s/iter; left time: 806.0845s
	iters: 300, epoch: 8 | loss: 0.0021572
	speed: 0.0214s/iter; left time: 815.2733s
	iters: 400, epoch: 8 | loss: 0.0000566
	speed: 0.0218s/iter; left time: 830.2841s
Epoch: 8 cost time: 9.251912832260132
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000409
	speed: 0.0680s/iter; left time: 2576.0446s
	iters: 200, epoch: 9 | loss: 0.8386995
	speed: 0.0212s/iter; left time: 801.1057s
	iters: 300, epoch: 9 | loss: 0.0003102
	speed: 0.0199s/iter; left time: 748.4558s
	iters: 400, epoch: 9 | loss: 0.3871033
	speed: 0.0198s/iter; left time: 743.9691s
Epoch: 9 cost time: 8.745633840560913
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.2862107
	speed: 0.0647s/iter; left time: 2426.8847s
	iters: 200, epoch: 10 | loss: 0.0001877
	speed: 0.0197s/iter; left time: 737.7692s
	iters: 300, epoch: 10 | loss: 0.0002452
	speed: 0.0200s/iter; left time: 747.4930s
	iters: 400, epoch: 10 | loss: 0.0000104
	speed: 0.0206s/iter; left time: 765.2702s
Epoch: 10 cost time: 8.589654207229614
Epoch: 10, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.4519575
	speed: 0.0649s/iter; left time: 2406.6532s
	iters: 200, epoch: 11 | loss: 0.0003742
	speed: 0.0204s/iter; left time: 752.3632s
	iters: 300, epoch: 11 | loss: 0.0000846
	speed: 0.0198s/iter; left time: 731.6404s
	iters: 400, epoch: 11 | loss: 0.3369319
	speed: 0.0211s/iter; left time: 775.1603s
Epoch: 11 cost time: 8.690040826797485
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.962 Test Loss: 0.203 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0001335
	speed: 0.0680s/iter; left time: 2492.2386s
	iters: 200, epoch: 12 | loss: 0.0000479
	speed: 0.0194s/iter; left time: 709.3160s
	iters: 300, epoch: 12 | loss: 0.0010784
	speed: 0.0182s/iter; left time: 665.0712s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 811.5133s
Epoch: 12 cost time: 8.733311176300049
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 194510
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9097328
	speed: 0.0392s/iter; left time: 1616.9207s
	iters: 200, epoch: 1 | loss: 0.1158489
	speed: 0.0206s/iter; left time: 845.5225s
	iters: 300, epoch: 1 | loss: 0.2070968
	speed: 0.0210s/iter; left time: 861.4472s
	iters: 400, epoch: 1 | loss: 0.0839883
	speed: 0.0208s/iter; left time: 849.0254s
Epoch: 1 cost time: 10.507768392562866
Epoch: 1, Steps: 413 | Train Loss: 0.536 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (inf --> -0.967712).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7479275
	speed: 0.0712s/iter; left time: 2904.0415s
	iters: 200, epoch: 2 | loss: 0.0052086
	speed: 0.0212s/iter; left time: 863.1479s
	iters: 300, epoch: 2 | loss: 0.0100767
	speed: 0.0212s/iter; left time: 858.7207s
	iters: 400, epoch: 2 | loss: 0.0366224
	speed: 0.0206s/iter; left time: 832.0474s
Epoch: 2 cost time: 8.912049293518066
Epoch: 2, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.967712 --> -0.980445).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0009130
	speed: 0.0730s/iter; left time: 2945.7663s
	iters: 200, epoch: 3 | loss: 0.0158492
	speed: 0.0208s/iter; left time: 839.6998s
	iters: 300, epoch: 3 | loss: 0.0417080
	speed: 0.0195s/iter; left time: 784.6676s
	iters: 400, epoch: 3 | loss: 0.0057448
	speed: 0.0207s/iter; left time: 831.5089s
Epoch: 3 cost time: 8.761175155639648
Epoch: 3, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0025948
	speed: 0.0703s/iter; left time: 2807.4298s
	iters: 200, epoch: 4 | loss: 0.0150166
	speed: 0.0212s/iter; left time: 843.7337s
	iters: 300, epoch: 4 | loss: 0.0015679
	speed: 0.0201s/iter; left time: 799.0433s
	iters: 400, epoch: 4 | loss: 0.0207468
	speed: 0.0197s/iter; left time: 783.0778s
Epoch: 4 cost time: 8.693119287490845
Epoch: 4, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.083 Vali Acc: 0.972 Test Loss: 0.083 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0060242
	speed: 0.0672s/iter; left time: 2656.5897s
	iters: 200, epoch: 5 | loss: 0.0009015
	speed: 0.0203s/iter; left time: 801.8655s
	iters: 300, epoch: 5 | loss: 0.0040649
	speed: 0.0196s/iter; left time: 770.0355s
	iters: 400, epoch: 5 | loss: 0.0014458
	speed: 0.0200s/iter; left time: 783.5752s
Epoch: 5 cost time: 8.588576793670654
Epoch: 5, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0143957
	speed: 0.0664s/iter; left time: 2597.0238s
	iters: 200, epoch: 6 | loss: 0.0367978
	speed: 0.0219s/iter; left time: 854.7354s
	iters: 300, epoch: 6 | loss: 0.0001698
	speed: 0.0216s/iter; left time: 841.7288s
	iters: 400, epoch: 6 | loss: 0.0012249
	speed: 0.0212s/iter; left time: 823.2752s
Epoch: 6 cost time: 9.156019449234009
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.062 Vali Acc: 0.979 Test Loss: 0.062 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0004290
	speed: 0.0662s/iter; left time: 2564.7387s
	iters: 200, epoch: 7 | loss: 0.0000895
	speed: 0.0202s/iter; left time: 780.8245s
	iters: 300, epoch: 7 | loss: 0.0000008
	speed: 0.0203s/iter; left time: 781.3879s
	iters: 400, epoch: 7 | loss: 0.0003096
	speed: 0.0207s/iter; left time: 793.8341s
Epoch: 7 cost time: 8.829066753387451
Epoch: 7, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0045264
	speed: 0.0662s/iter; left time: 2537.7203s
	iters: 200, epoch: 8 | loss: 0.0110244
	speed: 0.0211s/iter; left time: 805.0271s
	iters: 300, epoch: 8 | loss: 0.0001021
	speed: 0.0217s/iter; left time: 826.1246s
	iters: 400, epoch: 8 | loss: 0.0026798
	speed: 0.0212s/iter; left time: 806.5919s
Epoch: 8 cost time: 9.233535051345825
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000951
	speed: 0.0731s/iter; left time: 2771.5570s
	iters: 200, epoch: 9 | loss: 0.0311291
	speed: 0.0195s/iter; left time: 737.6647s
	iters: 300, epoch: 9 | loss: 0.0004886
	speed: 0.0212s/iter; left time: 797.4659s
	iters: 400, epoch: 9 | loss: 0.0012023
	speed: 0.0201s/iter; left time: 757.2192s
Epoch: 9 cost time: 8.731263399124146
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1550637
	speed: 0.0772s/iter; left time: 2892.8988s
	iters: 200, epoch: 10 | loss: 0.0000272
	speed: 0.0217s/iter; left time: 810.0076s
	iters: 300, epoch: 10 | loss: 0.0810378
	speed: 0.0215s/iter; left time: 800.5656s
	iters: 400, epoch: 10 | loss: 0.0007114
	speed: 0.0205s/iter; left time: 763.2007s
Epoch: 10 cost time: 9.190454959869385
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1041876
	speed: 0.0798s/iter; left time: 2957.8752s
	iters: 200, epoch: 11 | loss: 0.0019234
	speed: 0.0224s/iter; left time: 827.4457s
	iters: 300, epoch: 11 | loss: 0.2789702
	speed: 0.0200s/iter; left time: 736.2717s
	iters: 400, epoch: 11 | loss: 0.0000338
	speed: 0.0196s/iter; left time: 721.4362s
Epoch: 11 cost time: 8.97077488899231
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.230 Vali Acc: 0.962 Test Loss: 0.230 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000470
	speed: 0.0703s/iter; left time: 2575.4658s
	iters: 200, epoch: 12 | loss: 0.0007319
	speed: 0.0187s/iter; left time: 685.3366s
	iters: 300, epoch: 12 | loss: 0.0004302
	speed: 0.0198s/iter; left time: 720.8516s
	iters: 400, epoch: 12 | loss: 0.0000011
	speed: 0.0212s/iter; left time: 771.7147s
Epoch: 12 cost time: 8.567416667938232
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.970 Test Loss: 0.189 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 194510
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4131622
	speed: 0.0382s/iter; left time: 1574.9170s
	iters: 200, epoch: 1 | loss: 0.1247358
	speed: 0.0207s/iter; left time: 849.2711s
	iters: 300, epoch: 1 | loss: 0.0682176
	speed: 0.0225s/iter; left time: 922.3641s
	iters: 400, epoch: 1 | loss: 0.0931119
	speed: 0.0223s/iter; left time: 910.4687s
Epoch: 1 cost time: 10.759685516357422
Epoch: 1, Steps: 413 | Train Loss: 0.415 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
Validation loss decreased (inf --> -0.975443).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0314352
	speed: 0.0710s/iter; left time: 2895.3097s
	iters: 200, epoch: 2 | loss: 0.0354925
	speed: 0.0216s/iter; left time: 880.7538s
	iters: 300, epoch: 2 | loss: 0.0095920
	speed: 0.0226s/iter; left time: 915.4371s
	iters: 400, epoch: 2 | loss: 0.1167584
	speed: 0.0212s/iter; left time: 856.9893s
Epoch: 2 cost time: 9.32162594795227
Epoch: 2, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.055 Vali Acc: 0.981 Test Loss: 0.055 Test Acc: 0.981
Validation loss decreased (-0.975443 --> -0.980900).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0071469
	speed: 0.0634s/iter; left time: 2561.5417s
	iters: 200, epoch: 3 | loss: 0.0068717
	speed: 0.0206s/iter; left time: 831.0441s
	iters: 300, epoch: 3 | loss: 0.0079700
	speed: 0.0198s/iter; left time: 795.7489s
	iters: 400, epoch: 3 | loss: 0.0058828
	speed: 0.0190s/iter; left time: 762.0098s
Epoch: 3 cost time: 8.559772729873657
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.088 Vali Acc: 0.971 Test Loss: 0.088 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0001134
	speed: 0.0746s/iter; left time: 2979.2933s
	iters: 200, epoch: 4 | loss: 0.0205951
	speed: 0.0207s/iter; left time: 825.0195s
	iters: 300, epoch: 4 | loss: 0.0126879
	speed: 0.0210s/iter; left time: 833.9263s
	iters: 400, epoch: 4 | loss: 0.0049891
	speed: 0.0194s/iter; left time: 769.5710s
Epoch: 4 cost time: 8.901176929473877
Epoch: 4, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0009121
	speed: 0.0742s/iter; left time: 2934.9490s
	iters: 200, epoch: 5 | loss: 0.0001865
	speed: 0.0194s/iter; left time: 763.4755s
	iters: 300, epoch: 5 | loss: 0.0019429
	speed: 0.0202s/iter; left time: 795.1660s
	iters: 400, epoch: 5 | loss: 0.0009544
	speed: 0.0207s/iter; left time: 814.0515s
Epoch: 5 cost time: 8.670755863189697
Epoch: 5, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000363
	speed: 0.0699s/iter; left time: 2733.8579s
	iters: 200, epoch: 6 | loss: 0.0391503
	speed: 0.0208s/iter; left time: 810.2460s
	iters: 300, epoch: 6 | loss: 0.0142808
	speed: 0.0216s/iter; left time: 841.4093s
	iters: 400, epoch: 6 | loss: 0.0030048
	speed: 0.0223s/iter; left time: 865.9460s
Epoch: 6 cost time: 9.192801713943481
Epoch: 6, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000566
	speed: 0.0663s/iter; left time: 2567.5753s
	iters: 200, epoch: 7 | loss: 0.0007667
	speed: 0.0229s/iter; left time: 886.0639s
	iters: 300, epoch: 7 | loss: 0.0002658
	speed: 0.0215s/iter; left time: 829.3215s
	iters: 400, epoch: 7 | loss: 0.0022073
	speed: 0.0222s/iter; left time: 854.2271s
Epoch: 7 cost time: 9.509580612182617
Epoch: 7, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.964 Test Loss: 0.198 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0125916
	speed: 0.0694s/iter; left time: 2657.4653s
	iters: 200, epoch: 8 | loss: 0.0001754
	speed: 0.0231s/iter; left time: 884.4106s
	iters: 300, epoch: 8 | loss: 0.0509709
	speed: 0.0221s/iter; left time: 843.1792s
	iters: 400, epoch: 8 | loss: 0.0498793
	speed: 0.0211s/iter; left time: 802.2976s
Epoch: 8 cost time: 9.443942785263062
Epoch: 8, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0003173
	speed: 0.0707s/iter; left time: 2679.4882s
	iters: 200, epoch: 9 | loss: 0.0000817
	speed: 0.0210s/iter; left time: 792.6313s
	iters: 300, epoch: 9 | loss: 0.0000682
	speed: 0.0217s/iter; left time: 817.0131s
	iters: 400, epoch: 9 | loss: 0.0002943
	speed: 0.0227s/iter; left time: 852.4781s
Epoch: 9 cost time: 9.359373092651367
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0039569
	speed: 0.0739s/iter; left time: 2768.5608s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 799.2755s
	iters: 300, epoch: 10 | loss: 0.0004978
	speed: 0.0220s/iter; left time: 822.1059s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0221s/iter; left time: 822.8271s
Epoch: 10 cost time: 9.4810791015625
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000010
	speed: 0.0807s/iter; left time: 2991.8684s
	iters: 200, epoch: 11 | loss: 0.0554918
	speed: 0.0206s/iter; left time: 763.3166s
	iters: 300, epoch: 11 | loss: 0.0000017
	speed: 0.0208s/iter; left time: 766.5096s
	iters: 400, epoch: 11 | loss: 0.0000145
	speed: 0.0199s/iter; left time: 730.2675s
Epoch: 11 cost time: 8.999602556228638
Epoch: 11, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0802s/iter; left time: 2940.4122s
	iters: 200, epoch: 12 | loss: 0.0000045
	speed: 0.0201s/iter; left time: 733.6315s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0203s/iter; left time: 740.0511s
	iters: 400, epoch: 12 | loss: 0.0213147
	speed: 0.0186s/iter; left time: 674.8435s
Epoch: 12 cost time: 8.789381265640259
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 178126
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4723437
	speed: 0.0363s/iter; left time: 1496.3042s
	iters: 200, epoch: 1 | loss: 0.1455967
	speed: 0.0217s/iter; left time: 890.4380s
	iters: 300, epoch: 1 | loss: 0.0743820
	speed: 0.0217s/iter; left time: 889.9623s
	iters: 400, epoch: 1 | loss: 0.0564349
	speed: 0.0208s/iter; left time: 848.7135s
Epoch: 1 cost time: 10.407655000686646
Epoch: 1, Steps: 413 | Train Loss: 0.427 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
Validation loss decreased (inf --> -0.976352).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0320198
	speed: 0.0653s/iter; left time: 2663.5754s
	iters: 200, epoch: 2 | loss: 0.0534016
	speed: 0.0214s/iter; left time: 871.0006s
	iters: 300, epoch: 2 | loss: 0.0082666
	speed: 0.0207s/iter; left time: 842.0002s
	iters: 400, epoch: 2 | loss: 0.1435734
	speed: 0.0213s/iter; left time: 863.6522s
Epoch: 2 cost time: 9.053252935409546
Epoch: 2, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
Validation loss decreased (-0.976352 --> -0.979536).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0081175
	speed: 0.0691s/iter; left time: 2789.9404s
	iters: 200, epoch: 3 | loss: 0.0035548
	speed: 0.0228s/iter; left time: 917.2867s
	iters: 300, epoch: 3 | loss: 0.0599900
	speed: 0.0220s/iter; left time: 884.1735s
	iters: 400, epoch: 3 | loss: 0.0038998
	speed: 0.0211s/iter; left time: 845.7692s
Epoch: 3 cost time: 9.512887954711914
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.086 Vali Acc: 0.971 Test Loss: 0.086 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000584
	speed: 0.0703s/iter; left time: 2810.1746s
	iters: 200, epoch: 4 | loss: 0.0215476
	speed: 0.0199s/iter; left time: 791.3790s
	iters: 300, epoch: 4 | loss: 0.0031119
	speed: 0.0197s/iter; left time: 781.9298s
	iters: 400, epoch: 4 | loss: 0.0044960
	speed: 0.0194s/iter; left time: 769.9597s
Epoch: 4 cost time: 8.658471584320068
Epoch: 4, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979536 --> -0.980445).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0300743
	speed: 0.0788s/iter; left time: 3115.1693s
	iters: 200, epoch: 5 | loss: 0.0023994
	speed: 0.0201s/iter; left time: 794.5417s
	iters: 300, epoch: 5 | loss: 0.0125490
	speed: 0.0205s/iter; left time: 806.4035s
	iters: 400, epoch: 5 | loss: 0.0002554
	speed: 0.0203s/iter; left time: 797.6021s
Epoch: 5 cost time: 8.866508483886719
Epoch: 5, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000670
	speed: 0.0792s/iter; left time: 3099.0599s
	iters: 200, epoch: 6 | loss: 0.0012115
	speed: 0.0187s/iter; left time: 729.5316s
	iters: 300, epoch: 6 | loss: 0.0002164
	speed: 0.0195s/iter; left time: 759.9943s
	iters: 400, epoch: 6 | loss: 0.0163595
	speed: 0.0192s/iter; left time: 746.7924s
Epoch: 6 cost time: 8.618037939071655
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0381379
	speed: 0.0728s/iter; left time: 2818.0302s
	iters: 200, epoch: 7 | loss: 0.0000486
	speed: 0.0185s/iter; left time: 715.2673s
	iters: 300, epoch: 7 | loss: 0.0023638
	speed: 0.0184s/iter; left time: 710.1206s
	iters: 400, epoch: 7 | loss: 0.2098965
	speed: 0.0179s/iter; left time: 689.5982s
Epoch: 7 cost time: 8.085638284683228
Epoch: 7, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000735
	speed: 0.0736s/iter; left time: 2820.8873s
	iters: 200, epoch: 8 | loss: 0.2486040
	speed: 0.0194s/iter; left time: 743.0402s
	iters: 300, epoch: 8 | loss: 0.8482370
	speed: 0.0200s/iter; left time: 760.4352s
	iters: 400, epoch: 8 | loss: 0.0000334
	speed: 0.0205s/iter; left time: 779.2242s
Epoch: 8 cost time: 8.484437465667725
Epoch: 8, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000076
	speed: 0.0656s/iter; left time: 2484.4581s
	iters: 200, epoch: 9 | loss: 0.0000101
	speed: 0.0211s/iter; left time: 798.0653s
	iters: 300, epoch: 9 | loss: 0.0012334
	speed: 0.0207s/iter; left time: 781.2023s
	iters: 400, epoch: 9 | loss: 0.0008688
	speed: 0.0224s/iter; left time: 843.7304s
Epoch: 9 cost time: 9.215452909469604
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.218 Vali Acc: 0.965 Test Loss: 0.218 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000160
	speed: 0.0674s/iter; left time: 2527.9778s
	iters: 200, epoch: 10 | loss: 0.0000728
	speed: 0.0225s/iter; left time: 841.6312s
	iters: 300, epoch: 10 | loss: 0.0005570
	speed: 0.0214s/iter; left time: 798.3438s
	iters: 400, epoch: 10 | loss: 0.0000019
	speed: 0.0219s/iter; left time: 812.5309s
Epoch: 10 cost time: 9.356891632080078
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000228
	speed: 0.0690s/iter; left time: 2556.2325s
	iters: 200, epoch: 11 | loss: 0.0014633
	speed: 0.0205s/iter; left time: 759.4013s
	iters: 300, epoch: 11 | loss: 0.0000677
	speed: 0.0203s/iter; left time: 749.8593s
	iters: 400, epoch: 11 | loss: 0.0004280
	speed: 0.0202s/iter; left time: 743.0616s
Epoch: 11 cost time: 8.984164237976074
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.291 Vali Acc: 0.965 Test Loss: 0.291 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 2492.4276s
	iters: 200, epoch: 12 | loss: 0.0000008
	speed: 0.0220s/iter; left time: 802.6458s
	iters: 300, epoch: 12 | loss: 0.0001317
	speed: 0.0214s/iter; left time: 781.5200s
	iters: 400, epoch: 12 | loss: 0.0000012
	speed: 0.0209s/iter; left time: 761.3959s
Epoch: 12 cost time: 9.164869546890259
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000003
	speed: 0.0770s/iter; left time: 2791.6153s
	iters: 200, epoch: 13 | loss: 0.0000008
	speed: 0.0197s/iter; left time: 713.6192s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 747.0383s
	iters: 400, epoch: 13 | loss: 0.0000003
	speed: 0.0215s/iter; left time: 773.1773s
Epoch: 13 cost time: 9.086039543151855
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0806s/iter; left time: 2886.4054s
	iters: 200, epoch: 14 | loss: 0.0001252
	speed: 0.0218s/iter; left time: 779.6182s
	iters: 300, epoch: 14 | loss: 0.0000303
	speed: 0.0217s/iter; left time: 771.4750s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 746.0365s
Epoch: 14 cost time: 9.263347387313843
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 178126
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5857578
	speed: 0.0392s/iter; left time: 1617.0259s
	iters: 200, epoch: 1 | loss: 0.1686257
	speed: 0.0212s/iter; left time: 871.6680s
	iters: 300, epoch: 1 | loss: 0.0845550
	speed: 0.0211s/iter; left time: 866.4547s
	iters: 400, epoch: 1 | loss: 0.0976803
	speed: 0.0219s/iter; left time: 896.6756s
Epoch: 1 cost time: 10.701265096664429
Epoch: 1, Steps: 413 | Train Loss: 0.459 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (inf --> -0.978626).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0128482
	speed: 0.0727s/iter; left time: 2964.2014s
	iters: 200, epoch: 2 | loss: 0.0754668
	speed: 0.0213s/iter; left time: 867.4039s
	iters: 300, epoch: 2 | loss: 0.0204895
	speed: 0.0200s/iter; left time: 810.7598s
	iters: 400, epoch: 2 | loss: 0.2717397
	speed: 0.0204s/iter; left time: 826.8811s
Epoch: 2 cost time: 8.966468095779419
Epoch: 2, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
Validation loss decreased (-0.978626 --> -0.979536).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0015553
	speed: 0.0643s/iter; left time: 2596.7842s
	iters: 200, epoch: 3 | loss: 0.0058372
	speed: 0.0214s/iter; left time: 862.7154s
	iters: 300, epoch: 3 | loss: 0.0600681
	speed: 0.0205s/iter; left time: 824.7824s
	iters: 400, epoch: 3 | loss: 0.0009561
	speed: 0.0215s/iter; left time: 861.2978s
Epoch: 3 cost time: 9.004599332809448
Epoch: 3, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.065 Vali Acc: 0.978 Test Loss: 0.065 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0003155
	speed: 0.0641s/iter; left time: 2562.3616s
	iters: 200, epoch: 4 | loss: 0.0050149
	speed: 0.0210s/iter; left time: 835.9596s
	iters: 300, epoch: 4 | loss: 0.0133057
	speed: 0.0209s/iter; left time: 830.7069s
	iters: 400, epoch: 4 | loss: 0.0106871
	speed: 0.0212s/iter; left time: 841.1809s
Epoch: 4 cost time: 8.994385719299316
Epoch: 4, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0041226
	speed: 0.0685s/iter; left time: 2708.4703s
	iters: 200, epoch: 5 | loss: 0.0017490
	speed: 0.0193s/iter; left time: 761.8001s
	iters: 300, epoch: 5 | loss: 0.0307011
	speed: 0.0198s/iter; left time: 780.3942s
	iters: 400, epoch: 5 | loss: 0.0008333
	speed: 0.0200s/iter; left time: 784.7881s
Epoch: 5 cost time: 8.602397203445435
Epoch: 5, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0001486
	speed: 0.0718s/iter; left time: 2810.1611s
	iters: 200, epoch: 6 | loss: 0.0254385
	speed: 0.0204s/iter; left time: 794.8336s
	iters: 300, epoch: 6 | loss: 0.0006276
	speed: 0.0197s/iter; left time: 767.4432s
	iters: 400, epoch: 6 | loss: 0.2201977
	speed: 0.0188s/iter; left time: 731.4371s
Epoch: 6 cost time: 8.591352701187134
Epoch: 6, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0473552
	speed: 0.0717s/iter; left time: 2777.1448s
	iters: 200, epoch: 7 | loss: 0.0006549
	speed: 0.0201s/iter; left time: 777.8285s
	iters: 300, epoch: 7 | loss: 0.0000811
	speed: 0.0215s/iter; left time: 827.3324s
	iters: 400, epoch: 7 | loss: 0.0047613
	speed: 0.0197s/iter; left time: 758.7190s
Epoch: 7 cost time: 8.7683584690094
Epoch: 7, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0001986
	speed: 0.0695s/iter; left time: 2663.5242s
	iters: 200, epoch: 8 | loss: 0.3927850
	speed: 0.0199s/iter; left time: 759.2974s
	iters: 300, epoch: 8 | loss: 0.3620720
	speed: 0.0194s/iter; left time: 741.0339s
	iters: 400, epoch: 8 | loss: 0.0057730
	speed: 0.0183s/iter; left time: 695.7878s
Epoch: 8 cost time: 8.377352476119995
Epoch: 8, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.257 Vali Acc: 0.958 Test Loss: 0.257 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000762
	speed: 0.0672s/iter; left time: 2548.1765s
	iters: 200, epoch: 9 | loss: 0.0000012
	speed: 0.0202s/iter; left time: 764.5064s
	iters: 300, epoch: 9 | loss: 0.0017646
	speed: 0.0207s/iter; left time: 779.6272s
	iters: 400, epoch: 9 | loss: 0.0000628
	speed: 0.0209s/iter; left time: 786.0122s
Epoch: 9 cost time: 8.870975255966187
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0083833
	speed: 0.0700s/iter; left time: 2625.3461s
	iters: 200, epoch: 10 | loss: 0.0009462
	speed: 0.0220s/iter; left time: 823.5826s
	iters: 300, epoch: 10 | loss: 0.0000105
	speed: 0.0231s/iter; left time: 862.0769s
	iters: 400, epoch: 10 | loss: 0.0000005
	speed: 0.0214s/iter; left time: 796.3578s
Epoch: 10 cost time: 9.518533706665039
Epoch: 10, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.979536 --> -0.983173).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000004
	speed: 0.0756s/iter; left time: 2801.9458s
	iters: 200, epoch: 11 | loss: 0.0095565
	speed: 0.0205s/iter; left time: 757.2160s
	iters: 300, epoch: 11 | loss: 0.0000028
	speed: 0.0206s/iter; left time: 759.1953s
	iters: 400, epoch: 11 | loss: 0.0000030
	speed: 0.0205s/iter; left time: 753.9243s
Epoch: 11 cost time: 8.990000247955322
Epoch: 11, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.137 Vali Acc: 0.976 Test Loss: 0.137 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0667s/iter; left time: 2445.9515s
	iters: 200, epoch: 12 | loss: 0.0000776
	speed: 0.0203s/iter; left time: 741.6515s
	iters: 300, epoch: 12 | loss: 0.0000003
	speed: 0.0206s/iter; left time: 750.0823s
	iters: 400, epoch: 12 | loss: 0.0000512
	speed: 0.0203s/iter; left time: 737.0964s
Epoch: 12 cost time: 8.822587251663208
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.2287438
	speed: 0.0751s/iter; left time: 2721.3098s
	iters: 200, epoch: 13 | loss: 0.0000005
	speed: 0.0223s/iter; left time: 805.5233s
	iters: 300, epoch: 13 | loss: 0.0000009
	speed: 0.0219s/iter; left time: 787.9670s
	iters: 400, epoch: 13 | loss: 0.0001744
	speed: 0.0220s/iter; left time: 790.8171s
Epoch: 13 cost time: 9.407018661499023
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0006652
	speed: 0.0686s/iter; left time: 2456.8622s
	iters: 200, epoch: 14 | loss: 0.0000075
	speed: 0.0202s/iter; left time: 721.3651s
	iters: 300, epoch: 14 | loss: 0.0034512
	speed: 0.0214s/iter; left time: 762.8118s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 758.6326s
Epoch: 14 cost time: 9.084997177124023
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0009632
	speed: 0.0675s/iter; left time: 2389.1389s
	iters: 200, epoch: 15 | loss: 0.0000005
	speed: 0.0207s/iter; left time: 732.6124s
	iters: 300, epoch: 15 | loss: 0.0000235
	speed: 0.0208s/iter; left time: 733.8810s
	iters: 400, epoch: 15 | loss: 0.0000127
	speed: 0.0192s/iter; left time: 673.5050s
Epoch: 15 cost time: 8.685637474060059
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0049076
	speed: 0.0728s/iter; left time: 2547.6197s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 722.8524s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0221s/iter; left time: 767.8156s
	iters: 400, epoch: 16 | loss: 0.0318032
	speed: 0.0220s/iter; left time: 761.9112s
Epoch: 16 cost time: 9.34312105178833
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.152 Vali Acc: 0.974 Test Loss: 0.152 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000120
	speed: 0.0728s/iter; left time: 2519.6196s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 714.6626s
	iters: 300, epoch: 17 | loss: 0.0000225
	speed: 0.0218s/iter; left time: 750.6679s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0198s/iter; left time: 677.8552s
Epoch: 17 cost time: 9.055052042007446
Epoch: 17, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.986 Test Loss: 0.108 Test Acc: 0.986
Validation loss decreased (-0.983173 --> -0.986356).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.0787s/iter; left time: 2689.8524s
	iters: 200, epoch: 18 | loss: 0.0031406
	speed: 0.0206s/iter; left time: 701.3722s
	iters: 300, epoch: 18 | loss: 0.0000337
	speed: 0.0213s/iter; left time: 723.5193s
	iters: 400, epoch: 18 | loss: 0.0017117
	speed: 0.0219s/iter; left time: 742.2345s
Epoch: 18 cost time: 9.193423509597778
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.144 Vali Acc: 0.983 Test Loss: 0.144 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0007058
	speed: 0.0751s/iter; left time: 2535.9004s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0200s/iter; left time: 674.7795s
	iters: 300, epoch: 19 | loss: 0.0007869
	speed: 0.0206s/iter; left time: 691.2011s
	iters: 400, epoch: 19 | loss: 0.0000139
	speed: 0.0216s/iter; left time: 723.1643s
Epoch: 19 cost time: 8.967278718948364
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0669s/iter; left time: 2230.7565s
	iters: 200, epoch: 20 | loss: 0.0527051
	speed: 0.0217s/iter; left time: 720.3609s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0224s/iter; left time: 741.0319s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 743.0077s
Epoch: 20 cost time: 9.52337121963501
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0001382
	speed: 0.0728s/iter; left time: 2398.4751s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.0221s/iter; left time: 724.6323s
	iters: 300, epoch: 21 | loss: 0.0003189
	speed: 0.0211s/iter; left time: 691.9869s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0226s/iter; left time: 737.0671s
Epoch: 21 cost time: 9.399024486541748
Epoch: 21, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.189 Vali Acc: 0.977 Test Loss: 0.189 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000329
	speed: 0.0701s/iter; left time: 2279.6743s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 721.0118s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 707.1415s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0219s/iter; left time: 704.2359s
Epoch: 22 cost time: 9.37744665145874
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0188633
	speed: 0.0698s/iter; left time: 2242.5372s
	iters: 200, epoch: 23 | loss: 0.0004224
	speed: 0.0208s/iter; left time: 667.0909s
	iters: 300, epoch: 23 | loss: 0.0000002
	speed: 0.0201s/iter; left time: 642.8252s
	iters: 400, epoch: 23 | loss: 0.0002108
	speed: 0.0214s/iter; left time: 679.4824s
Epoch: 23 cost time: 8.969559669494629
Epoch: 23, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.205 Vali Acc: 0.976 Test Loss: 0.205 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 2324.2415s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0197s/iter; left time: 623.9861s
	iters: 300, epoch: 24 | loss: 0.0000014
	speed: 0.0212s/iter; left time: 668.7159s
	iters: 400, epoch: 24 | loss: 0.0000053
	speed: 0.0202s/iter; left time: 634.0741s
Epoch: 24 cost time: 8.940322875976562
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.978 Test Loss: 0.182 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0002401
	speed: 0.0772s/iter; left time: 2416.0763s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 648.7249s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0216s/iter; left time: 670.8664s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 635.3747s
Epoch: 25 cost time: 9.082334518432617
Epoch: 25, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.134 Vali Acc: 0.983 Test Loss: 0.134 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.0702s/iter; left time: 2168.4193s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0222s/iter; left time: 684.3966s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0226s/iter; left time: 694.3540s
	iters: 400, epoch: 26 | loss: 0.0000255
	speed: 0.0219s/iter; left time: 669.5637s
Epoch: 26 cost time: 9.44760799407959
Epoch: 26, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.984 Test Loss: 0.140 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0735s/iter; left time: 2239.6800s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 648.5420s
	iters: 300, epoch: 27 | loss: 0.0003353
	speed: 0.0221s/iter; left time: 668.9493s
	iters: 400, epoch: 27 | loss: 0.0021908
	speed: 0.0217s/iter; left time: 654.7523s
Epoch: 27 cost time: 9.35897421836853
Epoch: 27, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.274 Vali Acc: 0.968 Test Loss: 0.274 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 178126
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8737233
	speed: 0.0365s/iter; left time: 1503.1951s
	iters: 200, epoch: 1 | loss: 0.2523607
	speed: 0.0196s/iter; left time: 807.2601s
	iters: 300, epoch: 1 | loss: 0.0859160
	speed: 0.0200s/iter; left time: 819.4089s
	iters: 400, epoch: 1 | loss: 0.1339196
	speed: 0.0202s/iter; left time: 825.9961s
Epoch: 1 cost time: 9.951591491699219
Epoch: 1, Steps: 413 | Train Loss: 0.545 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (inf --> -0.977262).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0184738
	speed: 0.0686s/iter; left time: 2798.2100s
	iters: 200, epoch: 2 | loss: 0.0480964
	speed: 0.0197s/iter; left time: 801.4779s
	iters: 300, epoch: 2 | loss: 0.0534913
	speed: 0.0192s/iter; left time: 777.8664s
	iters: 400, epoch: 2 | loss: 0.0707821
	speed: 0.0199s/iter; left time: 806.5699s
Epoch: 2 cost time: 8.397547960281372
Epoch: 2, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.061 Vali Acc: 0.977 Test Loss: 0.061 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0014599
	speed: 0.0676s/iter; left time: 2729.1045s
	iters: 200, epoch: 3 | loss: 0.0046328
	speed: 0.0200s/iter; left time: 805.7112s
	iters: 300, epoch: 3 | loss: 0.0033281
	speed: 0.0205s/iter; left time: 823.6844s
	iters: 400, epoch: 3 | loss: 0.0035437
	speed: 0.0196s/iter; left time: 783.8526s
Epoch: 3 cost time: 8.664494514465332
Epoch: 3, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.072 Vali Acc: 0.974 Test Loss: 0.072 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0002035
	speed: 0.0674s/iter; left time: 2691.7263s
	iters: 200, epoch: 4 | loss: 0.0014634
	speed: 0.0229s/iter; left time: 914.3195s
	iters: 300, epoch: 4 | loss: 0.0325240
	speed: 0.0217s/iter; left time: 860.9693s
	iters: 400, epoch: 4 | loss: 0.0162303
	speed: 0.0218s/iter; left time: 865.0621s
Epoch: 4 cost time: 9.360839366912842
Epoch: 4, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
Validation loss decreased (-0.977262 --> -0.982719).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0038124
	speed: 0.0726s/iter; left time: 2871.8803s
	iters: 200, epoch: 5 | loss: 0.0001615
	speed: 0.0214s/iter; left time: 843.7819s
	iters: 300, epoch: 5 | loss: 0.0806290
	speed: 0.0212s/iter; left time: 834.7743s
	iters: 400, epoch: 5 | loss: 0.0011694
	speed: 0.0209s/iter; left time: 821.8528s
Epoch: 5 cost time: 9.2604079246521
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0009874
	speed: 0.0729s/iter; left time: 2852.1367s
	iters: 200, epoch: 6 | loss: 0.0150664
	speed: 0.0218s/iter; left time: 849.1943s
	iters: 300, epoch: 6 | loss: 0.0003272
	speed: 0.0216s/iter; left time: 842.0697s
	iters: 400, epoch: 6 | loss: 0.0002103
	speed: 0.0221s/iter; left time: 856.7224s
Epoch: 6 cost time: 9.23023533821106
Epoch: 6, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0071661
	speed: 0.0752s/iter; left time: 2910.3346s
	iters: 200, epoch: 7 | loss: 0.0006166
	speed: 0.0205s/iter; left time: 789.9556s
	iters: 300, epoch: 7 | loss: 0.0055255
	speed: 0.0216s/iter; left time: 833.4830s
	iters: 400, epoch: 7 | loss: 0.0013799
	speed: 0.0214s/iter; left time: 820.6224s
Epoch: 7 cost time: 9.125865936279297
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000472
	speed: 0.0787s/iter; left time: 3015.7221s
	iters: 200, epoch: 8 | loss: 0.0010508
	speed: 0.0214s/iter; left time: 817.4345s
	iters: 300, epoch: 8 | loss: 0.0025835
	speed: 0.0212s/iter; left time: 808.6832s
	iters: 400, epoch: 8 | loss: 0.0026076
	speed: 0.0213s/iter; left time: 808.3905s
Epoch: 8 cost time: 9.298444747924805
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0007972
	speed: 0.0754s/iter; left time: 2857.0631s
	iters: 200, epoch: 9 | loss: 0.0000600
	speed: 0.0200s/iter; left time: 754.3217s
	iters: 300, epoch: 9 | loss: 0.0007008
	speed: 0.0199s/iter; left time: 751.7341s
	iters: 400, epoch: 9 | loss: 0.0252842
	speed: 0.0203s/iter; left time: 763.3855s
Epoch: 9 cost time: 8.745970726013184
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000399
	speed: 0.0730s/iter; left time: 2735.9696s
	iters: 200, epoch: 10 | loss: 0.0000105
	speed: 0.0199s/iter; left time: 742.9346s
	iters: 300, epoch: 10 | loss: 0.0000481
	speed: 0.0195s/iter; left time: 728.8237s
	iters: 400, epoch: 10 | loss: 0.0005225
	speed: 0.0206s/iter; left time: 767.7533s
Epoch: 10 cost time: 8.764431715011597
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000173
	speed: 0.0661s/iter; left time: 2452.0108s
	iters: 200, epoch: 11 | loss: 0.0002264
	speed: 0.0201s/iter; left time: 742.5321s
	iters: 300, epoch: 11 | loss: 0.0000024
	speed: 0.0210s/iter; left time: 775.9029s
	iters: 400, epoch: 11 | loss: 0.0000175
	speed: 0.0203s/iter; left time: 745.6859s
Epoch: 11 cost time: 8.973252296447754
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.173 Vali Acc: 0.966 Test Loss: 0.173 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0669s/iter; left time: 2450.8025s
	iters: 200, epoch: 12 | loss: 0.0000008
	speed: 0.0209s/iter; left time: 762.5198s
	iters: 300, epoch: 12 | loss: 0.0083395
	speed: 0.0218s/iter; left time: 794.0608s
	iters: 400, epoch: 12 | loss: 0.0003661
	speed: 0.0216s/iter; left time: 786.6627s
Epoch: 12 cost time: 9.136438608169556
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0184841
	speed: 0.0688s/iter; left time: 2493.6253s
	iters: 200, epoch: 13 | loss: 0.0000043
	speed: 0.0223s/iter; left time: 805.3288s
	iters: 300, epoch: 13 | loss: 0.0000828
	speed: 0.0225s/iter; left time: 811.5765s
	iters: 400, epoch: 13 | loss: 0.0149399
	speed: 0.0210s/iter; left time: 754.6950s
Epoch: 13 cost time: 9.516559839248657
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000343
	speed: 0.0703s/iter; left time: 2519.3841s
	iters: 200, epoch: 14 | loss: 0.0057612
	speed: 0.0219s/iter; left time: 783.6217s
	iters: 300, epoch: 14 | loss: 0.0060595
	speed: 0.0220s/iter; left time: 782.9625s
	iters: 400, epoch: 14 | loss: 0.7128654
	speed: 0.0206s/iter; left time: 733.0185s
Epoch: 14 cost time: 9.218803882598877
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 178126
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6957871
	speed: 0.0372s/iter; left time: 1532.1693s
	iters: 200, epoch: 1 | loss: 0.2222770
	speed: 0.0196s/iter; left time: 806.3364s
	iters: 300, epoch: 1 | loss: 0.2681090
	speed: 0.0196s/iter; left time: 802.3432s
	iters: 400, epoch: 1 | loss: 0.0220833
	speed: 0.0198s/iter; left time: 810.5271s
Epoch: 1 cost time: 9.943219184875488
Epoch: 1, Steps: 413 | Train Loss: 0.574 Vali Loss: 0.129 Vali Acc: 0.961 Test Loss: 0.129 Test Acc: 0.961
Validation loss decreased (inf --> -0.961345).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0443765
	speed: 0.0728s/iter; left time: 2968.6838s
	iters: 200, epoch: 2 | loss: 0.0080791
	speed: 0.0192s/iter; left time: 780.4619s
	iters: 300, epoch: 2 | loss: 0.0140185
	speed: 0.0186s/iter; left time: 754.9082s
	iters: 400, epoch: 2 | loss: 0.0330155
	speed: 0.0201s/iter; left time: 815.1887s
Epoch: 2 cost time: 8.381555557250977
Epoch: 2, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
Validation loss decreased (-0.961345 --> -0.967712).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0077038
	speed: 0.0619s/iter; left time: 2500.2485s
	iters: 200, epoch: 3 | loss: 0.0325700
	speed: 0.0201s/iter; left time: 811.1925s
	iters: 300, epoch: 3 | loss: 0.0197165
	speed: 0.0196s/iter; left time: 788.9592s
	iters: 400, epoch: 3 | loss: 0.0119552
	speed: 0.0204s/iter; left time: 817.4118s
Epoch: 3 cost time: 8.702392339706421
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.062 Vali Acc: 0.979 Test Loss: 0.062 Test Acc: 0.979
Validation loss decreased (-0.967712 --> -0.979081).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0259459
	speed: 0.0675s/iter; left time: 2696.1390s
	iters: 200, epoch: 4 | loss: 0.0008796
	speed: 0.0212s/iter; left time: 844.8439s
	iters: 300, epoch: 4 | loss: 0.0019525
	speed: 0.0207s/iter; left time: 823.6137s
	iters: 400, epoch: 4 | loss: 0.0061045
	speed: 0.0205s/iter; left time: 812.8385s
Epoch: 4 cost time: 8.853374719619751
Epoch: 4, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.078 Vali Acc: 0.972 Test Loss: 0.078 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1471164
	speed: 0.0667s/iter; left time: 2637.9648s
	iters: 200, epoch: 5 | loss: 0.0008978
	speed: 0.0200s/iter; left time: 789.1063s
	iters: 300, epoch: 5 | loss: 0.0038285
	speed: 0.0203s/iter; left time: 799.4415s
	iters: 400, epoch: 5 | loss: 0.0368769
	speed: 0.0195s/iter; left time: 763.9527s
Epoch: 5 cost time: 8.667861700057983
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.064 Vali Acc: 0.977 Test Loss: 0.064 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0009246
	speed: 0.0613s/iter; left time: 2397.6202s
	iters: 200, epoch: 6 | loss: 0.0286753
	speed: 0.0183s/iter; left time: 715.8837s
	iters: 300, epoch: 6 | loss: 0.0008055
	speed: 0.0183s/iter; left time: 712.2850s
	iters: 400, epoch: 6 | loss: 0.0134374
	speed: 0.0187s/iter; left time: 727.8165s
Epoch: 6 cost time: 8.079133749008179
Epoch: 6, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979535).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0602111
	speed: 0.0627s/iter; left time: 2428.9584s
	iters: 200, epoch: 7 | loss: 0.0024103
	speed: 0.0194s/iter; left time: 749.6881s
	iters: 300, epoch: 7 | loss: 0.0122198
	speed: 0.0203s/iter; left time: 782.1883s
	iters: 400, epoch: 7 | loss: 0.0052267
	speed: 0.0187s/iter; left time: 720.0827s
Epoch: 7 cost time: 8.238457441329956
Epoch: 7, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0026921
	speed: 0.0772s/iter; left time: 2956.1991s
	iters: 200, epoch: 8 | loss: 0.0027767
	speed: 0.0190s/iter; left time: 727.4240s
	iters: 300, epoch: 8 | loss: 0.0001098
	speed: 0.0195s/iter; left time: 744.1937s
	iters: 400, epoch: 8 | loss: 0.3402495
	speed: 0.0196s/iter; left time: 743.5918s
Epoch: 8 cost time: 8.41720461845398
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0060723
	speed: 0.0721s/iter; left time: 2732.4811s
	iters: 200, epoch: 9 | loss: 0.0039672
	speed: 0.0183s/iter; left time: 691.3185s
	iters: 300, epoch: 9 | loss: 0.0023419
	speed: 0.0190s/iter; left time: 717.2186s
	iters: 400, epoch: 9 | loss: 0.0258360
	speed: 0.0190s/iter; left time: 714.7552s
Epoch: 9 cost time: 8.072450876235962
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000256
	speed: 0.0678s/iter; left time: 2542.4974s
	iters: 200, epoch: 10 | loss: 0.0005705
	speed: 0.0198s/iter; left time: 739.7158s
	iters: 300, epoch: 10 | loss: 0.0778313
	speed: 0.0191s/iter; left time: 711.5151s
	iters: 400, epoch: 10 | loss: 0.0401742
	speed: 0.0188s/iter; left time: 697.3608s
Epoch: 10 cost time: 8.198237657546997
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000210
	speed: 0.0668s/iter; left time: 2475.4980s
	iters: 200, epoch: 11 | loss: 0.0447413
	speed: 0.0198s/iter; left time: 732.8338s
	iters: 300, epoch: 11 | loss: 0.0011304
	speed: 0.0204s/iter; left time: 751.8509s
	iters: 400, epoch: 11 | loss: 0.0000128
	speed: 0.0198s/iter; left time: 727.0329s
Epoch: 11 cost time: 8.525677919387817
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000105
	speed: 0.0659s/iter; left time: 2414.2693s
	iters: 200, epoch: 12 | loss: 0.0014706
	speed: 0.0196s/iter; left time: 717.8841s
	iters: 300, epoch: 12 | loss: 0.0000017
	speed: 0.0205s/iter; left time: 746.7050s
	iters: 400, epoch: 12 | loss: 0.0002128
	speed: 0.0184s/iter; left time: 669.6223s
Epoch: 12 cost time: 8.423159122467041
Epoch: 12, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0001351
	speed: 0.0639s/iter; left time: 2315.9407s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 754.1708s
	iters: 300, epoch: 13 | loss: 0.0000030
	speed: 0.0195s/iter; left time: 702.2659s
	iters: 400, epoch: 13 | loss: 0.0646057
	speed: 0.0198s/iter; left time: 713.1439s
Epoch: 13 cost time: 8.69935941696167
Epoch: 13, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1840750
	speed: 0.0636s/iter; left time: 2277.1716s
	iters: 200, epoch: 14 | loss: 0.0002842
	speed: 0.0190s/iter; left time: 677.7082s
	iters: 300, epoch: 14 | loss: 0.0004813
	speed: 0.0189s/iter; left time: 674.4142s
	iters: 400, epoch: 14 | loss: 0.0029984
	speed: 0.0195s/iter; left time: 694.3414s
Epoch: 14 cost time: 8.211282968521118
Epoch: 14, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0072702
	speed: 0.0643s/iter; left time: 2276.0608s
	iters: 200, epoch: 15 | loss: 0.0005342
	speed: 0.0196s/iter; left time: 694.0137s
	iters: 300, epoch: 15 | loss: 0.4684058
	speed: 0.0189s/iter; left time: 667.0689s
	iters: 400, epoch: 15 | loss: 0.0000029
	speed: 0.0187s/iter; left time: 657.3238s
Epoch: 15 cost time: 8.212684392929077
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000020
	speed: 0.0642s/iter; left time: 2246.4506s
	iters: 200, epoch: 16 | loss: 0.0000012
	speed: 0.0209s/iter; left time: 728.6837s
	iters: 300, epoch: 16 | loss: 0.0000241
	speed: 0.0201s/iter; left time: 699.6894s
	iters: 400, epoch: 16 | loss: 0.0000016
	speed: 0.0209s/iter; left time: 726.9769s
Epoch: 16 cost time: 8.770817518234253
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 334862
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7377787
	speed: 0.0386s/iter; left time: 1589.4085s
	iters: 200, epoch: 1 | loss: 0.2474592
	speed: 0.0207s/iter; left time: 849.0680s
	iters: 300, epoch: 1 | loss: 0.2981840
	speed: 0.0206s/iter; left time: 845.4933s
	iters: 400, epoch: 1 | loss: 0.0259969
	speed: 0.0209s/iter; left time: 854.1238s
Epoch: 1 cost time: 10.436254024505615
Epoch: 1, Steps: 413 | Train Loss: 0.598 Vali Loss: 0.134 Vali Acc: 0.958 Test Loss: 0.134 Test Acc: 0.958
Validation loss decreased (inf --> -0.958161).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0453983
	speed: 0.0689s/iter; left time: 2811.1825s
	iters: 200, epoch: 2 | loss: 0.0094843
	speed: 0.0212s/iter; left time: 860.9985s
	iters: 300, epoch: 2 | loss: 0.0210521
	speed: 0.0213s/iter; left time: 866.5241s
	iters: 400, epoch: 2 | loss: 0.0279316
	speed: 0.0206s/iter; left time: 833.0719s
Epoch: 2 cost time: 8.919083595275879
Epoch: 2, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.087 Vali Acc: 0.969 Test Loss: 0.087 Test Acc: 0.969
Validation loss decreased (-0.958161 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0137639
	speed: 0.0763s/iter; left time: 3081.0964s
	iters: 200, epoch: 3 | loss: 0.0447996
	speed: 0.0201s/iter; left time: 808.2687s
	iters: 300, epoch: 3 | loss: 0.0476666
	speed: 0.0210s/iter; left time: 843.1319s
	iters: 400, epoch: 3 | loss: 0.0044742
	speed: 0.0202s/iter; left time: 809.7094s
Epoch: 3 cost time: 8.75880217552185
Epoch: 3, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
Validation loss decreased (-0.968621 --> -0.972714).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0145111
	speed: 0.0697s/iter; left time: 2787.2687s
	iters: 200, epoch: 4 | loss: 0.0005488
	speed: 0.0203s/iter; left time: 809.6268s
	iters: 300, epoch: 4 | loss: 0.0149439
	speed: 0.0203s/iter; left time: 807.3517s
	iters: 400, epoch: 4 | loss: 0.0053383
	speed: 0.0192s/iter; left time: 762.5721s
Epoch: 4 cost time: 8.62571406364441
Epoch: 4, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.081 Vali Acc: 0.969 Test Loss: 0.081 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1726268
	speed: 0.0647s/iter; left time: 2557.3035s
	iters: 200, epoch: 5 | loss: 0.0003426
	speed: 0.0209s/iter; left time: 825.9775s
	iters: 300, epoch: 5 | loss: 0.0063113
	speed: 0.0196s/iter; left time: 771.0257s
	iters: 400, epoch: 5 | loss: 0.0228510
	speed: 0.0210s/iter; left time: 822.7469s
Epoch: 5 cost time: 8.781525135040283
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.057 Vali Acc: 0.978 Test Loss: 0.057 Test Acc: 0.978
Validation loss decreased (-0.972714 --> -0.977717).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0023593
	speed: 0.0665s/iter; left time: 2604.2260s
	iters: 200, epoch: 6 | loss: 0.0441094
	speed: 0.0211s/iter; left time: 825.3650s
	iters: 300, epoch: 6 | loss: 0.0047274
	speed: 0.0208s/iter; left time: 810.1914s
	iters: 400, epoch: 6 | loss: 0.0118385
	speed: 0.0214s/iter; left time: 830.2004s
Epoch: 6 cost time: 8.999903440475464
Epoch: 6, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0848463
	speed: 0.0680s/iter; left time: 2632.1529s
	iters: 200, epoch: 7 | loss: 0.0001881
	speed: 0.0215s/iter; left time: 831.5777s
	iters: 300, epoch: 7 | loss: 0.0122841
	speed: 0.0203s/iter; left time: 781.7787s
	iters: 400, epoch: 7 | loss: 0.0318222
	speed: 0.0219s/iter; left time: 840.7379s
Epoch: 7 cost time: 8.921565532684326
Epoch: 7, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0013197
	speed: 0.0680s/iter; left time: 2604.6956s
	iters: 200, epoch: 8 | loss: 0.0121770
	speed: 0.0209s/iter; left time: 799.7924s
	iters: 300, epoch: 8 | loss: 0.0055788
	speed: 0.0211s/iter; left time: 805.8625s
	iters: 400, epoch: 8 | loss: 0.0434342
	speed: 0.0211s/iter; left time: 802.8389s
Epoch: 8 cost time: 9.065626859664917
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000354
	speed: 0.0699s/iter; left time: 2647.9848s
	iters: 200, epoch: 9 | loss: 0.0005929
	speed: 0.0219s/iter; left time: 825.8924s
	iters: 300, epoch: 9 | loss: 0.0010936
	speed: 0.0207s/iter; left time: 778.4932s
	iters: 400, epoch: 9 | loss: 0.0003492
	speed: 0.0205s/iter; left time: 769.1254s
Epoch: 9 cost time: 9.021175384521484
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0003768
	speed: 0.0752s/iter; left time: 2817.1373s
	iters: 200, epoch: 10 | loss: 0.0000255
	speed: 0.0198s/iter; left time: 741.9919s
	iters: 300, epoch: 10 | loss: 0.0067075
	speed: 0.0206s/iter; left time: 768.0395s
	iters: 400, epoch: 10 | loss: 0.0042940
	speed: 0.0196s/iter; left time: 729.0437s
Epoch: 10 cost time: 8.726532220840454
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.977717 --> -0.979535).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0004125
	speed: 0.0711s/iter; left time: 2635.2129s
	iters: 200, epoch: 11 | loss: 0.0167003
	speed: 0.0197s/iter; left time: 727.3872s
	iters: 300, epoch: 11 | loss: 0.0004430
	speed: 0.0204s/iter; left time: 751.6605s
	iters: 400, epoch: 11 | loss: 0.0000342
	speed: 0.0193s/iter; left time: 709.9991s
Epoch: 11 cost time: 8.580408811569214
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000120
	speed: 0.0702s/iter; left time: 2573.6530s
	iters: 200, epoch: 12 | loss: 0.0220126
	speed: 0.0205s/iter; left time: 747.9786s
	iters: 300, epoch: 12 | loss: 0.0000132
	speed: 0.0213s/iter; left time: 776.7413s
	iters: 400, epoch: 12 | loss: 0.0004608
	speed: 0.0220s/iter; left time: 800.6320s
Epoch: 12 cost time: 9.170246839523315
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0078592
	speed: 0.0715s/iter; left time: 2593.1240s
	iters: 200, epoch: 13 | loss: 0.0000002
	speed: 0.0210s/iter; left time: 759.0429s
	iters: 300, epoch: 13 | loss: 0.0000098
	speed: 0.0209s/iter; left time: 752.9586s
	iters: 400, epoch: 13 | loss: 0.0002031
	speed: 0.0202s/iter; left time: 726.0044s
Epoch: 13 cost time: 8.930564165115356
Epoch: 13, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000635
	speed: 0.0672s/iter; left time: 2408.1353s
	iters: 200, epoch: 14 | loss: 0.0000364
	speed: 0.0213s/iter; left time: 759.5720s
	iters: 300, epoch: 14 | loss: 0.0009971
	speed: 0.0207s/iter; left time: 738.7197s
	iters: 400, epoch: 14 | loss: 0.0780461
	speed: 0.0211s/iter; left time: 750.9318s
Epoch: 14 cost time: 8.98322606086731
Epoch: 14, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0555106
	speed: 0.0669s/iter; left time: 2370.8757s
	iters: 200, epoch: 15 | loss: 0.0013420
	speed: 0.0207s/iter; left time: 729.4596s
	iters: 300, epoch: 15 | loss: 0.1373667
	speed: 0.0196s/iter; left time: 690.9594s
	iters: 400, epoch: 15 | loss: 0.0000048
	speed: 0.0212s/iter; left time: 745.4431s
Epoch: 15 cost time: 8.82526707649231
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000422
	speed: 0.0731s/iter; left time: 2559.3208s
	iters: 200, epoch: 16 | loss: 0.0000312
	speed: 0.0198s/iter; left time: 691.1184s
	iters: 300, epoch: 16 | loss: 0.0251394
	speed: 0.0201s/iter; left time: 699.5060s
	iters: 400, epoch: 16 | loss: 0.0000219
	speed: 0.0205s/iter; left time: 712.7588s
Epoch: 16 cost time: 8.694133043289185
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0142332
	speed: 0.0686s/iter; left time: 2372.8623s
	iters: 200, epoch: 17 | loss: 0.0002080
	speed: 0.0208s/iter; left time: 717.4657s
	iters: 300, epoch: 17 | loss: 0.0000250
	speed: 0.0209s/iter; left time: 719.5530s
	iters: 400, epoch: 17 | loss: 0.0000040
	speed: 0.0198s/iter; left time: 679.5129s
Epoch: 17 cost time: 8.626015901565552
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000408
	speed: 0.0669s/iter; left time: 2287.7838s
	iters: 200, epoch: 18 | loss: 0.0000020
	speed: 0.0204s/iter; left time: 694.5570s
	iters: 300, epoch: 18 | loss: 0.0023165
	speed: 0.0198s/iter; left time: 672.8433s
	iters: 400, epoch: 18 | loss: 0.0120429
	speed: 0.0212s/iter; left time: 716.7978s
Epoch: 18 cost time: 8.799917936325073
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0283572
	speed: 0.0693s/iter; left time: 2339.9597s
	iters: 200, epoch: 19 | loss: 0.0000013
	speed: 0.0213s/iter; left time: 716.0329s
	iters: 300, epoch: 19 | loss: 0.0029036
	speed: 0.0210s/iter; left time: 705.3257s
	iters: 400, epoch: 19 | loss: 0.0000003
	speed: 0.0212s/iter; left time: 711.1193s
Epoch: 19 cost time: 8.979526281356812
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1521267
	speed: 0.0700s/iter; left time: 2334.1977s
	iters: 200, epoch: 20 | loss: 0.0001102
	speed: 0.0217s/iter; left time: 720.7842s
	iters: 300, epoch: 20 | loss: 0.0018921
	speed: 0.0209s/iter; left time: 694.0517s
	iters: 400, epoch: 20 | loss: 0.0002164
	speed: 0.0216s/iter; left time: 712.8002s
Epoch: 20 cost time: 9.12580943107605
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.979535 --> -0.983173).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.0686s/iter; left time: 2260.5782s
	iters: 200, epoch: 21 | loss: 0.0000040
	speed: 0.0214s/iter; left time: 703.7110s
	iters: 300, epoch: 21 | loss: 0.0000143
	speed: 0.0213s/iter; left time: 698.5479s
	iters: 400, epoch: 21 | loss: 0.0000027
	speed: 0.0209s/iter; left time: 682.4398s
Epoch: 21 cost time: 9.101819038391113
Epoch: 21, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0001802
	speed: 0.0748s/iter; left time: 2434.5802s
	iters: 200, epoch: 22 | loss: 0.0004506
	speed: 0.0203s/iter; left time: 658.5180s
	iters: 300, epoch: 22 | loss: 0.0000005
	speed: 0.0203s/iter; left time: 654.8990s
	iters: 400, epoch: 22 | loss: 0.0035512
	speed: 0.0205s/iter; left time: 660.4455s
Epoch: 22 cost time: 8.865588188171387
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0011321
	speed: 0.0725s/iter; left time: 2329.5882s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0193s/iter; left time: 617.9997s
	iters: 300, epoch: 23 | loss: 0.0000017
	speed: 0.0197s/iter; left time: 629.6681s
	iters: 400, epoch: 23 | loss: 0.0002868
	speed: 0.0189s/iter; left time: 601.1517s
Epoch: 23 cost time: 8.418636560440063
Epoch: 23, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000025
	speed: 0.0716s/iter; left time: 2271.1738s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0206s/iter; left time: 649.8247s
	iters: 300, epoch: 24 | loss: 0.0512371
	speed: 0.0205s/iter; left time: 644.9347s
	iters: 400, epoch: 24 | loss: 0.0000001
	speed: 0.0197s/iter; left time: 618.1337s
Epoch: 24 cost time: 8.820737600326538
Epoch: 24, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.0695s/iter; left time: 2175.6786s
	iters: 200, epoch: 25 | loss: 0.0180656
	speed: 0.0215s/iter; left time: 669.3255s
	iters: 300, epoch: 25 | loss: 0.0000395
	speed: 0.0227s/iter; left time: 704.7579s
	iters: 400, epoch: 25 | loss: 0.0000062
	speed: 0.0218s/iter; left time: 674.6160s
Epoch: 25 cost time: 9.210807085037231
Epoch: 25, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.982 Test Loss: 0.137 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000558
	speed: 0.0674s/iter; left time: 2081.7100s
	iters: 200, epoch: 26 | loss: 0.3537020
	speed: 0.0221s/iter; left time: 680.3834s
	iters: 300, epoch: 26 | loss: 0.0000052
	speed: 0.0207s/iter; left time: 634.0882s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 641.2364s
Epoch: 26 cost time: 9.157138347625732
Epoch: 26, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.985 Test Loss: 0.094 Test Acc: 0.985
Validation loss decreased (-0.983173 --> -0.984992).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0001882
	speed: 0.0696s/iter; left time: 2119.4419s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0202s/iter; left time: 612.1134s
	iters: 300, epoch: 27 | loss: 0.0662030
	speed: 0.0206s/iter; left time: 622.6822s
	iters: 400, epoch: 27 | loss: 0.0000039
	speed: 0.0206s/iter; left time: 620.4643s
Epoch: 27 cost time: 8.780029058456421
Epoch: 27, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000033
	speed: 0.0732s/iter; left time: 2199.0225s
	iters: 200, epoch: 28 | loss: 0.0000022
	speed: 0.0212s/iter; left time: 635.4971s
	iters: 300, epoch: 28 | loss: 0.0001478
	speed: 0.0215s/iter; left time: 640.4297s
	iters: 400, epoch: 28 | loss: 0.0000008
	speed: 0.0208s/iter; left time: 618.6963s
Epoch: 28 cost time: 9.018697738647461
Epoch: 28, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.0754s/iter; left time: 2235.4087s
	iters: 200, epoch: 29 | loss: 0.5921255
	speed: 0.0207s/iter; left time: 612.4776s
	iters: 300, epoch: 29 | loss: 0.0000001
	speed: 0.0214s/iter; left time: 628.6188s
	iters: 400, epoch: 29 | loss: 0.0000008
	speed: 0.0207s/iter; left time: 606.5245s
Epoch: 29 cost time: 9.014313220977783
Epoch: 29, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0298463
	speed: 0.0791s/iter; left time: 2312.8584s
	iters: 200, epoch: 30 | loss: 0.0895925
	speed: 0.0208s/iter; left time: 605.9991s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 619.5303s
	iters: 400, epoch: 30 | loss: 0.0000001
	speed: 0.0214s/iter; left time: 618.6858s
Epoch: 30 cost time: 9.234220027923584
Epoch: 30, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.982 Test Loss: 0.110 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 2366.7306s
	iters: 200, epoch: 31 | loss: 0.0000689
	speed: 0.0195s/iter; left time: 561.2314s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0190s/iter; left time: 544.7021s
	iters: 400, epoch: 31 | loss: 0.1303147
	speed: 0.0207s/iter; left time: 590.2361s
Epoch: 31 cost time: 8.851746559143066
Epoch: 31, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.982 Test Loss: 0.107 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000006
	speed: 0.0685s/iter; left time: 1945.4916s
	iters: 200, epoch: 32 | loss: 0.0039527
	speed: 0.0207s/iter; left time: 584.6233s
	iters: 300, epoch: 32 | loss: 0.0000018
	speed: 0.0207s/iter; left time: 584.8593s
	iters: 400, epoch: 32 | loss: 0.0000002
	speed: 0.0211s/iter; left time: 593.0635s
Epoch: 32 cost time: 9.101359367370605
Epoch: 32, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.0653s/iter; left time: 1826.7274s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 578.2353s
	iters: 300, epoch: 33 | loss: 0.0000024
	speed: 0.0212s/iter; left time: 589.0985s
	iters: 400, epoch: 33 | loss: 0.0000016
	speed: 0.0210s/iter; left time: 580.2967s
Epoch: 33 cost time: 9.081436157226562
Epoch: 33, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.982 Test Loss: 0.133 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000002
	speed: 0.0660s/iter; left time: 1819.6511s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 589.4470s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0226s/iter; left time: 618.3480s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 574.0486s
Epoch: 34 cost time: 9.211565732955933
Epoch: 34, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0000002
	speed: 0.0657s/iter; left time: 1785.2921s
	iters: 200, epoch: 35 | loss: 0.0000873
	speed: 0.0197s/iter; left time: 532.0942s
	iters: 300, epoch: 35 | loss: 0.0000670
	speed: 0.0206s/iter; left time: 554.2473s
	iters: 400, epoch: 35 | loss: 0.0000012
	speed: 0.0197s/iter; left time: 527.9933s
Epoch: 35 cost time: 8.602874755859375
Epoch: 35, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0002377
	speed: 0.0719s/iter; left time: 1923.0783s
	iters: 200, epoch: 36 | loss: 0.0000004
	speed: 0.0209s/iter; left time: 557.3846s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 563.0138s
	iters: 400, epoch: 36 | loss: 0.0000816
	speed: 0.0208s/iter; left time: 550.3048s
Epoch: 36 cost time: 8.960022211074829
Epoch: 36, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 334862
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8757493
	speed: 0.0379s/iter; left time: 1560.3130s
	iters: 200, epoch: 1 | loss: 0.2922394
	speed: 0.0215s/iter; left time: 884.9764s
	iters: 300, epoch: 1 | loss: 0.4214244
	speed: 0.0214s/iter; left time: 876.5255s
	iters: 400, epoch: 1 | loss: 0.0472293
	speed: 0.0201s/iter; left time: 821.2845s
Epoch: 1 cost time: 10.409799337387085
Epoch: 1, Steps: 413 | Train Loss: 0.648 Vali Loss: 0.148 Vali Acc: 0.953 Test Loss: 0.148 Test Acc: 0.953
Validation loss decreased (inf --> -0.953159).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0512150
	speed: 0.0707s/iter; left time: 2883.0145s
	iters: 200, epoch: 2 | loss: 0.0154796
	speed: 0.0215s/iter; left time: 873.1967s
	iters: 300, epoch: 2 | loss: 0.0390420
	speed: 0.0194s/iter; left time: 788.9850s
	iters: 400, epoch: 2 | loss: 0.0254131
	speed: 0.0215s/iter; left time: 870.8377s
Epoch: 2 cost time: 8.894675731658936
Epoch: 2, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
Validation loss decreased (-0.953159 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0352263
	speed: 0.0694s/iter; left time: 2800.0988s
	iters: 200, epoch: 3 | loss: 0.0395763
	speed: 0.0192s/iter; left time: 772.5974s
	iters: 300, epoch: 3 | loss: 0.0957150
	speed: 0.0221s/iter; left time: 886.9126s
	iters: 400, epoch: 3 | loss: 0.0017990
	speed: 0.0216s/iter; left time: 865.6991s
Epoch: 3 cost time: 8.92658019065857
Epoch: 3, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.970895 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0207311
	speed: 0.0675s/iter; left time: 2698.6685s
	iters: 200, epoch: 4 | loss: 0.0015158
	speed: 0.0215s/iter; left time: 857.1593s
	iters: 300, epoch: 4 | loss: 0.0315814
	speed: 0.0224s/iter; left time: 891.8401s
	iters: 400, epoch: 4 | loss: 0.0043649
	speed: 0.0216s/iter; left time: 857.7780s
Epoch: 4 cost time: 9.426419973373413
Epoch: 4, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.083 Vali Acc: 0.971 Test Loss: 0.083 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1464291
	speed: 0.0632s/iter; left time: 2500.7681s
	iters: 200, epoch: 5 | loss: 0.0006949
	speed: 0.0204s/iter; left time: 805.5815s
	iters: 300, epoch: 5 | loss: 0.0017678
	speed: 0.0209s/iter; left time: 821.1114s
	iters: 400, epoch: 5 | loss: 0.0678976
	speed: 0.0202s/iter; left time: 791.8791s
Epoch: 5 cost time: 8.692337036132812
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0003546
	speed: 0.0660s/iter; left time: 2582.1564s
	iters: 200, epoch: 6 | loss: 0.0058912
	speed: 0.0197s/iter; left time: 770.5397s
	iters: 300, epoch: 6 | loss: 0.0009240
	speed: 0.0195s/iter; left time: 760.5471s
	iters: 400, epoch: 6 | loss: 0.0451739
	speed: 0.0198s/iter; left time: 769.7366s
Epoch: 6 cost time: 8.439428567886353
Epoch: 6, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976807 --> -0.977262).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0022159
	speed: 0.0707s/iter; left time: 2738.1980s
	iters: 200, epoch: 7 | loss: 0.0003888
	speed: 0.0199s/iter; left time: 768.7000s
	iters: 300, epoch: 7 | loss: 0.0486541
	speed: 0.0188s/iter; left time: 723.2468s
	iters: 400, epoch: 7 | loss: 0.1788784
	speed: 0.0213s/iter; left time: 816.7769s
Epoch: 7 cost time: 8.630313158035278
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0022481
	speed: 0.0707s/iter; left time: 2709.5340s
	iters: 200, epoch: 8 | loss: 0.0049540
	speed: 0.0214s/iter; left time: 819.5295s
	iters: 300, epoch: 8 | loss: 0.0001509
	speed: 0.0206s/iter; left time: 783.6863s
	iters: 400, epoch: 8 | loss: 0.1076929
	speed: 0.0208s/iter; left time: 791.9635s
Epoch: 8 cost time: 8.931938409805298
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001898
	speed: 0.0732s/iter; left time: 2772.6260s
	iters: 200, epoch: 9 | loss: 0.0028465
	speed: 0.0208s/iter; left time: 787.9082s
	iters: 300, epoch: 9 | loss: 0.0005856
	speed: 0.0207s/iter; left time: 778.7337s
	iters: 400, epoch: 9 | loss: 0.0011396
	speed: 0.0209s/iter; left time: 785.1668s
Epoch: 9 cost time: 8.996479988098145
Epoch: 9, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0002658
	speed: 0.0737s/iter; left time: 2763.8179s
	iters: 200, epoch: 10 | loss: 0.0001288
	speed: 0.0213s/iter; left time: 794.4671s
	iters: 300, epoch: 10 | loss: 0.0271055
	speed: 0.0203s/iter; left time: 758.3244s
	iters: 400, epoch: 10 | loss: 0.0017739
	speed: 0.0218s/iter; left time: 810.0489s
Epoch: 10 cost time: 9.030683517456055
Epoch: 10, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0351077
	speed: 0.0696s/iter; left time: 2580.7142s
	iters: 200, epoch: 11 | loss: 0.0029326
	speed: 0.0220s/iter; left time: 812.2324s
	iters: 300, epoch: 11 | loss: 0.0396607
	speed: 0.0211s/iter; left time: 778.0938s
	iters: 400, epoch: 11 | loss: 0.0119435
	speed: 0.0207s/iter; left time: 760.7017s
Epoch: 11 cost time: 8.981896162033081
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0001376
	speed: 0.0704s/iter; left time: 2580.8796s
	iters: 200, epoch: 12 | loss: 0.0000186
	speed: 0.0205s/iter; left time: 751.1061s
	iters: 300, epoch: 12 | loss: 0.0000016
	speed: 0.0203s/iter; left time: 739.6307s
	iters: 400, epoch: 12 | loss: 0.0006702
	speed: 0.0200s/iter; left time: 728.7455s
Epoch: 12 cost time: 8.647206783294678
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
Validation loss decreased (-0.977262 --> -0.978626).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0004672
	speed: 0.0676s/iter; left time: 2449.0846s
	iters: 200, epoch: 13 | loss: 0.0000026
	speed: 0.0195s/iter; left time: 705.6125s
	iters: 300, epoch: 13 | loss: 0.0000976
	speed: 0.0206s/iter; left time: 741.0816s
	iters: 400, epoch: 13 | loss: 0.0015299
	speed: 0.0199s/iter; left time: 716.8013s
Epoch: 13 cost time: 8.505553960800171
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000395
	speed: 0.0637s/iter; left time: 2281.3201s
	iters: 200, epoch: 14 | loss: 0.0000043
	speed: 0.0194s/iter; left time: 693.5615s
	iters: 300, epoch: 14 | loss: 0.0000167
	speed: 0.0196s/iter; left time: 698.3819s
	iters: 400, epoch: 14 | loss: 0.0000894
	speed: 0.0202s/iter; left time: 716.2805s
Epoch: 14 cost time: 8.495003700256348
Epoch: 14, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0048109
	speed: 0.0638s/iter; left time: 2260.0536s
	iters: 200, epoch: 15 | loss: 0.0002265
	speed: 0.0206s/iter; left time: 727.6785s
	iters: 300, epoch: 15 | loss: 0.0391071
	speed: 0.0191s/iter; left time: 671.4006s
	iters: 400, epoch: 15 | loss: 0.0000181
	speed: 0.0192s/iter; left time: 674.3296s
Epoch: 15 cost time: 8.400188446044922
Epoch: 15, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000005
	speed: 0.0590s/iter; left time: 2066.4391s
	iters: 200, epoch: 16 | loss: 0.0004112
	speed: 0.0188s/iter; left time: 655.7857s
	iters: 300, epoch: 16 | loss: 0.0001051
	speed: 0.0194s/iter; left time: 676.4902s
	iters: 400, epoch: 16 | loss: 0.0029750
	speed: 0.0216s/iter; left time: 749.2115s
Epoch: 16 cost time: 8.446710348129272
Epoch: 16, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.978626 --> -0.982264).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0096682
	speed: 0.0737s/iter; left time: 2548.8726s
	iters: 200, epoch: 17 | loss: 0.0000540
	speed: 0.0212s/iter; left time: 730.3533s
	iters: 300, epoch: 17 | loss: 0.0000011
	speed: 0.0208s/iter; left time: 713.6929s
	iters: 400, epoch: 17 | loss: 0.0075643
	speed: 0.0214s/iter; left time: 734.5211s
Epoch: 17 cost time: 8.990288972854614
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0001220
	speed: 0.0742s/iter; left time: 2537.5591s
	iters: 200, epoch: 18 | loss: 0.0591396
	speed: 0.0212s/iter; left time: 722.2260s
	iters: 300, epoch: 18 | loss: 0.0720106
	speed: 0.0209s/iter; left time: 711.2379s
	iters: 400, epoch: 18 | loss: 0.0007886
	speed: 0.0214s/iter; left time: 723.6861s
Epoch: 18 cost time: 9.351341247558594
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0002510
	speed: 0.0695s/iter; left time: 2347.3416s
	iters: 200, epoch: 19 | loss: 0.0007336
	speed: 0.0209s/iter; left time: 703.9284s
	iters: 300, epoch: 19 | loss: 0.0000041
	speed: 0.0217s/iter; left time: 728.5486s
	iters: 400, epoch: 19 | loss: 0.0002075
	speed: 0.0217s/iter; left time: 727.4346s
Epoch: 19 cost time: 9.065667390823364
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0016676
	speed: 0.0751s/iter; left time: 2505.9289s
	iters: 200, epoch: 20 | loss: 0.0000058
	speed: 0.0202s/iter; left time: 672.4975s
	iters: 300, epoch: 20 | loss: 0.0000263
	speed: 0.0216s/iter; left time: 715.1339s
	iters: 400, epoch: 20 | loss: 0.0000195
	speed: 0.0211s/iter; left time: 696.0847s
Epoch: 20 cost time: 8.952107191085815
Epoch: 20, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000004
	speed: 0.0707s/iter; left time: 2327.6468s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0198s/iter; left time: 651.3504s
	iters: 300, epoch: 21 | loss: 0.0000009
	speed: 0.0198s/iter; left time: 648.9929s
	iters: 400, epoch: 21 | loss: 0.0030016
	speed: 0.0211s/iter; left time: 688.9712s
Epoch: 21 cost time: 8.886882305145264
Epoch: 21, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.983173).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000809
	speed: 0.0684s/iter; left time: 2223.8932s
	iters: 200, epoch: 22 | loss: 0.0000217
	speed: 0.0193s/iter; left time: 625.4654s
	iters: 300, epoch: 22 | loss: 0.0000237
	speed: 0.0193s/iter; left time: 625.3717s
	iters: 400, epoch: 22 | loss: 0.2375164
	speed: 0.0204s/iter; left time: 657.3446s
Epoch: 22 cost time: 8.657946586608887
Epoch: 22, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000002
	speed: 0.0712s/iter; left time: 2287.3234s
	iters: 200, epoch: 23 | loss: 0.0000044
	speed: 0.0212s/iter; left time: 679.6349s
	iters: 300, epoch: 23 | loss: 0.0000032
	speed: 0.0215s/iter; left time: 687.0871s
	iters: 400, epoch: 23 | loss: 0.0000449
	speed: 0.0212s/iter; left time: 674.0989s
Epoch: 23 cost time: 9.225393056869507
Epoch: 23, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000180
	speed: 0.0652s/iter; left time: 2067.9897s
	iters: 200, epoch: 24 | loss: 0.0000001
	speed: 0.0219s/iter; left time: 691.2896s
	iters: 300, epoch: 24 | loss: 0.1040678
	speed: 0.0208s/iter; left time: 654.7725s
	iters: 400, epoch: 24 | loss: 0.0004854
	speed: 0.0217s/iter; left time: 680.1593s
Epoch: 24 cost time: 9.122553586959839
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000006
	speed: 0.0673s/iter; left time: 2105.1438s
	iters: 200, epoch: 25 | loss: 0.0000023
	speed: 0.0203s/iter; left time: 632.9199s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.0234s/iter; left time: 727.4719s
	iters: 400, epoch: 25 | loss: 0.0000002
	speed: 0.0239s/iter; left time: 739.9200s
Epoch: 25 cost time: 9.537357091903687
Epoch: 25, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0004773
	speed: 0.0743s/iter; left time: 2294.8766s
	iters: 200, epoch: 26 | loss: 0.0000850
	speed: 0.0211s/iter; left time: 649.2152s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.0206s/iter; left time: 631.2332s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0199s/iter; left time: 607.1300s
Epoch: 26 cost time: 8.858723640441895
Epoch: 26, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.981 Test Loss: 0.154 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000052
	speed: 0.0713s/iter; left time: 2171.0005s
	iters: 200, epoch: 27 | loss: 0.0000067
	speed: 0.0190s/iter; left time: 576.5965s
	iters: 300, epoch: 27 | loss: 0.0000220
	speed: 0.0195s/iter; left time: 591.0148s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0188s/iter; left time: 568.4855s
Epoch: 27 cost time: 8.39018988609314
Epoch: 27, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0007579
	speed: 0.0699s/iter; left time: 2101.0641s
	iters: 200, epoch: 28 | loss: 0.0000002
	speed: 0.0208s/iter; left time: 623.0814s
	iters: 300, epoch: 28 | loss: 0.0021338
	speed: 0.0191s/iter; left time: 570.2978s
	iters: 400, epoch: 28 | loss: 0.0920128
	speed: 0.0188s/iter; left time: 560.2949s
Epoch: 28 cost time: 8.473666667938232
Epoch: 28, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.068 Vali Acc: 0.986 Test Loss: 0.068 Test Acc: 0.986
Validation loss decreased (-0.983173 --> -0.985902).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.0665s/iter; left time: 1970.9603s
	iters: 200, epoch: 29 | loss: 0.0000009
	speed: 0.0214s/iter; left time: 631.1078s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 614.1124s
	iters: 400, epoch: 29 | loss: 0.0012647
	speed: 0.0216s/iter; left time: 634.5577s
Epoch: 29 cost time: 8.953697204589844
Epoch: 29, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.150 Vali Acc: 0.976 Test Loss: 0.150 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 2024.3606s
	iters: 200, epoch: 30 | loss: 0.0000274
	speed: 0.0206s/iter; left time: 599.3524s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 625.0761s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0218s/iter; left time: 630.9388s
Epoch: 30 cost time: 9.151007413864136
Epoch: 30, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.984 Test Loss: 0.111 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.0677s/iter; left time: 1950.6145s
	iters: 200, epoch: 31 | loss: 0.0000619
	speed: 0.0205s/iter; left time: 588.3446s
	iters: 300, epoch: 31 | loss: 0.0000002
	speed: 0.0231s/iter; left time: 661.4598s
	iters: 400, epoch: 31 | loss: 0.0000054
	speed: 0.0221s/iter; left time: 628.9865s
Epoch: 31 cost time: 9.402512073516846
Epoch: 31, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.982 Test Loss: 0.111 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0215318
	speed: 0.0676s/iter; left time: 1920.8737s
	iters: 200, epoch: 32 | loss: 0.0000479
	speed: 0.0220s/iter; left time: 621.3961s
	iters: 300, epoch: 32 | loss: 0.0000410
	speed: 0.0199s/iter; left time: 561.8653s
	iters: 400, epoch: 32 | loss: 0.0042575
	speed: 0.0210s/iter; left time: 589.4271s
Epoch: 32 cost time: 8.996969223022461
Epoch: 32, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0000009
	speed: 0.0696s/iter; left time: 1946.7102s
	iters: 200, epoch: 33 | loss: 0.0000001
	speed: 0.0201s/iter; left time: 559.6672s
	iters: 300, epoch: 33 | loss: 0.0000005
	speed: 0.0206s/iter; left time: 571.9079s
	iters: 400, epoch: 33 | loss: 0.0004538
	speed: 0.0192s/iter; left time: 531.3413s
Epoch: 33 cost time: 8.536955833435059
Epoch: 33, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.983 Test Loss: 0.134 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0012922
	speed: 0.0683s/iter; left time: 1882.0527s
	iters: 200, epoch: 34 | loss: 0.0000002
	speed: 0.0202s/iter; left time: 554.7453s
	iters: 300, epoch: 34 | loss: 0.0000001
	speed: 0.0210s/iter; left time: 575.4587s
	iters: 400, epoch: 34 | loss: 0.0000068
	speed: 0.0199s/iter; left time: 543.2630s
Epoch: 34 cost time: 8.775136470794678
Epoch: 34, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 1944.0477s
	iters: 200, epoch: 35 | loss: 0.0000094
	speed: 0.0207s/iter; left time: 558.8756s
	iters: 300, epoch: 35 | loss: 0.1557453
	speed: 0.0217s/iter; left time: 583.7516s
	iters: 400, epoch: 35 | loss: 0.0000002
	speed: 0.0205s/iter; left time: 550.5558s
Epoch: 35 cost time: 9.057530403137207
Epoch: 35, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.986 Test Loss: 0.103 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0000001
	speed: 0.0724s/iter; left time: 1935.1706s
	iters: 200, epoch: 36 | loss: 0.0000038
	speed: 0.0217s/iter; left time: 578.2746s
	iters: 300, epoch: 36 | loss: 0.0231830
	speed: 0.0221s/iter; left time: 586.4124s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 553.2057s
Epoch: 36 cost time: 9.230248928070068
Epoch: 36, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.135 Vali Acc: 0.982 Test Loss: 0.135 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.0721s/iter; left time: 1897.7796s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0223s/iter; left time: 583.8630s
	iters: 300, epoch: 37 | loss: 0.0001327
	speed: 0.0223s/iter; left time: 582.4790s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 545.8220s
Epoch: 37 cost time: 9.241049528121948
Epoch: 37, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.133 Vali Acc: 0.982 Test Loss: 0.133 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.0708s/iter; left time: 1833.8524s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 530.0398s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 544.2366s
	iters: 400, epoch: 38 | loss: 0.0000026
	speed: 0.0210s/iter; left time: 537.1555s
Epoch: 38 cost time: 8.977676630020142
Epoch: 38, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.973 Test Loss: 0.206 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 334862
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2448826
	speed: 0.0379s/iter; left time: 1560.3088s
	iters: 200, epoch: 1 | loss: 0.4171665
	speed: 0.0204s/iter; left time: 838.1613s
	iters: 300, epoch: 1 | loss: 0.5534385
	speed: 0.0206s/iter; left time: 842.7569s
	iters: 400, epoch: 1 | loss: 0.0552640
	speed: 0.0201s/iter; left time: 822.3487s
Epoch: 1 cost time: 10.25335168838501
Epoch: 1, Steps: 413 | Train Loss: 0.780 Vali Loss: 0.169 Vali Acc: 0.953 Test Loss: 0.169 Test Acc: 0.953
Validation loss decreased (inf --> -0.952704).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0590373
	speed: 0.0691s/iter; left time: 2817.1703s
	iters: 200, epoch: 2 | loss: 0.0140443
	speed: 0.0218s/iter; left time: 887.9591s
	iters: 300, epoch: 2 | loss: 0.1354163
	speed: 0.0201s/iter; left time: 816.4997s
	iters: 400, epoch: 2 | loss: 0.0379092
	speed: 0.0202s/iter; left time: 819.4576s
Epoch: 2 cost time: 9.06842303276062
Epoch: 2, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
Validation loss decreased (-0.952704 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0262247
	speed: 0.0637s/iter; left time: 2571.2858s
	iters: 200, epoch: 3 | loss: 0.0341020
	speed: 0.0214s/iter; left time: 861.4524s
	iters: 300, epoch: 3 | loss: 0.0928988
	speed: 0.0212s/iter; left time: 852.6122s
	iters: 400, epoch: 3 | loss: 0.0289224
	speed: 0.0219s/iter; left time: 877.6896s
Epoch: 3 cost time: 9.212049007415771
Epoch: 3, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.080 Vali Acc: 0.972 Test Loss: 0.080 Test Acc: 0.972
Validation loss decreased (-0.972259 --> -0.972259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0234575
	speed: 0.0664s/iter; left time: 2651.6800s
	iters: 200, epoch: 4 | loss: 0.0127023
	speed: 0.0211s/iter; left time: 840.7890s
	iters: 300, epoch: 4 | loss: 0.0452744
	speed: 0.0216s/iter; left time: 860.3198s
	iters: 400, epoch: 4 | loss: 0.0469209
	speed: 0.0227s/iter; left time: 898.8431s
Epoch: 4 cost time: 9.266496419906616
Epoch: 4, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.971 Test Loss: 0.090 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1257166
	speed: 0.0707s/iter; left time: 2796.2204s
	iters: 200, epoch: 5 | loss: 0.0004765
	speed: 0.0212s/iter; left time: 838.0524s
	iters: 300, epoch: 5 | loss: 0.0006129
	speed: 0.0219s/iter; left time: 860.0591s
	iters: 400, epoch: 5 | loss: 0.0048495
	speed: 0.0211s/iter; left time: 828.7505s
Epoch: 5 cost time: 9.064188003540039
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.974533).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0002452
	speed: 0.0706s/iter; left time: 2761.2706s
	iters: 200, epoch: 6 | loss: 0.0177645
	speed: 0.0192s/iter; left time: 750.1764s
	iters: 300, epoch: 6 | loss: 0.0035496
	speed: 0.0194s/iter; left time: 753.5478s
	iters: 400, epoch: 6 | loss: 0.0039032
	speed: 0.0209s/iter; left time: 812.4563s
Epoch: 6 cost time: 8.579777956008911
Epoch: 6, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0013705
	speed: 0.0714s/iter; left time: 2763.8889s
	iters: 200, epoch: 7 | loss: 0.0007262
	speed: 0.0203s/iter; left time: 784.1873s
	iters: 300, epoch: 7 | loss: 0.0019352
	speed: 0.0208s/iter; left time: 800.4199s
	iters: 400, epoch: 7 | loss: 0.0269894
	speed: 0.0200s/iter; left time: 768.1047s
Epoch: 7 cost time: 8.694637060165405
Epoch: 7, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.974533 --> -0.976807).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0032537
	speed: 0.0722s/iter; left time: 2765.6548s
	iters: 200, epoch: 8 | loss: 0.0004659
	speed: 0.0203s/iter; left time: 777.0452s
	iters: 300, epoch: 8 | loss: 0.0023671
	speed: 0.0197s/iter; left time: 749.7982s
	iters: 400, epoch: 8 | loss: 0.0108853
	speed: 0.0198s/iter; left time: 752.4349s
Epoch: 8 cost time: 8.756956100463867
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0019842
	speed: 0.0628s/iter; left time: 2381.2737s
	iters: 200, epoch: 9 | loss: 0.0000696
	speed: 0.0219s/iter; left time: 829.3995s
	iters: 300, epoch: 9 | loss: 0.0000532
	speed: 0.0215s/iter; left time: 811.2278s
	iters: 400, epoch: 9 | loss: 0.0322048
	speed: 0.0225s/iter; left time: 845.7118s
Epoch: 9 cost time: 9.2326078414917
Epoch: 9, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0002849
	speed: 0.0652s/iter; left time: 2442.2910s
	iters: 200, epoch: 10 | loss: 0.0001354
	speed: 0.0213s/iter; left time: 795.2409s
	iters: 300, epoch: 10 | loss: 0.0240543
	speed: 0.0213s/iter; left time: 794.4480s
	iters: 400, epoch: 10 | loss: 0.0277569
	speed: 0.0206s/iter; left time: 764.2978s
Epoch: 10 cost time: 9.00477123260498
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0001128
	speed: 0.0661s/iter; left time: 2448.8497s
	iters: 200, epoch: 11 | loss: 0.0006737
	speed: 0.0210s/iter; left time: 775.8990s
	iters: 300, epoch: 11 | loss: 0.0411413
	speed: 0.0204s/iter; left time: 753.5266s
	iters: 400, epoch: 11 | loss: 0.0000572
	speed: 0.0208s/iter; left time: 763.4342s
Epoch: 11 cost time: 8.901414632797241
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.962 Test Loss: 0.199 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0165206
	speed: 0.0663s/iter; left time: 2431.5073s
	iters: 200, epoch: 12 | loss: 0.0005258
	speed: 0.0200s/iter; left time: 731.0476s
	iters: 300, epoch: 12 | loss: 0.0000177
	speed: 0.0205s/iter; left time: 748.0311s
	iters: 400, epoch: 12 | loss: 0.0023263
	speed: 0.0201s/iter; left time: 729.2779s
Epoch: 12 cost time: 8.77897024154663
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0001960
	speed: 0.0675s/iter; left time: 2447.3989s
	iters: 200, epoch: 13 | loss: 0.0001050
	speed: 0.0198s/iter; left time: 714.8391s
	iters: 300, epoch: 13 | loss: 0.0004816
	speed: 0.0202s/iter; left time: 727.1628s
	iters: 400, epoch: 13 | loss: 0.0194883
	speed: 0.0202s/iter; left time: 726.9498s
Epoch: 13 cost time: 8.572052717208862
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0391214
	speed: 0.0749s/iter; left time: 2683.5194s
	iters: 200, epoch: 14 | loss: 0.0000298
	speed: 0.0212s/iter; left time: 758.5855s
	iters: 300, epoch: 14 | loss: 0.0000781
	speed: 0.0211s/iter; left time: 752.2717s
	iters: 400, epoch: 14 | loss: 0.0078270
	speed: 0.0201s/iter; left time: 713.2506s
Epoch: 14 cost time: 8.959521532058716
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
Validation loss decreased (-0.976807 --> -0.981809).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0002128
	speed: 0.0717s/iter; left time: 2540.6409s
	iters: 200, epoch: 15 | loss: 0.0234499
	speed: 0.0216s/iter; left time: 763.0219s
	iters: 300, epoch: 15 | loss: 0.1563322
	speed: 0.0190s/iter; left time: 668.7576s
	iters: 400, epoch: 15 | loss: 0.0000181
	speed: 0.0196s/iter; left time: 687.3212s
Epoch: 15 cost time: 8.625923871994019
Epoch: 15, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.981809 --> -0.981809).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0002309
	speed: 0.0731s/iter; left time: 2560.2038s
	iters: 200, epoch: 16 | loss: 0.0026725
	speed: 0.0214s/iter; left time: 748.3331s
	iters: 300, epoch: 16 | loss: 0.0000616
	speed: 0.0219s/iter; left time: 761.7963s
	iters: 400, epoch: 16 | loss: 0.0003131
	speed: 0.0207s/iter; left time: 719.9346s
Epoch: 16 cost time: 9.149178981781006
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000083
	speed: 0.0715s/iter; left time: 2474.2057s
	iters: 200, epoch: 17 | loss: 0.0000333
	speed: 0.0214s/iter; left time: 739.5292s
	iters: 300, epoch: 17 | loss: 0.0006262
	speed: 0.0208s/iter; left time: 715.9529s
	iters: 400, epoch: 17 | loss: 0.0021485
	speed: 0.0212s/iter; left time: 727.0814s
Epoch: 17 cost time: 9.088263750076294
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.1042282
	speed: 0.0689s/iter; left time: 2355.2780s
	iters: 200, epoch: 18 | loss: 0.0000514
	speed: 0.0214s/iter; left time: 729.9415s
	iters: 300, epoch: 18 | loss: 0.0062016
	speed: 0.0221s/iter; left time: 752.2896s
	iters: 400, epoch: 18 | loss: 0.0442622
	speed: 0.0202s/iter; left time: 683.1119s
Epoch: 18 cost time: 9.15885591506958
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.981809 --> -0.983173).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000293
	speed: 0.0681s/iter; left time: 2298.8476s
	iters: 200, epoch: 19 | loss: 0.0003766
	speed: 0.0197s/iter; left time: 663.8395s
	iters: 300, epoch: 19 | loss: 0.0000010
	speed: 0.0199s/iter; left time: 667.1785s
	iters: 400, epoch: 19 | loss: 0.0000920
	speed: 0.0201s/iter; left time: 673.8584s
Epoch: 19 cost time: 8.720550537109375
Epoch: 19, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0001927
	speed: 0.0660s/iter; left time: 2202.2985s
	iters: 200, epoch: 20 | loss: 0.0000391
	speed: 0.0208s/iter; left time: 692.3813s
	iters: 300, epoch: 20 | loss: 0.0001635
	speed: 0.0205s/iter; left time: 678.9905s
	iters: 400, epoch: 20 | loss: 0.0000471
	speed: 0.0201s/iter; left time: 664.2492s
Epoch: 20 cost time: 8.844096899032593
Epoch: 20, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000035
	speed: 0.0660s/iter; left time: 2175.2434s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.0225s/iter; left time: 738.5330s
	iters: 300, epoch: 21 | loss: 0.0000063
	speed: 0.0206s/iter; left time: 674.3317s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.0199s/iter; left time: 649.0542s
Epoch: 21 cost time: 8.86011290550232
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0018592
	speed: 0.0667s/iter; left time: 2168.4755s
	iters: 200, epoch: 22 | loss: 0.0000050
	speed: 0.0215s/iter; left time: 697.9057s
	iters: 300, epoch: 22 | loss: 0.0020279
	speed: 0.0231s/iter; left time: 747.0899s
	iters: 400, epoch: 22 | loss: 0.1771408
	speed: 0.0208s/iter; left time: 670.2251s
Epoch: 22 cost time: 9.296766996383667
Epoch: 22, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0002257
	speed: 0.0706s/iter; left time: 2266.2834s
	iters: 200, epoch: 23 | loss: 0.0000020
	speed: 0.0207s/iter; left time: 662.4256s
	iters: 300, epoch: 23 | loss: 0.2266493
	speed: 0.0213s/iter; left time: 679.8855s
	iters: 400, epoch: 23 | loss: 0.0001513
	speed: 0.0205s/iter; left time: 652.1662s
Epoch: 23 cost time: 9.116913080215454
Epoch: 23, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000095
	speed: 0.0685s/iter; left time: 2170.8832s
	iters: 200, epoch: 24 | loss: 0.0000135
	speed: 0.0211s/iter; left time: 666.8640s
	iters: 300, epoch: 24 | loss: 0.0110993
	speed: 0.0200s/iter; left time: 631.2398s
	iters: 400, epoch: 24 | loss: 0.2409984
	speed: 0.0213s/iter; left time: 667.6417s
Epoch: 24 cost time: 8.83302354812622
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.179 Vali Acc: 0.977 Test Loss: 0.179 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0011616
	speed: 0.0686s/iter; left time: 2147.7208s
	iters: 200, epoch: 25 | loss: 0.0000055
	speed: 0.0188s/iter; left time: 587.4895s
	iters: 300, epoch: 25 | loss: 0.0000003
	speed: 0.0189s/iter; left time: 589.1275s
	iters: 400, epoch: 25 | loss: 0.0000049
	speed: 0.0197s/iter; left time: 608.9487s
Epoch: 25 cost time: 8.320589065551758
Epoch: 25, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000334
	speed: 0.0673s/iter; left time: 2079.3647s
	iters: 200, epoch: 26 | loss: 0.0002139
	speed: 0.0188s/iter; left time: 577.7081s
	iters: 300, epoch: 26 | loss: 0.0000005
	speed: 0.0201s/iter; left time: 616.2026s
	iters: 400, epoch: 26 | loss: 0.0000024
	speed: 0.0195s/iter; left time: 597.7122s
Epoch: 26 cost time: 8.443169355392456
Epoch: 26, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0374684
	speed: 0.0669s/iter; left time: 2037.2972s
	iters: 200, epoch: 27 | loss: 0.0000489
	speed: 0.0202s/iter; left time: 612.8576s
	iters: 300, epoch: 27 | loss: 0.0000052
	speed: 0.0211s/iter; left time: 637.7419s
	iters: 400, epoch: 27 | loss: 0.0000302
	speed: 0.0203s/iter; left time: 612.4675s
Epoch: 27 cost time: 8.752840757369995
Epoch: 27, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0410968
	speed: 0.0631s/iter; left time: 1894.9319s
	iters: 200, epoch: 28 | loss: 0.0018236
	speed: 0.0205s/iter; left time: 614.3728s
	iters: 300, epoch: 28 | loss: 0.0000003
	speed: 0.0209s/iter; left time: 625.0770s
	iters: 400, epoch: 28 | loss: 0.0008087
	speed: 0.0213s/iter; left time: 632.8735s
Epoch: 28 cost time: 8.981074810028076
Epoch: 28, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 334862
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6475742
	speed: 0.0376s/iter; left time: 1547.9522s
	iters: 200, epoch: 1 | loss: 0.1343238
	speed: 0.0210s/iter; left time: 864.5956s
	iters: 300, epoch: 1 | loss: 0.2537983
	speed: 0.0218s/iter; left time: 895.0646s
	iters: 400, epoch: 1 | loss: 0.2669588
	speed: 0.0210s/iter; left time: 858.4231s
Epoch: 1 cost time: 10.465025186538696
Epoch: 1, Steps: 413 | Train Loss: 0.573 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
Validation loss decreased (inf --> -0.963619).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0343060
	speed: 0.0652s/iter; left time: 2659.0603s
	iters: 200, epoch: 2 | loss: 0.0383748
	speed: 0.0205s/iter; left time: 834.4196s
	iters: 300, epoch: 2 | loss: 0.0029453
	speed: 0.0194s/iter; left time: 787.9870s
	iters: 400, epoch: 2 | loss: 0.0822896
	speed: 0.0198s/iter; left time: 802.7691s
Epoch: 2 cost time: 8.640270233154297
Epoch: 2, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.102 Vali Acc: 0.964 Test Loss: 0.102 Test Acc: 0.964
Validation loss decreased (-0.963619 --> -0.964074).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0112243
	speed: 0.0739s/iter; left time: 2982.3456s
	iters: 200, epoch: 3 | loss: 0.0055042
	speed: 0.0192s/iter; left time: 773.7404s
	iters: 300, epoch: 3 | loss: 0.1531874
	speed: 0.0194s/iter; left time: 781.0922s
	iters: 400, epoch: 3 | loss: 0.0364221
	speed: 0.0192s/iter; left time: 770.0226s
Epoch: 3 cost time: 8.50449514389038
Epoch: 3, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
Validation loss decreased (-0.964074 --> -0.970440).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0044043
	speed: 0.0723s/iter; left time: 2888.7369s
	iters: 200, epoch: 4 | loss: 0.0077033
	speed: 0.0198s/iter; left time: 790.8596s
	iters: 300, epoch: 4 | loss: 0.1364800
	speed: 0.0213s/iter; left time: 844.9970s
	iters: 400, epoch: 4 | loss: 0.0011485
	speed: 0.0197s/iter; left time: 779.9680s
Epoch: 4 cost time: 8.6990807056427
Epoch: 4, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.970440 --> -0.976807).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0634742
	speed: 0.0726s/iter; left time: 2873.0333s
	iters: 200, epoch: 5 | loss: 0.0126552
	speed: 0.0208s/iter; left time: 820.4565s
	iters: 300, epoch: 5 | loss: 0.1914696
	speed: 0.0205s/iter; left time: 807.9388s
	iters: 400, epoch: 5 | loss: 0.0015392
	speed: 0.0217s/iter; left time: 851.3974s
Epoch: 5 cost time: 8.80196738243103
Epoch: 5, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.079 Vali Acc: 0.972 Test Loss: 0.079 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0006942
	speed: 0.0711s/iter; left time: 2780.7508s
	iters: 200, epoch: 6 | loss: 0.0268075
	speed: 0.0204s/iter; left time: 797.4466s
	iters: 300, epoch: 6 | loss: 0.0001881
	speed: 0.0203s/iter; left time: 790.6654s
	iters: 400, epoch: 6 | loss: 0.0020747
	speed: 0.0212s/iter; left time: 822.6579s
Epoch: 6 cost time: 8.815065383911133
Epoch: 6, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0016103
	speed: 0.0697s/iter; left time: 2698.9344s
	iters: 200, epoch: 7 | loss: 0.0004109
	speed: 0.0220s/iter; left time: 848.9855s
	iters: 300, epoch: 7 | loss: 0.0028545
	speed: 0.0187s/iter; left time: 721.4090s
	iters: 400, epoch: 7 | loss: 0.0024868
	speed: 0.0212s/iter; left time: 816.4422s
Epoch: 7 cost time: 8.875657796859741
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.058 Vali Acc: 0.981 Test Loss: 0.058 Test Acc: 0.981
Validation loss decreased (-0.976807 --> -0.980900).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0095361
	speed: 0.0642s/iter; left time: 2460.1313s
	iters: 200, epoch: 8 | loss: 0.0002902
	speed: 0.0204s/iter; left time: 779.2226s
	iters: 300, epoch: 8 | loss: 0.0009446
	speed: 0.0204s/iter; left time: 777.2007s
	iters: 400, epoch: 8 | loss: 0.0001887
	speed: 0.0209s/iter; left time: 794.1217s
Epoch: 8 cost time: 8.871525287628174
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0002799
	speed: 0.0658s/iter; left time: 2494.1374s
	iters: 200, epoch: 9 | loss: 0.0005669
	speed: 0.0194s/iter; left time: 735.0743s
	iters: 300, epoch: 9 | loss: 0.0001229
	speed: 0.0204s/iter; left time: 770.1019s
	iters: 400, epoch: 9 | loss: 0.0000840
	speed: 0.0200s/iter; left time: 750.6807s
Epoch: 9 cost time: 8.494938611984253
Epoch: 9, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0001652
	speed: 0.0626s/iter; left time: 2345.5733s
	iters: 200, epoch: 10 | loss: 0.0000039
	speed: 0.0198s/iter; left time: 740.7734s
	iters: 300, epoch: 10 | loss: 0.0000482
	speed: 0.0202s/iter; left time: 751.5798s
	iters: 400, epoch: 10 | loss: 0.0002817
	speed: 0.0203s/iter; left time: 754.5728s
Epoch: 10 cost time: 8.637590408325195
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0073889
	speed: 0.0655s/iter; left time: 2428.4513s
	iters: 200, epoch: 11 | loss: 0.0037820
	speed: 0.0195s/iter; left time: 720.5666s
	iters: 300, epoch: 11 | loss: 0.0001182
	speed: 0.0207s/iter; left time: 763.6204s
	iters: 400, epoch: 11 | loss: 0.0011414
	speed: 0.0209s/iter; left time: 768.1632s
Epoch: 11 cost time: 8.662893533706665
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0001391
	speed: 0.0661s/iter; left time: 2422.5752s
	iters: 200, epoch: 12 | loss: 0.0000883
	speed: 0.0218s/iter; left time: 796.7313s
	iters: 300, epoch: 12 | loss: 0.0001659
	speed: 0.0218s/iter; left time: 795.3740s
	iters: 400, epoch: 12 | loss: 0.0022843
	speed: 0.0220s/iter; left time: 798.6633s
Epoch: 12 cost time: 9.252725601196289
Epoch: 12, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0003039
	speed: 0.0677s/iter; left time: 2452.6316s
	iters: 200, epoch: 13 | loss: 0.0015863
	speed: 0.0218s/iter; left time: 788.1529s
	iters: 300, epoch: 13 | loss: 0.0045737
	speed: 0.0212s/iter; left time: 763.5876s
	iters: 400, epoch: 13 | loss: 0.0016989
	speed: 0.0209s/iter; left time: 751.3745s
Epoch: 13 cost time: 9.12612247467041
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0001024
	speed: 0.0670s/iter; left time: 2399.0709s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.0207s/iter; left time: 740.9624s
	iters: 300, epoch: 14 | loss: 0.0000055
	speed: 0.0214s/iter; left time: 762.7389s
	iters: 400, epoch: 14 | loss: 0.0082746
	speed: 0.0218s/iter; left time: 773.5661s
Epoch: 14 cost time: 8.999099016189575
Epoch: 14, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0021907
	speed: 0.0717s/iter; left time: 2537.8491s
	iters: 200, epoch: 15 | loss: 0.0001320
	speed: 0.0190s/iter; left time: 669.7350s
	iters: 300, epoch: 15 | loss: 0.0000011
	speed: 0.0189s/iter; left time: 664.5463s
	iters: 400, epoch: 15 | loss: 0.0423430
	speed: 0.0201s/iter; left time: 704.5959s
Epoch: 15 cost time: 8.43415093421936
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0005577
	speed: 0.0691s/iter; left time: 2417.9906s
	iters: 200, epoch: 16 | loss: 0.0000415
	speed: 0.0195s/iter; left time: 681.1274s
	iters: 300, epoch: 16 | loss: 0.0000792
	speed: 0.0194s/iter; left time: 675.7059s
	iters: 400, epoch: 16 | loss: 0.0002768
	speed: 0.0189s/iter; left time: 656.7829s
Epoch: 16 cost time: 8.246598243713379
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.276 Vali Acc: 0.960 Test Loss: 0.276 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000601
	speed: 0.0646s/iter; left time: 2233.1380s
	iters: 200, epoch: 17 | loss: 0.0001625
	speed: 0.0206s/iter; left time: 710.6088s
	iters: 300, epoch: 17 | loss: 0.0000414
	speed: 0.0197s/iter; left time: 677.7032s
	iters: 400, epoch: 17 | loss: 0.0004009
	speed: 0.0205s/iter; left time: 703.6743s
Epoch: 17 cost time: 8.572632551193237
Epoch: 17, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 203790
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7043054
	speed: 0.0376s/iter; left time: 1550.8476s
	iters: 200, epoch: 1 | loss: 0.1634836
	speed: 0.0199s/iter; left time: 819.5351s
	iters: 300, epoch: 1 | loss: 0.2891662
	speed: 0.0208s/iter; left time: 853.1436s
	iters: 400, epoch: 1 | loss: 0.2917261
	speed: 0.0213s/iter; left time: 871.1465s
Epoch: 1 cost time: 10.301915407180786
Epoch: 1, Steps: 413 | Train Loss: 0.598 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0333988
	speed: 0.0676s/iter; left time: 2759.2161s
	iters: 200, epoch: 2 | loss: 0.0481513
	speed: 0.0207s/iter; left time: 840.6473s
	iters: 300, epoch: 2 | loss: 0.0066254
	speed: 0.0205s/iter; left time: 832.5874s
	iters: 400, epoch: 2 | loss: 0.1044584
	speed: 0.0215s/iter; left time: 872.3658s
Epoch: 2 cost time: 8.977438688278198
Epoch: 2, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.104 Vali Acc: 0.964 Test Loss: 0.104 Test Acc: 0.964
Validation loss decreased (-0.962709 --> -0.964074).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0107817
	speed: 0.0675s/iter; left time: 2724.2088s
	iters: 200, epoch: 3 | loss: 0.0073071
	speed: 0.0192s/iter; left time: 773.0617s
	iters: 300, epoch: 3 | loss: 0.1235981
	speed: 0.0203s/iter; left time: 816.8216s
	iters: 400, epoch: 3 | loss: 0.0223449
	speed: 0.0201s/iter; left time: 803.9725s
Epoch: 3 cost time: 8.726118803024292
Epoch: 3, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
Validation loss decreased (-0.964074 --> -0.975897).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0055479
	speed: 0.0758s/iter; left time: 3030.1790s
	iters: 200, epoch: 4 | loss: 0.0180723
	speed: 0.0204s/iter; left time: 814.1156s
	iters: 300, epoch: 4 | loss: 0.0167346
	speed: 0.0201s/iter; left time: 798.6766s
	iters: 400, epoch: 4 | loss: 0.0013260
	speed: 0.0197s/iter; left time: 782.6913s
Epoch: 4 cost time: 8.70288896560669
Epoch: 4, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0323797
	speed: 0.0730s/iter; left time: 2888.9712s
	iters: 200, epoch: 5 | loss: 0.0063924
	speed: 0.0205s/iter; left time: 808.7972s
	iters: 300, epoch: 5 | loss: 0.2111373
	speed: 0.0197s/iter; left time: 775.7954s
	iters: 400, epoch: 5 | loss: 0.0009163
	speed: 0.0204s/iter; left time: 799.5174s
Epoch: 5 cost time: 8.733293533325195
Epoch: 5, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.074 Vali Acc: 0.974 Test Loss: 0.074 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0077785
	speed: 0.0714s/iter; left time: 2793.4934s
	iters: 200, epoch: 6 | loss: 0.0022172
	speed: 0.0205s/iter; left time: 801.9435s
	iters: 300, epoch: 6 | loss: 0.0002930
	speed: 0.0215s/iter; left time: 836.6002s
	iters: 400, epoch: 6 | loss: 0.0062199
	speed: 0.0208s/iter; left time: 808.9007s
Epoch: 6 cost time: 9.004566431045532
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0020963
	speed: 0.0707s/iter; left time: 2735.9445s
	iters: 200, epoch: 7 | loss: 0.0008210
	speed: 0.0207s/iter; left time: 797.9009s
	iters: 300, epoch: 7 | loss: 0.0018655
	speed: 0.0211s/iter; left time: 812.6333s
	iters: 400, epoch: 7 | loss: 0.0006848
	speed: 0.0221s/iter; left time: 847.3523s
Epoch: 7 cost time: 8.969766855239868
Epoch: 7, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.078 Vali Acc: 0.974 Test Loss: 0.078 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0004554
	speed: 0.0670s/iter; left time: 2566.2394s
	iters: 200, epoch: 8 | loss: 0.0046605
	speed: 0.0194s/iter; left time: 741.1521s
	iters: 300, epoch: 8 | loss: 0.0005477
	speed: 0.0200s/iter; left time: 760.9906s
	iters: 400, epoch: 8 | loss: 0.0000270
	speed: 0.0210s/iter; left time: 797.6782s
Epoch: 8 cost time: 8.758203506469727
Epoch: 8, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.975897 --> -0.979535).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000384
	speed: 0.0659s/iter; left time: 2498.4982s
	iters: 200, epoch: 9 | loss: 0.0124914
	speed: 0.0203s/iter; left time: 765.5275s
	iters: 300, epoch: 9 | loss: 0.0014958
	speed: 0.0196s/iter; left time: 739.1742s
	iters: 400, epoch: 9 | loss: 0.0018652
	speed: 0.0199s/iter; left time: 748.6046s
Epoch: 9 cost time: 8.650099039077759
Epoch: 9, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0002185
	speed: 0.0669s/iter; left time: 2507.8459s
	iters: 200, epoch: 10 | loss: 0.0000391
	speed: 0.0196s/iter; left time: 734.0515s
	iters: 300, epoch: 10 | loss: 0.0247889
	speed: 0.0203s/iter; left time: 755.5407s
	iters: 400, epoch: 10 | loss: 0.0015269
	speed: 0.0204s/iter; left time: 757.0287s
Epoch: 10 cost time: 8.5198073387146
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0031787
	speed: 0.0648s/iter; left time: 2401.9506s
	iters: 200, epoch: 11 | loss: 0.0000830
	speed: 0.0203s/iter; left time: 750.3776s
	iters: 300, epoch: 11 | loss: 0.0002035
	speed: 0.0198s/iter; left time: 731.5106s
	iters: 400, epoch: 11 | loss: 0.0049932
	speed: 0.0201s/iter; left time: 737.7060s
Epoch: 11 cost time: 8.553807497024536
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
Validation loss decreased (-0.979535 --> -0.982264).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0011473
	speed: 0.0645s/iter; left time: 2366.1463s
	iters: 200, epoch: 12 | loss: 0.0000034
	speed: 0.0201s/iter; left time: 733.4040s
	iters: 300, epoch: 12 | loss: 0.0000051
	speed: 0.0217s/iter; left time: 790.7470s
	iters: 400, epoch: 12 | loss: 0.0003079
	speed: 0.0204s/iter; left time: 741.3568s
Epoch: 12 cost time: 8.688656568527222
Epoch: 12, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.0704s/iter; left time: 2550.1154s
	iters: 200, epoch: 13 | loss: 0.0050398
	speed: 0.0219s/iter; left time: 790.8809s
	iters: 300, epoch: 13 | loss: 0.0032477
	speed: 0.0207s/iter; left time: 746.3542s
	iters: 400, epoch: 13 | loss: 0.0121922
	speed: 0.0207s/iter; left time: 743.9129s
Epoch: 13 cost time: 9.077601909637451
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0001167
	speed: 0.0699s/iter; left time: 2503.9963s
	iters: 200, epoch: 14 | loss: 0.0000046
	speed: 0.0207s/iter; left time: 741.3629s
	iters: 300, epoch: 14 | loss: 0.0002853
	speed: 0.0199s/iter; left time: 707.8145s
	iters: 400, epoch: 14 | loss: 0.0000912
	speed: 0.0208s/iter; left time: 737.5736s
Epoch: 14 cost time: 8.778648376464844
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000036
	speed: 0.0668s/iter; left time: 2365.0237s
	iters: 200, epoch: 15 | loss: 0.0000016
	speed: 0.0211s/iter; left time: 746.9395s
	iters: 300, epoch: 15 | loss: 0.0000023
	speed: 0.0218s/iter; left time: 768.6816s
	iters: 400, epoch: 15 | loss: 0.0000380
	speed: 0.0214s/iter; left time: 752.2289s
Epoch: 15 cost time: 9.0621337890625
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0795452
	speed: 0.0687s/iter; left time: 2406.4988s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0195s/iter; left time: 682.1829s
	iters: 300, epoch: 16 | loss: 0.0000012
	speed: 0.0219s/iter; left time: 763.4506s
	iters: 400, epoch: 16 | loss: 0.0021006
	speed: 0.0209s/iter; left time: 724.4547s
Epoch: 16 cost time: 8.858360528945923
Epoch: 16, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1386350
	speed: 0.0708s/iter; left time: 2450.3196s
	iters: 200, epoch: 17 | loss: 0.0000032
	speed: 0.0185s/iter; left time: 637.1068s
	iters: 300, epoch: 17 | loss: 0.0097882
	speed: 0.0213s/iter; left time: 731.9218s
	iters: 400, epoch: 17 | loss: 0.0000023
	speed: 0.0200s/iter; left time: 685.8435s
Epoch: 17 cost time: 8.792725324630737
Epoch: 17, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000639
	speed: 0.0667s/iter; left time: 2278.4308s
	iters: 200, epoch: 18 | loss: 0.0009444
	speed: 0.0200s/iter; left time: 682.6688s
	iters: 300, epoch: 18 | loss: 0.0000707
	speed: 0.0202s/iter; left time: 687.9861s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 694.9228s
Epoch: 18 cost time: 8.555039405822754
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.163 Vali Acc: 0.976 Test Loss: 0.163 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000021
	speed: 0.0653s/iter; left time: 2204.0160s
	iters: 200, epoch: 19 | loss: 0.0001776
	speed: 0.0209s/iter; left time: 702.2540s
	iters: 300, epoch: 19 | loss: 0.0034824
	speed: 0.0218s/iter; left time: 730.7150s
	iters: 400, epoch: 19 | loss: 0.0000005
	speed: 0.0213s/iter; left time: 711.2192s
Epoch: 19 cost time: 8.997738122940063
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.0679s/iter; left time: 2263.9740s
	iters: 200, epoch: 20 | loss: 0.0001058
	speed: 0.0218s/iter; left time: 724.9719s
	iters: 300, epoch: 20 | loss: 0.0000153
	speed: 0.0225s/iter; left time: 747.3975s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0214s/iter; left time: 708.6630s
Epoch: 20 cost time: 9.311838865280151
Epoch: 20, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.974 Test Loss: 0.176 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000004
	speed: 0.0682s/iter; left time: 2247.8250s
	iters: 200, epoch: 21 | loss: 0.0030921
	speed: 0.0221s/iter; left time: 727.2231s
	iters: 300, epoch: 21 | loss: 0.0000005
	speed: 0.0221s/iter; left time: 722.1904s
	iters: 400, epoch: 21 | loss: 0.0000097
	speed: 0.0218s/iter; left time: 713.1998s
Epoch: 21 cost time: 9.354594230651855
Epoch: 21, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.138 Vali Acc: 0.976 Test Loss: 0.138 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 203790
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8126779
	speed: 0.0394s/iter; left time: 1624.3493s
	iters: 200, epoch: 1 | loss: 0.1969440
	speed: 0.0214s/iter; left time: 878.0171s
	iters: 300, epoch: 1 | loss: 0.2960134
	speed: 0.0198s/iter; left time: 809.9797s
	iters: 400, epoch: 1 | loss: 0.2624808
	speed: 0.0194s/iter; left time: 791.9041s
Epoch: 1 cost time: 10.305521011352539
Epoch: 1, Steps: 413 | Train Loss: 0.653 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0382612
	speed: 0.0773s/iter; left time: 3152.6673s
	iters: 200, epoch: 2 | loss: 0.0269202
	speed: 0.0210s/iter; left time: 854.1156s
	iters: 300, epoch: 2 | loss: 0.0133384
	speed: 0.0205s/iter; left time: 833.0145s
	iters: 400, epoch: 2 | loss: 0.0794911
	speed: 0.0210s/iter; left time: 849.3033s
Epoch: 2 cost time: 8.979102373123169
Epoch: 2, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
Validation loss decreased (-0.960890 --> -0.962254).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0257467
	speed: 0.0715s/iter; left time: 2888.3826s
	iters: 200, epoch: 3 | loss: 0.0096715
	speed: 0.0208s/iter; left time: 836.5356s
	iters: 300, epoch: 3 | loss: 0.1347049
	speed: 0.0209s/iter; left time: 841.2720s
	iters: 400, epoch: 3 | loss: 0.0772393
	speed: 0.0200s/iter; left time: 801.3028s
Epoch: 3 cost time: 8.757391214370728
Epoch: 3, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
Validation loss decreased (-0.962254 --> -0.974988).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0030898
	speed: 0.0660s/iter; left time: 2637.4258s
	iters: 200, epoch: 4 | loss: 0.0645370
	speed: 0.0213s/iter; left time: 847.5934s
	iters: 300, epoch: 4 | loss: 0.0031615
	speed: 0.0204s/iter; left time: 811.1273s
	iters: 400, epoch: 4 | loss: 0.0003069
	speed: 0.0206s/iter; left time: 818.9912s
Epoch: 4 cost time: 9.064795732498169
Epoch: 4, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.974988 --> -0.975897).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1363843
	speed: 0.0671s/iter; left time: 2654.9131s
	iters: 200, epoch: 5 | loss: 0.0022128
	speed: 0.0203s/iter; left time: 802.6300s
	iters: 300, epoch: 5 | loss: 0.4193637
	speed: 0.0216s/iter; left time: 851.5619s
	iters: 400, epoch: 5 | loss: 0.0008071
	speed: 0.0215s/iter; left time: 842.2521s
Epoch: 5 cost time: 9.12082314491272
Epoch: 5, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0013364
	speed: 0.0649s/iter; left time: 2541.2467s
	iters: 200, epoch: 6 | loss: 0.0006210
	speed: 0.0216s/iter; left time: 843.6162s
	iters: 300, epoch: 6 | loss: 0.0007152
	speed: 0.0195s/iter; left time: 760.2562s
	iters: 400, epoch: 6 | loss: 0.0026279
	speed: 0.0206s/iter; left time: 799.2776s
Epoch: 6 cost time: 8.814607381820679
Epoch: 6, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0005454
	speed: 0.0621s/iter; left time: 2406.5731s
	iters: 200, epoch: 7 | loss: 0.0003085
	speed: 0.0190s/iter; left time: 732.4031s
	iters: 300, epoch: 7 | loss: 0.0005260
	speed: 0.0200s/iter; left time: 768.7597s
	iters: 400, epoch: 7 | loss: 0.0075477
	speed: 0.0208s/iter; left time: 798.5719s
Epoch: 7 cost time: 8.539515733718872
Epoch: 7, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0031771
	speed: 0.0658s/iter; left time: 2522.0517s
	iters: 200, epoch: 8 | loss: 0.0001208
	speed: 0.0190s/iter; left time: 725.1583s
	iters: 300, epoch: 8 | loss: 0.0003476
	speed: 0.0199s/iter; left time: 759.2625s
	iters: 400, epoch: 8 | loss: 0.0000259
	speed: 0.0191s/iter; left time: 726.5614s
Epoch: 8 cost time: 8.313852071762085
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
Validation loss decreased (-0.975897 --> -0.981354).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0542171
	speed: 0.0721s/iter; left time: 2731.0905s
	iters: 200, epoch: 9 | loss: 0.0074671
	speed: 0.0192s/iter; left time: 724.6840s
	iters: 300, epoch: 9 | loss: 0.0005699
	speed: 0.0195s/iter; left time: 734.0258s
	iters: 400, epoch: 9 | loss: 0.0364601
	speed: 0.0202s/iter; left time: 758.7469s
Epoch: 9 cost time: 8.551391124725342
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0115357
	speed: 0.0675s/iter; left time: 2530.0841s
	iters: 200, epoch: 10 | loss: 0.0000014
	speed: 0.0208s/iter; left time: 776.8383s
	iters: 300, epoch: 10 | loss: 0.0001152
	speed: 0.0221s/iter; left time: 822.8626s
	iters: 400, epoch: 10 | loss: 0.0040657
	speed: 0.0204s/iter; left time: 758.3445s
Epoch: 10 cost time: 8.917484760284424
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.062 Vali Acc: 0.986 Test Loss: 0.062 Test Acc: 0.986
Validation loss decreased (-0.981354 --> -0.985902).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0074022
	speed: 0.0703s/iter; left time: 2605.8105s
	iters: 200, epoch: 11 | loss: 0.0004312
	speed: 0.0206s/iter; left time: 760.1126s
	iters: 300, epoch: 11 | loss: 0.0002100
	speed: 0.0209s/iter; left time: 771.9675s
	iters: 400, epoch: 11 | loss: 0.0045549
	speed: 0.0214s/iter; left time: 787.9508s
Epoch: 11 cost time: 8.900930643081665
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000824
	speed: 0.0706s/iter; left time: 2588.7412s
	iters: 200, epoch: 12 | loss: 0.0000017
	speed: 0.0214s/iter; left time: 783.0232s
	iters: 300, epoch: 12 | loss: 0.0001046
	speed: 0.0223s/iter; left time: 814.7739s
	iters: 400, epoch: 12 | loss: 0.0003764
	speed: 0.0198s/iter; left time: 718.4279s
Epoch: 12 cost time: 9.11334776878357
Epoch: 12, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0001034
	speed: 0.0649s/iter; left time: 2353.7001s
	iters: 200, epoch: 13 | loss: 0.0255504
	speed: 0.0207s/iter; left time: 748.5217s
	iters: 300, epoch: 13 | loss: 0.0003513
	speed: 0.0194s/iter; left time: 697.8443s
	iters: 400, epoch: 13 | loss: 0.0000315
	speed: 0.0199s/iter; left time: 713.5137s
Epoch: 13 cost time: 8.602641344070435
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0010795
	speed: 0.0653s/iter; left time: 2338.8656s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0206s/iter; left time: 736.6731s
	iters: 300, epoch: 14 | loss: 0.0000597
	speed: 0.0205s/iter; left time: 729.5030s
	iters: 400, epoch: 14 | loss: 0.0000062
	speed: 0.0202s/iter; left time: 717.2232s
Epoch: 14 cost time: 8.712385177612305
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0165362
	speed: 0.0697s/iter; left time: 2470.3210s
	iters: 200, epoch: 15 | loss: 0.0000029
	speed: 0.0206s/iter; left time: 728.4821s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0202s/iter; left time: 712.5932s
	iters: 400, epoch: 15 | loss: 0.0002322
	speed: 0.0204s/iter; left time: 717.6274s
Epoch: 15 cost time: 8.784471273422241
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0002944
	speed: 0.0683s/iter; left time: 2391.5325s
	iters: 200, epoch: 16 | loss: 0.0000246
	speed: 0.0215s/iter; left time: 751.9522s
	iters: 300, epoch: 16 | loss: 0.0052470
	speed: 0.0209s/iter; left time: 728.0726s
	iters: 400, epoch: 16 | loss: 0.0195837
	speed: 0.0214s/iter; left time: 743.3500s
Epoch: 16 cost time: 9.185241937637329
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000528
	speed: 0.0665s/iter; left time: 2301.1084s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 716.8984s
	iters: 300, epoch: 17 | loss: 0.0094916
	speed: 0.0208s/iter; left time: 717.0680s
	iters: 400, epoch: 17 | loss: 0.0000005
	speed: 0.0220s/iter; left time: 752.7470s
Epoch: 17 cost time: 9.015040159225464
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0012701
	speed: 0.0736s/iter; left time: 2515.8261s
	iters: 200, epoch: 18 | loss: 0.0003720
	speed: 0.0202s/iter; left time: 687.3242s
	iters: 300, epoch: 18 | loss: 0.0000278
	speed: 0.0199s/iter; left time: 675.4090s
	iters: 400, epoch: 18 | loss: 0.0000050
	speed: 0.0212s/iter; left time: 717.9147s
Epoch: 18 cost time: 8.886095523834229
Epoch: 18, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000124
	speed: 0.0720s/iter; left time: 2431.0599s
	iters: 200, epoch: 19 | loss: 0.0030740
	speed: 0.0214s/iter; left time: 721.9106s
	iters: 300, epoch: 19 | loss: 0.0000005
	speed: 0.0215s/iter; left time: 722.3210s
	iters: 400, epoch: 19 | loss: 0.0000159
	speed: 0.0204s/iter; left time: 683.7326s
Epoch: 19 cost time: 8.945206642150879
Epoch: 19, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000121
	speed: 0.0767s/iter; left time: 2558.4447s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0209s/iter; left time: 693.7665s
	iters: 300, epoch: 20 | loss: 0.0029964
	speed: 0.0211s/iter; left time: 697.9492s
	iters: 400, epoch: 20 | loss: 0.0001943
	speed: 0.0205s/iter; left time: 678.7647s
Epoch: 20 cost time: 9.094054937362671
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 203790
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1654941
	speed: 0.0397s/iter; left time: 1636.7515s
	iters: 200, epoch: 1 | loss: 0.3848389
	speed: 0.0208s/iter; left time: 856.5854s
	iters: 300, epoch: 1 | loss: 0.3472107
	speed: 0.0215s/iter; left time: 880.4333s
	iters: 400, epoch: 1 | loss: 0.1328438
	speed: 0.0205s/iter; left time: 837.5819s
Epoch: 1 cost time: 10.572423219680786
Epoch: 1, Steps: 413 | Train Loss: 0.784 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0661927
	speed: 0.0644s/iter; left time: 2624.9163s
	iters: 200, epoch: 2 | loss: 0.0368221
	speed: 0.0211s/iter; left time: 857.2621s
	iters: 300, epoch: 2 | loss: 0.0191126
	speed: 0.0232s/iter; left time: 941.1856s
	iters: 400, epoch: 2 | loss: 0.1467086
	speed: 0.0209s/iter; left time: 845.0711s
Epoch: 2 cost time: 9.315022706985474
Epoch: 2, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.116 Vali Acc: 0.961 Test Loss: 0.116 Test Acc: 0.961
Validation loss decreased (-0.957252 --> -0.961345).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0546373
	speed: 0.0672s/iter; left time: 2715.1886s
	iters: 200, epoch: 3 | loss: 0.0075893
	speed: 0.0189s/iter; left time: 762.0455s
	iters: 300, epoch: 3 | loss: 0.0692042
	speed: 0.0214s/iter; left time: 861.3458s
	iters: 400, epoch: 3 | loss: 0.0734880
	speed: 0.0192s/iter; left time: 768.8305s
Epoch: 3 cost time: 8.85074496269226
Epoch: 3, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
Validation loss decreased (-0.961345 --> -0.972714).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0049151
	speed: 0.0661s/iter; left time: 2642.5596s
	iters: 200, epoch: 4 | loss: 0.0506780
	speed: 0.0213s/iter; left time: 848.7279s
	iters: 300, epoch: 4 | loss: 0.0189281
	speed: 0.0215s/iter; left time: 852.9457s
	iters: 400, epoch: 4 | loss: 0.0022748
	speed: 0.0205s/iter; left time: 812.5477s
Epoch: 4 cost time: 9.098704814910889
Epoch: 4, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1417169
	speed: 0.0692s/iter; left time: 2736.9013s
	iters: 200, epoch: 5 | loss: 0.0030480
	speed: 0.0214s/iter; left time: 844.5233s
	iters: 300, epoch: 5 | loss: 0.4552490
	speed: 0.0192s/iter; left time: 754.1520s
	iters: 400, epoch: 5 | loss: 0.0005053
	speed: 0.0197s/iter; left time: 771.7770s
Epoch: 5 cost time: 8.685373306274414
Epoch: 5, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0173327
	speed: 0.0708s/iter; left time: 2772.5648s
	iters: 200, epoch: 6 | loss: 0.0006308
	speed: 0.0194s/iter; left time: 755.9603s
	iters: 300, epoch: 6 | loss: 0.0022747
	speed: 0.0199s/iter; left time: 773.8972s
	iters: 400, epoch: 6 | loss: 0.0136636
	speed: 0.0204s/iter; left time: 792.0105s
Epoch: 6 cost time: 8.547427892684937
Epoch: 6, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0086664
	speed: 0.0705s/iter; left time: 2731.8606s
	iters: 200, epoch: 7 | loss: 0.0001439
	speed: 0.0201s/iter; left time: 774.8791s
	iters: 300, epoch: 7 | loss: 0.0006304
	speed: 0.0204s/iter; left time: 785.0933s
	iters: 400, epoch: 7 | loss: 0.0041095
	speed: 0.0205s/iter; left time: 785.7704s
Epoch: 7 cost time: 8.725097179412842
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
Validation loss decreased (-0.972714 --> -0.975897).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0498748
	speed: 0.0691s/iter; left time: 2648.9079s
	iters: 200, epoch: 8 | loss: 0.0002235
	speed: 0.0210s/iter; left time: 804.0087s
	iters: 300, epoch: 8 | loss: 0.0001208
	speed: 0.0217s/iter; left time: 828.7316s
	iters: 400, epoch: 8 | loss: 0.0002092
	speed: 0.0226s/iter; left time: 858.2717s
Epoch: 8 cost time: 9.210323810577393
Epoch: 8, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975897 --> -0.976352).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1394904
	speed: 0.0686s/iter; left time: 2600.8984s
	iters: 200, epoch: 9 | loss: 0.0016053
	speed: 0.0199s/iter; left time: 751.4605s
	iters: 300, epoch: 9 | loss: 0.0027971
	speed: 0.0214s/iter; left time: 806.3200s
	iters: 400, epoch: 9 | loss: 0.0002538
	speed: 0.0216s/iter; left time: 811.2694s
Epoch: 9 cost time: 8.877586364746094
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0031080
	speed: 0.0669s/iter; left time: 2506.6168s
	iters: 200, epoch: 10 | loss: 0.0142926
	speed: 0.0210s/iter; left time: 784.8194s
	iters: 300, epoch: 10 | loss: 0.0072744
	speed: 0.0198s/iter; left time: 737.3335s
	iters: 400, epoch: 10 | loss: 0.0001259
	speed: 0.0221s/iter; left time: 822.9889s
Epoch: 10 cost time: 8.987321853637695
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0118666
	speed: 0.0646s/iter; left time: 2395.3935s
	iters: 200, epoch: 11 | loss: 0.0010188
	speed: 0.0226s/iter; left time: 835.6985s
	iters: 300, epoch: 11 | loss: 0.0000193
	speed: 0.0223s/iter; left time: 822.4447s
	iters: 400, epoch: 11 | loss: 0.0002466
	speed: 0.0206s/iter; left time: 758.6951s
Epoch: 11 cost time: 9.233426332473755
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000327
	speed: 0.0650s/iter; left time: 2383.5102s
	iters: 200, epoch: 12 | loss: 0.0000428
	speed: 0.0199s/iter; left time: 729.2708s
	iters: 300, epoch: 12 | loss: 0.0003989
	speed: 0.0200s/iter; left time: 728.6311s
	iters: 400, epoch: 12 | loss: 0.0021563
	speed: 0.0206s/iter; left time: 749.6155s
Epoch: 12 cost time: 8.6438148021698
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.977261).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000094
	speed: 0.0694s/iter; left time: 2514.3518s
	iters: 200, epoch: 13 | loss: 0.0174054
	speed: 0.0198s/iter; left time: 714.7913s
	iters: 300, epoch: 13 | loss: 0.0000192
	speed: 0.0201s/iter; left time: 724.7366s
	iters: 400, epoch: 13 | loss: 0.0001445
	speed: 0.0203s/iter; left time: 729.5096s
Epoch: 13 cost time: 8.62848162651062
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0006483
	speed: 0.0768s/iter; left time: 2753.1788s
	iters: 200, epoch: 14 | loss: 0.0000441
	speed: 0.0214s/iter; left time: 766.1124s
	iters: 300, epoch: 14 | loss: 0.0012042
	speed: 0.0208s/iter; left time: 742.8787s
	iters: 400, epoch: 14 | loss: 0.0002123
	speed: 0.0205s/iter; left time: 728.2238s
Epoch: 14 cost time: 8.945746183395386
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.977261 --> -0.977716).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1651779
	speed: 0.0704s/iter; left time: 2492.5000s
	iters: 200, epoch: 15 | loss: 0.0018892
	speed: 0.0208s/iter; left time: 734.0851s
	iters: 300, epoch: 15 | loss: 0.0000054
	speed: 0.0203s/iter; left time: 713.2024s
	iters: 400, epoch: 15 | loss: 0.0042058
	speed: 0.0194s/iter; left time: 682.1172s
Epoch: 15 cost time: 8.775240898132324
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.977716 --> -0.980900).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0019369
	speed: 0.0633s/iter; left time: 2216.4480s
	iters: 200, epoch: 16 | loss: 0.0000967
	speed: 0.0203s/iter; left time: 707.6083s
	iters: 300, epoch: 16 | loss: 0.0001249
	speed: 0.0200s/iter; left time: 694.5022s
	iters: 400, epoch: 16 | loss: 0.0001825
	speed: 0.0209s/iter; left time: 723.6238s
Epoch: 16 cost time: 8.690046787261963
Epoch: 16, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000521
	speed: 0.0680s/iter; left time: 2350.6487s
	iters: 200, epoch: 17 | loss: 0.0000272
	speed: 0.0213s/iter; left time: 734.5527s
	iters: 300, epoch: 17 | loss: 0.0002156
	speed: 0.0198s/iter; left time: 681.2527s
	iters: 400, epoch: 17 | loss: 0.0000751
	speed: 0.0209s/iter; left time: 715.1941s
Epoch: 17 cost time: 8.809088468551636
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0001820
	speed: 0.0680s/iter; left time: 2325.5642s
	iters: 200, epoch: 18 | loss: 0.0002965
	speed: 0.0214s/iter; left time: 727.7726s
	iters: 300, epoch: 18 | loss: 0.0003366
	speed: 0.0223s/iter; left time: 757.2303s
	iters: 400, epoch: 18 | loss: 0.0000024
	speed: 0.0222s/iter; left time: 752.7871s
Epoch: 18 cost time: 9.215068340301514
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000547
	speed: 0.0654s/iter; left time: 2207.7106s
	iters: 200, epoch: 19 | loss: 0.0018611
	speed: 0.0207s/iter; left time: 696.7465s
	iters: 300, epoch: 19 | loss: 0.0000012
	speed: 0.0208s/iter; left time: 698.0398s
	iters: 400, epoch: 19 | loss: 0.0000216
	speed: 0.0208s/iter; left time: 696.2116s
Epoch: 19 cost time: 8.841952323913574
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000008
	speed: 0.0657s/iter; left time: 2190.1310s
	iters: 200, epoch: 20 | loss: 0.0000435
	speed: 0.0206s/iter; left time: 686.1297s
	iters: 300, epoch: 20 | loss: 0.0001011
	speed: 0.0208s/iter; left time: 688.5667s
	iters: 400, epoch: 20 | loss: 0.0000032
	speed: 0.0213s/iter; left time: 705.4080s
Epoch: 20 cost time: 8.942976951599121
Epoch: 20, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
Validation loss decreased (-0.980900 --> -0.981809).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000016
	speed: 0.0653s/iter; left time: 2152.6151s
	iters: 200, epoch: 21 | loss: 0.0000373
	speed: 0.0200s/iter; left time: 656.3287s
	iters: 300, epoch: 21 | loss: 0.0000124
	speed: 0.0197s/iter; left time: 643.7607s
	iters: 400, epoch: 21 | loss: 0.0000474
	speed: 0.0205s/iter; left time: 668.8465s
Epoch: 21 cost time: 8.773361921310425
Epoch: 21, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000069
	speed: 0.0669s/iter; left time: 2174.7884s
	iters: 200, epoch: 22 | loss: 0.0000033
	speed: 0.0194s/iter; left time: 629.0745s
	iters: 300, epoch: 22 | loss: 0.0000009
	speed: 0.0192s/iter; left time: 620.7523s
	iters: 400, epoch: 22 | loss: 0.0002573
	speed: 0.0192s/iter; left time: 619.6641s
Epoch: 22 cost time: 8.402696132659912
Epoch: 22, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
Validation loss decreased (-0.981809 --> -0.982264).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0001565
	speed: 0.0717s/iter; left time: 2302.6270s
	iters: 200, epoch: 23 | loss: 0.0011774
	speed: 0.0201s/iter; left time: 642.7749s
	iters: 300, epoch: 23 | loss: 0.0001123
	speed: 0.0197s/iter; left time: 627.9765s
	iters: 400, epoch: 23 | loss: 0.0000227
	speed: 0.0199s/iter; left time: 634.3124s
Epoch: 23 cost time: 8.638973951339722
Epoch: 23, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000325
	speed: 0.0689s/iter; left time: 2183.3906s
	iters: 200, epoch: 24 | loss: 0.0000095
	speed: 0.0209s/iter; left time: 660.5225s
	iters: 300, epoch: 24 | loss: 0.0000055
	speed: 0.0217s/iter; left time: 682.8554s
	iters: 400, epoch: 24 | loss: 0.0006639
	speed: 0.0209s/iter; left time: 656.2218s
Epoch: 24 cost time: 9.04668116569519
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0002676
	speed: 0.0697s/iter; left time: 2182.3504s
	iters: 200, epoch: 25 | loss: 0.0004187
	speed: 0.0208s/iter; left time: 648.7430s
	iters: 300, epoch: 25 | loss: 0.0000301
	speed: 0.0217s/iter; left time: 673.2724s
	iters: 400, epoch: 25 | loss: 0.0000164
	speed: 0.0228s/iter; left time: 706.0983s
Epoch: 25 cost time: 9.270438194274902
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.984 Test Loss: 0.103 Test Acc: 0.984
Validation loss decreased (-0.982264 --> -0.984083).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000518
	speed: 0.0693s/iter; left time: 2138.2804s
	iters: 200, epoch: 26 | loss: 0.0018558
	speed: 0.0207s/iter; left time: 635.6887s
	iters: 300, epoch: 26 | loss: 0.0000131
	speed: 0.0216s/iter; left time: 662.5835s
	iters: 400, epoch: 26 | loss: 0.0000024
	speed: 0.0207s/iter; left time: 631.9818s
Epoch: 26 cost time: 8.942736864089966
Epoch: 26, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.072 Vali Acc: 0.989 Test Loss: 0.072 Test Acc: 0.989
Validation loss decreased (-0.984083 --> -0.988630).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0115627
	speed: 0.0656s/iter; left time: 1998.1325s
	iters: 200, epoch: 27 | loss: 0.0000036
	speed: 0.0218s/iter; left time: 662.7448s
	iters: 300, epoch: 27 | loss: 0.0013328
	speed: 0.0215s/iter; left time: 651.6384s
	iters: 400, epoch: 27 | loss: 0.0000003
	speed: 0.0221s/iter; left time: 666.4278s
Epoch: 27 cost time: 9.194172859191895
Epoch: 27, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000071
	speed: 0.0650s/iter; left time: 1953.0284s
	iters: 200, epoch: 28 | loss: 0.0000575
	speed: 0.0201s/iter; left time: 600.9930s
	iters: 300, epoch: 28 | loss: 0.0000008
	speed: 0.0206s/iter; left time: 613.4562s
	iters: 400, epoch: 28 | loss: 0.0000050
	speed: 0.0202s/iter; left time: 601.4870s
Epoch: 28 cost time: 8.68746280670166
Epoch: 28, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000085
	speed: 0.0636s/iter; left time: 1885.5382s
	iters: 200, epoch: 29 | loss: 0.0000007
	speed: 0.0209s/iter; left time: 616.2353s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0213s/iter; left time: 625.6001s
	iters: 400, epoch: 29 | loss: 0.0000005
	speed: 0.0208s/iter; left time: 610.2268s
Epoch: 29 cost time: 8.857540130615234
Epoch: 29, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.982 Test Loss: 0.139 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000014
	speed: 0.0698s/iter; left time: 2039.1260s
	iters: 200, epoch: 30 | loss: 0.0000003
	speed: 0.0212s/iter; left time: 618.0426s
	iters: 300, epoch: 30 | loss: 0.0000100
	speed: 0.0208s/iter; left time: 603.5789s
	iters: 400, epoch: 30 | loss: 0.0000013
	speed: 0.0209s/iter; left time: 604.5710s
Epoch: 30 cost time: 8.881588459014893
Epoch: 30, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000026
	speed: 0.0664s/iter; left time: 1913.0416s
	iters: 200, epoch: 31 | loss: 0.0000025
	speed: 0.0204s/iter; left time: 586.7547s
	iters: 300, epoch: 31 | loss: 0.0000015
	speed: 0.0215s/iter; left time: 615.7906s
	iters: 400, epoch: 31 | loss: 0.0001863
	speed: 0.0211s/iter; left time: 602.1338s
Epoch: 31 cost time: 9.038103103637695
Epoch: 31, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.973 Test Loss: 0.161 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000031
	speed: 0.0709s/iter; left time: 2012.6412s
	iters: 200, epoch: 32 | loss: 0.0000115
	speed: 0.0217s/iter; left time: 613.3043s
	iters: 300, epoch: 32 | loss: 0.0000620
	speed: 0.0216s/iter; left time: 609.1117s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 617.2707s
Epoch: 32 cost time: 9.168920755386353
Epoch: 32, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0022773
	speed: 0.0693s/iter; left time: 1939.6919s
	iters: 200, epoch: 33 | loss: 0.0001796
	speed: 0.0210s/iter; left time: 585.5772s
	iters: 300, epoch: 33 | loss: 0.0000065
	speed: 0.0212s/iter; left time: 589.5172s
	iters: 400, epoch: 33 | loss: 0.0000129
	speed: 0.0209s/iter; left time: 579.5931s
Epoch: 33 cost time: 8.876942157745361
Epoch: 33, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.125 Vali Acc: 0.982 Test Loss: 0.125 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000017
	speed: 0.0697s/iter; left time: 1923.0691s
	iters: 200, epoch: 34 | loss: 0.0057589
	speed: 0.0201s/iter; left time: 553.2527s
	iters: 300, epoch: 34 | loss: 0.0001343
	speed: 0.0202s/iter; left time: 553.1688s
	iters: 400, epoch: 34 | loss: 0.0000092
	speed: 0.0185s/iter; left time: 504.5309s
Epoch: 34 cost time: 8.532692670822144
Epoch: 34, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0000187
	speed: 0.0707s/iter; left time: 1920.7429s
	iters: 200, epoch: 35 | loss: 0.0000291
	speed: 0.0186s/iter; left time: 503.6859s
	iters: 300, epoch: 35 | loss: 0.0003508
	speed: 0.0184s/iter; left time: 495.5636s
	iters: 400, epoch: 35 | loss: 0.0167877
	speed: 0.0186s/iter; left time: 500.3666s
Epoch: 35 cost time: 8.165137767791748
Epoch: 35, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.149 Vali Acc: 0.978 Test Loss: 0.149 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0000237
	speed: 0.0666s/iter; left time: 1780.1303s
	iters: 200, epoch: 36 | loss: 0.0000289
	speed: 0.0188s/iter; left time: 499.9463s
	iters: 300, epoch: 36 | loss: 0.0000003
	speed: 0.0198s/iter; left time: 526.1974s
	iters: 400, epoch: 36 | loss: 0.0001333
	speed: 0.0197s/iter; left time: 520.7655s
Epoch: 36 cost time: 8.393647909164429
Epoch: 36, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 203790
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4451424
	speed: 0.0343s/iter; left time: 1413.6846s
	iters: 200, epoch: 1 | loss: 0.2795868
	speed: 0.0189s/iter; left time: 778.4147s
	iters: 300, epoch: 1 | loss: 0.0879628
	speed: 0.0184s/iter; left time: 752.6123s
	iters: 400, epoch: 1 | loss: 0.1535179
	speed: 0.0188s/iter; left time: 769.5223s
Epoch: 1 cost time: 9.360857248306274
Epoch: 1, Steps: 413 | Train Loss: 0.561 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (inf --> -0.965438).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0112712
	speed: 0.0621s/iter; left time: 2532.2602s
	iters: 200, epoch: 2 | loss: 0.0211670
	speed: 0.0192s/iter; left time: 782.4717s
	iters: 300, epoch: 2 | loss: 0.0066776
	speed: 0.0200s/iter; left time: 813.1648s
	iters: 400, epoch: 2 | loss: 0.0442943
	speed: 0.0200s/iter; left time: 811.4307s
Epoch: 2 cost time: 8.52215313911438
Epoch: 2, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.084 Vali Acc: 0.971 Test Loss: 0.084 Test Acc: 0.971
Validation loss decreased (-0.965438 --> -0.971350).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0037859
	speed: 0.0654s/iter; left time: 2641.5375s
	iters: 200, epoch: 3 | loss: 0.1089316
	speed: 0.0195s/iter; left time: 786.4758s
	iters: 300, epoch: 3 | loss: 0.0376763
	speed: 0.0201s/iter; left time: 805.8481s
	iters: 400, epoch: 3 | loss: 0.0741270
	speed: 0.0203s/iter; left time: 811.6949s
Epoch: 3 cost time: 8.684891939163208
Epoch: 3, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.073 Vali Acc: 0.974 Test Loss: 0.073 Test Acc: 0.974
Validation loss decreased (-0.971350 --> -0.973624).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0039468
	speed: 0.0677s/iter; left time: 2707.1083s
	iters: 200, epoch: 4 | loss: 0.0083167
	speed: 0.0180s/iter; left time: 718.2211s
	iters: 300, epoch: 4 | loss: 0.0055996
	speed: 0.0174s/iter; left time: 693.5190s
	iters: 400, epoch: 4 | loss: 0.0199637
	speed: 0.0172s/iter; left time: 682.9760s
Epoch: 4 cost time: 7.825937032699585
Epoch: 4, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0027688
	speed: 0.0669s/iter; left time: 2647.7589s
	iters: 200, epoch: 5 | loss: 0.0041843
	speed: 0.0180s/iter; left time: 710.7805s
	iters: 300, epoch: 5 | loss: 0.0000892
	speed: 0.0177s/iter; left time: 696.5533s
	iters: 400, epoch: 5 | loss: 0.0117835
	speed: 0.0165s/iter; left time: 648.1710s
Epoch: 5 cost time: 7.643387794494629
Epoch: 5, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.973624 --> -0.976807).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0028944
	speed: 0.0707s/iter; left time: 2766.4404s
	iters: 200, epoch: 6 | loss: 0.0023238
	speed: 0.0201s/iter; left time: 783.8893s
	iters: 300, epoch: 6 | loss: 0.0094273
	speed: 0.0204s/iter; left time: 793.6361s
	iters: 400, epoch: 6 | loss: 0.0023399
	speed: 0.0200s/iter; left time: 778.5226s
Epoch: 6 cost time: 8.824202299118042
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.967 Test Loss: 0.100 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0091191
	speed: 0.0755s/iter; left time: 2923.6707s
	iters: 200, epoch: 7 | loss: 0.0009918
	speed: 0.0209s/iter; left time: 807.1748s
	iters: 300, epoch: 7 | loss: 0.0005474
	speed: 0.0204s/iter; left time: 785.5619s
	iters: 400, epoch: 7 | loss: 0.0000914
	speed: 0.0205s/iter; left time: 788.4644s
Epoch: 7 cost time: 8.91773772239685
Epoch: 7, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000221
	speed: 0.0690s/iter; left time: 2642.9415s
	iters: 200, epoch: 8 | loss: 0.0014370
	speed: 0.0202s/iter; left time: 770.0381s
	iters: 300, epoch: 8 | loss: 0.0070635
	speed: 0.0217s/iter; left time: 825.3423s
	iters: 400, epoch: 8 | loss: 0.0334143
	speed: 0.0209s/iter; left time: 793.3277s
Epoch: 8 cost time: 9.045858383178711
Epoch: 8, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0002187
	speed: 0.0679s/iter; left time: 2573.0033s
	iters: 200, epoch: 9 | loss: 0.2092819
	speed: 0.0213s/iter; left time: 806.2048s
	iters: 300, epoch: 9 | loss: 0.0000147
	speed: 0.0210s/iter; left time: 793.2023s
	iters: 400, epoch: 9 | loss: 0.0043093
	speed: 0.0207s/iter; left time: 780.0082s
Epoch: 9 cost time: 9.139030933380127
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0021337
	speed: 0.0671s/iter; left time: 2514.5030s
	iters: 200, epoch: 10 | loss: 0.0001664
	speed: 0.0212s/iter; left time: 793.3808s
	iters: 300, epoch: 10 | loss: 0.0005327
	speed: 0.0211s/iter; left time: 786.2870s
	iters: 400, epoch: 10 | loss: 0.1070111
	speed: 0.0208s/iter; left time: 774.2262s
Epoch: 10 cost time: 9.056489944458008
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976807 --> -0.977261).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0003853
	speed: 0.0697s/iter; left time: 2583.4953s
	iters: 200, epoch: 11 | loss: 0.0002661
	speed: 0.0200s/iter; left time: 739.6189s
	iters: 300, epoch: 11 | loss: 0.0000095
	speed: 0.0199s/iter; left time: 733.6934s
	iters: 400, epoch: 11 | loss: 0.0149660
	speed: 0.0203s/iter; left time: 746.7541s
Epoch: 11 cost time: 8.765504598617554
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0004333
	speed: 0.0703s/iter; left time: 2578.2279s
	iters: 200, epoch: 12 | loss: 0.0000105
	speed: 0.0198s/iter; left time: 723.2700s
	iters: 300, epoch: 12 | loss: 0.0004068
	speed: 0.0214s/iter; left time: 779.8995s
	iters: 400, epoch: 12 | loss: 0.0001866
	speed: 0.0205s/iter; left time: 746.4430s
Epoch: 12 cost time: 8.77139139175415
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.977261 --> -0.979535).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000116
	speed: 0.0815s/iter; left time: 2953.4662s
	iters: 200, epoch: 13 | loss: 0.0000008
	speed: 0.0221s/iter; left time: 798.6982s
	iters: 300, epoch: 13 | loss: 0.0032766
	speed: 0.0208s/iter; left time: 748.2296s
	iters: 400, epoch: 13 | loss: 0.0005845
	speed: 0.0203s/iter; left time: 729.8928s
Epoch: 13 cost time: 9.187310457229614
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
Validation loss decreased (-0.979535 --> -0.981809).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0001112
	speed: 0.0780s/iter; left time: 2794.6096s
	iters: 200, epoch: 14 | loss: 0.0124447
	speed: 0.0227s/iter; left time: 811.3847s
	iters: 300, epoch: 14 | loss: 0.0011886
	speed: 0.0208s/iter; left time: 740.5209s
	iters: 400, epoch: 14 | loss: 0.0139827
	speed: 0.0215s/iter; left time: 765.4159s
Epoch: 14 cost time: 9.373613595962524
Epoch: 14, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.981809 --> -0.983173).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0001786
	speed: 0.0745s/iter; left time: 2638.8597s
	iters: 200, epoch: 15 | loss: 0.3082502
	speed: 0.0204s/iter; left time: 720.7946s
	iters: 300, epoch: 15 | loss: 0.0014887
	speed: 0.0223s/iter; left time: 785.1829s
	iters: 400, epoch: 15 | loss: 0.0000106
	speed: 0.0216s/iter; left time: 759.8806s
Epoch: 15 cost time: 9.277146816253662
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0001993
	speed: 0.0750s/iter; left time: 2624.2443s
	iters: 200, epoch: 16 | loss: 0.0001528
	speed: 0.0217s/iter; left time: 758.5559s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 738.3490s
	iters: 400, epoch: 16 | loss: 0.0032444
	speed: 0.0208s/iter; left time: 722.8955s
Epoch: 16 cost time: 9.2394118309021
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000034
	speed: 0.0697s/iter; left time: 2410.5524s
	iters: 200, epoch: 17 | loss: 0.0000106
	speed: 0.0200s/iter; left time: 690.3029s
	iters: 300, epoch: 17 | loss: 0.0000023
	speed: 0.0211s/iter; left time: 725.2338s
	iters: 400, epoch: 17 | loss: 0.0150031
	speed: 0.0209s/iter; left time: 716.4623s
Epoch: 17 cost time: 8.983063459396362
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000030
	speed: 0.0716s/iter; left time: 2447.6316s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0202s/iter; left time: 689.8562s
	iters: 300, epoch: 18 | loss: 0.0022050
	speed: 0.0197s/iter; left time: 667.8116s
	iters: 400, epoch: 18 | loss: 0.0104365
	speed: 0.0202s/iter; left time: 683.0375s
Epoch: 18 cost time: 8.786834001541138
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000115
	speed: 0.0695s/iter; left time: 2348.3668s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0195s/iter; left time: 657.6011s
	iters: 300, epoch: 19 | loss: 0.0000058
	speed: 0.0197s/iter; left time: 660.0921s
	iters: 400, epoch: 19 | loss: 0.0000005
	speed: 0.0200s/iter; left time: 668.5830s
Epoch: 19 cost time: 8.739368200302124
Epoch: 19, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0001390
	speed: 0.0690s/iter; left time: 2300.5737s
	iters: 200, epoch: 20 | loss: 0.0019919
	speed: 0.0212s/iter; left time: 703.3508s
	iters: 300, epoch: 20 | loss: 0.0000047
	speed: 0.0218s/iter; left time: 722.7540s
	iters: 400, epoch: 20 | loss: 0.0000002
	speed: 0.0199s/iter; left time: 658.2140s
Epoch: 20 cost time: 9.073722839355469
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000021
	speed: 0.0744s/iter; left time: 2449.6266s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0224s/iter; left time: 736.6171s
	iters: 300, epoch: 21 | loss: 0.0000004
	speed: 0.0220s/iter; left time: 719.0527s
	iters: 400, epoch: 21 | loss: 0.0000083
	speed: 0.0223s/iter; left time: 728.4517s
Epoch: 21 cost time: 9.544942617416382
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000005
	speed: 0.0731s/iter; left time: 2377.0465s
	iters: 200, epoch: 22 | loss: 0.0000346
	speed: 0.0225s/iter; left time: 729.7492s
	iters: 300, epoch: 22 | loss: 0.0000007
	speed: 0.0220s/iter; left time: 712.7777s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0225s/iter; left time: 725.2473s
Epoch: 22 cost time: 9.582715034484863
Epoch: 22, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000052
	speed: 0.0742s/iter; left time: 2384.5341s
	iters: 200, epoch: 23 | loss: 0.0000012
	speed: 0.0215s/iter; left time: 687.2209s
	iters: 300, epoch: 23 | loss: 0.0000010
	speed: 0.0219s/iter; left time: 699.6718s
	iters: 400, epoch: 23 | loss: 0.0000016
	speed: 0.0210s/iter; left time: 666.7049s
Epoch: 23 cost time: 9.345211744308472
Epoch: 23, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000214
	speed: 0.0758s/iter; left time: 2402.6851s
	iters: 200, epoch: 24 | loss: 0.0000005
	speed: 0.0204s/iter; left time: 644.4716s
	iters: 300, epoch: 24 | loss: 0.0000707
	speed: 0.0205s/iter; left time: 646.8564s
	iters: 400, epoch: 24 | loss: 0.0000249
	speed: 0.0210s/iter; left time: 658.6003s
Epoch: 24 cost time: 8.960151433944702
Epoch: 24, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.976 Test Loss: 0.156 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 138254
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5263246
	speed: 0.0367s/iter; left time: 1513.8230s
	iters: 200, epoch: 1 | loss: 0.2920820
	speed: 0.0206s/iter; left time: 845.2409s
	iters: 300, epoch: 1 | loss: 0.1129364
	speed: 0.0225s/iter; left time: 920.7745s
	iters: 400, epoch: 1 | loss: 0.1804702
	speed: 0.0206s/iter; left time: 841.1636s
Epoch: 1 cost time: 10.365769863128662
Epoch: 1, Steps: 413 | Train Loss: 0.585 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (inf --> -0.964528).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0122642
	speed: 0.0619s/iter; left time: 2526.6605s
	iters: 200, epoch: 2 | loss: 0.0262758
	speed: 0.0210s/iter; left time: 853.7062s
	iters: 300, epoch: 2 | loss: 0.0084270
	speed: 0.0205s/iter; left time: 831.4489s
	iters: 400, epoch: 2 | loss: 0.0504286
	speed: 0.0198s/iter; left time: 801.4000s
Epoch: 2 cost time: 8.595274925231934
Epoch: 2, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.964528 --> -0.972714).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0026657
	speed: 0.0601s/iter; left time: 2428.2273s
	iters: 200, epoch: 3 | loss: 0.0893863
	speed: 0.0195s/iter; left time: 785.3376s
	iters: 300, epoch: 3 | loss: 0.0906395
	speed: 0.0207s/iter; left time: 831.7206s
	iters: 400, epoch: 3 | loss: 0.1922414
	speed: 0.0200s/iter; left time: 803.0001s
Epoch: 3 cost time: 8.671024799346924
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.072 Vali Acc: 0.974 Test Loss: 0.072 Test Acc: 0.974
Validation loss decreased (-0.972714 --> -0.973624).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0136352
	speed: 0.0654s/iter; left time: 2613.9918s
	iters: 200, epoch: 4 | loss: 0.0055897
	speed: 0.0218s/iter; left time: 870.4489s
	iters: 300, epoch: 4 | loss: 0.0072735
	speed: 0.0219s/iter; left time: 871.4149s
	iters: 400, epoch: 4 | loss: 0.0184461
	speed: 0.0220s/iter; left time: 871.7131s
Epoch: 4 cost time: 9.263591527938843
Epoch: 4, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.075 Vali Acc: 0.972 Test Loss: 0.075 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0014575
	speed: 0.0676s/iter; left time: 2673.1141s
	iters: 200, epoch: 5 | loss: 0.0035389
	speed: 0.0190s/iter; left time: 748.2560s
	iters: 300, epoch: 5 | loss: 0.0003512
	speed: 0.0190s/iter; left time: 747.5703s
	iters: 400, epoch: 5 | loss: 0.0624798
	speed: 0.0195s/iter; left time: 765.6891s
Epoch: 5 cost time: 8.469755172729492
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
Validation loss decreased (-0.973624 --> -0.977262).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0017967
	speed: 0.0675s/iter; left time: 2642.7681s
	iters: 200, epoch: 6 | loss: 0.0014251
	speed: 0.0192s/iter; left time: 749.3233s
	iters: 300, epoch: 6 | loss: 0.0008575
	speed: 0.0205s/iter; left time: 798.5440s
	iters: 400, epoch: 6 | loss: 0.0055498
	speed: 0.0190s/iter; left time: 737.1664s
Epoch: 6 cost time: 8.441822528839111
Epoch: 6, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0100040
	speed: 0.0678s/iter; left time: 2625.5755s
	iters: 200, epoch: 7 | loss: 0.0006668
	speed: 0.0204s/iter; left time: 787.5820s
	iters: 300, epoch: 7 | loss: 0.0003223
	speed: 0.0204s/iter; left time: 785.2388s
	iters: 400, epoch: 7 | loss: 0.0001618
	speed: 0.0200s/iter; left time: 770.3407s
Epoch: 7 cost time: 8.689543962478638
Epoch: 7, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
Validation loss decreased (-0.977262 --> -0.980900).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0002280
	speed: 0.0722s/iter; left time: 2765.5555s
	iters: 200, epoch: 8 | loss: 0.0033526
	speed: 0.0205s/iter; left time: 781.9310s
	iters: 300, epoch: 8 | loss: 0.0141922
	speed: 0.0198s/iter; left time: 753.2241s
	iters: 400, epoch: 8 | loss: 0.0000218
	speed: 0.0209s/iter; left time: 795.5561s
Epoch: 8 cost time: 8.850712537765503
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0012602
	speed: 0.0682s/iter; left time: 2583.4848s
	iters: 200, epoch: 9 | loss: 0.0013971
	speed: 0.0204s/iter; left time: 769.8954s
	iters: 300, epoch: 9 | loss: 0.0018977
	speed: 0.0208s/iter; left time: 785.2224s
	iters: 400, epoch: 9 | loss: 0.2571094
	speed: 0.0201s/iter; left time: 754.4606s
Epoch: 9 cost time: 8.642118215560913
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0010646
	speed: 0.0683s/iter; left time: 2560.3532s
	iters: 200, epoch: 10 | loss: 0.0000818
	speed: 0.0217s/iter; left time: 812.1806s
	iters: 300, epoch: 10 | loss: 0.0017127
	speed: 0.0213s/iter; left time: 795.8856s
	iters: 400, epoch: 10 | loss: 0.0077909
	speed: 0.0212s/iter; left time: 789.3424s
Epoch: 10 cost time: 9.233500480651855
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0262408
	speed: 0.0734s/iter; left time: 2722.4916s
	iters: 200, epoch: 11 | loss: 0.0006317
	speed: 0.0202s/iter; left time: 746.3518s
	iters: 300, epoch: 11 | loss: 0.0000111
	speed: 0.0202s/iter; left time: 745.6821s
	iters: 400, epoch: 11 | loss: 0.0000813
	speed: 0.0226s/iter; left time: 832.6221s
Epoch: 11 cost time: 8.99209451675415
Epoch: 11, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0032197
	speed: 0.0705s/iter; left time: 2585.6581s
	iters: 200, epoch: 12 | loss: 0.0000506
	speed: 0.0186s/iter; left time: 679.1397s
	iters: 300, epoch: 12 | loss: 0.0000823
	speed: 0.0201s/iter; left time: 731.0181s
	iters: 400, epoch: 12 | loss: 0.0028476
	speed: 0.0201s/iter; left time: 731.6999s
Epoch: 12 cost time: 8.492693662643433
Epoch: 12, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000274
	speed: 0.0652s/iter; left time: 2361.4405s
	iters: 200, epoch: 13 | loss: 0.0007426
	speed: 0.0199s/iter; left time: 719.2284s
	iters: 300, epoch: 13 | loss: 0.0008789
	speed: 0.0212s/iter; left time: 762.5122s
	iters: 400, epoch: 13 | loss: 0.0002509
	speed: 0.0203s/iter; left time: 729.5207s
Epoch: 13 cost time: 8.67887568473816
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0008226
	speed: 0.0676s/iter; left time: 2423.5106s
	iters: 200, epoch: 14 | loss: 0.0017239
	speed: 0.0196s/iter; left time: 701.0039s
	iters: 300, epoch: 14 | loss: 0.0005160
	speed: 0.0194s/iter; left time: 691.5527s
	iters: 400, epoch: 14 | loss: 0.0000144
	speed: 0.0203s/iter; left time: 721.0629s
Epoch: 14 cost time: 8.501431465148926
Epoch: 14, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000021
	speed: 0.0625s/iter; left time: 2213.7408s
	iters: 200, epoch: 15 | loss: 0.0004913
	speed: 0.0198s/iter; left time: 699.7374s
	iters: 300, epoch: 15 | loss: 0.0326201
	speed: 0.0183s/iter; left time: 645.0598s
	iters: 400, epoch: 15 | loss: 0.0002283
	speed: 0.0213s/iter; left time: 746.5035s
Epoch: 15 cost time: 8.417844772338867
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000009
	speed: 0.0640s/iter; left time: 2240.4316s
	iters: 200, epoch: 16 | loss: 0.0001154
	speed: 0.0207s/iter; left time: 721.3788s
	iters: 300, epoch: 16 | loss: 0.0000013
	speed: 0.0210s/iter; left time: 729.9186s
	iters: 400, epoch: 16 | loss: 0.1035043
	speed: 0.0211s/iter; left time: 731.9305s
Epoch: 16 cost time: 8.955775499343872
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000029
	speed: 0.0688s/iter; left time: 2379.2160s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0215s/iter; left time: 742.4426s
	iters: 300, epoch: 17 | loss: 0.0000052
	speed: 0.0214s/iter; left time: 736.5204s
	iters: 400, epoch: 17 | loss: 0.0000390
	speed: 0.0204s/iter; left time: 700.9774s
Epoch: 17 cost time: 9.089600086212158
Epoch: 17, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 138254
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6847795
	speed: 0.0382s/iter; left time: 1572.5277s
	iters: 200, epoch: 1 | loss: 0.3337273
	speed: 0.0198s/iter; left time: 815.5440s
	iters: 300, epoch: 1 | loss: 0.1415918
	speed: 0.0193s/iter; left time: 790.5077s
	iters: 400, epoch: 1 | loss: 0.2046235
	speed: 0.0206s/iter; left time: 841.6992s
Epoch: 1 cost time: 10.09683632850647
Epoch: 1, Steps: 413 | Train Loss: 0.637 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (inf --> -0.961799).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0133186
	speed: 0.0674s/iter; left time: 2751.0348s
	iters: 200, epoch: 2 | loss: 0.0346211
	speed: 0.0191s/iter; left time: 778.2570s
	iters: 300, epoch: 2 | loss: 0.0083184
	speed: 0.0194s/iter; left time: 787.9108s
	iters: 400, epoch: 2 | loss: 0.0504623
	speed: 0.0204s/iter; left time: 824.6601s
Epoch: 2 cost time: 8.473775148391724
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.088 Vali Acc: 0.969 Test Loss: 0.088 Test Acc: 0.969
Validation loss decreased (-0.961799 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0055141
	speed: 0.0710s/iter; left time: 2868.5501s
	iters: 200, epoch: 3 | loss: 0.1035875
	speed: 0.0208s/iter; left time: 838.1795s
	iters: 300, epoch: 3 | loss: 0.1373050
	speed: 0.0209s/iter; left time: 838.2839s
	iters: 400, epoch: 3 | loss: 0.0914105
	speed: 0.0206s/iter; left time: 823.7581s
Epoch: 3 cost time: 8.905203342437744
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.063 Vali Acc: 0.977 Test Loss: 0.063 Test Acc: 0.977
Validation loss decreased (-0.969076 --> -0.977262).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0027957
	speed: 0.0678s/iter; left time: 2707.8696s
	iters: 200, epoch: 4 | loss: 0.0063023
	speed: 0.0232s/iter; left time: 923.2862s
	iters: 300, epoch: 4 | loss: 0.0151245
	speed: 0.0214s/iter; left time: 849.5055s
	iters: 400, epoch: 4 | loss: 0.0197477
	speed: 0.0219s/iter; left time: 868.6315s
Epoch: 4 cost time: 9.55277156829834
Epoch: 4, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0020931
	speed: 0.0682s/iter; left time: 2698.5306s
	iters: 200, epoch: 5 | loss: 0.0023861
	speed: 0.0213s/iter; left time: 839.9287s
	iters: 300, epoch: 5 | loss: 0.0003490
	speed: 0.0212s/iter; left time: 834.8497s
	iters: 400, epoch: 5 | loss: 0.0294320
	speed: 0.0217s/iter; left time: 850.6905s
Epoch: 5 cost time: 9.234817266464233
Epoch: 5, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0020122
	speed: 0.0671s/iter; left time: 2627.2395s
	iters: 200, epoch: 6 | loss: 0.0055536
	speed: 0.0203s/iter; left time: 791.8854s
	iters: 300, epoch: 6 | loss: 0.0060859
	speed: 0.0212s/iter; left time: 824.6136s
	iters: 400, epoch: 6 | loss: 0.0032436
	speed: 0.0222s/iter; left time: 861.4395s
Epoch: 6 cost time: 9.169614791870117
Epoch: 6, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0192857
	speed: 0.0665s/iter; left time: 2576.9351s
	iters: 200, epoch: 7 | loss: 0.0042619
	speed: 0.0204s/iter; left time: 786.4452s
	iters: 300, epoch: 7 | loss: 0.0000726
	speed: 0.0203s/iter; left time: 781.7662s
	iters: 400, epoch: 7 | loss: 0.0016919
	speed: 0.0202s/iter; left time: 774.7506s
Epoch: 7 cost time: 8.675777435302734
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.972 Test Loss: 0.085 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0001657
	speed: 0.0681s/iter; left time: 2610.7482s
	iters: 200, epoch: 8 | loss: 0.0050618
	speed: 0.0201s/iter; left time: 767.8192s
	iters: 300, epoch: 8 | loss: 0.0002355
	speed: 0.0211s/iter; left time: 802.9736s
	iters: 400, epoch: 8 | loss: 0.0001335
	speed: 0.0203s/iter; left time: 770.6491s
Epoch: 8 cost time: 8.702955484390259
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0183669
	speed: 0.0756s/iter; left time: 2865.9865s
	iters: 200, epoch: 9 | loss: 0.0165584
	speed: 0.0203s/iter; left time: 767.4818s
	iters: 300, epoch: 9 | loss: 0.0110044
	speed: 0.0196s/iter; left time: 738.0019s
	iters: 400, epoch: 9 | loss: 0.0327116
	speed: 0.0211s/iter; left time: 794.3410s
Epoch: 9 cost time: 8.887993335723877
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.140 Vali Acc: 0.966 Test Loss: 0.140 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0019574
	speed: 0.0701s/iter; left time: 2628.7761s
	iters: 200, epoch: 10 | loss: 0.0108130
	speed: 0.0205s/iter; left time: 764.5107s
	iters: 300, epoch: 10 | loss: 0.0002252
	speed: 0.0205s/iter; left time: 763.5632s
	iters: 400, epoch: 10 | loss: 0.0268472
	speed: 0.0202s/iter; left time: 751.8297s
Epoch: 10 cost time: 8.7390775680542
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0066000
	speed: 0.0703s/iter; left time: 2606.9841s
	iters: 200, epoch: 11 | loss: 0.0018784
	speed: 0.0219s/iter; left time: 809.1732s
	iters: 300, epoch: 11 | loss: 0.0052909
	speed: 0.0219s/iter; left time: 807.1291s
	iters: 400, epoch: 11 | loss: 0.1311156
	speed: 0.0216s/iter; left time: 795.9200s
Epoch: 11 cost time: 9.193055868148804
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.143 Vali Acc: 0.972 Test Loss: 0.143 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0005993
	speed: 0.0724s/iter; left time: 2652.2182s
	iters: 200, epoch: 12 | loss: 0.0056475
	speed: 0.0220s/iter; left time: 802.5609s
	iters: 300, epoch: 12 | loss: 0.0003628
	speed: 0.0218s/iter; left time: 793.2129s
	iters: 400, epoch: 12 | loss: 0.0049958
	speed: 0.0217s/iter; left time: 790.5775s
Epoch: 12 cost time: 9.377939701080322
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000086
	speed: 0.0680s/iter; left time: 2463.6629s
	iters: 200, epoch: 13 | loss: 0.0029015
	speed: 0.0198s/iter; left time: 716.2568s
	iters: 300, epoch: 13 | loss: 0.0005594
	speed: 0.0193s/iter; left time: 694.5967s
	iters: 400, epoch: 13 | loss: 0.0115062
	speed: 0.0198s/iter; left time: 710.8317s
Epoch: 13 cost time: 8.520532131195068
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.977262391996362
model parameter : 138254
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0372589
	speed: 0.0361s/iter; left time: 1486.1630s
	iters: 200, epoch: 1 | loss: 0.4835564
	speed: 0.0198s/iter; left time: 812.8326s
	iters: 300, epoch: 1 | loss: 0.1792338
	speed: 0.0198s/iter; left time: 809.8816s
	iters: 400, epoch: 1 | loss: 0.2065273
	speed: 0.0189s/iter; left time: 775.0422s
Epoch: 1 cost time: 9.806215286254883
Epoch: 1, Steps: 413 | Train Loss: 0.771 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (inf --> -0.957707).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0251910
	speed: 0.0640s/iter; left time: 2610.3767s
	iters: 200, epoch: 2 | loss: 0.0839301
	speed: 0.0211s/iter; left time: 856.6166s
	iters: 300, epoch: 2 | loss: 0.0133305
	speed: 0.0203s/iter; left time: 823.1511s
	iters: 400, epoch: 2 | loss: 0.0972867
	speed: 0.0198s/iter; left time: 800.0339s
Epoch: 2 cost time: 8.699549436569214
Epoch: 2, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.096 Vali Acc: 0.967 Test Loss: 0.096 Test Acc: 0.967
Validation loss decreased (-0.957707 --> -0.967257).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0098331
	speed: 0.0615s/iter; left time: 2481.0754s
	iters: 200, epoch: 3 | loss: 0.2102601
	speed: 0.0194s/iter; left time: 781.1950s
	iters: 300, epoch: 3 | loss: 0.2088487
	speed: 0.0202s/iter; left time: 812.1497s
	iters: 400, epoch: 3 | loss: 0.0199932
	speed: 0.0194s/iter; left time: 776.1913s
Epoch: 3 cost time: 8.410042762756348
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.967257 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0013341
	speed: 0.0646s/iter; left time: 2579.9406s
	iters: 200, epoch: 4 | loss: 0.0194872
	speed: 0.0198s/iter; left time: 790.3341s
	iters: 300, epoch: 4 | loss: 0.0077986
	speed: 0.0200s/iter; left time: 794.0113s
	iters: 400, epoch: 4 | loss: 0.0092115
	speed: 0.0212s/iter; left time: 840.6130s
Epoch: 4 cost time: 8.618977308273315
Epoch: 4, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0028423
	speed: 0.0665s/iter; left time: 2628.1075s
	iters: 200, epoch: 5 | loss: 0.0047051
	speed: 0.0200s/iter; left time: 787.1773s
	iters: 300, epoch: 5 | loss: 0.0014063
	speed: 0.0203s/iter; left time: 798.5767s
	iters: 400, epoch: 5 | loss: 0.0518170
	speed: 0.0198s/iter; left time: 775.6630s
Epoch: 5 cost time: 8.65409803390503
Epoch: 5, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.062 Vali Acc: 0.977 Test Loss: 0.062 Test Acc: 0.977
Validation loss decreased (-0.976807 --> -0.977262).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0014598
	speed: 0.0723s/iter; left time: 2828.8815s
	iters: 200, epoch: 6 | loss: 0.0134985
	speed: 0.0185s/iter; left time: 722.8293s
	iters: 300, epoch: 6 | loss: 0.0011268
	speed: 0.0192s/iter; left time: 747.8736s
	iters: 400, epoch: 6 | loss: 0.0035078
	speed: 0.0192s/iter; left time: 747.0439s
Epoch: 6 cost time: 8.379854202270508
Epoch: 6, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0130750
	speed: 0.0668s/iter; left time: 2587.7433s
	iters: 200, epoch: 7 | loss: 0.0304815
	speed: 0.0194s/iter; left time: 749.7512s
	iters: 300, epoch: 7 | loss: 0.0006033
	speed: 0.0193s/iter; left time: 744.3105s
	iters: 400, epoch: 7 | loss: 0.0031230
	speed: 0.0198s/iter; left time: 762.0872s
Epoch: 7 cost time: 8.468869924545288
Epoch: 7, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.977262 --> -0.979536).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0005789
	speed: 0.0712s/iter; left time: 2729.1504s
	iters: 200, epoch: 8 | loss: 0.0010321
	speed: 0.0198s/iter; left time: 754.7876s
	iters: 300, epoch: 8 | loss: 0.0164309
	speed: 0.0200s/iter; left time: 760.3457s
	iters: 400, epoch: 8 | loss: 0.0011957
	speed: 0.0201s/iter; left time: 764.3299s
Epoch: 8 cost time: 8.593669891357422
Epoch: 8, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0004553
	speed: 0.0654s/iter; left time: 2477.5251s
	iters: 200, epoch: 9 | loss: 0.0755608
	speed: 0.0198s/iter; left time: 747.1844s
	iters: 300, epoch: 9 | loss: 0.0022703
	speed: 0.0214s/iter; left time: 807.9744s
	iters: 400, epoch: 9 | loss: 0.0235420
	speed: 0.0200s/iter; left time: 751.7104s
Epoch: 9 cost time: 8.87086009979248
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0035344
	speed: 0.0652s/iter; left time: 2444.7016s
	iters: 200, epoch: 10 | loss: 0.0008667
	speed: 0.0206s/iter; left time: 771.7973s
	iters: 300, epoch: 10 | loss: 0.0046129
	speed: 0.0210s/iter; left time: 784.5881s
	iters: 400, epoch: 10 | loss: 0.0014672
	speed: 0.0206s/iter; left time: 767.2421s
Epoch: 10 cost time: 8.904046058654785
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0039108
	speed: 0.0655s/iter; left time: 2427.3477s
	iters: 200, epoch: 11 | loss: 0.0005529
	speed: 0.0209s/iter; left time: 773.4715s
	iters: 300, epoch: 11 | loss: 0.0004082
	speed: 0.0196s/iter; left time: 722.9643s
	iters: 400, epoch: 11 | loss: 0.0019968
	speed: 0.0209s/iter; left time: 768.2910s
Epoch: 11 cost time: 8.828364133834839
Epoch: 11, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000819
	speed: 0.0648s/iter; left time: 2374.0716s
	iters: 200, epoch: 12 | loss: 0.0003192
	speed: 0.0192s/iter; left time: 703.1379s
	iters: 300, epoch: 12 | loss: 0.0003635
	speed: 0.0197s/iter; left time: 717.6620s
	iters: 400, epoch: 12 | loss: 0.0007792
	speed: 0.0194s/iter; left time: 706.7376s
Epoch: 12 cost time: 8.307268857955933
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.979536 --> -0.982719).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000959
	speed: 0.0682s/iter; left time: 2473.2619s
	iters: 200, epoch: 13 | loss: 0.0099596
	speed: 0.0190s/iter; left time: 685.5332s
	iters: 300, epoch: 13 | loss: 0.0008155
	speed: 0.0198s/iter; left time: 712.1362s
	iters: 400, epoch: 13 | loss: 0.0146201
	speed: 0.0206s/iter; left time: 742.2445s
Epoch: 13 cost time: 8.572196006774902
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0038376
	speed: 0.0709s/iter; left time: 2540.3464s
	iters: 200, epoch: 14 | loss: 0.0008182
	speed: 0.0195s/iter; left time: 695.8718s
	iters: 300, epoch: 14 | loss: 0.0000065
	speed: 0.0188s/iter; left time: 670.2796s
	iters: 400, epoch: 14 | loss: 0.0001149
	speed: 0.0184s/iter; left time: 653.5435s
Epoch: 14 cost time: 8.212545394897461
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000574
	speed: 0.0663s/iter; left time: 2347.0489s
	iters: 200, epoch: 15 | loss: 0.0002118
	speed: 0.0195s/iter; left time: 689.2293s
	iters: 300, epoch: 15 | loss: 0.0007946
	speed: 0.0210s/iter; left time: 738.6468s
	iters: 400, epoch: 15 | loss: 0.0005173
	speed: 0.0202s/iter; left time: 709.7396s
Epoch: 15 cost time: 8.580202341079712
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0001662
	speed: 0.0679s/iter; left time: 2377.0239s
	iters: 200, epoch: 16 | loss: 0.0001389
	speed: 0.0187s/iter; left time: 651.0460s
	iters: 300, epoch: 16 | loss: 0.0000383
	speed: 0.0216s/iter; left time: 753.4464s
	iters: 400, epoch: 16 | loss: 0.0002603
	speed: 0.0210s/iter; left time: 729.0856s
Epoch: 16 cost time: 8.819807529449463
Epoch: 16, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000495
	speed: 0.0679s/iter; left time: 2349.5409s
	iters: 200, epoch: 17 | loss: 0.0000402
	speed: 0.0215s/iter; left time: 740.4152s
	iters: 300, epoch: 17 | loss: 0.0000094
	speed: 0.0221s/iter; left time: 761.6848s
	iters: 400, epoch: 17 | loss: 0.0142845
	speed: 0.0204s/iter; left time: 699.8302s
Epoch: 17 cost time: 9.100271463394165
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000045
	speed: 0.0689s/iter; left time: 2353.5473s
	iters: 200, epoch: 18 | loss: 0.0000274
	speed: 0.0209s/iter; left time: 711.0300s
	iters: 300, epoch: 18 | loss: 0.0115730
	speed: 0.0199s/iter; left time: 675.1850s
	iters: 400, epoch: 18 | loss: 0.0000044
	speed: 0.0198s/iter; left time: 669.8944s
Epoch: 18 cost time: 8.76749062538147
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000094
	speed: 0.0658s/iter; left time: 2223.2375s
	iters: 200, epoch: 19 | loss: 0.0000002
	speed: 0.0200s/iter; left time: 672.8482s
	iters: 300, epoch: 19 | loss: 0.0003304
	speed: 0.0190s/iter; left time: 637.3470s
	iters: 400, epoch: 19 | loss: 0.0002112
	speed: 0.0201s/iter; left time: 672.3418s
Epoch: 19 cost time: 8.416796922683716
Epoch: 19, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000613
	speed: 0.0652s/iter; left time: 2175.8238s
	iters: 200, epoch: 20 | loss: 0.0000354
	speed: 0.0191s/iter; left time: 635.6068s
	iters: 300, epoch: 20 | loss: 0.0000003
	speed: 0.0202s/iter; left time: 669.8578s
	iters: 400, epoch: 20 | loss: 0.0000695
	speed: 0.0198s/iter; left time: 652.9578s
Epoch: 20 cost time: 8.455655813217163
Epoch: 20, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1483973
	speed: 0.0631s/iter; left time: 2077.6763s
	iters: 200, epoch: 21 | loss: 0.0000004
	speed: 0.0201s/iter; left time: 659.8045s
	iters: 300, epoch: 21 | loss: 0.0000006
	speed: 0.0207s/iter; left time: 678.1715s
	iters: 400, epoch: 21 | loss: 0.0016112
	speed: 0.0210s/iter; left time: 686.8605s
Epoch: 21 cost time: 8.839333057403564
Epoch: 21, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000861
	speed: 0.0628s/iter; left time: 2041.9198s
	iters: 200, epoch: 22 | loss: 0.0000351
	speed: 0.0200s/iter; left time: 649.5226s
	iters: 300, epoch: 22 | loss: 0.0119361
	speed: 0.0198s/iter; left time: 641.6854s
	iters: 400, epoch: 22 | loss: 0.0000400
	speed: 0.0209s/iter; left time: 674.1782s
Epoch: 22 cost time: 8.747114658355713
Epoch: 22, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.139 Vali Acc: 0.980 Test Loss: 0.139 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 138254
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6696326
	speed: 0.0399s/iter; left time: 1642.9586s
	iters: 200, epoch: 1 | loss: 0.0864158
	speed: 0.0217s/iter; left time: 891.3865s
	iters: 300, epoch: 1 | loss: 0.0666780
	speed: 0.0227s/iter; left time: 929.0536s
	iters: 400, epoch: 1 | loss: 0.0483032
	speed: 0.0228s/iter; left time: 932.7478s
Epoch: 1 cost time: 11.055568933486938
Epoch: 1, Steps: 413 | Train Loss: 0.562 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
Validation loss decreased (inf --> -0.951340).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7320061
	speed: 0.0670s/iter; left time: 2734.0597s
	iters: 200, epoch: 2 | loss: 0.1412734
	speed: 0.0200s/iter; left time: 813.3212s
	iters: 300, epoch: 2 | loss: 0.0998038
	speed: 0.0209s/iter; left time: 847.0854s
	iters: 400, epoch: 2 | loss: 0.3957660
	speed: 0.0201s/iter; left time: 814.7551s
Epoch: 2 cost time: 8.698228359222412
Epoch: 2, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.093 Vali Acc: 0.966 Test Loss: 0.093 Test Acc: 0.966
Validation loss decreased (-0.951340 --> -0.965893).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0086223
	speed: 0.0743s/iter; left time: 2999.7234s
	iters: 200, epoch: 3 | loss: 0.0727601
	speed: 0.0208s/iter; left time: 837.7495s
	iters: 300, epoch: 3 | loss: 0.0018804
	speed: 0.0203s/iter; left time: 815.4020s
	iters: 400, epoch: 3 | loss: 0.0104099
	speed: 0.0203s/iter; left time: 814.1473s
Epoch: 3 cost time: 8.933226585388184
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
Validation loss decreased (-0.965893 --> -0.968166).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0060778
	speed: 0.0742s/iter; left time: 2965.5870s
	iters: 200, epoch: 4 | loss: 0.0005220
	speed: 0.0196s/iter; left time: 780.1939s
	iters: 300, epoch: 4 | loss: 0.0193362
	speed: 0.0201s/iter; left time: 800.9980s
	iters: 400, epoch: 4 | loss: 0.1121506
	speed: 0.0197s/iter; left time: 779.8628s
Epoch: 4 cost time: 8.554893493652344
Epoch: 4, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.075 Vali Acc: 0.974 Test Loss: 0.075 Test Acc: 0.974
Validation loss decreased (-0.968166 --> -0.973624).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0102878
	speed: 0.0712s/iter; left time: 2815.7973s
	iters: 200, epoch: 5 | loss: 0.0004102
	speed: 0.0196s/iter; left time: 771.9888s
	iters: 300, epoch: 5 | loss: 0.0467874
	speed: 0.0221s/iter; left time: 870.4812s
	iters: 400, epoch: 5 | loss: 0.0021520
	speed: 0.0221s/iter; left time: 865.6076s
Epoch: 5 cost time: 9.139464139938354
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0004030
	speed: 0.0708s/iter; left time: 2770.5271s
	iters: 200, epoch: 6 | loss: 0.1698108
	speed: 0.0212s/iter; left time: 826.6736s
	iters: 300, epoch: 6 | loss: 0.0001088
	speed: 0.0227s/iter; left time: 882.9227s
	iters: 400, epoch: 6 | loss: 0.0024525
	speed: 0.0214s/iter; left time: 829.7319s
Epoch: 6 cost time: 9.278963088989258
Epoch: 6, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0279043
	speed: 0.0685s/iter; left time: 2650.7366s
	iters: 200, epoch: 7 | loss: 0.0007413
	speed: 0.0224s/iter; left time: 863.5534s
	iters: 300, epoch: 7 | loss: 0.0163372
	speed: 0.0220s/iter; left time: 849.2853s
	iters: 400, epoch: 7 | loss: 0.0028701
	speed: 0.0206s/iter; left time: 791.9984s
Epoch: 7 cost time: 9.360910654067993
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
Validation loss decreased (-0.973624 --> -0.979081).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0044693
	speed: 0.0660s/iter; left time: 2530.0728s
	iters: 200, epoch: 8 | loss: 0.0007146
	speed: 0.0212s/iter; left time: 809.8570s
	iters: 300, epoch: 8 | loss: 0.0000225
	speed: 0.0208s/iter; left time: 791.7882s
	iters: 400, epoch: 8 | loss: 0.0012931
	speed: 0.0208s/iter; left time: 790.0768s
Epoch: 8 cost time: 9.027188062667847
Epoch: 8, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.980445).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000557
	speed: 0.0694s/iter; left time: 2630.7080s
	iters: 200, epoch: 9 | loss: 0.0000202
	speed: 0.0193s/iter; left time: 728.6121s
	iters: 300, epoch: 9 | loss: 0.1056683
	speed: 0.0191s/iter; left time: 719.5338s
	iters: 400, epoch: 9 | loss: 0.3312993
	speed: 0.0192s/iter; left time: 723.4881s
Epoch: 9 cost time: 8.336177587509155
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000098
	speed: 0.0708s/iter; left time: 2652.6993s
	iters: 200, epoch: 10 | loss: 0.0073493
	speed: 0.0199s/iter; left time: 745.5601s
	iters: 300, epoch: 10 | loss: 0.0014842
	speed: 0.0197s/iter; left time: 733.5645s
	iters: 400, epoch: 10 | loss: 0.0036490
	speed: 0.0194s/iter; left time: 719.6034s
Epoch: 10 cost time: 8.537313461303711
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.048 Vali Acc: 0.986 Test Loss: 0.048 Test Acc: 0.986
Validation loss decreased (-0.980445 --> -0.985902).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0695087
	speed: 0.0717s/iter; left time: 2658.4203s
	iters: 200, epoch: 11 | loss: 0.0102536
	speed: 0.0213s/iter; left time: 788.6312s
	iters: 300, epoch: 11 | loss: 0.0692382
	speed: 0.0213s/iter; left time: 783.9893s
	iters: 400, epoch: 11 | loss: 0.0001732
	speed: 0.0215s/iter; left time: 791.3412s
Epoch: 11 cost time: 9.334176778793335
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0014296
	speed: 0.0723s/iter; left time: 2651.1093s
	iters: 200, epoch: 12 | loss: 0.0133680
	speed: 0.0199s/iter; left time: 726.8291s
	iters: 300, epoch: 12 | loss: 0.0002726
	speed: 0.0211s/iter; left time: 767.8690s
	iters: 400, epoch: 12 | loss: 0.0000039
	speed: 0.0217s/iter; left time: 788.4455s
Epoch: 12 cost time: 9.140427589416504
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000078
	speed: 0.0727s/iter; left time: 2635.4984s
	iters: 200, epoch: 13 | loss: 0.0003107
	speed: 0.0213s/iter; left time: 768.9513s
	iters: 300, epoch: 13 | loss: 0.0012728
	speed: 0.0212s/iter; left time: 763.0411s
	iters: 400, epoch: 13 | loss: 0.0026713
	speed: 0.0203s/iter; left time: 728.7802s
Epoch: 13 cost time: 9.171194076538086
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000094
	speed: 0.0718s/iter; left time: 2572.6753s
	iters: 200, epoch: 14 | loss: 0.0248637
	speed: 0.0210s/iter; left time: 750.3070s
	iters: 300, epoch: 14 | loss: 0.0203097
	speed: 0.0205s/iter; left time: 732.0652s
	iters: 400, epoch: 14 | loss: 0.0000422
	speed: 0.0193s/iter; left time: 687.4645s
Epoch: 14 cost time: 8.835607051849365
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0010407
	speed: 0.0682s/iter; left time: 2415.9285s
	iters: 200, epoch: 15 | loss: 0.0000733
	speed: 0.0221s/iter; left time: 779.3569s
	iters: 300, epoch: 15 | loss: 0.0032375
	speed: 0.0209s/iter; left time: 734.6813s
	iters: 400, epoch: 15 | loss: 0.0189056
	speed: 0.0206s/iter; left time: 723.3764s
Epoch: 15 cost time: 9.079057931900024
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000059
	speed: 0.0667s/iter; left time: 2333.1654s
	iters: 200, epoch: 16 | loss: 0.0000098
	speed: 0.0201s/iter; left time: 700.4990s
	iters: 300, epoch: 16 | loss: 0.0000273
	speed: 0.0202s/iter; left time: 703.2641s
	iters: 400, epoch: 16 | loss: 0.0000185
	speed: 0.0207s/iter; left time: 717.6404s
Epoch: 16 cost time: 8.870714664459229
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0684s/iter; left time: 2367.4361s
	iters: 200, epoch: 17 | loss: 0.0006619
	speed: 0.0210s/iter; left time: 723.7289s
	iters: 300, epoch: 17 | loss: 0.0920796
	speed: 0.0222s/iter; left time: 765.2058s
	iters: 400, epoch: 17 | loss: 0.0001780
	speed: 0.0212s/iter; left time: 726.9031s
Epoch: 17 cost time: 9.303179740905762
Epoch: 17, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000007
	speed: 0.0655s/iter; left time: 2237.2927s
	iters: 200, epoch: 18 | loss: 0.0000008
	speed: 0.0207s/iter; left time: 704.8637s
	iters: 300, epoch: 18 | loss: 0.0001129
	speed: 0.0206s/iter; left time: 701.5779s
	iters: 400, epoch: 18 | loss: 0.0037039
	speed: 0.0212s/iter; left time: 717.1760s
Epoch: 18 cost time: 9.113541603088379
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0004466
	speed: 0.0674s/iter; left time: 2275.4057s
	iters: 200, epoch: 19 | loss: 0.0000502
	speed: 0.0217s/iter; left time: 731.7262s
	iters: 300, epoch: 19 | loss: 0.0000003
	speed: 0.0224s/iter; left time: 752.9905s
	iters: 400, epoch: 19 | loss: 0.0000010
	speed: 0.0215s/iter; left time: 721.0463s
Epoch: 19 cost time: 9.441985845565796
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0770530
	speed: 0.0749s/iter; left time: 2499.6739s
	iters: 200, epoch: 20 | loss: 0.0000049
	speed: 0.0221s/iter; left time: 733.5837s
	iters: 300, epoch: 20 | loss: 0.0000009
	speed: 0.0212s/iter; left time: 702.0547s
	iters: 400, epoch: 20 | loss: 0.0000468
	speed: 0.0217s/iter; left time: 717.5994s
Epoch: 20 cost time: 9.294753789901733
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.151 Vali Acc: 0.974 Test Loss: 0.151 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 105486
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7466023
	speed: 0.0390s/iter; left time: 1607.9949s
	iters: 200, epoch: 1 | loss: 0.1035125
	speed: 0.0197s/iter; left time: 810.9002s
	iters: 300, epoch: 1 | loss: 0.0609412
	speed: 0.0194s/iter; left time: 794.3143s
	iters: 400, epoch: 1 | loss: 0.0497048
	speed: 0.0201s/iter; left time: 820.2209s
Epoch: 1 cost time: 10.14709186553955
Epoch: 1, Steps: 413 | Train Loss: 0.589 Vali Loss: 0.141 Vali Acc: 0.955 Test Loss: 0.141 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7254236
	speed: 0.0776s/iter; left time: 3166.5853s
	iters: 200, epoch: 2 | loss: 0.1452246
	speed: 0.0208s/iter; left time: 846.8889s
	iters: 300, epoch: 2 | loss: 0.0931709
	speed: 0.0209s/iter; left time: 848.1934s
	iters: 400, epoch: 2 | loss: 0.4281816
	speed: 0.0212s/iter; left time: 859.2881s
Epoch: 2 cost time: 9.028974771499634
Epoch: 2, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
Validation loss decreased (-0.954978 --> -0.964528).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0100471
	speed: 0.0707s/iter; left time: 2853.5244s
	iters: 200, epoch: 3 | loss: 0.1045760
	speed: 0.0203s/iter; left time: 818.0873s
	iters: 300, epoch: 3 | loss: 0.0053501
	speed: 0.0222s/iter; left time: 891.6346s
	iters: 400, epoch: 3 | loss: 0.0103908
	speed: 0.0222s/iter; left time: 890.7948s
Epoch: 3 cost time: 9.16966438293457
Epoch: 3, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.075 Vali Acc: 0.975 Test Loss: 0.075 Test Acc: 0.975
Validation loss decreased (-0.964528 --> -0.974533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0034367
	speed: 0.0697s/iter; left time: 2784.1158s
	iters: 200, epoch: 4 | loss: 0.0031038
	speed: 0.0203s/iter; left time: 809.8669s
	iters: 300, epoch: 4 | loss: 0.0650693
	speed: 0.0203s/iter; left time: 808.3903s
	iters: 400, epoch: 4 | loss: 0.1359245
	speed: 0.0213s/iter; left time: 843.8646s
Epoch: 4 cost time: 9.02401614189148
Epoch: 4, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0096135
	speed: 0.0675s/iter; left time: 2669.9621s
	iters: 200, epoch: 5 | loss: 0.0011942
	speed: 0.0205s/iter; left time: 810.2605s
	iters: 300, epoch: 5 | loss: 0.0270906
	speed: 0.0206s/iter; left time: 812.4740s
	iters: 400, epoch: 5 | loss: 0.0015874
	speed: 0.0212s/iter; left time: 833.4266s
Epoch: 5 cost time: 8.978172302246094
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.061 Vali Acc: 0.979 Test Loss: 0.061 Test Acc: 0.979
Validation loss decreased (-0.974533 --> -0.978626).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0025700
	speed: 0.0693s/iter; left time: 2711.4306s
	iters: 200, epoch: 6 | loss: 0.0015648
	speed: 0.0205s/iter; left time: 802.0951s
	iters: 300, epoch: 6 | loss: 0.0009699
	speed: 0.0203s/iter; left time: 791.2604s
	iters: 400, epoch: 6 | loss: 0.0133950
	speed: 0.0206s/iter; left time: 798.3987s
Epoch: 6 cost time: 8.75590968132019
Epoch: 6, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0052867
	speed: 0.0642s/iter; left time: 2485.6785s
	iters: 200, epoch: 7 | loss: 0.0001966
	speed: 0.0199s/iter; left time: 769.7864s
	iters: 300, epoch: 7 | loss: 0.0003865
	speed: 0.0208s/iter; left time: 802.1139s
	iters: 400, epoch: 7 | loss: 0.0001574
	speed: 0.0213s/iter; left time: 817.1883s
Epoch: 7 cost time: 8.765434503555298
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0028072
	speed: 0.0726s/iter; left time: 2781.6855s
	iters: 200, epoch: 8 | loss: 0.0000438
	speed: 0.0177s/iter; left time: 677.7540s
	iters: 300, epoch: 8 | loss: 0.0000471
	speed: 0.0194s/iter; left time: 740.2199s
	iters: 400, epoch: 8 | loss: 0.0654138
	speed: 0.0206s/iter; left time: 782.3127s
Epoch: 8 cost time: 8.500277996063232
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0006234
	speed: 0.0681s/iter; left time: 2580.5555s
	iters: 200, epoch: 9 | loss: 0.0030640
	speed: 0.0204s/iter; left time: 770.2165s
	iters: 300, epoch: 9 | loss: 0.0011570
	speed: 0.0188s/iter; left time: 709.5097s
	iters: 400, epoch: 9 | loss: 0.0103781
	speed: 0.0192s/iter; left time: 720.4872s
Epoch: 9 cost time: 8.466554403305054
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000063
	speed: 0.0608s/iter; left time: 2279.2819s
	iters: 200, epoch: 10 | loss: 0.0002762
	speed: 0.0186s/iter; left time: 694.8134s
	iters: 300, epoch: 10 | loss: 0.0038624
	speed: 0.0171s/iter; left time: 637.3520s
	iters: 400, epoch: 10 | loss: 0.0054939
	speed: 0.0200s/iter; left time: 744.3096s
Epoch: 10 cost time: 8.159461975097656
Epoch: 10, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0012510
	speed: 0.0681s/iter; left time: 2525.3369s
	iters: 200, epoch: 11 | loss: 0.0042691
	speed: 0.0210s/iter; left time: 775.5278s
	iters: 300, epoch: 11 | loss: 0.0005260
	speed: 0.0216s/iter; left time: 795.9495s
	iters: 400, epoch: 11 | loss: 0.0021036
	speed: 0.0216s/iter; left time: 795.8416s
Epoch: 11 cost time: 9.305733919143677
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000020
	speed: 0.0707s/iter; left time: 2592.8478s
	iters: 200, epoch: 12 | loss: 0.0002249
	speed: 0.0200s/iter; left time: 731.5030s
	iters: 300, epoch: 12 | loss: 0.0006308
	speed: 0.0213s/iter; left time: 775.5656s
	iters: 400, epoch: 12 | loss: 0.0034447
	speed: 0.0215s/iter; left time: 783.3745s
Epoch: 12 cost time: 9.029120683670044
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000011
	speed: 0.0689s/iter; left time: 2497.6987s
	iters: 200, epoch: 13 | loss: 0.0003426
	speed: 0.0210s/iter; left time: 759.0950s
	iters: 300, epoch: 13 | loss: 0.0000175
	speed: 0.0211s/iter; left time: 761.9784s
	iters: 400, epoch: 13 | loss: 0.0000272
	speed: 0.0207s/iter; left time: 743.7194s
Epoch: 13 cost time: 9.217323303222656
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.978626 --> -0.979535).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000124
	speed: 0.0642s/iter; left time: 2301.2402s
	iters: 200, epoch: 14 | loss: 0.2188772
	speed: 0.0209s/iter; left time: 747.1021s
	iters: 300, epoch: 14 | loss: 0.0000008
	speed: 0.0200s/iter; left time: 713.1847s
	iters: 400, epoch: 14 | loss: 0.0000362
	speed: 0.0212s/iter; left time: 754.6490s
Epoch: 14 cost time: 8.955660581588745
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000095
	speed: 0.0687s/iter; left time: 2433.0851s
	iters: 200, epoch: 15 | loss: 0.0019185
	speed: 0.0210s/iter; left time: 742.1185s
	iters: 300, epoch: 15 | loss: 0.0000017
	speed: 0.0205s/iter; left time: 722.2897s
	iters: 400, epoch: 15 | loss: 0.0000114
	speed: 0.0199s/iter; left time: 699.5610s
Epoch: 15 cost time: 8.746833086013794
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.164 Vali Acc: 0.966 Test Loss: 0.164 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000286
	speed: 0.0658s/iter; left time: 2302.9724s
	iters: 200, epoch: 16 | loss: 0.0007930
	speed: 0.0198s/iter; left time: 689.3950s
	iters: 300, epoch: 16 | loss: 0.0000419
	speed: 0.0196s/iter; left time: 683.9297s
	iters: 400, epoch: 16 | loss: 0.0018265
	speed: 0.0195s/iter; left time: 678.2607s
Epoch: 16 cost time: 8.497224569320679
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0082251
	speed: 0.0668s/iter; left time: 2309.4371s
	iters: 200, epoch: 17 | loss: 0.0000250
	speed: 0.0197s/iter; left time: 679.2204s
	iters: 300, epoch: 17 | loss: 0.0000014
	speed: 0.0213s/iter; left time: 733.1178s
	iters: 400, epoch: 17 | loss: 0.0000035
	speed: 0.0205s/iter; left time: 704.2812s
Epoch: 17 cost time: 8.830329418182373
Epoch: 17, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.979 Test Loss: 0.134 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0706s/iter; left time: 2414.1459s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 732.9209s
	iters: 300, epoch: 18 | loss: 0.0019138
	speed: 0.0208s/iter; left time: 706.0003s
	iters: 400, epoch: 18 | loss: 0.0005736
	speed: 0.0209s/iter; left time: 708.5662s
Epoch: 18 cost time: 9.060583353042603
Epoch: 18, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.979535 --> -0.983173).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0237439
	speed: 0.0714s/iter; left time: 2411.0480s
	iters: 200, epoch: 19 | loss: 0.0000683
	speed: 0.0204s/iter; left time: 688.1474s
	iters: 300, epoch: 19 | loss: 0.0000730
	speed: 0.0189s/iter; left time: 635.7614s
	iters: 400, epoch: 19 | loss: 0.0014439
	speed: 0.0213s/iter; left time: 714.0419s
Epoch: 19 cost time: 8.863141536712646
Epoch: 19, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0016722
	speed: 0.0713s/iter; left time: 2376.8778s
	iters: 200, epoch: 20 | loss: 0.0003995
	speed: 0.0207s/iter; left time: 688.8509s
	iters: 300, epoch: 20 | loss: 0.0000021
	speed: 0.0209s/iter; left time: 693.9599s
	iters: 400, epoch: 20 | loss: 0.0216019
	speed: 0.0207s/iter; left time: 682.8989s
Epoch: 20 cost time: 8.836059331893921
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0001734
	speed: 0.0719s/iter; left time: 2368.0990s
	iters: 200, epoch: 21 | loss: 0.0001763
	speed: 0.0200s/iter; left time: 656.6091s
	iters: 300, epoch: 21 | loss: 0.0000822
	speed: 0.0203s/iter; left time: 665.8130s
	iters: 400, epoch: 21 | loss: 0.0000324
	speed: 0.0206s/iter; left time: 673.5670s
Epoch: 21 cost time: 8.82535171508789
Epoch: 21, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000123
	speed: 0.0698s/iter; left time: 2271.6396s
	iters: 200, epoch: 22 | loss: 0.0000596
	speed: 0.0193s/iter; left time: 626.1589s
	iters: 300, epoch: 22 | loss: 0.0040879
	speed: 0.0209s/iter; left time: 676.6098s
	iters: 400, epoch: 22 | loss: 0.0083464
	speed: 0.0210s/iter; left time: 676.4975s
Epoch: 22 cost time: 8.760431289672852
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0150942
	speed: 0.0686s/iter; left time: 2203.2684s
	iters: 200, epoch: 23 | loss: 0.0000134
	speed: 0.0207s/iter; left time: 662.7281s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 673.6373s
	iters: 400, epoch: 23 | loss: 0.0000003
	speed: 0.0213s/iter; left time: 677.0464s
Epoch: 23 cost time: 8.937014102935791
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0678s/iter; left time: 2148.3152s
	iters: 200, epoch: 24 | loss: 0.0000375
	speed: 0.0210s/iter; left time: 663.3490s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 682.0228s
	iters: 400, epoch: 24 | loss: 0.0000033
	speed: 0.0197s/iter; left time: 617.1412s
Epoch: 24 cost time: 9.05543828010559
Epoch: 24, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.978 Test Loss: 0.158 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000716
	speed: 0.0684s/iter; left time: 2139.7622s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 653.7437s
	iters: 300, epoch: 25 | loss: 0.0003980
	speed: 0.0218s/iter; left time: 677.9734s
	iters: 400, epoch: 25 | loss: 0.0000531
	speed: 0.0211s/iter; left time: 654.8043s
Epoch: 25 cost time: 9.13918924331665
Epoch: 25, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.979 Test Loss: 0.141 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000516
	speed: 0.0672s/iter; left time: 2074.9442s
	iters: 200, epoch: 26 | loss: 0.0000020
	speed: 0.0213s/iter; left time: 654.3625s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.0215s/iter; left time: 658.3458s
	iters: 400, epoch: 26 | loss: 0.0000094
	speed: 0.0213s/iter; left time: 651.4842s
Epoch: 26 cost time: 9.204166412353516
Epoch: 26, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0001046
	speed: 0.0679s/iter; left time: 2068.6203s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0189s/iter; left time: 574.2630s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0191s/iter; left time: 577.2272s
	iters: 400, epoch: 27 | loss: 0.0000579
	speed: 0.0200s/iter; left time: 603.9864s
Epoch: 27 cost time: 8.369502067565918
Epoch: 27, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.0715s/iter; left time: 2147.8301s
	iters: 200, epoch: 28 | loss: 0.0000136
	speed: 0.0200s/iter; left time: 598.5956s
	iters: 300, epoch: 28 | loss: 0.0000008
	speed: 0.0194s/iter; left time: 578.7863s
	iters: 400, epoch: 28 | loss: 0.0000015
	speed: 0.0192s/iter; left time: 572.2232s
Epoch: 28 cost time: 8.580740213394165
Epoch: 28, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 105486
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8402869
	speed: 0.0383s/iter; left time: 1577.6006s
	iters: 200, epoch: 1 | loss: 0.1686359
	speed: 0.0201s/iter; left time: 824.1042s
	iters: 300, epoch: 1 | loss: 0.0706403
	speed: 0.0215s/iter; left time: 882.3433s
	iters: 400, epoch: 1 | loss: 0.0690987
	speed: 0.0214s/iter; left time: 875.6617s
Epoch: 1 cost time: 10.464080572128296
Epoch: 1, Steps: 413 | Train Loss: 0.643 Vali Loss: 0.145 Vali Acc: 0.955 Test Loss: 0.145 Test Acc: 0.955
Validation loss decreased (inf --> -0.955433).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6033618
	speed: 0.0660s/iter; left time: 2691.9653s
	iters: 200, epoch: 2 | loss: 0.1282676
	speed: 0.0194s/iter; left time: 787.4346s
	iters: 300, epoch: 2 | loss: 0.0872753
	speed: 0.0199s/iter; left time: 808.3136s
	iters: 400, epoch: 2 | loss: 0.5097288
	speed: 0.0196s/iter; left time: 792.0306s
Epoch: 2 cost time: 8.430037021636963
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.087 Vali Acc: 0.971 Test Loss: 0.087 Test Acc: 0.971
Validation loss decreased (-0.955433 --> -0.971350).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0122521
	speed: 0.0646s/iter; left time: 2608.2601s
	iters: 200, epoch: 3 | loss: 0.0618957
	speed: 0.0198s/iter; left time: 795.6730s
	iters: 300, epoch: 3 | loss: 0.0088873
	speed: 0.0199s/iter; left time: 800.7462s
	iters: 400, epoch: 3 | loss: 0.0087539
	speed: 0.0206s/iter; left time: 825.7661s
Epoch: 3 cost time: 8.741454601287842
Epoch: 3, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0021584
	speed: 0.0635s/iter; left time: 2539.1616s
	iters: 200, epoch: 4 | loss: 0.0008040
	speed: 0.0206s/iter; left time: 821.4725s
	iters: 300, epoch: 4 | loss: 0.0225045
	speed: 0.0185s/iter; left time: 737.2616s
	iters: 400, epoch: 4 | loss: 0.0743363
	speed: 0.0199s/iter; left time: 789.3263s
Epoch: 4 cost time: 8.624388456344604
Epoch: 4, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.075 Vali Acc: 0.971 Test Loss: 0.075 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0055816
	speed: 0.0644s/iter; left time: 2546.3268s
	iters: 200, epoch: 5 | loss: 0.0006308
	speed: 0.0196s/iter; left time: 773.2975s
	iters: 300, epoch: 5 | loss: 0.0124058
	speed: 0.0198s/iter; left time: 780.4808s
	iters: 400, epoch: 5 | loss: 0.0020088
	speed: 0.0188s/iter; left time: 737.0127s
Epoch: 5 cost time: 8.300174236297607
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.971350 --> -0.972714).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0003161
	speed: 0.0654s/iter; left time: 2558.1166s
	iters: 200, epoch: 6 | loss: 0.0005029
	speed: 0.0199s/iter; left time: 776.6562s
	iters: 300, epoch: 6 | loss: 0.0001325
	speed: 0.0198s/iter; left time: 770.9735s
	iters: 400, epoch: 6 | loss: 0.0551401
	speed: 0.0196s/iter; left time: 759.9229s
Epoch: 6 cost time: 8.479781866073608
Epoch: 6, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
Validation loss decreased (-0.972714 --> -0.975897).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0124864
	speed: 0.0637s/iter; left time: 2467.2688s
	iters: 200, epoch: 7 | loss: 0.0065872
	speed: 0.0200s/iter; left time: 772.0930s
	iters: 300, epoch: 7 | loss: 0.0008835
	speed: 0.0207s/iter; left time: 798.5211s
	iters: 400, epoch: 7 | loss: 0.0049350
	speed: 0.0201s/iter; left time: 773.6943s
Epoch: 7 cost time: 8.585319757461548
Epoch: 7, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0137008
	speed: 0.0682s/iter; left time: 2613.5308s
	iters: 200, epoch: 8 | loss: 0.0018555
	speed: 0.0195s/iter; left time: 746.9799s
	iters: 300, epoch: 8 | loss: 0.0000813
	speed: 0.0198s/iter; left time: 755.4013s
	iters: 400, epoch: 8 | loss: 0.0024050
	speed: 0.0211s/iter; left time: 801.8454s
Epoch: 8 cost time: 8.587809801101685
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.975897 --> -0.979990).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0009520
	speed: 0.0702s/iter; left time: 2659.1102s
	iters: 200, epoch: 9 | loss: 0.0002343
	speed: 0.0217s/iter; left time: 819.4814s
	iters: 300, epoch: 9 | loss: 0.1380169
	speed: 0.0210s/iter; left time: 791.6844s
	iters: 400, epoch: 9 | loss: 0.0036843
	speed: 0.0195s/iter; left time: 734.9122s
Epoch: 9 cost time: 8.918210506439209
Epoch: 9, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000830
	speed: 0.0689s/iter; left time: 2583.5247s
	iters: 200, epoch: 10 | loss: 0.0015998
	speed: 0.0203s/iter; left time: 757.4875s
	iters: 300, epoch: 10 | loss: 0.0749564
	speed: 0.0205s/iter; left time: 765.0953s
	iters: 400, epoch: 10 | loss: 0.0041080
	speed: 0.0206s/iter; left time: 764.8876s
Epoch: 10 cost time: 8.73897910118103
Epoch: 10, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0004769
	speed: 0.0704s/iter; left time: 2610.3379s
	iters: 200, epoch: 11 | loss: 0.0149556
	speed: 0.0195s/iter; left time: 719.9780s
	iters: 300, epoch: 11 | loss: 0.0004040
	speed: 0.0190s/iter; left time: 701.4489s
	iters: 400, epoch: 11 | loss: 0.0018539
	speed: 0.0191s/iter; left time: 704.1168s
Epoch: 11 cost time: 8.371758460998535
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000148
	speed: 0.0724s/iter; left time: 2654.6362s
	iters: 200, epoch: 12 | loss: 0.0009151
	speed: 0.0195s/iter; left time: 713.0017s
	iters: 300, epoch: 12 | loss: 0.0000033
	speed: 0.0198s/iter; left time: 722.4747s
	iters: 400, epoch: 12 | loss: 0.0000182
	speed: 0.0211s/iter; left time: 768.2727s
Epoch: 12 cost time: 8.506991624832153
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0001243
	speed: 0.0685s/iter; left time: 2483.1307s
	iters: 200, epoch: 13 | loss: 0.0001198
	speed: 0.0191s/iter; left time: 690.2435s
	iters: 300, epoch: 13 | loss: 0.0000027
	speed: 0.0194s/iter; left time: 699.3903s
	iters: 400, epoch: 13 | loss: 0.0001995
	speed: 0.0206s/iter; left time: 742.0995s
Epoch: 13 cost time: 8.5476713180542
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.152 Vali Acc: 0.974 Test Loss: 0.152 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0029860
	speed: 0.0677s/iter; left time: 2426.9366s
	iters: 200, epoch: 14 | loss: 0.0003660
	speed: 0.0197s/iter; left time: 704.2467s
	iters: 300, epoch: 14 | loss: 0.0000255
	speed: 0.0206s/iter; left time: 735.0125s
	iters: 400, epoch: 14 | loss: 0.0000543
	speed: 0.0203s/iter; left time: 720.6729s
Epoch: 14 cost time: 8.719360113143921
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000857
	speed: 0.0641s/iter; left time: 2268.8628s
	iters: 200, epoch: 15 | loss: 0.0001154
	speed: 0.0194s/iter; left time: 686.7141s
	iters: 300, epoch: 15 | loss: 0.0009848
	speed: 0.0194s/iter; left time: 683.2672s
	iters: 400, epoch: 15 | loss: 0.0004268
	speed: 0.0202s/iter; left time: 708.6470s
Epoch: 15 cost time: 8.540875434875488
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1712902
	speed: 0.0655s/iter; left time: 2291.9826s
	iters: 200, epoch: 16 | loss: 0.0000019
	speed: 0.0199s/iter; left time: 694.1663s
	iters: 300, epoch: 16 | loss: 0.0000149
	speed: 0.0194s/iter; left time: 673.5165s
	iters: 400, epoch: 16 | loss: 0.0089593
	speed: 0.0194s/iter; left time: 672.0347s
Epoch: 16 cost time: 8.62040638923645
Epoch: 16, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
Validation loss decreased (-0.979990 --> -0.983628).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.0667s/iter; left time: 2306.5002s
	iters: 200, epoch: 17 | loss: 0.0000032
	speed: 0.0212s/iter; left time: 732.3924s
	iters: 300, epoch: 17 | loss: 0.0405410
	speed: 0.0211s/iter; left time: 725.1079s
	iters: 400, epoch: 17 | loss: 0.0004775
	speed: 0.0197s/iter; left time: 674.9237s
Epoch: 17 cost time: 8.933530807495117
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.067 Vali Acc: 0.986 Test Loss: 0.067 Test Acc: 0.986
Validation loss decreased (-0.983628 --> -0.986357).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000019
	speed: 0.0713s/iter; left time: 2436.8301s
	iters: 200, epoch: 18 | loss: 0.0000014
	speed: 0.0181s/iter; left time: 616.9726s
	iters: 300, epoch: 18 | loss: 0.0000285
	speed: 0.0190s/iter; left time: 645.0615s
	iters: 400, epoch: 18 | loss: 0.0041458
	speed: 0.0185s/iter; left time: 628.3555s
Epoch: 18 cost time: 8.148401260375977
Epoch: 18, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0005398
	speed: 0.0712s/iter; left time: 2405.4841s
	iters: 200, epoch: 19 | loss: 0.0000035
	speed: 0.0184s/iter; left time: 620.0469s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0179s/iter; left time: 601.0803s
	iters: 400, epoch: 19 | loss: 0.0002153
	speed: 0.0193s/iter; left time: 646.4101s
Epoch: 19 cost time: 8.102088212966919
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0001697
	speed: 0.0709s/iter; left time: 2365.1699s
	iters: 200, epoch: 20 | loss: 0.0000047
	speed: 0.0182s/iter; left time: 605.3614s
	iters: 300, epoch: 20 | loss: 0.0000017
	speed: 0.0212s/iter; left time: 701.6987s
	iters: 400, epoch: 20 | loss: 0.0001399
	speed: 0.0192s/iter; left time: 635.2721s
Epoch: 20 cost time: 8.490167617797852
Epoch: 20, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000158
	speed: 0.0680s/iter; left time: 2241.2912s
	iters: 200, epoch: 21 | loss: 0.0000027
	speed: 0.0227s/iter; left time: 744.4010s
	iters: 300, epoch: 21 | loss: 0.2202844
	speed: 0.0217s/iter; left time: 709.9208s
	iters: 400, epoch: 21 | loss: 0.0007321
	speed: 0.0197s/iter; left time: 642.3396s
Epoch: 21 cost time: 9.08144211769104
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000609
	speed: 0.0669s/iter; left time: 2177.3835s
	iters: 200, epoch: 22 | loss: 0.0000224
	speed: 0.0195s/iter; left time: 631.5281s
	iters: 300, epoch: 22 | loss: 0.0000039
	speed: 0.0206s/iter; left time: 666.9208s
	iters: 400, epoch: 22 | loss: 0.0000005
	speed: 0.0205s/iter; left time: 662.0483s
Epoch: 22 cost time: 8.82831072807312
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0001093
	speed: 0.0672s/iter; left time: 2156.5980s
	iters: 200, epoch: 23 | loss: 0.0000111
	speed: 0.0203s/iter; left time: 648.5222s
	iters: 300, epoch: 23 | loss: 0.0000011
	speed: 0.0198s/iter; left time: 630.4561s
	iters: 400, epoch: 23 | loss: 0.0000868
	speed: 0.0206s/iter; left time: 655.3812s
Epoch: 23 cost time: 8.805827856063843
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000001
	speed: 0.0645s/iter; left time: 2044.0744s
	iters: 200, epoch: 24 | loss: 0.0000029
	speed: 0.0184s/iter; left time: 581.8998s
	iters: 300, epoch: 24 | loss: 0.0000002
	speed: 0.0195s/iter; left time: 613.1038s
	iters: 400, epoch: 24 | loss: 0.0000009
	speed: 0.0197s/iter; left time: 619.9574s
Epoch: 24 cost time: 8.31952977180481
Epoch: 24, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.148 Vali Acc: 0.978 Test Loss: 0.148 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 2052.3374s
	iters: 200, epoch: 25 | loss: 0.0000003
	speed: 0.0199s/iter; left time: 619.1667s
	iters: 300, epoch: 25 | loss: 0.0000022
	speed: 0.0190s/iter; left time: 591.2205s
	iters: 400, epoch: 25 | loss: 0.0000011
	speed: 0.0196s/iter; left time: 605.9600s
Epoch: 25 cost time: 8.427591562271118
Epoch: 25, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000220
	speed: 0.0681s/iter; left time: 2102.0278s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0192s/iter; left time: 591.1618s
	iters: 300, epoch: 26 | loss: 0.0000004
	speed: 0.0201s/iter; left time: 615.4671s
	iters: 400, epoch: 26 | loss: 0.0000536
	speed: 0.0193s/iter; left time: 590.9910s
Epoch: 26 cost time: 8.393793106079102
Epoch: 26, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.983 Test Loss: 0.123 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000002
	speed: 0.0721s/iter; left time: 2197.0527s
	iters: 200, epoch: 27 | loss: 0.0000005
	speed: 0.0200s/iter; left time: 608.6433s
	iters: 300, epoch: 27 | loss: 0.0000003
	speed: 0.0210s/iter; left time: 634.9110s
	iters: 400, epoch: 27 | loss: 0.0000017
	speed: 0.0208s/iter; left time: 628.3862s
Epoch: 27 cost time: 8.853853464126587
Epoch: 27, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.145 Vali Acc: 0.981 Test Loss: 0.145 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 105486
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2031354
	speed: 0.0361s/iter; left time: 1488.2646s
	iters: 200, epoch: 1 | loss: 0.2681862
	speed: 0.0197s/iter; left time: 808.9733s
	iters: 300, epoch: 1 | loss: 0.1155991
	speed: 0.0206s/iter; left time: 843.5215s
	iters: 400, epoch: 1 | loss: 0.1250067
	speed: 0.0199s/iter; left time: 814.2478s
Epoch: 1 cost time: 9.942889213562012
Epoch: 1, Steps: 413 | Train Loss: 0.773 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (inf --> -0.958161).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5699502
	speed: 0.0664s/iter; left time: 2708.6875s
	iters: 200, epoch: 2 | loss: 0.1386013
	speed: 0.0201s/iter; left time: 818.5659s
	iters: 300, epoch: 2 | loss: 0.1329893
	speed: 0.0200s/iter; left time: 812.1992s
	iters: 400, epoch: 2 | loss: 0.4805998
	speed: 0.0200s/iter; left time: 808.2057s
Epoch: 2 cost time: 8.629037380218506
Epoch: 2, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.091 Vali Acc: 0.969 Test Loss: 0.091 Test Acc: 0.969
Validation loss decreased (-0.958161 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0073405
	speed: 0.0637s/iter; left time: 2569.9201s
	iters: 200, epoch: 3 | loss: 0.0537072
	speed: 0.0185s/iter; left time: 746.6684s
	iters: 300, epoch: 3 | loss: 0.0512396
	speed: 0.0191s/iter; left time: 765.3617s
	iters: 400, epoch: 3 | loss: 0.0045796
	speed: 0.0175s/iter; left time: 700.0721s
Epoch: 3 cost time: 7.872790336608887
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (-0.968621 --> -0.970440).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0013127
	speed: 0.0634s/iter; left time: 2531.7658s
	iters: 200, epoch: 4 | loss: 0.0060153
	speed: 0.0184s/iter; left time: 732.6803s
	iters: 300, epoch: 4 | loss: 0.0202196
	speed: 0.0187s/iter; left time: 743.6716s
	iters: 400, epoch: 4 | loss: 0.2561813
	speed: 0.0199s/iter; left time: 788.7435s
Epoch: 4 cost time: 8.17996859550476
Epoch: 4, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (-0.970440 --> -0.972714).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0023315
	speed: 0.0638s/iter; left time: 2522.0069s
	iters: 200, epoch: 5 | loss: 0.0001298
	speed: 0.0183s/iter; left time: 723.4481s
	iters: 300, epoch: 5 | loss: 0.0254566
	speed: 0.0187s/iter; left time: 736.5091s
	iters: 400, epoch: 5 | loss: 0.0055748
	speed: 0.0183s/iter; left time: 719.1906s
Epoch: 5 cost time: 7.9427149295806885
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
Validation loss decreased (-0.972714 --> -0.975443).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0055787
	speed: 0.0580s/iter; left time: 2269.1424s
	iters: 200, epoch: 6 | loss: 0.0017527
	speed: 0.0195s/iter; left time: 762.4277s
	iters: 300, epoch: 6 | loss: 0.0014391
	speed: 0.0192s/iter; left time: 746.6912s
	iters: 400, epoch: 6 | loss: 0.0074416
	speed: 0.0194s/iter; left time: 753.3760s
Epoch: 6 cost time: 8.240790128707886
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.975443 --> -0.977262).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0035074
	speed: 0.0610s/iter; left time: 2362.4851s
	iters: 200, epoch: 7 | loss: 0.0024890
	speed: 0.0197s/iter; left time: 760.6176s
	iters: 300, epoch: 7 | loss: 0.0024546
	speed: 0.0197s/iter; left time: 760.0724s
	iters: 400, epoch: 7 | loss: 0.0010889
	speed: 0.0203s/iter; left time: 779.4589s
Epoch: 7 cost time: 8.488230466842651
Epoch: 7, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.045 Vali Acc: 0.983 Test Loss: 0.045 Test Acc: 0.983
Validation loss decreased (-0.977262 --> -0.983174).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0002760
	speed: 0.0616s/iter; left time: 2359.1822s
	iters: 200, epoch: 8 | loss: 0.0024731
	speed: 0.0199s/iter; left time: 760.2214s
	iters: 300, epoch: 8 | loss: 0.0022383
	speed: 0.0199s/iter; left time: 757.5690s
	iters: 400, epoch: 8 | loss: 0.0024105
	speed: 0.0198s/iter; left time: 753.7283s
Epoch: 8 cost time: 8.57324481010437
Epoch: 8, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0044927
	speed: 0.0638s/iter; left time: 2416.7438s
	iters: 200, epoch: 9 | loss: 0.0959546
	speed: 0.0200s/iter; left time: 756.3176s
	iters: 300, epoch: 9 | loss: 0.0048275
	speed: 0.0203s/iter; left time: 764.4873s
	iters: 400, epoch: 9 | loss: 0.0620978
	speed: 0.0205s/iter; left time: 769.3766s
Epoch: 9 cost time: 8.605679988861084
Epoch: 9, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0003086
	speed: 0.0639s/iter; left time: 2395.4402s
	iters: 200, epoch: 10 | loss: 0.0048546
	speed: 0.0175s/iter; left time: 654.3577s
	iters: 300, epoch: 10 | loss: 0.0013302
	speed: 0.0181s/iter; left time: 675.4946s
	iters: 400, epoch: 10 | loss: 0.0002302
	speed: 0.0204s/iter; left time: 759.5580s
Epoch: 10 cost time: 8.009804725646973
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0004799
	speed: 0.0695s/iter; left time: 2577.7725s
	iters: 200, epoch: 11 | loss: 0.0154258
	speed: 0.0189s/iter; left time: 697.3625s
	iters: 300, epoch: 11 | loss: 0.0020953
	speed: 0.0200s/iter; left time: 736.9232s
	iters: 400, epoch: 11 | loss: 0.0022380
	speed: 0.0187s/iter; left time: 687.3088s
Epoch: 11 cost time: 8.309359073638916
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.152 Vali Acc: 0.961 Test Loss: 0.152 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0002039
	speed: 0.0692s/iter; left time: 2535.3136s
	iters: 200, epoch: 12 | loss: 0.0000569
	speed: 0.0190s/iter; left time: 694.6820s
	iters: 300, epoch: 12 | loss: 0.1351349
	speed: 0.0190s/iter; left time: 693.5579s
	iters: 400, epoch: 12 | loss: 0.0000138
	speed: 0.0184s/iter; left time: 670.4381s
Epoch: 12 cost time: 8.080676078796387
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000267
	speed: 0.0671s/iter; left time: 2430.2847s
	iters: 200, epoch: 13 | loss: 0.0001535
	speed: 0.0200s/iter; left time: 723.6675s
	iters: 300, epoch: 13 | loss: 0.0000008
	speed: 0.0205s/iter; left time: 738.2810s
	iters: 400, epoch: 13 | loss: 0.0000008
	speed: 0.0198s/iter; left time: 710.2964s
Epoch: 13 cost time: 8.510587215423584
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0003771
	speed: 0.0646s/iter; left time: 2315.5424s
	iters: 200, epoch: 14 | loss: 0.0000521
	speed: 0.0206s/iter; left time: 736.1148s
	iters: 300, epoch: 14 | loss: 0.0000148
	speed: 0.0207s/iter; left time: 738.3188s
	iters: 400, epoch: 14 | loss: 0.0032003
	speed: 0.0215s/iter; left time: 764.6241s
Epoch: 14 cost time: 9.008158922195435
Epoch: 14, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000086
	speed: 0.0664s/iter; left time: 2352.5319s
	iters: 200, epoch: 15 | loss: 0.0000074
	speed: 0.0216s/iter; left time: 763.0151s
	iters: 300, epoch: 15 | loss: 0.0000984
	speed: 0.0206s/iter; left time: 727.0461s
	iters: 400, epoch: 15 | loss: 0.0000896
	speed: 0.0199s/iter; left time: 697.7059s
Epoch: 15 cost time: 8.983723640441895
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0003344
	speed: 0.0630s/iter; left time: 2205.1026s
	iters: 200, epoch: 16 | loss: 0.0000094
	speed: 0.0205s/iter; left time: 714.8073s
	iters: 300, epoch: 16 | loss: 0.0002802
	speed: 0.0206s/iter; left time: 716.2419s
	iters: 400, epoch: 16 | loss: 0.0013517
	speed: 0.0201s/iter; left time: 696.2115s
Epoch: 16 cost time: 8.847269535064697
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000226
	speed: 0.0626s/iter; left time: 2165.9880s
	iters: 200, epoch: 17 | loss: 0.0000818
	speed: 0.0208s/iter; left time: 717.6767s
	iters: 300, epoch: 17 | loss: 0.0012931
	speed: 0.0201s/iter; left time: 689.9228s
	iters: 400, epoch: 17 | loss: 0.0127394
	speed: 0.0201s/iter; left time: 689.2300s
Epoch: 17 cost time: 8.68566370010376
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 105486
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4699143
	speed: 0.0391s/iter; left time: 1609.2886s
	iters: 200, epoch: 1 | loss: 0.1172420
	speed: 0.0193s/iter; left time: 792.6837s
	iters: 300, epoch: 1 | loss: 0.0520557
	speed: 0.0219s/iter; left time: 897.2581s
	iters: 400, epoch: 1 | loss: 0.0525488
	speed: 0.0215s/iter; left time: 879.7943s
Epoch: 1 cost time: 10.52137279510498
Epoch: 1, Steps: 413 | Train Loss: 0.554 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (inf --> -0.964983).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1588502
	speed: 0.0696s/iter; left time: 2839.0190s
	iters: 200, epoch: 2 | loss: 0.0860370
	speed: 0.0208s/iter; left time: 848.2526s
	iters: 300, epoch: 2 | loss: 0.1850495
	speed: 0.0214s/iter; left time: 869.7268s
	iters: 400, epoch: 2 | loss: 0.0220576
	speed: 0.0220s/iter; left time: 892.1050s
Epoch: 2 cost time: 9.256052732467651
Epoch: 2, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.079 Vali Acc: 0.972 Test Loss: 0.079 Test Acc: 0.972
Validation loss decreased (-0.964983 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0102539
	speed: 0.0693s/iter; left time: 2798.2909s
	iters: 200, epoch: 3 | loss: 0.0414531
	speed: 0.0207s/iter; left time: 835.0558s
	iters: 300, epoch: 3 | loss: 0.0137135
	speed: 0.0214s/iter; left time: 860.9516s
	iters: 400, epoch: 3 | loss: 0.0766505
	speed: 0.0210s/iter; left time: 842.4768s
Epoch: 3 cost time: 8.951348781585693
Epoch: 3, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.074 Vali Acc: 0.971 Test Loss: 0.074 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0137736
	speed: 0.0713s/iter; left time: 2850.0534s
	iters: 200, epoch: 4 | loss: 0.0109471
	speed: 0.0208s/iter; left time: 830.7664s
	iters: 300, epoch: 4 | loss: 0.0253671
	speed: 0.0220s/iter; left time: 874.4082s
	iters: 400, epoch: 4 | loss: 0.0010787
	speed: 0.0221s/iter; left time: 877.1928s
Epoch: 4 cost time: 9.250425100326538
Epoch: 4, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.063 Vali Acc: 0.979 Test Loss: 0.063 Test Acc: 0.979
Validation loss decreased (-0.972259 --> -0.979081).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0024702
	speed: 0.0751s/iter; left time: 2970.5218s
	iters: 200, epoch: 5 | loss: 0.0743526
	speed: 0.0209s/iter; left time: 825.5056s
	iters: 300, epoch: 5 | loss: 0.0014630
	speed: 0.0200s/iter; left time: 786.0886s
	iters: 400, epoch: 5 | loss: 0.0837574
	speed: 0.0186s/iter; left time: 730.6167s
Epoch: 5 cost time: 8.620078563690186
Epoch: 5, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0067380
	speed: 0.0671s/iter; left time: 2627.3456s
	iters: 200, epoch: 6 | loss: 0.0506698
	speed: 0.0194s/iter; left time: 758.9137s
	iters: 300, epoch: 6 | loss: 0.0317286
	speed: 0.0195s/iter; left time: 758.4725s
	iters: 400, epoch: 6 | loss: 0.0183000
	speed: 0.0188s/iter; left time: 731.4739s
Epoch: 6 cost time: 8.199986219406128
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0010643
	speed: 0.0664s/iter; left time: 2569.5826s
	iters: 200, epoch: 7 | loss: 0.0018307
	speed: 0.0189s/iter; left time: 731.7470s
	iters: 300, epoch: 7 | loss: 0.0544536
	speed: 0.0184s/iter; left time: 709.8506s
	iters: 400, epoch: 7 | loss: 0.0011533
	speed: 0.0211s/iter; left time: 809.6135s
Epoch: 7 cost time: 8.369659185409546
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.058 Vali Acc: 0.980 Test Loss: 0.058 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979990).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0104904
	speed: 0.0672s/iter; left time: 2574.8752s
	iters: 200, epoch: 8 | loss: 0.0001785
	speed: 0.0207s/iter; left time: 790.9844s
	iters: 300, epoch: 8 | loss: 0.0018813
	speed: 0.0214s/iter; left time: 814.4365s
	iters: 400, epoch: 8 | loss: 0.0006730
	speed: 0.0209s/iter; left time: 793.8119s
Epoch: 8 cost time: 9.005875587463379
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.979990 --> -0.980900).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0003758
	speed: 0.0663s/iter; left time: 2512.3844s
	iters: 200, epoch: 9 | loss: 0.0000599
	speed: 0.0203s/iter; left time: 765.7479s
	iters: 300, epoch: 9 | loss: 0.0006986
	speed: 0.0206s/iter; left time: 776.7300s
	iters: 400, epoch: 9 | loss: 0.0001704
	speed: 0.0207s/iter; left time: 777.3502s
Epoch: 9 cost time: 8.935161352157593
Epoch: 9, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0005004
	speed: 0.0654s/iter; left time: 2450.5410s
	iters: 200, epoch: 10 | loss: 0.0000491
	speed: 0.0192s/iter; left time: 716.3672s
	iters: 300, epoch: 10 | loss: 0.0000040
	speed: 0.0215s/iter; left time: 803.3321s
	iters: 400, epoch: 10 | loss: 0.0121448
	speed: 0.0217s/iter; left time: 806.1274s
Epoch: 10 cost time: 8.92649793624878
Epoch: 10, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1081166
	speed: 0.0700s/iter; left time: 2596.7433s
	iters: 200, epoch: 11 | loss: 0.0000159
	speed: 0.0208s/iter; left time: 768.1451s
	iters: 300, epoch: 11 | loss: 0.0265015
	speed: 0.0199s/iter; left time: 733.3853s
	iters: 400, epoch: 11 | loss: 0.0000125
	speed: 0.0197s/iter; left time: 723.3653s
Epoch: 11 cost time: 8.80707859992981
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000388
	speed: 0.0693s/iter; left time: 2542.2000s
	iters: 200, epoch: 12 | loss: 0.0002117
	speed: 0.0192s/iter; left time: 701.8540s
	iters: 300, epoch: 12 | loss: 0.0000909
	speed: 0.0192s/iter; left time: 701.6175s
	iters: 400, epoch: 12 | loss: 0.0003547
	speed: 0.0177s/iter; left time: 642.0289s
Epoch: 12 cost time: 8.13441252708435
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0028303
	speed: 0.0650s/iter; left time: 2355.4581s
	iters: 200, epoch: 13 | loss: 0.0000327
	speed: 0.0190s/iter; left time: 685.3888s
	iters: 300, epoch: 13 | loss: 0.0002463
	speed: 0.0190s/iter; left time: 683.2124s
	iters: 400, epoch: 13 | loss: 0.0000030
	speed: 0.0187s/iter; left time: 671.0285s
Epoch: 13 cost time: 8.218780517578125
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0005022
	speed: 0.0674s/iter; left time: 2416.3872s
	iters: 200, epoch: 14 | loss: 0.0145809
	speed: 0.0204s/iter; left time: 729.0534s
	iters: 300, epoch: 14 | loss: 0.0000004
	speed: 0.0212s/iter; left time: 754.9697s
	iters: 400, epoch: 14 | loss: 0.1287612
	speed: 0.0210s/iter; left time: 745.0353s
Epoch: 14 cost time: 8.89349627494812
Epoch: 14, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000091
	speed: 0.0702s/iter; left time: 2485.8516s
	iters: 200, epoch: 15 | loss: 0.0020851
	speed: 0.0207s/iter; left time: 731.6500s
	iters: 300, epoch: 15 | loss: 0.0000128
	speed: 0.0212s/iter; left time: 744.9065s
	iters: 400, epoch: 15 | loss: 0.0001805
	speed: 0.0208s/iter; left time: 730.1183s
Epoch: 15 cost time: 8.993457078933716
Epoch: 15, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000021
	speed: 0.0643s/iter; left time: 2250.6017s
	iters: 200, epoch: 16 | loss: 0.0094455
	speed: 0.0201s/iter; left time: 700.3817s
	iters: 300, epoch: 16 | loss: 0.0004630
	speed: 0.0206s/iter; left time: 717.0015s
	iters: 400, epoch: 16 | loss: 0.0000003
	speed: 0.0202s/iter; left time: 700.5871s
Epoch: 16 cost time: 8.826900959014893
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000225
	speed: 0.0666s/iter; left time: 2303.7149s
	iters: 200, epoch: 17 | loss: 0.0000374
	speed: 0.0214s/iter; left time: 736.6723s
	iters: 300, epoch: 17 | loss: 0.0000302
	speed: 0.0213s/iter; left time: 733.5480s
	iters: 400, epoch: 17 | loss: 0.0004116
	speed: 0.0207s/iter; left time: 708.5208s
Epoch: 17 cost time: 9.126930236816406
Epoch: 17, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000670
	speed: 0.0675s/iter; left time: 2306.4016s
	iters: 200, epoch: 18 | loss: 0.0000052
	speed: 0.0198s/iter; left time: 674.4557s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0189s/iter; left time: 642.9338s
	iters: 400, epoch: 18 | loss: 0.0000394
	speed: 0.0185s/iter; left time: 628.1966s
Epoch: 18 cost time: 8.303545951843262
Epoch: 18, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 89102
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5244864
	speed: 0.0381s/iter; left time: 1569.9861s
	iters: 200, epoch: 1 | loss: 0.1299359
	speed: 0.0201s/iter; left time: 827.5873s
	iters: 300, epoch: 1 | loss: 0.0706220
	speed: 0.0210s/iter; left time: 862.0787s
	iters: 400, epoch: 1 | loss: 0.0658476
	speed: 0.0213s/iter; left time: 872.9853s
Epoch: 1 cost time: 10.391615390777588
Epoch: 1, Steps: 413 | Train Loss: 0.578 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1608134
	speed: 0.0702s/iter; left time: 2862.3684s
	iters: 200, epoch: 2 | loss: 0.0886979
	speed: 0.0214s/iter; left time: 868.9829s
	iters: 300, epoch: 2 | loss: 0.2280963
	speed: 0.0202s/iter; left time: 819.1334s
	iters: 400, epoch: 2 | loss: 0.0159145
	speed: 0.0206s/iter; left time: 832.6375s
Epoch: 2 cost time: 8.911023616790771
Epoch: 2, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.084 Vali Acc: 0.971 Test Loss: 0.084 Test Acc: 0.971
Validation loss decreased (-0.962709 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0136184
	speed: 0.0710s/iter; left time: 2867.3529s
	iters: 200, epoch: 3 | loss: 0.0359269
	speed: 0.0202s/iter; left time: 811.5648s
	iters: 300, epoch: 3 | loss: 0.0161546
	speed: 0.0194s/iter; left time: 779.8908s
	iters: 400, epoch: 3 | loss: 0.0862256
	speed: 0.0198s/iter; left time: 795.4517s
Epoch: 3 cost time: 8.660672664642334
Epoch: 3, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0210308
	speed: 0.0703s/iter; left time: 2809.6692s
	iters: 200, epoch: 4 | loss: 0.0084692
	speed: 0.0200s/iter; left time: 795.5333s
	iters: 300, epoch: 4 | loss: 0.0137643
	speed: 0.0218s/iter; left time: 864.8595s
	iters: 400, epoch: 4 | loss: 0.0008645
	speed: 0.0197s/iter; left time: 781.2155s
Epoch: 4 cost time: 8.87673306465149
Epoch: 4, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.061 Vali Acc: 0.981 Test Loss: 0.061 Test Acc: 0.981
Validation loss decreased (-0.970895 --> -0.981355).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0050786
	speed: 0.0675s/iter; left time: 2670.5628s
	iters: 200, epoch: 5 | loss: 0.0264813
	speed: 0.0184s/iter; left time: 725.5883s
	iters: 300, epoch: 5 | loss: 0.0031062
	speed: 0.0191s/iter; left time: 751.5391s
	iters: 400, epoch: 5 | loss: 0.0002386
	speed: 0.0189s/iter; left time: 740.1009s
Epoch: 5 cost time: 8.133072137832642
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0001060
	speed: 0.0659s/iter; left time: 2578.4712s
	iters: 200, epoch: 6 | loss: 0.0906438
	speed: 0.0197s/iter; left time: 770.9424s
	iters: 300, epoch: 6 | loss: 0.0171575
	speed: 0.0192s/iter; left time: 748.7727s
	iters: 400, epoch: 6 | loss: 0.0118059
	speed: 0.0198s/iter; left time: 767.4088s
Epoch: 6 cost time: 8.518413066864014
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0001380
	speed: 0.0643s/iter; left time: 2488.5495s
	iters: 200, epoch: 7 | loss: 0.0067253
	speed: 0.0194s/iter; left time: 748.9264s
	iters: 300, epoch: 7 | loss: 0.0204430
	speed: 0.0193s/iter; left time: 745.3010s
	iters: 400, epoch: 7 | loss: 0.0005842
	speed: 0.0190s/iter; left time: 729.5337s
Epoch: 7 cost time: 8.268110275268555
Epoch: 7, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0432642
	speed: 0.0632s/iter; left time: 2420.4604s
	iters: 200, epoch: 8 | loss: 0.0038965
	speed: 0.0196s/iter; left time: 748.6673s
	iters: 300, epoch: 8 | loss: 0.0218961
	speed: 0.0200s/iter; left time: 762.1210s
	iters: 400, epoch: 8 | loss: 0.0013535
	speed: 0.0207s/iter; left time: 787.9248s
Epoch: 8 cost time: 8.711032629013062
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000168
	speed: 0.0630s/iter; left time: 2387.6412s
	iters: 200, epoch: 9 | loss: 0.0010937
	speed: 0.0198s/iter; left time: 749.6629s
	iters: 300, epoch: 9 | loss: 0.0016663
	speed: 0.0206s/iter; left time: 775.9354s
	iters: 400, epoch: 9 | loss: 0.0519436
	speed: 0.0198s/iter; left time: 745.0124s
Epoch: 9 cost time: 8.712274312973022
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0019849
	speed: 0.0642s/iter; left time: 2405.7540s
	iters: 200, epoch: 10 | loss: 0.0000382
	speed: 0.0211s/iter; left time: 788.2196s
	iters: 300, epoch: 10 | loss: 0.0001346
	speed: 0.0211s/iter; left time: 786.9858s
	iters: 400, epoch: 10 | loss: 0.0462863
	speed: 0.0202s/iter; left time: 751.5614s
Epoch: 10 cost time: 8.960038185119629
Epoch: 10, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0009328
	speed: 0.0670s/iter; left time: 2483.2281s
	iters: 200, epoch: 11 | loss: 0.0000494
	speed: 0.0206s/iter; left time: 760.9015s
	iters: 300, epoch: 11 | loss: 0.0329187
	speed: 0.0200s/iter; left time: 737.5826s
	iters: 400, epoch: 11 | loss: 0.0000277
	speed: 0.0197s/iter; left time: 725.3621s
Epoch: 11 cost time: 8.688895463943481
Epoch: 11, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000712
	speed: 0.0666s/iter; left time: 2441.9769s
	iters: 200, epoch: 12 | loss: 0.0000554
	speed: 0.0189s/iter; left time: 691.9469s
	iters: 300, epoch: 12 | loss: 0.0000629
	speed: 0.0204s/iter; left time: 744.2162s
	iters: 400, epoch: 12 | loss: 0.0003224
	speed: 0.0199s/iter; left time: 724.4727s
Epoch: 12 cost time: 8.42618203163147
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0006237
	speed: 0.0727s/iter; left time: 2634.2109s
	iters: 200, epoch: 13 | loss: 0.0001618
	speed: 0.0203s/iter; left time: 733.5686s
	iters: 300, epoch: 13 | loss: 0.0002563
	speed: 0.0199s/iter; left time: 717.9177s
	iters: 400, epoch: 13 | loss: 0.0009893
	speed: 0.0197s/iter; left time: 708.7854s
Epoch: 13 cost time: 8.544812440872192
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0035494
	speed: 0.0722s/iter; left time: 2585.8870s
	iters: 200, epoch: 14 | loss: 0.0025172
	speed: 0.0197s/iter; left time: 702.9029s
	iters: 300, epoch: 14 | loss: 0.0000015
	speed: 0.0213s/iter; left time: 760.1122s
	iters: 400, epoch: 14 | loss: 0.0031828
	speed: 0.0207s/iter; left time: 735.9803s
Epoch: 14 cost time: 8.781625032424927
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 89102
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6626964
	speed: 0.0367s/iter; left time: 1513.1066s
	iters: 200, epoch: 1 | loss: 0.1516221
	speed: 0.0215s/iter; left time: 882.1818s
	iters: 300, epoch: 1 | loss: 0.1230781
	speed: 0.0207s/iter; left time: 850.2125s
	iters: 400, epoch: 1 | loss: 0.1048921
	speed: 0.0213s/iter; left time: 872.3095s
Epoch: 1 cost time: 10.35037612915039
Epoch: 1, Steps: 413 | Train Loss: 0.633 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1635026
	speed: 0.0661s/iter; left time: 2695.1644s
	iters: 200, epoch: 2 | loss: 0.0882522
	speed: 0.0210s/iter; left time: 856.1041s
	iters: 300, epoch: 2 | loss: 0.1455635
	speed: 0.0215s/iter; left time: 871.5037s
	iters: 400, epoch: 2 | loss: 0.0426745
	speed: 0.0214s/iter; left time: 867.6243s
Epoch: 2 cost time: 9.17439579963684
Epoch: 2, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
Validation loss decreased (-0.957252 --> -0.975443).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0190433
	speed: 0.0692s/iter; left time: 2792.7957s
	iters: 200, epoch: 3 | loss: 0.0642459
	speed: 0.0192s/iter; left time: 772.9959s
	iters: 300, epoch: 3 | loss: 0.0069500
	speed: 0.0198s/iter; left time: 796.5625s
	iters: 400, epoch: 3 | loss: 0.1060729
	speed: 0.0203s/iter; left time: 814.0117s
Epoch: 3 cost time: 8.579689264297485
Epoch: 3, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0117557
	speed: 0.0669s/iter; left time: 2673.9497s
	iters: 200, epoch: 4 | loss: 0.0238837
	speed: 0.0195s/iter; left time: 778.8682s
	iters: 300, epoch: 4 | loss: 0.0482890
	speed: 0.0203s/iter; left time: 806.6164s
	iters: 400, epoch: 4 | loss: 0.0064757
	speed: 0.0206s/iter; left time: 816.8754s
Epoch: 4 cost time: 8.539738655090332
Epoch: 4, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.066 Vali Acc: 0.978 Test Loss: 0.066 Test Acc: 0.978
Validation loss decreased (-0.975443 --> -0.977716).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0007937
	speed: 0.0647s/iter; left time: 2560.5711s
	iters: 200, epoch: 5 | loss: 0.0488339
	speed: 0.0185s/iter; left time: 731.1857s
	iters: 300, epoch: 5 | loss: 0.0067380
	speed: 0.0201s/iter; left time: 791.5400s
	iters: 400, epoch: 5 | loss: 0.0002339
	speed: 0.0218s/iter; left time: 856.9933s
Epoch: 5 cost time: 8.628310203552246
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.178 Vali Acc: 0.947 Test Loss: 0.178 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0002080
	speed: 0.0702s/iter; left time: 2746.1258s
	iters: 200, epoch: 6 | loss: 0.0218861
	speed: 0.0205s/iter; left time: 801.4538s
	iters: 300, epoch: 6 | loss: 0.0220208
	speed: 0.0216s/iter; left time: 841.5392s
	iters: 400, epoch: 6 | loss: 0.0217734
	speed: 0.0205s/iter; left time: 796.3048s
Epoch: 6 cost time: 9.063122510910034
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0001577
	speed: 0.0681s/iter; left time: 2638.6274s
	iters: 200, epoch: 7 | loss: 0.0001189
	speed: 0.0208s/iter; left time: 804.6592s
	iters: 300, epoch: 7 | loss: 0.0061331
	speed: 0.0203s/iter; left time: 783.6833s
	iters: 400, epoch: 7 | loss: 0.0002088
	speed: 0.0207s/iter; left time: 794.3594s
Epoch: 7 cost time: 8.93980097770691
Epoch: 7, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (-0.977716 --> -0.979081).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0001200
	speed: 0.0678s/iter; left time: 2595.7968s
	iters: 200, epoch: 8 | loss: 0.0023740
	speed: 0.0210s/iter; left time: 802.0099s
	iters: 300, epoch: 8 | loss: 0.0033570
	speed: 0.0214s/iter; left time: 813.6560s
	iters: 400, epoch: 8 | loss: 0.0048367
	speed: 0.0202s/iter; left time: 767.5826s
Epoch: 8 cost time: 8.996898889541626
Epoch: 8, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0001455
	speed: 0.0665s/iter; left time: 2518.5234s
	iters: 200, epoch: 9 | loss: 0.0003447
	speed: 0.0190s/iter; left time: 718.3750s
	iters: 300, epoch: 9 | loss: 0.0026415
	speed: 0.0192s/iter; left time: 723.1552s
	iters: 400, epoch: 9 | loss: 0.0008048
	speed: 0.0199s/iter; left time: 746.8907s
Epoch: 9 cost time: 8.361242771148682
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0059127
	speed: 0.0677s/iter; left time: 2538.7610s
	iters: 200, epoch: 10 | loss: 0.0000049
	speed: 0.0194s/iter; left time: 723.4239s
	iters: 300, epoch: 10 | loss: 0.0000632
	speed: 0.0196s/iter; left time: 731.8309s
	iters: 400, epoch: 10 | loss: 0.0001344
	speed: 0.0198s/iter; left time: 735.2600s
Epoch: 10 cost time: 8.347977638244629
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0024804
	speed: 0.0645s/iter; left time: 2390.7087s
	iters: 200, epoch: 11 | loss: 0.0000020
	speed: 0.0200s/iter; left time: 737.6125s
	iters: 300, epoch: 11 | loss: 0.4039485
	speed: 0.0201s/iter; left time: 741.5694s
	iters: 400, epoch: 11 | loss: 0.0004237
	speed: 0.0194s/iter; left time: 713.0385s
Epoch: 11 cost time: 8.444936990737915
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000354
	speed: 0.0637s/iter; left time: 2333.4197s
	iters: 200, epoch: 12 | loss: 0.0003336
	speed: 0.0206s/iter; left time: 752.5781s
	iters: 300, epoch: 12 | loss: 0.0000082
	speed: 0.0210s/iter; left time: 766.6240s
	iters: 400, epoch: 12 | loss: 0.0002217
	speed: 0.0216s/iter; left time: 783.8714s
Epoch: 12 cost time: 9.009488344192505
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.965 Test Loss: 0.178 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000184
	speed: 0.0651s/iter; left time: 2359.5447s
	iters: 200, epoch: 13 | loss: 0.0080845
	speed: 0.0204s/iter; left time: 738.9717s
	iters: 300, epoch: 13 | loss: 0.0000103
	speed: 0.0222s/iter; left time: 801.0385s
	iters: 400, epoch: 13 | loss: 0.0008191
	speed: 0.0205s/iter; left time: 737.1290s
Epoch: 13 cost time: 8.941595792770386
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
Validation loss decreased (-0.979081 --> -0.984538).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0009377
	speed: 0.0651s/iter; left time: 2332.8042s
	iters: 200, epoch: 14 | loss: 0.0255266
	speed: 0.0208s/iter; left time: 744.7420s
	iters: 300, epoch: 14 | loss: 0.0000149
	speed: 0.0218s/iter; left time: 775.8104s
	iters: 400, epoch: 14 | loss: 0.0000336
	speed: 0.0216s/iter; left time: 767.4602s
Epoch: 14 cost time: 9.084705591201782
Epoch: 14, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000283
	speed: 0.0700s/iter; left time: 2480.7973s
	iters: 200, epoch: 15 | loss: 0.0002186
	speed: 0.0203s/iter; left time: 717.0301s
	iters: 300, epoch: 15 | loss: 0.0001432
	speed: 0.0209s/iter; left time: 736.5445s
	iters: 400, epoch: 15 | loss: 0.0013925
	speed: 0.0207s/iter; left time: 726.3798s
Epoch: 15 cost time: 8.801583290100098
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.968 Test Loss: 0.205 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000343
	speed: 0.0742s/iter; left time: 2597.8063s
	iters: 200, epoch: 16 | loss: 0.0000694
	speed: 0.0200s/iter; left time: 699.0071s
	iters: 300, epoch: 16 | loss: 0.0001767
	speed: 0.0203s/iter; left time: 706.0355s
	iters: 400, epoch: 16 | loss: 0.0000039
	speed: 0.0205s/iter; left time: 712.1336s
Epoch: 16 cost time: 8.68683385848999
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0003344
	speed: 0.0725s/iter; left time: 2508.9997s
	iters: 200, epoch: 17 | loss: 0.0367300
	speed: 0.0191s/iter; left time: 659.3833s
	iters: 300, epoch: 17 | loss: 0.0000469
	speed: 0.0206s/iter; left time: 708.5873s
	iters: 400, epoch: 17 | loss: 0.0000397
	speed: 0.0202s/iter; left time: 694.2974s
Epoch: 17 cost time: 8.694478750228882
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0008052
	speed: 0.0754s/iter; left time: 2576.4444s
	iters: 200, epoch: 18 | loss: 0.0000038
	speed: 0.0205s/iter; left time: 697.1453s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0185s/iter; left time: 627.1828s
	iters: 400, epoch: 18 | loss: 0.0000353
	speed: 0.0189s/iter; left time: 640.2967s
Epoch: 18 cost time: 8.494816541671753
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000687
	speed: 0.0657s/iter; left time: 2218.0426s
	iters: 200, epoch: 19 | loss: 0.0024911
	speed: 0.0197s/iter; left time: 662.8618s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0193s/iter; left time: 647.4937s
	iters: 400, epoch: 19 | loss: 0.0000020
	speed: 0.0200s/iter; left time: 669.1029s
Epoch: 19 cost time: 8.570607900619507
Epoch: 19, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000020
	speed: 0.0577s/iter; left time: 1925.1213s
	iters: 200, epoch: 20 | loss: 0.0000004
	speed: 0.0185s/iter; left time: 616.7806s
	iters: 300, epoch: 20 | loss: 0.0000242
	speed: 0.0184s/iter; left time: 611.1544s
	iters: 400, epoch: 20 | loss: 0.0000626
	speed: 0.0184s/iter; left time: 606.6263s
Epoch: 20 cost time: 8.087465047836304
Epoch: 20, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.128 Vali Acc: 0.979 Test Loss: 0.128 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0003223
	speed: 0.0613s/iter; left time: 2020.7390s
	iters: 200, epoch: 21 | loss: 0.0000009
	speed: 0.0208s/iter; left time: 682.0900s
	iters: 300, epoch: 21 | loss: 0.1295470
	speed: 0.0212s/iter; left time: 693.1630s
	iters: 400, epoch: 21 | loss: 0.0000069
	speed: 0.0208s/iter; left time: 679.1834s
Epoch: 21 cost time: 9.004809379577637
Epoch: 21, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000009
	speed: 0.0646s/iter; left time: 2101.7185s
	iters: 200, epoch: 22 | loss: 0.0000013
	speed: 0.0206s/iter; left time: 669.1767s
	iters: 300, epoch: 22 | loss: 0.0037805
	speed: 0.0203s/iter; left time: 657.4879s
	iters: 400, epoch: 22 | loss: 0.0008928
	speed: 0.0203s/iter; left time: 652.9165s
Epoch: 22 cost time: 8.867746353149414
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.1392679
	speed: 0.0650s/iter; left time: 2086.6984s
	iters: 200, epoch: 23 | loss: 0.0000036
	speed: 0.0207s/iter; left time: 663.2691s
	iters: 300, epoch: 23 | loss: 0.0000222
	speed: 0.0206s/iter; left time: 655.8791s
	iters: 400, epoch: 23 | loss: 0.0000379
	speed: 0.0209s/iter; left time: 664.8594s
Epoch: 23 cost time: 8.969464302062988
Epoch: 23, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 89102
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0253359
	speed: 0.0367s/iter; left time: 1511.6523s
	iters: 200, epoch: 1 | loss: 0.2936647
	speed: 0.0199s/iter; left time: 817.4749s
	iters: 300, epoch: 1 | loss: 0.2343727
	speed: 0.0188s/iter; left time: 770.6235s
	iters: 400, epoch: 1 | loss: 0.1163818
	speed: 0.0198s/iter; left time: 810.2273s
Epoch: 1 cost time: 9.808627367019653
Epoch: 1, Steps: 413 | Train Loss: 0.764 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (inf --> -0.962254).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1883498
	speed: 0.0667s/iter; left time: 2722.4426s
	iters: 200, epoch: 2 | loss: 0.0773283
	speed: 0.0191s/iter; left time: 776.9311s
	iters: 300, epoch: 2 | loss: 0.1661824
	speed: 0.0192s/iter; left time: 780.4549s
	iters: 400, epoch: 2 | loss: 0.0471245
	speed: 0.0191s/iter; left time: 773.8296s
Epoch: 2 cost time: 8.260283470153809
Epoch: 2, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.080 Vali Acc: 0.972 Test Loss: 0.080 Test Acc: 0.972
Validation loss decreased (-0.962254 --> -0.971805).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0717262
	speed: 0.0681s/iter; left time: 2749.4727s
	iters: 200, epoch: 3 | loss: 0.0613270
	speed: 0.0203s/iter; left time: 817.6273s
	iters: 300, epoch: 3 | loss: 0.0099395
	speed: 0.0194s/iter; left time: 777.9054s
	iters: 400, epoch: 3 | loss: 0.0677207
	speed: 0.0210s/iter; left time: 841.7986s
Epoch: 3 cost time: 8.699174165725708
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.086 Vali Acc: 0.972 Test Loss: 0.086 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3218437
	speed: 0.0683s/iter; left time: 2730.3979s
	iters: 200, epoch: 4 | loss: 0.0295114
	speed: 0.0197s/iter; left time: 784.3618s
	iters: 300, epoch: 4 | loss: 0.0058989
	speed: 0.0208s/iter; left time: 827.7541s
	iters: 400, epoch: 4 | loss: 0.0082159
	speed: 0.0203s/iter; left time: 806.7970s
Epoch: 4 cost time: 8.74953293800354
Epoch: 4, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.971805 --> -0.976807).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0019990
	speed: 0.0657s/iter; left time: 2599.1734s
	iters: 200, epoch: 5 | loss: 0.0096400
	speed: 0.0204s/iter; left time: 804.7190s
	iters: 300, epoch: 5 | loss: 0.0026476
	speed: 0.0208s/iter; left time: 818.3320s
	iters: 400, epoch: 5 | loss: 0.0233895
	speed: 0.0197s/iter; left time: 773.7640s
Epoch: 5 cost time: 8.717307090759277
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0057382
	speed: 0.0641s/iter; left time: 2508.3460s
	iters: 200, epoch: 6 | loss: 0.0134682
	speed: 0.0205s/iter; left time: 801.8260s
	iters: 300, epoch: 6 | loss: 0.0963414
	speed: 0.0207s/iter; left time: 804.1112s
	iters: 400, epoch: 6 | loss: 0.0064845
	speed: 0.0207s/iter; left time: 805.7766s
Epoch: 6 cost time: 8.709874629974365
Epoch: 6, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0012170
	speed: 0.0653s/iter; left time: 2530.1888s
	iters: 200, epoch: 7 | loss: 0.0003617
	speed: 0.0204s/iter; left time: 788.4274s
	iters: 300, epoch: 7 | loss: 0.0153334
	speed: 0.0185s/iter; left time: 712.6425s
	iters: 400, epoch: 7 | loss: 0.0015373
	speed: 0.0194s/iter; left time: 746.9216s
Epoch: 7 cost time: 8.4884672164917
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0001519
	speed: 0.0657s/iter; left time: 2518.5696s
	iters: 200, epoch: 8 | loss: 0.0018642
	speed: 0.0203s/iter; left time: 774.2068s
	iters: 300, epoch: 8 | loss: 0.0048992
	speed: 0.0210s/iter; left time: 801.2487s
	iters: 400, epoch: 8 | loss: 0.0007108
	speed: 0.0203s/iter; left time: 769.9549s
Epoch: 8 cost time: 8.686859846115112
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.976807 --> -0.980900).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0010912
	speed: 0.0656s/iter; left time: 2485.6080s
	iters: 200, epoch: 9 | loss: 0.0008328
	speed: 0.0190s/iter; left time: 716.8476s
	iters: 300, epoch: 9 | loss: 0.0005295
	speed: 0.0191s/iter; left time: 719.9819s
	iters: 400, epoch: 9 | loss: 0.0216316
	speed: 0.0197s/iter; left time: 739.0735s
Epoch: 9 cost time: 8.356047868728638
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.980900 --> -0.980900).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0924679
	speed: 0.0629s/iter; left time: 2355.9376s
	iters: 200, epoch: 10 | loss: 0.0034722
	speed: 0.0196s/iter; left time: 731.7811s
	iters: 300, epoch: 10 | loss: 0.0000840
	speed: 0.0211s/iter; left time: 788.2608s
	iters: 400, epoch: 10 | loss: 0.0528929
	speed: 0.0219s/iter; left time: 813.5295s
Epoch: 10 cost time: 8.726774215698242
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0085039
	speed: 0.0675s/iter; left time: 2501.1434s
	iters: 200, epoch: 11 | loss: 0.0000027
	speed: 0.0203s/iter; left time: 750.8721s
	iters: 300, epoch: 11 | loss: 0.0012556
	speed: 0.0206s/iter; left time: 759.7135s
	iters: 400, epoch: 11 | loss: 0.0055559
	speed: 0.0207s/iter; left time: 759.4597s
Epoch: 11 cost time: 8.820729494094849
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000541
	speed: 0.0646s/iter; left time: 2369.5556s
	iters: 200, epoch: 12 | loss: 0.0000227
	speed: 0.0206s/iter; left time: 752.2269s
	iters: 300, epoch: 12 | loss: 0.0003723
	speed: 0.0204s/iter; left time: 743.1026s
	iters: 400, epoch: 12 | loss: 0.0000944
	speed: 0.0201s/iter; left time: 728.9913s
Epoch: 12 cost time: 8.70190954208374
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0060905
	speed: 0.0645s/iter; left time: 2338.0310s
	iters: 200, epoch: 13 | loss: 0.1031295
	speed: 0.0204s/iter; left time: 736.1363s
	iters: 300, epoch: 13 | loss: 0.0000081
	speed: 0.0211s/iter; left time: 760.8242s
	iters: 400, epoch: 13 | loss: 0.0005082
	speed: 0.0199s/iter; left time: 714.8875s
Epoch: 13 cost time: 8.849075555801392
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0019374
	speed: 0.0655s/iter; left time: 2347.5464s
	iters: 200, epoch: 14 | loss: 0.0014158
	speed: 0.0193s/iter; left time: 691.2982s
	iters: 300, epoch: 14 | loss: 0.0010003
	speed: 0.0187s/iter; left time: 665.6214s
	iters: 400, epoch: 14 | loss: 0.0000245
	speed: 0.0190s/iter; left time: 676.6258s
Epoch: 14 cost time: 8.081873416900635
Epoch: 14, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000296
	speed: 0.0670s/iter; left time: 2372.8494s
	iters: 200, epoch: 15 | loss: 0.0000784
	speed: 0.0186s/iter; left time: 655.2587s
	iters: 300, epoch: 15 | loss: 0.0001290
	speed: 0.0181s/iter; left time: 638.0827s
	iters: 400, epoch: 15 | loss: 0.0000862
	speed: 0.0199s/iter; left time: 698.2069s
Epoch: 15 cost time: 8.166894435882568
Epoch: 15, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0006930
	speed: 0.0612s/iter; left time: 2143.8351s
	iters: 200, epoch: 16 | loss: 0.0121248
	speed: 0.0201s/iter; left time: 701.0461s
	iters: 300, epoch: 16 | loss: 0.0002329
	speed: 0.0197s/iter; left time: 685.7092s
	iters: 400, epoch: 16 | loss: 0.0002120
	speed: 0.0199s/iter; left time: 689.5409s
Epoch: 16 cost time: 8.525854110717773
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0237131
	speed: 0.0618s/iter; left time: 2138.4768s
	iters: 200, epoch: 17 | loss: 0.2931277
	speed: 0.0214s/iter; left time: 737.0278s
	iters: 300, epoch: 17 | loss: 0.0014924
	speed: 0.0207s/iter; left time: 713.0655s
	iters: 400, epoch: 17 | loss: 0.0116869
	speed: 0.0199s/iter; left time: 682.3057s
Epoch: 17 cost time: 8.771760702133179
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0001953
	speed: 0.0635s/iter; left time: 2170.4369s
	iters: 200, epoch: 18 | loss: 0.0001055
	speed: 0.0201s/iter; left time: 684.2861s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0197s/iter; left time: 669.7037s
	iters: 400, epoch: 18 | loss: 0.0001948
	speed: 0.0202s/iter; left time: 683.5972s
Epoch: 18 cost time: 8.569279909133911
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0007696
	speed: 0.0624s/iter; left time: 2105.8459s
	iters: 200, epoch: 19 | loss: 0.0007623
	speed: 0.0194s/iter; left time: 653.8719s
	iters: 300, epoch: 19 | loss: 0.0000070
	speed: 0.0200s/iter; left time: 670.4000s
	iters: 400, epoch: 19 | loss: 0.0028189
	speed: 0.0193s/iter; left time: 644.5838s
Epoch: 19 cost time: 8.430745840072632
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.150 Vali Acc: 0.976 Test Loss: 0.150 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 89102
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6519339
	speed: 0.0408s/iter; left time: 1681.4926s
	iters: 200, epoch: 1 | loss: 0.3119788
	speed: 0.0203s/iter; left time: 835.3341s
	iters: 300, epoch: 1 | loss: 0.0869469
	speed: 0.0203s/iter; left time: 830.4417s
	iters: 400, epoch: 1 | loss: 0.0998454
	speed: 0.0205s/iter; left time: 838.6405s
Epoch: 1 cost time: 10.477925539016724
Epoch: 1, Steps: 413 | Train Loss: 0.571 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
Validation loss decreased (inf --> -0.966347).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0316247
	speed: 0.0722s/iter; left time: 2946.7495s
	iters: 200, epoch: 2 | loss: 0.0278557
	speed: 0.0212s/iter; left time: 862.7575s
	iters: 300, epoch: 2 | loss: 0.0377642
	speed: 0.0202s/iter; left time: 817.9125s
	iters: 400, epoch: 2 | loss: 0.3188467
	speed: 0.0196s/iter; left time: 791.7293s
Epoch: 2 cost time: 8.806604385375977
Epoch: 2, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.084 Vali Acc: 0.971 Test Loss: 0.084 Test Acc: 0.971
Validation loss decreased (-0.966347 --> -0.971350).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1580219
	speed: 0.0742s/iter; left time: 2997.6977s
	iters: 200, epoch: 3 | loss: 0.0560382
	speed: 0.0195s/iter; left time: 786.8679s
	iters: 300, epoch: 3 | loss: 0.0080885
	speed: 0.0200s/iter; left time: 802.5432s
	iters: 400, epoch: 3 | loss: 0.0206343
	speed: 0.0208s/iter; left time: 834.1746s
Epoch: 3 cost time: 8.67364239692688
Epoch: 3, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
Validation loss decreased (-0.971350 --> -0.974533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0168051
	speed: 0.0708s/iter; left time: 2827.4971s
	iters: 200, epoch: 4 | loss: 0.0212575
	speed: 0.0215s/iter; left time: 855.3960s
	iters: 300, epoch: 4 | loss: 0.0292837
	speed: 0.0212s/iter; left time: 841.6895s
	iters: 400, epoch: 4 | loss: 0.0160182
	speed: 0.0215s/iter; left time: 851.2158s
Epoch: 4 cost time: 9.121530771255493
Epoch: 4, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.057 Vali Acc: 0.979 Test Loss: 0.057 Test Acc: 0.979
Validation loss decreased (-0.974533 --> -0.978626).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0038473
	speed: 0.0712s/iter; left time: 2816.5073s
	iters: 200, epoch: 5 | loss: 0.0101386
	speed: 0.0212s/iter; left time: 835.6286s
	iters: 300, epoch: 5 | loss: 0.0006777
	speed: 0.0204s/iter; left time: 802.8369s
	iters: 400, epoch: 5 | loss: 0.0126725
	speed: 0.0210s/iter; left time: 823.1677s
Epoch: 5 cost time: 9.069370031356812
Epoch: 5, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0021024
	speed: 0.0650s/iter; left time: 2545.7960s
	iters: 200, epoch: 6 | loss: 0.0079179
	speed: 0.0206s/iter; left time: 805.3691s
	iters: 300, epoch: 6 | loss: 0.0439355
	speed: 0.0205s/iter; left time: 799.6594s
	iters: 400, epoch: 6 | loss: 0.0050708
	speed: 0.0198s/iter; left time: 767.2496s
Epoch: 6 cost time: 8.765579462051392
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0015359
	speed: 0.0617s/iter; left time: 2387.6634s
	iters: 200, epoch: 7 | loss: 0.0004475
	speed: 0.0201s/iter; left time: 775.6437s
	iters: 300, epoch: 7 | loss: 0.0005872
	speed: 0.0197s/iter; left time: 757.3531s
	iters: 400, epoch: 7 | loss: 0.0000107
	speed: 0.0197s/iter; left time: 755.9579s
Epoch: 7 cost time: 8.54085922241211
Epoch: 7, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0012429
	speed: 0.0656s/iter; left time: 2514.2094s
	iters: 200, epoch: 8 | loss: 0.0001363
	speed: 0.0191s/iter; left time: 728.8808s
	iters: 300, epoch: 8 | loss: 0.0072870
	speed: 0.0188s/iter; left time: 718.3019s
	iters: 400, epoch: 8 | loss: 0.0745786
	speed: 0.0196s/iter; left time: 744.6136s
Epoch: 8 cost time: 8.374870777130127
Epoch: 8, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0004751
	speed: 0.0674s/iter; left time: 2553.0574s
	iters: 200, epoch: 9 | loss: 0.0033565
	speed: 0.0183s/iter; left time: 692.9999s
	iters: 300, epoch: 9 | loss: 0.0000695
	speed: 0.0199s/iter; left time: 751.5577s
	iters: 400, epoch: 9 | loss: 0.0030942
	speed: 0.0192s/iter; left time: 721.3545s
Epoch: 9 cost time: 8.289257049560547
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0009047
	speed: 0.0646s/iter; left time: 2420.2825s
	iters: 200, epoch: 10 | loss: 0.0008967
	speed: 0.0208s/iter; left time: 777.2704s
	iters: 300, epoch: 10 | loss: 0.0003101
	speed: 0.0214s/iter; left time: 799.4306s
	iters: 400, epoch: 10 | loss: 0.0006377
	speed: 0.0204s/iter; left time: 759.9791s
Epoch: 10 cost time: 9.044128894805908
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0661120
	speed: 0.0675s/iter; left time: 2501.0337s
	iters: 200, epoch: 11 | loss: 0.0000138
	speed: 0.0206s/iter; left time: 760.0002s
	iters: 300, epoch: 11 | loss: 0.0000219
	speed: 0.0204s/iter; left time: 750.6868s
	iters: 400, epoch: 11 | loss: 0.0004599
	speed: 0.0205s/iter; left time: 755.6170s
Epoch: 11 cost time: 8.785944700241089
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.978626 --> -0.979081).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000053
	speed: 0.0709s/iter; left time: 2599.5848s
	iters: 200, epoch: 12 | loss: 0.0003338
	speed: 0.0212s/iter; left time: 774.2671s
	iters: 300, epoch: 12 | loss: 0.0006839
	speed: 0.0219s/iter; left time: 796.7371s
	iters: 400, epoch: 12 | loss: 0.0009558
	speed: 0.0214s/iter; left time: 778.1903s
Epoch: 12 cost time: 9.277384281158447
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000117
	speed: 0.0730s/iter; left time: 2646.1145s
	iters: 200, epoch: 13 | loss: 0.0001025
	speed: 0.0196s/iter; left time: 707.4657s
	iters: 300, epoch: 13 | loss: 0.0016857
	speed: 0.0198s/iter; left time: 713.8102s
	iters: 400, epoch: 13 | loss: 0.0000010
	speed: 0.0197s/iter; left time: 707.7303s
Epoch: 13 cost time: 8.72990083694458
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0001764
	speed: 0.0742s/iter; left time: 2659.2722s
	iters: 200, epoch: 14 | loss: 0.0814179
	speed: 0.0200s/iter; left time: 715.6315s
	iters: 300, epoch: 14 | loss: 0.0000714
	speed: 0.0190s/iter; left time: 678.5865s
	iters: 400, epoch: 14 | loss: 0.0615340
	speed: 0.0190s/iter; left time: 673.5827s
Epoch: 14 cost time: 8.547131538391113
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0010989
	speed: 0.0709s/iter; left time: 2512.7599s
	iters: 200, epoch: 15 | loss: 0.0000050
	speed: 0.0193s/iter; left time: 682.9212s
	iters: 300, epoch: 15 | loss: 0.0000215
	speed: 0.0201s/iter; left time: 707.3172s
	iters: 400, epoch: 15 | loss: 0.0102485
	speed: 0.0201s/iter; left time: 706.0174s
Epoch: 15 cost time: 8.590728759765625
Epoch: 15, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0005019
	speed: 0.0667s/iter; left time: 2335.9396s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0202s/iter; left time: 703.9271s
	iters: 300, epoch: 16 | loss: 0.0000002
	speed: 0.0209s/iter; left time: 727.4330s
	iters: 400, epoch: 16 | loss: 0.0027076
	speed: 0.0215s/iter; left time: 744.5043s
Epoch: 16 cost time: 8.938162803649902
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000007
	speed: 0.0673s/iter; left time: 2329.2933s
	iters: 200, epoch: 17 | loss: 0.0000679
	speed: 0.0211s/iter; left time: 727.0626s
	iters: 300, epoch: 17 | loss: 0.0000008
	speed: 0.0212s/iter; left time: 729.5190s
	iters: 400, epoch: 17 | loss: 0.0000023
	speed: 0.0216s/iter; left time: 740.5567s
Epoch: 17 cost time: 9.251179218292236
Epoch: 17, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.979081 --> -0.981354).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0109828
	speed: 0.0683s/iter; left time: 2333.0818s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0205s/iter; left time: 697.4640s
	iters: 300, epoch: 18 | loss: 0.0010203
	speed: 0.0204s/iter; left time: 693.5731s
	iters: 400, epoch: 18 | loss: 0.0000029
	speed: 0.0198s/iter; left time: 670.8242s
Epoch: 18 cost time: 8.801338195800781
Epoch: 18, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000005
	speed: 0.0655s/iter; left time: 2212.7717s
	iters: 200, epoch: 19 | loss: 0.0000427
	speed: 0.0208s/iter; left time: 699.0976s
	iters: 300, epoch: 19 | loss: 0.0005374
	speed: 0.0189s/iter; left time: 634.1508s
	iters: 400, epoch: 19 | loss: 0.0000140
	speed: 0.0189s/iter; left time: 633.7044s
Epoch: 19 cost time: 8.575326681137085
Epoch: 19, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0002779
	speed: 0.0700s/iter; left time: 2333.7122s
	iters: 200, epoch: 20 | loss: 0.0000175
	speed: 0.0197s/iter; left time: 655.1776s
	iters: 300, epoch: 20 | loss: 0.0000130
	speed: 0.0192s/iter; left time: 635.2894s
	iters: 400, epoch: 20 | loss: 0.3773972
	speed: 0.0188s/iter; left time: 620.0233s
Epoch: 20 cost time: 8.38740873336792
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000118
	speed: 0.0678s/iter; left time: 2234.2383s
	iters: 200, epoch: 21 | loss: 0.0039500
	speed: 0.0190s/iter; left time: 622.4785s
	iters: 300, epoch: 21 | loss: 0.0063290
	speed: 0.0194s/iter; left time: 636.7500s
	iters: 400, epoch: 21 | loss: 0.0876837
	speed: 0.0194s/iter; left time: 633.4703s
Epoch: 21 cost time: 8.387510538101196
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000003
	speed: 0.0718s/iter; left time: 2336.8946s
	iters: 200, epoch: 22 | loss: 0.0871061
	speed: 0.0192s/iter; left time: 621.7470s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.0199s/iter; left time: 644.0331s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.0213s/iter; left time: 686.1843s
Epoch: 22 cost time: 8.629158973693848
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.970 Test Loss: 0.197 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0699s/iter; left time: 2245.7781s
	iters: 200, epoch: 23 | loss: 0.0000006
	speed: 0.0200s/iter; left time: 639.9650s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.0212s/iter; left time: 676.1645s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0207s/iter; left time: 659.4786s
Epoch: 23 cost time: 8.908738613128662
Epoch: 23, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.133 Vali Acc: 0.979 Test Loss: 0.133 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0027399
	speed: 0.0706s/iter; left time: 2238.3602s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 666.8017s
	iters: 300, epoch: 24 | loss: 0.0000075
	speed: 0.0198s/iter; left time: 623.0630s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0215s/iter; left time: 674.4369s
Epoch: 24 cost time: 9.037298679351807
Epoch: 24, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000035
	speed: 0.0657s/iter; left time: 2056.8480s
	iters: 200, epoch: 25 | loss: 0.0133777
	speed: 0.0199s/iter; left time: 621.4968s
	iters: 300, epoch: 25 | loss: 0.0000006
	speed: 0.0215s/iter; left time: 669.4103s
	iters: 400, epoch: 25 | loss: 0.0000658
	speed: 0.0212s/iter; left time: 657.5535s
Epoch: 25 cost time: 8.925034284591675
Epoch: 25, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.165 Vali Acc: 0.976 Test Loss: 0.165 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0627s/iter; left time: 1934.8786s
	iters: 200, epoch: 26 | loss: 0.0152297
	speed: 0.0197s/iter; left time: 605.1641s
	iters: 300, epoch: 26 | loss: 0.0166530
	speed: 0.0199s/iter; left time: 611.0040s
	iters: 400, epoch: 26 | loss: 0.0000011
	speed: 0.0203s/iter; left time: 621.6083s
Epoch: 26 cost time: 8.63211965560913
Epoch: 26, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.0697s/iter; left time: 2122.2810s
	iters: 200, epoch: 27 | loss: 0.1645113
	speed: 0.0201s/iter; left time: 610.8706s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0209s/iter; left time: 631.9871s
	iters: 400, epoch: 27 | loss: 0.0000746
	speed: 0.0198s/iter; left time: 597.2181s
Epoch: 27 cost time: 8.601782321929932
Epoch: 27, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 80910
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6815947
	speed: 0.0376s/iter; left time: 1548.7640s
	iters: 200, epoch: 1 | loss: 0.2916619
	speed: 0.0204s/iter; left time: 839.4159s
	iters: 300, epoch: 1 | loss: 0.1019080
	speed: 0.0203s/iter; left time: 832.0843s
	iters: 400, epoch: 1 | loss: 0.1016551
	speed: 0.0204s/iter; left time: 836.0692s
Epoch: 1 cost time: 10.196397066116333
Epoch: 1, Steps: 413 | Train Loss: 0.594 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
Validation loss decreased (inf --> -0.964073).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0419898
	speed: 0.0720s/iter; left time: 2937.6357s
	iters: 200, epoch: 2 | loss: 0.0313836
	speed: 0.0208s/iter; left time: 844.7020s
	iters: 300, epoch: 2 | loss: 0.0361865
	speed: 0.0207s/iter; left time: 841.0964s
	iters: 400, epoch: 2 | loss: 0.1672662
	speed: 0.0213s/iter; left time: 862.9109s
Epoch: 2 cost time: 9.068327903747559
Epoch: 2, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
Validation loss decreased (-0.964073 --> -0.975443).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0187048
	speed: 0.0718s/iter; left time: 2898.7649s
	iters: 200, epoch: 3 | loss: 0.0470434
	speed: 0.0207s/iter; left time: 834.4717s
	iters: 300, epoch: 3 | loss: 0.0124196
	speed: 0.0206s/iter; left time: 829.5728s
	iters: 400, epoch: 3 | loss: 0.0763189
	speed: 0.0209s/iter; left time: 836.2701s
Epoch: 3 cost time: 8.91837453842163
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0071965
	speed: 0.0718s/iter; left time: 2870.8502s
	iters: 200, epoch: 4 | loss: 0.0528589
	speed: 0.0196s/iter; left time: 781.6729s
	iters: 300, epoch: 4 | loss: 0.0023533
	speed: 0.0202s/iter; left time: 804.9309s
	iters: 400, epoch: 4 | loss: 0.0086478
	speed: 0.0201s/iter; left time: 797.3653s
Epoch: 4 cost time: 8.732741117477417
Epoch: 4, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.053 Vali Acc: 0.980 Test Loss: 0.053 Test Acc: 0.980
Validation loss decreased (-0.975443 --> -0.979536).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0032919
	speed: 0.0721s/iter; left time: 2852.1973s
	iters: 200, epoch: 5 | loss: 0.1382717
	speed: 0.0189s/iter; left time: 747.4159s
	iters: 300, epoch: 5 | loss: 0.0005076
	speed: 0.0185s/iter; left time: 726.5355s
	iters: 400, epoch: 5 | loss: 0.0137785
	speed: 0.0193s/iter; left time: 756.7030s
Epoch: 5 cost time: 8.104148864746094
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0060748
	speed: 0.0645s/iter; left time: 2525.5353s
	iters: 200, epoch: 6 | loss: 0.0067868
	speed: 0.0192s/iter; left time: 750.2888s
	iters: 300, epoch: 6 | loss: 0.0098911
	speed: 0.0193s/iter; left time: 750.1914s
	iters: 400, epoch: 6 | loss: 0.0030978
	speed: 0.0201s/iter; left time: 781.5036s
Epoch: 6 cost time: 8.425392866134644
Epoch: 6, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0001005
	speed: 0.0646s/iter; left time: 2499.6021s
	iters: 200, epoch: 7 | loss: 0.0000164
	speed: 0.0204s/iter; left time: 788.5524s
	iters: 300, epoch: 7 | loss: 0.0011578
	speed: 0.0215s/iter; left time: 829.8709s
	iters: 400, epoch: 7 | loss: 0.0000391
	speed: 0.0201s/iter; left time: 772.4301s
Epoch: 7 cost time: 8.948507308959961
Epoch: 7, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0740460
	speed: 0.0666s/iter; left time: 2553.0286s
	iters: 200, epoch: 8 | loss: 0.0069477
	speed: 0.0210s/iter; left time: 801.4637s
	iters: 300, epoch: 8 | loss: 0.0028833
	speed: 0.0211s/iter; left time: 802.5099s
	iters: 400, epoch: 8 | loss: 0.0231687
	speed: 0.0217s/iter; left time: 826.0883s
Epoch: 8 cost time: 9.144226789474487
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0037480
	speed: 0.0632s/iter; left time: 2395.3769s
	iters: 200, epoch: 9 | loss: 0.0034911
	speed: 0.0204s/iter; left time: 771.0643s
	iters: 300, epoch: 9 | loss: 0.0000036
	speed: 0.0204s/iter; left time: 770.2107s
	iters: 400, epoch: 9 | loss: 0.0000089
	speed: 0.0208s/iter; left time: 783.7745s
Epoch: 9 cost time: 8.806846857070923
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0004584
	speed: 0.0667s/iter; left time: 2498.3362s
	iters: 200, epoch: 10 | loss: 0.0001710
	speed: 0.0209s/iter; left time: 782.1788s
	iters: 300, epoch: 10 | loss: 0.0005425
	speed: 0.0204s/iter; left time: 758.9639s
	iters: 400, epoch: 10 | loss: 0.0043682
	speed: 0.0198s/iter; left time: 736.7100s
Epoch: 10 cost time: 8.851374864578247
Epoch: 10, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.979536 --> -0.980900).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0355725
	speed: 0.0684s/iter; left time: 2533.8052s
	iters: 200, epoch: 11 | loss: 0.0002421
	speed: 0.0185s/iter; left time: 683.7472s
	iters: 300, epoch: 11 | loss: 0.0000018
	speed: 0.0184s/iter; left time: 678.9000s
	iters: 400, epoch: 11 | loss: 0.0003006
	speed: 0.0194s/iter; left time: 712.2007s
Epoch: 11 cost time: 8.15338134765625
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000416
	speed: 0.0688s/iter; left time: 2521.8785s
	iters: 200, epoch: 12 | loss: 0.0043220
	speed: 0.0189s/iter; left time: 690.7224s
	iters: 300, epoch: 12 | loss: 0.0006573
	speed: 0.0191s/iter; left time: 696.0732s
	iters: 400, epoch: 12 | loss: 0.0036829
	speed: 0.0200s/iter; left time: 726.9969s
Epoch: 12 cost time: 8.355870485305786
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000098
	speed: 0.0695s/iter; left time: 2518.2601s
	iters: 200, epoch: 13 | loss: 0.0001363
	speed: 0.0198s/iter; left time: 715.9146s
	iters: 300, epoch: 13 | loss: 0.0015856
	speed: 0.0208s/iter; left time: 748.1254s
	iters: 400, epoch: 13 | loss: 0.0000532
	speed: 0.0220s/iter; left time: 791.9771s
Epoch: 13 cost time: 8.942595720291138
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0007254
	speed: 0.0701s/iter; left time: 2512.8930s
	iters: 200, epoch: 14 | loss: 0.0000881
	speed: 0.0217s/iter; left time: 774.8520s
	iters: 300, epoch: 14 | loss: 0.0005166
	speed: 0.0210s/iter; left time: 748.6080s
	iters: 400, epoch: 14 | loss: 0.0009758
	speed: 0.0204s/iter; left time: 725.2076s
Epoch: 14 cost time: 9.138130187988281
Epoch: 14, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000085
	speed: 0.0701s/iter; left time: 2481.2655s
	iters: 200, epoch: 15 | loss: 0.0000066
	speed: 0.0210s/iter; left time: 741.6985s
	iters: 300, epoch: 15 | loss: 0.0000019
	speed: 0.0212s/iter; left time: 746.3564s
	iters: 400, epoch: 15 | loss: 0.0000130
	speed: 0.0203s/iter; left time: 712.1026s
Epoch: 15 cost time: 8.892781496047974
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0006753
	speed: 0.0668s/iter; left time: 2338.3259s
	iters: 200, epoch: 16 | loss: 0.0000009
	speed: 0.0221s/iter; left time: 771.4601s
	iters: 300, epoch: 16 | loss: 0.0000515
	speed: 0.0207s/iter; left time: 718.9022s
	iters: 400, epoch: 16 | loss: 0.0001568
	speed: 0.0200s/iter; left time: 695.2654s
Epoch: 16 cost time: 8.984985589981079
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000041
	speed: 0.0699s/iter; left time: 2417.9444s
	iters: 200, epoch: 17 | loss: 0.0000091
	speed: 0.0191s/iter; left time: 659.0251s
	iters: 300, epoch: 17 | loss: 0.1254601
	speed: 0.0209s/iter; left time: 717.5652s
	iters: 400, epoch: 17 | loss: 0.0000043
	speed: 0.0204s/iter; left time: 698.7126s
Epoch: 17 cost time: 8.605547904968262
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
Validation loss decreased (-0.980900 --> -0.981354).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000571
	speed: 0.0674s/iter; left time: 2304.7780s
	iters: 200, epoch: 18 | loss: 0.0000058
	speed: 0.0203s/iter; left time: 690.1821s
	iters: 300, epoch: 18 | loss: 0.0000062
	speed: 0.0206s/iter; left time: 699.6539s
	iters: 400, epoch: 18 | loss: 0.0000221
	speed: 0.0201s/iter; left time: 680.8756s
Epoch: 18 cost time: 8.659608364105225
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 2313.5083s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0201s/iter; left time: 676.6727s
	iters: 300, epoch: 19 | loss: 0.0195763
	speed: 0.0220s/iter; left time: 738.1336s
	iters: 400, epoch: 19 | loss: 0.0000138
	speed: 0.0211s/iter; left time: 707.7856s
Epoch: 19 cost time: 8.917911767959595
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000024
	speed: 0.0678s/iter; left time: 2261.1394s
	iters: 200, epoch: 20 | loss: 0.0000108
	speed: 0.0210s/iter; left time: 697.6016s
	iters: 300, epoch: 20 | loss: 0.0000036
	speed: 0.0219s/iter; left time: 726.8947s
	iters: 400, epoch: 20 | loss: 0.0001469
	speed: 0.0215s/iter; left time: 711.8466s
Epoch: 20 cost time: 9.266398668289185
Epoch: 20, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.981354 --> -0.983173).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0003478
	speed: 0.0684s/iter; left time: 2252.8181s
	iters: 200, epoch: 21 | loss: 0.0091818
	speed: 0.0210s/iter; left time: 688.8870s
	iters: 300, epoch: 21 | loss: 0.0000223
	speed: 0.0213s/iter; left time: 696.9923s
	iters: 400, epoch: 21 | loss: 0.0000005
	speed: 0.0209s/iter; left time: 683.7956s
Epoch: 21 cost time: 9.06560730934143
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.0692s/iter; left time: 2249.9546s
	iters: 200, epoch: 22 | loss: 0.0798438
	speed: 0.0215s/iter; left time: 698.4009s
	iters: 300, epoch: 22 | loss: 0.0000015
	speed: 0.0210s/iter; left time: 680.1230s
	iters: 400, epoch: 22 | loss: 0.0011001
	speed: 0.0203s/iter; left time: 655.3294s
Epoch: 22 cost time: 9.030671119689941
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.168 Vali Acc: 0.976 Test Loss: 0.168 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000205
	speed: 0.0696s/iter; left time: 2236.5189s
	iters: 200, epoch: 23 | loss: 0.0000003
	speed: 0.0194s/iter; left time: 621.2970s
	iters: 300, epoch: 23 | loss: 0.0023972
	speed: 0.0198s/iter; left time: 632.4344s
	iters: 400, epoch: 23 | loss: 0.0000004
	speed: 0.0199s/iter; left time: 631.7695s
Epoch: 23 cost time: 8.52393651008606
Epoch: 23, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000052
	speed: 0.0702s/iter; left time: 2226.0167s
	iters: 200, epoch: 24 | loss: 0.0000085
	speed: 0.0195s/iter; left time: 616.6890s
	iters: 300, epoch: 24 | loss: 0.0000010
	speed: 0.0198s/iter; left time: 624.3091s
	iters: 400, epoch: 24 | loss: 0.0000010
	speed: 0.0193s/iter; left time: 607.3228s
Epoch: 24 cost time: 8.47939395904541
Epoch: 24, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0002412
	speed: 0.0678s/iter; left time: 2120.3498s
	iters: 200, epoch: 25 | loss: 0.0454242
	speed: 0.0177s/iter; left time: 551.4126s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.0211s/iter; left time: 655.8332s
	iters: 400, epoch: 25 | loss: 0.0000919
	speed: 0.0215s/iter; left time: 665.8151s
Epoch: 25 cost time: 8.574910163879395
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000004
	speed: 0.0660s/iter; left time: 2037.0285s
	iters: 200, epoch: 26 | loss: 0.0000009
	speed: 0.0217s/iter; left time: 667.9246s
	iters: 300, epoch: 26 | loss: 0.0021486
	speed: 0.0221s/iter; left time: 678.1915s
	iters: 400, epoch: 26 | loss: 0.0002955
	speed: 0.0215s/iter; left time: 658.7225s
Epoch: 26 cost time: 9.427260875701904
Epoch: 26, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.120 Vali Acc: 0.982 Test Loss: 0.120 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0024678
	speed: 0.0676s/iter; left time: 2059.0682s
	iters: 200, epoch: 27 | loss: 0.0000004
	speed: 0.0210s/iter; left time: 638.7942s
	iters: 300, epoch: 27 | loss: 0.0000006
	speed: 0.0216s/iter; left time: 653.4830s
	iters: 400, epoch: 27 | loss: 0.0000002
	speed: 0.0227s/iter; left time: 685.2845s
Epoch: 27 cost time: 9.323091268539429
Epoch: 27, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.982 Test Loss: 0.130 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000002
	speed: 0.0690s/iter; left time: 2072.7695s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 633.4362s
	iters: 300, epoch: 28 | loss: 0.0000007
	speed: 0.0221s/iter; left time: 659.9369s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0204s/iter; left time: 607.8165s
Epoch: 28 cost time: 9.125772476196289
Epoch: 28, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.985 Test Loss: 0.110 Test Acc: 0.985
Validation loss decreased (-0.983173 --> -0.984537).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.0648s/iter; left time: 1920.5447s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 619.8612s
	iters: 300, epoch: 29 | loss: 0.0000004
	speed: 0.0208s/iter; left time: 613.6088s
	iters: 400, epoch: 29 | loss: 0.0066749
	speed: 0.0206s/iter; left time: 603.8968s
Epoch: 29 cost time: 8.74792742729187
Epoch: 29, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.971 Test Loss: 0.198 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000006
	speed: 0.0759s/iter; left time: 2217.8629s
	iters: 200, epoch: 30 | loss: 0.0000476
	speed: 0.0200s/iter; left time: 581.1504s
	iters: 300, epoch: 30 | loss: 0.0000840
	speed: 0.0200s/iter; left time: 580.1029s
	iters: 400, epoch: 30 | loss: 0.0000082
	speed: 0.0204s/iter; left time: 589.3714s
Epoch: 30 cost time: 8.833771228790283
Epoch: 30, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0037914
	speed: 0.0739s/iter; left time: 2127.7000s
	iters: 200, epoch: 31 | loss: 0.0000117
	speed: 0.0199s/iter; left time: 571.2728s
	iters: 300, epoch: 31 | loss: 0.0044551
	speed: 0.0197s/iter; left time: 564.7251s
	iters: 400, epoch: 31 | loss: 0.0000020
	speed: 0.0194s/iter; left time: 553.6488s
Epoch: 31 cost time: 8.578131437301636
Epoch: 31, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.149 Vali Acc: 0.976 Test Loss: 0.149 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 2012.6742s
	iters: 200, epoch: 32 | loss: 0.0000054
	speed: 0.0198s/iter; left time: 561.0965s
	iters: 300, epoch: 32 | loss: 0.0000044
	speed: 0.0202s/iter; left time: 570.0586s
	iters: 400, epoch: 32 | loss: 0.0000006
	speed: 0.0194s/iter; left time: 543.7577s
Epoch: 32 cost time: 8.712896585464478
Epoch: 32, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.985 Test Loss: 0.091 Test Acc: 0.985
Validation loss decreased (-0.984537 --> -0.984538).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0000006
	speed: 0.0725s/iter; left time: 2029.8679s
	iters: 200, epoch: 33 | loss: 0.0000728
	speed: 0.0212s/iter; left time: 590.4757s
	iters: 300, epoch: 33 | loss: 0.0658240
	speed: 0.0206s/iter; left time: 571.6596s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 584.2116s
Epoch: 33 cost time: 9.039479732513428
Epoch: 33, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0000002
	speed: 0.0692s/iter; left time: 1908.6629s
	iters: 200, epoch: 34 | loss: 0.0000026
	speed: 0.0222s/iter; left time: 610.2962s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0234s/iter; left time: 640.0735s
	iters: 400, epoch: 34 | loss: 0.0002747
	speed: 0.0226s/iter; left time: 617.0835s
Epoch: 34 cost time: 9.680482387542725
Epoch: 34, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0000477
	speed: 0.0673s/iter; left time: 1829.0066s
	iters: 200, epoch: 35 | loss: 0.0793623
	speed: 0.0207s/iter; left time: 559.3096s
	iters: 300, epoch: 35 | loss: 0.0327072
	speed: 0.0198s/iter; left time: 534.6226s
	iters: 400, epoch: 35 | loss: 0.0000197
	speed: 0.0201s/iter; left time: 540.7176s
Epoch: 35 cost time: 8.881407737731934
Epoch: 35, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.982 Test Loss: 0.101 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0003389
	speed: 0.0657s/iter; left time: 1758.2978s
	iters: 200, epoch: 36 | loss: 0.0001372
	speed: 0.0193s/iter; left time: 513.7908s
	iters: 300, epoch: 36 | loss: 0.0000212
	speed: 0.0195s/iter; left time: 517.0706s
	iters: 400, epoch: 36 | loss: 0.0000088
	speed: 0.0202s/iter; left time: 535.2629s
Epoch: 36 cost time: 8.430248498916626
Epoch: 36, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.976 Test Loss: 0.177 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 1721.2739s
	iters: 200, epoch: 37 | loss: 0.0000736
	speed: 0.0202s/iter; left time: 528.8846s
	iters: 300, epoch: 37 | loss: 0.0000004
	speed: 0.0212s/iter; left time: 553.9888s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 540.9597s
Epoch: 37 cost time: 8.780879497528076
Epoch: 37, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.980 Test Loss: 0.185 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0000147
	speed: 0.0640s/iter; left time: 1660.0531s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0210s/iter; left time: 542.5518s
	iters: 300, epoch: 38 | loss: 0.0004327
	speed: 0.0210s/iter; left time: 539.0225s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0211s/iter; left time: 541.6969s
Epoch: 38 cost time: 9.028080224990845
Epoch: 38, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.152 Vali Acc: 0.983 Test Loss: 0.152 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0006690
	speed: 0.0662s/iter; left time: 1687.3939s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0200s/iter; left time: 507.9390s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 536.7667s
	iters: 400, epoch: 39 | loss: 0.0000005
	speed: 0.0201s/iter; left time: 506.9359s
Epoch: 39 cost time: 8.87363076210022
Epoch: 39, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.983 Test Loss: 0.159 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.0684s/iter; left time: 1717.1602s
	iters: 200, epoch: 40 | loss: 0.0005723
	speed: 0.0204s/iter; left time: 508.6532s
	iters: 300, epoch: 40 | loss: 0.0000001
	speed: 0.0199s/iter; left time: 495.1029s
	iters: 400, epoch: 40 | loss: 0.0000001
	speed: 0.0211s/iter; left time: 523.2095s
Epoch: 40 cost time: 8.842729806900024
Epoch: 40, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.982 Test Loss: 0.168 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 1697.5568s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 510.2284s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 519.4521s
	iters: 400, epoch: 41 | loss: 0.0000005
	speed: 0.0208s/iter; left time: 506.6445s
Epoch: 41 cost time: 9.06428599357605
Epoch: 41, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.981 Test Loss: 0.143 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0000027
	speed: 0.0764s/iter; left time: 1855.0650s
	iters: 200, epoch: 42 | loss: 0.0000001
	speed: 0.0196s/iter; left time: 472.8624s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0199s/iter; left time: 477.9386s
	iters: 400, epoch: 42 | loss: 0.0009855
	speed: 0.0210s/iter; left time: 504.3011s
Epoch: 42 cost time: 8.761975049972534
Epoch: 42, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.976 Test Loss: 0.226 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 80910
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8216109
	speed: 0.0375s/iter; left time: 1545.7544s
	iters: 200, epoch: 1 | loss: 0.3408017
	speed: 0.0208s/iter; left time: 855.7491s
	iters: 300, epoch: 1 | loss: 0.1062980
	speed: 0.0209s/iter; left time: 855.3099s
	iters: 400, epoch: 1 | loss: 0.1182072
	speed: 0.0206s/iter; left time: 841.6603s
Epoch: 1 cost time: 10.260957956314087
Epoch: 1, Steps: 413 | Train Loss: 0.645 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
Validation loss decreased (inf --> -0.959526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0463837
	speed: 0.0657s/iter; left time: 2678.0100s
	iters: 200, epoch: 2 | loss: 0.0617940
	speed: 0.0208s/iter; left time: 846.9408s
	iters: 300, epoch: 2 | loss: 0.0522097
	speed: 0.0203s/iter; left time: 822.8211s
	iters: 400, epoch: 2 | loss: 0.0803792
	speed: 0.0214s/iter; left time: 868.0318s
Epoch: 2 cost time: 8.92477798461914
Epoch: 2, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.959526 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0272175
	speed: 0.0675s/iter; left time: 2724.4201s
	iters: 200, epoch: 3 | loss: 0.1510754
	speed: 0.0200s/iter; left time: 806.0910s
	iters: 300, epoch: 3 | loss: 0.0304241
	speed: 0.0212s/iter; left time: 851.0953s
	iters: 400, epoch: 3 | loss: 0.0341354
	speed: 0.0203s/iter; left time: 812.8624s
Epoch: 3 cost time: 8.850743770599365
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.057 Vali Acc: 0.979 Test Loss: 0.057 Test Acc: 0.979
Validation loss decreased (-0.970440 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0164719
	speed: 0.0661s/iter; left time: 2640.9744s
	iters: 200, epoch: 4 | loss: 0.0079471
	speed: 0.0219s/iter; left time: 871.3352s
	iters: 300, epoch: 4 | loss: 0.0049785
	speed: 0.0201s/iter; left time: 800.9900s
	iters: 400, epoch: 4 | loss: 0.0171522
	speed: 0.0218s/iter; left time: 866.4917s
Epoch: 4 cost time: 9.108688116073608
Epoch: 4, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.069 Vali Acc: 0.975 Test Loss: 0.069 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0053662
	speed: 0.0647s/iter; left time: 2559.1859s
	iters: 200, epoch: 5 | loss: 0.0948542
	speed: 0.0189s/iter; left time: 747.3424s
	iters: 300, epoch: 5 | loss: 0.0003748
	speed: 0.0196s/iter; left time: 771.6483s
	iters: 400, epoch: 5 | loss: 0.0038801
	speed: 0.0196s/iter; left time: 768.2367s
Epoch: 5 cost time: 8.28918170928955
Epoch: 5, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.964 Test Loss: 0.110 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0140844
	speed: 0.0679s/iter; left time: 2657.7852s
	iters: 200, epoch: 6 | loss: 0.0071533
	speed: 0.0186s/iter; left time: 725.8879s
	iters: 300, epoch: 6 | loss: 0.0106558
	speed: 0.0184s/iter; left time: 716.4875s
	iters: 400, epoch: 6 | loss: 0.0004614
	speed: 0.0183s/iter; left time: 710.4030s
Epoch: 6 cost time: 8.065419435501099
Epoch: 6, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
Validation loss decreased (-0.978626 --> -0.979081).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0001501
	speed: 0.0694s/iter; left time: 2686.1320s
	iters: 200, epoch: 7 | loss: 0.0008609
	speed: 0.0190s/iter; left time: 733.8474s
	iters: 300, epoch: 7 | loss: 0.0001672
	speed: 0.0183s/iter; left time: 706.3610s
	iters: 400, epoch: 7 | loss: 0.0009094
	speed: 0.0183s/iter; left time: 704.0390s
Epoch: 7 cost time: 8.245397806167603
Epoch: 7, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1034625
	speed: 0.0665s/iter; left time: 2546.6399s
	iters: 200, epoch: 8 | loss: 0.0020775
	speed: 0.0190s/iter; left time: 726.2082s
	iters: 300, epoch: 8 | loss: 0.0158310
	speed: 0.0203s/iter; left time: 774.3817s
	iters: 400, epoch: 8 | loss: 0.0005352
	speed: 0.0216s/iter; left time: 821.6506s
Epoch: 8 cost time: 8.710336685180664
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0536116
	speed: 0.0673s/iter; left time: 2549.2290s
	iters: 200, epoch: 9 | loss: 0.1558967
	speed: 0.0202s/iter; left time: 762.6337s
	iters: 300, epoch: 9 | loss: 0.0000954
	speed: 0.0206s/iter; left time: 777.5486s
	iters: 400, epoch: 9 | loss: 0.0000413
	speed: 0.0208s/iter; left time: 782.0961s
Epoch: 9 cost time: 8.751405239105225
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0115836
	speed: 0.0667s/iter; left time: 2499.7311s
	iters: 200, epoch: 10 | loss: 0.0000896
	speed: 0.0203s/iter; left time: 758.8203s
	iters: 300, epoch: 10 | loss: 0.0002463
	speed: 0.0211s/iter; left time: 786.0993s
	iters: 400, epoch: 10 | loss: 0.0015198
	speed: 0.0209s/iter; left time: 777.6210s
Epoch: 10 cost time: 8.94635820388794
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0188668
	speed: 0.0636s/iter; left time: 2357.0550s
	iters: 200, epoch: 11 | loss: 0.0006422
	speed: 0.0210s/iter; left time: 777.0410s
	iters: 300, epoch: 11 | loss: 0.0009562
	speed: 0.0202s/iter; left time: 746.6010s
	iters: 400, epoch: 11 | loss: 0.0128165
	speed: 0.0207s/iter; left time: 760.8630s
Epoch: 11 cost time: 8.87455940246582
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000554
	speed: 0.0653s/iter; left time: 2394.1382s
	iters: 200, epoch: 12 | loss: 0.0002796
	speed: 0.0202s/iter; left time: 737.4282s
	iters: 300, epoch: 12 | loss: 0.0000462
	speed: 0.0198s/iter; left time: 721.5365s
	iters: 400, epoch: 12 | loss: 0.1033219
	speed: 0.0203s/iter; left time: 738.2361s
Epoch: 12 cost time: 8.498286008834839
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.979081 --> -0.981354).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000420
	speed: 0.0639s/iter; left time: 2314.4305s
	iters: 200, epoch: 13 | loss: 0.0002487
	speed: 0.0195s/iter; left time: 705.5646s
	iters: 300, epoch: 13 | loss: 0.0014745
	speed: 0.0193s/iter; left time: 697.3091s
	iters: 400, epoch: 13 | loss: 0.0000604
	speed: 0.0189s/iter; left time: 680.4695s
Epoch: 13 cost time: 8.202144145965576
Epoch: 13, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0089821
	speed: 0.0656s/iter; left time: 2351.5281s
	iters: 200, epoch: 14 | loss: 0.0000039
	speed: 0.0194s/iter; left time: 692.2652s
	iters: 300, epoch: 14 | loss: 0.0000062
	speed: 0.0210s/iter; left time: 746.6126s
	iters: 400, epoch: 14 | loss: 0.0000719
	speed: 0.0204s/iter; left time: 726.4074s
Epoch: 14 cost time: 8.609029054641724
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0006423
	speed: 0.0684s/iter; left time: 2423.4931s
	iters: 200, epoch: 15 | loss: 0.0000180
	speed: 0.0210s/iter; left time: 740.2666s
	iters: 300, epoch: 15 | loss: 0.0000003
	speed: 0.0206s/iter; left time: 725.1947s
	iters: 400, epoch: 15 | loss: 0.0000195
	speed: 0.0201s/iter; left time: 706.5357s
Epoch: 15 cost time: 8.886775016784668
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.159 Vali Acc: 0.971 Test Loss: 0.159 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0001376
	speed: 0.0687s/iter; left time: 2406.0668s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0192s/iter; left time: 670.6188s
	iters: 300, epoch: 16 | loss: 0.0001914
	speed: 0.0198s/iter; left time: 688.6868s
	iters: 400, epoch: 16 | loss: 0.0002904
	speed: 0.0207s/iter; left time: 717.4890s
Epoch: 16 cost time: 8.50832462310791
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.167 Vali Acc: 0.970 Test Loss: 0.167 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000009
	speed: 0.0694s/iter; left time: 2401.8822s
	iters: 200, epoch: 17 | loss: 0.0000595
	speed: 0.0209s/iter; left time: 719.3099s
	iters: 300, epoch: 17 | loss: 0.0000563
	speed: 0.0209s/iter; left time: 717.2864s
	iters: 400, epoch: 17 | loss: 0.0000056
	speed: 0.0201s/iter; left time: 688.8874s
Epoch: 17 cost time: 8.845365285873413
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000914
	speed: 0.0693s/iter; left time: 2369.1015s
	iters: 200, epoch: 18 | loss: 0.0000414
	speed: 0.0202s/iter; left time: 688.2379s
	iters: 300, epoch: 18 | loss: 0.0000813
	speed: 0.0195s/iter; left time: 661.3242s
	iters: 400, epoch: 18 | loss: 0.0001271
	speed: 0.0199s/iter; left time: 673.5418s
Epoch: 18 cost time: 8.694079160690308
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000003
	speed: 0.0764s/iter; left time: 2580.5758s
	iters: 200, epoch: 19 | loss: 0.0000004
	speed: 0.0188s/iter; left time: 633.4847s
	iters: 300, epoch: 19 | loss: 0.0005739
	speed: 0.0188s/iter; left time: 630.4016s
	iters: 400, epoch: 19 | loss: 0.0073832
	speed: 0.0194s/iter; left time: 650.0863s
Epoch: 19 cost time: 8.38242793083191
Epoch: 19, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
Validation loss decreased (-0.981354 --> -0.982264).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000851
	speed: 0.0688s/iter; left time: 2296.3459s
	iters: 200, epoch: 20 | loss: 0.0000096
	speed: 0.0183s/iter; left time: 608.1380s
	iters: 300, epoch: 20 | loss: 0.0000165
	speed: 0.0192s/iter; left time: 634.9796s
	iters: 400, epoch: 20 | loss: 0.0004046
	speed: 0.0174s/iter; left time: 574.2760s
Epoch: 20 cost time: 8.045189142227173
Epoch: 20, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000252
	speed: 0.0614s/iter; left time: 2021.2336s
	iters: 200, epoch: 21 | loss: 0.0001657
	speed: 0.0201s/iter; left time: 658.9218s
	iters: 300, epoch: 21 | loss: 0.0018152
	speed: 0.0187s/iter; left time: 611.1310s
	iters: 400, epoch: 21 | loss: 0.0097410
	speed: 0.0205s/iter; left time: 669.3104s
Epoch: 21 cost time: 8.547966957092285
Epoch: 21, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000027
	speed: 0.0632s/iter; left time: 2055.9904s
	iters: 200, epoch: 22 | loss: 0.0002305
	speed: 0.0203s/iter; left time: 656.6944s
	iters: 300, epoch: 22 | loss: 0.0000007
	speed: 0.0200s/iter; left time: 646.3228s
	iters: 400, epoch: 22 | loss: 0.0000042
	speed: 0.0209s/iter; left time: 672.6023s
Epoch: 22 cost time: 8.65764594078064
Epoch: 22, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.278 Vali Acc: 0.956 Test Loss: 0.278 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0003480
	speed: 0.0617s/iter; left time: 1982.5133s
	iters: 200, epoch: 23 | loss: 0.0000055
	speed: 0.0193s/iter; left time: 617.7670s
	iters: 300, epoch: 23 | loss: 0.0018554
	speed: 0.0187s/iter; left time: 598.2208s
	iters: 400, epoch: 23 | loss: 0.0000006
	speed: 0.0182s/iter; left time: 578.1883s
Epoch: 23 cost time: 8.006611108779907
Epoch: 23, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000194
	speed: 0.0575s/iter; left time: 1821.3237s
	iters: 200, epoch: 24 | loss: 0.0000002
	speed: 0.0184s/iter; left time: 579.9460s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.0194s/iter; left time: 609.6992s
	iters: 400, epoch: 24 | loss: 0.0000015
	speed: 0.0204s/iter; left time: 639.5219s
Epoch: 24 cost time: 8.475998401641846
Epoch: 24, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000147
	speed: 0.0628s/iter; left time: 1964.6556s
	iters: 200, epoch: 25 | loss: 0.0000228
	speed: 0.0189s/iter; left time: 590.7188s
	iters: 300, epoch: 25 | loss: 0.1650665
	speed: 0.0190s/iter; left time: 589.6948s
	iters: 400, epoch: 25 | loss: 0.0000010
	speed: 0.0191s/iter; left time: 590.6316s
Epoch: 25 cost time: 8.33875846862793
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0001662
	speed: 0.0611s/iter; left time: 1886.4736s
	iters: 200, epoch: 26 | loss: 0.0000065
	speed: 0.0186s/iter; left time: 571.3843s
	iters: 300, epoch: 26 | loss: 0.0000263
	speed: 0.0190s/iter; left time: 581.5025s
	iters: 400, epoch: 26 | loss: 0.0000248
	speed: 0.0206s/iter; left time: 629.7554s
Epoch: 26 cost time: 8.192386388778687
Epoch: 26, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000028
	speed: 0.0638s/iter; left time: 1942.3203s
	iters: 200, epoch: 27 | loss: 0.0000006
	speed: 0.0195s/iter; left time: 591.6657s
	iters: 300, epoch: 27 | loss: 0.0000037
	speed: 0.0185s/iter; left time: 559.6038s
	iters: 400, epoch: 27 | loss: 0.0242146
	speed: 0.0205s/iter; left time: 617.1905s
Epoch: 27 cost time: 8.32482624053955
Epoch: 27, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.986 Test Loss: 0.079 Test Acc: 0.986
Validation loss decreased (-0.982264 --> -0.986357).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000166
	speed: 0.0636s/iter; left time: 1909.9202s
	iters: 200, epoch: 28 | loss: 0.0000053
	speed: 0.0203s/iter; left time: 609.3292s
	iters: 300, epoch: 28 | loss: 0.0000002
	speed: 0.0205s/iter; left time: 612.4886s
	iters: 400, epoch: 28 | loss: 0.0001161
	speed: 0.0202s/iter; left time: 600.1412s
Epoch: 28 cost time: 8.724741220474243
Epoch: 28, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000005
	speed: 0.0652s/iter; left time: 1933.5914s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0197s/iter; left time: 583.0257s
	iters: 300, epoch: 29 | loss: 0.0690136
	speed: 0.0203s/iter; left time: 597.6650s
	iters: 400, epoch: 29 | loss: 0.0009529
	speed: 0.0211s/iter; left time: 618.1609s
Epoch: 29 cost time: 8.69140338897705
Epoch: 29, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.0692s/iter; left time: 2023.0792s
	iters: 200, epoch: 30 | loss: 0.0000008
	speed: 0.0204s/iter; left time: 595.1136s
	iters: 300, epoch: 30 | loss: 0.0000042
	speed: 0.0191s/iter; left time: 555.2795s
	iters: 400, epoch: 30 | loss: 0.0000064
	speed: 0.0200s/iter; left time: 578.3386s
Epoch: 30 cost time: 8.589606761932373
Epoch: 30, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0001716
	speed: 0.0704s/iter; left time: 2027.2258s
	iters: 200, epoch: 31 | loss: 0.0000007
	speed: 0.0200s/iter; left time: 573.5542s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0199s/iter; left time: 570.2369s
	iters: 400, epoch: 31 | loss: 0.0018132
	speed: 0.0201s/iter; left time: 572.0571s
Epoch: 31 cost time: 8.700846910476685
Epoch: 31, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0000028
	speed: 0.0720s/iter; left time: 2045.1968s
	iters: 200, epoch: 32 | loss: 0.0000004
	speed: 0.0206s/iter; left time: 582.1901s
	iters: 300, epoch: 32 | loss: 0.0000064
	speed: 0.0191s/iter; left time: 537.7757s
	iters: 400, epoch: 32 | loss: 0.0000168
	speed: 0.0199s/iter; left time: 559.3042s
Epoch: 32 cost time: 8.617070436477661
Epoch: 32, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000004
	speed: 0.0725s/iter; left time: 2028.8517s
	iters: 200, epoch: 33 | loss: 0.0000010
	speed: 0.0203s/iter; left time: 565.2567s
	iters: 300, epoch: 33 | loss: 0.0000007
	speed: 0.0203s/iter; left time: 564.4384s
	iters: 400, epoch: 33 | loss: 0.0000001
	speed: 0.0199s/iter; left time: 551.2823s
Epoch: 33 cost time: 8.743695497512817
Epoch: 33, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.984 Test Loss: 0.094 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000031
	speed: 0.0718s/iter; left time: 1978.8166s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0196s/iter; left time: 537.4959s
	iters: 300, epoch: 34 | loss: 0.0000058
	speed: 0.0196s/iter; left time: 535.9052s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0191s/iter; left time: 520.7503s
Epoch: 34 cost time: 8.453745603561401
Epoch: 34, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000013
	speed: 0.0636s/iter; left time: 1726.0694s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0194s/iter; left time: 526.2893s
	iters: 300, epoch: 35 | loss: 0.0000051
	speed: 0.0201s/iter; left time: 541.3121s
	iters: 400, epoch: 35 | loss: 0.0000250
	speed: 0.0199s/iter; left time: 534.6829s
Epoch: 35 cost time: 8.523133277893066
Epoch: 35, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0000181
	speed: 0.0634s/iter; left time: 1695.7816s
	iters: 200, epoch: 36 | loss: 0.0000038
	speed: 0.0194s/iter; left time: 517.4711s
	iters: 300, epoch: 36 | loss: 0.0279588
	speed: 0.0202s/iter; left time: 536.0798s
	iters: 400, epoch: 36 | loss: 0.0000834
	speed: 0.0203s/iter; left time: 535.6202s
Epoch: 36 cost time: 8.71022653579712
Epoch: 36, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 1647.3102s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0190s/iter; left time: 498.5642s
	iters: 300, epoch: 37 | loss: 0.0000048
	speed: 0.0204s/iter; left time: 532.7083s
	iters: 400, epoch: 37 | loss: 0.0000030
	speed: 0.0197s/iter; left time: 512.3471s
Epoch: 37 cost time: 8.541064739227295
Epoch: 37, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.982 Test Loss: 0.116 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 80910
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1501563
	speed: 0.0359s/iter; left time: 1478.7052s
	iters: 200, epoch: 1 | loss: 0.4471799
	speed: 0.0187s/iter; left time: 770.6096s
	iters: 300, epoch: 1 | loss: 0.1691881
	speed: 0.0178s/iter; left time: 731.0213s
	iters: 400, epoch: 1 | loss: 0.1530921
	speed: 0.0191s/iter; left time: 779.1696s
Epoch: 1 cost time: 9.46477746963501
Epoch: 1, Steps: 413 | Train Loss: 0.775 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
Validation loss decreased (inf --> -0.961345).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0444405
	speed: 0.0666s/iter; left time: 2716.9444s
	iters: 200, epoch: 2 | loss: 0.0573542
	speed: 0.0202s/iter; left time: 823.2032s
	iters: 300, epoch: 2 | loss: 0.0976536
	speed: 0.0189s/iter; left time: 768.2454s
	iters: 400, epoch: 2 | loss: 0.0156155
	speed: 0.0187s/iter; left time: 756.3123s
Epoch: 2 cost time: 8.340134620666504
Epoch: 2, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.961345 --> -0.969531).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0149624
	speed: 0.0634s/iter; left time: 2559.4393s
	iters: 200, epoch: 3 | loss: 0.1852032
	speed: 0.0198s/iter; left time: 799.3836s
	iters: 300, epoch: 3 | loss: 0.0359169
	speed: 0.0201s/iter; left time: 809.1595s
	iters: 400, epoch: 3 | loss: 0.0147636
	speed: 0.0203s/iter; left time: 812.0908s
Epoch: 3 cost time: 8.650060415267944
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.062 Vali Acc: 0.978 Test Loss: 0.062 Test Acc: 0.978
Validation loss decreased (-0.969531 --> -0.978171).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0463244
	speed: 0.0680s/iter; left time: 2715.9100s
	iters: 200, epoch: 4 | loss: 0.0066401
	speed: 0.0210s/iter; left time: 837.0871s
	iters: 300, epoch: 4 | loss: 0.0167698
	speed: 0.0217s/iter; left time: 862.2120s
	iters: 400, epoch: 4 | loss: 0.0084240
	speed: 0.0214s/iter; left time: 848.0183s
Epoch: 4 cost time: 9.219366550445557
Epoch: 4, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.085 Vali Acc: 0.972 Test Loss: 0.085 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0025683
	speed: 0.0644s/iter; left time: 2546.7545s
	iters: 200, epoch: 5 | loss: 0.0028769
	speed: 0.0207s/iter; left time: 816.3237s
	iters: 300, epoch: 5 | loss: 0.0005250
	speed: 0.0193s/iter; left time: 757.9423s
	iters: 400, epoch: 5 | loss: 0.0040666
	speed: 0.0204s/iter; left time: 800.1687s
Epoch: 5 cost time: 8.530452489852905
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0007971
	speed: 0.0648s/iter; left time: 2536.9117s
	iters: 200, epoch: 6 | loss: 0.0017357
	speed: 0.0178s/iter; left time: 695.6810s
	iters: 300, epoch: 6 | loss: 0.0145449
	speed: 0.0199s/iter; left time: 776.7007s
	iters: 400, epoch: 6 | loss: 0.0312820
	speed: 0.0200s/iter; left time: 777.4898s
Epoch: 6 cost time: 8.221258163452148
Epoch: 6, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000799
	speed: 0.0649s/iter; left time: 2511.2084s
	iters: 200, epoch: 7 | loss: 0.0006768
	speed: 0.0195s/iter; left time: 753.5264s
	iters: 300, epoch: 7 | loss: 0.0011064
	speed: 0.0191s/iter; left time: 735.6157s
	iters: 400, epoch: 7 | loss: 0.0001910
	speed: 0.0195s/iter; left time: 749.8981s
Epoch: 7 cost time: 8.332334041595459
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0002083
	speed: 0.0641s/iter; left time: 2456.9383s
	iters: 200, epoch: 8 | loss: 0.0013998
	speed: 0.0179s/iter; left time: 685.1127s
	iters: 300, epoch: 8 | loss: 0.0357748
	speed: 0.0197s/iter; left time: 751.2040s
	iters: 400, epoch: 8 | loss: 0.0033408
	speed: 0.0193s/iter; left time: 734.4672s
Epoch: 8 cost time: 8.127384662628174
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0003845
	speed: 0.0671s/iter; left time: 2543.4147s
	iters: 200, epoch: 9 | loss: 0.0079210
	speed: 0.0194s/iter; left time: 732.9355s
	iters: 300, epoch: 9 | loss: 0.0064830
	speed: 0.0184s/iter; left time: 693.4306s
	iters: 400, epoch: 9 | loss: 0.0003561
	speed: 0.0198s/iter; left time: 744.9348s
Epoch: 9 cost time: 8.315648317337036
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0085241
	speed: 0.0602s/iter; left time: 2255.7280s
	iters: 200, epoch: 10 | loss: 0.0010976
	speed: 0.0198s/iter; left time: 740.0096s
	iters: 300, epoch: 10 | loss: 0.0004822
	speed: 0.0189s/iter; left time: 706.4409s
	iters: 400, epoch: 10 | loss: 0.0120351
	speed: 0.0192s/iter; left time: 712.7010s
Epoch: 10 cost time: 8.371309995651245
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0147689
	speed: 0.0588s/iter; left time: 2178.9797s
	iters: 200, epoch: 11 | loss: 0.0009798
	speed: 0.0178s/iter; left time: 656.6883s
	iters: 300, epoch: 11 | loss: 0.0002284
	speed: 0.0181s/iter; left time: 668.2493s
	iters: 400, epoch: 11 | loss: 0.0007684
	speed: 0.0170s/iter; left time: 625.8597s
Epoch: 11 cost time: 7.815838575363159
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0025440
	speed: 0.0596s/iter; left time: 2183.2092s
	iters: 200, epoch: 12 | loss: 0.0000633
	speed: 0.0199s/iter; left time: 727.1563s
	iters: 300, epoch: 12 | loss: 0.0003908
	speed: 0.0210s/iter; left time: 766.9579s
	iters: 400, epoch: 12 | loss: 0.0000941
	speed: 0.0198s/iter; left time: 720.2462s
Epoch: 12 cost time: 8.480811357498169
Epoch: 12, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000377
	speed: 0.0650s/iter; left time: 2354.5310s
	iters: 200, epoch: 13 | loss: 0.0001747
	speed: 0.0210s/iter; left time: 759.8049s
	iters: 300, epoch: 13 | loss: 0.0000147
	speed: 0.0195s/iter; left time: 703.3546s
	iters: 400, epoch: 13 | loss: 0.0000164
	speed: 0.0199s/iter; left time: 715.2453s
Epoch: 13 cost time: 8.676259279251099
Epoch: 13, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 80910
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0745993
	speed: 0.0373s/iter; left time: 1536.7460s
	iters: 200, epoch: 1 | loss: 0.4823718
	speed: 0.0188s/iter; left time: 774.4692s
	iters: 300, epoch: 1 | loss: 0.2429098
	speed: 0.0193s/iter; left time: 793.1349s
	iters: 400, epoch: 1 | loss: 0.1663620
	speed: 0.0190s/iter; left time: 777.6452s
Epoch: 1 cost time: 9.707833051681519
Epoch: 1, Steps: 413 | Train Loss: 0.747 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (inf --> -0.959980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1863236
	speed: 0.0609s/iter; left time: 2482.4231s
	iters: 200, epoch: 2 | loss: 0.0664333
	speed: 0.0184s/iter; left time: 748.8291s
	iters: 300, epoch: 2 | loss: 0.1055162
	speed: 0.0205s/iter; left time: 831.3948s
	iters: 400, epoch: 2 | loss: 0.2701727
	speed: 0.0202s/iter; left time: 819.8340s
Epoch: 2 cost time: 8.569853782653809
Epoch: 2, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.959980 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0361340
	speed: 0.0585s/iter; left time: 2363.1097s
	iters: 200, epoch: 3 | loss: 0.0402560
	speed: 0.0191s/iter; left time: 771.1408s
	iters: 300, epoch: 3 | loss: 0.0037045
	speed: 0.0187s/iter; left time: 750.3982s
	iters: 400, epoch: 3 | loss: 0.0020744
	speed: 0.0183s/iter; left time: 733.1775s
Epoch: 3 cost time: 8.039223194122314
Epoch: 3, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
Validation loss decreased (-0.970440 --> -0.974078).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0130193
	speed: 0.0596s/iter; left time: 2380.1666s
	iters: 200, epoch: 4 | loss: 0.0636026
	speed: 0.0182s/iter; left time: 725.9939s
	iters: 300, epoch: 4 | loss: 0.0226072
	speed: 0.0184s/iter; left time: 731.4042s
	iters: 400, epoch: 4 | loss: 0.0304054
	speed: 0.0185s/iter; left time: 734.1860s
Epoch: 4 cost time: 7.9852659702301025
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
Validation loss decreased (-0.974078 --> -0.974078).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0406164
	speed: 0.0600s/iter; left time: 2374.0751s
	iters: 200, epoch: 5 | loss: 0.0025066
	speed: 0.0184s/iter; left time: 724.3703s
	iters: 300, epoch: 5 | loss: 0.0102552
	speed: 0.0194s/iter; left time: 764.4877s
	iters: 400, epoch: 5 | loss: 0.0084327
	speed: 0.0194s/iter; left time: 761.7172s
Epoch: 5 cost time: 8.266639709472656
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0123637
	speed: 0.0590s/iter; left time: 2310.5162s
	iters: 200, epoch: 6 | loss: 0.0353941
	speed: 0.0196s/iter; left time: 765.3411s
	iters: 300, epoch: 6 | loss: 0.0673035
	speed: 0.0196s/iter; left time: 763.1487s
	iters: 400, epoch: 6 | loss: 0.0052972
	speed: 0.0196s/iter; left time: 761.2189s
Epoch: 6 cost time: 8.360910415649414
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
Validation loss decreased (-0.974078 --> -0.974988).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0062971
	speed: 0.0601s/iter; left time: 2327.8676s
	iters: 200, epoch: 7 | loss: 0.0043022
	speed: 0.0183s/iter; left time: 706.1795s
	iters: 300, epoch: 7 | loss: 0.0212116
	speed: 0.0195s/iter; left time: 752.6140s
	iters: 400, epoch: 7 | loss: 0.0006229
	speed: 0.0200s/iter; left time: 770.2558s
Epoch: 7 cost time: 8.235239267349243
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
Validation loss decreased (-0.974988 --> -0.978171).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0008701
	speed: 0.0623s/iter; left time: 2387.3780s
	iters: 200, epoch: 8 | loss: 0.0061732
	speed: 0.0185s/iter; left time: 708.2193s
	iters: 300, epoch: 8 | loss: 0.0155250
	speed: 0.0193s/iter; left time: 735.4489s
	iters: 400, epoch: 8 | loss: 0.0115434
	speed: 0.0187s/iter; left time: 709.3606s
Epoch: 8 cost time: 8.147404432296753
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0008923
	speed: 0.0614s/iter; left time: 2325.2276s
	iters: 200, epoch: 9 | loss: 0.0001039
	speed: 0.0187s/iter; left time: 707.2431s
	iters: 300, epoch: 9 | loss: 0.0032843
	speed: 0.0192s/iter; left time: 724.8573s
	iters: 400, epoch: 9 | loss: 0.0008142
	speed: 0.0192s/iter; left time: 723.1651s
Epoch: 9 cost time: 8.098814249038696
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.083 Vali Acc: 0.974 Test Loss: 0.083 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0012364
	speed: 0.0606s/iter; left time: 2273.2874s
	iters: 200, epoch: 10 | loss: 0.0028780
	speed: 0.0178s/iter; left time: 664.6697s
	iters: 300, epoch: 10 | loss: 0.0165282
	speed: 0.0179s/iter; left time: 665.7960s
	iters: 400, epoch: 10 | loss: 0.0030769
	speed: 0.0175s/iter; left time: 649.2520s
Epoch: 10 cost time: 7.600261211395264
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0001603
	speed: 0.0626s/iter; left time: 2320.6068s
	iters: 200, epoch: 11 | loss: 0.0091582
	speed: 0.0167s/iter; left time: 616.5261s
	iters: 300, epoch: 11 | loss: 0.0061616
	speed: 0.0172s/iter; left time: 634.4159s
	iters: 400, epoch: 11 | loss: 0.0059645
	speed: 0.0178s/iter; left time: 654.6514s
Epoch: 11 cost time: 7.5702760219573975
Epoch: 11, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0012217
	speed: 0.0604s/iter; left time: 2213.3108s
	iters: 200, epoch: 12 | loss: 0.0045765
	speed: 0.0189s/iter; left time: 689.3942s
	iters: 300, epoch: 12 | loss: 0.0001046
	speed: 0.0190s/iter; left time: 691.6318s
	iters: 400, epoch: 12 | loss: 0.0019380
	speed: 0.0183s/iter; left time: 666.2357s
Epoch: 12 cost time: 8.003238439559937
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.975 Test Loss: 0.075 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0345626
	speed: 0.0612s/iter; left time: 2219.7548s
	iters: 200, epoch: 13 | loss: 0.0025051
	speed: 0.0192s/iter; left time: 694.5203s
	iters: 300, epoch: 13 | loss: 0.0024949
	speed: 0.0186s/iter; left time: 669.4589s
	iters: 400, epoch: 13 | loss: 0.0001515
	speed: 0.0199s/iter; left time: 714.2052s
Epoch: 13 cost time: 8.191041707992554
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0012095
	speed: 0.0617s/iter; left time: 2212.3168s
	iters: 200, epoch: 14 | loss: 0.0114759
	speed: 0.0200s/iter; left time: 715.8989s
	iters: 300, epoch: 14 | loss: 0.1140114
	speed: 0.0198s/iter; left time: 706.9713s
	iters: 400, epoch: 14 | loss: 0.0001461
	speed: 0.0196s/iter; left time: 697.7647s
Epoch: 14 cost time: 8.474178552627563
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0006638
	speed: 0.0592s/iter; left time: 2096.5804s
	iters: 200, epoch: 15 | loss: 0.0567344
	speed: 0.0195s/iter; left time: 689.2277s
	iters: 300, epoch: 15 | loss: 0.0000110
	speed: 0.0195s/iter; left time: 688.0855s
	iters: 400, epoch: 15 | loss: 0.0000121
	speed: 0.0185s/iter; left time: 650.7211s
Epoch: 15 cost time: 8.209177017211914
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0003393
	speed: 0.0590s/iter; left time: 2066.9967s
	iters: 200, epoch: 16 | loss: 0.0023278
	speed: 0.0192s/iter; left time: 671.0845s
	iters: 300, epoch: 16 | loss: 0.0021111
	speed: 0.0190s/iter; left time: 662.1892s
	iters: 400, epoch: 16 | loss: 0.0005540
	speed: 0.0189s/iter; left time: 656.0598s
Epoch: 16 cost time: 8.215580463409424
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0360740
	speed: 0.0584s/iter; left time: 2018.5247s
	iters: 200, epoch: 17 | loss: 0.0001241
	speed: 0.0175s/iter; left time: 604.1842s
	iters: 300, epoch: 17 | loss: 0.0000116
	speed: 0.0175s/iter; left time: 601.0209s
	iters: 400, epoch: 17 | loss: 0.0000010
	speed: 0.0172s/iter; left time: 588.5285s
Epoch: 17 cost time: 7.532717227935791
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.979535).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0067104
	speed: 0.0598s/iter; left time: 2043.1543s
	iters: 200, epoch: 18 | loss: 0.0022559
	speed: 0.0181s/iter; left time: 616.2942s
	iters: 300, epoch: 18 | loss: 0.0000158
	speed: 0.0174s/iter; left time: 589.8953s
	iters: 400, epoch: 18 | loss: 0.0000006
	speed: 0.0171s/iter; left time: 579.8361s
Epoch: 18 cost time: 7.582040786743164
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0007793
	speed: 0.0596s/iter; left time: 2011.2930s
	iters: 200, epoch: 19 | loss: 0.0006487
	speed: 0.0167s/iter; left time: 561.7462s
	iters: 300, epoch: 19 | loss: 0.0000523
	speed: 0.0176s/iter; left time: 592.1638s
	iters: 400, epoch: 19 | loss: 0.0000044
	speed: 0.0168s/iter; left time: 560.9571s
Epoch: 19 cost time: 7.392286062240601
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979535 --> -0.979990).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0004139
	speed: 0.0600s/iter; left time: 2001.1114s
	iters: 200, epoch: 20 | loss: 0.0001871
	speed: 0.0184s/iter; left time: 610.8692s
	iters: 300, epoch: 20 | loss: 0.0038530
	speed: 0.0185s/iter; left time: 613.5818s
	iters: 400, epoch: 20 | loss: 0.0000300
	speed: 0.0201s/iter; left time: 663.2329s
Epoch: 20 cost time: 8.233545541763306
Epoch: 20, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0001443
	speed: 0.0615s/iter; left time: 2026.4383s
	iters: 200, epoch: 21 | loss: 0.0043244
	speed: 0.0200s/iter; left time: 656.4470s
	iters: 300, epoch: 21 | loss: 0.0022368
	speed: 0.0198s/iter; left time: 647.4992s
	iters: 400, epoch: 21 | loss: 0.0000930
	speed: 0.0206s/iter; left time: 671.9552s
Epoch: 21 cost time: 8.583922624588013
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
Validation loss decreased (-0.979990 --> -0.981809).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000007
	speed: 0.0580s/iter; left time: 1885.0964s
	iters: 200, epoch: 22 | loss: 0.0000113
	speed: 0.0181s/iter; left time: 586.9203s
	iters: 300, epoch: 22 | loss: 0.0000006
	speed: 0.0198s/iter; left time: 640.8352s
	iters: 400, epoch: 22 | loss: 0.0011433
	speed: 0.0191s/iter; left time: 616.1330s
Epoch: 22 cost time: 7.928068161010742
Epoch: 22, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000008
	speed: 0.0629s/iter; left time: 2018.5030s
	iters: 200, epoch: 23 | loss: 0.0020483
	speed: 0.0209s/iter; left time: 670.1748s
	iters: 300, epoch: 23 | loss: 0.0000112
	speed: 0.0205s/iter; left time: 655.1014s
	iters: 400, epoch: 23 | loss: 0.0152532
	speed: 0.0214s/iter; left time: 681.0684s
Epoch: 23 cost time: 8.863717079162598
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.981809 --> -0.982719).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0075178
	speed: 0.0677s/iter; left time: 2145.2565s
	iters: 200, epoch: 24 | loss: 0.0000039
	speed: 0.0189s/iter; left time: 597.2515s
	iters: 300, epoch: 24 | loss: 0.0302118
	speed: 0.0193s/iter; left time: 608.3470s
	iters: 400, epoch: 24 | loss: 0.0000929
	speed: 0.0203s/iter; left time: 636.5509s
Epoch: 24 cost time: 8.766111135482788
Epoch: 24, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000003
	speed: 0.0662s/iter; left time: 2070.8320s
	iters: 200, epoch: 25 | loss: 0.0000003
	speed: 0.0190s/iter; left time: 593.0469s
	iters: 300, epoch: 25 | loss: 0.0000375
	speed: 0.0187s/iter; left time: 581.4265s
	iters: 400, epoch: 25 | loss: 0.0006563
	speed: 0.0201s/iter; left time: 623.2895s
Epoch: 25 cost time: 8.338789463043213
Epoch: 25, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000713
	speed: 0.0604s/iter; left time: 1866.1867s
	iters: 200, epoch: 26 | loss: 0.0000264
	speed: 0.0185s/iter; left time: 569.8323s
	iters: 300, epoch: 26 | loss: 0.0101729
	speed: 0.0180s/iter; left time: 551.4314s
	iters: 400, epoch: 26 | loss: 0.0000010
	speed: 0.0185s/iter; left time: 564.7783s
Epoch: 26 cost time: 7.847702503204346
Epoch: 26, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000006
	speed: 0.0608s/iter; left time: 1850.8217s
	iters: 200, epoch: 27 | loss: 0.0000006
	speed: 0.0191s/iter; left time: 578.5927s
	iters: 300, epoch: 27 | loss: 0.0000208
	speed: 0.0192s/iter; left time: 581.3045s
	iters: 400, epoch: 27 | loss: 0.0000105
	speed: 0.0189s/iter; left time: 568.6235s
Epoch: 27 cost time: 8.1130530834198
Epoch: 27, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000047
	speed: 0.0623s/iter; left time: 1871.5821s
	iters: 200, epoch: 28 | loss: 0.0000226
	speed: 0.0201s/iter; left time: 601.0157s
	iters: 300, epoch: 28 | loss: 0.0000133
	speed: 0.0192s/iter; left time: 571.8478s
	iters: 400, epoch: 28 | loss: 0.0000122
	speed: 0.0195s/iter; left time: 578.8791s
Epoch: 28 cost time: 8.421257257461548
Epoch: 28, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0013268
	speed: 0.0620s/iter; left time: 1838.3331s
	iters: 200, epoch: 29 | loss: 0.0000022
	speed: 0.0194s/iter; left time: 573.9678s
	iters: 300, epoch: 29 | loss: 0.2292222
	speed: 0.0182s/iter; left time: 536.8710s
	iters: 400, epoch: 29 | loss: 0.0006217
	speed: 0.0204s/iter; left time: 599.0732s
Epoch: 29 cost time: 8.43943452835083
Epoch: 29, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000500
	speed: 0.0626s/iter; left time: 1829.5210s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.0196s/iter; left time: 569.7315s
	iters: 300, epoch: 30 | loss: 0.0000015
	speed: 0.0192s/iter; left time: 556.9241s
	iters: 400, epoch: 30 | loss: 0.0000018
	speed: 0.0183s/iter; left time: 528.1853s
Epoch: 30 cost time: 8.219287395477295
Epoch: 30, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000057
	speed: 0.0605s/iter; left time: 1744.0351s
	iters: 200, epoch: 31 | loss: 0.0000147
	speed: 0.0202s/iter; left time: 578.9676s
	iters: 300, epoch: 31 | loss: 0.0007684
	speed: 0.0180s/iter; left time: 516.1906s
	iters: 400, epoch: 31 | loss: 0.0006105
	speed: 0.0171s/iter; left time: 487.0881s
Epoch: 31 cost time: 8.021502256393433
Epoch: 31, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000233
	speed: 0.0594s/iter; left time: 1686.1939s
	iters: 200, epoch: 32 | loss: 0.0002160
	speed: 0.0182s/iter; left time: 515.2663s
	iters: 300, epoch: 32 | loss: 0.0000008
	speed: 0.0182s/iter; left time: 511.9449s
	iters: 400, epoch: 32 | loss: 0.0000001
	speed: 0.0190s/iter; left time: 534.3283s
Epoch: 32 cost time: 8.015000581741333
Epoch: 32, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000088
	speed: 0.0622s/iter; left time: 1740.7335s
	iters: 200, epoch: 33 | loss: 0.0000072
	speed: 0.0188s/iter; left time: 524.0577s
	iters: 300, epoch: 33 | loss: 0.0000192
	speed: 0.0196s/iter; left time: 543.4210s
	iters: 400, epoch: 33 | loss: 0.0160013
	speed: 0.0186s/iter; left time: 514.7479s
Epoch: 33 cost time: 8.241816520690918
Epoch: 33, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 165422
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1414316
	speed: 0.0350s/iter; left time: 1441.0036s
	iters: 200, epoch: 1 | loss: 0.5108688
	speed: 0.0190s/iter; left time: 780.4277s
	iters: 300, epoch: 1 | loss: 0.2466189
	speed: 0.0189s/iter; left time: 776.6836s
	iters: 400, epoch: 1 | loss: 0.1906123
	speed: 0.0192s/iter; left time: 784.0300s
Epoch: 1 cost time: 9.534824848175049
Epoch: 1, Steps: 413 | Train Loss: 0.780 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
Validation loss decreased (inf --> -0.952704).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2051787
	speed: 0.0596s/iter; left time: 2431.5883s
	iters: 200, epoch: 2 | loss: 0.0816484
	speed: 0.0184s/iter; left time: 749.3666s
	iters: 300, epoch: 2 | loss: 0.1212451
	speed: 0.0206s/iter; left time: 835.9596s
	iters: 400, epoch: 2 | loss: 0.1834050
	speed: 0.0180s/iter; left time: 728.6793s
Epoch: 2 cost time: 8.133852005004883
Epoch: 2, Steps: 413 | Train Loss: 0.145 Vali Loss: 0.103 Vali Acc: 0.964 Test Loss: 0.103 Test Acc: 0.964
Validation loss decreased (-0.952704 --> -0.963619).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0268403
	speed: 0.0609s/iter; left time: 2457.2583s
	iters: 200, epoch: 3 | loss: 0.0458490
	speed: 0.0185s/iter; left time: 744.9518s
	iters: 300, epoch: 3 | loss: 0.0050172
	speed: 0.0191s/iter; left time: 769.1142s
	iters: 400, epoch: 3 | loss: 0.0024001
	speed: 0.0193s/iter; left time: 773.2005s
Epoch: 3 cost time: 8.222672700881958
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.963619 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0136545
	speed: 0.0620s/iter; left time: 2477.8111s
	iters: 200, epoch: 4 | loss: 0.0632395
	speed: 0.0189s/iter; left time: 753.5358s
	iters: 300, epoch: 4 | loss: 0.0629569
	speed: 0.0187s/iter; left time: 741.6636s
	iters: 400, epoch: 4 | loss: 0.0253940
	speed: 0.0189s/iter; left time: 750.8923s
Epoch: 4 cost time: 8.09763216972351
Epoch: 4, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.974533).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0149155
	speed: 0.0631s/iter; left time: 2495.8793s
	iters: 200, epoch: 5 | loss: 0.0055515
	speed: 0.0181s/iter; left time: 715.5043s
	iters: 300, epoch: 5 | loss: 0.0450616
	speed: 0.0182s/iter; left time: 715.9426s
	iters: 400, epoch: 5 | loss: 0.0079354
	speed: 0.0174s/iter; left time: 681.0144s
Epoch: 5 cost time: 7.769848823547363
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
Validation loss decreased (-0.974533 --> -0.975897).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0260972
	speed: 0.0630s/iter; left time: 2465.0751s
	iters: 200, epoch: 6 | loss: 0.0513596
	speed: 0.0167s/iter; left time: 651.3973s
	iters: 300, epoch: 6 | loss: 0.0780966
	speed: 0.0179s/iter; left time: 698.4076s
	iters: 400, epoch: 6 | loss: 0.0056018
	speed: 0.0171s/iter; left time: 662.2570s
Epoch: 6 cost time: 7.5867555141448975
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975897 --> -0.976352).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0584006
	speed: 0.0619s/iter; left time: 2396.5618s
	iters: 200, epoch: 7 | loss: 0.0019565
	speed: 0.0180s/iter; left time: 695.0357s
	iters: 300, epoch: 7 | loss: 0.0189771
	speed: 0.0177s/iter; left time: 681.0553s
	iters: 400, epoch: 7 | loss: 0.0006349
	speed: 0.0190s/iter; left time: 729.3320s
Epoch: 7 cost time: 7.889594554901123
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.976352 --> -0.980445).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0019849
	speed: 0.0632s/iter; left time: 2420.0947s
	iters: 200, epoch: 8 | loss: 0.0147707
	speed: 0.0206s/iter; left time: 788.9182s
	iters: 300, epoch: 8 | loss: 0.1006713
	speed: 0.0186s/iter; left time: 708.0195s
	iters: 400, epoch: 8 | loss: 0.0357201
	speed: 0.0203s/iter; left time: 772.7669s
Epoch: 8 cost time: 8.452826023101807
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0472954
	speed: 0.0644s/iter; left time: 2438.8425s
	iters: 200, epoch: 9 | loss: 0.0005438
	speed: 0.0198s/iter; left time: 747.5762s
	iters: 300, epoch: 9 | loss: 0.0325695
	speed: 0.0188s/iter; left time: 710.4226s
	iters: 400, epoch: 9 | loss: 0.0020846
	speed: 0.0194s/iter; left time: 730.5155s
Epoch: 9 cost time: 8.394954442977905
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0019419
	speed: 0.0638s/iter; left time: 2390.3149s
	iters: 200, epoch: 10 | loss: 0.0034687
	speed: 0.0204s/iter; left time: 762.9365s
	iters: 300, epoch: 10 | loss: 0.0017488
	speed: 0.0201s/iter; left time: 747.8148s
	iters: 400, epoch: 10 | loss: 0.0511151
	speed: 0.0202s/iter; left time: 749.7376s
Epoch: 10 cost time: 8.74208664894104
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0064918
	speed: 0.0610s/iter; left time: 2263.0425s
	iters: 200, epoch: 11 | loss: 0.0008851
	speed: 0.0197s/iter; left time: 729.9379s
	iters: 300, epoch: 11 | loss: 0.0010181
	speed: 0.0187s/iter; left time: 689.4120s
	iters: 400, epoch: 11 | loss: 0.0006730
	speed: 0.0181s/iter; left time: 665.7201s
Epoch: 11 cost time: 8.182664394378662
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0136164
	speed: 0.0595s/iter; left time: 2181.9435s
	iters: 200, epoch: 12 | loss: 0.0001901
	speed: 0.0186s/iter; left time: 679.7259s
	iters: 300, epoch: 12 | loss: 0.0000288
	speed: 0.0195s/iter; left time: 710.7800s
	iters: 400, epoch: 12 | loss: 0.0028056
	speed: 0.0191s/iter; left time: 693.5214s
Epoch: 12 cost time: 8.149802207946777
Epoch: 12, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000537
	speed: 0.0582s/iter; left time: 2110.1807s
	iters: 200, epoch: 13 | loss: 0.1116019
	speed: 0.0188s/iter; left time: 680.6434s
	iters: 300, epoch: 13 | loss: 0.0064017
	speed: 0.0186s/iter; left time: 670.6805s
	iters: 400, epoch: 13 | loss: 0.0005646
	speed: 0.0178s/iter; left time: 639.2617s
Epoch: 13 cost time: 7.968142509460449
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0045610
	speed: 0.0620s/iter; left time: 2221.6819s
	iters: 200, epoch: 14 | loss: 0.2770535
	speed: 0.0180s/iter; left time: 643.6894s
	iters: 300, epoch: 14 | loss: 0.1767589
	speed: 0.0204s/iter; left time: 725.4489s
	iters: 400, epoch: 14 | loss: 0.0000269
	speed: 0.0196s/iter; left time: 696.2212s
Epoch: 14 cost time: 8.175981044769287
Epoch: 14, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0024845
	speed: 0.0614s/iter; left time: 2174.0970s
	iters: 200, epoch: 15 | loss: 0.0228247
	speed: 0.0187s/iter; left time: 658.8628s
	iters: 300, epoch: 15 | loss: 0.0001897
	speed: 0.0188s/iter; left time: 662.1321s
	iters: 400, epoch: 15 | loss: 0.0000690
	speed: 0.0187s/iter; left time: 656.5983s
Epoch: 15 cost time: 8.045322179794312
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000654
	speed: 0.0592s/iter; left time: 2073.1042s
	iters: 200, epoch: 16 | loss: 0.0000335
	speed: 0.0196s/iter; left time: 683.7046s
	iters: 300, epoch: 16 | loss: 0.0000350
	speed: 0.0196s/iter; left time: 681.7301s
	iters: 400, epoch: 16 | loss: 0.0000035
	speed: 0.0181s/iter; left time: 629.8043s
Epoch: 16 cost time: 8.266351461410522
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0004564
	speed: 0.0631s/iter; left time: 2183.3225s
	iters: 200, epoch: 17 | loss: 0.0001416
	speed: 0.0186s/iter; left time: 640.2677s
	iters: 300, epoch: 17 | loss: 0.0001142
	speed: 0.0200s/iter; left time: 687.7512s
	iters: 400, epoch: 17 | loss: 0.0000062
	speed: 0.0194s/iter; left time: 665.6145s
Epoch: 17 cost time: 8.420076131820679
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.980900).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0001369
	speed: 0.0599s/iter; left time: 2047.9955s
	iters: 200, epoch: 18 | loss: 0.1128357
	speed: 0.0171s/iter; left time: 582.0228s
	iters: 300, epoch: 18 | loss: 0.0000042
	speed: 0.0196s/iter; left time: 666.5270s
	iters: 400, epoch: 18 | loss: 0.0000140
	speed: 0.0185s/iter; left time: 625.4577s
Epoch: 18 cost time: 7.921864986419678
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000062
	speed: 0.0599s/iter; left time: 2024.1820s
	iters: 200, epoch: 19 | loss: 0.0003250
	speed: 0.0193s/iter; left time: 651.2660s
	iters: 300, epoch: 19 | loss: 0.0000521
	speed: 0.0183s/iter; left time: 613.7224s
	iters: 400, epoch: 19 | loss: 0.0000018
	speed: 0.0188s/iter; left time: 628.0251s
Epoch: 19 cost time: 8.09049391746521
Epoch: 19, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0227320
	speed: 0.0575s/iter; left time: 1919.4575s
	iters: 200, epoch: 20 | loss: 0.0000010
	speed: 0.0194s/iter; left time: 643.5678s
	iters: 300, epoch: 20 | loss: 0.0158066
	speed: 0.0187s/iter; left time: 618.4106s
	iters: 400, epoch: 20 | loss: 0.0034351
	speed: 0.0185s/iter; left time: 613.0766s
Epoch: 20 cost time: 7.987476587295532
Epoch: 20, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000644
	speed: 0.0596s/iter; left time: 1962.0036s
	iters: 200, epoch: 21 | loss: 0.0043316
	speed: 0.0199s/iter; left time: 653.1176s
	iters: 300, epoch: 21 | loss: 0.0000422
	speed: 0.0202s/iter; left time: 662.8098s
	iters: 400, epoch: 21 | loss: 0.0000303
	speed: 0.0207s/iter; left time: 674.3723s
Epoch: 21 cost time: 8.461255550384521
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000062
	speed: 0.0631s/iter; left time: 2052.9876s
	iters: 200, epoch: 22 | loss: 0.0000084
	speed: 0.0203s/iter; left time: 657.3426s
	iters: 300, epoch: 22 | loss: 0.0000002
	speed: 0.0194s/iter; left time: 626.8367s
	iters: 400, epoch: 22 | loss: 0.0000078
	speed: 0.0207s/iter; left time: 667.9023s
Epoch: 22 cost time: 8.672828197479248
Epoch: 22, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000424
	speed: 0.0620s/iter; left time: 1992.3420s
	iters: 200, epoch: 23 | loss: 0.0070621
	speed: 0.0186s/iter; left time: 595.2890s
	iters: 300, epoch: 23 | loss: 0.0000021
	speed: 0.0186s/iter; left time: 594.3518s
	iters: 400, epoch: 23 | loss: 0.0601115
	speed: 0.0194s/iter; left time: 617.3643s
Epoch: 23 cost time: 8.135058641433716
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
Validation loss decreased (-0.980900 --> -0.982264).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0001291
	speed: 0.0635s/iter; left time: 2012.8938s
	iters: 200, epoch: 24 | loss: 0.0000442
	speed: 0.0193s/iter; left time: 609.2085s
	iters: 300, epoch: 24 | loss: 0.0002455
	speed: 0.0185s/iter; left time: 581.5786s
	iters: 400, epoch: 24 | loss: 0.0002514
	speed: 0.0180s/iter; left time: 565.1745s
Epoch: 24 cost time: 8.227819442749023
Epoch: 24, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000005
	speed: 0.0633s/iter; left time: 1980.5949s
	iters: 200, epoch: 25 | loss: 0.0000031
	speed: 0.0178s/iter; left time: 554.7427s
	iters: 300, epoch: 25 | loss: 0.0000015
	speed: 0.0182s/iter; left time: 565.4660s
	iters: 400, epoch: 25 | loss: 0.0037436
	speed: 0.0172s/iter; left time: 533.2120s
Epoch: 25 cost time: 7.804461717605591
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.982719).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0001330
	speed: 0.0620s/iter; left time: 1914.9894s
	iters: 200, epoch: 26 | loss: 0.0006605
	speed: 0.0176s/iter; left time: 540.9262s
	iters: 300, epoch: 26 | loss: 0.0028903
	speed: 0.0182s/iter; left time: 556.8722s
	iters: 400, epoch: 26 | loss: 0.0000004
	speed: 0.0185s/iter; left time: 567.0314s
Epoch: 26 cost time: 7.842930793762207
Epoch: 26, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0000004
	speed: 0.0610s/iter; left time: 1858.0758s
	iters: 200, epoch: 27 | loss: 0.0000501
	speed: 0.0178s/iter; left time: 539.9398s
	iters: 300, epoch: 27 | loss: 0.0000453
	speed: 0.0183s/iter; left time: 554.2591s
	iters: 400, epoch: 27 | loss: 0.0029331
	speed: 0.0181s/iter; left time: 547.2381s
Epoch: 27 cost time: 7.831282377243042
Epoch: 27, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0000371
	speed: 0.0614s/iter; left time: 1845.1803s
	iters: 200, epoch: 28 | loss: 0.0000094
	speed: 0.0191s/iter; left time: 571.3891s
	iters: 300, epoch: 28 | loss: 0.0003268
	speed: 0.0194s/iter; left time: 578.6503s
	iters: 400, epoch: 28 | loss: 0.0000096
	speed: 0.0193s/iter; left time: 574.3271s
Epoch: 28 cost time: 8.356887817382812
Epoch: 28, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0764394
	speed: 0.0610s/iter; left time: 1808.5552s
	iters: 200, epoch: 29 | loss: 0.0000082
	speed: 0.0184s/iter; left time: 543.8896s
	iters: 300, epoch: 29 | loss: 0.0000014
	speed: 0.0188s/iter; left time: 552.7220s
	iters: 400, epoch: 29 | loss: 0.0000005
	speed: 0.0196s/iter; left time: 573.5776s
Epoch: 29 cost time: 8.238669157028198
Epoch: 29, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000213
	speed: 0.0616s/iter; left time: 1798.9491s
	iters: 200, epoch: 30 | loss: 0.0000018
	speed: 0.0185s/iter; left time: 539.5256s
	iters: 300, epoch: 30 | loss: 0.0000006
	speed: 0.0189s/iter; left time: 548.5205s
	iters: 400, epoch: 30 | loss: 0.0000028
	speed: 0.0177s/iter; left time: 511.8042s
Epoch: 30 cost time: 8.110790967941284
Epoch: 30, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0002006
	speed: 0.0613s/iter; left time: 1765.7532s
	iters: 200, epoch: 31 | loss: 0.0000887
	speed: 0.0181s/iter; left time: 519.1183s
	iters: 300, epoch: 31 | loss: 0.0001128
	speed: 0.0194s/iter; left time: 554.8634s
	iters: 400, epoch: 31 | loss: 0.0001457
	speed: 0.0202s/iter; left time: 576.7461s
Epoch: 31 cost time: 8.469348669052124
Epoch: 31, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0000002
	speed: 0.0618s/iter; left time: 1754.7385s
	iters: 200, epoch: 32 | loss: 0.0008058
	speed: 0.0192s/iter; left time: 543.4240s
	iters: 300, epoch: 32 | loss: 0.0000019
	speed: 0.0180s/iter; left time: 507.4420s
	iters: 400, epoch: 32 | loss: 0.0132567
	speed: 0.0186s/iter; left time: 521.4168s
Epoch: 32 cost time: 8.152776718139648
Epoch: 32, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0000168
	speed: 0.0597s/iter; left time: 1669.8273s
	iters: 200, epoch: 33 | loss: 0.0000014
	speed: 0.0186s/iter; left time: 517.9072s
	iters: 300, epoch: 33 | loss: 0.0000031
	speed: 0.0176s/iter; left time: 489.9746s
	iters: 400, epoch: 33 | loss: 0.0000126
	speed: 0.0179s/iter; left time: 495.7055s
Epoch: 33 cost time: 7.929715394973755
Epoch: 33, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.982719 --> -0.983173).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0002689
	speed: 0.0620s/iter; left time: 1710.3486s
	iters: 200, epoch: 34 | loss: 0.0000031
	speed: 0.0175s/iter; left time: 479.7175s
	iters: 300, epoch: 34 | loss: 0.0001920
	speed: 0.0180s/iter; left time: 493.3304s
	iters: 400, epoch: 34 | loss: 0.0000051
	speed: 0.0183s/iter; left time: 499.4819s
Epoch: 34 cost time: 7.833756446838379
Epoch: 34, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0000041
	speed: 0.0634s/iter; left time: 1722.2583s
	iters: 200, epoch: 35 | loss: 0.0000143
	speed: 0.0196s/iter; left time: 529.5101s
	iters: 300, epoch: 35 | loss: 0.0000290
	speed: 0.0198s/iter; left time: 533.2212s
	iters: 400, epoch: 35 | loss: 0.0000004
	speed: 0.0203s/iter; left time: 545.2967s
Epoch: 35 cost time: 8.516990423202515
Epoch: 35, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0000345
	speed: 0.0652s/iter; left time: 1743.3927s
	iters: 200, epoch: 36 | loss: 0.0000031
	speed: 0.0190s/iter; left time: 505.9284s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0201s/iter; left time: 533.4404s
	iters: 400, epoch: 36 | loss: 0.0167254
	speed: 0.0190s/iter; left time: 501.9660s
Epoch: 36 cost time: 8.47548794746399
Epoch: 36, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0000015
	speed: 0.0652s/iter; left time: 1717.6483s
	iters: 200, epoch: 37 | loss: 0.0000596
	speed: 0.0191s/iter; left time: 500.1506s
	iters: 300, epoch: 37 | loss: 0.0003333
	speed: 0.0196s/iter; left time: 513.2464s
	iters: 400, epoch: 37 | loss: 0.0178626
	speed: 0.0192s/iter; left time: 499.1756s
Epoch: 37 cost time: 8.422099351882935
Epoch: 37, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.0142519
	speed: 0.0640s/iter; left time: 1657.6860s
	iters: 200, epoch: 38 | loss: 0.0000406
	speed: 0.0183s/iter; left time: 473.6820s
	iters: 300, epoch: 38 | loss: 0.0000444
	speed: 0.0189s/iter; left time: 486.1538s
	iters: 400, epoch: 38 | loss: 0.0000088
	speed: 0.0191s/iter; left time: 490.3755s
Epoch: 38 cost time: 8.199497699737549
Epoch: 38, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.0000006
	speed: 0.0617s/iter; left time: 1574.7638s
	iters: 200, epoch: 39 | loss: 0.0000014
	speed: 0.0188s/iter; left time: 478.8537s
	iters: 300, epoch: 39 | loss: 0.0007617
	speed: 0.0188s/iter; left time: 475.8696s
	iters: 400, epoch: 39 | loss: 0.0003416
	speed: 0.0188s/iter; left time: 474.8545s
Epoch: 39 cost time: 8.105095624923706
Epoch: 39, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.0001957
	speed: 0.0622s/iter; left time: 1559.5986s
	iters: 200, epoch: 40 | loss: 0.0000002
	speed: 0.0174s/iter; left time: 435.1072s
	iters: 300, epoch: 40 | loss: 0.0000018
	speed: 0.0180s/iter; left time: 448.2429s
	iters: 400, epoch: 40 | loss: 0.0000106
	speed: 0.0182s/iter; left time: 452.1075s
Epoch: 40 cost time: 7.717972040176392
Epoch: 40, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.982 Test Loss: 0.117 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0000009
	speed: 0.0612s/iter; left time: 1509.9742s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0173s/iter; left time: 425.6325s
	iters: 300, epoch: 41 | loss: 0.0000011
	speed: 0.0180s/iter; left time: 439.9327s
	iters: 400, epoch: 41 | loss: 0.0000176
	speed: 0.0172s/iter; left time: 420.0841s
Epoch: 41 cost time: 7.631372451782227
Epoch: 41, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.980 Test Loss: 0.141 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.0000005
	speed: 0.0610s/iter; left time: 1481.0952s
	iters: 200, epoch: 42 | loss: 0.0120611
	speed: 0.0181s/iter; left time: 437.3953s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0187s/iter; left time: 448.9126s
	iters: 400, epoch: 42 | loss: 0.0000007
	speed: 0.0192s/iter; left time: 461.1178s
Epoch: 42 cost time: 8.197598218917847
Epoch: 42, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.986 Test Loss: 0.083 Test Acc: 0.986
Validation loss decreased (-0.983173 --> -0.986357).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.0086979
	speed: 0.0600s/iter; left time: 1432.4073s
	iters: 200, epoch: 43 | loss: 0.0000001
	speed: 0.0181s/iter; left time: 429.6985s
	iters: 300, epoch: 43 | loss: 0.0031809
	speed: 0.0202s/iter; left time: 476.7931s
	iters: 400, epoch: 43 | loss: 0.0000001
	speed: 0.0206s/iter; left time: 485.1815s
Epoch: 43 cost time: 8.403236865997314
Epoch: 43, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
Validation loss decreased (-0.986357 --> -0.987266).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.0650s/iter; left time: 1523.2403s
	iters: 200, epoch: 44 | loss: 0.0000132
	speed: 0.0203s/iter; left time: 474.5495s
	iters: 300, epoch: 44 | loss: 0.0000334
	speed: 0.0189s/iter; left time: 438.8330s
	iters: 400, epoch: 44 | loss: 0.0000001
	speed: 0.0201s/iter; left time: 464.5026s
Epoch: 44 cost time: 8.440664291381836
Epoch: 44, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.981 Test Loss: 0.119 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 0.0009531
	speed: 0.0626s/iter; left time: 1440.9849s
	iters: 200, epoch: 45 | loss: 0.0000004
	speed: 0.0186s/iter; left time: 425.9858s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.0191s/iter; left time: 436.7970s
	iters: 400, epoch: 45 | loss: 0.0000028
	speed: 0.0196s/iter; left time: 445.2865s
Epoch: 45 cost time: 8.278433322906494
Epoch: 45, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.985 Test Loss: 0.095 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 0.0000003
	speed: 0.0615s/iter; left time: 1389.9024s
	iters: 200, epoch: 46 | loss: 0.3068893
	speed: 0.0183s/iter; left time: 412.9491s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.0187s/iter; left time: 419.2905s
	iters: 400, epoch: 46 | loss: 0.0000000
	speed: 0.0189s/iter; left time: 422.3494s
Epoch: 46 cost time: 8.090471506118774
Epoch: 46, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 0.0003528
	speed: 0.0620s/iter; left time: 1376.9860s
	iters: 200, epoch: 47 | loss: 0.0000221
	speed: 0.0169s/iter; left time: 372.6874s
	iters: 300, epoch: 47 | loss: 0.0000298
	speed: 0.0176s/iter; left time: 388.1297s
	iters: 400, epoch: 47 | loss: 0.0000001
	speed: 0.0173s/iter; left time: 378.8062s
Epoch: 47 cost time: 7.538296222686768
Epoch: 47, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 0.0024591
	speed: 0.0623s/iter; left time: 1358.0413s
	iters: 200, epoch: 48 | loss: 0.0000471
	speed: 0.0177s/iter; left time: 383.7196s
	iters: 300, epoch: 48 | loss: 0.0000859
	speed: 0.0179s/iter; left time: 385.8328s
	iters: 400, epoch: 48 | loss: 0.0000061
	speed: 0.0195s/iter; left time: 419.6666s
Epoch: 48 cost time: 7.877100229263306
Epoch: 48, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 49 | loss: 0.0000019
	speed: 0.0627s/iter; left time: 1341.2953s
	iters: 200, epoch: 49 | loss: 0.0000334
	speed: 0.0204s/iter; left time: 433.6362s
	iters: 300, epoch: 49 | loss: 0.0000012
	speed: 0.0193s/iter; left time: 408.9171s
	iters: 400, epoch: 49 | loss: 0.0000080
	speed: 0.0176s/iter; left time: 371.6488s
Epoch: 49 cost time: 8.42994999885559
Epoch: 49, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.983 Test Loss: 0.126 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 50 | loss: 0.0000002
	speed: 0.0627s/iter; left time: 1314.1597s
	iters: 200, epoch: 50 | loss: 0.0000246
	speed: 0.0193s/iter; left time: 403.5995s
	iters: 300, epoch: 50 | loss: 0.0000006
	speed: 0.0194s/iter; left time: 402.6396s
	iters: 400, epoch: 50 | loss: 0.0017588
	speed: 0.0198s/iter; left time: 409.0683s
Epoch: 50 cost time: 8.591630697250366
Epoch: 50, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.985 Test Loss: 0.080 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 51 | loss: 0.0000610
	speed: 0.0644s/iter; left time: 1322.8643s
	iters: 200, epoch: 51 | loss: 0.0000002
	speed: 0.0191s/iter; left time: 390.5721s
	iters: 300, epoch: 51 | loss: 0.0000323
	speed: 0.0197s/iter; left time: 400.3111s
	iters: 400, epoch: 51 | loss: 0.0000041
	speed: 0.0204s/iter; left time: 412.2142s
Epoch: 51 cost time: 8.590193748474121
Epoch: 51, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 52 | loss: 0.0000004
	speed: 0.0633s/iter; left time: 1274.9328s
	iters: 200, epoch: 52 | loss: 0.0000008
	speed: 0.0196s/iter; left time: 392.0415s
	iters: 300, epoch: 52 | loss: 0.0000045
	speed: 0.0197s/iter; left time: 393.2296s
	iters: 400, epoch: 52 | loss: 0.0000000
	speed: 0.0177s/iter; left time: 352.0063s
Epoch: 52 cost time: 8.216732025146484
Epoch: 52, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.985 Test Loss: 0.101 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 53 | loss: 0.0000001
	speed: 0.0631s/iter; left time: 1244.5571s
	iters: 200, epoch: 53 | loss: 0.0000105
	speed: 0.0174s/iter; left time: 342.1987s
	iters: 300, epoch: 53 | loss: 0.0000003
	speed: 0.0173s/iter; left time: 337.1079s
	iters: 400, epoch: 53 | loss: 0.0009342
	speed: 0.0175s/iter; left time: 340.8047s
Epoch: 53 cost time: 7.673044681549072
Epoch: 53, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.148 Vali Acc: 0.979 Test Loss: 0.148 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 165422
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2606202
	speed: 0.0378s/iter; left time: 1556.3839s
	iters: 200, epoch: 1 | loss: 0.5635381
	speed: 0.0188s/iter; left time: 773.3538s
	iters: 300, epoch: 1 | loss: 0.2587262
	speed: 0.0197s/iter; left time: 808.9680s
	iters: 400, epoch: 1 | loss: 0.2066595
	speed: 0.0202s/iter; left time: 826.6153s
Epoch: 1 cost time: 9.99833631515503
Epoch: 1, Steps: 413 | Train Loss: 0.853 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (inf --> -0.944064).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2180000
	speed: 0.0636s/iter; left time: 2594.6013s
	iters: 200, epoch: 2 | loss: 0.0859881
	speed: 0.0194s/iter; left time: 787.7314s
	iters: 300, epoch: 2 | loss: 0.1455534
	speed: 0.0199s/iter; left time: 807.1848s
	iters: 400, epoch: 2 | loss: 0.1775793
	speed: 0.0203s/iter; left time: 823.5484s
Epoch: 2 cost time: 8.46100640296936
Epoch: 2, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.113 Vali Acc: 0.964 Test Loss: 0.113 Test Acc: 0.964
Validation loss decreased (-0.944064 --> -0.963619).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0341650
	speed: 0.0646s/iter; left time: 2609.2828s
	iters: 200, epoch: 3 | loss: 0.0286520
	speed: 0.0199s/iter; left time: 802.7483s
	iters: 300, epoch: 3 | loss: 0.0204500
	speed: 0.0207s/iter; left time: 832.6054s
	iters: 400, epoch: 3 | loss: 0.0038930
	speed: 0.0188s/iter; left time: 755.1587s
Epoch: 3 cost time: 8.52812910079956
Epoch: 3, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.963619 --> -0.972714).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0134341
	speed: 0.0589s/iter; left time: 2355.4518s
	iters: 200, epoch: 4 | loss: 0.0488368
	speed: 0.0192s/iter; left time: 764.4134s
	iters: 300, epoch: 4 | loss: 0.0997847
	speed: 0.0199s/iter; left time: 790.9257s
	iters: 400, epoch: 4 | loss: 0.0808231
	speed: 0.0200s/iter; left time: 792.3789s
Epoch: 4 cost time: 8.469521284103394
Epoch: 4, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.078 Vali Acc: 0.974 Test Loss: 0.078 Test Acc: 0.974
Validation loss decreased (-0.972714 --> -0.973624).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0377034
	speed: 0.0621s/iter; left time: 2455.3395s
	iters: 200, epoch: 5 | loss: 0.0097449
	speed: 0.0200s/iter; left time: 789.9947s
	iters: 300, epoch: 5 | loss: 0.0473417
	speed: 0.0193s/iter; left time: 760.9925s
	iters: 400, epoch: 5 | loss: 0.0211552
	speed: 0.0182s/iter; left time: 714.9417s
Epoch: 5 cost time: 8.192189455032349
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0332671
	speed: 0.0605s/iter; left time: 2366.1041s
	iters: 200, epoch: 6 | loss: 0.0111605
	speed: 0.0196s/iter; left time: 764.7379s
	iters: 300, epoch: 6 | loss: 0.0115816
	speed: 0.0180s/iter; left time: 699.6576s
	iters: 400, epoch: 6 | loss: 0.0063905
	speed: 0.0183s/iter; left time: 711.2101s
Epoch: 6 cost time: 8.1257963180542
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0087920
	speed: 0.0582s/iter; left time: 2252.8650s
	iters: 200, epoch: 7 | loss: 0.0022120
	speed: 0.0192s/iter; left time: 742.2583s
	iters: 300, epoch: 7 | loss: 0.0924789
	speed: 0.0188s/iter; left time: 724.7619s
	iters: 400, epoch: 7 | loss: 0.0011794
	speed: 0.0186s/iter; left time: 715.6325s
Epoch: 7 cost time: 8.13026475906372
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.973624 --> -0.975897).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0001631
	speed: 0.0589s/iter; left time: 2255.9909s
	iters: 200, epoch: 8 | loss: 0.0332002
	speed: 0.0187s/iter; left time: 713.0053s
	iters: 300, epoch: 8 | loss: 0.0005941
	speed: 0.0207s/iter; left time: 789.6534s
	iters: 400, epoch: 8 | loss: 0.0294387
	speed: 0.0190s/iter; left time: 720.8018s
Epoch: 8 cost time: 8.147959232330322
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0243781
	speed: 0.0628s/iter; left time: 2379.5186s
	iters: 200, epoch: 9 | loss: 0.0008508
	speed: 0.0188s/iter; left time: 708.8001s
	iters: 300, epoch: 9 | loss: 0.0135042
	speed: 0.0184s/iter; left time: 692.7779s
	iters: 400, epoch: 9 | loss: 0.0007850
	speed: 0.0191s/iter; left time: 716.6857s
Epoch: 9 cost time: 8.220877408981323
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0043052
	speed: 0.0643s/iter; left time: 2410.8351s
	iters: 200, epoch: 10 | loss: 0.4062148
	speed: 0.0215s/iter; left time: 804.5538s
	iters: 300, epoch: 10 | loss: 0.0056671
	speed: 0.0190s/iter; left time: 709.5642s
	iters: 400, epoch: 10 | loss: 0.0121134
	speed: 0.0200s/iter; left time: 744.3558s
Epoch: 10 cost time: 8.72936749458313
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0047628
	speed: 0.0618s/iter; left time: 2291.5237s
	iters: 200, epoch: 11 | loss: 0.0191320
	speed: 0.0200s/iter; left time: 740.6252s
	iters: 300, epoch: 11 | loss: 0.0714565
	speed: 0.0188s/iter; left time: 694.4193s
	iters: 400, epoch: 11 | loss: 0.0026182
	speed: 0.0197s/iter; left time: 722.9650s
Epoch: 11 cost time: 8.414299011230469
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.087 Vali Acc: 0.971 Test Loss: 0.087 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0007400
	speed: 0.0630s/iter; left time: 2308.6205s
	iters: 200, epoch: 12 | loss: 0.1367494
	speed: 0.0190s/iter; left time: 694.8122s
	iters: 300, epoch: 12 | loss: 0.0006739
	speed: 0.0179s/iter; left time: 654.2725s
	iters: 400, epoch: 12 | loss: 0.0026258
	speed: 0.0185s/iter; left time: 673.5482s
Epoch: 12 cost time: 8.009298324584961
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000181
	speed: 0.0635s/iter; left time: 2300.4768s
	iters: 200, epoch: 13 | loss: 0.1281256
	speed: 0.0174s/iter; left time: 627.7760s
	iters: 300, epoch: 13 | loss: 0.0417418
	speed: 0.0178s/iter; left time: 640.0387s
	iters: 400, epoch: 13 | loss: 0.0144074
	speed: 0.0185s/iter; left time: 666.1433s
Epoch: 13 cost time: 7.76274847984314
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.975897 --> -0.977261).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0003819
	speed: 0.0582s/iter; left time: 2083.7233s
	iters: 200, epoch: 14 | loss: 0.0053113
	speed: 0.0188s/iter; left time: 673.3399s
	iters: 300, epoch: 14 | loss: 0.0484674
	speed: 0.0192s/iter; left time: 683.0735s
	iters: 400, epoch: 14 | loss: 0.0000508
	speed: 0.0193s/iter; left time: 687.0132s
Epoch: 14 cost time: 8.171515226364136
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0026722
	speed: 0.0618s/iter; left time: 2190.4134s
	iters: 200, epoch: 15 | loss: 0.0682125
	speed: 0.0197s/iter; left time: 695.5686s
	iters: 300, epoch: 15 | loss: 0.0625619
	speed: 0.0194s/iter; left time: 681.9251s
	iters: 400, epoch: 15 | loss: 0.0000202
	speed: 0.0203s/iter; left time: 713.3369s
Epoch: 15 cost time: 8.472036361694336
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0011337
	speed: 0.0631s/iter; left time: 2208.2484s
	iters: 200, epoch: 16 | loss: 0.1460446
	speed: 0.0202s/iter; left time: 706.0596s
	iters: 300, epoch: 16 | loss: 0.0012496
	speed: 0.0194s/iter; left time: 674.9206s
	iters: 400, epoch: 16 | loss: 0.0000156
	speed: 0.0203s/iter; left time: 703.7806s
Epoch: 16 cost time: 8.507445335388184
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.977261 --> -0.980445).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0406544
	speed: 0.0633s/iter; left time: 2188.8828s
	iters: 200, epoch: 17 | loss: 0.0002168
	speed: 0.0202s/iter; left time: 697.5938s
	iters: 300, epoch: 17 | loss: 0.0943209
	speed: 0.0208s/iter; left time: 714.9862s
	iters: 400, epoch: 17 | loss: 0.0000235
	speed: 0.0197s/iter; left time: 674.8735s
Epoch: 17 cost time: 8.68393349647522
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1000180
	speed: 0.0630s/iter; left time: 2154.7275s
	iters: 200, epoch: 18 | loss: 0.0029083
	speed: 0.0188s/iter; left time: 641.2528s
	iters: 300, epoch: 18 | loss: 0.0003723
	speed: 0.0200s/iter; left time: 679.2830s
	iters: 400, epoch: 18 | loss: 0.0000048
	speed: 0.0187s/iter; left time: 632.2963s
Epoch: 18 cost time: 8.309982538223267
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000040
	speed: 0.0626s/iter; left time: 2113.6946s
	iters: 200, epoch: 19 | loss: 0.0002181
	speed: 0.0189s/iter; left time: 635.0838s
	iters: 300, epoch: 19 | loss: 0.0007431
	speed: 0.0193s/iter; left time: 649.1393s
	iters: 400, epoch: 19 | loss: 0.0000062
	speed: 0.0182s/iter; left time: 610.7529s
Epoch: 19 cost time: 8.28108263015747
Epoch: 19, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0177542
	speed: 0.0613s/iter; left time: 2045.3022s
	iters: 200, epoch: 20 | loss: 0.0000118
	speed: 0.0184s/iter; left time: 612.9830s
	iters: 300, epoch: 20 | loss: 0.0000040
	speed: 0.0190s/iter; left time: 629.4507s
	iters: 400, epoch: 20 | loss: 0.0000739
	speed: 0.0187s/iter; left time: 617.5007s
Epoch: 20 cost time: 7.9924092292785645
Epoch: 20, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000628
	speed: 0.0597s/iter; left time: 1965.2686s
	iters: 200, epoch: 21 | loss: 0.0002493
	speed: 0.0187s/iter; left time: 615.0789s
	iters: 300, epoch: 21 | loss: 0.0000138
	speed: 0.0188s/iter; left time: 615.8784s
	iters: 400, epoch: 21 | loss: 0.0015236
	speed: 0.0186s/iter; left time: 605.8080s
Epoch: 21 cost time: 7.974318742752075
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000034
	speed: 0.0613s/iter; left time: 1995.0208s
	iters: 200, epoch: 22 | loss: 0.0030361
	speed: 0.0178s/iter; left time: 576.7469s
	iters: 300, epoch: 22 | loss: 0.0000059
	speed: 0.0180s/iter; left time: 582.7104s
	iters: 400, epoch: 22 | loss: 0.0002445
	speed: 0.0194s/iter; left time: 626.4283s
Epoch: 22 cost time: 7.88181209564209
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000534
	speed: 0.0643s/iter; left time: 2066.5205s
	iters: 200, epoch: 23 | loss: 0.0929530
	speed: 0.0202s/iter; left time: 646.9559s
	iters: 300, epoch: 23 | loss: 0.0000043
	speed: 0.0185s/iter; left time: 589.2672s
	iters: 400, epoch: 23 | loss: 0.0209729
	speed: 0.0206s/iter; left time: 655.1844s
Epoch: 23 cost time: 8.497865438461304
Epoch: 23, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0024408
	speed: 0.0617s/iter; left time: 1955.8323s
	iters: 200, epoch: 24 | loss: 0.0000293
	speed: 0.0205s/iter; left time: 648.2588s
	iters: 300, epoch: 24 | loss: 0.0085862
	speed: 0.0197s/iter; left time: 619.3300s
	iters: 400, epoch: 24 | loss: 0.0016953
	speed: 0.0199s/iter; left time: 626.0617s
Epoch: 24 cost time: 8.704983234405518
Epoch: 24, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000047
	speed: 0.0653s/iter; left time: 2042.0890s
	iters: 200, epoch: 25 | loss: 0.0000033
	speed: 0.0188s/iter; left time: 585.4886s
	iters: 300, epoch: 25 | loss: 0.0023236
	speed: 0.0200s/iter; left time: 621.4433s
	iters: 400, epoch: 25 | loss: 0.0768709
	speed: 0.0204s/iter; left time: 632.3881s
Epoch: 25 cost time: 8.551700830459595
Epoch: 25, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0668878
	speed: 0.0624s/iter; left time: 1927.7299s
	iters: 200, epoch: 26 | loss: 0.0003390
	speed: 0.0198s/iter; left time: 610.0141s
	iters: 300, epoch: 26 | loss: 0.0255665
	speed: 0.0188s/iter; left time: 578.0707s
	iters: 400, epoch: 26 | loss: 0.0000009
	speed: 0.0187s/iter; left time: 570.7123s
Epoch: 26 cost time: 8.3545401096344
Epoch: 26, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 165422
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.5565615
	speed: 0.0352s/iter; left time: 1449.4187s
	iters: 200, epoch: 1 | loss: 0.7924536
	speed: 0.0175s/iter; left time: 720.1288s
	iters: 300, epoch: 1 | loss: 0.3214570
	speed: 0.0185s/iter; left time: 758.8550s
	iters: 400, epoch: 1 | loss: 0.2136535
	speed: 0.0173s/iter; left time: 708.9265s
Epoch: 1 cost time: 9.166266441345215
Epoch: 1, Steps: 413 | Train Loss: 1.023 Vali Loss: 0.241 Vali Acc: 0.940 Test Loss: 0.241 Test Acc: 0.940
Validation loss decreased (inf --> -0.940425).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2910969
	speed: 0.0610s/iter; left time: 2487.3649s
	iters: 200, epoch: 2 | loss: 0.0978893
	speed: 0.0189s/iter; left time: 771.0239s
	iters: 300, epoch: 2 | loss: 0.2452579
	speed: 0.0185s/iter; left time: 749.8629s
	iters: 400, epoch: 2 | loss: 0.1642064
	speed: 0.0195s/iter; left time: 791.0106s
Epoch: 2 cost time: 8.08251690864563
Epoch: 2, Steps: 413 | Train Loss: 0.194 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
Validation loss decreased (-0.940425 --> -0.963619).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0567303
	speed: 0.0630s/iter; left time: 2544.9463s
	iters: 200, epoch: 3 | loss: 0.0396956
	speed: 0.0195s/iter; left time: 786.7262s
	iters: 300, epoch: 3 | loss: 0.1428438
	speed: 0.0189s/iter; left time: 758.0649s
	iters: 400, epoch: 3 | loss: 0.0040822
	speed: 0.0195s/iter; left time: 782.3278s
Epoch: 3 cost time: 8.308140754699707
Epoch: 3, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
Validation loss decreased (-0.963619 --> -0.967712).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0084295
	speed: 0.0607s/iter; left time: 2427.3393s
	iters: 200, epoch: 4 | loss: 0.0523028
	speed: 0.0192s/iter; left time: 766.0108s
	iters: 300, epoch: 4 | loss: 0.2002814
	speed: 0.0189s/iter; left time: 750.8953s
	iters: 400, epoch: 4 | loss: 0.1126587
	speed: 0.0192s/iter; left time: 760.5343s
Epoch: 4 cost time: 8.216356992721558
Epoch: 4, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
Validation loss decreased (-0.967712 --> -0.970895).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0370267
	speed: 0.0632s/iter; left time: 2497.9726s
	iters: 200, epoch: 5 | loss: 0.0207544
	speed: 0.0190s/iter; left time: 747.7819s
	iters: 300, epoch: 5 | loss: 0.1799454
	speed: 0.0193s/iter; left time: 760.7923s
	iters: 400, epoch: 5 | loss: 0.0773955
	speed: 0.0192s/iter; left time: 752.1050s
Epoch: 5 cost time: 8.222959756851196
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0432031
	speed: 0.0643s/iter; left time: 2514.9713s
	iters: 200, epoch: 6 | loss: 0.0172650
	speed: 0.0187s/iter; left time: 728.3484s
	iters: 300, epoch: 6 | loss: 0.0449790
	speed: 0.0179s/iter; left time: 697.2779s
	iters: 400, epoch: 6 | loss: 0.0469230
	speed: 0.0179s/iter; left time: 696.2208s
Epoch: 6 cost time: 7.988251686096191
Epoch: 6, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0064808
	speed: 0.0599s/iter; left time: 2320.7734s
	iters: 200, epoch: 7 | loss: 0.0032980
	speed: 0.0176s/iter; left time: 681.6806s
	iters: 300, epoch: 7 | loss: 0.0190933
	speed: 0.0186s/iter; left time: 717.0366s
	iters: 400, epoch: 7 | loss: 0.0047405
	speed: 0.0192s/iter; left time: 736.0536s
Epoch: 7 cost time: 7.918120384216309
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.068 Vali Acc: 0.976 Test Loss: 0.068 Test Acc: 0.976
Validation loss decreased (-0.970895 --> -0.975897).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0001984
	speed: 0.0603s/iter; left time: 2310.3918s
	iters: 200, epoch: 8 | loss: 0.0191825
	speed: 0.0188s/iter; left time: 717.4011s
	iters: 300, epoch: 8 | loss: 0.0011398
	speed: 0.0184s/iter; left time: 700.5811s
	iters: 400, epoch: 8 | loss: 0.0440419
	speed: 0.0189s/iter; left time: 718.8151s
Epoch: 8 cost time: 8.091510772705078
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.065 Vali Acc: 0.979 Test Loss: 0.065 Test Acc: 0.979
Validation loss decreased (-0.975897 --> -0.979081).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0109887
	speed: 0.0597s/iter; left time: 2263.1348s
	iters: 200, epoch: 9 | loss: 0.0003737
	speed: 0.0191s/iter; left time: 722.1304s
	iters: 300, epoch: 9 | loss: 0.1698052
	speed: 0.0191s/iter; left time: 720.6891s
	iters: 400, epoch: 9 | loss: 0.0007224
	speed: 0.0189s/iter; left time: 712.3440s
Epoch: 9 cost time: 8.21887993812561
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0033521
	speed: 0.0616s/iter; left time: 2308.7288s
	iters: 200, epoch: 10 | loss: 0.0270650
	speed: 0.0201s/iter; left time: 752.4124s
	iters: 300, epoch: 10 | loss: 0.0021200
	speed: 0.0195s/iter; left time: 726.3012s
	iters: 400, epoch: 10 | loss: 0.0078694
	speed: 0.0202s/iter; left time: 752.3643s
Epoch: 10 cost time: 8.614529132843018
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0048164
	speed: 0.0605s/iter; left time: 2242.2016s
	iters: 200, epoch: 11 | loss: 0.0229461
	speed: 0.0186s/iter; left time: 688.3113s
	iters: 300, epoch: 11 | loss: 0.0050605
	speed: 0.0196s/iter; left time: 723.9049s
	iters: 400, epoch: 11 | loss: 0.0026159
	speed: 0.0188s/iter; left time: 690.1541s
Epoch: 11 cost time: 8.218480110168457
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0036157
	speed: 0.0627s/iter; left time: 2297.0484s
	iters: 200, epoch: 12 | loss: 0.0007541
	speed: 0.0197s/iter; left time: 718.7656s
	iters: 300, epoch: 12 | loss: 0.0000587
	speed: 0.0196s/iter; left time: 716.3693s
	iters: 400, epoch: 12 | loss: 0.0003887
	speed: 0.0197s/iter; left time: 717.7385s
Epoch: 12 cost time: 8.534950733184814
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.057 Vali Acc: 0.982 Test Loss: 0.057 Test Acc: 0.982
Validation loss decreased (-0.979081 --> -0.982264).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0001490
	speed: 0.0648s/iter; left time: 2347.3228s
	iters: 200, epoch: 13 | loss: 0.0127507
	speed: 0.0197s/iter; left time: 713.5625s
	iters: 300, epoch: 13 | loss: 0.0005679
	speed: 0.0185s/iter; left time: 665.9184s
	iters: 400, epoch: 13 | loss: 0.0053197
	speed: 0.0177s/iter; left time: 637.7558s
Epoch: 13 cost time: 8.214149475097656
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.063 Vali Acc: 0.978 Test Loss: 0.063 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0010199
	speed: 0.0612s/iter; left time: 2192.7259s
	iters: 200, epoch: 14 | loss: 0.0010490
	speed: 0.0182s/iter; left time: 649.7300s
	iters: 300, epoch: 14 | loss: 0.0356467
	speed: 0.0181s/iter; left time: 645.5403s
	iters: 400, epoch: 14 | loss: 0.0007276
	speed: 0.0171s/iter; left time: 607.7070s
Epoch: 14 cost time: 7.712758779525757
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0002533
	speed: 0.0628s/iter; left time: 2222.7330s
	iters: 200, epoch: 15 | loss: 0.1236291
	speed: 0.0179s/iter; left time: 632.8521s
	iters: 300, epoch: 15 | loss: 0.0012640
	speed: 0.0170s/iter; left time: 597.5947s
	iters: 400, epoch: 15 | loss: 0.0000384
	speed: 0.0177s/iter; left time: 620.0457s
Epoch: 15 cost time: 7.705082178115845
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0003711
	speed: 0.0659s/iter; left time: 2305.9826s
	iters: 200, epoch: 16 | loss: 0.0000748
	speed: 0.0169s/iter; left time: 589.9201s
	iters: 300, epoch: 16 | loss: 0.0004619
	speed: 0.0192s/iter; left time: 666.9918s
	iters: 400, epoch: 16 | loss: 0.0000152
	speed: 0.0201s/iter; left time: 697.8634s
Epoch: 16 cost time: 8.0735023021698
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0151362
	speed: 0.0631s/iter; left time: 2183.7993s
	iters: 200, epoch: 17 | loss: 0.0005032
	speed: 0.0198s/iter; left time: 683.4042s
	iters: 300, epoch: 17 | loss: 0.0000676
	speed: 0.0204s/iter; left time: 701.7590s
	iters: 400, epoch: 17 | loss: 0.0378324
	speed: 0.0198s/iter; left time: 678.6772s
Epoch: 17 cost time: 8.61484432220459
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0002817
	speed: 0.0654s/iter; left time: 2234.4480s
	iters: 200, epoch: 18 | loss: 0.0002972
	speed: 0.0190s/iter; left time: 649.0323s
	iters: 300, epoch: 18 | loss: 0.0011577
	speed: 0.0189s/iter; left time: 643.2000s
	iters: 400, epoch: 18 | loss: 0.0000073
	speed: 0.0197s/iter; left time: 669.1000s
Epoch: 18 cost time: 8.487669229507446
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0006239
	speed: 0.0644s/iter; left time: 2175.6358s
	iters: 200, epoch: 19 | loss: 0.0417869
	speed: 0.0191s/iter; left time: 641.5348s
	iters: 300, epoch: 19 | loss: 0.0097176
	speed: 0.0189s/iter; left time: 632.8571s
	iters: 400, epoch: 19 | loss: 0.0000332
	speed: 0.0190s/iter; left time: 635.2986s
Epoch: 19 cost time: 8.405993461608887
Epoch: 19, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0095970
	speed: 0.0600s/iter; left time: 2000.0651s
	iters: 200, epoch: 20 | loss: 0.0000356
	speed: 0.0197s/iter; left time: 656.0128s
	iters: 300, epoch: 20 | loss: 0.0000104
	speed: 0.0190s/iter; left time: 629.1361s
	iters: 400, epoch: 20 | loss: 0.0000335
	speed: 0.0196s/iter; left time: 647.0448s
Epoch: 20 cost time: 8.309461832046509
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0004209
	speed: 0.0586s/iter; left time: 1929.6208s
	iters: 200, epoch: 21 | loss: 0.0015130
	speed: 0.0178s/iter; left time: 583.2764s
	iters: 300, epoch: 21 | loss: 0.0005985
	speed: 0.0172s/iter; left time: 564.0218s
	iters: 400, epoch: 21 | loss: 0.0016686
	speed: 0.0176s/iter; left time: 573.3741s
Epoch: 21 cost time: 7.575345516204834
Epoch: 21, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000446
	speed: 0.0612s/iter; left time: 1989.7847s
	iters: 200, epoch: 22 | loss: 0.0000386
	speed: 0.0172s/iter; left time: 556.3534s
	iters: 300, epoch: 22 | loss: 0.0000002
	speed: 0.0169s/iter; left time: 544.9278s
	iters: 400, epoch: 22 | loss: 0.0000053
	speed: 0.0173s/iter; left time: 558.4496s
Epoch: 22 cost time: 7.523455858230591
Epoch: 22, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 165422
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2067358
	speed: 0.0364s/iter; left time: 1501.5471s
	iters: 200, epoch: 1 | loss: 0.4088983
	speed: 0.0186s/iter; left time: 762.5270s
	iters: 300, epoch: 1 | loss: 0.2469489
	speed: 0.0199s/iter; left time: 815.5631s
	iters: 400, epoch: 1 | loss: 0.0755960
	speed: 0.0193s/iter; left time: 788.6487s
Epoch: 1 cost time: 9.768829345703125
Epoch: 1, Steps: 413 | Train Loss: 0.754 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
Validation loss decreased (inf --> -0.961799).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0437558
	speed: 0.0610s/iter; left time: 2488.2768s
	iters: 200, epoch: 2 | loss: 0.0760956
	speed: 0.0193s/iter; left time: 785.5684s
	iters: 300, epoch: 2 | loss: 0.4863932
	speed: 0.0190s/iter; left time: 772.0739s
	iters: 400, epoch: 2 | loss: 0.3535644
	speed: 0.0195s/iter; left time: 790.8073s
Epoch: 2 cost time: 8.254225254058838
Epoch: 2, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
Validation loss decreased (-0.961799 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0495570
	speed: 0.0630s/iter; left time: 2545.0779s
	iters: 200, epoch: 3 | loss: 0.0551296
	speed: 0.0194s/iter; left time: 780.3999s
	iters: 300, epoch: 3 | loss: 0.0214326
	speed: 0.0196s/iter; left time: 788.3062s
	iters: 400, epoch: 3 | loss: 0.0367683
	speed: 0.0201s/iter; left time: 807.0736s
Epoch: 3 cost time: 8.574708461761475
Epoch: 3, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0089558
	speed: 0.0651s/iter; left time: 2600.7794s
	iters: 200, epoch: 4 | loss: 0.0054577
	speed: 0.0209s/iter; left time: 832.0706s
	iters: 300, epoch: 4 | loss: 0.0098141
	speed: 0.0189s/iter; left time: 751.4505s
	iters: 400, epoch: 4 | loss: 0.0042747
	speed: 0.0189s/iter; left time: 750.6773s
Epoch: 4 cost time: 8.458823680877686
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.970895 --> -0.972714).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0092564
	speed: 0.0617s/iter; left time: 2440.3603s
	iters: 200, epoch: 5 | loss: 0.0287992
	speed: 0.0193s/iter; left time: 760.5819s
	iters: 300, epoch: 5 | loss: 0.0081039
	speed: 0.0175s/iter; left time: 690.5650s
	iters: 400, epoch: 5 | loss: 0.0126667
	speed: 0.0178s/iter; left time: 699.2510s
Epoch: 5 cost time: 7.893158435821533
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
Validation loss decreased (-0.972714 --> -0.975443).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0056465
	speed: 0.0604s/iter; left time: 2363.2719s
	iters: 200, epoch: 6 | loss: 0.0013557
	speed: 0.0195s/iter; left time: 761.8502s
	iters: 300, epoch: 6 | loss: 0.0032561
	speed: 0.0183s/iter; left time: 712.7208s
	iters: 400, epoch: 6 | loss: 0.0232242
	speed: 0.0183s/iter; left time: 710.9836s
Epoch: 6 cost time: 8.018163681030273
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0187561
	speed: 0.0614s/iter; left time: 2376.5323s
	iters: 200, epoch: 7 | loss: 0.0116793
	speed: 0.0181s/iter; left time: 699.6914s
	iters: 300, epoch: 7 | loss: 0.0398448
	speed: 0.0192s/iter; left time: 740.9868s
	iters: 400, epoch: 7 | loss: 0.0265684
	speed: 0.0203s/iter; left time: 781.3615s
Epoch: 7 cost time: 8.12386155128479
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.062 Vali Acc: 0.977 Test Loss: 0.062 Test Acc: 0.977
Validation loss decreased (-0.975443 --> -0.977262).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0035049
	speed: 0.0648s/iter; left time: 2481.5108s
	iters: 200, epoch: 8 | loss: 0.0121014
	speed: 0.0195s/iter; left time: 746.5386s
	iters: 300, epoch: 8 | loss: 0.0016409
	speed: 0.0200s/iter; left time: 763.9144s
	iters: 400, epoch: 8 | loss: 0.0115085
	speed: 0.0192s/iter; left time: 728.9870s
Epoch: 8 cost time: 8.490785598754883
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.058 Vali Acc: 0.980 Test Loss: 0.058 Test Acc: 0.980
Validation loss decreased (-0.977262 --> -0.980445).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0215393
	speed: 0.0610s/iter; left time: 2310.2107s
	iters: 200, epoch: 9 | loss: 0.0003955
	speed: 0.0202s/iter; left time: 763.1671s
	iters: 300, epoch: 9 | loss: 0.0001788
	speed: 0.0202s/iter; left time: 762.5659s
	iters: 400, epoch: 9 | loss: 0.2216738
	speed: 0.0188s/iter; left time: 706.2921s
Epoch: 9 cost time: 8.436818599700928
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0022519
	speed: 0.0609s/iter; left time: 2284.0151s
	iters: 200, epoch: 10 | loss: 0.0003603
	speed: 0.0194s/iter; left time: 723.8608s
	iters: 300, epoch: 10 | loss: 0.0027990
	speed: 0.0189s/iter; left time: 705.7644s
	iters: 400, epoch: 10 | loss: 0.0006419
	speed: 0.0201s/iter; left time: 749.1275s
Epoch: 10 cost time: 8.398016214370728
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0021395
	speed: 0.0644s/iter; left time: 2385.9849s
	iters: 200, epoch: 11 | loss: 0.0026966
	speed: 0.0187s/iter; left time: 690.3302s
	iters: 300, epoch: 11 | loss: 0.0048027
	speed: 0.0185s/iter; left time: 682.4903s
	iters: 400, epoch: 11 | loss: 0.0001281
	speed: 0.0177s/iter; left time: 651.8670s
Epoch: 11 cost time: 8.115681171417236
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.980900).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0503238
	speed: 0.0623s/iter; left time: 2283.9728s
	iters: 200, epoch: 12 | loss: 0.0053102
	speed: 0.0180s/iter; left time: 659.1918s
	iters: 300, epoch: 12 | loss: 0.0026347
	speed: 0.0176s/iter; left time: 640.6596s
	iters: 400, epoch: 12 | loss: 0.0003300
	speed: 0.0180s/iter; left time: 654.9589s
Epoch: 12 cost time: 7.827690124511719
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0012120
	speed: 0.0587s/iter; left time: 2125.9633s
	iters: 200, epoch: 13 | loss: 0.0070787
	speed: 0.0193s/iter; left time: 696.7335s
	iters: 300, epoch: 13 | loss: 0.0011257
	speed: 0.0199s/iter; left time: 716.1396s
	iters: 400, epoch: 13 | loss: 0.0001090
	speed: 0.0186s/iter; left time: 668.9819s
Epoch: 13 cost time: 8.199622631072998
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0001290
	speed: 0.0611s/iter; left time: 2188.1408s
	iters: 200, epoch: 14 | loss: 0.0003233
	speed: 0.0182s/iter; left time: 650.0591s
	iters: 300, epoch: 14 | loss: 0.0000243
	speed: 0.0193s/iter; left time: 686.4719s
	iters: 400, epoch: 14 | loss: 0.0003472
	speed: 0.0193s/iter; left time: 684.0928s
Epoch: 14 cost time: 8.132755279541016
Epoch: 14, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0066447
	speed: 0.0636s/iter; left time: 2253.2376s
	iters: 200, epoch: 15 | loss: 0.0097579
	speed: 0.0194s/iter; left time: 685.5474s
	iters: 300, epoch: 15 | loss: 0.0000174
	speed: 0.0201s/iter; left time: 707.2962s
	iters: 400, epoch: 15 | loss: 0.0004902
	speed: 0.0203s/iter; left time: 713.2568s
Epoch: 15 cost time: 8.627995729446411
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0001240
	speed: 0.0628s/iter; left time: 2196.8673s
	iters: 200, epoch: 16 | loss: 0.0003456
	speed: 0.0200s/iter; left time: 699.4318s
	iters: 300, epoch: 16 | loss: 0.0001321
	speed: 0.0204s/iter; left time: 710.4308s
	iters: 400, epoch: 16 | loss: 0.0000510
	speed: 0.0195s/iter; left time: 677.8453s
Epoch: 16 cost time: 8.62294602394104
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0163479
	speed: 0.0628s/iter; left time: 2171.5060s
	iters: 200, epoch: 17 | loss: 0.0014886
	speed: 0.0193s/iter; left time: 664.3808s
	iters: 300, epoch: 17 | loss: 0.0000110
	speed: 0.0190s/iter; left time: 653.7936s
	iters: 400, epoch: 17 | loss: 0.0529369
	speed: 0.0194s/iter; left time: 666.9423s
Epoch: 17 cost time: 8.292717456817627
Epoch: 17, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
Validation loss decreased (-0.980900 --> -0.981809).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0092269
	speed: 0.0651s/iter; left time: 2225.8805s
	iters: 200, epoch: 18 | loss: 0.0470535
	speed: 0.0186s/iter; left time: 635.4054s
	iters: 300, epoch: 18 | loss: 0.0022791
	speed: 0.0188s/iter; left time: 639.0180s
	iters: 400, epoch: 18 | loss: 0.0004465
	speed: 0.0178s/iter; left time: 604.5223s
Epoch: 18 cost time: 8.005709171295166
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0004209
	speed: 0.0636s/iter; left time: 2146.3542s
	iters: 200, epoch: 19 | loss: 0.0000121
	speed: 0.0177s/iter; left time: 595.9604s
	iters: 300, epoch: 19 | loss: 0.0001452
	speed: 0.0177s/iter; left time: 593.0174s
	iters: 400, epoch: 19 | loss: 0.0000115
	speed: 0.0171s/iter; left time: 573.1761s
Epoch: 19 cost time: 7.605817079544067
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0015639
	speed: 0.0597s/iter; left time: 1990.5424s
	iters: 200, epoch: 20 | loss: 0.0001219
	speed: 0.0177s/iter; left time: 587.2057s
	iters: 300, epoch: 20 | loss: 0.0008777
	speed: 0.0191s/iter; left time: 631.8928s
	iters: 400, epoch: 20 | loss: 0.0000531
	speed: 0.0198s/iter; left time: 655.7236s
Epoch: 20 cost time: 8.062231540679932
Epoch: 20, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000093
	speed: 0.0657s/iter; left time: 2165.7514s
	iters: 200, epoch: 21 | loss: 0.0076351
	speed: 0.0202s/iter; left time: 662.2442s
	iters: 300, epoch: 21 | loss: 0.0001374
	speed: 0.0198s/iter; left time: 649.1051s
	iters: 400, epoch: 21 | loss: 0.0001448
	speed: 0.0201s/iter; left time: 656.5718s
Epoch: 21 cost time: 8.714670181274414
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000530
	speed: 0.0647s/iter; left time: 2105.8892s
	iters: 200, epoch: 22 | loss: 0.0017183
	speed: 0.0197s/iter; left time: 638.9591s
	iters: 300, epoch: 22 | loss: 0.0000048
	speed: 0.0192s/iter; left time: 619.3748s
	iters: 400, epoch: 22 | loss: 0.0000787
	speed: 0.0189s/iter; left time: 608.3777s
Epoch: 22 cost time: 8.332533836364746
Epoch: 22, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.052 Vali Acc: 0.984 Test Loss: 0.052 Test Acc: 0.984
Validation loss decreased (-0.981809 --> -0.983628).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000577
	speed: 0.0611s/iter; left time: 1961.2220s
	iters: 200, epoch: 23 | loss: 0.0000050
	speed: 0.0181s/iter; left time: 579.0670s
	iters: 300, epoch: 23 | loss: 0.0069546
	speed: 0.0196s/iter; left time: 625.1835s
	iters: 400, epoch: 23 | loss: 0.0027220
	speed: 0.0193s/iter; left time: 612.8637s
Epoch: 23 cost time: 8.232561349868774
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0039891
	speed: 0.0627s/iter; left time: 1987.3227s
	iters: 200, epoch: 24 | loss: 0.0005352
	speed: 0.0199s/iter; left time: 628.8494s
	iters: 300, epoch: 24 | loss: 0.0000533
	speed: 0.0187s/iter; left time: 588.1850s
	iters: 400, epoch: 24 | loss: 0.0001275
	speed: 0.0190s/iter; left time: 597.6537s
Epoch: 24 cost time: 8.408067464828491
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000009
	speed: 0.0609s/iter; left time: 1904.7045s
	iters: 200, epoch: 25 | loss: 0.0006038
	speed: 0.0182s/iter; left time: 567.3238s
	iters: 300, epoch: 25 | loss: 0.0003174
	speed: 0.0182s/iter; left time: 566.6810s
	iters: 400, epoch: 25 | loss: 0.0072128
	speed: 0.0186s/iter; left time: 575.1077s
Epoch: 25 cost time: 7.925891160964966
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000568
	speed: 0.0611s/iter; left time: 1885.4726s
	iters: 200, epoch: 26 | loss: 0.1373263
	speed: 0.0175s/iter; left time: 538.8852s
	iters: 300, epoch: 26 | loss: 0.0003581
	speed: 0.0183s/iter; left time: 560.4820s
	iters: 400, epoch: 26 | loss: 0.0001837
	speed: 0.0179s/iter; left time: 547.8361s
Epoch: 26 cost time: 7.880561590194702
Epoch: 26, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000150
	speed: 0.0616s/iter; left time: 1875.4657s
	iters: 200, epoch: 27 | loss: 0.0000341
	speed: 0.0176s/iter; left time: 535.6348s
	iters: 300, epoch: 27 | loss: 0.0000003
	speed: 0.0167s/iter; left time: 504.6884s
	iters: 400, epoch: 27 | loss: 0.0001417
	speed: 0.0175s/iter; left time: 527.9461s
Epoch: 27 cost time: 7.625607490539551
Epoch: 27, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0003914
	speed: 0.0658s/iter; left time: 1977.5104s
	iters: 200, epoch: 28 | loss: 0.0000003
	speed: 0.0180s/iter; left time: 539.7586s
	iters: 300, epoch: 28 | loss: 0.0000045
	speed: 0.0184s/iter; left time: 549.8140s
	iters: 400, epoch: 28 | loss: 0.0000956
	speed: 0.0186s/iter; left time: 552.8639s
Epoch: 28 cost time: 7.945068597793579
Epoch: 28, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000050
	speed: 0.0633s/iter; left time: 1875.2263s
	iters: 200, epoch: 29 | loss: 0.0000647
	speed: 0.0181s/iter; left time: 535.1575s
	iters: 300, epoch: 29 | loss: 0.0005713
	speed: 0.0189s/iter; left time: 556.8661s
	iters: 400, epoch: 29 | loss: 0.0111772
	speed: 0.0197s/iter; left time: 578.2788s
Epoch: 29 cost time: 8.12608289718628
Epoch: 29, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000001
	speed: 0.0639s/iter; left time: 1868.4027s
	iters: 200, epoch: 30 | loss: 0.0061617
	speed: 0.0196s/iter; left time: 569.8549s
	iters: 300, epoch: 30 | loss: 0.0108546
	speed: 0.0190s/iter; left time: 551.0882s
	iters: 400, epoch: 30 | loss: 0.0006396
	speed: 0.0197s/iter; left time: 570.9319s
Epoch: 30 cost time: 8.262352228164673
Epoch: 30, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000084
	speed: 0.0654s/iter; left time: 1883.4899s
	iters: 200, epoch: 31 | loss: 0.0000012
	speed: 0.0197s/iter; left time: 565.6412s
	iters: 300, epoch: 31 | loss: 0.0003801
	speed: 0.0196s/iter; left time: 559.7709s
	iters: 400, epoch: 31 | loss: 0.0324982
	speed: 0.0185s/iter; left time: 527.1674s
Epoch: 31 cost time: 8.31741738319397
Epoch: 31, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000004
	speed: 0.0629s/iter; left time: 1785.4387s
	iters: 200, epoch: 32 | loss: 0.0000010
	speed: 0.0185s/iter; left time: 523.9210s
	iters: 300, epoch: 32 | loss: 0.0000001
	speed: 0.0181s/iter; left time: 509.0206s
	iters: 400, epoch: 32 | loss: 0.0000026
	speed: 0.0183s/iter; left time: 514.3663s
Epoch: 32 cost time: 8.056814193725586
Epoch: 32, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 99886
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3505471
	speed: 0.0357s/iter; left time: 1471.3839s
	iters: 200, epoch: 1 | loss: 0.4465330
	speed: 0.0195s/iter; left time: 801.0104s
	iters: 300, epoch: 1 | loss: 0.2453068
	speed: 0.0187s/iter; left time: 767.6719s
	iters: 400, epoch: 1 | loss: 0.0884025
	speed: 0.0185s/iter; left time: 758.1642s
Epoch: 1 cost time: 9.560537338256836
Epoch: 1, Steps: 413 | Train Loss: 0.789 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (inf --> -0.951794).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0425565
	speed: 0.0576s/iter; left time: 2347.9882s
	iters: 200, epoch: 2 | loss: 0.0748986
	speed: 0.0181s/iter; left time: 736.2750s
	iters: 300, epoch: 2 | loss: 0.5353677
	speed: 0.0159s/iter; left time: 643.3244s
	iters: 400, epoch: 2 | loss: 0.3645478
	speed: 0.0189s/iter; left time: 766.4004s
Epoch: 2 cost time: 7.765195369720459
Epoch: 2, Steps: 413 | Train Loss: 0.148 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.951794 --> -0.967712).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0545610
	speed: 0.0593s/iter; left time: 2392.2916s
	iters: 200, epoch: 3 | loss: 0.0659161
	speed: 0.0177s/iter; left time: 711.2149s
	iters: 300, epoch: 3 | loss: 0.0480746
	speed: 0.0185s/iter; left time: 743.5157s
	iters: 400, epoch: 3 | loss: 0.0519003
	speed: 0.0189s/iter; left time: 757.3004s
Epoch: 3 cost time: 8.01945948600769
Epoch: 3, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
Validation loss decreased (-0.967712 --> -0.972259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0033948
	speed: 0.0561s/iter; left time: 2241.4105s
	iters: 200, epoch: 4 | loss: 0.0046076
	speed: 0.0189s/iter; left time: 753.9392s
	iters: 300, epoch: 4 | loss: 0.0057353
	speed: 0.0193s/iter; left time: 765.7978s
	iters: 400, epoch: 4 | loss: 0.0046444
	speed: 0.0196s/iter; left time: 777.6495s
Epoch: 4 cost time: 8.352014780044556
Epoch: 4, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0063856
	speed: 0.0604s/iter; left time: 2388.7782s
	iters: 200, epoch: 5 | loss: 0.0083420
	speed: 0.0186s/iter; left time: 734.9041s
	iters: 300, epoch: 5 | loss: 0.0157687
	speed: 0.0186s/iter; left time: 732.8815s
	iters: 400, epoch: 5 | loss: 0.0676348
	speed: 0.0197s/iter; left time: 771.8780s
Epoch: 5 cost time: 8.253796100616455
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.972259 --> -0.980445).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0170703
	speed: 0.0650s/iter; left time: 2543.7998s
	iters: 200, epoch: 6 | loss: 0.0008165
	speed: 0.0193s/iter; left time: 752.9139s
	iters: 300, epoch: 6 | loss: 0.0090928
	speed: 0.0195s/iter; left time: 757.7568s
	iters: 400, epoch: 6 | loss: 0.0613175
	speed: 0.0198s/iter; left time: 767.3065s
Epoch: 6 cost time: 8.388701438903809
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0201463
	speed: 0.0631s/iter; left time: 2441.8720s
	iters: 200, epoch: 7 | loss: 0.0306631
	speed: 0.0190s/iter; left time: 735.2722s
	iters: 300, epoch: 7 | loss: 0.0396310
	speed: 0.0196s/iter; left time: 756.8166s
	iters: 400, epoch: 7 | loss: 0.1413367
	speed: 0.0195s/iter; left time: 750.8224s
Epoch: 7 cost time: 8.396406650543213
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0064162
	speed: 0.0625s/iter; left time: 2395.9913s
	iters: 200, epoch: 8 | loss: 0.0249959
	speed: 0.0195s/iter; left time: 746.2614s
	iters: 300, epoch: 8 | loss: 0.0000422
	speed: 0.0192s/iter; left time: 732.5186s
	iters: 400, epoch: 8 | loss: 0.0073795
	speed: 0.0205s/iter; left time: 777.8386s
Epoch: 8 cost time: 8.458162069320679
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0143551
	speed: 0.0626s/iter; left time: 2372.1344s
	iters: 200, epoch: 9 | loss: 0.0002972
	speed: 0.0181s/iter; left time: 685.9749s
	iters: 300, epoch: 9 | loss: 0.0001674
	speed: 0.0177s/iter; left time: 666.3539s
	iters: 400, epoch: 9 | loss: 0.1996251
	speed: 0.0184s/iter; left time: 691.0669s
Epoch: 9 cost time: 7.800495624542236
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0025111
	speed: 0.0623s/iter; left time: 2334.7782s
	iters: 200, epoch: 10 | loss: 0.0018216
	speed: 0.0187s/iter; left time: 699.2089s
	iters: 300, epoch: 10 | loss: 0.0015293
	speed: 0.0201s/iter; left time: 749.5076s
	iters: 400, epoch: 10 | loss: 0.0004508
	speed: 0.0198s/iter; left time: 734.8080s
Epoch: 10 cost time: 8.267845630645752
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.064 Vali Acc: 0.979 Test Loss: 0.064 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0018982
	speed: 0.0625s/iter; left time: 2315.1561s
	iters: 200, epoch: 11 | loss: 0.0057921
	speed: 0.0186s/iter; left time: 689.4118s
	iters: 300, epoch: 11 | loss: 0.0014827
	speed: 0.0198s/iter; left time: 730.6579s
	iters: 400, epoch: 11 | loss: 0.0000175
	speed: 0.0189s/iter; left time: 693.1709s
Epoch: 11 cost time: 8.298578023910522
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0434142
	speed: 0.0627s/iter; left time: 2300.0401s
	iters: 200, epoch: 12 | loss: 0.0003850
	speed: 0.0187s/iter; left time: 683.3472s
	iters: 300, epoch: 12 | loss: 0.0000957
	speed: 0.0193s/iter; left time: 702.8741s
	iters: 400, epoch: 12 | loss: 0.0096552
	speed: 0.0189s/iter; left time: 686.0786s
Epoch: 12 cost time: 8.290140151977539
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.059 Vali Acc: 0.981 Test Loss: 0.059 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.981355).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0090980
	speed: 0.0610s/iter; left time: 2211.7587s
	iters: 200, epoch: 13 | loss: 0.0008880
	speed: 0.0210s/iter; left time: 759.3122s
	iters: 300, epoch: 13 | loss: 0.0029865
	speed: 0.0199s/iter; left time: 717.3074s
	iters: 400, epoch: 13 | loss: 0.0000480
	speed: 0.0195s/iter; left time: 700.8219s
Epoch: 13 cost time: 8.633427858352661
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0002484
	speed: 0.0628s/iter; left time: 2250.7541s
	iters: 200, epoch: 14 | loss: 0.0017966
	speed: 0.0203s/iter; left time: 726.4666s
	iters: 300, epoch: 14 | loss: 0.0000403
	speed: 0.0203s/iter; left time: 722.3889s
	iters: 400, epoch: 14 | loss: 0.0011411
	speed: 0.0189s/iter; left time: 671.8042s
Epoch: 14 cost time: 8.633350372314453
Epoch: 14, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0001386
	speed: 0.0643s/iter; left time: 2277.0643s
	iters: 200, epoch: 15 | loss: 0.0029667
	speed: 0.0189s/iter; left time: 666.4869s
	iters: 300, epoch: 15 | loss: 0.0001461
	speed: 0.0204s/iter; left time: 717.5114s
	iters: 400, epoch: 15 | loss: 0.0210288
	speed: 0.0186s/iter; left time: 653.7647s
Epoch: 15 cost time: 8.291418552398682
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0005211
	speed: 0.0634s/iter; left time: 2218.7310s
	iters: 200, epoch: 16 | loss: 0.0002231
	speed: 0.0175s/iter; left time: 609.5185s
	iters: 300, epoch: 16 | loss: 0.0000449
	speed: 0.0176s/iter; left time: 611.7916s
	iters: 400, epoch: 16 | loss: 0.0000269
	speed: 0.0181s/iter; left time: 628.4893s
Epoch: 16 cost time: 7.7774999141693115
Epoch: 16, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.981355 --> -0.982719).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0010348
	speed: 0.0662s/iter; left time: 2289.7248s
	iters: 200, epoch: 17 | loss: 0.0000329
	speed: 0.0171s/iter; left time: 589.0004s
	iters: 300, epoch: 17 | loss: 0.0001246
	speed: 0.0175s/iter; left time: 602.1282s
	iters: 400, epoch: 17 | loss: 0.0000014
	speed: 0.0175s/iter; left time: 601.2686s
Epoch: 17 cost time: 7.689040660858154
Epoch: 17, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0083482
	speed: 0.0639s/iter; left time: 2183.3978s
	iters: 200, epoch: 18 | loss: 0.0023710
	speed: 0.0178s/iter; left time: 605.3438s
	iters: 300, epoch: 18 | loss: 0.0003640
	speed: 0.0173s/iter; left time: 588.0147s
	iters: 400, epoch: 18 | loss: 0.0012379
	speed: 0.0178s/iter; left time: 603.6133s
Epoch: 18 cost time: 7.695414304733276
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1758279
	speed: 0.0629s/iter; left time: 2123.6541s
	iters: 200, epoch: 19 | loss: 0.0000078
	speed: 0.0186s/iter; left time: 627.3988s
	iters: 300, epoch: 19 | loss: 0.0000082
	speed: 0.0191s/iter; left time: 640.0078s
	iters: 400, epoch: 19 | loss: 0.0001130
	speed: 0.0205s/iter; left time: 686.8989s
Epoch: 19 cost time: 8.4858558177948
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.062 Vali Acc: 0.981 Test Loss: 0.062 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0028794
	speed: 0.0649s/iter; left time: 2163.8033s
	iters: 200, epoch: 20 | loss: 0.0339931
	speed: 0.0191s/iter; left time: 635.3965s
	iters: 300, epoch: 20 | loss: 0.0039063
	speed: 0.0204s/iter; left time: 677.0716s
	iters: 400, epoch: 20 | loss: 0.0000626
	speed: 0.0197s/iter; left time: 650.8974s
Epoch: 20 cost time: 8.48299527168274
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000457
	speed: 0.0635s/iter; left time: 2090.9998s
	iters: 200, epoch: 21 | loss: 0.0007461
	speed: 0.0215s/iter; left time: 705.0049s
	iters: 300, epoch: 21 | loss: 0.0094267
	speed: 0.0205s/iter; left time: 670.7939s
	iters: 400, epoch: 21 | loss: 0.0014444
	speed: 0.0192s/iter; left time: 627.9332s
Epoch: 21 cost time: 8.701595544815063
Epoch: 21, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0009561
	speed: 0.0594s/iter; left time: 1931.8485s
	iters: 200, epoch: 22 | loss: 0.0012992
	speed: 0.0196s/iter; left time: 636.0429s
	iters: 300, epoch: 22 | loss: 0.0000660
	speed: 0.0188s/iter; left time: 607.4406s
	iters: 400, epoch: 22 | loss: 0.0110037
	speed: 0.0177s/iter; left time: 570.6922s
Epoch: 22 cost time: 8.191002607345581
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.063 Vali Acc: 0.982 Test Loss: 0.063 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000061
	speed: 0.0596s/iter; left time: 1914.6960s
	iters: 200, epoch: 23 | loss: 0.0001624
	speed: 0.0188s/iter; left time: 600.4125s
	iters: 300, epoch: 23 | loss: 0.0000072
	speed: 0.0192s/iter; left time: 612.7725s
	iters: 400, epoch: 23 | loss: 0.0000290
	speed: 0.0190s/iter; left time: 604.1162s
Epoch: 23 cost time: 8.123668909072876
Epoch: 23, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0006313
	speed: 0.0622s/iter; left time: 1970.6834s
	iters: 200, epoch: 24 | loss: 0.0003057
	speed: 0.0183s/iter; left time: 579.0215s
	iters: 300, epoch: 24 | loss: 0.0001632
	speed: 0.0169s/iter; left time: 533.5749s
	iters: 400, epoch: 24 | loss: 0.0000468
	speed: 0.0191s/iter; left time: 599.6149s
Epoch: 24 cost time: 7.94391942024231
Epoch: 24, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.982719 --> -0.985447).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000129
	speed: 0.0601s/iter; left time: 1879.8359s
	iters: 200, epoch: 25 | loss: 0.6033705
	speed: 0.0189s/iter; left time: 589.0623s
	iters: 300, epoch: 25 | loss: 0.0005408
	speed: 0.0197s/iter; left time: 611.4064s
	iters: 400, epoch: 25 | loss: 0.0033804
	speed: 0.0186s/iter; left time: 577.4786s
Epoch: 25 cost time: 8.22668719291687
Epoch: 25, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000052
	speed: 0.0593s/iter; left time: 1831.9945s
	iters: 200, epoch: 26 | loss: 0.0011433
	speed: 0.0190s/iter; left time: 583.3364s
	iters: 300, epoch: 26 | loss: 0.0003020
	speed: 0.0198s/iter; left time: 606.4485s
	iters: 400, epoch: 26 | loss: 0.0010361
	speed: 0.0207s/iter; left time: 631.7192s
Epoch: 26 cost time: 8.414560079574585
Epoch: 26, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0002552
	speed: 0.0603s/iter; left time: 1836.7652s
	iters: 200, epoch: 27 | loss: 0.0100678
	speed: 0.0198s/iter; left time: 601.4297s
	iters: 300, epoch: 27 | loss: 0.0000025
	speed: 0.0200s/iter; left time: 605.9969s
	iters: 400, epoch: 27 | loss: 0.0007645
	speed: 0.0202s/iter; left time: 608.1490s
Epoch: 27 cost time: 8.51845407485962
Epoch: 27, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0007415
	speed: 0.0630s/iter; left time: 1893.4758s
	iters: 200, epoch: 28 | loss: 0.0000103
	speed: 0.0192s/iter; left time: 574.2007s
	iters: 300, epoch: 28 | loss: 0.0000040
	speed: 0.0190s/iter; left time: 568.2619s
	iters: 400, epoch: 28 | loss: 0.0000053
	speed: 0.0190s/iter; left time: 565.0594s
Epoch: 28 cost time: 8.232594728469849
Epoch: 28, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000018
	speed: 0.0632s/iter; left time: 1873.5565s
	iters: 200, epoch: 29 | loss: 0.0000436
	speed: 0.0197s/iter; left time: 582.8302s
	iters: 300, epoch: 29 | loss: 0.0003246
	speed: 0.0193s/iter; left time: 568.9098s
	iters: 400, epoch: 29 | loss: 0.0001587
	speed: 0.0181s/iter; left time: 531.0587s
Epoch: 29 cost time: 8.206267595291138
Epoch: 29, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.982 Test Loss: 0.107 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000023
	speed: 0.0631s/iter; left time: 1844.4584s
	iters: 200, epoch: 30 | loss: 0.0000187
	speed: 0.0181s/iter; left time: 528.4290s
	iters: 300, epoch: 30 | loss: 0.0005366
	speed: 0.0182s/iter; left time: 528.5936s
	iters: 400, epoch: 30 | loss: 0.0011042
	speed: 0.0179s/iter; left time: 518.7529s
Epoch: 30 cost time: 7.8845062255859375
Epoch: 30, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0020877
	speed: 0.0652s/iter; left time: 1879.1844s
	iters: 200, epoch: 31 | loss: 0.0000001
	speed: 0.0182s/iter; left time: 523.5748s
	iters: 300, epoch: 31 | loss: 0.0004293
	speed: 0.0179s/iter; left time: 513.4076s
	iters: 400, epoch: 31 | loss: 0.0927707
	speed: 0.0178s/iter; left time: 507.3662s
Epoch: 31 cost time: 7.879660129547119
Epoch: 31, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000061
	speed: 0.0669s/iter; left time: 1898.9034s
	iters: 200, epoch: 32 | loss: 0.0000085
	speed: 0.0180s/iter; left time: 508.2471s
	iters: 300, epoch: 32 | loss: 0.0029765
	speed: 0.0187s/iter; left time: 528.5334s
	iters: 400, epoch: 32 | loss: 0.0002664
	speed: 0.0194s/iter; left time: 546.3767s
Epoch: 32 cost time: 8.019956350326538
Epoch: 32, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0005826
	speed: 0.0611s/iter; left time: 1710.5412s
	iters: 200, epoch: 33 | loss: 0.0001591
	speed: 0.0194s/iter; left time: 540.6772s
	iters: 300, epoch: 33 | loss: 0.0028077
	speed: 0.0201s/iter; left time: 558.3109s
	iters: 400, epoch: 33 | loss: 0.0000090
	speed: 0.0179s/iter; left time: 494.7510s
Epoch: 33 cost time: 8.188340425491333
Epoch: 33, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.984 Test Loss: 0.094 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0000003
	speed: 0.0636s/iter; left time: 1753.1836s
	iters: 200, epoch: 34 | loss: 0.0000192
	speed: 0.0194s/iter; left time: 534.0901s
	iters: 300, epoch: 34 | loss: 0.0012311
	speed: 0.0206s/iter; left time: 563.7924s
	iters: 400, epoch: 34 | loss: 0.0045815
	speed: 0.0199s/iter; left time: 541.4260s
Epoch: 34 cost time: 8.590322732925415
Epoch: 34, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.984 Test Loss: 0.090 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 99886
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4925098
	speed: 0.0321s/iter; left time: 1323.2147s
	iters: 200, epoch: 1 | loss: 0.5079588
	speed: 0.0186s/iter; left time: 763.3341s
	iters: 300, epoch: 1 | loss: 0.2921546
	speed: 0.0197s/iter; left time: 806.4816s
	iters: 400, epoch: 1 | loss: 0.1153789
	speed: 0.0198s/iter; left time: 809.9378s
Epoch: 1 cost time: 9.338099241256714
Epoch: 1, Steps: 413 | Train Loss: 0.859 Vali Loss: 0.204 Vali Acc: 0.946 Test Loss: 0.204 Test Acc: 0.946
Validation loss decreased (inf --> -0.945882).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0695540
	speed: 0.0623s/iter; left time: 2542.0618s
	iters: 200, epoch: 2 | loss: 0.1088157
	speed: 0.0197s/iter; left time: 801.2442s
	iters: 300, epoch: 2 | loss: 0.4609859
	speed: 0.0186s/iter; left time: 753.8286s
	iters: 400, epoch: 2 | loss: 0.3877171
	speed: 0.0188s/iter; left time: 762.6597s
Epoch: 2 cost time: 8.246513843536377
Epoch: 2, Steps: 413 | Train Loss: 0.161 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
Validation loss decreased (-0.945882 --> -0.964983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0695814
	speed: 0.0621s/iter; left time: 2507.2830s
	iters: 200, epoch: 3 | loss: 0.0954711
	speed: 0.0182s/iter; left time: 733.3637s
	iters: 300, epoch: 3 | loss: 0.0278836
	speed: 0.0184s/iter; left time: 737.6956s
	iters: 400, epoch: 3 | loss: 0.0960028
	speed: 0.0181s/iter; left time: 725.3913s
Epoch: 3 cost time: 7.876648902893066
Epoch: 3, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.088 Vali Acc: 0.971 Test Loss: 0.088 Test Acc: 0.971
Validation loss decreased (-0.964983 --> -0.970895).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0047446
	speed: 0.0616s/iter; left time: 2462.8424s
	iters: 200, epoch: 4 | loss: 0.0047950
	speed: 0.0172s/iter; left time: 684.6170s
	iters: 300, epoch: 4 | loss: 0.0071408
	speed: 0.0181s/iter; left time: 719.8978s
	iters: 400, epoch: 4 | loss: 0.0028616
	speed: 0.0183s/iter; left time: 727.1636s
Epoch: 4 cost time: 7.766615390777588
Epoch: 4, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
Validation loss decreased (-0.970895 --> -0.974988).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0057278
	speed: 0.0623s/iter; left time: 2463.3845s
	iters: 200, epoch: 5 | loss: 0.0165396
	speed: 0.0184s/iter; left time: 727.4812s
	iters: 300, epoch: 5 | loss: 0.0104024
	speed: 0.0205s/iter; left time: 806.5528s
	iters: 400, epoch: 5 | loss: 0.0187414
	speed: 0.0198s/iter; left time: 776.6255s
Epoch: 5 cost time: 8.36868166923523
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.077 Vali Acc: 0.971 Test Loss: 0.077 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2605169
	speed: 0.0648s/iter; left time: 2537.6444s
	iters: 200, epoch: 6 | loss: 0.0026625
	speed: 0.0201s/iter; left time: 785.1510s
	iters: 300, epoch: 6 | loss: 0.0114023
	speed: 0.0187s/iter; left time: 726.3160s
	iters: 400, epoch: 6 | loss: 0.1286869
	speed: 0.0199s/iter; left time: 774.1445s
Epoch: 6 cost time: 8.393516063690186
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1336445
	speed: 0.0627s/iter; left time: 2426.4718s
	iters: 200, epoch: 7 | loss: 0.0090436
	speed: 0.0195s/iter; left time: 751.3148s
	iters: 300, epoch: 7 | loss: 0.0585049
	speed: 0.0207s/iter; left time: 795.9735s
	iters: 400, epoch: 7 | loss: 0.0724820
	speed: 0.0198s/iter; left time: 761.8721s
Epoch: 7 cost time: 8.532562494277954
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
Validation loss decreased (-0.974988 --> -0.974988).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0078047
	speed: 0.0640s/iter; left time: 2453.5608s
	iters: 200, epoch: 8 | loss: 0.0111050
	speed: 0.0207s/iter; left time: 790.9546s
	iters: 300, epoch: 8 | loss: 0.0006577
	speed: 0.0197s/iter; left time: 749.7103s
	iters: 400, epoch: 8 | loss: 0.0051963
	speed: 0.0200s/iter; left time: 762.0597s
Epoch: 8 cost time: 8.649415969848633
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.974988 --> -0.976807).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0210644
	speed: 0.0630s/iter; left time: 2388.2417s
	iters: 200, epoch: 9 | loss: 0.0064749
	speed: 0.0205s/iter; left time: 773.7273s
	iters: 300, epoch: 9 | loss: 0.0007153
	speed: 0.0189s/iter; left time: 710.9059s
	iters: 400, epoch: 9 | loss: 0.0009587
	speed: 0.0180s/iter; left time: 678.2108s
Epoch: 9 cost time: 8.268115282058716
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0012023
	speed: 0.0635s/iter; left time: 2379.0915s
	iters: 200, epoch: 10 | loss: 0.0148728
	speed: 0.0186s/iter; left time: 695.4864s
	iters: 300, epoch: 10 | loss: 0.0028644
	speed: 0.0187s/iter; left time: 697.8063s
	iters: 400, epoch: 10 | loss: 0.0007273
	speed: 0.0187s/iter; left time: 696.2542s
Epoch: 10 cost time: 8.11409592628479
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.976807 --> -0.979535).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0006491
	speed: 0.0610s/iter; left time: 2262.2885s
	iters: 200, epoch: 11 | loss: 0.0402051
	speed: 0.0188s/iter; left time: 694.1309s
	iters: 300, epoch: 11 | loss: 0.0043600
	speed: 0.0179s/iter; left time: 661.4843s
	iters: 400, epoch: 11 | loss: 0.0003464
	speed: 0.0185s/iter; left time: 680.7007s
Epoch: 11 cost time: 7.973068952560425
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0298298
	speed: 0.0619s/iter; left time: 2269.7323s
	iters: 200, epoch: 12 | loss: 0.0029186
	speed: 0.0197s/iter; left time: 718.5165s
	iters: 300, epoch: 12 | loss: 0.0767009
	speed: 0.0197s/iter; left time: 716.7154s
	iters: 400, epoch: 12 | loss: 0.0007825
	speed: 0.0194s/iter; left time: 705.2171s
Epoch: 12 cost time: 8.256494760513306
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0026285
	speed: 0.0654s/iter; left time: 2368.9392s
	iters: 200, epoch: 13 | loss: 0.0058599
	speed: 0.0203s/iter; left time: 732.4705s
	iters: 300, epoch: 13 | loss: 0.0020450
	speed: 0.0198s/iter; left time: 714.1852s
	iters: 400, epoch: 13 | loss: 0.0000334
	speed: 0.0201s/iter; left time: 720.8725s
Epoch: 13 cost time: 8.64408278465271
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0002211
	speed: 0.0627s/iter; left time: 2246.7652s
	iters: 200, epoch: 14 | loss: 0.0014641
	speed: 0.0195s/iter; left time: 697.5882s
	iters: 300, epoch: 14 | loss: 0.0001062
	speed: 0.0196s/iter; left time: 699.7671s
	iters: 400, epoch: 14 | loss: 0.0116019
	speed: 0.0194s/iter; left time: 688.9465s
Epoch: 14 cost time: 8.452808856964111
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0002995
	speed: 0.0647s/iter; left time: 2290.4973s
	iters: 200, epoch: 15 | loss: 0.0017715
	speed: 0.0200s/iter; left time: 706.3449s
	iters: 300, epoch: 15 | loss: 0.0000079
	speed: 0.0185s/iter; left time: 653.1358s
	iters: 400, epoch: 15 | loss: 0.0184551
	speed: 0.0202s/iter; left time: 711.0251s
Epoch: 15 cost time: 8.512468099594116
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1155665
	speed: 0.0627s/iter; left time: 2195.7537s
	iters: 200, epoch: 16 | loss: 0.0013477
	speed: 0.0188s/iter; left time: 657.0195s
	iters: 300, epoch: 16 | loss: 0.0008083
	speed: 0.0184s/iter; left time: 639.5738s
	iters: 400, epoch: 16 | loss: 0.0000415
	speed: 0.0190s/iter; left time: 659.7279s
Epoch: 16 cost time: 8.268404245376587
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0028411
	speed: 0.0626s/iter; left time: 2165.5090s
	iters: 200, epoch: 17 | loss: 0.0000740
	speed: 0.0190s/iter; left time: 654.4428s
	iters: 300, epoch: 17 | loss: 0.0000690
	speed: 0.0190s/iter; left time: 654.0484s
	iters: 400, epoch: 17 | loss: 0.0000033
	speed: 0.0195s/iter; left time: 669.9146s
Epoch: 17 cost time: 8.332328796386719
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0004498
	speed: 0.0624s/iter; left time: 2131.8435s
	iters: 200, epoch: 18 | loss: 0.0053360
	speed: 0.0185s/iter; left time: 631.0611s
	iters: 300, epoch: 18 | loss: 0.0002864
	speed: 0.0187s/iter; left time: 634.6370s
	iters: 400, epoch: 18 | loss: 0.0004492
	speed: 0.0188s/iter; left time: 638.3071s
Epoch: 18 cost time: 8.04089617729187
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0004054
	speed: 0.0636s/iter; left time: 2148.8476s
	iters: 200, epoch: 19 | loss: 0.0009827
	speed: 0.0203s/iter; left time: 682.5096s
	iters: 300, epoch: 19 | loss: 0.0000712
	speed: 0.0197s/iter; left time: 659.9640s
	iters: 400, epoch: 19 | loss: 0.0000498
	speed: 0.0209s/iter; left time: 698.9155s
Epoch: 19 cost time: 8.464420080184937
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0001511
	speed: 0.0641s/iter; left time: 2138.2081s
	iters: 200, epoch: 20 | loss: 0.0103201
	speed: 0.0186s/iter; left time: 619.8190s
	iters: 300, epoch: 20 | loss: 0.0018659
	speed: 0.0208s/iter; left time: 687.9492s
	iters: 400, epoch: 20 | loss: 0.0002494
	speed: 0.0203s/iter; left time: 669.7118s
Epoch: 20 cost time: 8.662066221237183
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979535 --> -0.979990).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0021019
	speed: 0.0642s/iter; left time: 2114.2127s
	iters: 200, epoch: 21 | loss: 0.0037730
	speed: 0.0192s/iter; left time: 631.0407s
	iters: 300, epoch: 21 | loss: 0.0016150
	speed: 0.0196s/iter; left time: 640.3878s
	iters: 400, epoch: 21 | loss: 0.0141937
	speed: 0.0203s/iter; left time: 663.9823s
Epoch: 21 cost time: 8.51256537437439
Epoch: 21, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979990 --> -0.980445).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0005754
	speed: 0.0648s/iter; left time: 2107.8170s
	iters: 200, epoch: 22 | loss: 0.0039102
	speed: 0.0203s/iter; left time: 657.1144s
	iters: 300, epoch: 22 | loss: 0.0000273
	speed: 0.0203s/iter; left time: 655.7404s
	iters: 400, epoch: 22 | loss: 0.0029564
	speed: 0.0197s/iter; left time: 636.1359s
Epoch: 22 cost time: 8.697981119155884
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000004
	speed: 0.0624s/iter; left time: 2004.9010s
	iters: 200, epoch: 23 | loss: 0.0000989
	speed: 0.0181s/iter; left time: 580.1605s
	iters: 300, epoch: 23 | loss: 0.0013815
	speed: 0.0182s/iter; left time: 581.9952s
	iters: 400, epoch: 23 | loss: 0.0450450
	speed: 0.0172s/iter; left time: 546.1704s
Epoch: 23 cost time: 7.734625577926636
Epoch: 23, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0032062
	speed: 0.0641s/iter; left time: 2032.4995s
	iters: 200, epoch: 24 | loss: 0.0000486
	speed: 0.0177s/iter; left time: 558.0830s
	iters: 300, epoch: 24 | loss: 0.0738249
	speed: 0.0178s/iter; left time: 561.8746s
	iters: 400, epoch: 24 | loss: 0.0005957
	speed: 0.0170s/iter; left time: 533.2904s
Epoch: 24 cost time: 7.722171783447266
Epoch: 24, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.982 Test Loss: 0.096 Test Acc: 0.982
Validation loss decreased (-0.980445 --> -0.981809).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0001174
	speed: 0.0604s/iter; left time: 1891.1204s
	iters: 200, epoch: 25 | loss: 0.0081529
	speed: 0.0171s/iter; left time: 531.9424s
	iters: 300, epoch: 25 | loss: 0.0003456
	speed: 0.0173s/iter; left time: 538.8189s
	iters: 400, epoch: 25 | loss: 0.0000015
	speed: 0.0174s/iter; left time: 540.7120s
Epoch: 25 cost time: 7.515620708465576
Epoch: 25, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0001053
	speed: 0.0594s/iter; left time: 1834.7374s
	iters: 200, epoch: 26 | loss: 0.0020878
	speed: 0.0188s/iter; left time: 579.2800s
	iters: 300, epoch: 26 | loss: 0.0000166
	speed: 0.0190s/iter; left time: 583.4689s
	iters: 400, epoch: 26 | loss: 0.0000089
	speed: 0.0203s/iter; left time: 619.7376s
Epoch: 26 cost time: 8.188363075256348
Epoch: 26, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0023654
	speed: 0.0628s/iter; left time: 1914.3973s
	iters: 200, epoch: 27 | loss: 0.0000035
	speed: 0.0206s/iter; left time: 625.8948s
	iters: 300, epoch: 27 | loss: 0.0000046
	speed: 0.0201s/iter; left time: 607.2272s
	iters: 400, epoch: 27 | loss: 0.0005300
	speed: 0.0178s/iter; left time: 536.0226s
Epoch: 27 cost time: 8.357572793960571
Epoch: 27, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000588
	speed: 0.0617s/iter; left time: 1853.9749s
	iters: 200, epoch: 28 | loss: 0.0000007
	speed: 0.0200s/iter; left time: 600.3966s
	iters: 300, epoch: 28 | loss: 0.0000523
	speed: 0.0190s/iter; left time: 567.8568s
	iters: 400, epoch: 28 | loss: 0.0000385
	speed: 0.0194s/iter; left time: 578.5114s
Epoch: 28 cost time: 8.36063027381897
Epoch: 28, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000456
	speed: 0.0634s/iter; left time: 1878.0134s
	iters: 200, epoch: 29 | loss: 0.0000978
	speed: 0.0191s/iter; left time: 562.9493s
	iters: 300, epoch: 29 | loss: 0.1627271
	speed: 0.0200s/iter; left time: 588.8901s
	iters: 400, epoch: 29 | loss: 0.0000387
	speed: 0.0194s/iter; left time: 568.0151s
Epoch: 29 cost time: 8.445956230163574
Epoch: 29, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.144 Vali Acc: 0.978 Test Loss: 0.144 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000411
	speed: 0.0637s/iter; left time: 1862.4178s
	iters: 200, epoch: 30 | loss: 0.0000267
	speed: 0.0193s/iter; left time: 563.4059s
	iters: 300, epoch: 30 | loss: 0.0002311
	speed: 0.0176s/iter; left time: 509.5992s
	iters: 400, epoch: 30 | loss: 0.0016113
	speed: 0.0165s/iter; left time: 476.8584s
Epoch: 30 cost time: 7.885371208190918
Epoch: 30, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000554
	speed: 0.0668s/iter; left time: 1925.7150s
	iters: 200, epoch: 31 | loss: 0.0405416
	speed: 0.0172s/iter; left time: 492.4031s
	iters: 300, epoch: 31 | loss: 0.0019286
	speed: 0.0181s/iter; left time: 517.7265s
	iters: 400, epoch: 31 | loss: 0.0056591
	speed: 0.0174s/iter; left time: 497.0623s
Epoch: 31 cost time: 7.70405387878418
Epoch: 31, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0006660
	speed: 0.0626s/iter; left time: 1777.5219s
	iters: 200, epoch: 32 | loss: 0.0020769
	speed: 0.0183s/iter; left time: 517.9158s
	iters: 300, epoch: 32 | loss: 0.0000073
	speed: 0.0183s/iter; left time: 516.1075s
	iters: 400, epoch: 32 | loss: 0.0227671
	speed: 0.0172s/iter; left time: 482.2501s
Epoch: 32 cost time: 7.790379524230957
Epoch: 32, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000481
	speed: 0.0661s/iter; left time: 1849.9521s
	iters: 200, epoch: 33 | loss: 0.0032280
	speed: 0.0173s/iter; left time: 483.0791s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0165s/iter; left time: 459.3251s
	iters: 400, epoch: 33 | loss: 0.0000037
	speed: 0.0196s/iter; left time: 543.0685s
Epoch: 33 cost time: 7.8764753341674805
Epoch: 33, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.154 Vali Acc: 0.976 Test Loss: 0.154 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0000125
	speed: 0.0648s/iter; left time: 1786.0333s
	iters: 200, epoch: 34 | loss: 0.0000025
	speed: 0.0171s/iter; left time: 471.1241s
	iters: 300, epoch: 34 | loss: 0.0003397
	speed: 0.0199s/iter; left time: 543.9717s
	iters: 400, epoch: 34 | loss: 0.0115612
	speed: 0.0180s/iter; left time: 492.1461s
Epoch: 34 cost time: 8.20214581489563
Epoch: 34, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 99886
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.7684877
	speed: 0.0346s/iter; left time: 1424.2926s
	iters: 200, epoch: 1 | loss: 0.6750682
	speed: 0.0194s/iter; left time: 796.3086s
	iters: 300, epoch: 1 | loss: 0.3911945
	speed: 0.0201s/iter; left time: 822.2091s
	iters: 400, epoch: 1 | loss: 0.1229835
	speed: 0.0206s/iter; left time: 842.2799s
Epoch: 1 cost time: 9.773975372314453
Epoch: 1, Steps: 413 | Train Loss: 1.019 Vali Loss: 0.236 Vali Acc: 0.943 Test Loss: 0.236 Test Acc: 0.943
Validation loss decreased (inf --> -0.942699).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1213635
	speed: 0.0620s/iter; left time: 2526.8976s
	iters: 200, epoch: 2 | loss: 0.1906258
	speed: 0.0191s/iter; left time: 775.8095s
	iters: 300, epoch: 2 | loss: 0.2481541
	speed: 0.0181s/iter; left time: 734.1285s
	iters: 400, epoch: 2 | loss: 0.3898211
	speed: 0.0205s/iter; left time: 829.1843s
Epoch: 2 cost time: 8.375143766403198
Epoch: 2, Steps: 413 | Train Loss: 0.198 Vali Loss: 0.142 Vali Acc: 0.956 Test Loss: 0.142 Test Acc: 0.956
Validation loss decreased (-0.942699 --> -0.955888).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0676022
	speed: 0.0605s/iter; left time: 2442.9126s
	iters: 200, epoch: 3 | loss: 0.0658399
	speed: 0.0168s/iter; left time: 674.7270s
	iters: 300, epoch: 3 | loss: 0.0951066
	speed: 0.0181s/iter; left time: 727.9834s
	iters: 400, epoch: 3 | loss: 0.0808022
	speed: 0.0193s/iter; left time: 772.5251s
Epoch: 3 cost time: 7.957296371459961
Epoch: 3, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
Validation loss decreased (-0.955888 --> -0.975443).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0535378
	speed: 0.0605s/iter; left time: 2417.4379s
	iters: 200, epoch: 4 | loss: 0.0050589
	speed: 0.0189s/iter; left time: 752.8863s
	iters: 300, epoch: 4 | loss: 0.0117031
	speed: 0.0193s/iter; left time: 765.7579s
	iters: 400, epoch: 4 | loss: 0.0055628
	speed: 0.0193s/iter; left time: 765.8522s
Epoch: 4 cost time: 8.243412733078003
Epoch: 4, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0063252
	speed: 0.0625s/iter; left time: 2471.4012s
	iters: 200, epoch: 5 | loss: 0.0241612
	speed: 0.0193s/iter; left time: 759.6761s
	iters: 300, epoch: 5 | loss: 0.0147195
	speed: 0.0184s/iter; left time: 723.7773s
	iters: 400, epoch: 5 | loss: 0.0132283
	speed: 0.0199s/iter; left time: 780.2663s
Epoch: 5 cost time: 8.261433124542236
Epoch: 5, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2782591
	speed: 0.0641s/iter; left time: 2507.2610s
	iters: 200, epoch: 6 | loss: 0.0072811
	speed: 0.0194s/iter; left time: 758.0773s
	iters: 300, epoch: 6 | loss: 0.0038500
	speed: 0.0197s/iter; left time: 768.0280s
	iters: 400, epoch: 6 | loss: 0.0536760
	speed: 0.0212s/iter; left time: 823.7992s
Epoch: 6 cost time: 8.643819570541382
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.099 Vali Acc: 0.967 Test Loss: 0.099 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0118469
	speed: 0.0631s/iter; left time: 2441.5382s
	iters: 200, epoch: 7 | loss: 0.2041847
	speed: 0.0196s/iter; left time: 758.8698s
	iters: 300, epoch: 7 | loss: 0.0081234
	speed: 0.0200s/iter; left time: 771.8310s
	iters: 400, epoch: 7 | loss: 0.0458963
	speed: 0.0195s/iter; left time: 750.0341s
Epoch: 7 cost time: 8.388193845748901
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.971 Test Loss: 0.086 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0046117
	speed: 0.0615s/iter; left time: 2355.8014s
	iters: 200, epoch: 8 | loss: 0.0406194
	speed: 0.0189s/iter; left time: 720.5964s
	iters: 300, epoch: 8 | loss: 0.0528235
	speed: 0.0191s/iter; left time: 728.6306s
	iters: 400, epoch: 8 | loss: 0.0006872
	speed: 0.0190s/iter; left time: 722.7881s
Epoch: 8 cost time: 8.212763547897339
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0160699
	speed: 0.0596s/iter; left time: 2258.7550s
	iters: 200, epoch: 9 | loss: 0.0006817
	speed: 0.0185s/iter; left time: 699.4765s
	iters: 300, epoch: 9 | loss: 0.0006523
	speed: 0.0183s/iter; left time: 691.7043s
	iters: 400, epoch: 9 | loss: 0.0020077
	speed: 0.0179s/iter; left time: 673.4665s
Epoch: 9 cost time: 7.818869113922119
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0413963
	speed: 0.0610s/iter; left time: 2287.2871s
	iters: 200, epoch: 10 | loss: 0.1417448
	speed: 0.0170s/iter; left time: 634.2929s
	iters: 300, epoch: 10 | loss: 0.0098902
	speed: 0.0170s/iter; left time: 632.1696s
	iters: 400, epoch: 10 | loss: 0.0003157
	speed: 0.0165s/iter; left time: 614.3070s
Epoch: 10 cost time: 7.365929365158081
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.966 Test Loss: 0.119 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0008801
	speed: 0.0578s/iter; left time: 2143.7328s
	iters: 200, epoch: 11 | loss: 0.0582207
	speed: 0.0180s/iter; left time: 667.0633s
	iters: 300, epoch: 11 | loss: 0.0078621
	speed: 0.0182s/iter; left time: 671.4640s
	iters: 400, epoch: 11 | loss: 0.0008937
	speed: 0.0175s/iter; left time: 644.9415s
Epoch: 11 cost time: 7.7361767292022705
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0107082
	speed: 0.0585s/iter; left time: 2143.5066s
	iters: 200, epoch: 12 | loss: 0.0281798
	speed: 0.0192s/iter; left time: 700.3414s
	iters: 300, epoch: 12 | loss: 0.0006592
	speed: 0.0177s/iter; left time: 645.0956s
	iters: 400, epoch: 12 | loss: 0.0175679
	speed: 0.0182s/iter; left time: 662.6898s
Epoch: 12 cost time: 7.911980628967285
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0790602
	speed: 0.0594s/iter; left time: 2152.1514s
	iters: 200, epoch: 13 | loss: 0.0023345
	speed: 0.0200s/iter; left time: 722.4147s
	iters: 300, epoch: 13 | loss: 0.0020607
	speed: 0.0197s/iter; left time: 709.2286s
	iters: 400, epoch: 13 | loss: 0.0000740
	speed: 0.0189s/iter; left time: 680.0274s
Epoch: 13 cost time: 8.456269979476929
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 99886
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7382849
	speed: 0.0358s/iter; left time: 1475.6694s
	iters: 200, epoch: 1 | loss: 0.4766794
	speed: 0.0204s/iter; left time: 838.5156s
	iters: 300, epoch: 1 | loss: 0.2186464
	speed: 0.0196s/iter; left time: 801.9729s
	iters: 400, epoch: 1 | loss: 0.0861502
	speed: 0.0193s/iter; left time: 789.3435s
Epoch: 1 cost time: 9.878621578216553
Epoch: 1, Steps: 413 | Train Loss: 0.738 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0800916
	speed: 0.0627s/iter; left time: 2558.5710s
	iters: 200, epoch: 2 | loss: 0.0979964
	speed: 0.0196s/iter; left time: 798.0722s
	iters: 300, epoch: 2 | loss: 0.0456816
	speed: 0.0195s/iter; left time: 790.0267s
	iters: 400, epoch: 2 | loss: 0.0721246
	speed: 0.0203s/iter; left time: 821.8737s
Epoch: 2 cost time: 8.396866798400879
Epoch: 2, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.962709 --> -0.969985).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0458533
	speed: 0.0620s/iter; left time: 2501.8431s
	iters: 200, epoch: 3 | loss: 0.0286738
	speed: 0.0190s/iter; left time: 766.4542s
	iters: 300, epoch: 3 | loss: 0.0063844
	speed: 0.0188s/iter; left time: 757.0575s
	iters: 400, epoch: 3 | loss: 0.0211708
	speed: 0.0186s/iter; left time: 745.6590s
Epoch: 3 cost time: 8.136627197265625
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
Validation loss decreased (-0.969985 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0054423
	speed: 0.0639s/iter; left time: 2555.5250s
	iters: 200, epoch: 4 | loss: 0.0187058
	speed: 0.0185s/iter; left time: 737.0871s
	iters: 300, epoch: 4 | loss: 0.1261254
	speed: 0.0184s/iter; left time: 731.1325s
	iters: 400, epoch: 4 | loss: 0.0009521
	speed: 0.0184s/iter; left time: 729.1202s
Epoch: 4 cost time: 7.964919090270996
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.974988).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0017525
	speed: 0.0645s/iter; left time: 2549.3259s
	iters: 200, epoch: 5 | loss: 0.0210440
	speed: 0.0179s/iter; left time: 705.9336s
	iters: 300, epoch: 5 | loss: 0.0233281
	speed: 0.0178s/iter; left time: 698.8686s
	iters: 400, epoch: 5 | loss: 0.0318639
	speed: 0.0176s/iter; left time: 689.8705s
Epoch: 5 cost time: 7.713552713394165
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.082 Vali Acc: 0.972 Test Loss: 0.082 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0241154
	speed: 0.0624s/iter; left time: 2440.3414s
	iters: 200, epoch: 6 | loss: 0.0006186
	speed: 0.0188s/iter; left time: 732.6172s
	iters: 300, epoch: 6 | loss: 0.0008442
	speed: 0.0192s/iter; left time: 746.7695s
	iters: 400, epoch: 6 | loss: 0.0869815
	speed: 0.0189s/iter; left time: 734.0845s
Epoch: 6 cost time: 8.193904399871826
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.963 Test Loss: 0.117 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0099522
	speed: 0.0620s/iter; left time: 2402.4034s
	iters: 200, epoch: 7 | loss: 0.0061226
	speed: 0.0193s/iter; left time: 747.2350s
	iters: 300, epoch: 7 | loss: 0.0115651
	speed: 0.0212s/iter; left time: 816.6636s
	iters: 400, epoch: 7 | loss: 0.0011451
	speed: 0.0210s/iter; left time: 807.5652s
Epoch: 7 cost time: 8.799113988876343
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.964 Test Loss: 0.111 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0013934
	speed: 0.0622s/iter; left time: 2381.4209s
	iters: 200, epoch: 8 | loss: 0.0001261
	speed: 0.0194s/iter; left time: 742.5032s
	iters: 300, epoch: 8 | loss: 0.0068830
	speed: 0.0200s/iter; left time: 762.8216s
	iters: 400, epoch: 8 | loss: 0.0002514
	speed: 0.0204s/iter; left time: 776.2520s
Epoch: 8 cost time: 8.576597213745117
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0019087
	speed: 0.0607s/iter; left time: 2299.3731s
	iters: 200, epoch: 9 | loss: 0.0063272
	speed: 0.0210s/iter; left time: 792.2242s
	iters: 300, epoch: 9 | loss: 0.0133793
	speed: 0.0211s/iter; left time: 793.7131s
	iters: 400, epoch: 9 | loss: 0.0004667
	speed: 0.0208s/iter; left time: 781.0199s
Epoch: 9 cost time: 8.932143688201904
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.974988 --> -0.976352).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0002817
	speed: 0.0650s/iter; left time: 2437.7760s
	iters: 200, epoch: 10 | loss: 0.0027673
	speed: 0.0180s/iter; left time: 672.0454s
	iters: 300, epoch: 10 | loss: 0.0014358
	speed: 0.0195s/iter; left time: 727.1576s
	iters: 400, epoch: 10 | loss: 0.0011811
	speed: 0.0196s/iter; left time: 729.6610s
Epoch: 10 cost time: 8.404743194580078
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0011448
	speed: 0.0607s/iter; left time: 2249.5925s
	iters: 200, epoch: 11 | loss: 0.0006161
	speed: 0.0196s/iter; left time: 724.8426s
	iters: 300, epoch: 11 | loss: 0.0091393
	speed: 0.0198s/iter; left time: 731.1096s
	iters: 400, epoch: 11 | loss: 0.0000704
	speed: 0.0188s/iter; left time: 690.8876s
Epoch: 11 cost time: 8.295867204666138
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0002833
	speed: 0.0598s/iter; left time: 2193.4664s
	iters: 200, epoch: 12 | loss: 0.0008976
	speed: 0.0185s/iter; left time: 676.9469s
	iters: 300, epoch: 12 | loss: 0.0013329
	speed: 0.0180s/iter; left time: 656.3271s
	iters: 400, epoch: 12 | loss: 0.0055478
	speed: 0.0176s/iter; left time: 639.8560s
Epoch: 12 cost time: 7.806551456451416
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0005531
	speed: 0.0628s/iter; left time: 2274.4694s
	iters: 200, epoch: 13 | loss: 0.0001636
	speed: 0.0200s/iter; left time: 723.6932s
	iters: 300, epoch: 13 | loss: 0.0039259
	speed: 0.0199s/iter; left time: 718.4461s
	iters: 400, epoch: 13 | loss: 0.0010728
	speed: 0.0213s/iter; left time: 764.3980s
Epoch: 13 cost time: 8.712900161743164
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.976352 --> -0.977716).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000029
	speed: 0.0604s/iter; left time: 2163.8026s
	iters: 200, epoch: 14 | loss: 0.0020459
	speed: 0.0197s/iter; left time: 705.1883s
	iters: 300, epoch: 14 | loss: 0.0273025
	speed: 0.0198s/iter; left time: 705.9148s
	iters: 400, epoch: 14 | loss: 0.0000320
	speed: 0.0185s/iter; left time: 657.8580s
Epoch: 14 cost time: 8.161181926727295
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.979990).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0096944
	speed: 0.0629s/iter; left time: 2227.9134s
	iters: 200, epoch: 15 | loss: 0.0000345
	speed: 0.0187s/iter; left time: 660.9694s
	iters: 300, epoch: 15 | loss: 0.0375452
	speed: 0.0195s/iter; left time: 685.9323s
	iters: 400, epoch: 15 | loss: 0.0014919
	speed: 0.0191s/iter; left time: 669.4847s
Epoch: 15 cost time: 8.19546890258789
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000061
	speed: 0.0631s/iter; left time: 2207.6465s
	iters: 200, epoch: 16 | loss: 0.0002102
	speed: 0.0189s/iter; left time: 661.2664s
	iters: 300, epoch: 16 | loss: 0.0000091
	speed: 0.0190s/iter; left time: 662.3823s
	iters: 400, epoch: 16 | loss: 0.0002189
	speed: 0.0185s/iter; left time: 642.1162s
Epoch: 16 cost time: 8.136648416519165
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000034
	speed: 0.0629s/iter; left time: 2175.8915s
	iters: 200, epoch: 17 | loss: 0.0007673
	speed: 0.0183s/iter; left time: 630.4889s
	iters: 300, epoch: 17 | loss: 0.0061639
	speed: 0.0195s/iter; left time: 668.9521s
	iters: 400, epoch: 17 | loss: 0.0030950
	speed: 0.0183s/iter; left time: 628.7454s
Epoch: 17 cost time: 8.131152153015137
Epoch: 17, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000220
	speed: 0.0602s/iter; left time: 2058.3239s
	iters: 200, epoch: 18 | loss: 0.0000054
	speed: 0.0181s/iter; left time: 615.6722s
	iters: 300, epoch: 18 | loss: 0.0000561
	speed: 0.0188s/iter; left time: 639.1525s
	iters: 400, epoch: 18 | loss: 0.0002203
	speed: 0.0185s/iter; left time: 627.0203s
Epoch: 18 cost time: 7.920165538787842
Epoch: 18, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0016513
	speed: 0.0615s/iter; left time: 2075.3341s
	iters: 200, epoch: 19 | loss: 0.0025179
	speed: 0.0186s/iter; left time: 626.9356s
	iters: 300, epoch: 19 | loss: 0.0002672
	speed: 0.0192s/iter; left time: 645.4694s
	iters: 400, epoch: 19 | loss: 0.0000449
	speed: 0.0193s/iter; left time: 645.4487s
Epoch: 19 cost time: 8.108711957931519
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000286
	speed: 0.0637s/iter; left time: 2125.3562s
	iters: 200, epoch: 20 | loss: 0.0016323
	speed: 0.0188s/iter; left time: 625.2031s
	iters: 300, epoch: 20 | loss: 0.1508008
	speed: 0.0195s/iter; left time: 647.6536s
	iters: 400, epoch: 20 | loss: 0.0000745
	speed: 0.0185s/iter; left time: 612.3569s
Epoch: 20 cost time: 8.305177211761475
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0042198
	speed: 0.0605s/iter; left time: 1991.7746s
	iters: 200, epoch: 21 | loss: 0.0003492
	speed: 0.0196s/iter; left time: 644.9420s
	iters: 300, epoch: 21 | loss: 0.0000505
	speed: 0.0184s/iter; left time: 602.0207s
	iters: 400, epoch: 21 | loss: 0.0001424
	speed: 0.0190s/iter; left time: 621.0550s
Epoch: 21 cost time: 8.11525845527649
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000032
	speed: 0.0628s/iter; left time: 2042.1040s
	iters: 200, epoch: 22 | loss: 0.0000006
	speed: 0.0198s/iter; left time: 643.4383s
	iters: 300, epoch: 22 | loss: 0.0000044
	speed: 0.0187s/iter; left time: 603.4983s
	iters: 400, epoch: 22 | loss: 0.0001933
	speed: 0.0193s/iter; left time: 622.7463s
Epoch: 22 cost time: 8.430712223052979
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000017
	speed: 0.0623s/iter; left time: 2000.4868s
	iters: 200, epoch: 23 | loss: 0.0000452
	speed: 0.0203s/iter; left time: 648.9279s
	iters: 300, epoch: 23 | loss: 0.0026777
	speed: 0.0194s/iter; left time: 619.8477s
	iters: 400, epoch: 23 | loss: 0.0000021
	speed: 0.0193s/iter; left time: 614.1096s
Epoch: 23 cost time: 8.387250900268555
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0018937
	speed: 0.0629s/iter; left time: 1994.2448s
	iters: 200, epoch: 24 | loss: 0.0005789
	speed: 0.0197s/iter; left time: 623.8335s
	iters: 300, epoch: 24 | loss: 0.0000418
	speed: 0.0192s/iter; left time: 605.4360s
	iters: 400, epoch: 24 | loss: 0.0000089
	speed: 0.0182s/iter; left time: 572.7851s
Epoch: 24 cost time: 8.350672483444214
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
Validation loss decreased (-0.979990 --> -0.981809).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0010117
	speed: 0.0641s/iter; left time: 2005.8637s
	iters: 200, epoch: 25 | loss: 0.0627955
	speed: 0.0176s/iter; left time: 550.2892s
	iters: 300, epoch: 25 | loss: 0.0544680
	speed: 0.0180s/iter; left time: 560.3506s
	iters: 400, epoch: 25 | loss: 0.0001030
	speed: 0.0171s/iter; left time: 529.3168s
Epoch: 25 cost time: 7.772805452346802
Epoch: 25, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000322
	speed: 0.0625s/iter; left time: 1928.7829s
	iters: 200, epoch: 26 | loss: 0.0000035
	speed: 0.0175s/iter; left time: 537.1318s
	iters: 300, epoch: 26 | loss: 0.0004561
	speed: 0.0180s/iter; left time: 552.4806s
	iters: 400, epoch: 26 | loss: 0.0000116
	speed: 0.0201s/iter; left time: 614.2635s
Epoch: 26 cost time: 7.975604772567749
Epoch: 26, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0006472
	speed: 0.0627s/iter; left time: 1910.9377s
	iters: 200, epoch: 27 | loss: 0.0000012
	speed: 0.0208s/iter; left time: 631.1196s
	iters: 300, epoch: 27 | loss: 0.0000779
	speed: 0.0200s/iter; left time: 606.2219s
	iters: 400, epoch: 27 | loss: 0.0000051
	speed: 0.0185s/iter; left time: 556.9929s
Epoch: 27 cost time: 8.321237802505493
Epoch: 27, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000236
	speed: 0.0639s/iter; left time: 1919.2225s
	iters: 200, epoch: 28 | loss: 0.0000069
	speed: 0.0201s/iter; left time: 600.6194s
	iters: 300, epoch: 28 | loss: 0.0000252
	speed: 0.0209s/iter; left time: 624.4672s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0198s/iter; left time: 588.3132s
Epoch: 28 cost time: 8.65965223312378
Epoch: 28, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0002683
	speed: 0.0666s/iter; left time: 1974.7332s
	iters: 200, epoch: 29 | loss: 0.0137364
	speed: 0.0190s/iter; left time: 560.4291s
	iters: 300, epoch: 29 | loss: 0.0138570
	speed: 0.0199s/iter; left time: 584.9187s
	iters: 400, epoch: 29 | loss: 0.0003012
	speed: 0.0207s/iter; left time: 606.0982s
Epoch: 29 cost time: 8.793714046478271
Epoch: 29, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0053828
	speed: 0.0642s/iter; left time: 1875.7005s
	iters: 200, epoch: 30 | loss: 0.0000021
	speed: 0.0202s/iter; left time: 587.6216s
	iters: 300, epoch: 30 | loss: 0.0024453
	speed: 0.0206s/iter; left time: 597.5303s
	iters: 400, epoch: 30 | loss: 0.0000057
	speed: 0.0221s/iter; left time: 637.9736s
Epoch: 30 cost time: 8.972111463546753
Epoch: 30, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.981809 --> -0.983173).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.2100298
	speed: 0.0628s/iter; left time: 1808.0179s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0188s/iter; left time: 539.7813s
	iters: 300, epoch: 31 | loss: 0.0980631
	speed: 0.0181s/iter; left time: 518.8019s
	iters: 400, epoch: 31 | loss: 0.0000014
	speed: 0.0178s/iter; left time: 508.0599s
Epoch: 31 cost time: 7.937068700790405
Epoch: 31, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000078
	speed: 0.0625s/iter; left time: 1773.8516s
	iters: 200, epoch: 32 | loss: 0.0507481
	speed: 0.0175s/iter; left time: 494.2254s
	iters: 300, epoch: 32 | loss: 0.0000200
	speed: 0.0176s/iter; left time: 496.4027s
	iters: 400, epoch: 32 | loss: 0.0000044
	speed: 0.0178s/iter; left time: 500.6203s
Epoch: 32 cost time: 7.691317081451416
Epoch: 32, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000010
	speed: 0.0617s/iter; left time: 1727.9901s
	iters: 200, epoch: 33 | loss: 0.3460696
	speed: 0.0180s/iter; left time: 502.5807s
	iters: 300, epoch: 33 | loss: 0.0004446
	speed: 0.0179s/iter; left time: 497.3737s
	iters: 400, epoch: 33 | loss: 0.0000081
	speed: 0.0192s/iter; left time: 531.8820s
Epoch: 33 cost time: 7.89681077003479
Epoch: 33, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0004667
	speed: 0.0618s/iter; left time: 1705.0083s
	iters: 200, epoch: 34 | loss: 0.0000093
	speed: 0.0185s/iter; left time: 507.3999s
	iters: 300, epoch: 34 | loss: 0.0006326
	speed: 0.0199s/iter; left time: 544.1434s
	iters: 400, epoch: 34 | loss: 0.0016378
	speed: 0.0202s/iter; left time: 551.3732s
Epoch: 34 cost time: 8.333887577056885
Epoch: 34, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000002
	speed: 0.0620s/iter; left time: 1682.8123s
	iters: 200, epoch: 35 | loss: 0.0000028
	speed: 0.0190s/iter; left time: 514.1679s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0193s/iter; left time: 520.3897s
	iters: 400, epoch: 35 | loss: 0.0234484
	speed: 0.0198s/iter; left time: 531.1730s
Epoch: 35 cost time: 8.382810592651367
Epoch: 35, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0000004
	speed: 0.0628s/iter; left time: 1680.8613s
	iters: 200, epoch: 36 | loss: 0.0004530
	speed: 0.0195s/iter; left time: 519.8696s
	iters: 300, epoch: 36 | loss: 0.0000422
	speed: 0.0200s/iter; left time: 529.8090s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0175s/iter; left time: 462.8214s
Epoch: 36 cost time: 8.23171877861023
Epoch: 36, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0000006
	speed: 0.0637s/iter; left time: 1676.8587s
	iters: 200, epoch: 37 | loss: 0.0000001
	speed: 0.0202s/iter; left time: 531.0947s
	iters: 300, epoch: 37 | loss: 0.0000021
	speed: 0.0218s/iter; left time: 569.4975s
	iters: 400, epoch: 37 | loss: 0.0002335
	speed: 0.0205s/iter; left time: 534.9239s
Epoch: 37 cost time: 9.023401975631714
Epoch: 37, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0000021
	speed: 0.0647s/iter; left time: 1675.9684s
	iters: 200, epoch: 38 | loss: 0.0000005
	speed: 0.0187s/iter; left time: 483.0012s
	iters: 300, epoch: 38 | loss: 0.0000620
	speed: 0.0187s/iter; left time: 480.1864s
	iters: 400, epoch: 38 | loss: 0.0000007
	speed: 0.0184s/iter; left time: 471.8411s
Epoch: 38 cost time: 8.18118166923523
Epoch: 38, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0000943
	speed: 0.0621s/iter; left time: 1584.7002s
	iters: 200, epoch: 39 | loss: 0.0000935
	speed: 0.0187s/iter; left time: 476.1694s
	iters: 300, epoch: 39 | loss: 0.0000003
	speed: 0.0193s/iter; left time: 488.0772s
	iters: 400, epoch: 39 | loss: 0.0000050
	speed: 0.0187s/iter; left time: 472.0262s
Epoch: 39 cost time: 8.124476432800293
Epoch: 39, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0000002
	speed: 0.0631s/iter; left time: 1582.3348s
	iters: 200, epoch: 40 | loss: 0.0323220
	speed: 0.0181s/iter; left time: 451.1477s
	iters: 300, epoch: 40 | loss: 0.0015129
	speed: 0.0182s/iter; left time: 452.5739s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0199s/iter; left time: 494.4694s
Epoch: 40 cost time: 8.122108221054077
Epoch: 40, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 67118
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8412970
	speed: 0.0370s/iter; left time: 1523.8157s
	iters: 200, epoch: 1 | loss: 0.5335241
	speed: 0.0190s/iter; left time: 779.3574s
	iters: 300, epoch: 1 | loss: 0.2361942
	speed: 0.0190s/iter; left time: 778.3763s
	iters: 400, epoch: 1 | loss: 0.0943902
	speed: 0.0194s/iter; left time: 791.4956s
Epoch: 1 cost time: 9.731174945831299
Epoch: 1, Steps: 413 | Train Loss: 0.773 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
Validation loss decreased (inf --> -0.954068).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0822053
	speed: 0.0620s/iter; left time: 2529.0806s
	iters: 200, epoch: 2 | loss: 0.0760087
	speed: 0.0196s/iter; left time: 797.6562s
	iters: 300, epoch: 2 | loss: 0.0530964
	speed: 0.0192s/iter; left time: 777.2878s
	iters: 400, epoch: 2 | loss: 0.0739053
	speed: 0.0192s/iter; left time: 777.6954s
Epoch: 2 cost time: 8.33541226387024
Epoch: 2, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.954068 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0409002
	speed: 0.0637s/iter; left time: 2571.7155s
	iters: 200, epoch: 3 | loss: 0.0377684
	speed: 0.0188s/iter; left time: 755.9263s
	iters: 300, epoch: 3 | loss: 0.0154093
	speed: 0.0190s/iter; left time: 763.4458s
	iters: 400, epoch: 3 | loss: 0.0196687
	speed: 0.0184s/iter; left time: 737.7859s
Epoch: 3 cost time: 8.233640432357788
Epoch: 3, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
Validation loss decreased (-0.970440 --> -0.970440).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0079810
	speed: 0.0603s/iter; left time: 2408.2584s
	iters: 200, epoch: 4 | loss: 0.0313667
	speed: 0.0185s/iter; left time: 737.8841s
	iters: 300, epoch: 4 | loss: 0.0418854
	speed: 0.0183s/iter; left time: 727.6324s
	iters: 400, epoch: 4 | loss: 0.0020741
	speed: 0.0173s/iter; left time: 687.6343s
Epoch: 4 cost time: 7.804316759109497
Epoch: 4, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
Validation loss decreased (-0.970440 --> -0.974078).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0036549
	speed: 0.0576s/iter; left time: 2276.4862s
	iters: 200, epoch: 5 | loss: 0.0129295
	speed: 0.0181s/iter; left time: 714.0054s
	iters: 300, epoch: 5 | loss: 0.0379000
	speed: 0.0181s/iter; left time: 712.8840s
	iters: 400, epoch: 5 | loss: 0.1167983
	speed: 0.0186s/iter; left time: 731.9066s
Epoch: 5 cost time: 7.861656665802002
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0064981
	speed: 0.0595s/iter; left time: 2328.0376s
	iters: 200, epoch: 6 | loss: 0.0003718
	speed: 0.0185s/iter; left time: 724.0918s
	iters: 300, epoch: 6 | loss: 0.0010620
	speed: 0.0184s/iter; left time: 715.7508s
	iters: 400, epoch: 6 | loss: 0.2237677
	speed: 0.0185s/iter; left time: 719.9612s
Epoch: 6 cost time: 8.011292934417725
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0068164
	speed: 0.0604s/iter; left time: 2337.4073s
	iters: 200, epoch: 7 | loss: 0.0089857
	speed: 0.0195s/iter; left time: 751.4040s
	iters: 300, epoch: 7 | loss: 0.0490621
	speed: 0.0198s/iter; left time: 761.3306s
	iters: 400, epoch: 7 | loss: 0.0020103
	speed: 0.0196s/iter; left time: 754.0859s
Epoch: 7 cost time: 8.433147668838501
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.967 Test Loss: 0.102 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0004457
	speed: 0.0624s/iter; left time: 2391.3114s
	iters: 200, epoch: 8 | loss: 0.0003508
	speed: 0.0190s/iter; left time: 724.9346s
	iters: 300, epoch: 8 | loss: 0.0152007
	speed: 0.0196s/iter; left time: 745.8063s
	iters: 400, epoch: 8 | loss: 0.0003925
	speed: 0.0188s/iter; left time: 714.7228s
Epoch: 8 cost time: 8.284675121307373
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0032401
	speed: 0.0630s/iter; left time: 2389.0233s
	iters: 200, epoch: 9 | loss: 0.0047844
	speed: 0.0193s/iter; left time: 730.7735s
	iters: 300, epoch: 9 | loss: 0.0177830
	speed: 0.0183s/iter; left time: 689.9068s
	iters: 400, epoch: 9 | loss: 0.0058705
	speed: 0.0200s/iter; left time: 750.2180s
Epoch: 9 cost time: 8.462480545043945
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
Validation loss decreased (-0.974078 --> -0.975443).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0010962
	speed: 0.0632s/iter; left time: 2367.6460s
	iters: 200, epoch: 10 | loss: 0.0003271
	speed: 0.0194s/iter; left time: 723.5984s
	iters: 300, epoch: 10 | loss: 0.0391123
	speed: 0.0201s/iter; left time: 748.2924s
	iters: 400, epoch: 10 | loss: 0.0005055
	speed: 0.0204s/iter; left time: 757.0521s
Epoch: 10 cost time: 8.548805952072144
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0031423
	speed: 0.0649s/iter; left time: 2407.2277s
	iters: 200, epoch: 11 | loss: 0.0372138
	speed: 0.0189s/iter; left time: 697.6695s
	iters: 300, epoch: 11 | loss: 0.0008262
	speed: 0.0189s/iter; left time: 696.3208s
	iters: 400, epoch: 11 | loss: 0.0001965
	speed: 0.0184s/iter; left time: 674.9503s
Epoch: 11 cost time: 8.148555755615234
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0010389
	speed: 0.0677s/iter; left time: 2482.9643s
	iters: 200, epoch: 12 | loss: 0.0008104
	speed: 0.0192s/iter; left time: 702.9357s
	iters: 300, epoch: 12 | loss: 0.0007771
	speed: 0.0180s/iter; left time: 655.6985s
	iters: 400, epoch: 12 | loss: 0.0159896
	speed: 0.0180s/iter; left time: 653.6352s
Epoch: 12 cost time: 8.095160245895386
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.975443 --> -0.977262).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0004089
	speed: 0.0636s/iter; left time: 2305.9867s
	iters: 200, epoch: 13 | loss: 0.0000038
	speed: 0.0174s/iter; left time: 629.0329s
	iters: 300, epoch: 13 | loss: 0.0473017
	speed: 0.0181s/iter; left time: 652.0693s
	iters: 400, epoch: 13 | loss: 0.0053439
	speed: 0.0180s/iter; left time: 646.6524s
Epoch: 13 cost time: 7.786367654800415
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0001189
	speed: 0.0610s/iter; left time: 2186.1109s
	iters: 200, epoch: 14 | loss: 0.0002786
	speed: 0.0193s/iter; left time: 688.7369s
	iters: 300, epoch: 14 | loss: 0.0009890
	speed: 0.0208s/iter; left time: 740.6148s
	iters: 400, epoch: 14 | loss: 0.0552309
	speed: 0.0198s/iter; left time: 704.3412s
Epoch: 14 cost time: 8.454900026321411
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.977262 --> -0.980445).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0154476
	speed: 0.0649s/iter; left time: 2297.3569s
	iters: 200, epoch: 15 | loss: 0.0000383
	speed: 0.0193s/iter; left time: 680.5347s
	iters: 300, epoch: 15 | loss: 0.0428501
	speed: 0.0189s/iter; left time: 667.0586s
	iters: 400, epoch: 15 | loss: 0.0250949
	speed: 0.0194s/iter; left time: 682.8896s
Epoch: 15 cost time: 8.385916471481323
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000444
	speed: 0.0627s/iter; left time: 2195.7174s
	iters: 200, epoch: 16 | loss: 0.0001490
	speed: 0.0188s/iter; left time: 654.8197s
	iters: 300, epoch: 16 | loss: 0.0090075
	speed: 0.0190s/iter; left time: 662.4978s
	iters: 400, epoch: 16 | loss: 0.0001694
	speed: 0.0200s/iter; left time: 694.5476s
Epoch: 16 cost time: 8.408872842788696
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.059 Vali Acc: 0.981 Test Loss: 0.059 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.981355).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0001871
	speed: 0.0627s/iter; left time: 2170.1989s
	iters: 200, epoch: 17 | loss: 0.0124597
	speed: 0.0194s/iter; left time: 669.8512s
	iters: 300, epoch: 17 | loss: 0.0121778
	speed: 0.0198s/iter; left time: 681.1932s
	iters: 400, epoch: 17 | loss: 0.0013093
	speed: 0.0195s/iter; left time: 667.4551s
Epoch: 17 cost time: 8.537609577178955
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0001584
	speed: 0.0618s/iter; left time: 2111.6149s
	iters: 200, epoch: 18 | loss: 0.0000049
	speed: 0.0181s/iter; left time: 618.3096s
	iters: 300, epoch: 18 | loss: 0.0000194
	speed: 0.0192s/iter; left time: 652.8274s
	iters: 400, epoch: 18 | loss: 0.0000323
	speed: 0.0184s/iter; left time: 624.2652s
Epoch: 18 cost time: 8.03483271598816
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0696827
	speed: 0.0607s/iter; left time: 2050.0186s
	iters: 200, epoch: 19 | loss: 0.0581168
	speed: 0.0179s/iter; left time: 603.0138s
	iters: 300, epoch: 19 | loss: 0.0001056
	speed: 0.0190s/iter; left time: 637.9011s
	iters: 400, epoch: 19 | loss: 0.0000237
	speed: 0.0193s/iter; left time: 646.4409s
Epoch: 19 cost time: 8.193153381347656
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000237
	speed: 0.0606s/iter; left time: 2020.3707s
	iters: 200, epoch: 20 | loss: 0.0032033
	speed: 0.0176s/iter; left time: 586.2400s
	iters: 300, epoch: 20 | loss: 0.0604735
	speed: 0.0171s/iter; left time: 567.3235s
	iters: 400, epoch: 20 | loss: 0.0019550
	speed: 0.0172s/iter; left time: 568.0460s
Epoch: 20 cost time: 7.635478734970093
Epoch: 20, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0023858
	speed: 0.0679s/iter; left time: 2235.4279s
	iters: 200, epoch: 21 | loss: 0.0182059
	speed: 0.0177s/iter; left time: 582.5346s
	iters: 300, epoch: 21 | loss: 0.0000073
	speed: 0.0173s/iter; left time: 567.8601s
	iters: 400, epoch: 21 | loss: 0.0001097
	speed: 0.0186s/iter; left time: 606.8763s
Epoch: 21 cost time: 7.869713544845581
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0001049
	speed: 0.0628s/iter; left time: 2043.7852s
	iters: 200, epoch: 22 | loss: 0.0000016
	speed: 0.0185s/iter; left time: 598.9201s
	iters: 300, epoch: 22 | loss: 0.0000033
	speed: 0.0189s/iter; left time: 610.4533s
	iters: 400, epoch: 22 | loss: 0.0000123
	speed: 0.0182s/iter; left time: 586.9932s
Epoch: 22 cost time: 8.028224229812622
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000003
	speed: 0.0619s/iter; left time: 1987.5794s
	iters: 200, epoch: 23 | loss: 0.0013454
	speed: 0.0186s/iter; left time: 595.0228s
	iters: 300, epoch: 23 | loss: 0.0094963
	speed: 0.0188s/iter; left time: 598.4725s
	iters: 400, epoch: 23 | loss: 0.0011634
	speed: 0.0184s/iter; left time: 584.1348s
Epoch: 23 cost time: 8.119220733642578
Epoch: 23, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0283034
	speed: 0.0647s/iter; left time: 2050.9889s
	iters: 200, epoch: 24 | loss: 0.0012816
	speed: 0.0189s/iter; left time: 597.5707s
	iters: 300, epoch: 24 | loss: 0.0000196
	speed: 0.0184s/iter; left time: 579.3961s
	iters: 400, epoch: 24 | loss: 0.0003792
	speed: 0.0185s/iter; left time: 581.4642s
Epoch: 24 cost time: 8.105987310409546
Epoch: 24, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0128416
	speed: 0.0628s/iter; left time: 1964.9318s
	iters: 200, epoch: 25 | loss: 0.0006160
	speed: 0.0189s/iter; left time: 590.6768s
	iters: 300, epoch: 25 | loss: 0.3637606
	speed: 0.0192s/iter; left time: 597.3100s
	iters: 400, epoch: 25 | loss: 0.0000020
	speed: 0.0185s/iter; left time: 573.3380s
Epoch: 25 cost time: 8.08709979057312
Epoch: 25, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000003
	speed: 0.0593s/iter; left time: 1830.6887s
	iters: 200, epoch: 26 | loss: 0.0009189
	speed: 0.0190s/iter; left time: 586.0111s
	iters: 300, epoch: 26 | loss: 0.0001286
	speed: 0.0186s/iter; left time: 570.2872s
	iters: 400, epoch: 26 | loss: 0.0001391
	speed: 0.0184s/iter; left time: 563.8327s
Epoch: 26 cost time: 8.074827432632446
Epoch: 26, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 67118
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0240505
	speed: 0.0346s/iter; left time: 1426.1184s
	iters: 200, epoch: 1 | loss: 0.6220304
	speed: 0.0184s/iter; left time: 757.1482s
	iters: 300, epoch: 1 | loss: 0.3136884
	speed: 0.0191s/iter; left time: 782.5428s
	iters: 400, epoch: 1 | loss: 0.1239911
	speed: 0.0202s/iter; left time: 825.1552s
Epoch: 1 cost time: 9.538692474365234
Epoch: 1, Steps: 413 | Train Loss: 0.849 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (inf --> -0.944063).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0846979
	speed: 0.0623s/iter; left time: 2542.9509s
	iters: 200, epoch: 2 | loss: 0.0985130
	speed: 0.0202s/iter; left time: 823.0906s
	iters: 300, epoch: 2 | loss: 0.0848946
	speed: 0.0189s/iter; left time: 769.0606s
	iters: 400, epoch: 2 | loss: 0.0668446
	speed: 0.0194s/iter; left time: 787.4776s
Epoch: 2 cost time: 8.526538848876953
Epoch: 2, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (-0.944063 --> -0.964528).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0427046
	speed: 0.0616s/iter; left time: 2485.8547s
	iters: 200, epoch: 3 | loss: 0.0570251
	speed: 0.0200s/iter; left time: 803.9502s
	iters: 300, epoch: 3 | loss: 0.0127389
	speed: 0.0197s/iter; left time: 791.6727s
	iters: 400, epoch: 3 | loss: 0.0216194
	speed: 0.0206s/iter; left time: 823.7295s
Epoch: 3 cost time: 8.623276948928833
Epoch: 3, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
Validation loss decreased (-0.964528 --> -0.969531).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0339794
	speed: 0.0614s/iter; left time: 2453.1809s
	iters: 200, epoch: 4 | loss: 0.0197900
	speed: 0.0189s/iter; left time: 751.4149s
	iters: 300, epoch: 4 | loss: 0.0473538
	speed: 0.0189s/iter; left time: 752.7865s
	iters: 400, epoch: 4 | loss: 0.0123075
	speed: 0.0200s/iter; left time: 791.9847s
Epoch: 4 cost time: 8.27826714515686
Epoch: 4, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.074 Vali Acc: 0.972 Test Loss: 0.074 Test Acc: 0.972
Validation loss decreased (-0.969531 --> -0.972259).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0056193
	speed: 0.0624s/iter; left time: 2467.3155s
	iters: 200, epoch: 5 | loss: 0.0256888
	speed: 0.0182s/iter; left time: 718.7509s
	iters: 300, epoch: 5 | loss: 0.0349807
	speed: 0.0189s/iter; left time: 742.9709s
	iters: 400, epoch: 5 | loss: 0.0327984
	speed: 0.0192s/iter; left time: 755.2487s
Epoch: 5 cost time: 8.04476547241211
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.972259 --> -0.973169).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0083393
	speed: 0.0659s/iter; left time: 2579.0656s
	iters: 200, epoch: 6 | loss: 0.0046673
	speed: 0.0176s/iter; left time: 687.1524s
	iters: 300, epoch: 6 | loss: 0.0018791
	speed: 0.0179s/iter; left time: 696.8243s
	iters: 400, epoch: 6 | loss: 0.1491437
	speed: 0.0175s/iter; left time: 679.6318s
Epoch: 6 cost time: 7.780464172363281
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0055002
	speed: 0.0634s/iter; left time: 2455.0546s
	iters: 200, epoch: 7 | loss: 0.0087048
	speed: 0.0177s/iter; left time: 684.4764s
	iters: 300, epoch: 7 | loss: 0.0320437
	speed: 0.0179s/iter; left time: 689.3664s
	iters: 400, epoch: 7 | loss: 0.0019855
	speed: 0.0180s/iter; left time: 689.7612s
Epoch: 7 cost time: 7.792500972747803
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0005758
	speed: 0.0623s/iter; left time: 2387.5524s
	iters: 200, epoch: 8 | loss: 0.0004187
	speed: 0.0187s/iter; left time: 715.1908s
	iters: 300, epoch: 8 | loss: 0.0067506
	speed: 0.0181s/iter; left time: 691.2862s
	iters: 400, epoch: 8 | loss: 0.0241391
	speed: 0.0204s/iter; left time: 774.0785s
Epoch: 8 cost time: 8.16050410270691
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0008177
	speed: 0.0630s/iter; left time: 2387.5854s
	iters: 200, epoch: 9 | loss: 0.0050190
	speed: 0.0194s/iter; left time: 733.3956s
	iters: 300, epoch: 9 | loss: 0.0039904
	speed: 0.0186s/iter; left time: 703.0038s
	iters: 400, epoch: 9 | loss: 0.0052500
	speed: 0.0200s/iter; left time: 752.3238s
Epoch: 9 cost time: 8.347155809402466
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.974533).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0077897
	speed: 0.0640s/iter; left time: 2400.3488s
	iters: 200, epoch: 10 | loss: 0.0198745
	speed: 0.0194s/iter; left time: 725.1427s
	iters: 300, epoch: 10 | loss: 0.0016108
	speed: 0.0198s/iter; left time: 736.4063s
	iters: 400, epoch: 10 | loss: 0.0004487
	speed: 0.0201s/iter; left time: 749.1929s
Epoch: 10 cost time: 8.690452814102173
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
Validation loss decreased (-0.974533 --> -0.975897).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0068774
	speed: 0.0628s/iter; left time: 2327.8345s
	iters: 200, epoch: 11 | loss: 0.0008532
	speed: 0.0184s/iter; left time: 679.0561s
	iters: 300, epoch: 11 | loss: 0.0000632
	speed: 0.0187s/iter; left time: 687.8463s
	iters: 400, epoch: 11 | loss: 0.0014430
	speed: 0.0199s/iter; left time: 732.8154s
Epoch: 11 cost time: 8.26628303527832
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0271286
	speed: 0.0595s/iter; left time: 2181.5254s
	iters: 200, epoch: 12 | loss: 0.0012110
	speed: 0.0189s/iter; left time: 690.1980s
	iters: 300, epoch: 12 | loss: 0.0096611
	speed: 0.0188s/iter; left time: 686.2423s
	iters: 400, epoch: 12 | loss: 0.0017172
	speed: 0.0200s/iter; left time: 727.3079s
Epoch: 12 cost time: 8.19469165802002
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0005010
	speed: 0.0612s/iter; left time: 2217.3642s
	iters: 200, epoch: 13 | loss: 0.0000302
	speed: 0.0187s/iter; left time: 676.1758s
	iters: 300, epoch: 13 | loss: 0.0041060
	speed: 0.0178s/iter; left time: 643.2468s
	iters: 400, epoch: 13 | loss: 0.0028771
	speed: 0.0183s/iter; left time: 659.2517s
Epoch: 13 cost time: 7.9145684242248535
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0053223
	speed: 0.0632s/iter; left time: 2264.1512s
	iters: 200, epoch: 14 | loss: 0.0004090
	speed: 0.0170s/iter; left time: 607.5060s
	iters: 300, epoch: 14 | loss: 0.0003981
	speed: 0.0172s/iter; left time: 613.4212s
	iters: 400, epoch: 14 | loss: 0.0085578
	speed: 0.0179s/iter; left time: 636.2209s
Epoch: 14 cost time: 7.597985029220581
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
Validation loss decreased (-0.975897 --> -0.979081).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0031960
	speed: 0.0618s/iter; left time: 2189.6066s
	iters: 200, epoch: 15 | loss: 0.0000193
	speed: 0.0172s/iter; left time: 608.4222s
	iters: 300, epoch: 15 | loss: 0.0000068
	speed: 0.0180s/iter; left time: 632.7782s
	iters: 400, epoch: 15 | loss: 0.0224363
	speed: 0.0176s/iter; left time: 617.9953s
Epoch: 15 cost time: 7.604124546051025
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000202
	speed: 0.0612s/iter; left time: 2140.9513s
	iters: 200, epoch: 16 | loss: 0.0000500
	speed: 0.0194s/iter; left time: 677.7756s
	iters: 300, epoch: 16 | loss: 0.0001937
	speed: 0.0170s/iter; left time: 592.6558s
	iters: 400, epoch: 16 | loss: 0.0043564
	speed: 0.0189s/iter; left time: 657.1706s
Epoch: 16 cost time: 8.007135152816772
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0015899
	speed: 0.0621s/iter; left time: 2146.6662s
	iters: 200, epoch: 17 | loss: 0.0003773
	speed: 0.0204s/iter; left time: 705.2044s
	iters: 300, epoch: 17 | loss: 0.0011405
	speed: 0.0188s/iter; left time: 646.3026s
	iters: 400, epoch: 17 | loss: 0.0001343
	speed: 0.0191s/iter; left time: 655.5875s
Epoch: 17 cost time: 8.383082866668701
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979535).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0004066
	speed: 0.0593s/iter; left time: 2028.2371s
	iters: 200, epoch: 18 | loss: 0.0000080
	speed: 0.0191s/iter; left time: 650.7303s
	iters: 300, epoch: 18 | loss: 0.0003815
	speed: 0.0198s/iter; left time: 671.3186s
	iters: 400, epoch: 18 | loss: 0.0020292
	speed: 0.0197s/iter; left time: 665.8425s
Epoch: 18 cost time: 8.45547366142273
Epoch: 18, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0001979
	speed: 0.0646s/iter; left time: 2180.6876s
	iters: 200, epoch: 19 | loss: 0.0131319
	speed: 0.0191s/iter; left time: 644.6467s
	iters: 300, epoch: 19 | loss: 0.0016591
	speed: 0.0187s/iter; left time: 627.3186s
	iters: 400, epoch: 19 | loss: 0.0003370
	speed: 0.0195s/iter; left time: 652.8009s
Epoch: 19 cost time: 8.254642486572266
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000607
	speed: 0.0628s/iter; left time: 2093.6138s
	iters: 200, epoch: 20 | loss: 0.0021862
	speed: 0.0181s/iter; left time: 601.6464s
	iters: 300, epoch: 20 | loss: 0.3011224
	speed: 0.0181s/iter; left time: 599.9992s
	iters: 400, epoch: 20 | loss: 0.0027101
	speed: 0.0185s/iter; left time: 611.2317s
Epoch: 20 cost time: 7.978224754333496
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0005138
	speed: 0.0631s/iter; left time: 2078.9198s
	iters: 200, epoch: 21 | loss: 0.0015052
	speed: 0.0184s/iter; left time: 603.5843s
	iters: 300, epoch: 21 | loss: 0.0000021
	speed: 0.0176s/iter; left time: 576.7523s
	iters: 400, epoch: 21 | loss: 0.0000498
	speed: 0.0191s/iter; left time: 622.4637s
Epoch: 21 cost time: 7.922001361846924
Epoch: 21, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0001072
	speed: 0.0608s/iter; left time: 1976.7438s
	iters: 200, epoch: 22 | loss: 0.0000079
	speed: 0.0186s/iter; left time: 602.2384s
	iters: 300, epoch: 22 | loss: 0.0000519
	speed: 0.0196s/iter; left time: 632.2640s
	iters: 400, epoch: 22 | loss: 0.0105684
	speed: 0.0179s/iter; left time: 577.0682s
Epoch: 22 cost time: 8.061824560165405
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000500
	speed: 0.0633s/iter; left time: 2031.9653s
	iters: 200, epoch: 23 | loss: 0.0140697
	speed: 0.0202s/iter; left time: 646.9316s
	iters: 300, epoch: 23 | loss: 0.0096230
	speed: 0.0184s/iter; left time: 586.8193s
	iters: 400, epoch: 23 | loss: 0.0000134
	speed: 0.0200s/iter; left time: 635.5185s
Epoch: 23 cost time: 8.438321113586426
Epoch: 23, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.981354).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0002530
	speed: 0.0632s/iter; left time: 2002.1750s
	iters: 200, epoch: 24 | loss: 0.0000038
	speed: 0.0209s/iter; left time: 659.8927s
	iters: 300, epoch: 24 | loss: 0.0012509
	speed: 0.0194s/iter; left time: 611.2142s
	iters: 400, epoch: 24 | loss: 0.0000014
	speed: 0.0198s/iter; left time: 623.0720s
Epoch: 24 cost time: 8.583923578262329
Epoch: 24, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0281277
	speed: 0.0599s/iter; left time: 1872.8724s
	iters: 200, epoch: 25 | loss: 0.0090498
	speed: 0.0186s/iter; left time: 579.2427s
	iters: 300, epoch: 25 | loss: 0.0030371
	speed: 0.0186s/iter; left time: 577.6975s
	iters: 400, epoch: 25 | loss: 0.0000435
	speed: 0.0200s/iter; left time: 619.0007s
Epoch: 25 cost time: 8.243113040924072
Epoch: 25, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000019
	speed: 0.0644s/iter; left time: 1988.2796s
	iters: 200, epoch: 26 | loss: 0.0001286
	speed: 0.0192s/iter; left time: 591.9704s
	iters: 300, epoch: 26 | loss: 0.0072551
	speed: 0.0186s/iter; left time: 570.3316s
	iters: 400, epoch: 26 | loss: 0.0021422
	speed: 0.0191s/iter; left time: 584.5522s
Epoch: 26 cost time: 8.356533765792847
Epoch: 26, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0016003
	speed: 0.0654s/iter; left time: 1992.1897s
	iters: 200, epoch: 27 | loss: 0.0347248
	speed: 0.0176s/iter; left time: 534.6081s
	iters: 300, epoch: 27 | loss: 0.0001966
	speed: 0.0172s/iter; left time: 521.7652s
	iters: 400, epoch: 27 | loss: 0.0000125
	speed: 0.0181s/iter; left time: 546.6447s
Epoch: 27 cost time: 7.776005029678345
Epoch: 27, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.982 Test Loss: 0.100 Test Acc: 0.982
Validation loss decreased (-0.981354 --> -0.981809).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000663
	speed: 0.0624s/iter; left time: 1875.6733s
	iters: 200, epoch: 28 | loss: 0.0005739
	speed: 0.0180s/iter; left time: 538.5959s
	iters: 300, epoch: 28 | loss: 0.0000002
	speed: 0.0184s/iter; left time: 549.1695s
	iters: 400, epoch: 28 | loss: 0.0003147
	speed: 0.0190s/iter; left time: 565.5124s
Epoch: 28 cost time: 7.876543283462524
Epoch: 28, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0004241
	speed: 0.0627s/iter; left time: 1858.4871s
	iters: 200, epoch: 29 | loss: 0.0203504
	speed: 0.0179s/iter; left time: 528.3877s
	iters: 300, epoch: 29 | loss: 0.0003288
	speed: 0.0182s/iter; left time: 536.8945s
	iters: 400, epoch: 29 | loss: 0.0003420
	speed: 0.0174s/iter; left time: 509.6930s
Epoch: 29 cost time: 7.731804370880127
Epoch: 29, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0001875
	speed: 0.0617s/iter; left time: 1803.3696s
	iters: 200, epoch: 30 | loss: 0.0000006
	speed: 0.0186s/iter; left time: 540.5520s
	iters: 300, epoch: 30 | loss: 0.0575852
	speed: 0.0204s/iter; left time: 593.5366s
	iters: 400, epoch: 30 | loss: 0.0000038
	speed: 0.0189s/iter; left time: 545.2903s
Epoch: 30 cost time: 8.424282789230347
Epoch: 30, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
Validation loss decreased (-0.981809 --> -0.983628).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0642601
	speed: 0.0642s/iter; left time: 1849.2124s
	iters: 200, epoch: 31 | loss: 0.0000001
	speed: 0.0192s/iter; left time: 552.2291s
	iters: 300, epoch: 31 | loss: 0.0001000
	speed: 0.0188s/iter; left time: 537.2487s
	iters: 400, epoch: 31 | loss: 0.0011527
	speed: 0.0192s/iter; left time: 548.4178s
Epoch: 31 cost time: 8.326714992523193
Epoch: 31, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.982 Test Loss: 0.098 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0016789
	speed: 0.0623s/iter; left time: 1768.2893s
	iters: 200, epoch: 32 | loss: 0.0028918
	speed: 0.0198s/iter; left time: 559.2670s
	iters: 300, epoch: 32 | loss: 0.0000053
	speed: 0.0192s/iter; left time: 540.7332s
	iters: 400, epoch: 32 | loss: 0.0001344
	speed: 0.0198s/iter; left time: 557.1577s
Epoch: 32 cost time: 8.464493036270142
Epoch: 32, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000103
	speed: 0.0629s/iter; left time: 1759.2455s
	iters: 200, epoch: 33 | loss: 0.0062022
	speed: 0.0195s/iter; left time: 543.7798s
	iters: 300, epoch: 33 | loss: 0.0006626
	speed: 0.0195s/iter; left time: 542.6920s
	iters: 400, epoch: 33 | loss: 0.0000003
	speed: 0.0197s/iter; left time: 545.8503s
Epoch: 33 cost time: 8.423155546188354
Epoch: 33, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0016085
	speed: 0.0618s/iter; left time: 1704.8074s
	iters: 200, epoch: 34 | loss: 0.0020839
	speed: 0.0185s/iter; left time: 509.0070s
	iters: 300, epoch: 34 | loss: 0.0000526
	speed: 0.0182s/iter; left time: 497.5368s
	iters: 400, epoch: 34 | loss: 0.0001881
	speed: 0.0178s/iter; left time: 484.5788s
Epoch: 34 cost time: 7.853047132492065
Epoch: 34, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.982 Test Loss: 0.102 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000081
	speed: 0.0637s/iter; left time: 1730.7209s
	iters: 200, epoch: 35 | loss: 0.0003768
	speed: 0.0182s/iter; left time: 492.9728s
	iters: 300, epoch: 35 | loss: 0.0000002
	speed: 0.0176s/iter; left time: 473.3929s
	iters: 400, epoch: 35 | loss: 0.0820243
	speed: 0.0176s/iter; left time: 473.1598s
Epoch: 35 cost time: 7.783099174499512
Epoch: 35, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.145 Vali Acc: 0.978 Test Loss: 0.145 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0000016
	speed: 0.0665s/iter; left time: 1778.2234s
	iters: 200, epoch: 36 | loss: 0.0070916
	speed: 0.0178s/iter; left time: 475.5806s
	iters: 300, epoch: 36 | loss: 0.0000028
	speed: 0.0176s/iter; left time: 467.1340s
	iters: 400, epoch: 36 | loss: 0.0006660
	speed: 0.0174s/iter; left time: 458.8514s
Epoch: 36 cost time: 7.7518837451934814
Epoch: 36, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.135 Vali Acc: 0.978 Test Loss: 0.135 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 1723.6075s
	iters: 200, epoch: 37 | loss: 0.0000012
	speed: 0.0191s/iter; left time: 501.9431s
	iters: 300, epoch: 37 | loss: 0.0000001
	speed: 0.0190s/iter; left time: 495.4980s
	iters: 400, epoch: 37 | loss: 0.0236558
	speed: 0.0195s/iter; left time: 507.9967s
Epoch: 37 cost time: 8.271037340164185
Epoch: 37, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0000039
	speed: 0.0638s/iter; left time: 1652.4788s
	iters: 200, epoch: 38 | loss: 0.0010225
	speed: 0.0198s/iter; left time: 511.0188s
	iters: 300, epoch: 38 | loss: 0.0618564
	speed: 0.0189s/iter; left time: 486.1536s
	iters: 400, epoch: 38 | loss: 0.0000234
	speed: 0.0197s/iter; left time: 505.1544s
Epoch: 38 cost time: 8.430314779281616
Epoch: 38, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0001363
	speed: 0.0598s/iter; left time: 1525.3395s
	iters: 200, epoch: 39 | loss: 0.0004226
	speed: 0.0194s/iter; left time: 491.8073s
	iters: 300, epoch: 39 | loss: 0.0014400
	speed: 0.0202s/iter; left time: 510.8186s
	iters: 400, epoch: 39 | loss: 0.0000271
	speed: 0.0212s/iter; left time: 534.3892s
Epoch: 39 cost time: 8.524990558624268
Epoch: 39, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0000001
	speed: 0.0623s/iter; left time: 1562.7687s
	iters: 200, epoch: 40 | loss: 0.0020397
	speed: 0.0199s/iter; left time: 496.9039s
	iters: 300, epoch: 40 | loss: 0.0207030
	speed: 0.0202s/iter; left time: 504.0254s
	iters: 400, epoch: 40 | loss: 0.0000100
	speed: 0.0201s/iter; left time: 498.7445s
Epoch: 40 cost time: 8.572046041488647
Epoch: 40, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 67118
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3969058
	speed: 0.0346s/iter; left time: 1425.9878s
	iters: 200, epoch: 1 | loss: 0.7779542
	speed: 0.0180s/iter; left time: 738.0353s
	iters: 300, epoch: 1 | loss: 0.4753152
	speed: 0.0187s/iter; left time: 768.2835s
	iters: 400, epoch: 1 | loss: 0.1635168
	speed: 0.0176s/iter; left time: 721.1280s
Epoch: 1 cost time: 9.185047626495361
Epoch: 1, Steps: 413 | Train Loss: 1.017 Vali Loss: 0.255 Vali Acc: 0.937 Test Loss: 0.255 Test Acc: 0.937
Validation loss decreased (inf --> -0.937242).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2446449
	speed: 0.0645s/iter; left time: 2632.4181s
	iters: 200, epoch: 2 | loss: 0.1209271
	speed: 0.0174s/iter; left time: 707.7177s
	iters: 300, epoch: 2 | loss: 0.0766972
	speed: 0.0178s/iter; left time: 723.4145s
	iters: 400, epoch: 2 | loss: 0.0742873
	speed: 0.0182s/iter; left time: 736.8175s
Epoch: 2 cost time: 7.834598541259766
Epoch: 2, Steps: 413 | Train Loss: 0.199 Vali Loss: 0.128 Vali Acc: 0.958 Test Loss: 0.128 Test Acc: 0.958
Validation loss decreased (-0.937242 --> -0.958162).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0474406
	speed: 0.0647s/iter; left time: 2613.6719s
	iters: 200, epoch: 3 | loss: 0.1607641
	speed: 0.0189s/iter; left time: 759.4367s
	iters: 300, epoch: 3 | loss: 0.0347168
	speed: 0.0184s/iter; left time: 740.8834s
	iters: 400, epoch: 3 | loss: 0.0280648
	speed: 0.0183s/iter; left time: 732.6472s
Epoch: 3 cost time: 7.988674163818359
Epoch: 3, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.100 Vali Acc: 0.964 Test Loss: 0.100 Test Acc: 0.964
Validation loss decreased (-0.958162 --> -0.964074).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0438539
	speed: 0.0627s/iter; left time: 2506.1754s
	iters: 200, epoch: 4 | loss: 0.0046975
	speed: 0.0182s/iter; left time: 726.0425s
	iters: 300, epoch: 4 | loss: 0.1159712
	speed: 0.0181s/iter; left time: 721.1434s
	iters: 400, epoch: 4 | loss: 0.0166377
	speed: 0.0190s/iter; left time: 752.9754s
Epoch: 4 cost time: 7.918409824371338
Epoch: 4, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.078 Vali Acc: 0.974 Test Loss: 0.078 Test Acc: 0.974
Validation loss decreased (-0.964074 --> -0.973624).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0321003
	speed: 0.0656s/iter; left time: 2593.6540s
	iters: 200, epoch: 5 | loss: 0.0681577
	speed: 0.0176s/iter; left time: 693.6621s
	iters: 300, epoch: 5 | loss: 0.0166784
	speed: 0.0181s/iter; left time: 710.8159s
	iters: 400, epoch: 5 | loss: 0.0184187
	speed: 0.0182s/iter; left time: 716.0695s
Epoch: 5 cost time: 7.808239698410034
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0066528
	speed: 0.0612s/iter; left time: 2395.9457s
	iters: 200, epoch: 6 | loss: 0.0020195
	speed: 0.0196s/iter; left time: 764.8770s
	iters: 300, epoch: 6 | loss: 0.0084816
	speed: 0.0188s/iter; left time: 730.4672s
	iters: 400, epoch: 6 | loss: 0.0092479
	speed: 0.0180s/iter; left time: 698.3853s
Epoch: 6 cost time: 8.052035093307495
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0580912
	speed: 0.0604s/iter; left time: 2339.1725s
	iters: 200, epoch: 7 | loss: 0.0110384
	speed: 0.0176s/iter; left time: 680.1530s
	iters: 300, epoch: 7 | loss: 0.0587793
	speed: 0.0180s/iter; left time: 691.6028s
	iters: 400, epoch: 7 | loss: 0.0123871
	speed: 0.0183s/iter; left time: 703.2456s
Epoch: 7 cost time: 7.77775764465332
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0006364
	speed: 0.0601s/iter; left time: 2303.2898s
	iters: 200, epoch: 8 | loss: 0.0107336
	speed: 0.0187s/iter; left time: 715.5672s
	iters: 300, epoch: 8 | loss: 0.0258689
	speed: 0.0189s/iter; left time: 719.3821s
	iters: 400, epoch: 8 | loss: 0.0133375
	speed: 0.0190s/iter; left time: 722.6606s
Epoch: 8 cost time: 8.046731948852539
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0473548
	speed: 0.0605s/iter; left time: 2291.8525s
	iters: 200, epoch: 9 | loss: 0.0018307
	speed: 0.0189s/iter; left time: 712.7745s
	iters: 300, epoch: 9 | loss: 0.0106700
	speed: 0.0185s/iter; left time: 696.3747s
	iters: 400, epoch: 9 | loss: 0.0139303
	speed: 0.0193s/iter; left time: 726.9498s
Epoch: 9 cost time: 8.070592880249023
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.966 Test Loss: 0.105 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0080387
	speed: 0.0578s/iter; left time: 2168.0377s
	iters: 200, epoch: 10 | loss: 0.0022674
	speed: 0.0207s/iter; left time: 774.0731s
	iters: 300, epoch: 10 | loss: 0.0804633
	speed: 0.0203s/iter; left time: 758.5210s
	iters: 400, epoch: 10 | loss: 0.0007482
	speed: 0.0178s/iter; left time: 662.5104s
Epoch: 10 cost time: 8.42131519317627
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0013146
	speed: 0.0609s/iter; left time: 2256.3310s
	iters: 200, epoch: 11 | loss: 0.0087744
	speed: 0.0181s/iter; left time: 669.9853s
	iters: 300, epoch: 11 | loss: 0.0005107
	speed: 0.0161s/iter; left time: 593.3238s
	iters: 400, epoch: 11 | loss: 0.0012047
	speed: 0.0166s/iter; left time: 610.5741s
Epoch: 11 cost time: 7.545981168746948
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0404738
	speed: 0.0627s/iter; left time: 2299.9282s
	iters: 200, epoch: 12 | loss: 0.0007159
	speed: 0.0184s/iter; left time: 673.0502s
	iters: 300, epoch: 12 | loss: 0.0001076
	speed: 0.0178s/iter; left time: 647.9854s
	iters: 400, epoch: 12 | loss: 0.0017415
	speed: 0.0181s/iter; left time: 657.1662s
Epoch: 12 cost time: 7.908572196960449
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.973624 --> -0.975897).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0004922
	speed: 0.0675s/iter; left time: 2446.6389s
	iters: 200, epoch: 13 | loss: 0.0007837
	speed: 0.0186s/iter; left time: 672.4541s
	iters: 300, epoch: 13 | loss: 0.0050573
	speed: 0.0177s/iter; left time: 637.0421s
	iters: 400, epoch: 13 | loss: 0.0428626
	speed: 0.0186s/iter; left time: 666.8639s
Epoch: 13 cost time: 8.056636333465576
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000294
	speed: 0.0657s/iter; left time: 2354.2616s
	iters: 200, epoch: 14 | loss: 0.2222797
	speed: 0.0186s/iter; left time: 664.0815s
	iters: 300, epoch: 14 | loss: 0.0036005
	speed: 0.0187s/iter; left time: 667.7581s
	iters: 400, epoch: 14 | loss: 0.0173329
	speed: 0.0192s/iter; left time: 680.9097s
Epoch: 14 cost time: 8.186431407928467
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0008123
	speed: 0.0616s/iter; left time: 2182.2481s
	iters: 200, epoch: 15 | loss: 0.0000421
	speed: 0.0188s/iter; left time: 663.2927s
	iters: 300, epoch: 15 | loss: 0.0000116
	speed: 0.0197s/iter; left time: 693.3013s
	iters: 400, epoch: 15 | loss: 0.0198591
	speed: 0.0194s/iter; left time: 682.4405s
Epoch: 15 cost time: 8.278356075286865
Epoch: 15, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0004097
	speed: 0.0650s/iter; left time: 2273.9346s
	iters: 200, epoch: 16 | loss: 0.0024113
	speed: 0.0179s/iter; left time: 624.6024s
	iters: 300, epoch: 16 | loss: 0.0001987
	speed: 0.0179s/iter; left time: 621.3579s
	iters: 400, epoch: 16 | loss: 0.0008750
	speed: 0.0184s/iter; left time: 639.7749s
Epoch: 16 cost time: 8.0792555809021
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.161 Vali Acc: 0.963 Test Loss: 0.161 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0002552
	speed: 0.0613s/iter; left time: 2120.3796s
	iters: 200, epoch: 17 | loss: 0.0007940
	speed: 0.0173s/iter; left time: 595.4330s
	iters: 300, epoch: 17 | loss: 0.0113618
	speed: 0.0181s/iter; left time: 621.3642s
	iters: 400, epoch: 17 | loss: 0.0034763
	speed: 0.0189s/iter; left time: 647.9757s
Epoch: 17 cost time: 7.826779127120972
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0088176
	speed: 0.0601s/iter; left time: 2054.8324s
	iters: 200, epoch: 18 | loss: 0.0000216
	speed: 0.0185s/iter; left time: 630.5769s
	iters: 300, epoch: 18 | loss: 0.0017498
	speed: 0.0180s/iter; left time: 610.8272s
	iters: 400, epoch: 18 | loss: 0.0000080
	speed: 0.0181s/iter; left time: 614.2493s
Epoch: 18 cost time: 7.8898162841796875
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0011254
	speed: 0.0622s/iter; left time: 2101.0021s
	iters: 200, epoch: 19 | loss: 0.0109426
	speed: 0.0203s/iter; left time: 683.9550s
	iters: 300, epoch: 19 | loss: 0.0193041
	speed: 0.0197s/iter; left time: 659.8230s
	iters: 400, epoch: 19 | loss: 0.0012729
	speed: 0.0198s/iter; left time: 663.9976s
Epoch: 19 cost time: 8.639993906021118
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000985
	speed: 0.0636s/iter; left time: 2121.6301s
	iters: 200, epoch: 20 | loss: 0.0001091
	speed: 0.0195s/iter; left time: 647.3260s
	iters: 300, epoch: 20 | loss: 0.0098718
	speed: 0.0200s/iter; left time: 663.4794s
	iters: 400, epoch: 20 | loss: 0.0002501
	speed: 0.0196s/iter; left time: 648.8310s
Epoch: 20 cost time: 8.50131630897522
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0001905
	speed: 0.0635s/iter; left time: 2091.8421s
	iters: 200, epoch: 21 | loss: 0.0177886
	speed: 0.0195s/iter; left time: 640.5576s
	iters: 300, epoch: 21 | loss: 0.0001528
	speed: 0.0188s/iter; left time: 614.1213s
	iters: 400, epoch: 21 | loss: 0.0069808
	speed: 0.0193s/iter; left time: 629.9964s
Epoch: 21 cost time: 8.213111877441406
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000388
	speed: 0.0637s/iter; left time: 2072.8767s
	iters: 200, epoch: 22 | loss: 0.0000033
	speed: 0.0201s/iter; left time: 653.0953s
	iters: 300, epoch: 22 | loss: 0.0000722
	speed: 0.0203s/iter; left time: 655.7960s
	iters: 400, epoch: 22 | loss: 0.0414672
	speed: 0.0189s/iter; left time: 608.7905s
Epoch: 22 cost time: 8.522738933563232
Epoch: 22, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9758981355161437
model parameter : 67118
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9150848
	speed: 0.0379s/iter; left time: 1560.9343s
	iters: 200, epoch: 1 | loss: 0.2235144
	speed: 0.0184s/iter; left time: 754.5498s
	iters: 300, epoch: 1 | loss: 0.2784988
	speed: 0.0193s/iter; left time: 792.5033s
	iters: 400, epoch: 1 | loss: 0.4459156
	speed: 0.0176s/iter; left time: 719.9905s
Epoch: 1 cost time: 9.616314888000488
Epoch: 1, Steps: 413 | Train Loss: 0.755 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
Validation loss decreased (inf --> -0.954068).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1223135
	speed: 0.0616s/iter; left time: 2512.4390s
	iters: 200, epoch: 2 | loss: 0.0310892
	speed: 0.0173s/iter; left time: 702.9113s
	iters: 300, epoch: 2 | loss: 0.0399576
	speed: 0.0195s/iter; left time: 791.8587s
	iters: 400, epoch: 2 | loss: 0.0106258
	speed: 0.0192s/iter; left time: 778.4987s
Epoch: 2 cost time: 8.083736658096313
Epoch: 2, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
Validation loss decreased (-0.954068 --> -0.965438).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0570766
	speed: 0.0625s/iter; left time: 2521.4571s
	iters: 200, epoch: 3 | loss: 0.0206064
	speed: 0.0198s/iter; left time: 797.9794s
	iters: 300, epoch: 3 | loss: 0.0736227
	speed: 0.0199s/iter; left time: 798.7120s
	iters: 400, epoch: 3 | loss: 0.0267528
	speed: 0.0191s/iter; left time: 763.5898s
Epoch: 3 cost time: 8.513688325881958
Epoch: 3, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.080 Vali Acc: 0.972 Test Loss: 0.080 Test Acc: 0.972
Validation loss decreased (-0.965438 --> -0.972259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0182161
	speed: 0.0659s/iter; left time: 2632.0013s
	iters: 200, epoch: 4 | loss: 0.0031728
	speed: 0.0192s/iter; left time: 764.3423s
	iters: 300, epoch: 4 | loss: 0.0343329
	speed: 0.0185s/iter; left time: 737.0110s
	iters: 400, epoch: 4 | loss: 0.1582411
	speed: 0.0202s/iter; left time: 799.9319s
Epoch: 4 cost time: 8.511362314224243
Epoch: 4, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.974533).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0391602
	speed: 0.0653s/iter; left time: 2583.1930s
	iters: 200, epoch: 5 | loss: 0.0206059
	speed: 0.0199s/iter; left time: 786.8962s
	iters: 300, epoch: 5 | loss: 0.3786830
	speed: 0.0200s/iter; left time: 788.7855s
	iters: 400, epoch: 5 | loss: 0.0288620
	speed: 0.0207s/iter; left time: 810.7757s
Epoch: 5 cost time: 8.670379400253296
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.974533 --> -0.977262).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0115076
	speed: 0.0654s/iter; left time: 2559.8346s
	iters: 200, epoch: 6 | loss: 0.0099374
	speed: 0.0190s/iter; left time: 742.3123s
	iters: 300, epoch: 6 | loss: 0.0126818
	speed: 0.0193s/iter; left time: 750.4793s
	iters: 400, epoch: 6 | loss: 0.2198525
	speed: 0.0196s/iter; left time: 762.7151s
Epoch: 6 cost time: 8.46848201751709
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0005137
	speed: 0.0629s/iter; left time: 2436.7640s
	iters: 200, epoch: 7 | loss: 0.0661444
	speed: 0.0184s/iter; left time: 709.3049s
	iters: 300, epoch: 7 | loss: 0.0421356
	speed: 0.0180s/iter; left time: 693.8573s
	iters: 400, epoch: 7 | loss: 0.0044548
	speed: 0.0180s/iter; left time: 693.2334s
Epoch: 7 cost time: 7.9797163009643555
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.087 Vali Acc: 0.972 Test Loss: 0.087 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1399130
	speed: 0.0622s/iter; left time: 2383.2033s
	iters: 200, epoch: 8 | loss: 0.0013096
	speed: 0.0187s/iter; left time: 713.6700s
	iters: 300, epoch: 8 | loss: 0.0179342
	speed: 0.0185s/iter; left time: 706.5395s
	iters: 400, epoch: 8 | loss: 0.0065811
	speed: 0.0189s/iter; left time: 718.3927s
Epoch: 8 cost time: 8.085919618606567
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
Validation loss decreased (-0.977262 --> -0.977716).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0025179
	speed: 0.0615s/iter; left time: 2332.1514s
	iters: 200, epoch: 9 | loss: 0.0007122
	speed: 0.0204s/iter; left time: 771.8273s
	iters: 300, epoch: 9 | loss: 0.1224333
	speed: 0.0201s/iter; left time: 759.1962s
	iters: 400, epoch: 9 | loss: 0.0316499
	speed: 0.0203s/iter; left time: 762.8571s
Epoch: 9 cost time: 8.58322548866272
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.980445).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0035000
	speed: 0.0637s/iter; left time: 2386.4316s
	iters: 200, epoch: 10 | loss: 0.0330202
	speed: 0.0188s/iter; left time: 702.6160s
	iters: 300, epoch: 10 | loss: 0.0005201
	speed: 0.0190s/iter; left time: 708.4484s
	iters: 400, epoch: 10 | loss: 0.0018323
	speed: 0.0196s/iter; left time: 730.1833s
Epoch: 10 cost time: 8.30401062965393
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
Validation loss decreased (-0.980445 --> -0.981809).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0054203
	speed: 0.0651s/iter; left time: 2412.6848s
	iters: 200, epoch: 11 | loss: 0.0009419
	speed: 0.0194s/iter; left time: 715.8532s
	iters: 300, epoch: 11 | loss: 0.1719068
	speed: 0.0196s/iter; left time: 721.2627s
	iters: 400, epoch: 11 | loss: 0.0003963
	speed: 0.0201s/iter; left time: 737.9505s
Epoch: 11 cost time: 8.44113540649414
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0002079
	speed: 0.0649s/iter; left time: 2378.6122s
	iters: 200, epoch: 12 | loss: 0.0088063
	speed: 0.0193s/iter; left time: 705.4673s
	iters: 300, epoch: 12 | loss: 0.0013240
	speed: 0.0190s/iter; left time: 692.8634s
	iters: 400, epoch: 12 | loss: 0.0000857
	speed: 0.0195s/iter; left time: 707.6414s
Epoch: 12 cost time: 8.205806016921997
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0004695
	speed: 0.0617s/iter; left time: 2236.3455s
	iters: 200, epoch: 13 | loss: 0.0027252
	speed: 0.0188s/iter; left time: 678.5301s
	iters: 300, epoch: 13 | loss: 0.0001252
	speed: 0.0178s/iter; left time: 642.5753s
	iters: 400, epoch: 13 | loss: 0.0015797
	speed: 0.0182s/iter; left time: 653.7296s
Epoch: 13 cost time: 7.985791921615601
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0357551
	speed: 0.0605s/iter; left time: 2168.9923s
	iters: 200, epoch: 14 | loss: 0.0020270
	speed: 0.0193s/iter; left time: 690.0868s
	iters: 300, epoch: 14 | loss: 0.0159014
	speed: 0.0205s/iter; left time: 730.7159s
	iters: 400, epoch: 14 | loss: 0.0005731
	speed: 0.0199s/iter; left time: 707.3765s
Epoch: 14 cost time: 8.396001815795898
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.981809 --> -0.982719).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0001318
	speed: 0.0609s/iter; left time: 2156.1954s
	iters: 200, epoch: 15 | loss: 0.0203106
	speed: 0.0197s/iter; left time: 697.4039s
	iters: 300, epoch: 15 | loss: 0.0055582
	speed: 0.0199s/iter; left time: 702.2603s
	iters: 400, epoch: 15 | loss: 0.0000681
	speed: 0.0202s/iter; left time: 710.1141s
Epoch: 15 cost time: 8.55744457244873
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0001901
	speed: 0.0632s/iter; left time: 2213.6509s
	iters: 200, epoch: 16 | loss: 0.0000097
	speed: 0.0200s/iter; left time: 698.2508s
	iters: 300, epoch: 16 | loss: 0.0001477
	speed: 0.0198s/iter; left time: 690.5195s
	iters: 400, epoch: 16 | loss: 0.0004649
	speed: 0.0202s/iter; left time: 699.7877s
Epoch: 16 cost time: 8.717846155166626
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0001021
	speed: 0.0621s/iter; left time: 2148.8268s
	iters: 200, epoch: 17 | loss: 0.0001094
	speed: 0.0199s/iter; left time: 687.4737s
	iters: 300, epoch: 17 | loss: 0.0012419
	speed: 0.0196s/iter; left time: 675.0747s
	iters: 400, epoch: 17 | loss: 0.0001945
	speed: 0.0191s/iter; left time: 656.2059s
Epoch: 17 cost time: 8.485638856887817
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.1485738
	speed: 0.0629s/iter; left time: 2149.3903s
	iters: 200, epoch: 18 | loss: 0.0002318
	speed: 0.0187s/iter; left time: 637.6246s
	iters: 300, epoch: 18 | loss: 0.0002134
	speed: 0.0199s/iter; left time: 676.4836s
	iters: 400, epoch: 18 | loss: 0.0003334
	speed: 0.0190s/iter; left time: 644.7872s
Epoch: 18 cost time: 8.369385719299316
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0005900
	speed: 0.0660s/iter; left time: 2228.8786s
	iters: 200, epoch: 19 | loss: 0.0000794
	speed: 0.0185s/iter; left time: 622.5528s
	iters: 300, epoch: 19 | loss: 0.0004637
	speed: 0.0189s/iter; left time: 634.1167s
	iters: 400, epoch: 19 | loss: 0.0003686
	speed: 0.0186s/iter; left time: 623.1681s
Epoch: 19 cost time: 8.10485291481018
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000174
	speed: 0.0642s/iter; left time: 2142.3957s
	iters: 200, epoch: 20 | loss: 0.0000580
	speed: 0.0186s/iter; left time: 617.1538s
	iters: 300, epoch: 20 | loss: 0.0000025
	speed: 0.0186s/iter; left time: 617.0687s
	iters: 400, epoch: 20 | loss: 0.0001217
	speed: 0.0173s/iter; left time: 570.3637s
Epoch: 20 cost time: 7.8864967823028564
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000146
	speed: 0.0654s/iter; left time: 2153.1998s
	iters: 200, epoch: 21 | loss: 0.0000009
	speed: 0.0174s/iter; left time: 570.9314s
	iters: 300, epoch: 21 | loss: 0.0010166
	speed: 0.0184s/iter; left time: 603.3637s
	iters: 400, epoch: 21 | loss: 0.0212316
	speed: 0.0180s/iter; left time: 588.3876s
Epoch: 21 cost time: 7.8188042640686035
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0048325
	speed: 0.0658s/iter; left time: 2140.5026s
	iters: 200, epoch: 22 | loss: 0.4065936
	speed: 0.0214s/iter; left time: 695.1041s
	iters: 300, epoch: 22 | loss: 0.0003032
	speed: 0.0208s/iter; left time: 671.8510s
	iters: 400, epoch: 22 | loss: 0.0000918
	speed: 0.0190s/iter; left time: 613.2927s
Epoch: 22 cost time: 8.778367519378662
Epoch: 22, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0008867
	speed: 0.0645s/iter; left time: 2071.8006s
	iters: 200, epoch: 23 | loss: 0.0000533
	speed: 0.0194s/iter; left time: 620.4072s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.0197s/iter; left time: 627.6217s
	iters: 400, epoch: 23 | loss: 0.0002817
	speed: 0.0203s/iter; left time: 646.1839s
Epoch: 23 cost time: 8.758045434951782
Epoch: 23, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
Validation loss decreased (-0.982719 --> -0.984083).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000004
	speed: 0.0617s/iter; left time: 1956.9683s
	iters: 200, epoch: 24 | loss: 0.0296170
	speed: 0.0193s/iter; left time: 610.6246s
	iters: 300, epoch: 24 | loss: 0.0000046
	speed: 0.0205s/iter; left time: 646.4918s
	iters: 400, epoch: 24 | loss: 0.0000132
	speed: 0.0200s/iter; left time: 626.9376s
Epoch: 24 cost time: 8.491278886795044
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0609336
	speed: 0.0610s/iter; left time: 1907.7584s
	iters: 200, epoch: 25 | loss: 0.0006083
	speed: 0.0182s/iter; left time: 567.9905s
	iters: 300, epoch: 25 | loss: 0.0002296
	speed: 0.0196s/iter; left time: 609.2663s
	iters: 400, epoch: 25 | loss: 0.0000047
	speed: 0.0191s/iter; left time: 591.6828s
Epoch: 25 cost time: 8.182051181793213
Epoch: 25, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000038
	speed: 0.0626s/iter; left time: 1933.0938s
	iters: 200, epoch: 26 | loss: 0.0001028
	speed: 0.0178s/iter; left time: 548.5522s
	iters: 300, epoch: 26 | loss: 0.0000016
	speed: 0.0186s/iter; left time: 572.0141s
	iters: 400, epoch: 26 | loss: 0.0006282
	speed: 0.0194s/iter; left time: 593.9085s
Epoch: 26 cost time: 8.112635135650635
Epoch: 26, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0003290
	speed: 0.0617s/iter; left time: 1879.2468s
	iters: 200, epoch: 27 | loss: 0.0073189
	speed: 0.0185s/iter; left time: 561.3734s
	iters: 300, epoch: 27 | loss: 0.0000032
	speed: 0.0183s/iter; left time: 554.8440s
	iters: 400, epoch: 27 | loss: 0.0269955
	speed: 0.0176s/iter; left time: 532.1626s
Epoch: 27 cost time: 7.790355920791626
Epoch: 27, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000671
	speed: 0.0670s/iter; left time: 2011.9995s
	iters: 200, epoch: 28 | loss: 0.0003593
	speed: 0.0172s/iter; left time: 516.5236s
	iters: 300, epoch: 28 | loss: 0.0139710
	speed: 0.0184s/iter; left time: 548.9967s
	iters: 400, epoch: 28 | loss: 0.0000004
	speed: 0.0188s/iter; left time: 558.6773s
Epoch: 28 cost time: 7.940834283828735
Epoch: 28, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000394
	speed: 0.0666s/iter; left time: 1974.5382s
	iters: 200, epoch: 29 | loss: 0.0000106
	speed: 0.0192s/iter; left time: 566.7484s
	iters: 300, epoch: 29 | loss: 0.0000540
	speed: 0.0201s/iter; left time: 591.9720s
	iters: 400, epoch: 29 | loss: 0.0004814
	speed: 0.0193s/iter; left time: 566.6027s
Epoch: 29 cost time: 8.371195793151855
Epoch: 29, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0029181
	speed: 0.0673s/iter; left time: 1966.9091s
	iters: 200, epoch: 30 | loss: 0.0000012
	speed: 0.0189s/iter; left time: 550.1003s
	iters: 300, epoch: 30 | loss: 0.0000008
	speed: 0.0184s/iter; left time: 534.3726s
	iters: 400, epoch: 30 | loss: 0.0000046
	speed: 0.0186s/iter; left time: 538.3501s
Epoch: 30 cost time: 8.318272113800049
Epoch: 30, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0004466
	speed: 0.0646s/iter; left time: 1860.8233s
	iters: 200, epoch: 31 | loss: 0.0000455
	speed: 0.0193s/iter; left time: 554.3618s
	iters: 300, epoch: 31 | loss: 0.0000008
	speed: 0.0192s/iter; left time: 550.5597s
	iters: 400, epoch: 31 | loss: 0.0000005
	speed: 0.0194s/iter; left time: 553.8616s
Epoch: 31 cost time: 8.423256158828735
Epoch: 31, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000153
	speed: 0.0629s/iter; left time: 1786.3556s
	iters: 200, epoch: 32 | loss: 0.0018166
	speed: 0.0194s/iter; left time: 549.8640s
	iters: 300, epoch: 32 | loss: 0.0002737
	speed: 0.0198s/iter; left time: 558.5409s
	iters: 400, epoch: 32 | loss: 0.0000012
	speed: 0.0191s/iter; left time: 537.3932s
Epoch: 32 cost time: 8.447924137115479
Epoch: 32, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000001
	speed: 0.0608s/iter; left time: 1701.6206s
	iters: 200, epoch: 33 | loss: 0.0001502
	speed: 0.0187s/iter; left time: 520.0793s
	iters: 300, epoch: 33 | loss: 0.0682852
	speed: 0.0182s/iter; left time: 506.0442s
	iters: 400, epoch: 33 | loss: 0.0000860
	speed: 0.0187s/iter; left time: 518.5151s
Epoch: 33 cost time: 8.183913946151733
Epoch: 33, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 50734
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9974896
	speed: 0.0381s/iter; left time: 1569.6314s
	iters: 200, epoch: 1 | loss: 0.2773882
	speed: 0.0180s/iter; left time: 738.5011s
	iters: 300, epoch: 1 | loss: 0.3262354
	speed: 0.0186s/iter; left time: 762.2654s
	iters: 400, epoch: 1 | loss: 0.4938774
	speed: 0.0206s/iter; left time: 843.8788s
Epoch: 1 cost time: 9.840553760528564
Epoch: 1, Steps: 413 | Train Loss: 0.789 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (inf --> -0.944064).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1857841
	speed: 0.0653s/iter; left time: 2665.4788s
	iters: 200, epoch: 2 | loss: 0.0310908
	speed: 0.0187s/iter; left time: 759.4576s
	iters: 300, epoch: 2 | loss: 0.0375415
	speed: 0.0201s/iter; left time: 817.0028s
	iters: 400, epoch: 2 | loss: 0.0165038
	speed: 0.0200s/iter; left time: 811.3880s
Epoch: 2 cost time: 8.482842683792114
Epoch: 2, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.111 Vali Acc: 0.964 Test Loss: 0.111 Test Acc: 0.964
Validation loss decreased (-0.944064 --> -0.963619).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1050859
	speed: 0.0639s/iter; left time: 2579.5212s
	iters: 200, epoch: 3 | loss: 0.0209906
	speed: 0.0200s/iter; left time: 807.1706s
	iters: 300, epoch: 3 | loss: 0.0760489
	speed: 0.0196s/iter; left time: 788.3567s
	iters: 400, epoch: 3 | loss: 0.0264885
	speed: 0.0193s/iter; left time: 771.9108s
Epoch: 3 cost time: 8.418216943740845
Epoch: 3, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
Validation loss decreased (-0.963619 --> -0.969985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0470857
	speed: 0.0639s/iter; left time: 2554.0399s
	iters: 200, epoch: 4 | loss: 0.0050110
	speed: 0.0191s/iter; left time: 760.2500s
	iters: 300, epoch: 4 | loss: 0.0402051
	speed: 0.0182s/iter; left time: 721.9979s
	iters: 400, epoch: 4 | loss: 0.0656144
	speed: 0.0187s/iter; left time: 739.7833s
Epoch: 4 cost time: 8.267451047897339
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.969985 --> -0.976352).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0502601
	speed: 0.0650s/iter; left time: 2572.1820s
	iters: 200, epoch: 5 | loss: 0.0080225
	speed: 0.0194s/iter; left time: 766.4199s
	iters: 300, epoch: 5 | loss: 0.4023536
	speed: 0.0191s/iter; left time: 750.9461s
	iters: 400, epoch: 5 | loss: 0.0167921
	speed: 0.0179s/iter; left time: 700.9540s
Epoch: 5 cost time: 8.253448247909546
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0435725
	speed: 0.0612s/iter; left time: 2395.7168s
	iters: 200, epoch: 6 | loss: 0.0060520
	speed: 0.0184s/iter; left time: 716.8385s
	iters: 300, epoch: 6 | loss: 0.0095599
	speed: 0.0182s/iter; left time: 708.6893s
	iters: 400, epoch: 6 | loss: 0.0707023
	speed: 0.0185s/iter; left time: 717.2133s
Epoch: 6 cost time: 7.940114259719849
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0014334
	speed: 0.0627s/iter; left time: 2426.5824s
	iters: 200, epoch: 7 | loss: 0.0140740
	speed: 0.0182s/iter; left time: 701.4870s
	iters: 300, epoch: 7 | loss: 0.0289505
	speed: 0.0181s/iter; left time: 695.3555s
	iters: 400, epoch: 7 | loss: 0.0036313
	speed: 0.0184s/iter; left time: 706.4630s
Epoch: 7 cost time: 7.936180353164673
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1690943
	speed: 0.0608s/iter; left time: 2328.5005s
	iters: 200, epoch: 8 | loss: 0.0100141
	speed: 0.0190s/iter; left time: 724.1470s
	iters: 300, epoch: 8 | loss: 0.0287111
	speed: 0.0192s/iter; left time: 731.6555s
	iters: 400, epoch: 8 | loss: 0.0025648
	speed: 0.0192s/iter; left time: 729.5134s
Epoch: 8 cost time: 8.238132238388062
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.976352 --> -0.979990).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0051987
	speed: 0.0644s/iter; left time: 2442.0775s
	iters: 200, epoch: 9 | loss: 0.0009599
	speed: 0.0198s/iter; left time: 746.6578s
	iters: 300, epoch: 9 | loss: 0.0320328
	speed: 0.0196s/iter; left time: 739.1331s
	iters: 400, epoch: 9 | loss: 0.0477862
	speed: 0.0201s/iter; left time: 756.2220s
Epoch: 9 cost time: 8.604483842849731
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0125215
	speed: 0.0645s/iter; left time: 2417.5842s
	iters: 200, epoch: 10 | loss: 0.0046694
	speed: 0.0199s/iter; left time: 745.4779s
	iters: 300, epoch: 10 | loss: 0.0013320
	speed: 0.0193s/iter; left time: 719.7336s
	iters: 400, epoch: 10 | loss: 0.0038154
	speed: 0.0197s/iter; left time: 734.0177s
Epoch: 10 cost time: 8.586951494216919
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0018111
	speed: 0.0630s/iter; left time: 2336.9911s
	iters: 200, epoch: 11 | loss: 0.0046572
	speed: 0.0201s/iter; left time: 741.8934s
	iters: 300, epoch: 11 | loss: 0.0935086
	speed: 0.0202s/iter; left time: 746.4592s
	iters: 400, epoch: 11 | loss: 0.0059914
	speed: 0.0182s/iter; left time: 667.9383s
Epoch: 11 cost time: 8.468831777572632
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0001859
	speed: 0.0590s/iter; left time: 2162.3746s
	iters: 200, epoch: 12 | loss: 0.0003985
	speed: 0.0189s/iter; left time: 689.4964s
	iters: 300, epoch: 12 | loss: 0.0020952
	speed: 0.0186s/iter; left time: 677.6918s
	iters: 400, epoch: 12 | loss: 0.4182324
	speed: 0.0191s/iter; left time: 692.9538s
Epoch: 12 cost time: 8.130714893341064
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0002946
	speed: 0.0599s/iter; left time: 2172.8632s
	iters: 200, epoch: 13 | loss: 0.0025978
	speed: 0.0185s/iter; left time: 668.2467s
	iters: 300, epoch: 13 | loss: 0.0000612
	speed: 0.0184s/iter; left time: 661.9104s
	iters: 400, epoch: 13 | loss: 0.0018690
	speed: 0.0197s/iter; left time: 709.3915s
Epoch: 13 cost time: 7.987488031387329
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0025918
	speed: 0.0646s/iter; left time: 2313.4799s
	iters: 200, epoch: 14 | loss: 0.0023066
	speed: 0.0181s/iter; left time: 647.6796s
	iters: 300, epoch: 14 | loss: 0.0126695
	speed: 0.0192s/iter; left time: 683.9642s
	iters: 400, epoch: 14 | loss: 0.0018094
	speed: 0.0196s/iter; left time: 695.6878s
Epoch: 14 cost time: 8.144087076187134
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0003057
	speed: 0.0608s/iter; left time: 2153.4165s
	iters: 200, epoch: 15 | loss: 0.0160153
	speed: 0.0192s/iter; left time: 679.4845s
	iters: 300, epoch: 15 | loss: 0.0002629
	speed: 0.0202s/iter; left time: 711.3329s
	iters: 400, epoch: 15 | loss: 0.0001058
	speed: 0.0211s/iter; left time: 741.1917s
Epoch: 15 cost time: 8.523222923278809
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0011295
	speed: 0.0628s/iter; left time: 2197.9531s
	iters: 200, epoch: 16 | loss: 0.0002307
	speed: 0.0191s/iter; left time: 664.9687s
	iters: 300, epoch: 16 | loss: 0.0009217
	speed: 0.0184s/iter; left time: 639.5350s
	iters: 400, epoch: 16 | loss: 0.0000592
	speed: 0.0192s/iter; left time: 664.6332s
Epoch: 16 cost time: 8.214363098144531
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000381
	speed: 0.0650s/iter; left time: 2249.4807s
	iters: 200, epoch: 17 | loss: 0.0001060
	speed: 0.0184s/iter; left time: 636.2423s
	iters: 300, epoch: 17 | loss: 0.0000637
	speed: 0.0188s/iter; left time: 648.0519s
	iters: 400, epoch: 17 | loss: 0.0035270
	speed: 0.0194s/iter; left time: 666.1073s
Epoch: 17 cost time: 8.257465124130249
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0123607
	speed: 0.0625s/iter; left time: 2137.6181s
	iters: 200, epoch: 18 | loss: 0.0000541
	speed: 0.0207s/iter; left time: 705.0053s
	iters: 300, epoch: 18 | loss: 0.0041716
	speed: 0.0192s/iter; left time: 652.4875s
	iters: 400, epoch: 18 | loss: 0.0788322
	speed: 0.0196s/iter; left time: 663.7145s
Epoch: 18 cost time: 8.549220085144043
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 50734
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1646935
	speed: 0.0359s/iter; left time: 1478.2385s
	iters: 200, epoch: 1 | loss: 0.3316234
	speed: 0.0182s/iter; left time: 747.3643s
	iters: 300, epoch: 1 | loss: 0.3765832
	speed: 0.0183s/iter; left time: 748.4242s
	iters: 400, epoch: 1 | loss: 0.5033848
	speed: 0.0181s/iter; left time: 739.7182s
Epoch: 1 cost time: 9.326234579086304
Epoch: 1, Steps: 413 | Train Loss: 0.861 Vali Loss: 0.214 Vali Acc: 0.936 Test Loss: 0.214 Test Acc: 0.936
Validation loss decreased (inf --> -0.935878).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1756816
	speed: 0.0572s/iter; left time: 2334.5473s
	iters: 200, epoch: 2 | loss: 0.0621235
	speed: 0.0175s/iter; left time: 710.2847s
	iters: 300, epoch: 2 | loss: 0.0672099
	speed: 0.0163s/iter; left time: 660.0657s
	iters: 400, epoch: 2 | loss: 0.0127044
	speed: 0.0187s/iter; left time: 755.5674s
Epoch: 2 cost time: 7.627282619476318
Epoch: 2, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.122 Vali Acc: 0.958 Test Loss: 0.122 Test Acc: 0.958
Validation loss decreased (-0.935878 --> -0.958162).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1089778
	speed: 0.0574s/iter; left time: 2315.8614s
	iters: 200, epoch: 3 | loss: 0.0289409
	speed: 0.0192s/iter; left time: 771.6120s
	iters: 300, epoch: 3 | loss: 0.0732085
	speed: 0.0195s/iter; left time: 783.3848s
	iters: 400, epoch: 3 | loss: 0.0850324
	speed: 0.0179s/iter; left time: 717.4482s
Epoch: 3 cost time: 8.116185426712036
Epoch: 3, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
Validation loss decreased (-0.958162 --> -0.971350).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0586974
	speed: 0.0622s/iter; left time: 2486.7008s
	iters: 200, epoch: 4 | loss: 0.0099357
	speed: 0.0192s/iter; left time: 763.4042s
	iters: 300, epoch: 4 | loss: 0.0587195
	speed: 0.0190s/iter; left time: 753.9916s
	iters: 400, epoch: 4 | loss: 0.1418234
	speed: 0.0201s/iter; left time: 795.4197s
Epoch: 4 cost time: 8.296027421951294
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
Validation loss decreased (-0.971350 --> -0.974078).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0675051
	speed: 0.0590s/iter; left time: 2332.5930s
	iters: 200, epoch: 5 | loss: 0.0105764
	speed: 0.0185s/iter; left time: 728.4496s
	iters: 300, epoch: 5 | loss: 0.6754583
	speed: 0.0180s/iter; left time: 709.8452s
	iters: 400, epoch: 5 | loss: 0.0201670
	speed: 0.0183s/iter; left time: 719.3463s
Epoch: 5 cost time: 7.9122633934021
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
Validation loss decreased (-0.974078 --> -0.974533).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0503012
	speed: 0.0596s/iter; left time: 2331.7120s
	iters: 200, epoch: 6 | loss: 0.0015313
	speed: 0.0179s/iter; left time: 697.4001s
	iters: 300, epoch: 6 | loss: 0.0072066
	speed: 0.0184s/iter; left time: 717.5657s
	iters: 400, epoch: 6 | loss: 0.1337275
	speed: 0.0183s/iter; left time: 712.2072s
Epoch: 6 cost time: 7.762544870376587
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
Validation loss decreased (-0.974533 --> -0.979990).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0018970
	speed: 0.0635s/iter; left time: 2458.0383s
	iters: 200, epoch: 7 | loss: 0.0500653
	speed: 0.0169s/iter; left time: 652.9314s
	iters: 300, epoch: 7 | loss: 0.0402530
	speed: 0.0171s/iter; left time: 660.2304s
	iters: 400, epoch: 7 | loss: 0.0172264
	speed: 0.0174s/iter; left time: 670.3291s
Epoch: 7 cost time: 7.426243543624878
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0182849
	speed: 0.0637s/iter; left time: 2442.1497s
	iters: 200, epoch: 8 | loss: 0.0053897
	speed: 0.0170s/iter; left time: 648.1490s
	iters: 300, epoch: 8 | loss: 0.0177156
	speed: 0.0175s/iter; left time: 666.6044s
	iters: 400, epoch: 8 | loss: 0.0224034
	speed: 0.0170s/iter; left time: 647.3222s
Epoch: 8 cost time: 7.459352016448975
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0025295
	speed: 0.0600s/iter; left time: 2273.8680s
	iters: 200, epoch: 9 | loss: 0.0010628
	speed: 0.0193s/iter; left time: 728.9946s
	iters: 300, epoch: 9 | loss: 0.0676724
	speed: 0.0196s/iter; left time: 738.5573s
	iters: 400, epoch: 9 | loss: 0.0196346
	speed: 0.0207s/iter; left time: 778.2949s
Epoch: 9 cost time: 8.35684084892273
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0019662
	speed: 0.0624s/iter; left time: 2338.2234s
	iters: 200, epoch: 10 | loss: 0.0043087
	speed: 0.0197s/iter; left time: 736.3154s
	iters: 300, epoch: 10 | loss: 0.0007468
	speed: 0.0224s/iter; left time: 836.0279s
	iters: 400, epoch: 10 | loss: 0.0055762
	speed: 0.0207s/iter; left time: 768.2315s
Epoch: 10 cost time: 9.007674932479858
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.979990 --> -0.980900).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0084841
	speed: 0.0639s/iter; left time: 2370.5657s
	iters: 200, epoch: 11 | loss: 0.0004751
	speed: 0.0211s/iter; left time: 781.4240s
	iters: 300, epoch: 11 | loss: 0.4069757
	speed: 0.0208s/iter; left time: 766.6000s
	iters: 400, epoch: 11 | loss: 0.1616131
	speed: 0.0203s/iter; left time: 747.2495s
Epoch: 11 cost time: 8.952819585800171
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0004107
	speed: 0.0636s/iter; left time: 2330.3433s
	iters: 200, epoch: 12 | loss: 0.0007485
	speed: 0.0188s/iter; left time: 686.7083s
	iters: 300, epoch: 12 | loss: 0.0029366
	speed: 0.0193s/iter; left time: 704.7885s
	iters: 400, epoch: 12 | loss: 0.4296296
	speed: 0.0211s/iter; left time: 765.5409s
Epoch: 12 cost time: 8.661904096603394
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0003613
	speed: 0.0633s/iter; left time: 2294.0383s
	iters: 200, epoch: 13 | loss: 0.0083921
	speed: 0.0204s/iter; left time: 735.7160s
	iters: 300, epoch: 13 | loss: 0.0009183
	speed: 0.0205s/iter; left time: 739.8246s
	iters: 400, epoch: 13 | loss: 0.0031617
	speed: 0.0202s/iter; left time: 727.7121s
Epoch: 13 cost time: 8.83588171005249
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.160 Vali Acc: 0.968 Test Loss: 0.160 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0035899
	speed: 0.0681s/iter; left time: 2440.2817s
	iters: 200, epoch: 14 | loss: 0.0083942
	speed: 0.0184s/iter; left time: 657.8104s
	iters: 300, epoch: 14 | loss: 0.0024131
	speed: 0.0181s/iter; left time: 646.2473s
	iters: 400, epoch: 14 | loss: 0.0010725
	speed: 0.0174s/iter; left time: 617.0174s
Epoch: 14 cost time: 7.926098823547363
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000400
	speed: 0.0620s/iter; left time: 2194.4897s
	iters: 200, epoch: 15 | loss: 0.0072687
	speed: 0.0178s/iter; left time: 627.1232s
	iters: 300, epoch: 15 | loss: 0.0001594
	speed: 0.0173s/iter; left time: 608.7533s
	iters: 400, epoch: 15 | loss: 0.0000161
	speed: 0.0173s/iter; left time: 607.3414s
Epoch: 15 cost time: 7.532123804092407
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0028997
	speed: 0.0616s/iter; left time: 2156.9681s
	iters: 200, epoch: 16 | loss: 0.0002662
	speed: 0.0177s/iter; left time: 616.9931s
	iters: 300, epoch: 16 | loss: 0.0000051
	speed: 0.0176s/iter; left time: 612.5295s
	iters: 400, epoch: 16 | loss: 0.0000910
	speed: 0.0176s/iter; left time: 611.6937s
Epoch: 16 cost time: 7.647509813308716
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000894
	speed: 0.0612s/iter; left time: 2117.1326s
	iters: 200, epoch: 17 | loss: 0.0001533
	speed: 0.0179s/iter; left time: 618.0310s
	iters: 300, epoch: 17 | loss: 0.0007066
	speed: 0.0180s/iter; left time: 618.6793s
	iters: 400, epoch: 17 | loss: 0.0004127
	speed: 0.0175s/iter; left time: 601.6055s
Epoch: 17 cost time: 7.673038005828857
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0714202
	speed: 0.0590s/iter; left time: 2017.7788s
	iters: 200, epoch: 18 | loss: 0.0000090
	speed: 0.0195s/iter; left time: 665.8506s
	iters: 300, epoch: 18 | loss: 0.0016191
	speed: 0.0192s/iter; left time: 653.0626s
	iters: 400, epoch: 18 | loss: 0.0156836
	speed: 0.0195s/iter; left time: 660.7239s
Epoch: 18 cost time: 8.310814380645752
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0001911
	speed: 0.0609s/iter; left time: 2057.3912s
	iters: 200, epoch: 19 | loss: 0.0000261
	speed: 0.0196s/iter; left time: 659.2329s
	iters: 300, epoch: 19 | loss: 0.0000173
	speed: 0.0193s/iter; left time: 649.4440s
	iters: 400, epoch: 19 | loss: 0.0011223
	speed: 0.0197s/iter; left time: 659.8434s
Epoch: 19 cost time: 8.480960130691528
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000046
	speed: 0.0595s/iter; left time: 1985.1354s
	iters: 200, epoch: 20 | loss: 0.0000522
	speed: 0.0190s/iter; left time: 631.5943s
	iters: 300, epoch: 20 | loss: 0.0001466
	speed: 0.0198s/iter; left time: 655.5495s
	iters: 400, epoch: 20 | loss: 0.0003465
	speed: 0.0185s/iter; left time: 610.9393s
Epoch: 20 cost time: 8.328808784484863
Epoch: 20, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 50734
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4674423
	speed: 0.0367s/iter; left time: 1513.8517s
	iters: 200, epoch: 1 | loss: 0.4964839
	speed: 0.0181s/iter; left time: 741.9308s
	iters: 300, epoch: 1 | loss: 0.4627426
	speed: 0.0177s/iter; left time: 723.8383s
	iters: 400, epoch: 1 | loss: 0.6499940
	speed: 0.0181s/iter; left time: 740.9056s
Epoch: 1 cost time: 9.328705787658691
Epoch: 1, Steps: 413 | Train Loss: 1.023 Vali Loss: 0.266 Vali Acc: 0.928 Test Loss: 0.266 Test Acc: 0.928
Validation loss decreased (inf --> -0.927692).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2149864
	speed: 0.0597s/iter; left time: 2435.4634s
	iters: 200, epoch: 2 | loss: 0.0907537
	speed: 0.0194s/iter; left time: 790.6689s
	iters: 300, epoch: 2 | loss: 0.0937419
	speed: 0.0195s/iter; left time: 790.8391s
	iters: 400, epoch: 2 | loss: 0.0303316
	speed: 0.0196s/iter; left time: 791.6005s
Epoch: 2 cost time: 8.244199514389038
Epoch: 2, Steps: 413 | Train Loss: 0.200 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
Validation loss decreased (-0.927692 --> -0.960435).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0938225
	speed: 0.0631s/iter; left time: 2546.3685s
	iters: 200, epoch: 3 | loss: 0.1046167
	speed: 0.0197s/iter; left time: 793.8454s
	iters: 300, epoch: 3 | loss: 0.0793469
	speed: 0.0195s/iter; left time: 782.0762s
	iters: 400, epoch: 3 | loss: 0.1038026
	speed: 0.0187s/iter; left time: 749.7488s
Epoch: 3 cost time: 8.296320676803589
Epoch: 3, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
Validation loss decreased (-0.960435 --> -0.965438).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0420031
	speed: 0.0648s/iter; left time: 2589.2942s
	iters: 200, epoch: 4 | loss: 0.0091912
	speed: 0.0192s/iter; left time: 764.3908s
	iters: 300, epoch: 4 | loss: 0.0579134
	speed: 0.0201s/iter; left time: 798.4972s
	iters: 400, epoch: 4 | loss: 0.1810850
	speed: 0.0201s/iter; left time: 796.4298s
Epoch: 4 cost time: 8.554121255874634
Epoch: 4, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.106 Vali Acc: 0.963 Test Loss: 0.106 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0106050
	speed: 0.0629s/iter; left time: 2487.0188s
	iters: 200, epoch: 5 | loss: 0.0231075
	speed: 0.0180s/iter; left time: 710.4495s
	iters: 300, epoch: 5 | loss: 0.4076240
	speed: 0.0191s/iter; left time: 752.0183s
	iters: 400, epoch: 5 | loss: 0.0221223
	speed: 0.0186s/iter; left time: 728.5531s
Epoch: 5 cost time: 8.17347264289856
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.965438 --> -0.970440).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0228997
	speed: 0.0606s/iter; left time: 2372.7144s
	iters: 200, epoch: 6 | loss: 0.0065412
	speed: 0.0182s/iter; left time: 709.6016s
	iters: 300, epoch: 6 | loss: 0.0179556
	speed: 0.0181s/iter; left time: 706.1327s
	iters: 400, epoch: 6 | loss: 0.0259796
	speed: 0.0187s/iter; left time: 727.1165s
Epoch: 6 cost time: 7.908171892166138
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.970440 --> -0.972714).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0182839
	speed: 0.0602s/iter; left time: 2332.5077s
	iters: 200, epoch: 7 | loss: 0.1804187
	speed: 0.0177s/iter; left time: 684.4898s
	iters: 300, epoch: 7 | loss: 0.2267252
	speed: 0.0178s/iter; left time: 687.2170s
	iters: 400, epoch: 7 | loss: 0.0073831
	speed: 0.0180s/iter; left time: 692.3906s
Epoch: 7 cost time: 7.664032220840454
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.972714 --> -0.973169).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1322450
	speed: 0.0599s/iter; left time: 2296.2727s
	iters: 200, epoch: 8 | loss: 0.0013809
	speed: 0.0192s/iter; left time: 735.3176s
	iters: 300, epoch: 8 | loss: 0.0997908
	speed: 0.0194s/iter; left time: 741.2317s
	iters: 400, epoch: 8 | loss: 0.0635495
	speed: 0.0195s/iter; left time: 739.7796s
Epoch: 8 cost time: 8.370769262313843
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.974533).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0217409
	speed: 0.0620s/iter; left time: 2348.8316s
	iters: 200, epoch: 9 | loss: 0.0003523
	speed: 0.0186s/iter; left time: 704.4988s
	iters: 300, epoch: 9 | loss: 0.0107520
	speed: 0.0198s/iter; left time: 745.4439s
	iters: 400, epoch: 9 | loss: 0.0108499
	speed: 0.0202s/iter; left time: 758.6940s
Epoch: 9 cost time: 8.475756645202637
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0086370
	speed: 0.0624s/iter; left time: 2338.1232s
	iters: 200, epoch: 10 | loss: 0.0610623
	speed: 0.0190s/iter; left time: 708.4634s
	iters: 300, epoch: 10 | loss: 0.0367814
	speed: 0.0190s/iter; left time: 710.2180s
	iters: 400, epoch: 10 | loss: 0.0419127
	speed: 0.0191s/iter; left time: 710.2596s
Epoch: 10 cost time: 8.26322627067566
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0014624
	speed: 0.0626s/iter; left time: 2319.5797s
	iters: 200, epoch: 11 | loss: 0.0019575
	speed: 0.0193s/iter; left time: 712.0277s
	iters: 300, epoch: 11 | loss: 0.1828857
	speed: 0.0185s/iter; left time: 681.9837s
	iters: 400, epoch: 11 | loss: 0.0018961
	speed: 0.0188s/iter; left time: 689.5821s
Epoch: 11 cost time: 8.276095151901245
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.974533 --> -0.979990).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0035824
	speed: 0.0635s/iter; left time: 2328.8980s
	iters: 200, epoch: 12 | loss: 0.0015827
	speed: 0.0189s/iter; left time: 690.1186s
	iters: 300, epoch: 12 | loss: 0.0004015
	speed: 0.0180s/iter; left time: 656.1061s
	iters: 400, epoch: 12 | loss: 0.0073838
	speed: 0.0179s/iter; left time: 650.5722s
Epoch: 12 cost time: 8.042698860168457
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0019522
	speed: 0.0583s/iter; left time: 2113.2573s
	iters: 200, epoch: 13 | loss: 0.0037398
	speed: 0.0172s/iter; left time: 622.1861s
	iters: 300, epoch: 13 | loss: 0.0041428
	speed: 0.0171s/iter; left time: 615.5868s
	iters: 400, epoch: 13 | loss: 0.0055833
	speed: 0.0169s/iter; left time: 606.8308s
Epoch: 13 cost time: 7.478183031082153
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0007429
	speed: 0.0592s/iter; left time: 2120.8547s
	iters: 200, epoch: 14 | loss: 0.0001406
	speed: 0.0169s/iter; left time: 602.5267s
	iters: 300, epoch: 14 | loss: 0.0003162
	speed: 0.0165s/iter; left time: 589.1710s
	iters: 400, epoch: 14 | loss: 0.0161133
	speed: 0.0177s/iter; left time: 628.8208s
Epoch: 14 cost time: 7.467516660690308
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.144 Vali Acc: 0.972 Test Loss: 0.144 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0010721
	speed: 0.0609s/iter; left time: 2157.9037s
	iters: 200, epoch: 15 | loss: 0.0100416
	speed: 0.0186s/iter; left time: 657.1536s
	iters: 300, epoch: 15 | loss: 0.1255352
	speed: 0.0201s/iter; left time: 706.5989s
	iters: 400, epoch: 15 | loss: 0.0027707
	speed: 0.0182s/iter; left time: 639.8098s
Epoch: 15 cost time: 8.059126615524292
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000932
	speed: 0.0609s/iter; left time: 2132.5171s
	iters: 200, epoch: 16 | loss: 0.0017191
	speed: 0.0188s/iter; left time: 655.0830s
	iters: 300, epoch: 16 | loss: 0.0000112
	speed: 0.0187s/iter; left time: 649.4839s
	iters: 400, epoch: 16 | loss: 0.0014800
	speed: 0.0190s/iter; left time: 658.0060s
Epoch: 16 cost time: 8.174351930618286
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000720
	speed: 0.0614s/iter; left time: 2122.8063s
	iters: 200, epoch: 17 | loss: 0.0033690
	speed: 0.0186s/iter; left time: 641.2096s
	iters: 300, epoch: 17 | loss: 0.0002103
	speed: 0.0181s/iter; left time: 622.4519s
	iters: 400, epoch: 17 | loss: 0.0013938
	speed: 0.0187s/iter; left time: 640.4964s
Epoch: 17 cost time: 8.059928894042969
Epoch: 17, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0255555
	speed: 0.0614s/iter; left time: 2098.8667s
	iters: 200, epoch: 18 | loss: 0.0154534
	speed: 0.0195s/iter; left time: 663.2670s
	iters: 300, epoch: 18 | loss: 0.0006629
	speed: 0.0190s/iter; left time: 644.5848s
	iters: 400, epoch: 18 | loss: 0.0001896
	speed: 0.0197s/iter; left time: 666.5394s
Epoch: 18 cost time: 8.365095853805542
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0001942
	speed: 0.0629s/iter; left time: 2124.2658s
	iters: 200, epoch: 19 | loss: 0.0003236
	speed: 0.0168s/iter; left time: 565.1216s
	iters: 300, epoch: 19 | loss: 0.0001220
	speed: 0.0173s/iter; left time: 580.5168s
	iters: 400, epoch: 19 | loss: 0.0004171
	speed: 0.0184s/iter; left time: 617.0631s
Epoch: 19 cost time: 7.702206373214722
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000502
	speed: 0.0609s/iter; left time: 2030.1094s
	iters: 200, epoch: 20 | loss: 0.0026257
	speed: 0.0175s/iter; left time: 582.0220s
	iters: 300, epoch: 20 | loss: 0.0006542
	speed: 0.0177s/iter; left time: 586.9829s
	iters: 400, epoch: 20 | loss: 0.0000624
	speed: 0.0174s/iter; left time: 575.9611s
Epoch: 20 cost time: 7.594107627868652
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0014331
	speed: 0.0619s/iter; left time: 2040.3942s
	iters: 200, epoch: 21 | loss: 0.0000079
	speed: 0.0178s/iter; left time: 585.8379s
	iters: 300, epoch: 21 | loss: 0.0002998
	speed: 0.0180s/iter; left time: 588.6101s
	iters: 400, epoch: 21 | loss: 0.0521092
	speed: 0.0179s/iter; left time: 583.7988s
Epoch: 21 cost time: 7.740979909896851
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 50734
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1618638
	speed: 0.0376s/iter; left time: 1549.9265s
	iters: 200, epoch: 1 | loss: 0.7282518
	speed: 0.0194s/iter; left time: 798.6027s
	iters: 300, epoch: 1 | loss: 0.2796852
	speed: 0.0205s/iter; left time: 841.0311s
	iters: 400, epoch: 1 | loss: 0.1974195
	speed: 0.0198s/iter; left time: 807.9076s
Epoch: 1 cost time: 9.988369941711426
Epoch: 1, Steps: 413 | Train Loss: 0.742 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0183297
	speed: 0.0608s/iter; left time: 2479.9312s
	iters: 200, epoch: 2 | loss: 0.0588118
	speed: 0.0181s/iter; left time: 738.4718s
	iters: 300, epoch: 2 | loss: 0.0075711
	speed: 0.0178s/iter; left time: 721.6229s
	iters: 400, epoch: 2 | loss: 0.0348872
	speed: 0.0191s/iter; left time: 773.1837s
Epoch: 2 cost time: 7.962903738021851
Epoch: 2, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
Validation loss decreased (-0.959071 --> -0.965438).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0325617
	speed: 0.0621s/iter; left time: 2508.9185s
	iters: 200, epoch: 3 | loss: 0.0205442
	speed: 0.0197s/iter; left time: 795.0394s
	iters: 300, epoch: 3 | loss: 0.0098545
	speed: 0.0199s/iter; left time: 798.7957s
	iters: 400, epoch: 3 | loss: 0.0248504
	speed: 0.0192s/iter; left time: 768.6241s
Epoch: 3 cost time: 8.450165510177612
Epoch: 3, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.063 Vali Acc: 0.979 Test Loss: 0.063 Test Acc: 0.979
Validation loss decreased (-0.965438 --> -0.979081).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1010991
	speed: 0.0645s/iter; left time: 2578.7578s
	iters: 200, epoch: 4 | loss: 0.2714486
	speed: 0.0188s/iter; left time: 747.9131s
	iters: 300, epoch: 4 | loss: 0.0805940
	speed: 0.0188s/iter; left time: 748.3568s
	iters: 400, epoch: 4 | loss: 0.1566354
	speed: 0.0184s/iter; left time: 728.8832s
Epoch: 4 cost time: 8.078563928604126
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1010328
	speed: 0.0643s/iter; left time: 2544.2667s
	iters: 200, epoch: 5 | loss: 0.0012143
	speed: 0.0179s/iter; left time: 708.0004s
	iters: 300, epoch: 5 | loss: 0.0097084
	speed: 0.0177s/iter; left time: 694.7075s
	iters: 400, epoch: 5 | loss: 0.0326924
	speed: 0.0185s/iter; left time: 725.4238s
Epoch: 5 cost time: 7.919695854187012
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0047388
	speed: 0.0629s/iter; left time: 2463.0156s
	iters: 200, epoch: 6 | loss: 0.0016059
	speed: 0.0182s/iter; left time: 712.3487s
	iters: 300, epoch: 6 | loss: 0.0023890
	speed: 0.0175s/iter; left time: 681.8507s
	iters: 400, epoch: 6 | loss: 0.0008453
	speed: 0.0186s/iter; left time: 722.9671s
Epoch: 6 cost time: 7.949626445770264
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0045943
	speed: 0.0655s/iter; left time: 2535.5830s
	iters: 200, epoch: 7 | loss: 0.0139098
	speed: 0.0202s/iter; left time: 780.1624s
	iters: 300, epoch: 7 | loss: 0.0166249
	speed: 0.0207s/iter; left time: 796.9994s
	iters: 400, epoch: 7 | loss: 0.0061859
	speed: 0.0191s/iter; left time: 733.8401s
Epoch: 7 cost time: 8.53383994102478
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0035003
	speed: 0.0635s/iter; left time: 2432.8000s
	iters: 200, epoch: 8 | loss: 0.0003244
	speed: 0.0192s/iter; left time: 732.4668s
	iters: 300, epoch: 8 | loss: 0.0115373
	speed: 0.0182s/iter; left time: 692.8188s
	iters: 400, epoch: 8 | loss: 0.0007560
	speed: 0.0181s/iter; left time: 687.2340s
Epoch: 8 cost time: 8.267122268676758
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.078 Vali Acc: 0.974 Test Loss: 0.078 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0204087
	speed: 0.0604s/iter; left time: 2288.9651s
	iters: 200, epoch: 9 | loss: 0.0047138
	speed: 0.0194s/iter; left time: 731.4074s
	iters: 300, epoch: 9 | loss: 0.0062502
	speed: 0.0168s/iter; left time: 632.4074s
	iters: 400, epoch: 9 | loss: 0.0005543
	speed: 0.0172s/iter; left time: 647.5217s
Epoch: 9 cost time: 7.708003759384155
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0003154
	speed: 0.0626s/iter; left time: 2345.9562s
	iters: 200, epoch: 10 | loss: 0.0026403
	speed: 0.0198s/iter; left time: 738.9319s
	iters: 300, epoch: 10 | loss: 0.0009185
	speed: 0.0193s/iter; left time: 719.7679s
	iters: 400, epoch: 10 | loss: 0.0003454
	speed: 0.0181s/iter; left time: 672.9515s
Epoch: 10 cost time: 8.229890823364258
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0172845
	speed: 0.0641s/iter; left time: 2376.8208s
	iters: 200, epoch: 11 | loss: 0.0023478
	speed: 0.0185s/iter; left time: 684.3812s
	iters: 300, epoch: 11 | loss: 0.0039515
	speed: 0.0181s/iter; left time: 666.3580s
	iters: 400, epoch: 11 | loss: 0.0137258
	speed: 0.0185s/iter; left time: 681.0529s
Epoch: 11 cost time: 7.98207688331604
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.972 Test Loss: 0.093 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0070817
	speed: 0.0613s/iter; left time: 2246.6870s
	iters: 200, epoch: 12 | loss: 0.0023883
	speed: 0.0185s/iter; left time: 675.7004s
	iters: 300, epoch: 12 | loss: 0.0021878
	speed: 0.0183s/iter; left time: 668.7387s
	iters: 400, epoch: 12 | loss: 0.0001910
	speed: 0.0188s/iter; left time: 685.0554s
Epoch: 12 cost time: 8.041886329650879
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979990).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0030036
	speed: 0.0661s/iter; left time: 2394.0505s
	iters: 200, epoch: 13 | loss: 0.0008131
	speed: 0.0186s/iter; left time: 673.9491s
	iters: 300, epoch: 13 | loss: 0.0070960
	speed: 0.0191s/iter; left time: 687.5856s
	iters: 400, epoch: 13 | loss: 0.0005789
	speed: 0.0191s/iter; left time: 685.6780s
Epoch: 13 cost time: 8.125148057937622
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0125322
	speed: 0.0650s/iter; left time: 2328.1234s
	iters: 200, epoch: 14 | loss: 0.3979504
	speed: 0.0187s/iter; left time: 668.3127s
	iters: 300, epoch: 14 | loss: 0.0095701
	speed: 0.0186s/iter; left time: 664.0493s
	iters: 400, epoch: 14 | loss: 0.0017479
	speed: 0.0188s/iter; left time: 669.1324s
Epoch: 14 cost time: 8.095013856887817
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0033868
	speed: 0.0661s/iter; left time: 2341.6243s
	iters: 200, epoch: 15 | loss: 0.0033979
	speed: 0.0195s/iter; left time: 687.0528s
	iters: 300, epoch: 15 | loss: 0.0001781
	speed: 0.0190s/iter; left time: 667.7647s
	iters: 400, epoch: 15 | loss: 0.0000083
	speed: 0.0184s/iter; left time: 645.4351s
Epoch: 15 cost time: 8.249232292175293
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.979990 --> -0.981354).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000056
	speed: 0.0629s/iter; left time: 2201.9825s
	iters: 200, epoch: 16 | loss: 0.0001122
	speed: 0.0201s/iter; left time: 703.3273s
	iters: 300, epoch: 16 | loss: 0.0042503
	speed: 0.0214s/iter; left time: 746.0413s
	iters: 400, epoch: 16 | loss: 0.4203351
	speed: 0.0197s/iter; left time: 683.5840s
Epoch: 16 cost time: 8.689995050430298
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000237
	speed: 0.0607s/iter; left time: 2098.8969s
	iters: 200, epoch: 17 | loss: 0.0001751
	speed: 0.0172s/iter; left time: 592.8321s
	iters: 300, epoch: 17 | loss: 0.0038705
	speed: 0.0184s/iter; left time: 632.2395s
	iters: 400, epoch: 17 | loss: 0.0193047
	speed: 0.0169s/iter; left time: 577.9943s
Epoch: 17 cost time: 7.723844289779663
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0005371
	speed: 0.0575s/iter; left time: 1963.9018s
	iters: 200, epoch: 18 | loss: 0.0529293
	speed: 0.0188s/iter; left time: 640.9319s
	iters: 300, epoch: 18 | loss: 0.0013164
	speed: 0.0190s/iter; left time: 644.8335s
	iters: 400, epoch: 18 | loss: 0.0000701
	speed: 0.0175s/iter; left time: 593.9095s
Epoch: 18 cost time: 7.945759296417236
Epoch: 18, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000635
	speed: 0.0611s/iter; left time: 2062.1714s
	iters: 200, epoch: 19 | loss: 0.0731985
	speed: 0.0201s/iter; left time: 675.8585s
	iters: 300, epoch: 19 | loss: 0.0102460
	speed: 0.0189s/iter; left time: 633.4513s
	iters: 400, epoch: 19 | loss: 0.0000007
	speed: 0.0187s/iter; left time: 625.0337s
Epoch: 19 cost time: 8.273563861846924
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0001526
	speed: 0.0657s/iter; left time: 2190.6349s
	iters: 200, epoch: 20 | loss: 0.0000037
	speed: 0.0202s/iter; left time: 673.2408s
	iters: 300, epoch: 20 | loss: 0.0000019
	speed: 0.0197s/iter; left time: 654.4044s
	iters: 400, epoch: 20 | loss: 0.0157079
	speed: 0.0197s/iter; left time: 652.7912s
Epoch: 20 cost time: 8.741753339767456
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000155
	speed: 0.0643s/iter; left time: 2117.5923s
	iters: 200, epoch: 21 | loss: 0.0000616
	speed: 0.0189s/iter; left time: 622.0948s
	iters: 300, epoch: 21 | loss: 0.0000014
	speed: 0.0195s/iter; left time: 638.3870s
	iters: 400, epoch: 21 | loss: 0.0001997
	speed: 0.0191s/iter; left time: 622.1438s
Epoch: 21 cost time: 8.30328893661499
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0010998
	speed: 0.0646s/iter; left time: 2100.1518s
	iters: 200, epoch: 22 | loss: 0.0014233
	speed: 0.0189s/iter; left time: 612.7989s
	iters: 300, epoch: 22 | loss: 0.0009497
	speed: 0.0186s/iter; left time: 601.0089s
	iters: 400, epoch: 22 | loss: 0.0002605
	speed: 0.0196s/iter; left time: 632.7933s
Epoch: 22 cost time: 8.277567386627197
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0476649
	speed: 0.0644s/iter; left time: 2067.8538s
	iters: 200, epoch: 23 | loss: 0.0002176
	speed: 0.0203s/iter; left time: 648.7049s
	iters: 300, epoch: 23 | loss: 0.0000300
	speed: 0.0186s/iter; left time: 592.0981s
	iters: 400, epoch: 23 | loss: 0.0000033
	speed: 0.0186s/iter; left time: 590.3168s
Epoch: 23 cost time: 8.335028171539307
Epoch: 23, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0016610
	speed: 0.0633s/iter; left time: 2006.0476s
	iters: 200, epoch: 24 | loss: 0.0000587
	speed: 0.0180s/iter; left time: 569.8516s
	iters: 300, epoch: 24 | loss: 0.0000175
	speed: 0.0186s/iter; left time: 585.6893s
	iters: 400, epoch: 24 | loss: 0.0000185
	speed: 0.0173s/iter; left time: 543.0436s
Epoch: 24 cost time: 7.732593774795532
Epoch: 24, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000016
	speed: 0.0614s/iter; left time: 1920.2560s
	iters: 200, epoch: 25 | loss: 0.0000142
	speed: 0.0174s/iter; left time: 543.6955s
	iters: 300, epoch: 25 | loss: 0.0114879
	speed: 0.0175s/iter; left time: 542.7336s
	iters: 400, epoch: 25 | loss: 0.0217093
	speed: 0.0179s/iter; left time: 555.9195s
Epoch: 25 cost time: 7.675070762634277
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 42542
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1965656
	speed: 0.0354s/iter; left time: 1457.7523s
	iters: 200, epoch: 1 | loss: 0.7769231
	speed: 0.0176s/iter; left time: 724.9698s
	iters: 300, epoch: 1 | loss: 0.2688101
	speed: 0.0190s/iter; left time: 780.2557s
	iters: 400, epoch: 1 | loss: 0.1874334
	speed: 0.0177s/iter; left time: 724.9869s
Epoch: 1 cost time: 9.284478664398193
Epoch: 1, Steps: 413 | Train Loss: 0.777 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
Validation loss decreased (inf --> -0.952249).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0274233
	speed: 0.0548s/iter; left time: 2233.4248s
	iters: 200, epoch: 2 | loss: 0.0697135
	speed: 0.0165s/iter; left time: 672.6607s
	iters: 300, epoch: 2 | loss: 0.0108414
	speed: 0.0188s/iter; left time: 764.2883s
	iters: 400, epoch: 2 | loss: 0.0274771
	speed: 0.0188s/iter; left time: 762.1681s
Epoch: 2 cost time: 7.600056171417236
Epoch: 2, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.112 Vali Acc: 0.963 Test Loss: 0.112 Test Acc: 0.963
Validation loss decreased (-0.952249 --> -0.962709).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0344644
	speed: 0.0619s/iter; left time: 2500.4928s
	iters: 200, epoch: 3 | loss: 0.0177693
	speed: 0.0193s/iter; left time: 777.2579s
	iters: 300, epoch: 3 | loss: 0.0113644
	speed: 0.0198s/iter; left time: 796.1651s
	iters: 400, epoch: 3 | loss: 0.0267513
	speed: 0.0199s/iter; left time: 796.9987s
Epoch: 3 cost time: 8.367939710617065
Epoch: 3, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
Validation loss decreased (-0.962709 --> -0.975443).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0915326
	speed: 0.0630s/iter; left time: 2516.9187s
	iters: 200, epoch: 4 | loss: 0.1554130
	speed: 0.0192s/iter; left time: 765.7346s
	iters: 300, epoch: 4 | loss: 0.1017458
	speed: 0.0203s/iter; left time: 806.3796s
	iters: 400, epoch: 4 | loss: 0.2577882
	speed: 0.0191s/iter; left time: 756.4992s
Epoch: 4 cost time: 8.445369243621826
Epoch: 4, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1027425
	speed: 0.0620s/iter; left time: 2453.5747s
	iters: 200, epoch: 5 | loss: 0.0014931
	speed: 0.0196s/iter; left time: 771.6893s
	iters: 300, epoch: 5 | loss: 0.0054034
	speed: 0.0205s/iter; left time: 808.2325s
	iters: 400, epoch: 5 | loss: 0.0374660
	speed: 0.0197s/iter; left time: 772.0535s
Epoch: 5 cost time: 8.547888278961182
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.088 Vali Acc: 0.971 Test Loss: 0.088 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0057246
	speed: 0.0630s/iter; left time: 2466.6989s
	iters: 200, epoch: 6 | loss: 0.0082591
	speed: 0.0209s/iter; left time: 817.0681s
	iters: 300, epoch: 6 | loss: 0.0026577
	speed: 0.0188s/iter; left time: 730.5176s
	iters: 400, epoch: 6 | loss: 0.0020493
	speed: 0.0190s/iter; left time: 739.3271s
Epoch: 6 cost time: 8.479169607162476
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0051764
	speed: 0.0590s/iter; left time: 2284.6966s
	iters: 200, epoch: 7 | loss: 0.0707935
	speed: 0.0195s/iter; left time: 752.2171s
	iters: 300, epoch: 7 | loss: 0.0298120
	speed: 0.0183s/iter; left time: 706.2194s
	iters: 400, epoch: 7 | loss: 0.0077547
	speed: 0.0196s/iter; left time: 754.0401s
Epoch: 7 cost time: 8.20511507987976
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.077 Vali Acc: 0.974 Test Loss: 0.077 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0006197
	speed: 0.0602s/iter; left time: 2305.2794s
	iters: 200, epoch: 8 | loss: 0.0006542
	speed: 0.0182s/iter; left time: 693.9670s
	iters: 300, epoch: 8 | loss: 0.0058998
	speed: 0.0176s/iter; left time: 671.9773s
	iters: 400, epoch: 8 | loss: 0.0009455
	speed: 0.0184s/iter; left time: 697.6155s
Epoch: 8 cost time: 7.756861209869385
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0828420
	speed: 0.0621s/iter; left time: 2354.3416s
	iters: 200, epoch: 9 | loss: 0.0091558
	speed: 0.0195s/iter; left time: 737.9331s
	iters: 300, epoch: 9 | loss: 0.0093214
	speed: 0.0197s/iter; left time: 741.5798s
	iters: 400, epoch: 9 | loss: 0.0011597
	speed: 0.0198s/iter; left time: 744.3199s
Epoch: 9 cost time: 8.427797794342041
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0003814
	speed: 0.0602s/iter; left time: 2255.4413s
	iters: 200, epoch: 10 | loss: 0.0048139
	speed: 0.0188s/iter; left time: 703.4338s
	iters: 300, epoch: 10 | loss: 0.0003231
	speed: 0.0196s/iter; left time: 731.7720s
	iters: 400, epoch: 10 | loss: 0.0003787
	speed: 0.0200s/iter; left time: 743.7071s
Epoch: 10 cost time: 8.26473355293274
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0017852
	speed: 0.0614s/iter; left time: 2276.7513s
	iters: 200, epoch: 11 | loss: 0.0007276
	speed: 0.0185s/iter; left time: 684.7037s
	iters: 300, epoch: 11 | loss: 0.0029604
	speed: 0.0190s/iter; left time: 699.0528s
	iters: 400, epoch: 11 | loss: 0.0030750
	speed: 0.0195s/iter; left time: 716.8684s
Epoch: 11 cost time: 8.15205454826355
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.975443 --> -0.979535).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0342620
	speed: 0.0636s/iter; left time: 2331.7664s
	iters: 200, epoch: 12 | loss: 0.0000207
	speed: 0.0191s/iter; left time: 699.6800s
	iters: 300, epoch: 12 | loss: 0.0014679
	speed: 0.0201s/iter; left time: 731.3399s
	iters: 400, epoch: 12 | loss: 0.0000674
	speed: 0.0190s/iter; left time: 689.7899s
Epoch: 12 cost time: 8.25894570350647
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0069753
	speed: 0.0614s/iter; left time: 2226.4448s
	iters: 200, epoch: 13 | loss: 0.0000994
	speed: 0.0182s/iter; left time: 656.3138s
	iters: 300, epoch: 13 | loss: 0.0001328
	speed: 0.0181s/iter; left time: 650.8271s
	iters: 400, epoch: 13 | loss: 0.0000987
	speed: 0.0183s/iter; left time: 658.6432s
Epoch: 13 cost time: 7.891079664230347
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0020634
	speed: 0.0622s/iter; left time: 2227.9126s
	iters: 200, epoch: 14 | loss: 0.0000975
	speed: 0.0188s/iter; left time: 670.6139s
	iters: 300, epoch: 14 | loss: 0.0095252
	speed: 0.0171s/iter; left time: 608.0644s
	iters: 400, epoch: 14 | loss: 0.0062163
	speed: 0.0192s/iter; left time: 683.8774s
Epoch: 14 cost time: 7.916503429412842
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0986109
	speed: 0.0610s/iter; left time: 2160.2580s
	iters: 200, epoch: 15 | loss: 0.0018088
	speed: 0.0185s/iter; left time: 654.9479s
	iters: 300, epoch: 15 | loss: 0.0006848
	speed: 0.0185s/iter; left time: 650.3824s
	iters: 400, epoch: 15 | loss: 0.0000478
	speed: 0.0184s/iter; left time: 646.2440s
Epoch: 15 cost time: 7.969240188598633
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.980900).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000030
	speed: 0.0590s/iter; left time: 2066.2609s
	iters: 200, epoch: 16 | loss: 0.0000064
	speed: 0.0200s/iter; left time: 699.3127s
	iters: 300, epoch: 16 | loss: 0.0138063
	speed: 0.0194s/iter; left time: 674.4631s
	iters: 400, epoch: 16 | loss: 0.0052098
	speed: 0.0197s/iter; left time: 683.6068s
Epoch: 16 cost time: 8.475932121276855
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0018739
	speed: 0.0606s/iter; left time: 2097.2800s
	iters: 200, epoch: 17 | loss: 0.0000320
	speed: 0.0194s/iter; left time: 669.8014s
	iters: 300, epoch: 17 | loss: 0.0000629
	speed: 0.0206s/iter; left time: 709.0413s
	iters: 400, epoch: 17 | loss: 0.0001458
	speed: 0.0194s/iter; left time: 666.5406s
Epoch: 17 cost time: 8.536603927612305
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000260
	speed: 0.0623s/iter; left time: 2130.3762s
	iters: 200, epoch: 18 | loss: 0.0284235
	speed: 0.0187s/iter; left time: 637.3728s
	iters: 300, epoch: 18 | loss: 0.0097301
	speed: 0.0190s/iter; left time: 647.0368s
	iters: 400, epoch: 18 | loss: 0.0010805
	speed: 0.0196s/iter; left time: 663.7105s
Epoch: 18 cost time: 8.292575120925903
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0001000
	speed: 0.0644s/iter; left time: 2174.7653s
	iters: 200, epoch: 19 | loss: 0.0035992
	speed: 0.0189s/iter; left time: 636.6199s
	iters: 300, epoch: 19 | loss: 0.0009238
	speed: 0.0190s/iter; left time: 639.3317s
	iters: 400, epoch: 19 | loss: 0.0000122
	speed: 0.0201s/iter; left time: 672.0247s
Epoch: 19 cost time: 8.436657190322876
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000572
	speed: 0.0636s/iter; left time: 2121.9360s
	iters: 200, epoch: 20 | loss: 0.0000172
	speed: 0.0185s/iter; left time: 616.0896s
	iters: 300, epoch: 20 | loss: 0.0028198
	speed: 0.0185s/iter; left time: 613.6059s
	iters: 400, epoch: 20 | loss: 0.0025740
	speed: 0.0181s/iter; left time: 599.2295s
Epoch: 20 cost time: 7.986095905303955
Epoch: 20, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
Validation loss decreased (-0.980900 --> -0.981809).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0035872
	speed: 0.0656s/iter; left time: 2160.7312s
	iters: 200, epoch: 21 | loss: 0.0000197
	speed: 0.0182s/iter; left time: 597.7911s
	iters: 300, epoch: 21 | loss: 0.0000011
	speed: 0.0177s/iter; left time: 579.5645s
	iters: 400, epoch: 21 | loss: 0.0000008
	speed: 0.0181s/iter; left time: 590.9692s
Epoch: 21 cost time: 7.8819899559021
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000899
	speed: 0.0662s/iter; left time: 2152.4546s
	iters: 200, epoch: 22 | loss: 0.0035002
	speed: 0.0179s/iter; left time: 579.4921s
	iters: 300, epoch: 22 | loss: 0.0032043
	speed: 0.0178s/iter; left time: 573.9423s
	iters: 400, epoch: 22 | loss: 0.0000196
	speed: 0.0181s/iter; left time: 583.6191s
Epoch: 22 cost time: 7.7817912101745605
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0161785
	speed: 0.0610s/iter; left time: 1958.8138s
	iters: 200, epoch: 23 | loss: 0.0000343
	speed: 0.0203s/iter; left time: 650.5860s
	iters: 300, epoch: 23 | loss: 0.0013350
	speed: 0.0195s/iter; left time: 622.2240s
	iters: 400, epoch: 23 | loss: 0.0000007
	speed: 0.0202s/iter; left time: 642.1206s
Epoch: 23 cost time: 8.613473415374756
Epoch: 23, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0076025
	speed: 0.0622s/iter; left time: 1972.3058s
	iters: 200, epoch: 24 | loss: 0.0000059
	speed: 0.0195s/iter; left time: 615.8784s
	iters: 300, epoch: 24 | loss: 0.0002444
	speed: 0.0200s/iter; left time: 631.4289s
	iters: 400, epoch: 24 | loss: 0.0005781
	speed: 0.0193s/iter; left time: 605.3153s
Epoch: 24 cost time: 8.408011198043823
Epoch: 24, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
Validation loss decreased (-0.981809 --> -0.981809).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000114
	speed: 0.0633s/iter; left time: 1981.8691s
	iters: 200, epoch: 25 | loss: 0.0006991
	speed: 0.0203s/iter; left time: 632.0256s
	iters: 300, epoch: 25 | loss: 0.0012118
	speed: 0.0202s/iter; left time: 626.8289s
	iters: 400, epoch: 25 | loss: 0.0274852
	speed: 0.0202s/iter; left time: 625.4860s
Epoch: 25 cost time: 8.762200355529785
Epoch: 25, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0002658
	speed: 0.0606s/iter; left time: 1871.0528s
	iters: 200, epoch: 26 | loss: 0.0000013
	speed: 0.0198s/iter; left time: 608.2821s
	iters: 300, epoch: 26 | loss: 0.0000006
	speed: 0.0186s/iter; left time: 569.1205s
	iters: 400, epoch: 26 | loss: 0.0001183
	speed: 0.0187s/iter; left time: 570.4968s
Epoch: 26 cost time: 8.280114889144897
Epoch: 26, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000241
	speed: 0.0586s/iter; left time: 1784.1931s
	iters: 200, epoch: 27 | loss: 0.0114844
	speed: 0.0190s/iter; left time: 576.0429s
	iters: 300, epoch: 27 | loss: 0.0000101
	speed: 0.0195s/iter; left time: 589.4022s
	iters: 400, epoch: 27 | loss: 0.0000105
	speed: 0.0185s/iter; left time: 559.3974s
Epoch: 27 cost time: 8.089681625366211
Epoch: 27, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000237
	speed: 0.0655s/iter; left time: 1967.3268s
	iters: 200, epoch: 28 | loss: 0.0000737
	speed: 0.0183s/iter; left time: 548.5403s
	iters: 300, epoch: 28 | loss: 0.0009079
	speed: 0.0188s/iter; left time: 560.3361s
	iters: 400, epoch: 28 | loss: 0.0001514
	speed: 0.0183s/iter; left time: 543.3254s
Epoch: 28 cost time: 8.038410425186157
Epoch: 28, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000019
	speed: 0.0650s/iter; left time: 1925.2270s
	iters: 200, epoch: 29 | loss: 0.0078013
	speed: 0.0184s/iter; left time: 542.4085s
	iters: 300, epoch: 29 | loss: 0.0000266
	speed: 0.0182s/iter; left time: 535.3449s
	iters: 400, epoch: 29 | loss: 0.0111992
	speed: 0.0182s/iter; left time: 533.0203s
Epoch: 29 cost time: 7.842046737670898
Epoch: 29, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.070 Vali Acc: 0.986 Test Loss: 0.070 Test Acc: 0.986
Validation loss decreased (-0.981809 --> -0.986357).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0025450
	speed: 0.0623s/iter; left time: 1821.2308s
	iters: 200, epoch: 30 | loss: 0.0000614
	speed: 0.0185s/iter; left time: 538.0478s
	iters: 300, epoch: 30 | loss: 0.0000431
	speed: 0.0177s/iter; left time: 513.8341s
	iters: 400, epoch: 30 | loss: 0.0000037
	speed: 0.0193s/iter; left time: 557.7927s
Epoch: 30 cost time: 7.942617654800415
Epoch: 30, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0002077
	speed: 0.0623s/iter; left time: 1795.2348s
	iters: 200, epoch: 31 | loss: 0.0442780
	speed: 0.0186s/iter; left time: 534.8274s
	iters: 300, epoch: 31 | loss: 0.0000009
	speed: 0.0186s/iter; left time: 531.3715s
	iters: 400, epoch: 31 | loss: 0.0000130
	speed: 0.0196s/iter; left time: 559.8659s
Epoch: 31 cost time: 8.152291297912598
Epoch: 31, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000219
	speed: 0.0614s/iter; left time: 1742.4067s
	iters: 200, epoch: 32 | loss: 0.0000691
	speed: 0.0196s/iter; left time: 555.6838s
	iters: 300, epoch: 32 | loss: 0.0000054
	speed: 0.0189s/iter; left time: 534.0937s
	iters: 400, epoch: 32 | loss: 0.0000034
	speed: 0.0197s/iter; left time: 553.8013s
Epoch: 32 cost time: 8.40960168838501
Epoch: 32, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.0623s/iter; left time: 1742.8856s
	iters: 200, epoch: 33 | loss: 0.0000032
	speed: 0.0195s/iter; left time: 543.1000s
	iters: 300, epoch: 33 | loss: 0.0000014
	speed: 0.0201s/iter; left time: 557.5725s
	iters: 400, epoch: 33 | loss: 0.0000565
	speed: 0.0188s/iter; left time: 521.1589s
Epoch: 33 cost time: 8.463703870773315
Epoch: 33, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000010
	speed: 0.0603s/iter; left time: 1663.4652s
	iters: 200, epoch: 34 | loss: 0.0051361
	speed: 0.0185s/iter; left time: 507.0802s
	iters: 300, epoch: 34 | loss: 0.0001148
	speed: 0.0187s/iter; left time: 512.8186s
	iters: 400, epoch: 34 | loss: 0.0000001
	speed: 0.0195s/iter; left time: 532.8280s
Epoch: 34 cost time: 8.117154836654663
Epoch: 34, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000382
	speed: 0.0567s/iter; left time: 1540.3460s
	iters: 200, epoch: 35 | loss: 0.0001572
	speed: 0.0177s/iter; left time: 479.0582s
	iters: 300, epoch: 35 | loss: 0.0005209
	speed: 0.0187s/iter; left time: 504.3258s
	iters: 400, epoch: 35 | loss: 0.0554792
	speed: 0.0190s/iter; left time: 510.8188s
Epoch: 35 cost time: 7.903973340988159
Epoch: 35, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0000832
	speed: 0.0605s/iter; left time: 1617.6262s
	iters: 200, epoch: 36 | loss: 0.0000002
	speed: 0.0192s/iter; left time: 511.4652s
	iters: 300, epoch: 36 | loss: 0.0001544
	speed: 0.0196s/iter; left time: 521.2839s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0194s/iter; left time: 513.1145s
Epoch: 36 cost time: 8.20400333404541
Epoch: 36, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.979 Test Loss: 0.118 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0000011
	speed: 0.0631s/iter; left time: 1661.0326s
	iters: 200, epoch: 37 | loss: 0.0000001
	speed: 0.0204s/iter; left time: 536.1640s
	iters: 300, epoch: 37 | loss: 0.0006927
	speed: 0.0212s/iter; left time: 553.0738s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0208s/iter; left time: 541.7410s
Epoch: 37 cost time: 8.848036766052246
Epoch: 37, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0000035
	speed: 0.0634s/iter; left time: 1643.8267s
	iters: 200, epoch: 38 | loss: 0.0000104
	speed: 0.0192s/iter; left time: 495.5974s
	iters: 300, epoch: 38 | loss: 0.0023344
	speed: 0.0189s/iter; left time: 486.6554s
	iters: 400, epoch: 38 | loss: 0.0028405
	speed: 0.0188s/iter; left time: 482.5450s
Epoch: 38 cost time: 8.129339694976807
Epoch: 38, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0000032
	speed: 0.0650s/iter; left time: 1657.0801s
	iters: 200, epoch: 39 | loss: 0.0000014
	speed: 0.0183s/iter; left time: 465.9680s
	iters: 300, epoch: 39 | loss: 0.0000194
	speed: 0.0173s/iter; left time: 438.7581s
	iters: 400, epoch: 39 | loss: 0.0000119
	speed: 0.0202s/iter; left time: 508.2302s
Epoch: 39 cost time: 8.05188536643982
Epoch: 39, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.979 Test Loss: 0.134 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 42542
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3318723
	speed: 0.0357s/iter; left time: 1470.4569s
	iters: 200, epoch: 1 | loss: 0.9772045
	speed: 0.0181s/iter; left time: 742.6886s
	iters: 300, epoch: 1 | loss: 0.2761994
	speed: 0.0180s/iter; left time: 739.3086s
	iters: 400, epoch: 1 | loss: 0.1521336
	speed: 0.0178s/iter; left time: 726.4638s
Epoch: 1 cost time: 9.23734712600708
Epoch: 1, Steps: 413 | Train Loss: 0.849 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
Validation loss decreased (inf --> -0.942699).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0465464
	speed: 0.0624s/iter; left time: 2546.2071s
	iters: 200, epoch: 2 | loss: 0.1538081
	speed: 0.0175s/iter; left time: 713.0574s
	iters: 300, epoch: 2 | loss: 0.0099409
	speed: 0.0182s/iter; left time: 740.0077s
	iters: 400, epoch: 2 | loss: 0.0291400
	speed: 0.0193s/iter; left time: 783.1630s
Epoch: 2 cost time: 7.907208442687988
Epoch: 2, Steps: 413 | Train Loss: 0.156 Vali Loss: 0.118 Vali Acc: 0.960 Test Loss: 0.118 Test Acc: 0.960
Validation loss decreased (-0.942699 --> -0.960435).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0368699
	speed: 0.0591s/iter; left time: 2385.6495s
	iters: 200, epoch: 3 | loss: 0.0143692
	speed: 0.0201s/iter; left time: 807.6965s
	iters: 300, epoch: 3 | loss: 0.0303528
	speed: 0.0205s/iter; left time: 822.2468s
	iters: 400, epoch: 3 | loss: 0.0399940
	speed: 0.0194s/iter; left time: 776.0757s
Epoch: 3 cost time: 8.492711067199707
Epoch: 3, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.960435 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0940448
	speed: 0.0635s/iter; left time: 2537.9892s
	iters: 200, epoch: 4 | loss: 0.1189801
	speed: 0.0210s/iter; left time: 838.6312s
	iters: 300, epoch: 4 | loss: 0.0524492
	speed: 0.0199s/iter; left time: 791.4190s
	iters: 400, epoch: 4 | loss: 0.2086931
	speed: 0.0208s/iter; left time: 825.3301s
Epoch: 4 cost time: 8.789192199707031
Epoch: 4, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0860374
	speed: 0.0631s/iter; left time: 2496.1124s
	iters: 200, epoch: 5 | loss: 0.0081902
	speed: 0.0203s/iter; left time: 799.6018s
	iters: 300, epoch: 5 | loss: 0.0035314
	speed: 0.0198s/iter; left time: 777.7121s
	iters: 400, epoch: 5 | loss: 0.0305690
	speed: 0.0201s/iter; left time: 790.5208s
Epoch: 5 cost time: 8.55252718925476
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.093 Vali Acc: 0.969 Test Loss: 0.093 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0041336
	speed: 0.0646s/iter; left time: 2527.8758s
	iters: 200, epoch: 6 | loss: 0.0029930
	speed: 0.0193s/iter; left time: 751.8960s
	iters: 300, epoch: 6 | loss: 0.0162456
	speed: 0.0211s/iter; left time: 820.0542s
	iters: 400, epoch: 6 | loss: 0.0113630
	speed: 0.0205s/iter; left time: 796.3900s
Epoch: 6 cost time: 8.730819463729858
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0049212
	speed: 0.0606s/iter; left time: 2348.3219s
	iters: 200, epoch: 7 | loss: 0.0093588
	speed: 0.0175s/iter; left time: 675.5420s
	iters: 300, epoch: 7 | loss: 0.0182715
	speed: 0.0186s/iter; left time: 715.7580s
	iters: 400, epoch: 7 | loss: 0.0027462
	speed: 0.0186s/iter; left time: 714.4600s
Epoch: 7 cost time: 7.803954362869263
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.066 Vali Acc: 0.975 Test Loss: 0.066 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.975443).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0058929
	speed: 0.0606s/iter; left time: 2321.0574s
	iters: 200, epoch: 8 | loss: 0.0002741
	speed: 0.0173s/iter; left time: 659.8111s
	iters: 300, epoch: 8 | loss: 0.0152330
	speed: 0.0190s/iter; left time: 724.0402s
	iters: 400, epoch: 8 | loss: 0.0005269
	speed: 0.0189s/iter; left time: 716.5462s
Epoch: 8 cost time: 7.823465347290039
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0227290
	speed: 0.0626s/iter; left time: 2373.0248s
	iters: 200, epoch: 9 | loss: 0.0012256
	speed: 0.0176s/iter; left time: 664.5397s
	iters: 300, epoch: 9 | loss: 0.0054346
	speed: 0.0178s/iter; left time: 671.1255s
	iters: 400, epoch: 9 | loss: 0.0015527
	speed: 0.0196s/iter; left time: 736.2268s
Epoch: 9 cost time: 7.931107044219971
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0004194
	speed: 0.0607s/iter; left time: 2277.0052s
	iters: 200, epoch: 10 | loss: 0.0017505
	speed: 0.0187s/iter; left time: 699.3087s
	iters: 300, epoch: 10 | loss: 0.0006122
	speed: 0.0209s/iter; left time: 780.3633s
	iters: 400, epoch: 10 | loss: 0.0003544
	speed: 0.0195s/iter; left time: 724.1637s
Epoch: 10 cost time: 8.415451288223267
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0008115
	speed: 0.0605s/iter; left time: 2242.8647s
	iters: 200, epoch: 11 | loss: 0.0004491
	speed: 0.0189s/iter; left time: 697.2990s
	iters: 300, epoch: 11 | loss: 0.0001540
	speed: 0.0194s/iter; left time: 716.3197s
	iters: 400, epoch: 11 | loss: 0.0004762
	speed: 0.0195s/iter; left time: 715.6322s
Epoch: 11 cost time: 8.267212390899658
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.975443 --> -0.979081).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0334486
	speed: 0.0646s/iter; left time: 2368.4330s
	iters: 200, epoch: 12 | loss: 0.0000670
	speed: 0.0199s/iter; left time: 729.0283s
	iters: 300, epoch: 12 | loss: 0.0279958
	speed: 0.0195s/iter; left time: 711.8840s
	iters: 400, epoch: 12 | loss: 0.0003079
	speed: 0.0191s/iter; left time: 695.9213s
Epoch: 12 cost time: 8.383848428726196
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000314
	speed: 0.0644s/iter; left time: 2334.2032s
	iters: 200, epoch: 13 | loss: 0.0009633
	speed: 0.0195s/iter; left time: 703.6248s
	iters: 300, epoch: 13 | loss: 0.0002945
	speed: 0.0187s/iter; left time: 672.9772s
	iters: 400, epoch: 13 | loss: 0.0001604
	speed: 0.0191s/iter; left time: 685.1587s
Epoch: 13 cost time: 8.223557233810425
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0088656
	speed: 0.0610s/iter; left time: 2187.1074s
	iters: 200, epoch: 14 | loss: 0.0003410
	speed: 0.0186s/iter; left time: 665.0082s
	iters: 300, epoch: 14 | loss: 0.0017720
	speed: 0.0177s/iter; left time: 630.6523s
	iters: 400, epoch: 14 | loss: 0.0003732
	speed: 0.0171s/iter; left time: 608.3812s
Epoch: 14 cost time: 7.743235111236572
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.068 Vali Acc: 0.979 Test Loss: 0.068 Test Acc: 0.979
Validation loss decreased (-0.979081 --> -0.979081).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0805911
	speed: 0.0584s/iter; left time: 2066.7907s
	iters: 200, epoch: 15 | loss: 0.0090241
	speed: 0.0183s/iter; left time: 645.6169s
	iters: 300, epoch: 15 | loss: 0.0018207
	speed: 0.0191s/iter; left time: 673.6525s
	iters: 400, epoch: 15 | loss: 0.0000287
	speed: 0.0192s/iter; left time: 673.1125s
Epoch: 15 cost time: 8.064981698989868
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000034
	speed: 0.0603s/iter; left time: 2112.0992s
	iters: 200, epoch: 16 | loss: 0.0000110
	speed: 0.0202s/iter; left time: 704.6389s
	iters: 300, epoch: 16 | loss: 0.0059771
	speed: 0.0198s/iter; left time: 690.6563s
	iters: 400, epoch: 16 | loss: 0.0006756
	speed: 0.0194s/iter; left time: 673.8944s
Epoch: 16 cost time: 8.398228883743286
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.980445).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0003746
	speed: 0.0580s/iter; left time: 2007.4616s
	iters: 200, epoch: 17 | loss: 0.0010410
	speed: 0.0196s/iter; left time: 676.9084s
	iters: 300, epoch: 17 | loss: 0.0005556
	speed: 0.0207s/iter; left time: 711.4081s
	iters: 400, epoch: 17 | loss: 0.0047599
	speed: 0.0196s/iter; left time: 672.1630s
Epoch: 17 cost time: 8.388396739959717
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000340
	speed: 0.0621s/iter; left time: 2121.7612s
	iters: 200, epoch: 18 | loss: 0.0005788
	speed: 0.0181s/iter; left time: 618.3562s
	iters: 300, epoch: 18 | loss: 0.0000248
	speed: 0.0191s/iter; left time: 649.4738s
	iters: 400, epoch: 18 | loss: 0.0003719
	speed: 0.0189s/iter; left time: 641.0979s
Epoch: 18 cost time: 8.208996534347534
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000647
	speed: 0.0603s/iter; left time: 2037.7554s
	iters: 200, epoch: 19 | loss: 0.0003563
	speed: 0.0187s/iter; left time: 629.7143s
	iters: 300, epoch: 19 | loss: 0.0827255
	speed: 0.0190s/iter; left time: 636.2442s
	iters: 400, epoch: 19 | loss: 0.0006116
	speed: 0.0192s/iter; left time: 642.8782s
Epoch: 19 cost time: 8.31644058227539
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000411
	speed: 0.0647s/iter; left time: 2158.7005s
	iters: 200, epoch: 20 | loss: 0.0000008
	speed: 0.0184s/iter; left time: 611.5463s
	iters: 300, epoch: 20 | loss: 0.0001316
	speed: 0.0184s/iter; left time: 610.7327s
	iters: 400, epoch: 20 | loss: 0.6475101
	speed: 0.0182s/iter; left time: 602.6092s
Epoch: 20 cost time: 7.983297348022461
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.981354).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0074926
	speed: 0.0657s/iter; left time: 2162.9893s
	iters: 200, epoch: 21 | loss: 0.0000401
	speed: 0.0178s/iter; left time: 585.3912s
	iters: 300, epoch: 21 | loss: 0.0000007
	speed: 0.0184s/iter; left time: 601.5996s
	iters: 400, epoch: 21 | loss: 0.0000441
	speed: 0.0182s/iter; left time: 592.7556s
Epoch: 21 cost time: 7.868740558624268
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000048
	speed: 0.0630s/iter; left time: 2049.7282s
	iters: 200, epoch: 22 | loss: 0.0058136
	speed: 0.0186s/iter; left time: 603.3040s
	iters: 300, epoch: 22 | loss: 0.0036950
	speed: 0.0192s/iter; left time: 619.7926s
	iters: 400, epoch: 22 | loss: 0.0001157
	speed: 0.0189s/iter; left time: 608.5882s
Epoch: 22 cost time: 8.179911375045776
Epoch: 22, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000790
	speed: 0.0625s/iter; left time: 2008.5251s
	iters: 200, epoch: 23 | loss: 0.0002419
	speed: 0.0188s/iter; left time: 602.3473s
	iters: 300, epoch: 23 | loss: 0.0000333
	speed: 0.0198s/iter; left time: 631.6606s
	iters: 400, epoch: 23 | loss: 0.0000008
	speed: 0.0203s/iter; left time: 645.3693s
Epoch: 23 cost time: 8.530685901641846
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0005120
	speed: 0.0612s/iter; left time: 1938.9836s
	iters: 200, epoch: 24 | loss: 0.0000239
	speed: 0.0199s/iter; left time: 627.8254s
	iters: 300, epoch: 24 | loss: 0.0000059
	speed: 0.0203s/iter; left time: 640.7648s
	iters: 400, epoch: 24 | loss: 0.0003652
	speed: 0.0209s/iter; left time: 654.9720s
Epoch: 24 cost time: 8.757817029953003
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000289
	speed: 0.0641s/iter; left time: 2004.6007s
	iters: 200, epoch: 25 | loss: 0.0000100
	speed: 0.0207s/iter; left time: 644.1309s
	iters: 300, epoch: 25 | loss: 0.0088106
	speed: 0.0204s/iter; left time: 634.2221s
	iters: 400, epoch: 25 | loss: 0.0271318
	speed: 0.0203s/iter; left time: 629.6292s
Epoch: 25 cost time: 8.924254894256592
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0238546
	speed: 0.0596s/iter; left time: 1840.2333s
	iters: 200, epoch: 26 | loss: 0.0004988
	speed: 0.0202s/iter; left time: 621.7675s
	iters: 300, epoch: 26 | loss: 0.0004730
	speed: 0.0204s/iter; left time: 625.7776s
	iters: 400, epoch: 26 | loss: 0.0001360
	speed: 0.0194s/iter; left time: 592.7777s
Epoch: 26 cost time: 8.592381954193115
Epoch: 26, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000341
	speed: 0.0636s/iter; left time: 1936.0112s
	iters: 200, epoch: 27 | loss: 0.0097331
	speed: 0.0182s/iter; left time: 551.9153s
	iters: 300, epoch: 27 | loss: 0.0000003
	speed: 0.0184s/iter; left time: 557.9142s
	iters: 400, epoch: 27 | loss: 0.0000141
	speed: 0.0187s/iter; left time: 564.9853s
Epoch: 27 cost time: 8.095612049102783
Epoch: 27, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0023183
	speed: 0.0678s/iter; left time: 2036.0760s
	iters: 200, epoch: 28 | loss: 0.0008323
	speed: 0.0181s/iter; left time: 543.2368s
	iters: 300, epoch: 28 | loss: 0.0009470
	speed: 0.0190s/iter; left time: 566.4295s
	iters: 400, epoch: 28 | loss: 0.0000004
	speed: 0.0182s/iter; left time: 542.4297s
Epoch: 28 cost time: 8.049597978591919
Epoch: 28, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000318
	speed: 0.0662s/iter; left time: 1962.6421s
	iters: 200, epoch: 29 | loss: 0.0001345
	speed: 0.0189s/iter; left time: 557.7962s
	iters: 300, epoch: 29 | loss: 0.0132634
	speed: 0.0184s/iter; left time: 541.8927s
	iters: 400, epoch: 29 | loss: 0.0004084
	speed: 0.0189s/iter; left time: 555.7864s
Epoch: 29 cost time: 8.08507251739502
Epoch: 29, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.981354 --> -0.981354).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000006
	speed: 0.0675s/iter; left time: 1973.5196s
	iters: 200, epoch: 30 | loss: 0.0018119
	speed: 0.0196s/iter; left time: 570.2735s
	iters: 300, epoch: 30 | loss: 0.0000622
	speed: 0.0200s/iter; left time: 580.8020s
	iters: 400, epoch: 30 | loss: 0.0000045
	speed: 0.0196s/iter; left time: 565.8170s
Epoch: 30 cost time: 8.618942022323608
Epoch: 30, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.981354 --> -0.983173).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000245
	speed: 0.0658s/iter; left time: 1896.8406s
	iters: 200, epoch: 31 | loss: 0.0518099
	speed: 0.0201s/iter; left time: 577.2742s
	iters: 300, epoch: 31 | loss: 0.0000040
	speed: 0.0195s/iter; left time: 557.6918s
	iters: 400, epoch: 31 | loss: 0.0003003
	speed: 0.0193s/iter; left time: 550.0370s
Epoch: 31 cost time: 8.438000679016113
Epoch: 31, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0002488
	speed: 0.0622s/iter; left time: 1767.6619s
	iters: 200, epoch: 32 | loss: 0.0023728
	speed: 0.0186s/iter; left time: 526.7066s
	iters: 300, epoch: 32 | loss: 0.0016083
	speed: 0.0206s/iter; left time: 580.3846s
	iters: 400, epoch: 32 | loss: 0.0036605
	speed: 0.0190s/iter; left time: 533.1621s
Epoch: 32 cost time: 8.416231870651245
Epoch: 32, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000004
	speed: 0.0611s/iter; left time: 1710.8633s
	iters: 200, epoch: 33 | loss: 0.0000001
	speed: 0.0186s/iter; left time: 518.8352s
	iters: 300, epoch: 33 | loss: 0.0000910
	speed: 0.0213s/iter; left time: 591.7951s
	iters: 400, epoch: 33 | loss: 0.0000758
	speed: 0.0202s/iter; left time: 559.6068s
Epoch: 33 cost time: 8.630701780319214
Epoch: 33, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0000079
	speed: 0.0593s/iter; left time: 1634.9626s
	iters: 200, epoch: 34 | loss: 0.0000026
	speed: 0.0184s/iter; left time: 506.5767s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0186s/iter; left time: 509.6248s
	iters: 400, epoch: 34 | loss: 0.0000022
	speed: 0.0186s/iter; left time: 506.3631s
Epoch: 34 cost time: 8.020599365234375
Epoch: 34, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.982 Test Loss: 0.115 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000007
	speed: 0.0588s/iter; left time: 1598.0248s
	iters: 200, epoch: 35 | loss: 0.0002189
	speed: 0.0194s/iter; left time: 524.5600s
	iters: 300, epoch: 35 | loss: 0.1095099
	speed: 0.0182s/iter; left time: 490.9595s
	iters: 400, epoch: 35 | loss: 0.0002169
	speed: 0.0189s/iter; left time: 506.6032s
Epoch: 35 cost time: 8.087532997131348
Epoch: 35, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.985 Test Loss: 0.092 Test Acc: 0.985
Validation loss decreased (-0.983173 --> -0.984538).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0000020
	speed: 0.0618s/iter; left time: 1651.9568s
	iters: 200, epoch: 36 | loss: 0.0000454
	speed: 0.0188s/iter; left time: 501.9286s
	iters: 300, epoch: 36 | loss: 0.0003456
	speed: 0.0188s/iter; left time: 499.5387s
	iters: 400, epoch: 36 | loss: 0.0000002
	speed: 0.0172s/iter; left time: 455.8153s
Epoch: 36 cost time: 7.985912799835205
Epoch: 36, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.982 Test Loss: 0.102 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0000038
	speed: 0.0607s/iter; left time: 1598.5091s
	iters: 200, epoch: 37 | loss: 0.0000411
	speed: 0.0184s/iter; left time: 481.7508s
	iters: 300, epoch: 37 | loss: 0.0000007
	speed: 0.0189s/iter; left time: 493.3504s
	iters: 400, epoch: 37 | loss: 0.0000066
	speed: 0.0202s/iter; left time: 525.4012s
Epoch: 37 cost time: 8.290742874145508
Epoch: 37, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0000025
	speed: 0.0621s/iter; left time: 1609.7211s
	iters: 200, epoch: 38 | loss: 0.0000019
	speed: 0.0201s/iter; left time: 518.9526s
	iters: 300, epoch: 38 | loss: 0.0001468
	speed: 0.0203s/iter; left time: 521.2192s
	iters: 400, epoch: 38 | loss: 0.0000268
	speed: 0.0204s/iter; left time: 522.6592s
Epoch: 38 cost time: 8.574386358261108
Epoch: 38, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0000025
	speed: 0.0606s/iter; left time: 1546.8022s
	iters: 200, epoch: 39 | loss: 0.0000152
	speed: 0.0201s/iter; left time: 510.0342s
	iters: 300, epoch: 39 | loss: 0.1291450
	speed: 0.0189s/iter; left time: 479.4171s
	iters: 400, epoch: 39 | loss: 0.0000165
	speed: 0.0201s/iter; left time: 505.8918s
Epoch: 39 cost time: 8.461274862289429
Epoch: 39, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.0028211
	speed: 0.0600s/iter; left time: 1504.8571s
	iters: 200, epoch: 40 | loss: 0.0011488
	speed: 0.0191s/iter; left time: 476.8060s
	iters: 300, epoch: 40 | loss: 0.0000005
	speed: 0.0202s/iter; left time: 503.5275s
	iters: 400, epoch: 40 | loss: 0.0000239
	speed: 0.0201s/iter; left time: 497.9725s
Epoch: 40 cost time: 8.333989381790161
Epoch: 40, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0000015
	speed: 0.0601s/iter; left time: 1482.1137s
	iters: 200, epoch: 41 | loss: 0.0001041
	speed: 0.0181s/iter; left time: 445.2448s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0183s/iter; left time: 447.8606s
	iters: 400, epoch: 41 | loss: 0.0000721
	speed: 0.0182s/iter; left time: 444.6736s
Epoch: 41 cost time: 7.976192474365234
Epoch: 41, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0009788
	speed: 0.0596s/iter; left time: 1445.1859s
	iters: 200, epoch: 42 | loss: 0.0000876
	speed: 0.0181s/iter; left time: 436.8341s
	iters: 300, epoch: 42 | loss: 0.0061085
	speed: 0.0179s/iter; left time: 429.9751s
	iters: 400, epoch: 42 | loss: 0.0000007
	speed: 0.0171s/iter; left time: 410.1074s
Epoch: 42 cost time: 7.809178113937378
Epoch: 42, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.978 Test Loss: 0.160 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0000002
	speed: 0.0592s/iter; left time: 1412.3581s
	iters: 200, epoch: 43 | loss: 0.0000068
	speed: 0.0183s/iter; left time: 433.5387s
	iters: 300, epoch: 43 | loss: 0.0000037
	speed: 0.0189s/iter; left time: 447.1332s
	iters: 400, epoch: 43 | loss: 0.0000024
	speed: 0.0180s/iter; left time: 424.1192s
Epoch: 43 cost time: 7.961059331893921
Epoch: 43, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0003118
	speed: 0.0597s/iter; left time: 1398.4567s
	iters: 200, epoch: 44 | loss: 0.0000895
	speed: 0.0197s/iter; left time: 459.5073s
	iters: 300, epoch: 44 | loss: 0.0020931
	speed: 0.0188s/iter; left time: 436.4951s
	iters: 400, epoch: 44 | loss: 0.1512541
	speed: 0.0201s/iter; left time: 465.7702s
Epoch: 44 cost time: 8.385141372680664
Epoch: 44, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0000140
	speed: 0.0618s/iter; left time: 1422.2262s
	iters: 200, epoch: 45 | loss: 0.0039512
	speed: 0.0196s/iter; left time: 450.0014s
	iters: 300, epoch: 45 | loss: 0.0001250
	speed: 0.0193s/iter; left time: 441.3793s
	iters: 400, epoch: 45 | loss: 0.0000086
	speed: 0.0184s/iter; left time: 419.0890s
Epoch: 45 cost time: 8.275712251663208
Epoch: 45, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 42542
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.6356170
	speed: 0.0333s/iter; left time: 1373.6324s
	iters: 200, epoch: 1 | loss: 1.2316232
	speed: 0.0169s/iter; left time: 692.8737s
	iters: 300, epoch: 1 | loss: 0.3115508
	speed: 0.0187s/iter; left time: 765.4193s
	iters: 400, epoch: 1 | loss: 0.1750578
	speed: 0.0183s/iter; left time: 748.2672s
Epoch: 1 cost time: 9.021498203277588
Epoch: 1, Steps: 413 | Train Loss: 1.010 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
Validation loss decreased (inf --> -0.940880).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0954344
	speed: 0.0579s/iter; left time: 2362.9236s
	iters: 200, epoch: 2 | loss: 0.2136213
	speed: 0.0166s/iter; left time: 673.4176s
	iters: 300, epoch: 2 | loss: 0.0393282
	speed: 0.0168s/iter; left time: 683.6024s
	iters: 400, epoch: 2 | loss: 0.0319354
	speed: 0.0166s/iter; left time: 674.0709s
Epoch: 2 cost time: 7.2251832485198975
Epoch: 2, Steps: 413 | Train Loss: 0.195 Vali Loss: 0.134 Vali Acc: 0.952 Test Loss: 0.134 Test Acc: 0.952
Validation loss decreased (-0.940880 --> -0.952250).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0779795
	speed: 0.0601s/iter; left time: 2425.7466s
	iters: 200, epoch: 3 | loss: 0.0136042
	speed: 0.0167s/iter; left time: 672.8200s
	iters: 300, epoch: 3 | loss: 0.0455263
	speed: 0.0165s/iter; left time: 663.4944s
	iters: 400, epoch: 3 | loss: 0.0405675
	speed: 0.0163s/iter; left time: 651.9473s
Epoch: 3 cost time: 7.1945459842681885
Epoch: 3, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.086 Vali Acc: 0.972 Test Loss: 0.086 Test Acc: 0.972
Validation loss decreased (-0.952250 --> -0.972259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1557583
	speed: 0.0607s/iter; left time: 2427.6100s
	iters: 200, epoch: 4 | loss: 0.3113175
	speed: 0.0163s/iter; left time: 648.7600s
	iters: 300, epoch: 4 | loss: 0.1158563
	speed: 0.0164s/iter; left time: 653.3783s
	iters: 400, epoch: 4 | loss: 0.2920493
	speed: 0.0163s/iter; left time: 647.3294s
Epoch: 4 cost time: 7.111398220062256
Epoch: 4, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.085 Vali Acc: 0.971 Test Loss: 0.085 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0296632
	speed: 0.0600s/iter; left time: 2374.4810s
	iters: 200, epoch: 5 | loss: 0.0044980
	speed: 0.0188s/iter; left time: 740.7537s
	iters: 300, epoch: 5 | loss: 0.0132846
	speed: 0.0190s/iter; left time: 746.6742s
	iters: 400, epoch: 5 | loss: 0.0301147
	speed: 0.0183s/iter; left time: 717.5384s
Epoch: 5 cost time: 7.924835681915283
Epoch: 5, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.097 Vali Acc: 0.967 Test Loss: 0.097 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0019527
	speed: 0.0590s/iter; left time: 2307.1177s
	iters: 200, epoch: 6 | loss: 0.0118581
	speed: 0.0196s/iter; left time: 766.5145s
	iters: 300, epoch: 6 | loss: 0.0025303
	speed: 0.0186s/iter; left time: 726.0996s
	iters: 400, epoch: 6 | loss: 0.0233007
	speed: 0.0190s/iter; left time: 737.4313s
Epoch: 6 cost time: 8.170890808105469
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.974533).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0021866
	speed: 0.0597s/iter; left time: 2311.0255s
	iters: 200, epoch: 7 | loss: 0.0162104
	speed: 0.0180s/iter; left time: 694.4027s
	iters: 300, epoch: 7 | loss: 0.0017224
	speed: 0.0185s/iter; left time: 712.0979s
	iters: 400, epoch: 7 | loss: 0.0090978
	speed: 0.0190s/iter; left time: 730.9150s
Epoch: 7 cost time: 7.895098924636841
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.084 Vali Acc: 0.972 Test Loss: 0.084 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0009069
	speed: 0.0596s/iter; left time: 2282.1737s
	iters: 200, epoch: 8 | loss: 0.0125827
	speed: 0.0169s/iter; left time: 644.3829s
	iters: 300, epoch: 8 | loss: 0.0190519
	speed: 0.0172s/iter; left time: 653.8062s
	iters: 400, epoch: 8 | loss: 0.0003320
	speed: 0.0185s/iter; left time: 701.3141s
Epoch: 8 cost time: 7.621984004974365
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0614858
	speed: 0.0580s/iter; left time: 2198.4941s
	iters: 200, epoch: 9 | loss: 0.0140904
	speed: 0.0194s/iter; left time: 731.3791s
	iters: 300, epoch: 9 | loss: 0.0106697
	speed: 0.0164s/iter; left time: 619.3366s
	iters: 400, epoch: 9 | loss: 0.0070104
	speed: 0.0171s/iter; left time: 644.0035s
Epoch: 9 cost time: 7.758512496948242
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0038705
	speed: 0.0571s/iter; left time: 2140.0819s
	iters: 200, epoch: 10 | loss: 0.0148267
	speed: 0.0167s/iter; left time: 624.4307s
	iters: 300, epoch: 10 | loss: 0.0009321
	speed: 0.0165s/iter; left time: 613.7158s
	iters: 400, epoch: 10 | loss: 0.0004739
	speed: 0.0160s/iter; left time: 596.3631s
Epoch: 10 cost time: 7.180120468139648
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0461389
	speed: 0.0566s/iter; left time: 2099.6010s
	iters: 200, epoch: 11 | loss: 0.0017887
	speed: 0.0160s/iter; left time: 589.8661s
	iters: 300, epoch: 11 | loss: 0.0007734
	speed: 0.0162s/iter; left time: 598.0684s
	iters: 400, epoch: 11 | loss: 0.0090335
	speed: 0.0158s/iter; left time: 581.5156s
Epoch: 11 cost time: 7.047865867614746
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0084640
	speed: 0.0556s/iter; left time: 2038.3466s
	iters: 200, epoch: 12 | loss: 0.0000910
	speed: 0.0160s/iter; left time: 586.2696s
	iters: 300, epoch: 12 | loss: 0.1566110
	speed: 0.0158s/iter; left time: 577.4363s
	iters: 400, epoch: 12 | loss: 0.0013437
	speed: 0.0176s/iter; left time: 640.7168s
Epoch: 12 cost time: 7.159098386764526
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0643908
	speed: 0.0593s/iter; left time: 2151.0413s
	iters: 200, epoch: 13 | loss: 0.0005422
	speed: 0.0192s/iter; left time: 694.4367s
	iters: 300, epoch: 13 | loss: 0.0624934
	speed: 0.0193s/iter; left time: 694.0214s
	iters: 400, epoch: 13 | loss: 0.0000511
	speed: 0.0186s/iter; left time: 668.3948s
Epoch: 13 cost time: 8.17565131187439
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000232
	speed: 0.0582s/iter; left time: 2085.5586s
	iters: 200, epoch: 14 | loss: 0.0014892
	speed: 0.0186s/iter; left time: 664.6575s
	iters: 300, epoch: 14 | loss: 0.0043722
	speed: 0.0186s/iter; left time: 664.3328s
	iters: 400, epoch: 14 | loss: 0.0660196
	speed: 0.0186s/iter; left time: 661.1491s
Epoch: 14 cost time: 8.001337766647339
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0039907
	speed: 0.0578s/iter; left time: 2047.2729s
	iters: 200, epoch: 15 | loss: 0.0198618
	speed: 0.0162s/iter; left time: 571.3532s
	iters: 300, epoch: 15 | loss: 0.0022091
	speed: 0.0163s/iter; left time: 573.2579s
	iters: 400, epoch: 15 | loss: 0.0000147
	speed: 0.0182s/iter; left time: 639.8981s
Epoch: 15 cost time: 7.499118089675903
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000279
	speed: 0.0565s/iter; left time: 1978.1618s
	iters: 200, epoch: 16 | loss: 0.0000407
	speed: 0.0160s/iter; left time: 557.8515s
	iters: 300, epoch: 16 | loss: 0.0077509
	speed: 0.0166s/iter; left time: 576.5132s
	iters: 400, epoch: 16 | loss: 0.0112870
	speed: 0.0190s/iter; left time: 657.8135s
Epoch: 16 cost time: 7.470250368118286
Epoch: 16, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9745338790359254
model parameter : 42542
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0998468
	speed: 0.0345s/iter; left time: 1422.5599s
	iters: 200, epoch: 1 | loss: 0.4261554
	speed: 0.0177s/iter; left time: 727.4096s
	iters: 300, epoch: 1 | loss: 0.1716680
	speed: 0.0197s/iter; left time: 806.4054s
	iters: 400, epoch: 1 | loss: 0.1232111
	speed: 0.0184s/iter; left time: 753.6802s
Epoch: 1 cost time: 9.333302021026611
Epoch: 1, Steps: 413 | Train Loss: 0.747 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (inf --> -0.958161).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2902369
	speed: 0.0571s/iter; left time: 2330.1135s
	iters: 200, epoch: 2 | loss: 0.1579761
	speed: 0.0174s/iter; left time: 709.0980s
	iters: 300, epoch: 2 | loss: 0.1196994
	speed: 0.0183s/iter; left time: 741.4525s
	iters: 400, epoch: 2 | loss: 0.0643348
	speed: 0.0180s/iter; left time: 727.9145s
Epoch: 2 cost time: 7.625497341156006
Epoch: 2, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
Validation loss decreased (-0.958161 --> -0.968166).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0352466
	speed: 0.0604s/iter; left time: 2440.1248s
	iters: 200, epoch: 3 | loss: 0.0906227
	speed: 0.0189s/iter; left time: 760.4561s
	iters: 300, epoch: 3 | loss: 0.0238145
	speed: 0.0187s/iter; left time: 749.3394s
	iters: 400, epoch: 3 | loss: 0.0442063
	speed: 0.0192s/iter; left time: 769.9640s
Epoch: 3 cost time: 8.202466011047363
Epoch: 3, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
Validation loss decreased (-0.968166 --> -0.970440).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0304535
	speed: 0.0614s/iter; left time: 2452.5110s
	iters: 200, epoch: 4 | loss: 0.1455820
	speed: 0.0191s/iter; left time: 761.4024s
	iters: 300, epoch: 4 | loss: 0.0102081
	speed: 0.0182s/iter; left time: 725.0785s
	iters: 400, epoch: 4 | loss: 0.1734058
	speed: 0.0190s/iter; left time: 753.6392s
Epoch: 4 cost time: 8.028193235397339
Epoch: 4, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.082 Vali Acc: 0.971 Test Loss: 0.082 Test Acc: 0.971
Validation loss decreased (-0.970440 --> -0.970895).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0082125
	speed: 0.0598s/iter; left time: 2365.9947s
	iters: 200, epoch: 5 | loss: 0.0092607
	speed: 0.0181s/iter; left time: 713.8440s
	iters: 300, epoch: 5 | loss: 0.0037865
	speed: 0.0187s/iter; left time: 733.8809s
	iters: 400, epoch: 5 | loss: 0.0139626
	speed: 0.0188s/iter; left time: 738.5778s
Epoch: 5 cost time: 7.869327545166016
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.069 Vali Acc: 0.973 Test Loss: 0.069 Test Acc: 0.973
Validation loss decreased (-0.970895 --> -0.973169).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0042794
	speed: 0.0607s/iter; left time: 2377.1744s
	iters: 200, epoch: 6 | loss: 0.0090316
	speed: 0.0183s/iter; left time: 715.2327s
	iters: 300, epoch: 6 | loss: 0.0037366
	speed: 0.0185s/iter; left time: 719.7127s
	iters: 400, epoch: 6 | loss: 0.0994073
	speed: 0.0186s/iter; left time: 721.5168s
Epoch: 6 cost time: 7.934056043624878
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.065 Vali Acc: 0.976 Test Loss: 0.065 Test Acc: 0.976
Validation loss decreased (-0.973169 --> -0.975897).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0118167
	speed: 0.0628s/iter; left time: 2430.7487s
	iters: 200, epoch: 7 | loss: 0.1305054
	speed: 0.0190s/iter; left time: 733.3398s
	iters: 300, epoch: 7 | loss: 0.0079847
	speed: 0.0178s/iter; left time: 686.0706s
	iters: 400, epoch: 7 | loss: 0.0109322
	speed: 0.0169s/iter; left time: 647.8548s
Epoch: 7 cost time: 7.9219725131988525
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.075 Vali Acc: 0.975 Test Loss: 0.075 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0065459
	speed: 0.0603s/iter; left time: 2310.7134s
	iters: 200, epoch: 8 | loss: 0.0009180
	speed: 0.0168s/iter; left time: 643.2173s
	iters: 300, epoch: 8 | loss: 0.0006571
	speed: 0.0175s/iter; left time: 668.3651s
	iters: 400, epoch: 8 | loss: 0.0090052
	speed: 0.0165s/iter; left time: 626.3211s
Epoch: 8 cost time: 7.418431997299194
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.069 Vali Acc: 0.974 Test Loss: 0.069 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0057371
	speed: 0.0563s/iter; left time: 2132.5115s
	iters: 200, epoch: 9 | loss: 0.0004685
	speed: 0.0172s/iter; left time: 651.8775s
	iters: 300, epoch: 9 | loss: 0.0293905
	speed: 0.0178s/iter; left time: 671.1358s
	iters: 400, epoch: 9 | loss: 0.0012091
	speed: 0.0179s/iter; left time: 672.5134s
Epoch: 9 cost time: 7.673279285430908
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1166512
	speed: 0.0575s/iter; left time: 2156.1688s
	iters: 200, epoch: 10 | loss: 0.0438795
	speed: 0.0193s/iter; left time: 723.3444s
	iters: 300, epoch: 10 | loss: 0.0005387
	speed: 0.0195s/iter; left time: 727.3161s
	iters: 400, epoch: 10 | loss: 0.0005642
	speed: 0.0190s/iter; left time: 705.4009s
Epoch: 10 cost time: 8.137566804885864
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (-0.975897 --> -0.976352).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0001737
	speed: 0.0597s/iter; left time: 2214.7367s
	iters: 200, epoch: 11 | loss: 0.0045476
	speed: 0.0188s/iter; left time: 693.5323s
	iters: 300, epoch: 11 | loss: 0.0001154
	speed: 0.0185s/iter; left time: 683.9378s
	iters: 400, epoch: 11 | loss: 0.0039482
	speed: 0.0187s/iter; left time: 689.0932s
Epoch: 11 cost time: 8.081477165222168
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0058132
	speed: 0.0590s/iter; left time: 2162.0422s
	iters: 200, epoch: 12 | loss: 0.0001622
	speed: 0.0189s/iter; left time: 689.4696s
	iters: 300, epoch: 12 | loss: 0.0060904
	speed: 0.0191s/iter; left time: 694.8261s
	iters: 400, epoch: 12 | loss: 0.0002033
	speed: 0.0173s/iter; left time: 629.8374s
Epoch: 12 cost time: 8.07697081565857
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.976807).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0045063
	speed: 0.0576s/iter; left time: 2089.0579s
	iters: 200, epoch: 13 | loss: 0.0001204
	speed: 0.0182s/iter; left time: 657.3584s
	iters: 300, epoch: 13 | loss: 0.0063552
	speed: 0.0177s/iter; left time: 638.2516s
	iters: 400, epoch: 13 | loss: 0.0033145
	speed: 0.0182s/iter; left time: 652.5685s
Epoch: 13 cost time: 7.833752393722534
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000512
	speed: 0.0579s/iter; left time: 2073.4108s
	iters: 200, epoch: 14 | loss: 0.0002297
	speed: 0.0189s/iter; left time: 676.6937s
	iters: 300, epoch: 14 | loss: 0.0000914
	speed: 0.0189s/iter; left time: 672.0148s
	iters: 400, epoch: 14 | loss: 0.0002341
	speed: 0.0184s/iter; left time: 653.3826s
Epoch: 14 cost time: 7.886128902435303
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0120098
	speed: 0.0590s/iter; left time: 2089.0808s
	iters: 200, epoch: 15 | loss: 0.0040913
	speed: 0.0161s/iter; left time: 568.4333s
	iters: 300, epoch: 15 | loss: 0.0005378
	speed: 0.0167s/iter; left time: 586.9277s
	iters: 400, epoch: 15 | loss: 0.0002875
	speed: 0.0178s/iter; left time: 623.8906s
Epoch: 15 cost time: 7.315413951873779
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0041154
	speed: 0.0569s/iter; left time: 1991.0272s
	iters: 200, epoch: 16 | loss: 0.0000319
	speed: 0.0170s/iter; left time: 592.9004s
	iters: 300, epoch: 16 | loss: 0.0007811
	speed: 0.0166s/iter; left time: 576.7399s
	iters: 400, epoch: 16 | loss: 0.0134788
	speed: 0.0164s/iter; left time: 567.4647s
Epoch: 16 cost time: 7.11528205871582
Epoch: 16, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0001301
	speed: 0.0595s/iter; left time: 2058.0162s
	iters: 200, epoch: 17 | loss: 0.0002079
	speed: 0.0169s/iter; left time: 584.0692s
	iters: 300, epoch: 17 | loss: 0.0001818
	speed: 0.0170s/iter; left time: 583.5158s
	iters: 400, epoch: 17 | loss: 0.0000611
	speed: 0.0168s/iter; left time: 575.5318s
Epoch: 17 cost time: 7.4049670696258545
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976807 --> -0.977261).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0004051
	speed: 0.0590s/iter; left time: 2015.5985s
	iters: 200, epoch: 18 | loss: 0.0042833
	speed: 0.0187s/iter; left time: 636.9325s
	iters: 300, epoch: 18 | loss: 0.0310802
	speed: 0.0186s/iter; left time: 630.7619s
	iters: 400, epoch: 18 | loss: 0.0001751
	speed: 0.0186s/iter; left time: 629.3080s
Epoch: 18 cost time: 7.914820909500122
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0113481
	speed: 0.0605s/iter; left time: 2043.3795s
	iters: 200, epoch: 19 | loss: 0.1971497
	speed: 0.0187s/iter; left time: 631.0381s
	iters: 300, epoch: 19 | loss: 0.0003658
	speed: 0.0178s/iter; left time: 598.6250s
	iters: 400, epoch: 19 | loss: 0.0000086
	speed: 0.0174s/iter; left time: 580.9154s
Epoch: 19 cost time: 7.927761793136597
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.977261 --> -0.980445).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000028
	speed: 0.0563s/iter; left time: 1879.0986s
	iters: 200, epoch: 20 | loss: 0.0003521
	speed: 0.0179s/iter; left time: 596.1972s
	iters: 300, epoch: 20 | loss: 0.0000143
	speed: 0.0178s/iter; left time: 588.9712s
	iters: 400, epoch: 20 | loss: 0.0243685
	speed: 0.0187s/iter; left time: 618.3787s
Epoch: 20 cost time: 7.959546089172363
Epoch: 20, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000085
	speed: 0.0559s/iter; left time: 1840.1530s
	iters: 200, epoch: 21 | loss: 0.0000024
	speed: 0.0198s/iter; left time: 651.3142s
	iters: 300, epoch: 21 | loss: 0.0001210
	speed: 0.0178s/iter; left time: 583.9388s
	iters: 400, epoch: 21 | loss: 0.0035018
	speed: 0.0198s/iter; left time: 647.7105s
Epoch: 21 cost time: 7.920207738876343
Epoch: 21, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.0597s/iter; left time: 1940.9015s
	iters: 200, epoch: 22 | loss: 0.0000523
	speed: 0.0177s/iter; left time: 575.4208s
	iters: 300, epoch: 22 | loss: 0.0000050
	speed: 0.0166s/iter; left time: 535.2156s
	iters: 400, epoch: 22 | loss: 0.0000225
	speed: 0.0177s/iter; left time: 570.1823s
Epoch: 22 cost time: 7.688348770141602
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000067
	speed: 0.0578s/iter; left time: 1856.6202s
	iters: 200, epoch: 23 | loss: 0.0000002
	speed: 0.0177s/iter; left time: 565.1139s
	iters: 300, epoch: 23 | loss: 0.0013125
	speed: 0.0176s/iter; left time: 561.1119s
	iters: 400, epoch: 23 | loss: 0.0014848
	speed: 0.0183s/iter; left time: 581.1414s
Epoch: 23 cost time: 7.685423851013184
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0002798
	speed: 0.0587s/iter; left time: 1861.6822s
	iters: 200, epoch: 24 | loss: 0.0126459
	speed: 0.0164s/iter; left time: 519.3405s
	iters: 300, epoch: 24 | loss: 0.0002189
	speed: 0.0169s/iter; left time: 533.5863s
	iters: 400, epoch: 24 | loss: 0.0000563
	speed: 0.0163s/iter; left time: 510.7139s
Epoch: 24 cost time: 7.305968999862671
Epoch: 24, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0155688
	speed: 0.0606s/iter; left time: 1895.9491s
	iters: 200, epoch: 25 | loss: 0.1328734
	speed: 0.0159s/iter; left time: 496.2108s
	iters: 300, epoch: 25 | loss: 0.0000112
	speed: 0.0181s/iter; left time: 561.8433s
	iters: 400, epoch: 25 | loss: 0.0019797
	speed: 0.0188s/iter; left time: 583.7617s
Epoch: 25 cost time: 7.5802717208862305
Epoch: 25, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000053
	speed: 0.0603s/iter; left time: 1860.5312s
	iters: 200, epoch: 26 | loss: 0.0004797
	speed: 0.0195s/iter; left time: 599.1963s
	iters: 300, epoch: 26 | loss: 0.0019397
	speed: 0.0182s/iter; left time: 557.1007s
	iters: 400, epoch: 26 | loss: 0.0000589
	speed: 0.0181s/iter; left time: 552.7188s
Epoch: 26 cost time: 8.027538061141968
Epoch: 26, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0035725
	speed: 0.0608s/iter; left time: 1853.4712s
	iters: 200, epoch: 27 | loss: 0.0000265
	speed: 0.0187s/iter; left time: 569.1816s
	iters: 300, epoch: 27 | loss: 0.0126032
	speed: 0.0192s/iter; left time: 582.0258s
	iters: 400, epoch: 27 | loss: 0.0002005
	speed: 0.0189s/iter; left time: 568.7557s
Epoch: 27 cost time: 8.193084478378296
Epoch: 27, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000003
	speed: 0.0622s/iter; left time: 1869.3876s
	iters: 200, epoch: 28 | loss: 0.0000030
	speed: 0.0193s/iter; left time: 578.6705s
	iters: 300, epoch: 28 | loss: 0.0000002
	speed: 0.0188s/iter; left time: 561.1216s
	iters: 400, epoch: 28 | loss: 0.0000005
	speed: 0.0195s/iter; left time: 581.1024s
Epoch: 28 cost time: 8.27035403251648
Epoch: 28, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.981354).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.0602s/iter; left time: 1783.1378s
	iters: 200, epoch: 29 | loss: 0.0000012
	speed: 0.0190s/iter; left time: 559.9428s
	iters: 300, epoch: 29 | loss: 0.0002994
	speed: 0.0196s/iter; left time: 577.3872s
	iters: 400, epoch: 29 | loss: 0.0000959
	speed: 0.0185s/iter; left time: 542.2500s
Epoch: 29 cost time: 8.114429712295532
Epoch: 29, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0002481
	speed: 0.0600s/iter; left time: 1753.8611s
	iters: 200, epoch: 30 | loss: 0.0000052
	speed: 0.0187s/iter; left time: 543.4148s
	iters: 300, epoch: 30 | loss: 0.0000435
	speed: 0.0179s/iter; left time: 520.9432s
	iters: 400, epoch: 30 | loss: 0.0000262
	speed: 0.0176s/iter; left time: 510.2395s
Epoch: 30 cost time: 7.843919992446899
Epoch: 30, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0346452
	speed: 0.0580s/iter; left time: 1670.1331s
	iters: 200, epoch: 31 | loss: 0.0470932
	speed: 0.0174s/iter; left time: 500.7322s
	iters: 300, epoch: 31 | loss: 0.0004303
	speed: 0.0181s/iter; left time: 516.9731s
	iters: 400, epoch: 31 | loss: 0.0000039
	speed: 0.0179s/iter; left time: 508.9526s
Epoch: 31 cost time: 7.712172031402588
Epoch: 31, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0000106
	speed: 0.0583s/iter; left time: 1654.6045s
	iters: 200, epoch: 32 | loss: 0.0000898
	speed: 0.0177s/iter; left time: 500.4631s
	iters: 300, epoch: 32 | loss: 0.0036293
	speed: 0.0181s/iter; left time: 511.4639s
	iters: 400, epoch: 32 | loss: 0.0000114
	speed: 0.0200s/iter; left time: 560.9034s
Epoch: 32 cost time: 7.979120254516602
Epoch: 32, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0008243
	speed: 0.0593s/iter; left time: 1660.1422s
	iters: 200, epoch: 33 | loss: 0.0000009
	speed: 0.0188s/iter; left time: 523.2587s
	iters: 300, epoch: 33 | loss: 0.0002557
	speed: 0.0196s/iter; left time: 544.7273s
	iters: 400, epoch: 33 | loss: 0.0000124
	speed: 0.0183s/iter; left time: 506.4444s
Epoch: 33 cost time: 8.120489120483398
Epoch: 33, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 1602.5483s
	iters: 200, epoch: 34 | loss: 0.0000043
	speed: 0.0206s/iter; left time: 566.3551s
	iters: 300, epoch: 34 | loss: 0.0000007
	speed: 0.0191s/iter; left time: 523.9730s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0185s/iter; left time: 504.2387s
Epoch: 34 cost time: 8.240111112594604
Epoch: 34, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0007053
	speed: 0.0600s/iter; left time: 1629.6904s
	iters: 200, epoch: 35 | loss: 0.0000180
	speed: 0.0181s/iter; left time: 489.4271s
	iters: 300, epoch: 35 | loss: 0.0028140
	speed: 0.0192s/iter; left time: 517.9550s
	iters: 400, epoch: 35 | loss: 0.0299446
	speed: 0.0186s/iter; left time: 500.4997s
Epoch: 35 cost time: 8.104167938232422
Epoch: 35, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0010198
	speed: 0.0596s/iter; left time: 1594.3543s
	iters: 200, epoch: 36 | loss: 0.0000007
	speed: 0.0185s/iter; left time: 493.5006s
	iters: 300, epoch: 36 | loss: 0.0000005
	speed: 0.0183s/iter; left time: 486.9163s
	iters: 400, epoch: 36 | loss: 0.0000206
	speed: 0.0190s/iter; left time: 502.9817s
Epoch: 36 cost time: 7.992074728012085
Epoch: 36, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0000600
	speed: 0.0591s/iter; left time: 1554.9904s
	iters: 200, epoch: 37 | loss: 0.0000700
	speed: 0.0165s/iter; left time: 432.4290s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0163s/iter; left time: 427.1567s
	iters: 400, epoch: 37 | loss: 0.1924208
	speed: 0.0170s/iter; left time: 443.2909s
Epoch: 37 cost time: 7.171615123748779
Epoch: 37, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0009505
	speed: 0.0578s/iter; left time: 1497.2153s
	iters: 200, epoch: 38 | loss: 0.0010916
	speed: 0.0158s/iter; left time: 408.4159s
	iters: 300, epoch: 38 | loss: 0.0000037
	speed: 0.0165s/iter; left time: 424.2308s
	iters: 400, epoch: 38 | loss: 0.0001899
	speed: 0.0165s/iter; left time: 421.6367s
Epoch: 38 cost time: 7.088157892227173
Epoch: 38, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 38446
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1754651
	speed: 0.0351s/iter; left time: 1444.3950s
	iters: 200, epoch: 1 | loss: 0.4458982
	speed: 0.0189s/iter; left time: 778.6259s
	iters: 300, epoch: 1 | loss: 0.1951730
	speed: 0.0182s/iter; left time: 746.2296s
	iters: 400, epoch: 1 | loss: 0.1592562
	speed: 0.0196s/iter; left time: 802.3559s
Epoch: 1 cost time: 9.458288192749023
Epoch: 1, Steps: 413 | Train Loss: 0.779 Vali Loss: 0.176 Vali Acc: 0.945 Test Loss: 0.176 Test Acc: 0.945
Validation loss decreased (inf --> -0.944973).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3517132
	speed: 0.0583s/iter; left time: 2378.6529s
	iters: 200, epoch: 2 | loss: 0.1555399
	speed: 0.0193s/iter; left time: 786.5395s
	iters: 300, epoch: 2 | loss: 0.1156417
	speed: 0.0184s/iter; left time: 746.5854s
	iters: 400, epoch: 2 | loss: 0.0593981
	speed: 0.0188s/iter; left time: 759.7492s
Epoch: 2 cost time: 8.132084131240845
Epoch: 2, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.944973 --> -0.967712).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0351296
	speed: 0.0602s/iter; left time: 2431.9655s
	iters: 200, epoch: 3 | loss: 0.0744614
	speed: 0.0183s/iter; left time: 736.5427s
	iters: 300, epoch: 3 | loss: 0.0182995
	speed: 0.0195s/iter; left time: 783.5322s
	iters: 400, epoch: 3 | loss: 0.0470468
	speed: 0.0184s/iter; left time: 737.1395s
Epoch: 3 cost time: 8.081329107284546
Epoch: 3, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
Validation loss decreased (-0.967712 --> -0.974078).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0395144
	speed: 0.0602s/iter; left time: 2406.5646s
	iters: 200, epoch: 4 | loss: 0.1553899
	speed: 0.0199s/iter; left time: 792.0495s
	iters: 300, epoch: 4 | loss: 0.0150626
	speed: 0.0203s/iter; left time: 806.2959s
	iters: 400, epoch: 4 | loss: 0.0861428
	speed: 0.0191s/iter; left time: 758.2507s
Epoch: 4 cost time: 8.492361307144165
Epoch: 4, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.088 Vali Acc: 0.967 Test Loss: 0.088 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0272200
	speed: 0.0608s/iter; left time: 2405.1370s
	iters: 200, epoch: 5 | loss: 0.0109386
	speed: 0.0182s/iter; left time: 717.9903s
	iters: 300, epoch: 5 | loss: 0.0122497
	speed: 0.0181s/iter; left time: 710.9375s
	iters: 400, epoch: 5 | loss: 0.0094450
	speed: 0.0185s/iter; left time: 726.8257s
Epoch: 5 cost time: 7.878889083862305
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
Validation loss decreased (-0.974078 --> -0.974988).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0127445
	speed: 0.0627s/iter; left time: 2452.6193s
	iters: 200, epoch: 6 | loss: 0.0078506
	speed: 0.0181s/iter; left time: 705.6853s
	iters: 300, epoch: 6 | loss: 0.0202617
	speed: 0.0191s/iter; left time: 744.7750s
	iters: 400, epoch: 6 | loss: 0.0805274
	speed: 0.0182s/iter; left time: 705.2295s
Epoch: 6 cost time: 7.98107385635376
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.080 Vali Acc: 0.972 Test Loss: 0.080 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0125826
	speed: 0.0651s/iter; left time: 2521.5471s
	iters: 200, epoch: 7 | loss: 0.0806265
	speed: 0.0189s/iter; left time: 729.7790s
	iters: 300, epoch: 7 | loss: 0.0290212
	speed: 0.0191s/iter; left time: 735.1312s
	iters: 400, epoch: 7 | loss: 0.0150767
	speed: 0.0185s/iter; left time: 710.4114s
Epoch: 7 cost time: 8.093370199203491
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0031827
	speed: 0.0608s/iter; left time: 2329.0223s
	iters: 200, epoch: 8 | loss: 0.0008158
	speed: 0.0204s/iter; left time: 777.9168s
	iters: 300, epoch: 8 | loss: 0.0063837
	speed: 0.0201s/iter; left time: 766.1444s
	iters: 400, epoch: 8 | loss: 0.0063003
	speed: 0.0191s/iter; left time: 727.7992s
Epoch: 8 cost time: 8.479001760482788
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0081711
	speed: 0.0632s/iter; left time: 2396.6286s
	iters: 200, epoch: 9 | loss: 0.0005379
	speed: 0.0198s/iter; left time: 748.5193s
	iters: 300, epoch: 9 | loss: 0.0030542
	speed: 0.0191s/iter; left time: 719.2255s
	iters: 400, epoch: 9 | loss: 0.0009694
	speed: 0.0190s/iter; left time: 715.7325s
Epoch: 9 cost time: 8.341476917266846
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.088 Vali Acc: 0.971 Test Loss: 0.088 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1224707
	speed: 0.0602s/iter; left time: 2257.2153s
	iters: 200, epoch: 10 | loss: 0.0000957
	speed: 0.0200s/iter; left time: 749.0816s
	iters: 300, epoch: 10 | loss: 0.0015081
	speed: 0.0203s/iter; left time: 755.1440s
	iters: 400, epoch: 10 | loss: 0.0010817
	speed: 0.0206s/iter; left time: 764.1653s
Epoch: 10 cost time: 8.664643049240112
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
Validation loss decreased (-0.974988 --> -0.975443).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0028355
	speed: 0.0615s/iter; left time: 2281.1448s
	iters: 200, epoch: 11 | loss: 0.0161079
	speed: 0.0204s/iter; left time: 754.7984s
	iters: 300, epoch: 11 | loss: 0.0003141
	speed: 0.0186s/iter; left time: 686.0802s
	iters: 400, epoch: 11 | loss: 0.0031049
	speed: 0.0204s/iter; left time: 750.5582s
Epoch: 11 cost time: 8.408053636550903
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0156580
	speed: 0.0601s/iter; left time: 2204.0301s
	iters: 200, epoch: 12 | loss: 0.0024850
	speed: 0.0186s/iter; left time: 678.5824s
	iters: 300, epoch: 12 | loss: 0.0001906
	speed: 0.0190s/iter; left time: 693.7415s
	iters: 400, epoch: 12 | loss: 0.0010179
	speed: 0.0185s/iter; left time: 672.9661s
Epoch: 12 cost time: 8.084138631820679
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0023168
	speed: 0.0588s/iter; left time: 2132.8040s
	iters: 200, epoch: 13 | loss: 0.0027468
	speed: 0.0192s/iter; left time: 692.4802s
	iters: 300, epoch: 13 | loss: 0.0006115
	speed: 0.0192s/iter; left time: 692.0617s
	iters: 400, epoch: 13 | loss: 0.0009583
	speed: 0.0187s/iter; left time: 673.6536s
Epoch: 13 cost time: 8.108639478683472
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.975443 --> -0.976352).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0001086
	speed: 0.0603s/iter; left time: 2160.1669s
	iters: 200, epoch: 14 | loss: 0.0016383
	speed: 0.0188s/iter; left time: 672.4433s
	iters: 300, epoch: 14 | loss: 0.0000537
	speed: 0.0185s/iter; left time: 658.8143s
	iters: 400, epoch: 14 | loss: 0.0026619
	speed: 0.0171s/iter; left time: 608.4634s
Epoch: 14 cost time: 7.81463098526001
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0009230
	speed: 0.0593s/iter; left time: 2100.9905s
	iters: 200, epoch: 15 | loss: 0.2954377
	speed: 0.0181s/iter; left time: 640.1010s
	iters: 300, epoch: 15 | loss: 0.0072962
	speed: 0.0173s/iter; left time: 609.5149s
	iters: 400, epoch: 15 | loss: 0.0000718
	speed: 0.0200s/iter; left time: 700.8562s
Epoch: 15 cost time: 8.046821117401123
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0053410
	speed: 0.0615s/iter; left time: 2152.1746s
	iters: 200, epoch: 16 | loss: 0.0000353
	speed: 0.0183s/iter; left time: 639.0196s
	iters: 300, epoch: 16 | loss: 0.0000548
	speed: 0.0182s/iter; left time: 634.4884s
	iters: 400, epoch: 16 | loss: 0.0001232
	speed: 0.0183s/iter; left time: 634.0994s
Epoch: 16 cost time: 7.963587760925293
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.976352 --> -0.980900).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000204
	speed: 0.0552s/iter; left time: 1909.1959s
	iters: 200, epoch: 17 | loss: 0.0001384
	speed: 0.0169s/iter; left time: 582.7055s
	iters: 300, epoch: 17 | loss: 0.0231083
	speed: 0.0175s/iter; left time: 602.1070s
	iters: 400, epoch: 17 | loss: 0.2677868
	speed: 0.0226s/iter; left time: 773.5472s
Epoch: 17 cost time: 8.076026916503906
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.980900 --> -0.983173).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0008374
	speed: 0.0856s/iter; left time: 2924.9785s
	iters: 200, epoch: 18 | loss: 0.0000558
	speed: 0.0256s/iter; left time: 874.1332s
	iters: 300, epoch: 18 | loss: 0.0118010
	speed: 0.0249s/iter; left time: 845.9114s
	iters: 400, epoch: 18 | loss: 0.0019164
	speed: 0.0260s/iter; left time: 879.5477s
Epoch: 18 cost time: 10.859508991241455
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000061
	speed: 0.0894s/iter; left time: 3019.1531s
	iters: 200, epoch: 19 | loss: 0.0022823
	speed: 0.0243s/iter; left time: 819.6846s
	iters: 300, epoch: 19 | loss: 0.0015247
	speed: 0.0244s/iter; left time: 818.6691s
	iters: 400, epoch: 19 | loss: 0.0000776
	speed: 0.0255s/iter; left time: 852.4201s
Epoch: 19 cost time: 10.672025680541992
Epoch: 19, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000062
	speed: 0.0857s/iter; left time: 2858.2110s
	iters: 200, epoch: 20 | loss: 0.0007905
	speed: 0.0264s/iter; left time: 877.8440s
	iters: 300, epoch: 20 | loss: 0.0270222
	speed: 0.0246s/iter; left time: 816.0570s
	iters: 400, epoch: 20 | loss: 0.0004635
	speed: 0.0253s/iter; left time: 835.4838s
Epoch: 20 cost time: 10.812206983566284
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0019161
	speed: 0.0836s/iter; left time: 2754.4066s
	iters: 200, epoch: 21 | loss: 0.0000027
	speed: 0.0243s/iter; left time: 798.9339s
	iters: 300, epoch: 21 | loss: 0.0903744
	speed: 0.0259s/iter; left time: 849.4986s
	iters: 400, epoch: 21 | loss: 0.0044784
	speed: 0.0239s/iter; left time: 778.6422s
Epoch: 21 cost time: 10.61463451385498
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000178
	speed: 0.0817s/iter; left time: 2657.8215s
	iters: 200, epoch: 22 | loss: 0.0002405
	speed: 0.0261s/iter; left time: 844.7509s
	iters: 300, epoch: 22 | loss: 0.0000008
	speed: 0.0256s/iter; left time: 826.5332s
	iters: 400, epoch: 22 | loss: 0.0000406
	speed: 0.0258s/iter; left time: 830.7646s
Epoch: 22 cost time: 11.05799126625061
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000488
	speed: 0.0882s/iter; left time: 2831.4788s
	iters: 200, epoch: 23 | loss: 0.0000002
	speed: 0.0267s/iter; left time: 853.8951s
	iters: 300, epoch: 23 | loss: 0.0031955
	speed: 0.0274s/iter; left time: 873.9815s
	iters: 400, epoch: 23 | loss: 0.0013376
	speed: 0.0267s/iter; left time: 850.4212s
Epoch: 23 cost time: 11.330155849456787
Epoch: 23, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000542
	speed: 0.0865s/iter; left time: 2741.4308s
	iters: 200, epoch: 24 | loss: 0.0140723
	speed: 0.0239s/iter; left time: 754.7403s
	iters: 300, epoch: 24 | loss: 0.0000238
	speed: 0.0237s/iter; left time: 747.9735s
	iters: 400, epoch: 24 | loss: 0.0002669
	speed: 0.0247s/iter; left time: 774.2503s
Epoch: 24 cost time: 10.175429344177246
Epoch: 24, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0002934
	speed: 0.0860s/iter; left time: 2689.9183s
	iters: 200, epoch: 25 | loss: 0.0002764
	speed: 0.0238s/iter; left time: 743.5717s
	iters: 300, epoch: 25 | loss: 0.0000059
	speed: 0.0241s/iter; left time: 748.9115s
	iters: 400, epoch: 25 | loss: 0.0025542
	speed: 0.0236s/iter; left time: 731.3682s
Epoch: 25 cost time: 9.9583899974823
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0007156
	speed: 0.0889s/iter; left time: 2745.8629s
	iters: 200, epoch: 26 | loss: 0.0040705
	speed: 0.0260s/iter; left time: 798.8765s
	iters: 300, epoch: 26 | loss: 0.0000952
	speed: 0.0257s/iter; left time: 787.8712s
	iters: 400, epoch: 26 | loss: 0.0001022
	speed: 0.0253s/iter; left time: 772.0808s
Epoch: 26 cost time: 10.743784666061401
Epoch: 26, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000017
	speed: 0.0911s/iter; left time: 2773.7131s
	iters: 200, epoch: 27 | loss: 0.0000581
	speed: 0.0258s/iter; left time: 782.0675s
	iters: 300, epoch: 27 | loss: 0.0001103
	speed: 0.0255s/iter; left time: 770.2758s
	iters: 400, epoch: 27 | loss: 0.0001206
	speed: 0.0249s/iter; left time: 752.0370s
Epoch: 27 cost time: 10.867803573608398
Epoch: 27, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 38446
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3419913
	speed: 0.0412s/iter; left time: 1698.9567s
	iters: 200, epoch: 1 | loss: 0.5098333
	speed: 0.0233s/iter; left time: 958.8798s
	iters: 300, epoch: 1 | loss: 0.2130129
	speed: 0.0236s/iter; left time: 966.0583s
	iters: 400, epoch: 1 | loss: 0.1989181
	speed: 0.0216s/iter; left time: 885.1505s
Epoch: 1 cost time: 11.35811996459961
Epoch: 1, Steps: 413 | Train Loss: 0.852 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
Validation loss decreased (inf --> -0.942244).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3293145
	speed: 0.0874s/iter; left time: 3563.7664s
	iters: 200, epoch: 2 | loss: 0.1663163
	speed: 0.0234s/iter; left time: 952.3924s
	iters: 300, epoch: 2 | loss: 0.1055276
	speed: 0.0248s/iter; left time: 1005.1643s
	iters: 400, epoch: 2 | loss: 0.0812227
	speed: 0.0216s/iter; left time: 875.6344s
Epoch: 2 cost time: 10.111079216003418
Epoch: 2, Steps: 413 | Train Loss: 0.161 Vali Loss: 0.129 Vali Acc: 0.956 Test Loss: 0.129 Test Acc: 0.956
Validation loss decreased (-0.942244 --> -0.956342).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0356257
	speed: 0.0843s/iter; left time: 3403.1283s
	iters: 200, epoch: 3 | loss: 0.0714810
	speed: 0.0252s/iter; left time: 1013.9242s
	iters: 300, epoch: 3 | loss: 0.0146894
	speed: 0.0264s/iter; left time: 1060.9458s
	iters: 400, epoch: 3 | loss: 0.0303103
	speed: 0.0249s/iter; left time: 998.1327s
Epoch: 3 cost time: 10.912858009338379
Epoch: 3, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
Validation loss decreased (-0.956342 --> -0.964983).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0180787
	speed: 0.0875s/iter; left time: 3495.4182s
	iters: 200, epoch: 4 | loss: 0.2568761
	speed: 0.0256s/iter; left time: 1021.8050s
	iters: 300, epoch: 4 | loss: 0.0055156
	speed: 0.0270s/iter; left time: 1072.7918s
	iters: 400, epoch: 4 | loss: 0.0453634
	speed: 0.0255s/iter; left time: 1010.0084s
Epoch: 4 cost time: 11.078556537628174
Epoch: 4, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
Validation loss decreased (-0.964983 --> -0.968166).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1126923
	speed: 0.0833s/iter; left time: 3295.5983s
	iters: 200, epoch: 5 | loss: 0.0033169
	speed: 0.0254s/iter; left time: 1003.4271s
	iters: 300, epoch: 5 | loss: 0.0454686
	speed: 0.0248s/iter; left time: 977.5771s
	iters: 400, epoch: 5 | loss: 0.0131612
	speed: 0.0257s/iter; left time: 1007.2675s
Epoch: 5 cost time: 10.803268671035767
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.063 Vali Acc: 0.978 Test Loss: 0.063 Test Acc: 0.978
Validation loss decreased (-0.968166 --> -0.978171).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0122850
	speed: 0.0827s/iter; left time: 3236.7625s
	iters: 200, epoch: 6 | loss: 0.0079704
	speed: 0.0264s/iter; left time: 1031.5758s
	iters: 300, epoch: 6 | loss: 0.0068251
	speed: 0.0251s/iter; left time: 977.5972s
	iters: 400, epoch: 6 | loss: 0.0869258
	speed: 0.0250s/iter; left time: 969.8842s
Epoch: 6 cost time: 10.88161563873291
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0097963
	speed: 0.0809s/iter; left time: 3133.4650s
	iters: 200, epoch: 7 | loss: 0.0659610
	speed: 0.0254s/iter; left time: 980.1833s
	iters: 300, epoch: 7 | loss: 0.0235652
	speed: 0.0253s/iter; left time: 975.0739s
	iters: 400, epoch: 7 | loss: 0.0392439
	speed: 0.0255s/iter; left time: 978.4805s
Epoch: 7 cost time: 10.700630903244019
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0018935
	speed: 0.0871s/iter; left time: 3336.5774s
	iters: 200, epoch: 8 | loss: 0.0007047
	speed: 0.0266s/iter; left time: 1016.0486s
	iters: 300, epoch: 8 | loss: 0.0097262
	speed: 0.0253s/iter; left time: 965.7322s
	iters: 400, epoch: 8 | loss: 0.0026312
	speed: 0.0257s/iter; left time: 978.2520s
Epoch: 8 cost time: 10.9958815574646
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0054731
	speed: 0.0922s/iter; left time: 3493.7106s
	iters: 200, epoch: 9 | loss: 0.0036699
	speed: 0.0227s/iter; left time: 856.9535s
	iters: 300, epoch: 9 | loss: 0.0191439
	speed: 0.0231s/iter; left time: 871.5931s
	iters: 400, epoch: 9 | loss: 0.0004827
	speed: 0.0238s/iter; left time: 895.3970s
Epoch: 9 cost time: 10.264125347137451
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0531822
	speed: 0.0888s/iter; left time: 3329.6719s
	iters: 200, epoch: 10 | loss: 0.0004566
	speed: 0.0232s/iter; left time: 867.3017s
	iters: 300, epoch: 10 | loss: 0.0017900
	speed: 0.0234s/iter; left time: 873.7964s
	iters: 400, epoch: 10 | loss: 0.0002318
	speed: 0.0225s/iter; left time: 836.5514s
Epoch: 10 cost time: 10.018746852874756
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0013351
	speed: 0.0887s/iter; left time: 3289.3529s
	iters: 200, epoch: 11 | loss: 0.0017432
	speed: 0.0236s/iter; left time: 870.7411s
	iters: 300, epoch: 11 | loss: 0.0006735
	speed: 0.0231s/iter; left time: 851.5613s
	iters: 400, epoch: 11 | loss: 0.0056477
	speed: 0.0267s/iter; left time: 983.4066s
Epoch: 11 cost time: 10.415813446044922
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.061 Vali Acc: 0.984 Test Loss: 0.061 Test Acc: 0.984
Validation loss decreased (-0.978171 --> -0.983628).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0009806
	speed: 0.0924s/iter; left time: 3386.0720s
	iters: 200, epoch: 12 | loss: 0.0002976
	speed: 0.0250s/iter; left time: 914.5193s
	iters: 300, epoch: 12 | loss: 0.0004289
	speed: 0.0251s/iter; left time: 916.2573s
	iters: 400, epoch: 12 | loss: 0.0010048
	speed: 0.0262s/iter; left time: 951.5380s
Epoch: 12 cost time: 11.021343231201172
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0014915
	speed: 0.0886s/iter; left time: 3212.5366s
	iters: 200, epoch: 13 | loss: 0.0110844
	speed: 0.0250s/iter; left time: 905.3431s
	iters: 300, epoch: 13 | loss: 0.0080405
	speed: 0.0262s/iter; left time: 944.8460s
	iters: 400, epoch: 13 | loss: 0.0058874
	speed: 0.0247s/iter; left time: 888.5718s
Epoch: 13 cost time: 10.833823680877686
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000352
	speed: 0.0875s/iter; left time: 3136.3661s
	iters: 200, epoch: 14 | loss: 0.0050567
	speed: 0.0235s/iter; left time: 839.0479s
	iters: 300, epoch: 14 | loss: 0.0047282
	speed: 0.0231s/iter; left time: 824.6735s
	iters: 400, epoch: 14 | loss: 0.0047400
	speed: 0.0235s/iter; left time: 835.5526s
Epoch: 14 cost time: 10.117109537124634
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0063527
	speed: 0.0844s/iter; left time: 2990.2844s
	iters: 200, epoch: 15 | loss: 0.0768309
	speed: 0.0238s/iter; left time: 840.2525s
	iters: 300, epoch: 15 | loss: 0.0000672
	speed: 0.0245s/iter; left time: 864.0471s
	iters: 400, epoch: 15 | loss: 0.0001724
	speed: 0.0241s/iter; left time: 847.3345s
Epoch: 15 cost time: 10.436209678649902
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0005642
	speed: 0.0815s/iter; left time: 2852.1906s
	iters: 200, epoch: 16 | loss: 0.0001612
	speed: 0.0244s/iter; left time: 851.1279s
	iters: 300, epoch: 16 | loss: 0.0038147
	speed: 0.0250s/iter; left time: 868.7656s
	iters: 400, epoch: 16 | loss: 0.0036427
	speed: 0.0250s/iter; left time: 868.6631s
Epoch: 16 cost time: 10.713051557540894
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000046
	speed: 0.0865s/iter; left time: 2991.5333s
	iters: 200, epoch: 17 | loss: 0.0000113
	speed: 0.0242s/iter; left time: 835.7096s
	iters: 300, epoch: 17 | loss: 0.0003432
	speed: 0.0251s/iter; left time: 862.0740s
	iters: 400, epoch: 17 | loss: 0.0023327
	speed: 0.0244s/iter; left time: 836.7491s
Epoch: 17 cost time: 10.605264902114868
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0226250
	speed: 0.0858s/iter; left time: 2931.0273s
	iters: 200, epoch: 18 | loss: 0.0002649
	speed: 0.0219s/iter; left time: 746.4476s
	iters: 300, epoch: 18 | loss: 0.0020855
	speed: 0.0233s/iter; left time: 792.2689s
	iters: 400, epoch: 18 | loss: 0.0002151
	speed: 0.0236s/iter; left time: 798.0043s
Epoch: 18 cost time: 9.899672508239746
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000283
	speed: 0.0872s/iter; left time: 2943.2015s
	iters: 200, epoch: 19 | loss: 0.0098701
	speed: 0.0200s/iter; left time: 674.6306s
	iters: 300, epoch: 19 | loss: 0.0000817
	speed: 0.0215s/iter; left time: 721.2900s
	iters: 400, epoch: 19 | loss: 0.0016054
	speed: 0.0213s/iter; left time: 711.1947s
Epoch: 19 cost time: 9.179732322692871
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000241
	speed: 0.0864s/iter; left time: 2880.1655s
	iters: 200, epoch: 20 | loss: 0.0008885
	speed: 0.0202s/iter; left time: 670.9092s
	iters: 300, epoch: 20 | loss: 0.0000028
	speed: 0.0231s/iter; left time: 765.7954s
	iters: 400, epoch: 20 | loss: 0.0004771
	speed: 0.0247s/iter; left time: 817.2501s
Epoch: 20 cost time: 9.81115460395813
Epoch: 20, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000337
	speed: 0.0879s/iter; left time: 2894.2359s
	iters: 200, epoch: 21 | loss: 0.0000892
	speed: 0.0247s/iter; left time: 810.5552s
	iters: 300, epoch: 21 | loss: 0.0016836
	speed: 0.0238s/iter; left time: 778.3287s
	iters: 400, epoch: 21 | loss: 0.0010610
	speed: 0.0256s/iter; left time: 836.9929s
Epoch: 21 cost time: 10.598428726196289
Epoch: 21, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 38446
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.6240389
	speed: 0.0405s/iter; left time: 1667.8417s
	iters: 200, epoch: 1 | loss: 0.8079430
	speed: 0.0216s/iter; left time: 888.9116s
	iters: 300, epoch: 1 | loss: 0.3376433
	speed: 0.0227s/iter; left time: 932.1383s
	iters: 400, epoch: 1 | loss: 0.2760276
	speed: 0.0226s/iter; left time: 922.8877s
Epoch: 1 cost time: 11.141701698303223
Epoch: 1, Steps: 413 | Train Loss: 1.023 Vali Loss: 0.245 Vali Acc: 0.936 Test Loss: 0.245 Test Acc: 0.936
Validation loss decreased (inf --> -0.935877).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4217788
	speed: 0.0848s/iter; left time: 3457.6760s
	iters: 200, epoch: 2 | loss: 0.1582462
	speed: 0.0240s/iter; left time: 976.9304s
	iters: 300, epoch: 2 | loss: 0.1489016
	speed: 0.0239s/iter; left time: 968.3194s
	iters: 400, epoch: 2 | loss: 0.0819521
	speed: 0.0233s/iter; left time: 943.5345s
Epoch: 2 cost time: 10.285696506500244
Epoch: 2, Steps: 413 | Train Loss: 0.199 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
Validation loss decreased (-0.935877 --> -0.949976).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0347944
	speed: 0.0841s/iter; left time: 3393.9800s
	iters: 200, epoch: 3 | loss: 0.0908903
	speed: 0.0252s/iter; left time: 1015.2622s
	iters: 300, epoch: 3 | loss: 0.0068559
	speed: 0.0255s/iter; left time: 1022.9603s
	iters: 400, epoch: 3 | loss: 0.0258527
	speed: 0.0254s/iter; left time: 1019.0700s
Epoch: 3 cost time: 10.838565349578857
Epoch: 3, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.095 Vali Acc: 0.966 Test Loss: 0.095 Test Acc: 0.966
Validation loss decreased (-0.949976 --> -0.966347).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0345809
	speed: 0.0879s/iter; left time: 3513.9350s
	iters: 200, epoch: 4 | loss: 0.1080260
	speed: 0.0268s/iter; left time: 1066.3136s
	iters: 300, epoch: 4 | loss: 0.0428545
	speed: 0.0257s/iter; left time: 1020.4484s
	iters: 400, epoch: 4 | loss: 0.0514021
	speed: 0.0251s/iter; left time: 995.2043s
Epoch: 4 cost time: 11.131125450134277
Epoch: 4, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.966347 --> -0.970440).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1131207
	speed: 0.0881s/iter; left time: 3483.5541s
	iters: 200, epoch: 5 | loss: 0.0052136
	speed: 0.0258s/iter; left time: 1017.5155s
	iters: 300, epoch: 5 | loss: 0.0177148
	speed: 0.0217s/iter; left time: 854.2202s
	iters: 400, epoch: 5 | loss: 0.0176577
	speed: 0.0242s/iter; left time: 948.8877s
Epoch: 5 cost time: 10.352593660354614
Epoch: 5, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.082 Vali Acc: 0.972 Test Loss: 0.082 Test Acc: 0.972
Validation loss decreased (-0.970440 --> -0.972259).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0112380
	speed: 0.0873s/iter; left time: 3416.6547s
	iters: 200, epoch: 6 | loss: 0.0223758
	speed: 0.0232s/iter; left time: 905.4748s
	iters: 300, epoch: 6 | loss: 0.0393231
	speed: 0.0202s/iter; left time: 784.9934s
	iters: 400, epoch: 6 | loss: 0.0697152
	speed: 0.0218s/iter; left time: 847.1375s
Epoch: 6 cost time: 9.49469804763794
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.966 Test Loss: 0.111 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0350556
	speed: 0.0856s/iter; left time: 3315.9841s
	iters: 200, epoch: 7 | loss: 0.0055790
	speed: 0.0225s/iter; left time: 868.4283s
	iters: 300, epoch: 7 | loss: 0.0033978
	speed: 0.0223s/iter; left time: 858.7149s
	iters: 400, epoch: 7 | loss: 0.0662000
	speed: 0.0211s/iter; left time: 810.5361s
Epoch: 7 cost time: 9.525015830993652
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0134562
	speed: 0.0878s/iter; left time: 3363.7197s
	iters: 200, epoch: 8 | loss: 0.0128256
	speed: 0.0254s/iter; left time: 968.9557s
	iters: 300, epoch: 8 | loss: 0.0132425
	speed: 0.0247s/iter; left time: 942.5589s
	iters: 400, epoch: 8 | loss: 0.0023735
	speed: 0.0251s/iter; left time: 954.2457s
Epoch: 8 cost time: 10.834047079086304
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0034817
	speed: 0.0876s/iter; left time: 3318.6822s
	iters: 200, epoch: 9 | loss: 0.0025554
	speed: 0.0252s/iter; left time: 952.6331s
	iters: 300, epoch: 9 | loss: 0.0272151
	speed: 0.0261s/iter; left time: 982.3993s
	iters: 400, epoch: 9 | loss: 0.0024847
	speed: 0.0252s/iter; left time: 949.0870s
Epoch: 9 cost time: 10.799811363220215
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.084 Vali Acc: 0.972 Test Loss: 0.084 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0188405
	speed: 0.0813s/iter; left time: 3047.3909s
	iters: 200, epoch: 10 | loss: 0.0010266
	speed: 0.0234s/iter; left time: 874.4774s
	iters: 300, epoch: 10 | loss: 0.0017405
	speed: 0.0229s/iter; left time: 855.6485s
	iters: 400, epoch: 10 | loss: 0.0052075
	speed: 0.0219s/iter; left time: 814.5068s
Epoch: 10 cost time: 9.783767461776733
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.966 Test Loss: 0.113 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0001797
	speed: 0.0819s/iter; left time: 3035.3211s
	iters: 200, epoch: 11 | loss: 0.0162721
	speed: 0.0234s/iter; left time: 864.2883s
	iters: 300, epoch: 11 | loss: 0.0072307
	speed: 0.0221s/iter; left time: 814.5102s
	iters: 400, epoch: 11 | loss: 0.0018948
	speed: 0.0226s/iter; left time: 830.1896s
Epoch: 11 cost time: 9.785509586334229
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0032522
	speed: 0.0841s/iter; left time: 3082.0930s
	iters: 200, epoch: 12 | loss: 0.0023957
	speed: 0.0238s/iter; left time: 869.7546s
	iters: 300, epoch: 12 | loss: 0.0022517
	speed: 0.0243s/iter; left time: 887.3164s
	iters: 400, epoch: 12 | loss: 0.0132889
	speed: 0.0249s/iter; left time: 907.0022s
Epoch: 12 cost time: 10.172277212142944
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0431216
	speed: 0.0840s/iter; left time: 3045.7983s
	iters: 200, epoch: 13 | loss: 0.2052389
	speed: 0.0247s/iter; left time: 892.8126s
	iters: 300, epoch: 13 | loss: 0.0010367
	speed: 0.0248s/iter; left time: 893.0793s
	iters: 400, epoch: 13 | loss: 0.0113809
	speed: 0.0252s/iter; left time: 906.6017s
Epoch: 13 cost time: 10.658844470977783
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0150913
	speed: 0.0822s/iter; left time: 2944.5676s
	iters: 200, epoch: 14 | loss: 0.0016010
	speed: 0.0256s/iter; left time: 913.2214s
	iters: 300, epoch: 14 | loss: 0.0009339
	speed: 0.0247s/iter; left time: 881.1634s
	iters: 400, epoch: 14 | loss: 0.0019734
	speed: 0.0215s/iter; left time: 764.4523s
Epoch: 14 cost time: 10.326400518417358
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.2512568
	speed: 0.0873s/iter; left time: 3092.8132s
	iters: 200, epoch: 15 | loss: 0.0003542
	speed: 0.0242s/iter; left time: 855.7958s
	iters: 300, epoch: 15 | loss: 0.0002986
	speed: 0.0254s/iter; left time: 894.1998s
	iters: 400, epoch: 15 | loss: 0.0030176
	speed: 0.0203s/iter; left time: 712.8561s
Epoch: 15 cost time: 10.07506275177002
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_ETSformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9722601182355616
model parameter : 38446
model size : 0.77MB
